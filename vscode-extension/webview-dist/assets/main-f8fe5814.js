(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var d4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k5={exports:{}},Kd={},E5={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=Symbol.for("react.element"),ok=Symbol.for("react.portal"),lk=Symbol.for("react.fragment"),ck=Symbol.for("react.strict_mode"),uk=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),hk=Symbol.for("react.forward_ref"),pk=Symbol.for("react.suspense"),gk=Symbol.for("react.memo"),mk=Symbol.for("react.lazy"),h4=Symbol.iterator;function xk(e){return e===null||typeof e!="object"?null:(e=h4&&e[h4]||e["@@iterator"],typeof e=="function"?e:null)}var C5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T5=Object.assign,A5={};function ec(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}ec.prototype.isReactComponent={};ec.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ec.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function P5(){}P5.prototype=ec.prototype;function Vm(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}var Gm=Vm.prototype=new P5;Gm.constructor=Vm;T5(Gm,ec.prototype);Gm.isPureReactComponent=!0;var p4=Array.isArray,F5=Object.prototype.hasOwnProperty,Hm={current:null},N5={key:!0,ref:!0,__self:!0,__source:!0};function R5(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)F5.call(t,n)&&!N5.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),f=0;f<o;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:nu,type:e,key:a,ref:s,props:i,_owner:Hm.current}}function vk(e,t){return{$$typeof:nu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wm(e){return typeof e=="object"&&e!==null&&e.$$typeof===nu}function yk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var g4=/\/+/g;function Sp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yk(""+e.key):t.toString(36)}function Hf(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case nu:case ok:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+Sp(s,0):n,p4(i)?(r="",e!=null&&(r=e.replace(g4,"$&/")+"/"),Hf(i,t,r,"",function(f){return f})):i!=null&&(Wm(i)&&(i=vk(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(g4,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",p4(e))for(var o=0;o<e.length;o++){a=e[o];var u=n+Sp(a,o);s+=Hf(a,t,r,u,i)}else if(u=xk(e),typeof u=="function")for(e=u.call(e),o=0;!(a=e.next()).done;)a=a.value,u=n+Sp(a,o++),s+=Hf(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function df(e,t,r){if(e==null)return e;var n=[],i=0;return Hf(e,n,"","",function(a){return t.call(r,a,i++)}),n}function _k(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Nn={current:null},Wf={transition:null},Sk={ReactCurrentDispatcher:Nn,ReactCurrentBatchConfig:Wf,ReactCurrentOwner:Hm};function I5(){throw Error("act(...) is not supported in production builds of React.")}mt.Children={map:df,forEach:function(e,t,r){df(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return df(e,function(){t++}),t},toArray:function(e){return df(e,function(t){return t})||[]},only:function(e){if(!Wm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};mt.Component=ec;mt.Fragment=lk;mt.Profiler=uk;mt.PureComponent=Vm;mt.StrictMode=ck;mt.Suspense=pk;mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sk;mt.act=I5;mt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=T5({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Hm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)F5.call(t,u)&&!N5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var f=0;f<u;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:nu,type:e.type,key:i,ref:a,props:n,_owner:s}};mt.createContext=function(e){return e={$$typeof:dk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fk,_context:e},e.Consumer=e};mt.createElement=R5;mt.createFactory=function(e){var t=R5.bind(null,e);return t.type=e,t};mt.createRef=function(){return{current:null}};mt.forwardRef=function(e){return{$$typeof:hk,render:e}};mt.isValidElement=Wm;mt.lazy=function(e){return{$$typeof:mk,_payload:{_status:-1,_result:e},_init:_k}};mt.memo=function(e,t){return{$$typeof:gk,type:e,compare:t===void 0?null:t}};mt.startTransition=function(e){var t=Wf.transition;Wf.transition={};try{e()}finally{Wf.transition=t}};mt.unstable_act=I5;mt.useCallback=function(e,t){return Nn.current.useCallback(e,t)};mt.useContext=function(e){return Nn.current.useContext(e)};mt.useDebugValue=function(){};mt.useDeferredValue=function(e){return Nn.current.useDeferredValue(e)};mt.useEffect=function(e,t){return Nn.current.useEffect(e,t)};mt.useId=function(){return Nn.current.useId()};mt.useImperativeHandle=function(e,t,r){return Nn.current.useImperativeHandle(e,t,r)};mt.useInsertionEffect=function(e,t){return Nn.current.useInsertionEffect(e,t)};mt.useLayoutEffect=function(e,t){return Nn.current.useLayoutEffect(e,t)};mt.useMemo=function(e,t){return Nn.current.useMemo(e,t)};mt.useReducer=function(e,t,r){return Nn.current.useReducer(e,t,r)};mt.useRef=function(e){return Nn.current.useRef(e)};mt.useState=function(e){return Nn.current.useState(e)};mt.useSyncExternalStore=function(e,t,r){return Nn.current.useSyncExternalStore(e,t,r)};mt.useTransition=function(){return Nn.current.useTransition()};mt.version="18.3.1";E5.exports=mt;var ke=E5.exports;const Sr=Xd(ke);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk=ke,kk=Symbol.for("react.element"),Ek=Symbol.for("react.fragment"),Ck=Object.prototype.hasOwnProperty,Tk=wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ak={key:!0,ref:!0,__self:!0,__source:!0};function D5(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Ck.call(t,n)&&!Ak.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:kk,type:e,key:a,ref:s,props:i,_owner:Tk.current}}Kd.Fragment=Ek;Kd.jsx=D5;Kd.jsxs=D5;k5.exports=Kd;var A=k5.exports,wg={},O5={exports:{}},ni={},b5={exports:{}},L5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,X){var ce=ie.length;ie.push(X);e:for(;0<ce;){var Ce=ce-1>>>1,L=ie[Ce];if(0<i(L,X))ie[Ce]=X,ie[ce]=L,ce=Ce;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var X=ie[0],ce=ie.pop();if(ce!==X){ie[0]=ce;e:for(var Ce=0,L=ie.length,q=L>>>1;Ce<q;){var Y=2*(Ce+1)-1,K=ie[Y],de=Y+1,G=ie[de];if(0>i(K,ce))de<L&&0>i(G,K)?(ie[Ce]=G,ie[de]=ce,Ce=de):(ie[Ce]=K,ie[Y]=ce,Ce=Y);else if(de<L&&0>i(G,ce))ie[Ce]=G,ie[de]=ce,Ce=de;else break e}}return X}function i(ie,X){var ce=ie.sortIndex-X.sortIndex;return ce!==0?ce:ie.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],f=[],d=1,p=null,m=3,v=!1,g=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ie){for(var X=r(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=ie)n(f),X.sortIndex=X.expirationTime,t(u,X);else break;X=r(f)}}function C(ie){if(_=!1,x(ie),!g)if(r(u)!==null)g=!0,Ae(N);else{var X=r(f);X!==null&&Te(C,X.startTime-ie)}}function N(ie,X){g=!1,_&&(_=!1,E(P),P=-1),v=!0;var ce=m;try{for(x(X),p=r(u);p!==null&&(!(p.expirationTime>X)||ie&&!U());){var Ce=p.callback;if(typeof Ce=="function"){p.callback=null,m=p.priorityLevel;var L=Ce(p.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?p.callback=L:p===r(u)&&n(u),x(X)}else n(u);p=r(u)}if(p!==null)var q=!0;else{var Y=r(f);Y!==null&&Te(C,Y.startTime-X),q=!1}return q}finally{p=null,m=ce,v=!1}}var T=!1,F=null,P=-1,I=5,D=-1;function U(){return!(e.unstable_now()-D<I)}function b(){if(F!==null){var ie=e.unstable_now();D=ie;var X=!0;try{X=F(!0,ie)}finally{X?Q():(T=!1,F=null)}}else T=!1}var Q;if(typeof S=="function")Q=function(){S(b)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,te=he.port2;he.port1.onmessage=b,Q=function(){te.postMessage(null)}}else Q=function(){k(b,0)};function Ae(ie){F=ie,T||(T=!0,Q())}function Te(ie,X){P=k(function(){ie(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){g||v||(g=!0,Ae(N))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ie){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var ce=m;m=X;try{return ie()}finally{m=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,X){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ce=m;m=ie;try{return X()}finally{m=ce}},e.unstable_scheduleCallback=function(ie,X,ce){var Ce=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ce+ce:Ce):ce=Ce,ie){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=ce+L,ie={id:d++,callback:X,priorityLevel:ie,startTime:ce,expirationTime:L,sortIndex:-1},ce>Ce?(ie.sortIndex=ce,t(f,ie),r(u)===null&&ie===r(f)&&(_?(E(P),P=-1):_=!0,Te(C,ce-Ce))):(ie.sortIndex=L,t(u,ie),g||v||(g=!0,Ae(N))),ie},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(ie){var X=m;return function(){var ce=m;m=X;try{return ie.apply(this,arguments)}finally{m=ce}}}})(L5);b5.exports=L5;var s0=b5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pk=ke,ei=s0;function Ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M5=new Set,C0={};function Fo(e,t){Bl(e,t),Bl(e+"Capture",t)}function Bl(e,t){for(C0[e]=t,e=0;e<t.length;e++)M5.add(t[e])}var ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kg=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m4={},x4={};function Nk(e){return kg.call(x4,e)?!0:kg.call(m4,e)?!1:Fk.test(e)?x4[e]=!0:(m4[e]=!0,!1)}function Rk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ik(e,t,r,n){if(t===null||typeof t>"u"||Rk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Rn(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var Jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Jr[e]=new Rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Jr[t]=new Rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Jr[e]=new Rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Jr[e]=new Rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Jr[e]=new Rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Jr[e]=new Rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Jr[e]=new Rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Jr[e]=new Rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Jr[e]=new Rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var $m=/[\-:]([a-z])/g;function Xm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($m,Xm);Jr[t]=new Rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($m,Xm);Jr[t]=new Rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($m,Xm);Jr[t]=new Rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Jr[e]=new Rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Jr.xlinkHref=new Rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Jr[e]=new Rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Km(e,t,r,n){var i=Jr.hasOwnProperty(t)?Jr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ik(t,r,i,n)&&(r=null),n||i===null?Nk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var $a=Pk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hf=Symbol.for("react.element"),gl=Symbol.for("react.portal"),ml=Symbol.for("react.fragment"),Ym=Symbol.for("react.strict_mode"),Eg=Symbol.for("react.profiler"),B5=Symbol.for("react.provider"),U5=Symbol.for("react.context"),Qm=Symbol.for("react.forward_ref"),Cg=Symbol.for("react.suspense"),Tg=Symbol.for("react.suspense_list"),qm=Symbol.for("react.memo"),fs=Symbol.for("react.lazy"),j5=Symbol.for("react.offscreen"),v4=Symbol.iterator;function Dc(e){return e===null||typeof e!="object"?null:(e=v4&&e[v4]||e["@@iterator"],typeof e=="function"?e:null)}var nr=Object.assign,wp;function qc(e){if(wp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);wp=t&&t[1]||""}return`
`+wp+e}var kp=!1;function Ep(e,t){if(!e||kp)return"";kp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=o);break}}}finally{kp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qc(e):""}function Dk(e){switch(e.tag){case 5:return qc(e.type);case 16:return qc("Lazy");case 13:return qc("Suspense");case 19:return qc("SuspenseList");case 0:case 2:case 15:return e=Ep(e.type,!1),e;case 11:return e=Ep(e.type.render,!1),e;case 1:return e=Ep(e.type,!0),e;default:return""}}function Ag(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ml:return"Fragment";case gl:return"Portal";case Eg:return"Profiler";case Ym:return"StrictMode";case Cg:return"Suspense";case Tg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case U5:return(e.displayName||"Context")+".Consumer";case B5:return(e._context.displayName||"Context")+".Provider";case Qm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qm:return t=e.displayName||null,t!==null?t:Ag(e.type)||"Memo";case fs:t=e._payload,e=e._init;try{return Ag(e(t))}catch{}}return null}function Ok(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ag(t);case 8:return t===Ym?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function z5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bk(e){var t=z5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pf(e){e._valueTracker||(e._valueTracker=bk(e))}function V5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=z5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function id(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pg(e,t){var r=t.checked;return nr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function y4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ns(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function G5(e,t){t=t.checked,t!=null&&Km(e,"checked",t,!1)}function Fg(e,t){G5(e,t);var r=Ns(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ng(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ng(e,t.type,Ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ng(e,t,r){(t!=="number"||id(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jc=Array.isArray;function Pl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ns(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return nr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function S4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ie(92));if(Jc(r)){if(1<r.length)throw Error(Ie(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ns(r)}}function H5(e,t){var r=Ns(t.value),n=Ns(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function w4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ig(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gf,$5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gf=gf||document.createElement("div"),gf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function T0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var o0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lk=["Webkit","ms","Moz","O"];Object.keys(o0).forEach(function(e){Lk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),o0[t]=o0[e]})});function X5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||o0.hasOwnProperty(e)&&o0[e]?(""+t).trim():t+"px"}function K5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=X5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Mk=nr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dg(e,t){if(t){if(Mk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ie(62))}}function Og(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bg=null;function Jm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Lg=null,Fl=null,Nl=null;function k4(e){if(e=su(e)){if(typeof Lg!="function")throw Error(Ie(280));var t=e.stateNode;t&&(t=Zd(t),Lg(e.stateNode,e.type,t))}}function Y5(e){Fl?Nl?Nl.push(e):Nl=[e]:Fl=e}function Q5(){if(Fl){var e=Fl,t=Nl;if(Nl=Fl=null,k4(e),t)for(e=0;e<t.length;e++)k4(t[e])}}function q5(e,t){return e(t)}function J5(){}var Cp=!1;function Z5(e,t,r){if(Cp)return e(t,r);Cp=!0;try{return q5(e,t,r)}finally{Cp=!1,(Fl!==null||Nl!==null)&&(J5(),Q5())}}function A0(e,t){var r=e.stateNode;if(r===null)return null;var n=Zd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ie(231,t,typeof r));return r}var Mg=!1;if(ja)try{var Oc={};Object.defineProperty(Oc,"passive",{get:function(){Mg=!0}}),window.addEventListener("test",Oc,Oc),window.removeEventListener("test",Oc,Oc)}catch{Mg=!1}function Bk(e,t,r,n,i,a,s,o,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var l0=!1,ad=null,sd=!1,Bg=null,Uk={onError:function(e){l0=!0,ad=e}};function jk(e,t,r,n,i,a,s,o,u){l0=!1,ad=null,Bk.apply(Uk,arguments)}function zk(e,t,r,n,i,a,s,o,u){if(jk.apply(this,arguments),l0){if(l0){var f=ad;l0=!1,ad=null}else throw Error(Ie(198));sd||(sd=!0,Bg=f)}}function No(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function e_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function E4(e){if(No(e)!==e)throw Error(Ie(188))}function Vk(e){var t=e.alternate;if(!t){if(t=No(e),t===null)throw Error(Ie(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return E4(i),e;if(a===n)return E4(i),t;a=a.sibling}throw Error(Ie(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Ie(189))}}if(r.alternate!==n)throw Error(Ie(190))}if(r.tag!==3)throw Error(Ie(188));return r.stateNode.current===r?e:t}function t_(e){return e=Vk(e),e!==null?r_(e):null}function r_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=r_(e);if(t!==null)return t;e=e.sibling}return null}var n_=ei.unstable_scheduleCallback,C4=ei.unstable_cancelCallback,Gk=ei.unstable_shouldYield,Hk=ei.unstable_requestPaint,dr=ei.unstable_now,Wk=ei.unstable_getCurrentPriorityLevel,Zm=ei.unstable_ImmediatePriority,i_=ei.unstable_UserBlockingPriority,od=ei.unstable_NormalPriority,$k=ei.unstable_LowPriority,a_=ei.unstable_IdlePriority,Yd=null,da=null;function Xk(e){if(da&&typeof da.onCommitFiberRoot=="function")try{da.onCommitFiberRoot(Yd,e,void 0,(e.current.flags&128)===128)}catch{}}var Hi=Math.clz32?Math.clz32:Qk,Kk=Math.log,Yk=Math.LN2;function Qk(e){return e>>>=0,e===0?32:31-(Kk(e)/Yk|0)|0}var mf=64,xf=4194304;function Zc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ld(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=Zc(o):(a&=s,a!==0&&(n=Zc(a)))}else s=r&~i,s!==0?n=Zc(s):a!==0&&(n=Zc(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Hi(t),i=1<<r,n|=e[r],t&=~i;return n}function qk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Hi(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=qk(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}function Ug(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function s_(){var e=mf;return mf<<=1,!(mf&4194240)&&(mf=64),e}function Tp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function iu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hi(t),e[t]=r}function Zk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Hi(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function e2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Hi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Lt=0;function o_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var l_,t2,c_,u_,f_,jg=!1,vf=[],Ss=null,ws=null,ks=null,P0=new Map,F0=new Map,hs=[],e9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T4(e,t){switch(e){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":ks=null;break;case"pointerover":case"pointerout":P0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":F0.delete(t.pointerId)}}function bc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=su(t),t!==null&&t2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function t9(e,t,r,n,i){switch(t){case"focusin":return Ss=bc(Ss,e,t,r,n,i),!0;case"dragenter":return ws=bc(ws,e,t,r,n,i),!0;case"mouseover":return ks=bc(ks,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return P0.set(a,bc(P0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,F0.set(a,bc(F0.get(a)||null,e,t,r,n,i)),!0}return!1}function d_(e){var t=uo(e.target);if(t!==null){var r=No(t);if(r!==null){if(t=r.tag,t===13){if(t=e_(r),t!==null){e.blockedOn=t,f_(e.priority,function(){c_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $f(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=zg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);bg=n,r.target.dispatchEvent(n),bg=null}else return t=su(r),t!==null&&t2(t),e.blockedOn=r,!1;t.shift()}return!0}function A4(e,t,r){$f(e)&&r.delete(t)}function r9(){jg=!1,Ss!==null&&$f(Ss)&&(Ss=null),ws!==null&&$f(ws)&&(ws=null),ks!==null&&$f(ks)&&(ks=null),P0.forEach(A4),F0.forEach(A4)}function Lc(e,t){e.blockedOn===t&&(e.blockedOn=null,jg||(jg=!0,ei.unstable_scheduleCallback(ei.unstable_NormalPriority,r9)))}function N0(e){function t(i){return Lc(i,e)}if(0<vf.length){Lc(vf[0],e);for(var r=1;r<vf.length;r++){var n=vf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ss!==null&&Lc(Ss,e),ws!==null&&Lc(ws,e),ks!==null&&Lc(ks,e),P0.forEach(t),F0.forEach(t),r=0;r<hs.length;r++)n=hs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<hs.length&&(r=hs[0],r.blockedOn===null);)d_(r),r.blockedOn===null&&hs.shift()}var Rl=$a.ReactCurrentBatchConfig,cd=!0;function n9(e,t,r,n){var i=Lt,a=Rl.transition;Rl.transition=null;try{Lt=1,r2(e,t,r,n)}finally{Lt=i,Rl.transition=a}}function i9(e,t,r,n){var i=Lt,a=Rl.transition;Rl.transition=null;try{Lt=4,r2(e,t,r,n)}finally{Lt=i,Rl.transition=a}}function r2(e,t,r,n){if(cd){var i=zg(e,t,r,n);if(i===null)Lp(e,t,n,ud,r),T4(e,n);else if(t9(i,e,t,r,n))n.stopPropagation();else if(T4(e,n),t&4&&-1<e9.indexOf(e)){for(;i!==null;){var a=su(i);if(a!==null&&l_(a),a=zg(e,t,r,n),a===null&&Lp(e,t,n,ud,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Lp(e,t,n,null,r)}}var ud=null;function zg(e,t,r,n){if(ud=null,e=Jm(n),e=uo(e),e!==null)if(t=No(e),t===null)e=null;else if(r=t.tag,r===13){if(e=e_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ud=e,null}function h_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wk()){case Zm:return 1;case i_:return 4;case od:case $k:return 16;case a_:return 536870912;default:return 16}default:return 16}}var xs=null,n2=null,Xf=null;function p_(){if(Xf)return Xf;var e,t=n2,r=t.length,n,i="value"in xs?xs.value:xs.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return Xf=i.slice(e,1<n?1-n:void 0)}function Kf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yf(){return!0}function P4(){return!1}function ii(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?yf:P4,this.isPropagationStopped=P4,this}return nr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=yf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=yf)},persist:function(){},isPersistent:yf}),t}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i2=ii(tc),au=nr({},tc,{view:0,detail:0}),a9=ii(au),Ap,Pp,Mc,Qd=nr({},au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mc&&(Mc&&e.type==="mousemove"?(Ap=e.screenX-Mc.screenX,Pp=e.screenY-Mc.screenY):Pp=Ap=0,Mc=e),Ap)},movementY:function(e){return"movementY"in e?e.movementY:Pp}}),F4=ii(Qd),s9=nr({},Qd,{dataTransfer:0}),o9=ii(s9),l9=nr({},au,{relatedTarget:0}),Fp=ii(l9),c9=nr({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),u9=ii(c9),f9=nr({},tc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),d9=ii(f9),h9=nr({},tc,{data:0}),N4=ii(h9),p9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x9(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m9[e])?!!t[e]:!1}function a2(){return x9}var v9=nr({},au,{key:function(e){if(e.key){var t=p9[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Kf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a2,charCode:function(e){return e.type==="keypress"?Kf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),y9=ii(v9),_9=nr({},Qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R4=ii(_9),S9=nr({},au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a2}),w9=ii(S9),k9=nr({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),E9=ii(k9),C9=nr({},Qd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),T9=ii(C9),A9=[9,13,27,32],s2=ja&&"CompositionEvent"in window,c0=null;ja&&"documentMode"in document&&(c0=document.documentMode);var P9=ja&&"TextEvent"in window&&!c0,g_=ja&&(!s2||c0&&8<c0&&11>=c0),I4=String.fromCharCode(32),D4=!1;function m_(e,t){switch(e){case"keyup":return A9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function x_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xl=!1;function F9(e,t){switch(e){case"compositionend":return x_(t);case"keypress":return t.which!==32?null:(D4=!0,I4);case"textInput":return e=t.data,e===I4&&D4?null:e;default:return null}}function N9(e,t){if(xl)return e==="compositionend"||!s2&&m_(e,t)?(e=p_(),Xf=n2=xs=null,xl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return g_&&t.locale!=="ko"?null:t.data;default:return null}}var R9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!R9[e.type]:t==="textarea"}function v_(e,t,r,n){Y5(n),t=fd(t,"onChange"),0<t.length&&(r=new i2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var u0=null,R0=null;function I9(e){F_(e,0)}function qd(e){var t=_l(e);if(V5(t))return e}function D9(e,t){if(e==="change")return t}var y_=!1;if(ja){var Np;if(ja){var Rp="oninput"in document;if(!Rp){var b4=document.createElement("div");b4.setAttribute("oninput","return;"),Rp=typeof b4.oninput=="function"}Np=Rp}else Np=!1;y_=Np&&(!document.documentMode||9<document.documentMode)}function L4(){u0&&(u0.detachEvent("onpropertychange",__),R0=u0=null)}function __(e){if(e.propertyName==="value"&&qd(R0)){var t=[];v_(t,R0,e,Jm(e)),Z5(I9,t)}}function O9(e,t,r){e==="focusin"?(L4(),u0=t,R0=r,u0.attachEvent("onpropertychange",__)):e==="focusout"&&L4()}function b9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qd(R0)}function L9(e,t){if(e==="click")return qd(t)}function M9(e,t){if(e==="input"||e==="change")return qd(t)}function B9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yi=typeof Object.is=="function"?Object.is:B9;function I0(e,t){if(Yi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!kg.call(t,i)||!Yi(e[i],t[i]))return!1}return!0}function M4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function B4(e,t){var r=M4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=M4(r)}}function S_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?S_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function w_(){for(var e=window,t=id();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=id(e.document)}return t}function o2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function U9(e){var t=w_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&S_(r.ownerDocument.documentElement,r)){if(n!==null&&o2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=B4(r,a);var s=B4(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var j9=ja&&"documentMode"in document&&11>=document.documentMode,vl=null,Vg=null,f0=null,Gg=!1;function U4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gg||vl==null||vl!==id(n)||(n=vl,"selectionStart"in n&&o2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),f0&&I0(f0,n)||(f0=n,n=fd(Vg,"onSelect"),0<n.length&&(t=new i2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vl)))}function _f(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var yl={animationend:_f("Animation","AnimationEnd"),animationiteration:_f("Animation","AnimationIteration"),animationstart:_f("Animation","AnimationStart"),transitionend:_f("Transition","TransitionEnd")},Ip={},k_={};ja&&(k_=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function Jd(e){if(Ip[e])return Ip[e];if(!yl[e])return e;var t=yl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in k_)return Ip[e]=t[r];return e}var E_=Jd("animationend"),C_=Jd("animationiteration"),T_=Jd("animationstart"),A_=Jd("transitionend"),P_=new Map,j4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ls(e,t){P_.set(e,t),Fo(t,[e])}for(var Dp=0;Dp<j4.length;Dp++){var Op=j4[Dp],z9=Op.toLowerCase(),V9=Op[0].toUpperCase()+Op.slice(1);Ls(z9,"on"+V9)}Ls(E_,"onAnimationEnd");Ls(C_,"onAnimationIteration");Ls(T_,"onAnimationStart");Ls("dblclick","onDoubleClick");Ls("focusin","onFocus");Ls("focusout","onBlur");Ls(A_,"onTransitionEnd");Bl("onMouseEnter",["mouseout","mouseover"]);Bl("onMouseLeave",["mouseout","mouseover"]);Bl("onPointerEnter",["pointerout","pointerover"]);Bl("onPointerLeave",["pointerout","pointerover"]);Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var e0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G9=new Set("cancel close invalid load scroll toggle".split(" ").concat(e0));function z4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zk(n,t,void 0,e),e.currentTarget=null}function F_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,f=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;z4(i,o,f),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,f=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;z4(i,o,f),a=u}}}if(sd)throw e=Bg,sd=!1,Bg=null,e}function $t(e,t){var r=t[Kg];r===void 0&&(r=t[Kg]=new Set);var n=e+"__bubble";r.has(n)||(N_(t,e,2,!1),r.add(n))}function bp(e,t,r){var n=0;t&&(n|=4),N_(r,e,n,t)}var Sf="_reactListening"+Math.random().toString(36).slice(2);function D0(e){if(!e[Sf]){e[Sf]=!0,M5.forEach(function(r){r!=="selectionchange"&&(G9.has(r)||bp(r,!1,e),bp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Sf]||(t[Sf]=!0,bp("selectionchange",!1,t))}}function N_(e,t,r,n){switch(h_(t)){case 1:var i=n9;break;case 4:i=i9;break;default:i=r2}r=i.bind(null,t,r,e),i=void 0,!Mg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Lp(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=uo(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}Z5(function(){var f=a,d=Jm(r),p=[];e:{var m=P_.get(e);if(m!==void 0){var v=i2,g=e;switch(e){case"keypress":if(Kf(r)===0)break e;case"keydown":case"keyup":v=y9;break;case"focusin":g="focus",v=Fp;break;case"focusout":g="blur",v=Fp;break;case"beforeblur":case"afterblur":v=Fp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=F4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=o9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=w9;break;case E_:case C_:case T_:v=u9;break;case A_:v=E9;break;case"scroll":v=a9;break;case"wheel":v=T9;break;case"copy":case"cut":case"paste":v=d9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=R4}var _=(t&4)!==0,k=!_&&e==="scroll",E=_?m!==null?m+"Capture":null:m;_=[];for(var S=f,x;S!==null;){x=S;var C=x.stateNode;if(x.tag===5&&C!==null&&(x=C,E!==null&&(C=A0(S,E),C!=null&&_.push(O0(S,C,x)))),k)break;S=S.return}0<_.length&&(m=new v(m,g,null,r,d),p.push({event:m,listeners:_}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",m&&r!==bg&&(g=r.relatedTarget||r.fromElement)&&(uo(g)||g[za]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(g=r.relatedTarget||r.toElement,v=f,g=g?uo(g):null,g!==null&&(k=No(g),g!==k||g.tag!==5&&g.tag!==6)&&(g=null)):(v=null,g=f),v!==g)){if(_=F4,C="onMouseLeave",E="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(_=R4,C="onPointerLeave",E="onPointerEnter",S="pointer"),k=v==null?m:_l(v),x=g==null?m:_l(g),m=new _(C,S+"leave",v,r,d),m.target=k,m.relatedTarget=x,C=null,uo(d)===f&&(_=new _(E,S+"enter",g,r,d),_.target=x,_.relatedTarget=k,C=_),k=C,v&&g)t:{for(_=v,E=g,S=0,x=_;x;x=sl(x))S++;for(x=0,C=E;C;C=sl(C))x++;for(;0<S-x;)_=sl(_),S--;for(;0<x-S;)E=sl(E),x--;for(;S--;){if(_===E||E!==null&&_===E.alternate)break t;_=sl(_),E=sl(E)}_=null}else _=null;v!==null&&V4(p,m,v,_,!1),g!==null&&k!==null&&V4(p,k,g,_,!0)}}e:{if(m=f?_l(f):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var N=D9;else if(O4(m))if(y_)N=M9;else{N=b9;var T=O9}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(N=L9);if(N&&(N=N(e,f))){v_(p,N,r,d);break e}T&&T(e,m,f),e==="focusout"&&(T=m._wrapperState)&&T.controlled&&m.type==="number"&&Ng(m,"number",m.value)}switch(T=f?_l(f):window,e){case"focusin":(O4(T)||T.contentEditable==="true")&&(vl=T,Vg=f,f0=null);break;case"focusout":f0=Vg=vl=null;break;case"mousedown":Gg=!0;break;case"contextmenu":case"mouseup":case"dragend":Gg=!1,U4(p,r,d);break;case"selectionchange":if(j9)break;case"keydown":case"keyup":U4(p,r,d)}var F;if(s2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else xl?m_(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(g_&&r.locale!=="ko"&&(xl||P!=="onCompositionStart"?P==="onCompositionEnd"&&xl&&(F=p_()):(xs=d,n2="value"in xs?xs.value:xs.textContent,xl=!0)),T=fd(f,P),0<T.length&&(P=new N4(P,e,null,r,d),p.push({event:P,listeners:T}),F?P.data=F:(F=x_(r),F!==null&&(P.data=F)))),(F=P9?F9(e,r):N9(e,r))&&(f=fd(f,"onBeforeInput"),0<f.length&&(d=new N4("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:f}),d.data=F))}F_(p,t)})}function O0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function fd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=A0(e,r),a!=null&&n.unshift(O0(e,a,i)),a=A0(e,t),a!=null&&n.push(O0(e,a,i))),e=e.return}return n}function sl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V4(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,f=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&f!==null&&(o=f,i?(u=A0(r,a),u!=null&&s.unshift(O0(r,u,o))):i||(u=A0(r,a),u!=null&&s.push(O0(r,u,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var H9=/\r\n?/g,W9=/\u0000|\uFFFD/g;function G4(e){return(typeof e=="string"?e:""+e).replace(H9,`
`).replace(W9,"")}function wf(e,t,r){if(t=G4(t),G4(e)!==t&&r)throw Error(Ie(425))}function dd(){}var Hg=null,Wg=null;function $g(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xg=typeof setTimeout=="function"?setTimeout:void 0,$9=typeof clearTimeout=="function"?clearTimeout:void 0,H4=typeof Promise=="function"?Promise:void 0,X9=typeof queueMicrotask=="function"?queueMicrotask:typeof H4<"u"?function(e){return H4.resolve(null).then(e).catch(K9)}:Xg;function K9(e){setTimeout(function(){throw e})}function Mp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),N0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);N0(t)}function Es(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function W4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var rc=Math.random().toString(36).slice(2),ua="__reactFiber$"+rc,b0="__reactProps$"+rc,za="__reactContainer$"+rc,Kg="__reactEvents$"+rc,Y9="__reactListeners$"+rc,Q9="__reactHandles$"+rc;function uo(e){var t=e[ua];if(t)return t;for(var r=e.parentNode;r;){if(t=r[za]||r[ua]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=W4(e);e!==null;){if(r=e[ua])return r;e=W4(e)}return t}e=r,r=e.parentNode}return null}function su(e){return e=e[ua]||e[za],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _l(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ie(33))}function Zd(e){return e[b0]||null}var Yg=[],Sl=-1;function Ms(e){return{current:e}}function Xt(e){0>Sl||(e.current=Yg[Sl],Yg[Sl]=null,Sl--)}function Gt(e,t){Sl++,Yg[Sl]=e.current,e.current=t}var Rs={},gn=Ms(Rs),zn=Ms(!1),_o=Rs;function Ul(e,t){var r=e.type.contextTypes;if(!r)return Rs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vn(e){return e=e.childContextTypes,e!=null}function hd(){Xt(zn),Xt(gn)}function $4(e,t,r){if(gn.current!==Rs)throw Error(Ie(168));Gt(gn,t),Gt(zn,r)}function R_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ie(108,Ok(e)||"Unknown",i));return nr({},r,n)}function pd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rs,_o=gn.current,Gt(gn,e),Gt(zn,zn.current),!0}function X4(e,t,r){var n=e.stateNode;if(!n)throw Error(Ie(169));r?(e=R_(e,t,_o),n.__reactInternalMemoizedMergedChildContext=e,Xt(zn),Xt(gn),Gt(gn,e)):Xt(zn),Gt(zn,r)}var Ra=null,eh=!1,Bp=!1;function I_(e){Ra===null?Ra=[e]:Ra.push(e)}function q9(e){eh=!0,I_(e)}function Bs(){if(!Bp&&Ra!==null){Bp=!0;var e=0,t=Lt;try{var r=Ra;for(Lt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ra=null,eh=!1}catch(i){throw Ra!==null&&(Ra=Ra.slice(e+1)),n_(Zm,Bs),i}finally{Lt=t,Bp=!1}}return null}var wl=[],kl=0,gd=null,md=0,vi=[],yi=0,So=null,Da=1,Oa="";function so(e,t){wl[kl++]=md,wl[kl++]=gd,gd=e,md=t}function D_(e,t,r){vi[yi++]=Da,vi[yi++]=Oa,vi[yi++]=So,So=e;var n=Da;e=Oa;var i=32-Hi(n)-1;n&=~(1<<i),r+=1;var a=32-Hi(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Da=1<<32-Hi(t)+i|r<<i|n,Oa=a+e}else Da=1<<a|r<<i|n,Oa=e}function l2(e){e.return!==null&&(so(e,1),D_(e,1,0))}function c2(e){for(;e===gd;)gd=wl[--kl],wl[kl]=null,md=wl[--kl],wl[kl]=null;for(;e===So;)So=vi[--yi],vi[yi]=null,Oa=vi[--yi],vi[yi]=null,Da=vi[--yi],vi[yi]=null}var Zn=null,Jn=null,qt=!1,ji=null;function O_(e,t){var r=Si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function K4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=Es(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=So!==null?{id:Da,overflow:Oa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Zn=e,Jn=null,!0):!1;default:return!1}}function Qg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qg(e){if(qt){var t=Jn;if(t){var r=t;if(!K4(e,t)){if(Qg(e))throw Error(Ie(418));t=Es(r.nextSibling);var n=Zn;t&&K4(e,t)?O_(n,r):(e.flags=e.flags&-4097|2,qt=!1,Zn=e)}}else{if(Qg(e))throw Error(Ie(418));e.flags=e.flags&-4097|2,qt=!1,Zn=e}}}function Y4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zn=e}function kf(e){if(e!==Zn)return!1;if(!qt)return Y4(e),qt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$g(e.type,e.memoizedProps)),t&&(t=Jn)){if(Qg(e))throw b_(),Error(Ie(418));for(;t;)O_(e,t),t=Es(t.nextSibling)}if(Y4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Jn=Es(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Jn=null}}else Jn=Zn?Es(e.stateNode.nextSibling):null;return!0}function b_(){for(var e=Jn;e;)e=Es(e.nextSibling)}function jl(){Jn=Zn=null,qt=!1}function u2(e){ji===null?ji=[e]:ji.push(e)}var J9=$a.ReactCurrentBatchConfig;function Bc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ie(309));var n=r.stateNode}if(!n)throw Error(Ie(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ie(284));if(!r._owner)throw Error(Ie(290,e))}return e}function Ef(e,t){throw e=Object.prototype.toString.call(t),Error(Ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Q4(e){var t=e._init;return t(e._payload)}function L_(e){function t(E,S){if(e){var x=E.deletions;x===null?(E.deletions=[S],E.flags|=16):x.push(S)}}function r(E,S){if(!e)return null;for(;S!==null;)t(E,S),S=S.sibling;return null}function n(E,S){for(E=new Map;S!==null;)S.key!==null?E.set(S.key,S):E.set(S.index,S),S=S.sibling;return E}function i(E,S){return E=Ps(E,S),E.index=0,E.sibling=null,E}function a(E,S,x){return E.index=x,e?(x=E.alternate,x!==null?(x=x.index,x<S?(E.flags|=2,S):x):(E.flags|=2,S)):(E.flags|=1048576,S)}function s(E){return e&&E.alternate===null&&(E.flags|=2),E}function o(E,S,x,C){return S===null||S.tag!==6?(S=Wp(x,E.mode,C),S.return=E,S):(S=i(S,x),S.return=E,S)}function u(E,S,x,C){var N=x.type;return N===ml?d(E,S,x.props.children,C,x.key):S!==null&&(S.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===fs&&Q4(N)===S.type)?(C=i(S,x.props),C.ref=Bc(E,S,x),C.return=E,C):(C=td(x.type,x.key,x.props,null,E.mode,C),C.ref=Bc(E,S,x),C.return=E,C)}function f(E,S,x,C){return S===null||S.tag!==4||S.stateNode.containerInfo!==x.containerInfo||S.stateNode.implementation!==x.implementation?(S=$p(x,E.mode,C),S.return=E,S):(S=i(S,x.children||[]),S.return=E,S)}function d(E,S,x,C,N){return S===null||S.tag!==7?(S=xo(x,E.mode,C,N),S.return=E,S):(S=i(S,x),S.return=E,S)}function p(E,S,x){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Wp(""+S,E.mode,x),S.return=E,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hf:return x=td(S.type,S.key,S.props,null,E.mode,x),x.ref=Bc(E,null,S),x.return=E,x;case gl:return S=$p(S,E.mode,x),S.return=E,S;case fs:var C=S._init;return p(E,C(S._payload),x)}if(Jc(S)||Dc(S))return S=xo(S,E.mode,x,null),S.return=E,S;Ef(E,S)}return null}function m(E,S,x,C){var N=S!==null?S.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return N!==null?null:o(E,S,""+x,C);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case hf:return x.key===N?u(E,S,x,C):null;case gl:return x.key===N?f(E,S,x,C):null;case fs:return N=x._init,m(E,S,N(x._payload),C)}if(Jc(x)||Dc(x))return N!==null?null:d(E,S,x,C,null);Ef(E,x)}return null}function v(E,S,x,C,N){if(typeof C=="string"&&C!==""||typeof C=="number")return E=E.get(x)||null,o(S,E,""+C,N);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case hf:return E=E.get(C.key===null?x:C.key)||null,u(S,E,C,N);case gl:return E=E.get(C.key===null?x:C.key)||null,f(S,E,C,N);case fs:var T=C._init;return v(E,S,x,T(C._payload),N)}if(Jc(C)||Dc(C))return E=E.get(x)||null,d(S,E,C,N,null);Ef(S,C)}return null}function g(E,S,x,C){for(var N=null,T=null,F=S,P=S=0,I=null;F!==null&&P<x.length;P++){F.index>P?(I=F,F=null):I=F.sibling;var D=m(E,F,x[P],C);if(D===null){F===null&&(F=I);break}e&&F&&D.alternate===null&&t(E,F),S=a(D,S,P),T===null?N=D:T.sibling=D,T=D,F=I}if(P===x.length)return r(E,F),qt&&so(E,P),N;if(F===null){for(;P<x.length;P++)F=p(E,x[P],C),F!==null&&(S=a(F,S,P),T===null?N=F:T.sibling=F,T=F);return qt&&so(E,P),N}for(F=n(E,F);P<x.length;P++)I=v(F,E,P,x[P],C),I!==null&&(e&&I.alternate!==null&&F.delete(I.key===null?P:I.key),S=a(I,S,P),T===null?N=I:T.sibling=I,T=I);return e&&F.forEach(function(U){return t(E,U)}),qt&&so(E,P),N}function _(E,S,x,C){var N=Dc(x);if(typeof N!="function")throw Error(Ie(150));if(x=N.call(x),x==null)throw Error(Ie(151));for(var T=N=null,F=S,P=S=0,I=null,D=x.next();F!==null&&!D.done;P++,D=x.next()){F.index>P?(I=F,F=null):I=F.sibling;var U=m(E,F,D.value,C);if(U===null){F===null&&(F=I);break}e&&F&&U.alternate===null&&t(E,F),S=a(U,S,P),T===null?N=U:T.sibling=U,T=U,F=I}if(D.done)return r(E,F),qt&&so(E,P),N;if(F===null){for(;!D.done;P++,D=x.next())D=p(E,D.value,C),D!==null&&(S=a(D,S,P),T===null?N=D:T.sibling=D,T=D);return qt&&so(E,P),N}for(F=n(E,F);!D.done;P++,D=x.next())D=v(F,E,P,D.value,C),D!==null&&(e&&D.alternate!==null&&F.delete(D.key===null?P:D.key),S=a(D,S,P),T===null?N=D:T.sibling=D,T=D);return e&&F.forEach(function(b){return t(E,b)}),qt&&so(E,P),N}function k(E,S,x,C){if(typeof x=="object"&&x!==null&&x.type===ml&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case hf:e:{for(var N=x.key,T=S;T!==null;){if(T.key===N){if(N=x.type,N===ml){if(T.tag===7){r(E,T.sibling),S=i(T,x.props.children),S.return=E,E=S;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===fs&&Q4(N)===T.type){r(E,T.sibling),S=i(T,x.props),S.ref=Bc(E,T,x),S.return=E,E=S;break e}r(E,T);break}else t(E,T);T=T.sibling}x.type===ml?(S=xo(x.props.children,E.mode,C,x.key),S.return=E,E=S):(C=td(x.type,x.key,x.props,null,E.mode,C),C.ref=Bc(E,S,x),C.return=E,E=C)}return s(E);case gl:e:{for(T=x.key;S!==null;){if(S.key===T)if(S.tag===4&&S.stateNode.containerInfo===x.containerInfo&&S.stateNode.implementation===x.implementation){r(E,S.sibling),S=i(S,x.children||[]),S.return=E,E=S;break e}else{r(E,S);break}else t(E,S);S=S.sibling}S=$p(x,E.mode,C),S.return=E,E=S}return s(E);case fs:return T=x._init,k(E,S,T(x._payload),C)}if(Jc(x))return g(E,S,x,C);if(Dc(x))return _(E,S,x,C);Ef(E,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,S!==null&&S.tag===6?(r(E,S.sibling),S=i(S,x),S.return=E,E=S):(r(E,S),S=Wp(x,E.mode,C),S.return=E,E=S),s(E)):r(E,S)}return k}var zl=L_(!0),M_=L_(!1),xd=Ms(null),vd=null,El=null,f2=null;function d2(){f2=El=vd=null}function h2(e){var t=xd.current;Xt(xd),e._currentValue=t}function Jg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Il(e,t){vd=e,f2=El=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(jn=!0),e.firstContext=null)}function ki(e){var t=e._currentValue;if(f2!==e)if(e={context:e,memoizedValue:t,next:null},El===null){if(vd===null)throw Error(Ie(308));El=e,vd.dependencies={lanes:0,firstContext:e}}else El=El.next=e;return t}var fo=null;function p2(e){fo===null?fo=[e]:fo.push(e)}function B_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,p2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Va(e,n)}function Va(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ds=!1;function g2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function La(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Tt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Va(e,r)}return i=n.interleaved,i===null?(t.next=t,p2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Va(e,r)}function Yf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e2(e,r)}}function q4(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function yd(e,t,r,n){var i=e.updateQueue;ds=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,f=u.next;u.next=null,s===null?a=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=f:o.next=f,d.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;s=0,d=f=u=null,o=a;do{var m=o.lane,v=o.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,_=o;switch(m=t,v=r,_.tag){case 1:if(g=_.payload,typeof g=="function"){p=g.call(v,p,m);break e}p=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=_.payload,m=typeof g=="function"?g.call(v,p,m):g,m==null)break e;p=nr({},p,m);break e;case 2:ds=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else v={eventTime:v,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(f=d=v,u=p):d=d.next=v,s|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ko|=s,e.lanes=s,e.memoizedState=p}}function J4(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ie(191,i));i.call(n)}}}var ou={},ha=Ms(ou),L0=Ms(ou),M0=Ms(ou);function ho(e){if(e===ou)throw Error(Ie(174));return e}function m2(e,t){switch(Gt(M0,t),Gt(L0,e),Gt(ha,ou),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ig(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ig(t,e)}Xt(ha),Gt(ha,t)}function Vl(){Xt(ha),Xt(L0),Xt(M0)}function j_(e){ho(M0.current);var t=ho(ha.current),r=Ig(t,e.type);t!==r&&(Gt(L0,e),Gt(ha,r))}function x2(e){L0.current===e&&(Xt(ha),Xt(L0))}var tr=Ms(0);function _d(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Up=[];function v2(){for(var e=0;e<Up.length;e++)Up[e]._workInProgressVersionPrimary=null;Up.length=0}var Qf=$a.ReactCurrentDispatcher,jp=$a.ReactCurrentBatchConfig,wo=0,rr=null,Pr=null,Vr=null,Sd=!1,d0=!1,B0=0,Z9=0;function on(){throw Error(Ie(321))}function y2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yi(e[r],t[r]))return!1;return!0}function _2(e,t,r,n,i,a){if(wo=a,rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qf.current=e===null||e.memoizedState===null?nE:iE,e=r(n,i),d0){a=0;do{if(d0=!1,B0=0,25<=a)throw Error(Ie(301));a+=1,Vr=Pr=null,t.updateQueue=null,Qf.current=aE,e=r(n,i)}while(d0)}if(Qf.current=wd,t=Pr!==null&&Pr.next!==null,wo=0,Vr=Pr=rr=null,Sd=!1,t)throw Error(Ie(300));return e}function S2(){var e=B0!==0;return B0=0,e}function ca(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vr===null?rr.memoizedState=Vr=e:Vr=Vr.next=e,Vr}function Ei(){if(Pr===null){var e=rr.alternate;e=e!==null?e.memoizedState:null}else e=Pr.next;var t=Vr===null?rr.memoizedState:Vr.next;if(t!==null)Vr=t,Pr=e;else{if(e===null)throw Error(Ie(310));Pr=e,e={memoizedState:Pr.memoizedState,baseState:Pr.baseState,baseQueue:Pr.baseQueue,queue:Pr.queue,next:null},Vr===null?rr.memoizedState=Vr=e:Vr=Vr.next=e}return Vr}function U0(e,t){return typeof t=="function"?t(e):t}function zp(e){var t=Ei(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=Pr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,f=a;do{var d=f.lane;if((wo&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(o=u=p,s=n):u=u.next=p,rr.lanes|=d,ko|=d}f=f.next}while(f!==null&&f!==a);u===null?s=n:u.next=o,Yi(n,t.memoizedState)||(jn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,rr.lanes|=a,ko|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vp(e){var t=Ei(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Yi(a,t.memoizedState)||(jn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function z_(){}function V_(e,t){var r=rr,n=Ei(),i=t(),a=!Yi(n.memoizedState,i);if(a&&(n.memoizedState=i,jn=!0),n=n.queue,w2(W_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Vr!==null&&Vr.memoizedState.tag&1){if(r.flags|=2048,j0(9,H_.bind(null,r,n,i,t),void 0,null),Gr===null)throw Error(Ie(349));wo&30||G_(r,t,i)}return i}function G_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function H_(e,t,r,n){t.value=r,t.getSnapshot=n,$_(t)&&X_(e)}function W_(e,t,r){return r(function(){$_(t)&&X_(e)})}function $_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yi(e,r)}catch{return!0}}function X_(e){var t=Va(e,1);t!==null&&Wi(t,e,1,-1)}function Z4(e){var t=ca();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:U0,lastRenderedState:e},t.queue=e,e=e.dispatch=rE.bind(null,rr,e),[t.memoizedState,e]}function j0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function K_(){return Ei().memoizedState}function qf(e,t,r,n){var i=ca();rr.flags|=e,i.memoizedState=j0(1|t,r,void 0,n===void 0?null:n)}function th(e,t,r,n){var i=Ei();n=n===void 0?null:n;var a=void 0;if(Pr!==null){var s=Pr.memoizedState;if(a=s.destroy,n!==null&&y2(n,s.deps)){i.memoizedState=j0(t,r,a,n);return}}rr.flags|=e,i.memoizedState=j0(1|t,r,a,n)}function ey(e,t){return qf(8390656,8,e,t)}function w2(e,t){return th(2048,8,e,t)}function Y_(e,t){return th(4,2,e,t)}function Q_(e,t){return th(4,4,e,t)}function q_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function J_(e,t,r){return r=r!=null?r.concat([e]):null,th(4,4,q_.bind(null,t,e),r)}function k2(){}function Z_(e,t){var r=Ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function e6(e,t){var r=Ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function t6(e,t,r){return wo&21?(Yi(r,t)||(r=s_(),rr.lanes|=r,ko|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,jn=!0),e.memoizedState=r)}function eE(e,t){var r=Lt;Lt=r!==0&&4>r?r:4,e(!0);var n=jp.transition;jp.transition={};try{e(!1),t()}finally{Lt=r,jp.transition=n}}function r6(){return Ei().memoizedState}function tE(e,t,r){var n=As(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},n6(e))i6(t,r);else if(r=B_(e,t,r,n),r!==null){var i=An();Wi(r,e,n,i),a6(r,t,n)}}function rE(e,t,r){var n=As(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(n6(e))i6(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Yi(o,s)){var u=t.interleaved;u===null?(i.next=i,p2(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=B_(e,t,i,n),r!==null&&(i=An(),Wi(r,e,n,i),a6(r,t,n))}}function n6(e){var t=e.alternate;return e===rr||t!==null&&t===rr}function i6(e,t){d0=Sd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function a6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e2(e,r)}}var wd={readContext:ki,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useInsertionEffect:on,useLayoutEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useMutableSource:on,useSyncExternalStore:on,useId:on,unstable_isNewReconciler:!1},nE={readContext:ki,useCallback:function(e,t){return ca().memoizedState=[e,t===void 0?null:t],e},useContext:ki,useEffect:ey,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,qf(4194308,4,q_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return qf(4194308,4,e,t)},useInsertionEffect:function(e,t){return qf(4,2,e,t)},useMemo:function(e,t){var r=ca();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ca();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tE.bind(null,rr,e),[n.memoizedState,e]},useRef:function(e){var t=ca();return e={current:e},t.memoizedState=e},useState:Z4,useDebugValue:k2,useDeferredValue:function(e){return ca().memoizedState=e},useTransition:function(){var e=Z4(!1),t=e[0];return e=eE.bind(null,e[1]),ca().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rr,i=ca();if(qt){if(r===void 0)throw Error(Ie(407));r=r()}else{if(r=t(),Gr===null)throw Error(Ie(349));wo&30||G_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,ey(W_.bind(null,n,a,e),[e]),n.flags|=2048,j0(9,H_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ca(),t=Gr.identifierPrefix;if(qt){var r=Oa,n=Da;r=(n&~(1<<32-Hi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=B0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Z9++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iE={readContext:ki,useCallback:Z_,useContext:ki,useEffect:w2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:zp,useRef:K_,useState:function(){return zp(U0)},useDebugValue:k2,useDeferredValue:function(e){var t=Ei();return t6(t,Pr.memoizedState,e)},useTransition:function(){var e=zp(U0)[0],t=Ei().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1},aE={readContext:ki,useCallback:Z_,useContext:ki,useEffect:w2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:Vp,useRef:K_,useState:function(){return Vp(U0)},useDebugValue:k2,useDeferredValue:function(e){var t=Ei();return Pr===null?t.memoizedState=e:t6(t,Pr.memoizedState,e)},useTransition:function(){var e=Vp(U0)[0],t=Ei().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1};function Bi(e,t){if(e&&e.defaultProps){t=nr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Zg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var rh={isMounted:function(e){return(e=e._reactInternals)?No(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=An(),i=As(e),a=La(n,i);a.payload=t,r!=null&&(a.callback=r),t=Cs(e,a,i),t!==null&&(Wi(t,e,i,n),Yf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=An(),i=As(e),a=La(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Cs(e,a,i),t!==null&&(Wi(t,e,i,n),Yf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=An(),n=As(e),i=La(r,n);i.tag=2,t!=null&&(i.callback=t),t=Cs(e,i,n),t!==null&&(Wi(t,e,n,r),Yf(t,e,n))}};function ty(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!I0(r,n)||!I0(i,a):!0}function s6(e,t,r){var n=!1,i=Rs,a=t.contextType;return typeof a=="object"&&a!==null?a=ki(a):(i=Vn(t)?_o:gn.current,n=t.contextTypes,a=(n=n!=null)?Ul(e,i):Rs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=rh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ry(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&rh.enqueueReplaceState(t,t.state,null)}function em(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},g2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=ki(a):(a=Vn(t)?_o:gn.current,i.context=Ul(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Zg(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&rh.enqueueReplaceState(i,i.state,null),yd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Gl(e,t){try{var r="",n=t;do r+=Dk(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Gp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function tm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sE=typeof WeakMap=="function"?WeakMap:Map;function o6(e,t,r){r=La(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ed||(Ed=!0,fm=n),tm(e,t)},r}function l6(e,t,r){r=La(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){tm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){tm(e,t),typeof n!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function ny(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sE;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_E.bind(null,e,t,r),t.then(e,e))}function iy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ay(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=La(-1,1),t.tag=2,Cs(r,t,1))),r.lanes|=1),e)}var oE=$a.ReactCurrentOwner,jn=!1;function wn(e,t,r,n){t.child=e===null?M_(t,null,r,n):zl(t,e.child,r,n)}function sy(e,t,r,n,i){r=r.render;var a=t.ref;return Il(t,i),n=_2(e,t,r,n,a,i),r=S2(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i)):(qt&&r&&l2(t),t.flags|=1,wn(e,t,n,i),t.child)}function oy(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!R2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,c6(e,t,a,n,i)):(e=td(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:I0,r(s,n)&&e.ref===t.ref)return Ga(e,t,i)}return t.flags|=1,e=Ps(a,n),e.ref=t.ref,e.return=t,t.child=e}function c6(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(I0(a,n)&&e.ref===t.ref)if(jn=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(jn=!0);else return t.lanes=e.lanes,Ga(e,t,i)}return rm(e,t,r,n,i)}function u6(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Tl,Yn),Yn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Gt(Tl,Yn),Yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Gt(Tl,Yn),Yn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Gt(Tl,Yn),Yn|=n;return wn(e,t,i,r),t.child}function f6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function rm(e,t,r,n,i){var a=Vn(r)?_o:gn.current;return a=Ul(t,a),Il(t,i),r=_2(e,t,r,n,a,i),n=S2(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i)):(qt&&n&&l2(t),t.flags|=1,wn(e,t,r,i),t.child)}function ly(e,t,r,n,i){if(Vn(r)){var a=!0;pd(t)}else a=!1;if(Il(t,i),t.stateNode===null)Jf(e,t),s6(t,r,n),em(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=ki(f):(f=Vn(r)?_o:gn.current,f=Ul(t,f));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==f)&&ry(t,s,n,f),ds=!1;var m=t.memoizedState;s.state=m,yd(t,n,s,i),u=t.memoizedState,o!==n||m!==u||zn.current||ds?(typeof d=="function"&&(Zg(t,r,d,n),u=t.memoizedState),(o=ds||ty(t,r,o,n,m,u,f))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=f,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,U_(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:Bi(t.type,o),s.props=f,p=t.pendingProps,m=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=ki(u):(u=Vn(r)?_o:gn.current,u=Ul(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==p||m!==u)&&ry(t,s,n,u),ds=!1,m=t.memoizedState,s.state=m,yd(t,n,s,i);var g=t.memoizedState;o!==p||m!==g||zn.current||ds?(typeof v=="function"&&(Zg(t,r,v,n),g=t.memoizedState),(f=ds||ty(t,r,f,n,m,g,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),s.props=n,s.state=g,s.context=u,n=f):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return nm(e,t,r,n,a,i)}function nm(e,t,r,n,i,a){f6(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&X4(t,r,!1),Ga(e,t,a);n=t.stateNode,oE.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=zl(t,e.child,null,a),t.child=zl(t,null,o,a)):wn(e,t,o,a),t.memoizedState=n.state,i&&X4(t,r,!0),t.child}function d6(e){var t=e.stateNode;t.pendingContext?$4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$4(e,t.context,!1),m2(e,t.containerInfo)}function cy(e,t,r,n,i){return jl(),u2(i),t.flags|=256,wn(e,t,r,n),t.child}var im={dehydrated:null,treeContext:null,retryLane:0};function am(e){return{baseLanes:e,cachePool:null,transitions:null}}function h6(e,t,r){var n=t.pendingProps,i=tr.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Gt(tr,i&1),e===null)return qg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=ah(s,n,0,null),e=xo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=am(r),t.memoizedState=im,e):E2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lE(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ps(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Ps(o,a):(a=xo(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?am(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=im,n}return a=e.child,e=a.sibling,n=Ps(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function E2(e,t){return t=ah({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cf(e,t,r,n){return n!==null&&u2(n),zl(t,e.child,null,r),e=E2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lE(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=Gp(Error(Ie(422))),Cf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=ah({mode:"visible",children:n.children},i,0,null),a=xo(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&zl(t,e.child,null,s),t.child.memoizedState=am(s),t.memoizedState=im,a);if(!(t.mode&1))return Cf(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Ie(419)),n=Gp(a,n,void 0),Cf(e,t,s,n)}if(o=(s&e.childLanes)!==0,jn||o){if(n=Gr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Va(e,i),Wi(n,e,i,-1))}return N2(),n=Gp(Error(Ie(421))),Cf(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=SE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Jn=Es(i.nextSibling),Zn=t,qt=!0,ji=null,e!==null&&(vi[yi++]=Da,vi[yi++]=Oa,vi[yi++]=So,Da=e.id,Oa=e.overflow,So=t),t=E2(t,n.children),t.flags|=4096,t)}function uy(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Jg(e.return,t,r)}function Hp(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function p6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wn(e,t,n.children,r),n=tr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uy(e,r,t);else if(e.tag===19)uy(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Gt(tr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&_d(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Hp(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&_d(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Hp(t,!0,r,null,a);break;case"together":Hp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ko|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ie(153));if(t.child!==null){for(e=t.child,r=Ps(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ps(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cE(e,t,r){switch(t.tag){case 3:d6(t),jl();break;case 5:j_(t);break;case 1:Vn(t.type)&&pd(t);break;case 4:m2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Gt(xd,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Gt(tr,tr.current&1),t.flags|=128,null):r&t.child.childLanes?h6(e,t,r):(Gt(tr,tr.current&1),e=Ga(e,t,r),e!==null?e.sibling:null);Gt(tr,tr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return p6(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Gt(tr,tr.current),n)break;return null;case 22:case 23:return t.lanes=0,u6(e,t,r)}return Ga(e,t,r)}var g6,sm,m6,x6;g6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};sm=function(){};m6=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ho(ha.current);var a=null;switch(r){case"input":i=Pg(e,i),n=Pg(e,n),a=[];break;case"select":i=nr({},i,{value:void 0}),n=nr({},n,{value:void 0}),a=[];break;case"textarea":i=Rg(e,i),n=Rg(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=dd)}Dg(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var o=i[f];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(C0.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(o=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==o&&(u!=null||o!=null))if(f==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(C0.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&$t("scroll",e),a||o===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};x6=function(e,t,r,n){r!==n&&(t.flags|=4)};function Uc(e,t){if(!qt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ln(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uE(e,t,r){var n=t.pendingProps;switch(c2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(t),null;case 1:return Vn(t.type)&&hd(),ln(t),null;case 3:return n=t.stateNode,Vl(),Xt(zn),Xt(gn),v2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(kf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ji!==null&&(pm(ji),ji=null))),sm(e,t),ln(t),null;case 5:x2(t);var i=ho(M0.current);if(r=t.type,e!==null&&t.stateNode!=null)m6(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ie(166));return ln(t),null}if(e=ho(ha.current),kf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ua]=t,n[b0]=a,e=(t.mode&1)!==0,r){case"dialog":$t("cancel",n),$t("close",n);break;case"iframe":case"object":case"embed":$t("load",n);break;case"video":case"audio":for(i=0;i<e0.length;i++)$t(e0[i],n);break;case"source":$t("error",n);break;case"img":case"image":case"link":$t("error",n),$t("load",n);break;case"details":$t("toggle",n);break;case"input":y4(n,a),$t("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},$t("invalid",n);break;case"textarea":S4(n,a),$t("invalid",n)}Dg(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&wf(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&wf(n.textContent,o,e),i=["children",""+o]):C0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&$t("scroll",n)}switch(r){case"input":pf(n),_4(n,a,!0);break;case"textarea":pf(n),w4(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=dd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[ua]=t,e[b0]=n,g6(e,t,!1,!1),t.stateNode=e;e:{switch(s=Og(r,n),r){case"dialog":$t("cancel",e),$t("close",e),i=n;break;case"iframe":case"object":case"embed":$t("load",e),i=n;break;case"video":case"audio":for(i=0;i<e0.length;i++)$t(e0[i],e);i=n;break;case"source":$t("error",e),i=n;break;case"img":case"image":case"link":$t("error",e),$t("load",e),i=n;break;case"details":$t("toggle",e),i=n;break;case"input":y4(e,n),i=Pg(e,n),$t("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=nr({},n,{value:void 0}),$t("invalid",e);break;case"textarea":S4(e,n),i=Rg(e,n),$t("invalid",e);break;default:i=n}Dg(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?K5(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$5(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&T0(e,u):typeof u=="number"&&T0(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(C0.hasOwnProperty(a)?u!=null&&a==="onScroll"&&$t("scroll",e):u!=null&&Km(e,a,u,s))}switch(r){case"input":pf(e),_4(e,n,!1);break;case"textarea":pf(e),w4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ns(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Pl(e,!!n.multiple,a,!1):n.defaultValue!=null&&Pl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=dd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ln(t),null;case 6:if(e&&t.stateNode!=null)x6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ie(166));if(r=ho(M0.current),ho(ha.current),kf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ua]=t,(a=n.nodeValue!==r)&&(e=Zn,e!==null))switch(e.tag){case 3:wf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ua]=t,t.stateNode=n}return ln(t),null;case 13:if(Xt(tr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qt&&Jn!==null&&t.mode&1&&!(t.flags&128))b_(),jl(),t.flags|=98560,a=!1;else if(a=kf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ie(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ie(317));a[ua]=t}else jl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ln(t),a=!1}else ji!==null&&(pm(ji),ji=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tr.current&1?Fr===0&&(Fr=3):N2())),t.updateQueue!==null&&(t.flags|=4),ln(t),null);case 4:return Vl(),sm(e,t),e===null&&D0(t.stateNode.containerInfo),ln(t),null;case 10:return h2(t.type._context),ln(t),null;case 17:return Vn(t.type)&&hd(),ln(t),null;case 19:if(Xt(tr),a=t.memoizedState,a===null)return ln(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)Uc(a,!1);else{if(Fr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=_d(e),s!==null){for(t.flags|=128,Uc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Gt(tr,tr.current&1|2),t.child}e=e.sibling}a.tail!==null&&dr()>Hl&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304)}else{if(!n)if(e=_d(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!qt)return ln(t),null}else 2*dr()-a.renderingStartTime>Hl&&r!==1073741824&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=dr(),t.sibling=null,r=tr.current,Gt(tr,n?r&1|2:r&1),t):(ln(t),null);case 22:case 23:return F2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yn&1073741824&&(ln(t),t.subtreeFlags&6&&(t.flags|=8192)):ln(t),null;case 24:return null;case 25:return null}throw Error(Ie(156,t.tag))}function fE(e,t){switch(c2(t),t.tag){case 1:return Vn(t.type)&&hd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Vl(),Xt(zn),Xt(gn),v2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x2(t),null;case 13:if(Xt(tr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ie(340));jl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xt(tr),null;case 4:return Vl(),null;case 10:return h2(t.type._context),null;case 22:case 23:return F2(),null;case 24:return null;default:return null}}var Tf=!1,fn=!1,dE=typeof WeakSet=="function"?WeakSet:Set,We=null;function Cl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ar(e,t,n)}else r.current=null}function om(e,t,r){try{r()}catch(n){ar(e,t,n)}}var fy=!1;function hE(e,t){if(Hg=cd,e=w_(),o2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,f=0,d=0,p=e,m=null;t:for(;;){for(var v;p!==r||i!==0&&p.nodeType!==3||(o=s+i),p!==a||n!==0&&p.nodeType!==3||(u=s+n),p.nodeType===3&&(s+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===e)break t;if(m===r&&++f===i&&(o=s),m===a&&++d===n&&(u=s),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Wg={focusedElem:e,selectionRange:r},cd=!1,We=t;We!==null;)if(t=We,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,We=e;else for(;We!==null;){t=We;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var _=g.memoizedProps,k=g.memoizedState,E=t.stateNode,S=E.getSnapshotBeforeUpdate(t.elementType===t.type?_:Bi(t.type,_),k);E.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(C){ar(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,We=e;break}We=t.return}return g=fy,fy=!1,g}function h0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&om(t,r,a)}i=i.next}while(i!==n)}}function nh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function lm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function v6(e){var t=e.alternate;t!==null&&(e.alternate=null,v6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ua],delete t[b0],delete t[Kg],delete t[Y9],delete t[Q9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function y6(e){return e.tag===5||e.tag===3||e.tag===4}function dy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||y6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=dd));else if(n!==4&&(e=e.child,e!==null))for(cm(e,t,r),e=e.sibling;e!==null;)cm(e,t,r),e=e.sibling}function um(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(um(e,t,r),e=e.sibling;e!==null;)um(e,t,r),e=e.sibling}var Xr=null,Ui=!1;function os(e,t,r){for(r=r.child;r!==null;)_6(e,t,r),r=r.sibling}function _6(e,t,r){if(da&&typeof da.onCommitFiberUnmount=="function")try{da.onCommitFiberUnmount(Yd,r)}catch{}switch(r.tag){case 5:fn||Cl(r,t);case 6:var n=Xr,i=Ui;Xr=null,os(e,t,r),Xr=n,Ui=i,Xr!==null&&(Ui?(e=Xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Xr.removeChild(r.stateNode));break;case 18:Xr!==null&&(Ui?(e=Xr,r=r.stateNode,e.nodeType===8?Mp(e.parentNode,r):e.nodeType===1&&Mp(e,r),N0(e)):Mp(Xr,r.stateNode));break;case 4:n=Xr,i=Ui,Xr=r.stateNode.containerInfo,Ui=!0,os(e,t,r),Xr=n,Ui=i;break;case 0:case 11:case 14:case 15:if(!fn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&om(r,t,s),i=i.next}while(i!==n)}os(e,t,r);break;case 1:if(!fn&&(Cl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){ar(r,t,o)}os(e,t,r);break;case 21:os(e,t,r);break;case 22:r.mode&1?(fn=(n=fn)||r.memoizedState!==null,os(e,t,r),fn=n):os(e,t,r);break;default:os(e,t,r)}}function hy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dE),t.forEach(function(n){var i=wE.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Oi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Xr=o.stateNode,Ui=!1;break e;case 3:Xr=o.stateNode.containerInfo,Ui=!0;break e;case 4:Xr=o.stateNode.containerInfo,Ui=!0;break e}o=o.return}if(Xr===null)throw Error(Ie(160));_6(a,s,i),Xr=null,Ui=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){ar(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)S6(t,e),t=t.sibling}function S6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Oi(t,e),aa(e),n&4){try{h0(3,e,e.return),nh(3,e)}catch(_){ar(e,e.return,_)}try{h0(5,e,e.return)}catch(_){ar(e,e.return,_)}}break;case 1:Oi(t,e),aa(e),n&512&&r!==null&&Cl(r,r.return);break;case 5:if(Oi(t,e),aa(e),n&512&&r!==null&&Cl(r,r.return),e.flags&32){var i=e.stateNode;try{T0(i,"")}catch(_){ar(e,e.return,_)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&G5(i,a),Og(o,s);var f=Og(o,a);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];d==="style"?K5(i,p):d==="dangerouslySetInnerHTML"?$5(i,p):d==="children"?T0(i,p):Km(i,d,p,f)}switch(o){case"input":Fg(i,a);break;case"textarea":H5(i,a);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Pl(i,!!a.multiple,v,!1):m!==!!a.multiple&&(a.defaultValue!=null?Pl(i,!!a.multiple,a.defaultValue,!0):Pl(i,!!a.multiple,a.multiple?[]:"",!1))}i[b0]=a}catch(_){ar(e,e.return,_)}}break;case 6:if(Oi(t,e),aa(e),n&4){if(e.stateNode===null)throw Error(Ie(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(_){ar(e,e.return,_)}}break;case 3:if(Oi(t,e),aa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{N0(t.containerInfo)}catch(_){ar(e,e.return,_)}break;case 4:Oi(t,e),aa(e);break;case 13:Oi(t,e),aa(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(A2=dr())),n&4&&hy(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(fn=(f=fn)||d,Oi(t,e),fn=f):Oi(t,e),aa(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for(We=e,d=e.child;d!==null;){for(p=We=d;We!==null;){switch(m=We,v=m.child,m.tag){case 0:case 11:case 14:case 15:h0(4,m,m.return);break;case 1:Cl(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(_){ar(n,r,_)}}break;case 5:Cl(m,m.return);break;case 22:if(m.memoizedState!==null){gy(p);continue}}v!==null?(v.return=m,We=v):gy(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,u=p.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=X5("display",s))}catch(_){ar(e,e.return,_)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(_){ar(e,e.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Oi(t,e),aa(e),n&4&&hy(e);break;case 21:break;default:Oi(t,e),aa(e)}}function aa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(y6(r)){var n=r;break e}r=r.return}throw Error(Ie(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(T0(i,""),n.flags&=-33);var a=dy(e);um(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=dy(e);cm(e,o,s);break;default:throw Error(Ie(161))}}catch(u){ar(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pE(e,t,r){We=e,w6(e)}function w6(e,t,r){for(var n=(e.mode&1)!==0;We!==null;){var i=We,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Tf;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||fn;o=Tf;var f=fn;if(Tf=s,(fn=u)&&!f)for(We=i;We!==null;)s=We,u=s.child,s.tag===22&&s.memoizedState!==null?my(i):u!==null?(u.return=s,We=u):my(i);for(;a!==null;)We=a,w6(a),a=a.sibling;We=i,Tf=o,fn=f}py(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,We=a):py(e)}}function py(e){for(;We!==null;){var t=We;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:fn||nh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!fn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Bi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&J4(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}J4(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&N0(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}fn||t.flags&512&&lm(t)}catch(m){ar(t,t.return,m)}}if(t===e){We=null;break}if(r=t.sibling,r!==null){r.return=t.return,We=r;break}We=t.return}}function gy(e){for(;We!==null;){var t=We;if(t===e){We=null;break}var r=t.sibling;if(r!==null){r.return=t.return,We=r;break}We=t.return}}function my(e){for(;We!==null;){var t=We;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nh(4,t)}catch(u){ar(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){ar(t,i,u)}}var a=t.return;try{lm(t)}catch(u){ar(t,a,u)}break;case 5:var s=t.return;try{lm(t)}catch(u){ar(t,s,u)}}}catch(u){ar(t,t.return,u)}if(t===e){We=null;break}var o=t.sibling;if(o!==null){o.return=t.return,We=o;break}We=t.return}}var gE=Math.ceil,kd=$a.ReactCurrentDispatcher,C2=$a.ReactCurrentOwner,wi=$a.ReactCurrentBatchConfig,Tt=0,Gr=null,wr=null,Yr=0,Yn=0,Tl=Ms(0),Fr=0,z0=null,ko=0,ih=0,T2=0,p0=null,Un=null,A2=0,Hl=1/0,Fa=null,Ed=!1,fm=null,Ts=null,Af=!1,vs=null,Cd=0,g0=0,dm=null,Zf=-1,ed=0;function An(){return Tt&6?dr():Zf!==-1?Zf:Zf=dr()}function As(e){return e.mode&1?Tt&2&&Yr!==0?Yr&-Yr:J9.transition!==null?(ed===0&&(ed=s_()),ed):(e=Lt,e!==0||(e=window.event,e=e===void 0?16:h_(e.type)),e):1}function Wi(e,t,r,n){if(50<g0)throw g0=0,dm=null,Error(Ie(185));iu(e,r,n),(!(Tt&2)||e!==Gr)&&(e===Gr&&(!(Tt&2)&&(ih|=r),Fr===4&&ps(e,Yr)),Gn(e,n),r===1&&Tt===0&&!(t.mode&1)&&(Hl=dr()+500,eh&&Bs()))}function Gn(e,t){var r=e.callbackNode;Jk(e,t);var n=ld(e,e===Gr?Yr:0);if(n===0)r!==null&&C4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&C4(r),t===1)e.tag===0?q9(xy.bind(null,e)):I_(xy.bind(null,e)),X9(function(){!(Tt&6)&&Bs()}),r=null;else{switch(o_(n)){case 1:r=Zm;break;case 4:r=i_;break;case 16:r=od;break;case 536870912:r=a_;break;default:r=od}r=N6(r,k6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function k6(e,t){if(Zf=-1,ed=0,Tt&6)throw Error(Ie(327));var r=e.callbackNode;if(Dl()&&e.callbackNode!==r)return null;var n=ld(e,e===Gr?Yr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Td(e,n);else{t=n;var i=Tt;Tt|=2;var a=C6();(Gr!==e||Yr!==t)&&(Fa=null,Hl=dr()+500,mo(e,t));do try{vE();break}catch(o){E6(e,o)}while(1);d2(),kd.current=a,Tt=i,wr!==null?t=0:(Gr=null,Yr=0,t=Fr)}if(t!==0){if(t===2&&(i=Ug(e),i!==0&&(n=i,t=hm(e,i))),t===1)throw r=z0,mo(e,0),ps(e,n),Gn(e,dr()),r;if(t===6)ps(e,n);else{if(i=e.current.alternate,!(n&30)&&!mE(i)&&(t=Td(e,n),t===2&&(a=Ug(e),a!==0&&(n=a,t=hm(e,a))),t===1))throw r=z0,mo(e,0),ps(e,n),Gn(e,dr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ie(345));case 2:oo(e,Un,Fa);break;case 3:if(ps(e,n),(n&130023424)===n&&(t=A2+500-dr(),10<t)){if(ld(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){An(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xg(oo.bind(null,e,Un,Fa),t);break}oo(e,Un,Fa);break;case 4:if(ps(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Hi(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=dr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gE(n/1960))-n,10<n){e.timeoutHandle=Xg(oo.bind(null,e,Un,Fa),n);break}oo(e,Un,Fa);break;case 5:oo(e,Un,Fa);break;default:throw Error(Ie(329))}}}return Gn(e,dr()),e.callbackNode===r?k6.bind(null,e):null}function hm(e,t){var r=p0;return e.current.memoizedState.isDehydrated&&(mo(e,t).flags|=256),e=Td(e,t),e!==2&&(t=Un,Un=r,t!==null&&pm(t)),e}function pm(e){Un===null?Un=e:Un.push.apply(Un,e)}function mE(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Yi(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ps(e,t){for(t&=~T2,t&=~ih,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hi(t),n=1<<r;e[r]=-1,t&=~n}}function xy(e){if(Tt&6)throw Error(Ie(327));Dl();var t=ld(e,0);if(!(t&1))return Gn(e,dr()),null;var r=Td(e,t);if(e.tag!==0&&r===2){var n=Ug(e);n!==0&&(t=n,r=hm(e,n))}if(r===1)throw r=z0,mo(e,0),ps(e,t),Gn(e,dr()),r;if(r===6)throw Error(Ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,oo(e,Un,Fa),Gn(e,dr()),null}function P2(e,t){var r=Tt;Tt|=1;try{return e(t)}finally{Tt=r,Tt===0&&(Hl=dr()+500,eh&&Bs())}}function Eo(e){vs!==null&&vs.tag===0&&!(Tt&6)&&Dl();var t=Tt;Tt|=1;var r=wi.transition,n=Lt;try{if(wi.transition=null,Lt=1,e)return e()}finally{Lt=n,wi.transition=r,Tt=t,!(Tt&6)&&Bs()}}function F2(){Yn=Tl.current,Xt(Tl)}function mo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$9(r)),wr!==null)for(r=wr.return;r!==null;){var n=r;switch(c2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hd();break;case 3:Vl(),Xt(zn),Xt(gn),v2();break;case 5:x2(n);break;case 4:Vl();break;case 13:Xt(tr);break;case 19:Xt(tr);break;case 10:h2(n.type._context);break;case 22:case 23:F2()}r=r.return}if(Gr=e,wr=e=Ps(e.current,null),Yr=Yn=t,Fr=0,z0=null,T2=ih=ko=0,Un=p0=null,fo!==null){for(t=0;t<fo.length;t++)if(r=fo[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}fo=null}return e}function E6(e,t){do{var r=wr;try{if(d2(),Qf.current=wd,Sd){for(var n=rr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Sd=!1}if(wo=0,Vr=Pr=rr=null,d0=!1,B0=0,C2.current=null,r===null||r.return===null){Fr=1,z0=t,wr=null;break}e:{var a=e,s=r.return,o=r,u=t;if(t=Yr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=o,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=iy(s);if(v!==null){v.flags&=-257,ay(v,s,o,a,t),v.mode&1&&ny(a,f,t),t=v,u=f;var g=t.updateQueue;if(g===null){var _=new Set;_.add(u),t.updateQueue=_}else g.add(u);break e}else{if(!(t&1)){ny(a,f,t),N2();break e}u=Error(Ie(426))}}else if(qt&&o.mode&1){var k=iy(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ay(k,s,o,a,t),u2(Gl(u,o));break e}}a=u=Gl(u,o),Fr!==4&&(Fr=2),p0===null?p0=[a]:p0.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var E=o6(a,u,t);q4(a,E);break e;case 1:o=u;var S=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof S.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ts===null||!Ts.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=l6(a,o,t);q4(a,C);break e}}a=a.return}while(a!==null)}A6(r)}catch(N){t=N,wr===r&&r!==null&&(wr=r=r.return);continue}break}while(1)}function C6(){var e=kd.current;return kd.current=wd,e===null?wd:e}function N2(){(Fr===0||Fr===3||Fr===2)&&(Fr=4),Gr===null||!(ko&268435455)&&!(ih&268435455)||ps(Gr,Yr)}function Td(e,t){var r=Tt;Tt|=2;var n=C6();(Gr!==e||Yr!==t)&&(Fa=null,mo(e,t));do try{xE();break}catch(i){E6(e,i)}while(1);if(d2(),Tt=r,kd.current=n,wr!==null)throw Error(Ie(261));return Gr=null,Yr=0,Fr}function xE(){for(;wr!==null;)T6(wr)}function vE(){for(;wr!==null&&!Gk();)T6(wr)}function T6(e){var t=F6(e.alternate,e,Yn);e.memoizedProps=e.pendingProps,t===null?A6(e):wr=t,C2.current=null}function A6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fE(r,t),r!==null){r.flags&=32767,wr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fr=6,wr=null;return}}else if(r=uE(r,t,Yn),r!==null){wr=r;return}if(t=t.sibling,t!==null){wr=t;return}wr=t=e}while(t!==null);Fr===0&&(Fr=5)}function oo(e,t,r){var n=Lt,i=wi.transition;try{wi.transition=null,Lt=1,yE(e,t,r,n)}finally{wi.transition=i,Lt=n}return null}function yE(e,t,r,n){do Dl();while(vs!==null);if(Tt&6)throw Error(Ie(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ie(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Zk(e,a),e===Gr&&(wr=Gr=null,Yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Af||(Af=!0,N6(od,function(){return Dl(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=wi.transition,wi.transition=null;var s=Lt;Lt=1;var o=Tt;Tt|=4,C2.current=null,hE(e,r),S6(r,e),U9(Wg),cd=!!Hg,Wg=Hg=null,e.current=r,pE(r),Hk(),Tt=o,Lt=s,wi.transition=a}else e.current=r;if(Af&&(Af=!1,vs=e,Cd=i),a=e.pendingLanes,a===0&&(Ts=null),Xk(r.stateNode),Gn(e,dr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ed)throw Ed=!1,e=fm,fm=null,e;return Cd&1&&e.tag!==0&&Dl(),a=e.pendingLanes,a&1?e===dm?g0++:(g0=0,dm=e):g0=0,Bs(),null}function Dl(){if(vs!==null){var e=o_(Cd),t=wi.transition,r=Lt;try{if(wi.transition=null,Lt=16>e?16:e,vs===null)var n=!1;else{if(e=vs,vs=null,Cd=0,Tt&6)throw Error(Ie(331));var i=Tt;for(Tt|=4,We=e.current;We!==null;){var a=We,s=a.child;if(We.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var f=o[u];for(We=f;We!==null;){var d=We;switch(d.tag){case 0:case 11:case 15:h0(8,d,a)}var p=d.child;if(p!==null)p.return=d,We=p;else for(;We!==null;){d=We;var m=d.sibling,v=d.return;if(v6(d),d===f){We=null;break}if(m!==null){m.return=v,We=m;break}We=v}}}var g=a.alternate;if(g!==null){var _=g.child;if(_!==null){g.child=null;do{var k=_.sibling;_.sibling=null,_=k}while(_!==null)}}We=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,We=s;else e:for(;We!==null;){if(a=We,a.flags&2048)switch(a.tag){case 0:case 11:case 15:h0(9,a,a.return)}var E=a.sibling;if(E!==null){E.return=a.return,We=E;break e}We=a.return}}var S=e.current;for(We=S;We!==null;){s=We;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,We=x;else e:for(s=S;We!==null;){if(o=We,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:nh(9,o)}}catch(N){ar(o,o.return,N)}if(o===s){We=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,We=C;break e}We=o.return}}if(Tt=i,Bs(),da&&typeof da.onPostCommitFiberRoot=="function")try{da.onPostCommitFiberRoot(Yd,e)}catch{}n=!0}return n}finally{Lt=r,wi.transition=t}}return!1}function vy(e,t,r){t=Gl(r,t),t=o6(e,t,1),e=Cs(e,t,1),t=An(),e!==null&&(iu(e,1,t),Gn(e,t))}function ar(e,t,r){if(e.tag===3)vy(e,e,r);else for(;t!==null;){if(t.tag===3){vy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ts===null||!Ts.has(n))){e=Gl(r,e),e=l6(t,e,1),t=Cs(t,e,1),e=An(),t!==null&&(iu(t,1,e),Gn(t,e));break}}t=t.return}}function _E(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=An(),e.pingedLanes|=e.suspendedLanes&r,Gr===e&&(Yr&r)===r&&(Fr===4||Fr===3&&(Yr&130023424)===Yr&&500>dr()-A2?mo(e,0):T2|=r),Gn(e,t)}function P6(e,t){t===0&&(e.mode&1?(t=xf,xf<<=1,!(xf&130023424)&&(xf=4194304)):t=1);var r=An();e=Va(e,t),e!==null&&(iu(e,t,r),Gn(e,r))}function SE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),P6(e,r)}function wE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ie(314))}n!==null&&n.delete(t),P6(e,r)}var F6;F6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||zn.current)jn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return jn=!1,cE(e,t,r);jn=!!(e.flags&131072)}else jn=!1,qt&&t.flags&1048576&&D_(t,md,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Jf(e,t),e=t.pendingProps;var i=Ul(t,gn.current);Il(t,r),i=_2(null,t,n,e,i,r);var a=S2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vn(n)?(a=!0,pd(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,g2(t),i.updater=rh,t.stateNode=i,i._reactInternals=t,em(t,n,e,r),t=nm(null,t,n,!0,a,r)):(t.tag=0,qt&&a&&l2(t),wn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Jf(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=EE(n),e=Bi(n,e),i){case 0:t=rm(null,t,n,e,r);break e;case 1:t=ly(null,t,n,e,r);break e;case 11:t=sy(null,t,n,e,r);break e;case 14:t=oy(null,t,n,Bi(n.type,e),r);break e}throw Error(Ie(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),rm(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),ly(e,t,n,i,r);case 3:e:{if(d6(t),e===null)throw Error(Ie(387));n=t.pendingProps,a=t.memoizedState,i=a.element,U_(e,t),yd(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Gl(Error(Ie(423)),t),t=cy(e,t,n,r,i);break e}else if(n!==i){i=Gl(Error(Ie(424)),t),t=cy(e,t,n,r,i);break e}else for(Jn=Es(t.stateNode.containerInfo.firstChild),Zn=t,qt=!0,ji=null,r=M_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jl(),n===i){t=Ga(e,t,r);break e}wn(e,t,n,r)}t=t.child}return t;case 5:return j_(t),e===null&&qg(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,$g(n,i)?s=null:a!==null&&$g(n,a)&&(t.flags|=32),f6(e,t),wn(e,t,s,r),t.child;case 6:return e===null&&qg(t),null;case 13:return h6(e,t,r);case 4:return m2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=zl(t,null,n,r):wn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),sy(e,t,n,i,r);case 7:return wn(e,t,t.pendingProps,r),t.child;case 8:return wn(e,t,t.pendingProps.children,r),t.child;case 12:return wn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Gt(xd,n._currentValue),n._currentValue=s,a!==null)if(Yi(a.value,s)){if(a.children===i.children&&!zn.current){t=Ga(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=La(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),Jg(a.return,r,t),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Ie(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Jg(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}wn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Il(t,r),i=ki(i),n=n(i),t.flags|=1,wn(e,t,n,r),t.child;case 14:return n=t.type,i=Bi(n,t.pendingProps),i=Bi(n.type,i),oy(e,t,n,i,r);case 15:return c6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),Jf(e,t),t.tag=1,Vn(n)?(e=!0,pd(t)):e=!1,Il(t,r),s6(t,n,i),em(t,n,i,r),nm(null,t,n,!0,e,r);case 19:return p6(e,t,r);case 22:return u6(e,t,r)}throw Error(Ie(156,t.tag))};function N6(e,t){return n_(e,t)}function kE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,r,n){return new kE(e,t,r,n)}function R2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function EE(e){if(typeof e=="function")return R2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qm)return 11;if(e===qm)return 14}return 2}function Ps(e,t){var r=e.alternate;return r===null?(r=Si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function td(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")R2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ml:return xo(r.children,i,a,t);case Ym:s=8,i|=8;break;case Eg:return e=Si(12,r,t,i|2),e.elementType=Eg,e.lanes=a,e;case Cg:return e=Si(13,r,t,i),e.elementType=Cg,e.lanes=a,e;case Tg:return e=Si(19,r,t,i),e.elementType=Tg,e.lanes=a,e;case j5:return ah(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B5:s=10;break e;case U5:s=9;break e;case Qm:s=11;break e;case qm:s=14;break e;case fs:s=16,n=null;break e}throw Error(Ie(130,e==null?e:typeof e,""))}return t=Si(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function xo(e,t,r,n){return e=Si(7,e,n,t),e.lanes=r,e}function ah(e,t,r,n){return e=Si(22,e,n,t),e.elementType=j5,e.lanes=r,e.stateNode={isHidden:!1},e}function Wp(e,t,r){return e=Si(6,e,null,t),e.lanes=r,e}function $p(e,t,r){return t=Si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function CE(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tp(0),this.expirationTimes=Tp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,a,s,o,u){return e=new CE(e,t,r,o,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Si(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},g2(a),e}function TE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function R6(e){if(!e)return Rs;e=e._reactInternals;e:{if(No(e)!==e||e.tag!==1)throw Error(Ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ie(171))}if(e.tag===1){var r=e.type;if(Vn(r))return R_(e,r,t)}return t}function I6(e,t,r,n,i,a,s,o,u){return e=I2(r,n,!0,e,i,a,s,o,u),e.context=R6(null),r=e.current,n=An(),i=As(r),a=La(n,i),a.callback=t??null,Cs(r,a,i),e.current.lanes=i,iu(e,i,n),Gn(e,n),e}function sh(e,t,r,n){var i=t.current,a=An(),s=As(i);return r=R6(r),t.context===null?t.context=r:t.pendingContext=r,t=La(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Cs(i,t,s),e!==null&&(Wi(e,i,s,a),Yf(e,i,s)),s}function Ad(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function D2(e,t){yy(e,t),(e=e.alternate)&&yy(e,t)}function AE(){return null}var D6=typeof reportError=="function"?reportError:function(e){console.error(e)};function O2(e){this._internalRoot=e}oh.prototype.render=O2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ie(409));sh(e,t,null,null)};oh.prototype.unmount=O2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Eo(function(){sh(null,e,null,null)}),t[za]=null}};function oh(e){this._internalRoot=e}oh.prototype.unstable_scheduleHydration=function(e){if(e){var t=u_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<hs.length&&t!==0&&t<hs[r].priority;r++);hs.splice(r,0,e),r===0&&d_(e)}};function b2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function lh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _y(){}function PE(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Ad(s);a.call(f)}}var s=I6(t,n,e,0,null,!1,!1,"",_y);return e._reactRootContainer=s,e[za]=s.current,D0(e.nodeType===8?e.parentNode:e),Eo(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var f=Ad(u);o.call(f)}}var u=I2(e,0,!1,null,null,!1,!1,"",_y);return e._reactRootContainer=u,e[za]=u.current,D0(e.nodeType===8?e.parentNode:e),Eo(function(){sh(t,u,r,n)}),u}function ch(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=Ad(s);o.call(u)}}sh(t,s,e,i)}else s=PE(r,t,e,i,n);return Ad(s)}l_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zc(t.pendingLanes);r!==0&&(e2(t,r|1),Gn(t,dr()),!(Tt&6)&&(Hl=dr()+500,Bs()))}break;case 13:Eo(function(){var n=Va(e,1);if(n!==null){var i=An();Wi(n,e,1,i)}}),D2(e,1)}};t2=function(e){if(e.tag===13){var t=Va(e,134217728);if(t!==null){var r=An();Wi(t,e,134217728,r)}D2(e,134217728)}};c_=function(e){if(e.tag===13){var t=As(e),r=Va(e,t);if(r!==null){var n=An();Wi(r,e,t,n)}D2(e,t)}};u_=function(){return Lt};f_=function(e,t){var r=Lt;try{return Lt=e,t()}finally{Lt=r}};Lg=function(e,t,r){switch(t){case"input":if(Fg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Zd(n);if(!i)throw Error(Ie(90));V5(n),Fg(n,i)}}}break;case"textarea":H5(e,r);break;case"select":t=r.value,t!=null&&Pl(e,!!r.multiple,t,!1)}};q5=P2;J5=Eo;var FE={usingClientEntryPoint:!1,Events:[su,_l,Zd,Y5,Q5,P2]},jc={findFiberByHostInstance:uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NE={bundleType:jc.bundleType,version:jc.version,rendererPackageName:jc.rendererPackageName,rendererConfig:jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=t_(e),e===null?null:e.stateNode},findFiberByHostInstance:jc.findFiberByHostInstance||AE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{Yd=Pf.inject(NE),da=Pf}catch{}}ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;ni.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b2(t))throw Error(Ie(200));return TE(e,t,null,r)};ni.createRoot=function(e,t){if(!b2(e))throw Error(Ie(299));var r=!1,n="",i=D6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[za]=t.current,D0(e.nodeType===8?e.parentNode:e),new O2(t)};ni.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ie(188)):(e=Object.keys(e).join(","),Error(Ie(268,e)));return e=t_(t),e=e===null?null:e.stateNode,e};ni.flushSync=function(e){return Eo(e)};ni.hydrate=function(e,t,r){if(!lh(t))throw Error(Ie(200));return ch(null,e,t,!0,r)};ni.hydrateRoot=function(e,t,r){if(!b2(e))throw Error(Ie(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=D6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=I6(t,null,e,1,r??null,i,!1,a,s),e[za]=t.current,D0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new oh(t)};ni.render=function(e,t,r){if(!lh(t))throw Error(Ie(200));return ch(null,e,t,!1,r)};ni.unmountComponentAtNode=function(e){if(!lh(e))throw Error(Ie(40));return e._reactRootContainer?(Eo(function(){ch(null,null,e,!1,function(){e._reactRootContainer=null,e[za]=null})}),!0):!1};ni.unstable_batchedUpdates=P2;ni.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!lh(r))throw Error(Ie(200));if(e==null||e._reactInternals===void 0)throw Error(Ie(38));return ch(e,t,r,!1,n)};ni.version="18.3.1-next-f1338f8080-20240426";function O6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O6)}catch(e){console.error(e)}}O6(),O5.exports=ni;var RE=O5.exports,Sy=RE;wg.createRoot=Sy.createRoot,wg.hydrateRoot=Sy.hydrateRoot;const wy=e=>{let t;const r=new Set,n=(d,p)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const v=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(g=>g(t,v))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>f,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},f=t=e(n,i,u);return u},IE=e=>e?wy(e):wy;var b6={exports:{}},L6={},M6={exports:{}},B6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wl=ke;function DE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var OE=typeof Object.is=="function"?Object.is:DE,bE=Wl.useState,LE=Wl.useEffect,ME=Wl.useLayoutEffect,BE=Wl.useDebugValue;function UE(e,t){var r=t(),n=bE({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return ME(function(){i.value=r,i.getSnapshot=t,Xp(i)&&a({inst:i})},[e,r,t]),LE(function(){return Xp(i)&&a({inst:i}),e(function(){Xp(i)&&a({inst:i})})},[e]),BE(r),r}function Xp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!OE(e,r)}catch{return!0}}function jE(e,t){return t()}var zE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?jE:UE;B6.useSyncExternalStore=Wl.useSyncExternalStore!==void 0?Wl.useSyncExternalStore:zE;M6.exports=B6;var VE=M6.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uh=ke,GE=VE;function HE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var WE=typeof Object.is=="function"?Object.is:HE,$E=GE.useSyncExternalStore,XE=uh.useRef,KE=uh.useEffect,YE=uh.useMemo,QE=uh.useDebugValue;L6.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=XE(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=YE(function(){function u(v){if(!f){if(f=!0,d=v,v=n(v),i!==void 0&&s.hasValue){var g=s.value;if(i(g,v))return p=g}return p=v}if(g=p,WE(d,v))return g;var _=n(v);return i!==void 0&&i(g,_)?(d=v,g):(d=v,p=_)}var f=!1,d,p,m=r===void 0?null:r;return[function(){return u(t())},m===null?void 0:function(){return u(m())}]},[t,r,n,i]);var o=$E(e,a[0],a[1]);return KE(function(){s.hasValue=!0,s.value=o},[o]),QE(o),o};b6.exports=L6;var qE=b6.exports;const JE=Xd(qE),{useDebugValue:ZE}=Sr,{useSyncExternalStoreWithSelector:eC}=JE;const tC=e=>e;function rC(e,t=tC,r){const n=eC(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return ZE(n),n}const ky=e=>{const t=typeof e=="function"?IE(e):e,r=(n,i)=>rC(t,n,i);return Object.assign(r,t),r},nC=e=>e?ky(e):ky;var U6=Symbol.for("immer-nothing"),Ey=Symbol.for("immer-draftable"),It=Symbol.for("immer-state");function _i(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var $l=Object.getPrototypeOf;function Xl(e){return!!e&&!!e[It]}function Ha(e){var t;return e?j6(e)||Array.isArray(e)||!!e[Ey]||!!((t=e.constructor)!=null&&t[Ey])||dh(e)||hh(e):!1}var iC=Object.prototype.constructor.toString();function j6(e){if(!e||typeof e!="object")return!1;const t=$l(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===iC}function V0(e,t){fh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function fh(e){const t=e[It];return t?t.type_:Array.isArray(e)?1:dh(e)?2:hh(e)?3:0}function gm(e,t){return fh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function z6(e,t,r){const n=fh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function aC(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function dh(e){return e instanceof Map}function hh(e){return e instanceof Set}function jr(e){return e.copy_||e.base_}function mm(e,t){if(dh(e))return new Map(e);if(hh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=j6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[It];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create($l(e),n)}else{const n=$l(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function L2(e,t=!1){return ph(e)||Xl(e)||!Ha(e)||(fh(e)>1&&(e.set=e.add=e.clear=e.delete=sC),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>L2(n,!0))),e}function sC(){_i(2)}function ph(e){return Object.isFrozen(e)}var xm={};function Co(e){const t=xm[e];return t||_i(0,e),t}function oC(e,t){xm[e]||(xm[e]=t)}var G0;function Pd(){return G0}function lC(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Cy(e,t){t&&(Co("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function vm(e){ym(e),e.drafts_.forEach(cC),e.drafts_=null}function ym(e){e===G0&&(G0=e.parent_)}function Ty(e){return G0=lC(G0,e)}function cC(e){const t=e[It];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ay(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[It].modified_&&(vm(t),_i(4)),Ha(e)&&(e=Fd(t,e),t.parent_||Nd(t,e)),t.patches_&&Co("Patches").generateReplacementPatches_(r[It].base_,e,t.patches_,t.inversePatches_)):e=Fd(t,r,[]),vm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==U6?e:void 0}function Fd(e,t,r){if(ph(t))return t;const n=t[It];if(!n)return V0(t,(i,a)=>Py(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Nd(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),V0(a,(o,u)=>Py(e,n,i,o,u,r,s)),Nd(e,i,!1),r&&e.patches_&&Co("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Py(e,t,r,n,i,a,s){if(Xl(i)){const o=a&&t&&t.type_!==3&&!gm(t.assigned_,n)?a.concat(n):void 0,u=Fd(e,i,o);if(z6(r,n,u),Xl(u))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Ha(i)&&!ph(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Fd(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Nd(e,i)}}function Nd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&L2(t,r)}function uC(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Pd(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=M2;r&&(i=[n],a=H0);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var M2={get(e,t){if(t===It)return e;const r=jr(e);if(!gm(r,t))return fC(e,r,t);const n=r[t];return e.finalized_||!Ha(n)?n:n===Kp(e.base_,t)?(Yp(e),e.copy_[t]=W0(n,e)):n},has(e,t){return t in jr(e)},ownKeys(e){return Reflect.ownKeys(jr(e))},set(e,t,r){const n=V6(jr(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Kp(jr(e),t),a=i==null?void 0:i[It];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(aC(r,i)&&(r!==void 0||gm(e.base_,t)))return!0;Yp(e),Ia(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Kp(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Yp(e),Ia(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=jr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){_i(11)},getPrototypeOf(e){return $l(e.base_)},setPrototypeOf(){_i(12)}},H0={};V0(M2,(e,t)=>{H0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});H0.deleteProperty=function(e,t){return H0.set.call(this,e,t,void 0)};H0.set=function(e,t,r){return M2.set.call(this,e[0],t,r,e[0])};function Kp(e,t){const r=e[It];return(r?jr(r):e)[t]}function fC(e,t,r){var i;const n=V6(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function V6(e,t){if(!(t in e))return;let r=$l(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=$l(r)}}function Ia(e){e.modified_||(e.modified_=!0,e.parent_&&Ia(e.parent_))}function Yp(e){e.copy_||(e.copy_=mm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dC=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(u=a,...f){return s.produce(u,d=>r.call(this,d,...f))}}typeof r!="function"&&_i(6),n!==void 0&&typeof n!="function"&&_i(7);let i;if(Ha(t)){const a=Ty(this),s=W0(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?vm(a):ym(a)}return Cy(a,n),Ay(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===U6&&(i=void 0),this.autoFreeze_&&L2(i,!0),n){const a=[],s=[];Co("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else _i(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,u=>t(u,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ha(e)||_i(8),Xl(e)&&(e=hC(e));const t=Ty(this),r=W0(e,void 0);return r[It].isManual_=!0,ym(t),r}finishDraft(e,t){const r=e&&e[It];(!r||!r.isManual_)&&_i(9);const{scope_:n}=r;return Cy(n,t),Ay(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Co("Patches").applyPatches_;return Xl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function W0(e,t){const r=dh(e)?Co("MapSet").proxyMap_(e,t):hh(e)?Co("MapSet").proxySet_(e,t):uC(e,t);return(t?t.scope_:Pd()).drafts_.push(r),r}function hC(e){return Xl(e)||_i(10,e),G6(e)}function G6(e){if(!Ha(e)||ph(e))return e;const t=e[It];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=mm(e,t.scope_.immer_.useStrictShallowCopy_)}else r=mm(e,!0);return V0(r,(n,i)=>{z6(r,n,G6(i))}),t&&(t.finalized_=!1),r}function pC(){class e extends Map{constructor(u,f){super(),this[It]={type_:2,parent_:f,scope_:f?f.scope_:Pd(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:u,draft_:this,isManual_:!1,revoked_:!1}}get size(){return jr(this[It]).size}has(u){return jr(this[It]).has(u)}set(u,f){const d=this[It];return s(d),(!jr(d).has(u)||jr(d).get(u)!==f)&&(r(d),Ia(d),d.assigned_.set(u,!0),d.copy_.set(u,f),d.assigned_.set(u,!0)),this}delete(u){if(!this.has(u))return!1;const f=this[It];return s(f),r(f),Ia(f),f.base_.has(u)?f.assigned_.set(u,!1):f.assigned_.delete(u),f.copy_.delete(u),!0}clear(){const u=this[It];s(u),jr(u).size&&(r(u),Ia(u),u.assigned_=new Map,V0(u.base_,f=>{u.assigned_.set(f,!1)}),u.copy_.clear())}forEach(u,f){const d=this[It];jr(d).forEach((p,m,v)=>{u.call(f,this.get(m),m,this)})}get(u){const f=this[It];s(f);const d=jr(f).get(u);if(f.finalized_||!Ha(d)||d!==f.base_.get(u))return d;const p=W0(d,f);return r(f),f.copy_.set(u,p),p}keys(){return jr(this[It]).keys()}values(){const u=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const f=u.next();return f.done?f:{done:!1,value:this.get(f.value)}}}}entries(){const u=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const f=u.next();if(f.done)return f;const d=this.get(f.value);return{done:!1,value:[f.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,u){return new e(o,u)}function r(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class n extends Set{constructor(u,f){super(),this[It]={type_:3,parent_:f,scope_:f?f.scope_:Pd(),modified_:!1,finalized_:!1,copy_:void 0,base_:u,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return jr(this[It]).size}has(u){const f=this[It];return s(f),f.copy_?!!(f.copy_.has(u)||f.drafts_.has(u)&&f.copy_.has(f.drafts_.get(u))):f.base_.has(u)}add(u){const f=this[It];return s(f),this.has(u)||(a(f),Ia(f),f.copy_.add(u)),this}delete(u){if(!this.has(u))return!1;const f=this[It];return s(f),a(f),Ia(f),f.copy_.delete(u)||(f.drafts_.has(u)?f.copy_.delete(f.drafts_.get(u)):!1)}clear(){const u=this[It];s(u),jr(u).size&&(a(u),Ia(u),u.copy_.clear())}values(){const u=this[It];return s(u),a(u),u.copy_.values()}entries(){const u=this[It];return s(u),a(u),u.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(u,f){const d=this.values();let p=d.next();for(;!p.done;)u.call(f,p.value,p.value,this),p=d.next()}}function i(o,u){return new n(o,u)}function a(o){o.copy_||(o.copy_=new Set,o.base_.forEach(u=>{if(Ha(u)){const f=W0(u,o);o.drafts_.set(u,f),o.copy_.add(f)}else o.copy_.add(u)}))}function s(o){o.revoked_&&_i(3,JSON.stringify(jr(o)))}oC("MapSet",{proxyMap_:t,proxySet_:i})}var ti=new dC,gC=ti.produce;ti.produceWithPatches.bind(ti);ti.setAutoFreeze.bind(ti);ti.setUseStrictShallowCopy.bind(ti);ti.applyPatches.bind(ti);ti.createDraft.bind(ti);ti.finishDraft.bind(ti);const mC=e=>(t,r,n)=>(n.setState=(i,a,...s)=>{const o=typeof i=="function"?gC(i):i;return t(o,a,...s)},e(n.setState,r,n)),xC=mC;class Cr{static initialize(t=50){this.state.maxHistorySize=t}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static notifyListeners(){this.listeners.forEach(t=>t())}static recordAction(t,r,n){const i={id:crypto.randomUUID(),type:t,timestamp:new Date,data:JSON.parse(JSON.stringify(r)),description:n};return this.state.history=this.state.history.slice(0,this.state.currentIndex+1),this.state.history.push(i),this.state.currentIndex++,this.state.history.length>this.state.maxHistorySize&&(this.state.history.shift(),this.state.currentIndex--),this.notifyListeners(),i.id}static canUndo(){return this.state.currentIndex>=0}static canRedo(){return this.state.currentIndex<this.state.history.length-1}static undo(){if(!this.canUndo())return null;const t=this.state.history[this.state.currentIndex];return this.state.currentIndex--,this.notifyListeners(),t}static redo(){if(!this.canRedo())return null;this.state.currentIndex++;const t=this.state.history[this.state.currentIndex];return this.notifyListeners(),t}static getHistory(){return[...this.state.history]}static getCurrentIndex(){return this.state.currentIndex}static clear(){this.state.history=[],this.state.currentIndex=-1,this.notifyListeners()}static createPinAssignmentAction(t,r,n){return{type:"PIN_ASSIGNMENT",data:{pinId:t,oldSignal:r,newSignal:n}}}static createBulkAssignmentAction(t){return{type:"BULK_ASSIGNMENT",data:{assignments:t}}}static createSelectionAction(t,r){return{type:"SELECTION_CHANGE",data:{oldSelection:Array.from(t),newSelection:Array.from(r)}}}static createViewChangeAction(t,r){return{type:"VIEW_CHANGE",data:{oldView:t,newView:r}}}static getActionDescription(t){switch(t.type){case"PIN_ASSIGNMENT":const{pinId:r,oldSignal:n,newSignal:i}=t.data;return i?`Assigned "${i}" to pin ${r}`:`Cleared assignment from pin ${r}`;case"BULK_ASSIGNMENT":return`Bulk assignment to ${t.data.assignments.length} pins`;case"SELECTION_CHANGE":return`Selected ${t.data.newSelection.length} pin(s)`;case"VIEW_CHANGE":return"Changed view settings";default:return t.description||`Unknown action: ${t.type}`}}}Cr.state={history:[],currentIndex:-1,maxHistorySize:50};Cr.listeners=new Set;function Is(e){if(e.length===1)return e.charCodeAt(0)-65;if(e.length===2){const t=e.charCodeAt(0)-65,r=e.charCodeAt(1)-65;return 26+t*26+r}return 0}function ol(e){if(e<0)return console.warn(` Invalid index ${e}, defaulting to 'A'`),"A";if(e<26)return String.fromCharCode(65+e);{const t=e-26,r=Math.floor(t/26),n=t%26;return String.fromCharCode(65+r)+String.fromCharCode(65+n)}}function H6(e,t){const r=Is(e),n=Is(t);return r-n}pC();const Qp={rotation:0,isTopView:!0,zoom:1,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},Ff={pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"grid",sortOrder:"asc"},vC={activeTab:"overview",viewMode:"grid",searchQuery:"",selectedRows:new Set,sortColumn:void 0,sortDirection:"asc",commentFilter:"all"},$i=nC()(xC((e,t)=>({currentProject:null,package:null,pins:[],filteredPins:[],selectedPins:new Set,visibleBanks:new Set,viewConfig:Qp,listView:vC,pinColorMode:"bank",filters:Ff,isLoading:!1,error:null,recentFiles:[],canUndo:!1,canRedo:!1,currentActionDescription:null,nextRedoActionDescription:null,loadProject:r=>{e(n=>{n.currentProject=r,n.package=r.packageData,n.pins=r.pinAssignments,n.viewConfig=r.viewConfig,n.filters=r.filters}),t().applyFilters()},createNewProject:(r,n)=>e(i=>{const a={id:crypto.randomUUID(),name:r,description:"",created:new Date,modified:new Date,projectInfo:{device:n.device,package:n.packageType,speedGrade:"-1",temperature:"C"},packageData:n,pinAssignments:n.pins,viewConfig:Qp,filters:Ff};i.currentProject=a,i.package=n,i.pins=n.pins,i.filteredPins=n.pins,i.viewConfig=Qp,i.filters=Ff;const s=new Set;n.pins.forEach(o=>{const u=o.bank||"NA";s.add(u)}),i.visibleBanks=s,console.log(" : newProject -  visibleBanks:",Array.from(s)),t().applyFilters()}),saveProject:()=>e(r=>{r.currentProject&&(r.currentProject.modified=new Date,r.currentProject.pinAssignments=r.pins,r.currentProject.viewConfig=r.viewConfig,r.currentProject.filters=r.filters)}),loadPackage:r=>e(n=>{var a;console.log(" : loadPackage",r),n.package=r,n.pins=r.pins,n.filteredPins=r.pins,n.selectedPins.clear();const i=new Set;r.pins.forEach(s=>{const o=s.bank||"NA";i.add(o)}),n.visibleBanks=i,console.log(" :  visibleBanks:",Array.from(i)),console.log(" :",{packageName:(a=n.package)==null?void 0:a.name,pinsCount:n.pins.length,filteredPinsCount:n.filteredPins.length})}),updatePin:(r,n)=>e(i=>{const a=i.pins.find(s=>s.id===r);a&&(Object.assign(a,n),n.signalName!==void 0&&(a.isAssigned=n.signalName!==""))}),updatePins:r=>e(n=>{r.forEach((i,a)=>{const s=n.pins.find(o=>o.id===a);s&&(Object.assign(s,i),i.signalName!==void 0&&(s.isAssigned=i.signalName!==""))})}),assignSignal:(r,n)=>{const a=t().pins.find(u=>u.id===r);if(!a)return;const s=a.signalName,o=Cr.createPinAssignmentAction(r,s,n);Cr.recordAction(o.type,o.data,n?` "${n}"  ${r} `:` ${r} `),e(u=>{const f=u.pins.find(d=>d.id===r);f&&(f.signalName=n,f.isAssigned=n!=="")}),t().applyFilters(),t().updateUndoRedoState()},clearSignal:r=>{const i=t().pins.find(o=>o.id===r);if(!i||!i.signalName)return;const a=i.signalName,s=Cr.createPinAssignmentAction(r,a,"");Cr.recordAction(s.type,s.data,` ${r} `),e(o=>{const u=o.pins.find(f=>f.id===r);u&&(u.signalName="",u.isAssigned=!1)}),t().applyFilters(),t().updateUndoRedoState()},selectPin:r=>e(n=>{n.selectedPins.clear(),n.selectedPins.add(r)}),selectPins:r=>e(n=>{n.selectedPins.clear(),r.forEach(i=>n.selectedPins.add(i))}),clearSelection:()=>e(r=>{r.selectedPins.clear()}),togglePinSelection:r=>e(n=>{n.selectedPins.has(r)?n.selectedPins.delete(r):n.selectedPins.add(r)}),setRotation:r=>e(n=>{n.viewConfig.rotation=r%360}),toggleView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setZoom:r=>e(n=>{n.viewConfig.zoom=Math.max(.1,Math.min(5,r))}),resetZoom:()=>e(r=>{r.viewConfig.zoom=1}),updateViewConfig:r=>e(n=>{Object.assign(n.viewConfig,r)}),updateFilters:r=>e(n=>{Object.assign(n.filters,r);let i=[...n.pins];if(n.filters.pinTypes.length>0&&(i=i.filter(a=>n.filters.pinTypes.includes(a.pinType))),n.filters.banks.length>0&&(i=i.filter(a=>a.bank&&n.filters.banks.includes(a.bank))),n.filters.searchText){const a=n.filters.searchText.toLowerCase();i=i.filter(s=>s.pinNumber.toLowerCase().includes(a)||s.pinName.toLowerCase().includes(a)||s.signalName.toLowerCase().includes(a))}n.filters.voltageFilter.length>0&&(i=i.filter(a=>n.filters.voltageFilter.includes(a.voltage))),n.filters.assignmentStatus!=="all"&&(i=i.filter(a=>n.filters.assignmentStatus==="assigned"?a.isAssigned:!a.isAssigned)),n.filters.showOnlyDifferentialPairs&&(i=i.filter(a=>a.differentialPair)),i.sort((a,s)=>{var d,p;let o,u;switch(n.filters.sortField){case"pinNumber":o=a.pinNumber,u=s.pinNumber;break;case"pinName":o=a.pinName,u=s.pinName;break;case"signalName":o=a.signalName,u=s.signalName;break;case"pinType":o=a.pinType,u=s.pinType;break;case"bank":o=a.bank||"",u=s.bank||"";break;case"grid":if(a.gridPosition&&s.gridPosition){const m=H6(a.gridPosition.row,s.gridPosition.row);if(m!==0)return n.filters.sortOrder==="asc"?m:-m;const v=a.gridPosition.col-s.gridPosition.col;return n.filters.sortOrder==="asc"?v:-v}o=((d=a.gridPosition)==null?void 0:d.row)||"",u=((p=s.gridPosition)==null?void 0:p.row)||"";break;default:o=a.pinNumber,u=s.pinNumber}const f=o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"});return n.filters.sortOrder==="asc"?f:-f}),n.filteredPins=i}),clearFilters:()=>e(r=>{r.filters={...Ff},r.filteredPins=r.pins}),applyFilters:()=>e(r=>{let n=[...r.pins];if(console.log(" applyFilters: visibleBanks =",Array.from(r.visibleBanks)),console.log(" applyFilters: pins before bank filter =",n.length),r.visibleBanks.size>0){const i=n.length;n=n.filter(a=>{const s=a.bank||"UNASSIGNED";return r.visibleBanks.has(s)}),console.log(` applyFilters: filtered from ${i} to ${n.length} pins`)}else console.log(" applyFilters: visibleBanks is empty, showing all pins");if(r.filters.pinTypes.length>0&&(n=n.filter(i=>r.filters.pinTypes.includes(i.pinType))),r.filters.banks.length>0&&(n=n.filter(i=>i.bank&&r.filters.banks.includes(i.bank))),r.filters.searchText){const i=r.filters.searchText.toLowerCase();n=n.filter(a=>a.pinNumber.toLowerCase().includes(i)||a.pinName.toLowerCase().includes(i)||a.signalName.toLowerCase().includes(i))}r.filters.voltageFilter.length>0&&(n=n.filter(i=>r.filters.voltageFilter.includes(i.voltage))),r.filters.assignmentStatus!=="all"&&(n=n.filter(i=>r.filters.assignmentStatus==="assigned"?i.isAssigned:!i.isAssigned)),r.filters.showOnlyDifferentialPairs&&(n=n.filter(i=>i.differentialPair)),n.sort((i,a)=>{let s,o;switch(r.filters.sortField){case"pinNumber":s=i.pinNumber,o=a.pinNumber;break;case"pinName":s=i.pinName,o=a.pinName;break;case"signalName":s=i.signalName||"",o=a.signalName||"";break;case"pinType":s=i.pinType,o=a.pinType;break;case"bank":s=i.bank||"",o=a.bank||"";break;default:s=i.pinNumber,o=a.pinNumber}const u=s.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"});return r.filters.sortOrder==="asc"?u:-u}),r.filteredPins=n}),setSortField:r=>e(n=>{n.filters.sortField=r,t().applyFilters()}),setSortOrder:r=>e(n=>{n.filters.sortOrder=r,t().applyFilters()}),toggleBankVisibility:r=>{e(n=>{console.log(` toggleBankVisibility called for Bank ${r}`),console.log(" Before: visibleBanks =",Array.from(n.visibleBanks)),n.visibleBanks.has(r)?(n.visibleBanks.delete(r),console.log(` Removed Bank ${r} from visibleBanks`)):(n.visibleBanks.add(r),console.log(` Added Bank ${r} to visibleBanks`)),console.log(" After: visibleBanks =",Array.from(n.visibleBanks))}),console.log(" Calling applyFilters after state update..."),t().applyFilters()},setBankVisibility:(r,n)=>{e(i=>{n?i.visibleBanks.add(r):i.visibleBanks.delete(r)}),t().applyFilters()},showAllBanks:()=>{e(r=>{console.log(" showAllBanks: clearing visibleBanks"),r.visibleBanks.clear()}),t().applyFilters()},assignDifferentialPair:(r,n,i)=>e(a=>{const s=a.pins.find(u=>u.id===r),o=a.pins.find(u=>u.id===n);s&&o&&(s.signalName=`${i}_P`,s.isAssigned=!0,s.differentialPair={pair:n,type:"positive"},o.signalName=`${i}_N`,o.isAssigned=!0,o.differentialPair={pair:r,type:"negative"})}),clearDifferentialPair:r=>e(n=>{const i=n.pins.find(a=>a.id===r);if(i&&i.differentialPair){const a=n.pins.find(s=>s.id===i.differentialPair.pair);i.differentialPair=void 0,i.signalName="",i.isAssigned=!1,a&&(a.differentialPair=void 0,a.signalName="",a.isAssigned=!1)}}),rotatePins:r=>e(n=>{n.viewConfig.rotation=(n.viewConfig.rotation+r)%360}),flipView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setLoading:r=>e(n=>{n.isLoading=r}),setError:r=>e(n=>{n.error=r}),setViewMode:r=>e(n=>{n.listView.viewMode=r}),setActiveTab:r=>e(n=>{n.listView.activeTab=r}),setSearchQuery:r=>e(n=>{n.listView.searchQuery=r}),setCommentFilter:r=>e(n=>{n.listView.commentFilter=r}),updateListViewState:r=>e(n=>{Object.assign(n.listView,r)}),bulkUpdateComments:(r,n)=>e(i=>{const a=new Date;r.forEach(s=>{const o=i.pins.find(u=>u.id===s);o&&(o.comment=n,o.commentTimestamp=a,o.commentAuthor="current_user")}),i.listView.selectedRows.clear()}),setPinColorMode:r=>e(n=>{n.pinColorMode=r}),addRecentFile:r=>e(n=>{const i=n.recentFiles.filter(a=>a!==r);n.recentFiles=[r,...i].slice(0,10)}),undo:()=>{const r=Cr.undo();r&&(t().handleUndoRedoAction(r,"undo"),t().updateUndoRedoState())},redo:()=>{const r=Cr.redo();r&&(t().handleUndoRedoAction(r,"redo"),t().updateUndoRedoState())},updateUndoRedoState:()=>e(r=>{r.canUndo=Cr.canUndo(),r.canRedo=Cr.canRedo();const n=Cr.getHistory(),i=Cr.getCurrentIndex();i>=0&&i<n.length?r.currentActionDescription=Cr.getActionDescription(n[i]):r.currentActionDescription=null,i+1<n.length?r.nextRedoActionDescription=Cr.getActionDescription(n[i+1]):r.nextRedoActionDescription=null}),clearHistory:()=>{Cr.clear(),t().updateUndoRedoState()},handleUndoRedoAction:(r,n)=>{const{type:i,data:a}=r;switch(i){case"PIN_ASSIGNMENT":const{pinId:s,oldSignal:o,newSignal:u}=a,f=n==="undo"?o:u;e(E=>{const S=E.pins.find(x=>x.id===s);S&&(S.signalName=f||"",S.isAssigned=!!f)}),t().applyFilters();break;case"BULK_ASSIGNMENT":const{assignments:d}=a;e(E=>{d.forEach(({pinId:S,oldSignal:x,newSignal:C})=>{const N=E.pins.find(T=>T.id===S);if(N){const T=n==="undo"?x:C;N.signalName=T||"",N.isAssigned=!!T}})}),t().applyFilters();break;case"SELECTION_CHANGE":const{oldSelection:p,newSelection:m}=a,v=n==="undo"?p:m;e(E=>{E.selectedPins=new Set(v)});break;case"VIEW_CHANGE":const{oldView:g,newView:_}=a,k=n==="undo"?g:_;e(E=>{Object.assign(E.viewConfig,k)});break;default:console.warn(`Unhandled undo/redo action type: ${i}`);break}}})));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var W6=1252,yC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},U2=function(e){yC.indexOf(e)!=-1&&(W6=B2[0]=e)};function _C(){U2(1252)}var Vi=function(e){U2(e)};function $6(){Vi(1200),_C()}function Fy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function SC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function X6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var t0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?SC(e.slice(2)):t==254&&r==255?X6(e.slice(2)):t==65279?e.slice(1):e},Nf=function(t){return String.fromCharCode(t)},Ny=function(t){return String.fromCharCode(t)},gs,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ry(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,i=e.charCodeAt(f++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),t+=ys.charAt(a)+ys.charAt(s)+ys.charAt(o)+ys.charAt(u);return t}function ri(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=ys.indexOf(e.charAt(f++)),s=ys.indexOf(e.charAt(f++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=ys.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=ys.indexOf(e.charAt(f++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ro=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ds(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Iy(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zi=function(t){return _t?Ro(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Io(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function j2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return j2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ms=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ro(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function wC(e){for(var t=[],r=0,n=e.length+250,i=Ds(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ds(65535),n=65530)}return t.push(i.slice(0,r)),ms(t)}var Pn=/\u0000/g,r0=/[\u0001-\u0006]/g;function Ol(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gi(e,t){var r=""+e;return r.length>=t?r:sr("0",t-r.length)+r}function z2(e,t){var r=""+e;return r.length>=t?r:sr(" ",t-r.length)+r}function Rd(e,t){var r=""+e;return r.length>=t?r:r+sr(" ",t-r.length)}function kC(e,t){var r=""+Math.round(e);return r.length>=t?r:sr("0",t-r.length)+r}function EC(e,t){var r=""+e;return r.length>=t?r:sr("0",t-r.length)+r}var Dy=Math.pow(2,32);function ll(e,t){if(e>Dy||e<-Dy)return kC(e,t);var r=Math.round(e);return EC(r,t)}function Id(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Oy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},by={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},TC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dd(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),o=p*s+a,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),a=s,s=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=a):(d=f,o=s)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function po(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=IC(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var K6=new Date(1899,11,31,0,0,0),AC=K6.getTime(),PC=new Date(1900,2,1,0,0,0);function Y6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=PC&&(r+=24*60*60*1e3),(r-(AC+(e.getTimezoneOffset()-K6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function V2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NC(e){var t=e<0?12:11,r=V2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function RC(e){var t=V2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NC(e):t===10?r=e.toFixed(10).substr(0,12):r=RC(e),V2(FC(r.toUpperCase()))}function To(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ci(14,Y6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function IC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function DC(e,t,r,n){var i="",a=0,s=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return qp[r.m-1][1];case 5:return qp[r.m-1][0];default:return qp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Oy[r.q][0];default:return Oy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Gi(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?Gi(u,f):"";return d}function _s(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Q6=/%/g;function OC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ma(e,n,r*Math.pow(10,2*i))+sr("%",i)}function bC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ma(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function q6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J6=/# (\?+)( ?)\/( ?)(\d+)/;function LC(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?sr(" ",e[1].length+1+e[4].length):z2(s,e[1].length)+e[2]+"/"+e[3]+Gi(o,e[4].length))}function MC(e,t,r){return r+(t===0?"":""+t)+sr(" ",e[1].length+2+e[4].length)}var Z6=/^#*0*\.([0#]+)/,e8=/\).*[0#]/,t8=/\(###\) ###\\?-####/;function kn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ly(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function My(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function BC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function UC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function mi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(e8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mi("n",n,r):"("+mi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bC(e,t,r);if(t.indexOf("%")!==-1)return OC(e,t,r);if(t.indexOf("E")!==-1)return q6(t,r);if(t.charCodeAt(0)===36)return"$"+mi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ll(u,t.length);if(t.match(/^[#?]+$/))return i=ll(r,0),i==="0"&&(i=""),i.length>t.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return LC(a,u,f);if(t.match(/^#+0+$/))return f+ll(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=Ly(r,a[1].length).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])).replace(/\.(\d*)$/,function(g,_){return"."+_+sr("0",kn(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+Ly(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+_s(ll(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mi(e,t,-r):_s(""+(Math.floor(r)+BC(r,a[1].length)))+"."+Gi(My(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return mi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ol(mi(e,t.replace(/[\\-]/g,""),r)),s=0,Ol(Ol(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(t8))return i=mi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Dd(u,Math.pow(10,s)-1,!1),i=""+f,d=Ma("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Rd(o[2],s),d.length<a[4].length&&(d=kn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Dd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?z2(o[1],s)+a[2]+"/"+a[3]+Rd(o[2],s):sr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ll(r,0),t.length<=i.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,m=t.length-i.length-p;return kn(t.substr(0,p)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=My(r,a[1].length),r<0?"-"+mi(e,t,-r):_s(UC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gi(0,3-g.length):"")+g})+"."+Gi(s,a[1].length);switch(t){case"###,##0.00":return mi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=_s(ll(u,0));return v!=="0"?f+v:"";case"###,###.00":return mi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return mi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ma(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function zC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ma(e,n,r*Math.pow(10,2*i))+sr("%",i)}function r8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+r8(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function la(e,t,r){if(e.charCodeAt(0)===40&&!t.match(e8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?la("n",n,r):"("+la("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jC(e,t,r);if(t.indexOf("%")!==-1)return zC(e,t,r);if(t.indexOf("E")!==-1)return r8(t,r);if(t.charCodeAt(0)===36)return"$"+la(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Gi(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return MC(a,u,f);if(t.match(/^#+0+$/))return f+Gi(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])),i=i.replace(/\.(\d*)$/,function(g,_){return"."+_+sr("0",kn(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+_s(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+la(e,t,-r):_s(""+r)+"."+sr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return la(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ol(la(e,t.replace(/[\\-]/g,""),r)),s=0,Ol(Ol(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(t8))return i=la(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Dd(u,Math.pow(10,s)-1,!1),i=""+f,d=Ma("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Rd(o[2],s),d.length<a[4].length&&(d=kn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Dd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?z2(o[1],s)+a[2]+"/"+a[3]+Rd(o[2],s):sr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,m=t.length-i.length-p;return kn(t.substr(0,p)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+la(e,t,-r):_s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gi(0,3-g.length):"")+g})+"."+Gi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=_s(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return la(e,t.slice(0,t.lastIndexOf(".")),r)+kn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ma(e,t,r){return(r|0)===r?la(e,t,r):mi(e,t,r)}function VC(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var n8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Id(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(n8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function GC(e,t,r,n){for(var i=[],a="",s=0,o="",u="t",f,d,p,m="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Id(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(p=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++s;break;case"\\":var v=e.charAt(++s),g=v==="("||v===")"?v:"t";i[i.length]={t:g,v},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=po(t,r,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=po(t,r),f==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:a},u=o;break;case"A":case"a":case"":var _={t:o,v:o};if(f==null&&(f=po(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",m="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",s+=5,m="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(_.v=f.H>=12?"":""),_.t="T",s+=5,m="h"):(_.t="t",++s),f==null&&_.t==="T")return"";i[i.length]=_,u=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(n8)){if(f==null&&(f=po(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",nc(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var k=0,E=0,S;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=m,u="h",k<1&&(k=1);break;case"s":(S=i[s].v.match(/\.0+$/))&&(E=Math.max(E,S[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&i[s].v.match(/[Hh]/)&&(k=1),k<2&&i[s].v.match(/[Mm]/)&&(k=2),k<3&&i[s].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",C;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=DC(i[s].t.charCodeAt(0),i[s].v,f,E),i[s].t="t";break;case"n":case"?":for(C=s+1;i[C]!=null&&((o=i[C].t)==="?"||o==="D"||(o===" "||o==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[s].v+=i[C].v,i[C]={v:"",t:";"},++C;x+=i[s].v,s=C-1;break;case"G":i[s].t="t",i[s].v=To(t,r);break}var N="",T,F;if(x.length>0){x.charCodeAt(0)==40?(T=t<0&&x.charCodeAt(0)===45?-t:t,F=Ma("n",x,T)):(T=t<0&&n>1?-t:t,F=Ma("n",x,T),T<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),C=F.length-1;var P=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){P=s;break}var I=i.length;if(P===i.length&&F.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(C>=i[s].v.length-1?(C-=i[s].v.length,i[s].v=F.substr(C+1,i[s].v.length)):C<0?i[s].v="":(i[s].v=F.substr(0,C+1),C=-1),i[s].t="t",I=s);C>=0&&I<i.length&&(i[I].v=F.substr(0,C+1)+i[I].v)}else if(P!==i.length&&F.indexOf("E")===-1){for(C=F.indexOf(".")-1,s=P;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")-1:i[s].v.length-1,N=i[s].v.substr(d+1);d>=0;--d)C>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(N=F.charAt(C--)+N);i[s].v=N,i[s].t="t",I=s}for(C>=0&&I<i.length&&(i[I].v=F.substr(0,C+1)+i[I].v),C=F.indexOf(".")+1,s=P;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==P)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")+1:0,N=i[s].v.substr(0,d);d<i[s].v.length;++d)C<F.length&&(N+=F.charAt(C++));i[s].v=N,i[s].t="t",I=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(T=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Ma(i[s].t,i[s].v,T),i[s].t="t");var D="";for(s=0;s!==i.length;++s)i[s]!=null&&(D+=i[s].v);return D}var By=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function HC(e,t){var r=VC(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(By),o=r[1].match(By);return Uy(t,s)?[n,r[0]]:Uy(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Ci(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ct)[e],n==null&&(n=r.table&&r.table[by[e]]||ct[by[e]]),n==null&&(n=TC[e]||"General");break}if(Id(n,0))return To(t,r);t instanceof Date&&(t=Y6(t,r.date1904));var i=HC(n,t);if(Id(i[1]))return To(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return GC(i[1],t,r,i[0])}function vo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ct[r]==null){t<0&&(t=r);continue}if(ct[r]==e){t=r;break}}t<0&&(t=391)}return ct[t]=e,t}function i8(){ct=CC()}var WC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $C(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(a8,"(\\d+)"),new RegExp("^"+t+"$")}function XC(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,u=-1;(t.match(a8)||[]).forEach(function(p,m){var v=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":s=v;break;case"s":u=v;break;case"m":s>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var KC=function(){var e={};e.version="1.2.0";function t(){for(var F=0,P=new Array(256),I=0;I!=256;++I)F=I,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,P[I]=F;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(F){var P=0,I=0,D=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)U[D]=F[D];for(D=0;D!=256;++D)for(I=F[D],P=256+D;P<4096;P+=256)I=U[P]=I>>>8^F[I&255];var b=[];for(D=1;D!=16;++D)b[D-1]=typeof Int32Array<"u"?U.subarray(D*256,D*256+256):U.slice(D*256,D*256+256);return b}var i=n(r),a=i[0],s=i[1],o=i[2],u=i[3],f=i[4],d=i[5],p=i[6],m=i[7],v=i[8],g=i[9],_=i[10],k=i[11],E=i[12],S=i[13],x=i[14];function C(F,P){for(var I=P^-1,D=0,U=F.length;D<U;)I=I>>>8^r[(I^F.charCodeAt(D++))&255];return~I}function N(F,P){for(var I=P^-1,D=F.length-15,U=0;U<D;)I=x[F[U++]^I&255]^S[F[U++]^I>>8&255]^E[F[U++]^I>>16&255]^k[F[U++]^I>>>24]^_[F[U++]]^g[F[U++]]^v[F[U++]]^m[F[U++]]^p[F[U++]]^d[F[U++]]^f[F[U++]]^u[F[U++]]^o[F[U++]]^s[F[U++]]^a[F[U++]]^r[F[U++]];for(D+=15;U<D;)I=I>>>8^r[(I^F[U++])&255];return~I}function T(F,P){for(var I=P^-1,D=0,U=F.length,b=0,Q=0;D<U;)b=F.charCodeAt(D++),b<128?I=I>>>8^r[(I^b)&255]:b<2048?(I=I>>>8^r[(I^(192|b>>6&31))&255],I=I>>>8^r[(I^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,Q=F.charCodeAt(D++)&1023,I=I>>>8^r[(I^(240|b>>8&7))&255],I=I>>>8^r[(I^(128|b>>2&63))&255],I=I>>>8^r[(I^(128|Q>>6&15|(b&3)<<4))&255],I=I>>>8^r[(I^(128|Q&63))&255]):(I=I>>>8^r[(I^(224|b>>12&15))&255],I=I>>>8^r[(I^(128|b>>6&63))&255],I=I>>>8^r[(I^(128|b&63))&255]);return~I}return e.table=r,e.bstr=C,e.buf=N,e.str=T,e}(),Et=function(){var t={};t.version="1.2.1";function r(O,z){for(var M=O.split("/"),j=z.split("/"),H=0,W=0,ae=Math.min(M.length,j.length);H<ae;++H){if(W=M[H].length-j[H].length)return W;if(M[H]!=j[H])return M[H]<j[H]?-1:1}return M.length-j.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var z=O.lastIndexOf("/");return z===-1?O:O.slice(0,z+1)}function i(O){if(O.charAt(O.length-1)=="/")return i(O.slice(0,-1));var z=O.lastIndexOf("/");return z===-1?O:O.slice(z+1)}function a(O,z){typeof z=="string"&&(z=new Date(z));var M=z.getHours();M=M<<6|z.getMinutes(),M=M<<5|z.getSeconds()>>>1,O.write_shift(2,M);var j=z.getFullYear()-1980;j=j<<4|z.getMonth()+1,j=j<<5|z.getDate(),O.write_shift(2,j)}function s(O){var z=O.read_shift(2)&65535,M=O.read_shift(2)&65535,j=new Date,H=M&31;M>>>=5;var W=M&15;M>>>=4,j.setMilliseconds(0),j.setFullYear(M+1980),j.setMonth(W-1),j.setDate(H);var ae=z&31;z>>>=5;var ye=z&63;return z>>>=6,j.setHours(z),j.setMinutes(ye),j.setSeconds(ae<<1),j}function o(O){Kr(O,0);for(var z={},M=0;O.l<=O.length-4;){var j=O.read_shift(2),H=O.read_shift(2),W=O.l+H,ae={};switch(j){case 21589:M=O.read_shift(1),M&1&&(ae.mtime=O.read_shift(4)),H>5&&(M&2&&(ae.atime=O.read_shift(4)),M&4&&(ae.ctime=O.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}O.l=W,z[j]=ae}return z}var u;function f(){return u||(u={})}function d(O,z){if(O[0]==80&&O[1]==75)return qe(O,z);if((O[0]|32)==109&&(O[1]|32)==105)return Xs(O,z);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var M=3,j=512,H=0,W=0,ae=0,ye=0,ne=0,se=[],oe=O.slice(0,512);Kr(oe,0);var Ne=p(oe);switch(M=Ne[0],M){case 3:j=512;break;case 4:j=4096;break;case 0:if(Ne[1]==0)return qe(O,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}j!==512&&(oe=O.slice(0,j),Kr(oe,28));var Ue=O.slice(0,j);m(oe,M);var Ge=oe.read_shift(4,"i");if(M===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);oe.l+=4,ae=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),ye=oe.read_shift(4,"i"),H=oe.read_shift(4,"i"),ne=oe.read_shift(4,"i"),W=oe.read_shift(4,"i");for(var Oe=-1,je=0;je<109&&(Oe=oe.read_shift(4,"i"),!(Oe<0));++je)se[je]=Oe;var it=v(O,j);k(ne,W,it,j,se);var Ot=S(it,ae,se,j);Ot[ae].name="!Directory",H>0&&ye!==Q&&(Ot[ye].name="!MiniFAT"),Ot[se[0]].name="!FAT",Ot.fat_addrs=se,Ot.ssz=j;var jt={},gr=[],Ks=[],ya=[];x(ae,Ot,it,gr,H,jt,Ks,ye),g(Ks,ya,gr),gr.shift();var ai={FileIndex:Ks,FullPaths:ya};return z&&z.raw&&(ai.raw={header:Ue,sectors:it}),ai}function p(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(he,"Header Signature: "),O.l+=16;var z=O.read_shift(2,"u");return[O.read_shift(2,"u"),z]}function m(O,z){var M=9;switch(O.l+=2,M=O.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function v(O,z){for(var M=Math.ceil(O.length/z)-1,j=[],H=1;H<M;++H)j[H-1]=O.slice(H*z,(H+1)*z);return j[M-1]=O.slice(M*z),j}function g(O,z,M){for(var j=0,H=0,W=0,ae=0,ye=0,ne=M.length,se=[],oe=[];j<ne;++j)se[j]=oe[j]=j,z[j]=M[j];for(;ye<oe.length;++ye)j=oe[ye],H=O[j].L,W=O[j].R,ae=O[j].C,se[j]===j&&(H!==-1&&se[H]!==H&&(se[j]=se[H]),W!==-1&&se[W]!==W&&(se[j]=se[W])),ae!==-1&&(se[ae]=j),H!==-1&&j!=se[j]&&(se[H]=se[j],oe.lastIndexOf(H)<ye&&oe.push(H)),W!==-1&&j!=se[j]&&(se[W]=se[j],oe.lastIndexOf(W)<ye&&oe.push(W));for(j=1;j<ne;++j)se[j]===j&&(W!==-1&&se[W]!==W?se[j]=se[W]:H!==-1&&se[H]!==H&&(se[j]=se[H]));for(j=1;j<ne;++j)if(O[j].type!==0){if(ye=j,ye!=se[ye])do ye=se[ye],z[j]=z[ye]+"/"+z[j];while(ye!==0&&se[ye]!==-1&&ye!=se[ye]);se[j]=-1}for(z[0]+="/",j=1;j<ne;++j)O[j].type!==2&&(z[j]+="/")}function _(O,z,M){for(var j=O.start,H=O.size,W=[],ae=j;M&&H>0&&ae>=0;)W.push(z.slice(ae*b,ae*b+b)),H-=b,ae=co(M,ae*4);return W.length===0?Ar(0):ms(W).slice(0,O.size)}function k(O,z,M,j,H){var W=Q;if(O===Q){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ae=M[O],ye=(j>>>2)-1;if(!ae)return;for(var ne=0;ne<ye&&(W=co(ae,ne*4))!==Q;++ne)H.push(W);k(co(ae,j-4),z-1,M,j,H)}}function E(O,z,M,j,H){var W=[],ae=[];H||(H=[]);var ye=j-1,ne=0,se=0;for(ne=z;ne>=0;){H[ne]=!0,W[W.length]=ne,ae.push(O[ne]);var oe=M[Math.floor(ne*4/j)];if(se=ne*4&ye,j<4+se)throw new Error("FAT boundary crossed: "+ne+" 4 "+j);if(!O[oe])break;ne=co(O[oe],se)}return{nodes:W,data:Yy([ae])}}function S(O,z,M,j){var H=O.length,W=[],ae=[],ye=[],ne=[],se=j-1,oe=0,Ne=0,Ue=0,Ge=0;for(oe=0;oe<H;++oe)if(ye=[],Ue=oe+z,Ue>=H&&(Ue-=H),!ae[Ue]){ne=[];var Oe=[];for(Ne=Ue;Ne>=0;){Oe[Ne]=!0,ae[Ne]=!0,ye[ye.length]=Ne,ne.push(O[Ne]);var je=M[Math.floor(Ne*4/j)];if(Ge=Ne*4&se,j<4+Ge)throw new Error("FAT boundary crossed: "+Ne+" 4 "+j);if(!O[je]||(Ne=co(O[je],Ge),Oe[Ne]))break}W[Ue]={nodes:ye,data:Yy([ne])}}return W}function x(O,z,M,j,H,W,ae,ye){for(var ne=0,se=j.length?2:0,oe=z[O].data,Ne=0,Ue=0,Ge;Ne<oe.length;Ne+=128){var Oe=oe.slice(Ne,Ne+128);Kr(Oe,64),Ue=Oe.read_shift(2),Ge=X2(Oe,0,Ue-se),j.push(Ge);var je={name:Ge,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},it=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);it!==0&&(je.ct=C(Oe,Oe.l-8));var Ot=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Ot!==0&&(je.mt=C(Oe,Oe.l-8)),je.start=Oe.read_shift(4,"i"),je.size=Oe.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=Q,je.name=""),je.type===5?(ne=je.start,H>0&&ne!==Q&&(z[ne].name="!StreamData")):je.size>=4096?(je.storage="fat",z[je.start]===void 0&&(z[je.start]=E(M,je.start,z.fat_addrs,z.ssz)),z[je.start].name=je.name,je.content=z[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ne!==Q&&je.start!==Q&&z[ne]&&(je.content=_(je,z[ne].data,(z[ye]||{}).data))),je.content&&Kr(je.content,0),W[Ge]=je,ae.push(je)}}function C(O,z){return new Date((Qn(O,z+4)/1e7*Math.pow(2,32)+Qn(O,z)/1e7-11644473600)*1e3)}function N(O,z){return f(),d(u.readFileSync(O),z)}function T(O,z){var M=z&&z.type;switch(M||_t&&Buffer.isBuffer(O)&&(M="buffer"),M||"base64"){case"file":return N(O,z);case"base64":return d(zi(ri(O)),z);case"binary":return d(zi(O),z)}return d(O,z)}function F(O,z){var M=z||{},j=M.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=j+"/",O.FileIndex[0]={name:j,type:5}),M.CLSID&&(O.FileIndex[0].clsid=M.CLSID),P(O)}function P(O){var z="Sh33tJ5";if(!Et.find(O,"/"+z)){var M=Ar(4);M[0]=55,M[1]=M[3]=50,M[2]=54,O.FileIndex.push({name:z,type:2,content:M,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+z),I(O)}}function I(O,z){F(O);for(var M=!1,j=!1,H=O.FullPaths.length-1;H>=0;--H){var W=O.FileIndex[H];switch(W.type){case 0:j?M=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(W.R*W.L*W.C)&&(M=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!z)){var ae=new Date(1987,1,19),ye=0,ne=Object.create?Object.create(null):{},se=[];for(H=0;H<O.FullPaths.length;++H)ne[O.FullPaths[H]]=!0,O.FileIndex[H].type!==0&&se.push([O.FullPaths[H],O.FileIndex[H]]);for(H=0;H<se.length;++H){var oe=n(se[H][0]);j=ne[oe],j||(se.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Ae,ct:ae,mt:ae,content:null}]),ne[oe]=!0)}for(se.sort(function(Ge,Oe){return r(Ge[0],Oe[0])}),O.FullPaths=[],O.FileIndex=[],H=0;H<se.length;++H)O.FullPaths[H]=se[H][0],O.FileIndex[H]=se[H][1];for(H=0;H<se.length;++H){var Ne=O.FileIndex[H],Ue=O.FullPaths[H];if(Ne.name=i(Ue).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Ae,H===0)Ne.C=se.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Ue.slice(-1)=="/"){for(ye=H+1;ye<se.length&&n(O.FullPaths[ye])!=Ue;++ye);for(Ne.C=ye>=se.length?-1:ye,ye=H+1;ye<se.length&&n(O.FullPaths[ye])!=n(Ue);++ye);Ne.R=ye>=se.length?-1:ye,Ne.type=1}else n(O.FullPaths[H+1]||"")==n(Ue)&&(Ne.R=H+1),Ne.type=2}}}function D(O,z){var M=z||{};if(M.fileType=="mad")return $o(O,M);switch(I(O),M.fileType){case"zip":return dt(O,M)}var j=function(Ge){for(var Oe=0,je=0,it=0;it<Ge.FileIndex.length;++it){var Ot=Ge.FileIndex[it];if(Ot.content){var jt=Ot.content.length;jt>0&&(jt<4096?Oe+=jt+63>>6:je+=jt+511>>9)}}for(var gr=Ge.FullPaths.length+3>>2,Ks=Oe+7>>3,ya=Oe+127>>7,ai=Ks+je+gr+ya,en=ai+127>>7,bt=en<=109?0:Math.ceil((en-109)/127);ai+en+bt+127>>7>en;)bt=++en<=109?0:Math.ceil((en-109)/127);var vt=[1,bt,en,ya,gr,je,Oe,0];return Ge.FileIndex[0].size=Oe<<6,vt[7]=(Ge.FileIndex[0].start=vt[0]+vt[1]+vt[2]+vt[3]+vt[4]+vt[5])+(vt[6]+7>>3),vt}(O),H=Ar(j[7]<<9),W=0,ae=0;{for(W=0;W<8;++W)H.write_shift(1,te[W]);for(W=0;W<8;++W)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),W=0;W<3;++W)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,j[2]),H.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:Q),H.write_shift(4,j[3]),H.write_shift(-4,j[1]?j[0]-1:Q),H.write_shift(4,j[1]),W=0;W<109;++W)H.write_shift(-4,W<j[2]?j[1]+W:-1)}if(j[1])for(ae=0;ae<j[1];++ae){for(;W<236+ae*127;++W)H.write_shift(-4,W<j[2]?j[1]+W:-1);H.write_shift(-4,ae===j[1]-1?Q:ae+1)}var ye=function(Ge){for(ae+=Ge;W<ae-1;++W)H.write_shift(-4,W+1);Ge&&(++W,H.write_shift(-4,Q))};for(ae=W=0,ae+=j[1];W<ae;++W)H.write_shift(-4,Te.DIFSECT);for(ae+=j[2];W<ae;++W)H.write_shift(-4,Te.FATSECT);ye(j[3]),ye(j[4]);for(var ne=0,se=0,oe=O.FileIndex[0];ne<O.FileIndex.length;++ne)oe=O.FileIndex[ne],oe.content&&(se=oe.content.length,!(se<4096)&&(oe.start=ae,ye(se+511>>9)));for(ye(j[6]+7>>3);H.l&511;)H.write_shift(-4,Te.ENDOFCHAIN);for(ae=W=0,ne=0;ne<O.FileIndex.length;++ne)oe=O.FileIndex[ne],oe.content&&(se=oe.content.length,!(!se||se>=4096)&&(oe.start=ae,ye(se+63>>6)));for(;H.l&511;)H.write_shift(-4,Te.ENDOFCHAIN);for(W=0;W<j[4]<<2;++W){var Ne=O.FullPaths[W];if(!Ne||Ne.length===0){for(ne=0;ne<17;++ne)H.write_shift(4,0);for(ne=0;ne<3;++ne)H.write_shift(4,-1);for(ne=0;ne<12;++ne)H.write_shift(4,0);continue}oe=O.FileIndex[W],W===0&&(oe.start=oe.size?oe.start-1:Q);var Ue=W===0&&M.root||oe.name;if(se=2*(Ue.length+1),H.write_shift(64,Ue,"utf16le"),H.write_shift(2,se),H.write_shift(1,oe.type),H.write_shift(1,oe.color),H.write_shift(-4,oe.L),H.write_shift(-4,oe.R),H.write_shift(-4,oe.C),oe.clsid)H.write_shift(16,oe.clsid,"hex");else for(ne=0;ne<4;++ne)H.write_shift(4,0);H.write_shift(4,oe.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,oe.start),H.write_shift(4,oe.size),H.write_shift(4,0)}for(W=1;W<O.FileIndex.length;++W)if(oe=O.FileIndex[W],oe.size>=4096)if(H.l=oe.start+1<<9,_t&&Buffer.isBuffer(oe.content))oe.content.copy(H,H.l,0,oe.size),H.l+=oe.size+511&-512;else{for(ne=0;ne<oe.size;++ne)H.write_shift(1,oe.content[ne]);for(;ne&511;++ne)H.write_shift(1,0)}for(W=1;W<O.FileIndex.length;++W)if(oe=O.FileIndex[W],oe.size>0&&oe.size<4096)if(_t&&Buffer.isBuffer(oe.content))oe.content.copy(H,H.l,0,oe.size),H.l+=oe.size+63&-64;else{for(ne=0;ne<oe.size;++ne)H.write_shift(1,oe.content[ne]);for(;ne&63;++ne)H.write_shift(1,0)}if(_t)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function U(O,z){var M=O.FullPaths.map(function(ne){return ne.toUpperCase()}),j=M.map(function(ne){var se=ne.split("/");return se[se.length-(ne.slice(-1)=="/"?2:1)]}),H=!1;z.charCodeAt(0)===47?(H=!0,z=M[0].slice(0,-1)+z):H=z.indexOf("/")!==-1;var W=z.toUpperCase(),ae=H===!0?M.indexOf(W):j.indexOf(W);if(ae!==-1)return O.FileIndex[ae];var ye=!W.match(r0);for(W=W.replace(Pn,""),ye&&(W=W.replace(r0,"!")),ae=0;ae<M.length;++ae)if((ye?M[ae].replace(r0,"!"):M[ae]).replace(Pn,"")==W||(ye?j[ae].replace(r0,"!"):j[ae]).replace(Pn,"")==W)return O.FileIndex[ae];return null}var b=64,Q=-2,he="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",Te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(O,z,M){f();var j=D(O,M);u.writeFileSync(z,j)}function X(O){for(var z=new Array(O.length),M=0;M<O.length;++M)z[M]=String.fromCharCode(O[M]);return z.join("")}function ce(O,z){var M=D(O,z);switch(z&&z.type||"buffer"){case"file":return f(),u.writeFileSync(z.filename,M),M;case"binary":return typeof M=="string"?M:X(M);case"base64":return Ry(typeof M=="string"?M:X(M));case"buffer":if(_t)return Buffer.isBuffer(M)?M:Ro(M);case"array":return typeof M=="string"?zi(M):M}return M}var Ce;function L(O){try{var z=O.InflateRaw,M=new z;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Ce=O;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function q(O,z){if(!Ce)return Xe(O,z);var M=Ce.InflateRaw,j=new M,H=j._processChunk(O.slice(O.l),j._finishFlushFlag);return O.l+=j.bytesRead,H}function Y(O){return Ce?Ce.deflateRawSync(O):xe(O)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(O){var z=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(z>>16|z>>8|z)&255}for(var ue=typeof Uint8Array<"u",ve=ue?new Uint8Array(256):[],Be=0;Be<256;++Be)ve[Be]=J(Be);function V(O,z){var M=ve[O&255];return z<=8?M>>>8-z:(M=M<<8|ve[O>>8&255],z<=16?M>>>16-z:(M=M<<8|ve[O>>16&255],M>>>24-z))}function Ze(O,z){var M=z&7,j=z>>>3;return(O[j]|(M<=6?0:O[j+1]<<8))>>>M&3}function nt(O,z){var M=z&7,j=z>>>3;return(O[j]|(M<=5?0:O[j+1]<<8))>>>M&7}function Ye(O,z){var M=z&7,j=z>>>3;return(O[j]|(M<=4?0:O[j+1]<<8))>>>M&15}function Je(O,z){var M=z&7,j=z>>>3;return(O[j]|(M<=3?0:O[j+1]<<8))>>>M&31}function Re(O,z){var M=z&7,j=z>>>3;return(O[j]|(M<=1?0:O[j+1]<<8))>>>M&127}function wt(O,z,M){var j=z&7,H=z>>>3,W=(1<<M)-1,ae=O[H]>>>j;return M<8-j||(ae|=O[H+1]<<8-j,M<16-j)||(ae|=O[H+2]<<16-j,M<24-j)||(ae|=O[H+3]<<24-j),ae&W}function Or(O,z,M){var j=z&7,H=z>>>3;return j<=5?O[H]|=(M&7)<<j:(O[H]|=M<<j&255,O[H+1]=(M&7)>>8-j),z+3}function pr(O,z,M){var j=z&7,H=z>>>3;return M=(M&1)<<j,O[H]|=M,z+1}function _e(O,z,M){var j=z&7,H=z>>>3;return M<<=j,O[H]|=M&255,M>>>=8,O[H+1]=M,z+8}function me(O,z,M){var j=z&7,H=z>>>3;return M<<=j,O[H]|=M&255,M>>>=8,O[H+1]=M&255,O[H+2]=M>>>8,z+16}function Se(O,z){var M=O.length,j=2*M>z?2*M:z+5,H=0;if(M>=z)return O;if(_t){var W=Iy(j);if(O.copy)O.copy(W);else for(;H<O.length;++H)W[H]=O[H];return W}else if(ue){var ae=new Uint8Array(j);if(ae.set)ae.set(O);else for(;H<M;++H)ae[H]=O[H];return ae}return O.length=j,O}function we(O){for(var z=new Array(O),M=0;M<O;++M)z[M]=0;return z}function Ee(O,z,M){var j=1,H=0,W=0,ae=0,ye=0,ne=O.length,se=ue?new Uint16Array(32):we(32);for(W=0;W<32;++W)se[W]=0;for(W=ne;W<M;++W)O[W]=0;ne=O.length;var oe=ue?new Uint16Array(ne):we(ne);for(W=0;W<ne;++W)se[H=O[W]]++,j<H&&(j=H),oe[W]=0;for(se[0]=0,W=1;W<=j;++W)se[W+16]=ye=ye+se[W-1]<<1;for(W=0;W<ne;++W)ye=O[W],ye!=0&&(oe[W]=se[ye+16]++);var Ne=0;for(W=0;W<ne;++W)if(Ne=O[W],Ne!=0)for(ye=V(oe[W],j)>>j-Ne,ae=(1<<j+4-Ne)-1;ae>=0;--ae)z[ye|ae<<Ne]=Ne&15|W<<4;return j}var Pe=ue?new Uint16Array(512):we(512),Me=ue?new Uint16Array(32):we(32);if(!ue){for(var pe=0;pe<512;++pe)Pe[pe]=0;for(pe=0;pe<32;++pe)Me[pe]=0}(function(){for(var O=[],z=0;z<32;z++)O.push(5);Ee(O,Me,32);var M=[];for(z=0;z<=143;z++)M.push(8);for(;z<=255;z++)M.push(9);for(;z<=279;z++)M.push(7);for(;z<=287;z++)M.push(8);Ee(M,Pe,288)})();var re=function(){for(var z=ue?new Uint8Array(32768):[],M=0,j=0;M<G.length-1;++M)for(;j<G[M+1];++j)z[j]=M;for(;j<32768;++j)z[j]=29;var H=ue?new Uint8Array(259):[];for(M=0,j=0;M<de.length-1;++M)for(;j<de[M+1];++j)H[j]=M;function W(ye,ne){for(var se=0;se<ye.length;){var oe=Math.min(65535,ye.length-se),Ne=se+oe==ye.length;for(ne.write_shift(1,+Ne),ne.write_shift(2,oe),ne.write_shift(2,~oe&65535);oe-- >0;)ne[ne.l++]=ye[se++]}return ne.l}function ae(ye,ne){for(var se=0,oe=0,Ne=ue?new Uint16Array(32768):[];oe<ye.length;){var Ue=Math.min(65535,ye.length-oe);if(Ue<10){for(se=Or(ne,se,+(oe+Ue==ye.length)),se&7&&(se+=8-(se&7)),ne.l=se/8|0,ne.write_shift(2,Ue),ne.write_shift(2,~Ue&65535);Ue-- >0;)ne[ne.l++]=ye[oe++];se=ne.l*8;continue}se=Or(ne,se,+(oe+Ue==ye.length)+2);for(var Ge=0;Ue-- >0;){var Oe=ye[oe];Ge=(Ge<<5^Oe)&32767;var je=-1,it=0;if((je=Ne[Ge])&&(je|=oe&-32768,je>oe&&(je-=32768),je<oe))for(;ye[je+it]==ye[oe+it]&&it<250;)++it;if(it>2){Oe=H[it],Oe<=22?se=_e(ne,se,ve[Oe+1]>>1)-1:(_e(ne,se,3),se+=5,_e(ne,se,ve[Oe-23]>>5),se+=3);var Ot=Oe<8?0:Oe-4>>2;Ot>0&&(me(ne,se,it-de[Oe]),se+=Ot),Oe=z[oe-je],se=_e(ne,se,ve[Oe]>>3),se-=3;var jt=Oe<4?0:Oe-2>>1;jt>0&&(me(ne,se,oe-je-G[Oe]),se+=jt);for(var gr=0;gr<it;++gr)Ne[Ge]=oe&32767,Ge=(Ge<<5^ye[oe])&32767,++oe;Ue-=it-1}else Oe<=143?Oe=Oe+48:se=pr(ne,se,1),se=_e(ne,se,ve[Oe]),Ne[Ge]=oe&32767,++oe}se=_e(ne,se,0)-1}return ne.l=(se+7)/8|0,ne.l}return function(ne,se){return ne.length<8?W(ne,se):ae(ne,se)}}();function xe(O){var z=Ar(50+Math.floor(O.length*1.1)),M=re(O,z);return z.slice(0,M)}var De=ue?new Uint16Array(32768):we(32768),Le=ue?new Uint16Array(32768):we(32768),Ke=ue?new Uint16Array(128):we(128),xt=1,Dt=1;function Ut(O,z){var M=Je(O,z)+257;z+=5;var j=Je(O,z)+1;z+=5;var H=Ye(O,z)+4;z+=4;for(var W=0,ae=ue?new Uint8Array(19):we(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,se=ue?new Uint8Array(8):we(8),oe=ue?new Uint8Array(8):we(8),Ne=ae.length,Ue=0;Ue<H;++Ue)ae[K[Ue]]=W=nt(O,z),ne<W&&(ne=W),se[W]++,z+=3;var Ge=0;for(se[0]=0,Ue=1;Ue<=ne;++Ue)oe[Ue]=Ge=Ge+se[Ue-1]<<1;for(Ue=0;Ue<Ne;++Ue)(Ge=ae[Ue])!=0&&(ye[Ue]=oe[Ge]++);var Oe=0;for(Ue=0;Ue<Ne;++Ue)if(Oe=ae[Ue],Oe!=0){Ge=ve[ye[Ue]]>>8-Oe;for(var je=(1<<7-Oe)-1;je>=0;--je)Ke[Ge|je<<Oe]=Oe&7|Ue<<3}var it=[];for(ne=1;it.length<M+j;)switch(Ge=Ke[Re(O,z)],z+=Ge&7,Ge>>>=3){case 16:for(W=3+Ze(O,z),z+=2,Ge=it[it.length-1];W-- >0;)it.push(Ge);break;case 17:for(W=3+nt(O,z),z+=3;W-- >0;)it.push(0);break;case 18:for(W=11+Re(O,z),z+=7;W-- >0;)it.push(0);break;default:it.push(Ge),ne<Ge&&(ne=Ge);break}var Ot=it.slice(0,M),jt=it.slice(M);for(Ue=M;Ue<286;++Ue)Ot[Ue]=0;for(Ue=j;Ue<30;++Ue)jt[Ue]=0;return xt=Ee(Ot,De,286),Dt=Ee(jt,Le,30),z}function Fe(O,z){if(O[0]==3&&!(O[1]&3))return[Ds(z),2];for(var M=0,j=0,H=Iy(z||1<<18),W=0,ae=H.length>>>0,ye=0,ne=0;!(j&1);){if(j=nt(O,M),M+=3,j>>>1)j>>1==1?(ye=9,ne=5):(M=Ut(O,M),ye=xt,ne=Dt);else{M&7&&(M+=8-(M&7));var se=O[M>>>3]|O[(M>>>3)+1]<<8;if(M+=32,se>0)for(!z&&ae<W+se&&(H=Se(H,W+se),ae=H.length);se-- >0;)H[W++]=O[M>>>3],M+=8;continue}for(;;){!z&&ae<W+32767&&(H=Se(H,W+32767),ae=H.length);var oe=wt(O,M,ye),Ne=j>>>1==1?Pe[oe]:De[oe];if(M+=Ne&15,Ne>>>=4,!(Ne>>>8&255))H[W++]=Ne;else{if(Ne==256)break;Ne-=257;var Ue=Ne<8?0:Ne-4>>2;Ue>5&&(Ue=0);var Ge=W+de[Ne];Ue>0&&(Ge+=wt(O,M,Ue),M+=Ue),oe=wt(O,M,ne),Ne=j>>>1==1?Me[oe]:Le[oe],M+=Ne&15,Ne>>>=4;var Oe=Ne<4?0:Ne-2>>1,je=G[Ne];for(Oe>0&&(je+=wt(O,M,Oe),M+=Oe),!z&&ae<Ge&&(H=Se(H,Ge+100),ae=H.length);W<Ge;)H[W]=H[W-je],++W}}}return z?[H,M+7>>>3]:[H.slice(0,W),M+7>>>3]}function Xe(O,z){var M=O.slice(O.l||0),j=Fe(M,z);return O.l+=j[1],j[0]}function Qe(O,z){if(O)typeof console<"u"&&console.error(z);else throw new Error(z)}function qe(O,z){var M=O;Kr(M,0);var j=[],H=[],W={FileIndex:j,FullPaths:H};F(W,{root:z.root});for(var ae=M.length-4;(M[ae]!=80||M[ae+1]!=75||M[ae+2]!=5||M[ae+3]!=6)&&ae>=0;)--ae;M.l=ae+4,M.l+=4;var ye=M.read_shift(2);M.l+=6;var ne=M.read_shift(4);for(M.l=ne,ae=0;ae<ye;++ae){M.l+=20;var se=M.read_shift(4),oe=M.read_shift(4),Ne=M.read_shift(2),Ue=M.read_shift(2),Ge=M.read_shift(2);M.l+=8;var Oe=M.read_shift(4),je=o(M.slice(M.l+Ne,M.l+Ne+Ue));M.l+=Ne+Ue+Ge;var it=M.l;M.l=Oe+4,kt(M,se,oe,W,je),M.l=it}return W}function kt(O,z,M,j,H){O.l+=2;var W=O.read_shift(2),ae=O.read_shift(2),ye=s(O);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ne=O.read_shift(4),se=O.read_shift(4),oe=O.read_shift(4),Ne=O.read_shift(2),Ue=O.read_shift(2),Ge="",Oe=0;Oe<Ne;++Oe)Ge+=String.fromCharCode(O[O.l++]);if(Ue){var je=o(O.slice(O.l,O.l+Ue));(je[21589]||{}).mt&&(ye=je[21589].mt),((H||{})[21589]||{}).mt&&(ye=H[21589].mt)}O.l+=Ue;var it=O.slice(O.l,O.l+se);switch(ae){case 8:it=q(O,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Ot=!1;W&8&&(ne=O.read_shift(4),ne==134695760&&(ne=O.read_shift(4),Ot=!0),se=O.read_shift(4),oe=O.read_shift(4)),se!=z&&Qe(Ot,"Bad compressed size: "+z+" != "+se),oe!=M&&Qe(Ot,"Bad uncompressed size: "+M+" != "+oe),hc(j,Ge,it,{unsafe:!0,mt:ye})}function dt(O,z){var M=z||{},j=[],H=[],W=Ar(1),ae=M.compression?8:0,ye=0,ne=0,se=0,oe=0,Ne=0,Ue=O.FullPaths[0],Ge=Ue,Oe=O.FileIndex[0],je=[],it=0;for(ne=1;ne<O.FullPaths.length;++ne)if(Ge=O.FullPaths[ne].slice(Ue.length),Oe=O.FileIndex[ne],!(!Oe.size||!Oe.content||Ge=="Sh33tJ5")){var Ot=oe,jt=Ar(Ge.length);for(se=0;se<Ge.length;++se)jt.write_shift(1,Ge.charCodeAt(se)&127);jt=jt.slice(0,jt.l),je[Ne]=KC.buf(Oe.content,0);var gr=Oe.content;ae==8&&(gr=Y(gr)),W=Ar(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,ae),Oe.mt?a(W,Oe.mt):W.write_shift(4,0),W.write_shift(-4,je[Ne]),W.write_shift(4,gr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,jt.length),W.write_shift(2,0),oe+=W.length,j.push(W),oe+=jt.length,j.push(jt),oe+=gr.length,j.push(gr),W=Ar(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,ae),W.write_shift(4,0),W.write_shift(-4,je[Ne]),W.write_shift(4,gr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,jt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Ot),it+=W.l,H.push(W),it+=jt.length,H.push(jt),++Ne}return W=Ar(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Ne),W.write_shift(2,Ne),W.write_shift(4,it),W.write_shift(4,oe),W.write_shift(2,0),ms([ms(j),ms(H),W])}var gt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Hn(O,z){if(O.ctype)return O.ctype;var M=O.name||"",j=M.match(/\.([^\.]+)$/);return j&&gt[j[1]]||z&&(j=(M=z).match(/[\.\\]([^\.\\])+$/),j&&gt[j[1]])?gt[j[1]]:"application/octet-stream"}function yn(O){for(var z=Ry(O),M=[],j=0;j<z.length;j+=76)M.push(z.slice(j,j+76));return M.join(`\r
`)+`\r
`}function va(O){var z=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var oe=se.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],j=z.split(`\r
`),H=0;H<j.length;++H){var W=j[H];if(W.length==0){M.push("");continue}for(var ae=0;ae<W.length;){var ye=76,ne=W.slice(ae,ae+ye);ne.charAt(ye-1)=="="?ye--:ne.charAt(ye-2)=="="?ye-=2:ne.charAt(ye-3)=="="&&(ye-=3),ne=W.slice(ae,ae+ye),ae+=ye,ae<W.length&&(ne+="="),M.push(ne)}}return M.join(`\r
`)}function _n(O){for(var z=[],M=0;M<O.length;++M){for(var j=O[M];M<=O.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+O[++M];z.push(j)}for(var H=0;H<z.length;++H)z[H]=z[H].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return zi(z.join(`\r
`))}function Zr(O,z,M){for(var j="",H="",W="",ae,ye=0;ye<10;++ye){var ne=z[ye];if(!ne||ne.match(/^\s*$/))break;var se=ne.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":j=se[2].trim();break;case"content-type":W=se[2].trim();break;case"content-transfer-encoding":H=se[2].trim();break}}switch(++ye,H.toLowerCase()){case"base64":ae=zi(ri(z.slice(ye).join("")));break;case"quoted-printable":ae=_n(z.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var oe=hc(O,j.slice(M.length),ae,{unsafe:!0});W&&(oe.ctype=W)}function Xs(O,z){if(X(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=z&&z.root||"",j=(_t&&Buffer.isBuffer(O)?O.toString("binary"):X(O)).split(`\r
`),H=0,W="";for(H=0;H<j.length;++H)if(W=j[H],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),M||(M=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),W.slice(0,M.length)!=M););var ae=(j[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ye="--"+(ae[1]||""),ne=[],se=[],oe={FileIndex:ne,FullPaths:se};F(oe);var Ne,Ue=0;for(H=0;H<j.length;++H){var Ge=j[H];Ge!==ye&&Ge!==ye+"--"||(Ue++&&Zr(oe,j.slice(Ne,H),M),Ne=H)}return oe}function $o(O,z){var M=z||{},j=M.boundary||"SheetJS";j="------="+j;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],W=O.FullPaths[0],ae=W,ye=O.FileIndex[0],ne=1;ne<O.FullPaths.length;++ne)if(ae=O.FullPaths[ne].slice(W.length),ye=O.FileIndex[ne],!(!ye.size||!ye.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var se=ye.content,oe=_t&&Buffer.isBuffer(se)?se.toString("binary"):X(se),Ne=0,Ue=Math.min(1024,oe.length),Ge=0,Oe=0;Oe<=Ue;++Oe)(Ge=oe.charCodeAt(Oe))>=32&&Ge<128&&++Ne;var je=Ne>=Ue*4/5;H.push(j),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ae),H.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),H.push("Content-Type: "+Hn(ye,ae)),H.push(""),H.push(je?va(oe):yn(oe))}return H.push(j+`--\r
`),H.join(`\r
`)}function f1(O){var z={};return F(z,O),z}function hc(O,z,M,j){var H=j&&j.unsafe;H||F(O);var W=!H&&Et.find(O,z);if(!W){var ae=O.FullPaths[0];z.slice(0,ae.length)==ae?ae=z:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+z).replace("//","/")),W={name:i(z),type:2},O.FileIndex.push(W),O.FullPaths.push(ae),H||Et.utils.cfb_gc(O)}return W.content=M,W.size=M?M.length:0,j&&(j.CLSID&&(W.clsid=j.CLSID),j.mt&&(W.mt=j.mt),j.ct&&(W.ct=j.ct)),W}function yu(O,z){F(O);var M=Et.find(O,z);if(M){for(var j=0;j<O.FileIndex.length;++j)if(O.FileIndex[j]==M)return O.FileIndex.splice(j,1),O.FullPaths.splice(j,1),!0}return!1}function pc(O,z,M){F(O);var j=Et.find(O,z);if(j){for(var H=0;H<O.FileIndex.length;++H)if(O.FileIndex[H]==j)return O.FileIndex[H].name=i(M),O.FullPaths[H]=M,!0}return!1}function d1(O){I(O,!0)}return t.find=U,t.read=T,t.parse=d,t.write=ce,t.writeFile=ie,t.utils={cfb_new:f1,cfb_add:hc,cfb_del:yu,cfb_mov:pc,cfb_gc:d1,ReadShift:m0,CheckField:P8,prep_blob:Kr,bconcat:ms,use_zlib:L,_deflateRaw:xe,_inflateRaw:Xe,consts:Te},t}();function YC(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function pa(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function G2(e){for(var t=[],r=pa(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Od=new Date(1899,11,30,0,0,0);function Fn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Od.getTime()+(e.getTimezoneOffset()-Od.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var s8=new Date,QC=Od.getTime()+(s8.getTimezoneOffset()-Od.getTimezoneOffset())*6e4,jy=s8.getTimezoneOffset();function gh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+QC),t.getTimezoneOffset()!==jy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-jy)*6e4),t}function qC(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var zy=new Date("2017-02-19T19:06:09.000Z"),o8=isNaN(zy.getFullYear())?new Date("2/19/17"):zy,JC=o8.getFullYear()==2017;function Hr(e,t){var r=new Date(e);if(JC)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(o8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ao(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return i0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return i0(X6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return i0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return i0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Qr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Qr(e[r]));return t}function sr(e,t){for(var r="";r.length<t;)r+=e;return r}function Xi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var ZC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&ZC.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var e7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function l8(e){return e?e.content&&e.type?Ao(e.content,!0):e.data?t0(e.data):e.asNodeBuffer&&_t?t0(e.asNodeBuffer().toString("binary")):e.asBinary?t0(e.asBinary()):e._data&&e._data.getContent?t0(Ao(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function c8(e){if(!e)return null;if(e.data)return Fy(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Fy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function t7(e){return e&&e.name.slice(-4)===".bin"?c8(e):l8(e)}function xi(e,t){for(var r=e.FullPaths||pa(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function H2(e,t){var r=xi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function vr(e,t,r){if(!r)return t7(H2(e,t));if(!t)return null;try{return vr(e,t)}catch{return null}}function qn(e,t,r){if(!r)return l8(H2(e,t));if(!t)return null;try{return qn(e,t)}catch{return null}}function u8(e,t,r){if(!r)return c8(H2(e,t));if(!t)return null;try{return u8(e,t)}catch{return null}}function Vy(e){for(var t=e.FullPaths||pa(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function r7(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=Ro(r):n=wC(r),Et.utils.cfb_add(e,t,n)}Et.utils.cfb_add(e,t,r)}else e.file(t,r)}function f8(e,t){switch(t.type){case"base64":return Et.read(e,{type:"base64"});case"binary":return Et.read(e,{type:"binary"});case"buffer":case"array":return Et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function n0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var d8=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,n7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,i7=/<[^>]*>/g,xn=d8.match(Gy)?Gy:i7,a7=/<\w*:/,s7=/<(\/?)\w+:/;function tt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(n7),o=0,u="",f=0,d="",p="",m=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(d=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(m=(i=p.charCodeAt(a+1))==34||i==39?1:0,u=p.slice(a+1+m,p.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,r||(n[d.toLowerCase()]=u);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=u,r||(n[v.toLowerCase()]=u)}}return n}function ga(e){return e.replace(s7,"<$1")}var h8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o7=G2(h8),At=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,u){return h8[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),l7=/[&<>'"]/g,c7=/[\u0000-\u001f]/g;function W2(e){var t=e+"";return t.replace(l7,function(r){return o7[r]}).replace(/\n/g,"<br/>").replace(c7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Hy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Qt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jp(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Wy(e){var t=Ds(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function $y(e){return Ro(e,"binary").toString("utf8")}var Rf="foo bar baz",Ht=_t&&($y(Rf)==Jp(Rf)&&$y||Wy(Rf)==Jp(Rf)&&Wy)||Jp,i0=_t?function(e){return Ro(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},X0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),p8=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),u7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),f7=/<\/?(?:vt:)?variant>/g,d7=/<(?:vt:)([^>]*)>([\s\S]*)</;function Xy(e,t){var r=tt(e),n=e.match(u7(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(f7,"").match(d7);s&&i.push({v:Ht(s[2]),t:s[1]})}),i}var h7=/(^\s|\s$|\n)/;function p7(e){return pa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function g7(e,t,r){return"<"+e+(r!=null?p7(r):"")+(t!=null?(t.match(h7)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $2(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ht(Io(j2(e)));throw new Error("Bad input format: expected Buffer or string")}var K0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,m7={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},x7=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function v7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function y7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Ky=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Yy=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ro(t)})):Ky(e)}:Ky,Qy=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ba(e,i)));return n.join("").replace(Pn,"")},X2=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pn,""):Qy(e,t,r)}:Qy,qy=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},g8=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qy(e,t,r)}:qy,Jy=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(hl(e,i)));return n.join("")},lu=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Jy(t,r,n)}:Jy,m8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},x8=m8,v8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},y8=v8,_8=function(e,t){var r=2*Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},S8=_8,w8=function(t,r){var n=Qn(t,r);return n>0?X2(t,r+4,r+4+n):""},k8=w8,E8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r):""},C8=E8,T8=function(e,t){return v7(e,t)},bd=T8,A8=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(x8=function(t,r){if(!Buffer.isBuffer(t))return m8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},y8=function(t,r){if(!Buffer.isBuffer(t))return v8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},S8=function(t,r){if(!Buffer.isBuffer(t))return _8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},k8=function(t,r){if(!Buffer.isBuffer(t))return w8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},C8=function(t,r){if(!Buffer.isBuffer(t))return E8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},bd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):T8(t,r)},A8=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var hl=function(e,t){return e[t]},ba=function(e,t){return e[t+1]*256+e[t]},_7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},co=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},S7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function m0(e,t){var r="",n,i,a=[],s,o,u,f;switch(t){case"dbcs":if(f=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(ba(this,f)),f+=2;e*=2;break;case"utf8":r=lu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=X2(this,this.l,this.l+e);break;case"wstr":return m0.call(this,e,"dbcs");case"lpstr-ansi":r=x8(this,this.l),e=4+Qn(this,this.l);break;case"lpstr-cp":r=y8(this,this.l),e=4+Qn(this,this.l);break;case"lpwstr":r=S8(this,this.l),e=4+2*Qn(this,this.l);break;case"lpp4":e=4+Qn(this,this.l),r=k8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qn(this,this.l),r=C8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=hl(this,this.l+e++))!==0;)a.push(Nf(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=ba(this,this.l+e))!==0;)a.push(Nf(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nf(ba(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nf(hl(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=hl(this,this.l),this.l++,n;case 2:return n=(t==="i"?_7:ba)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?co:S7)(this,this.l),this.l+=4,n):(i=Qn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=bd(this,this.l):i=bd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=g8(this,this.l,e);break}}return this.l+=e,r}var w7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},k7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},E7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function C7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)E7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,w7(this,t,this.l);break;case 8:if(n=8,r==="f"){y7(this,t,this.l);break}case 16:break;case-4:n=4,k7(this,t,this.l);break}return this.l+=n,this}function P8(e,t){var r=g8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Kr(e,t){e.l=t,e.read_shift=m0,e.chk=P8,e.write_shift=C7}function mn(e,t){e.l+=t}function Ar(e){var t=Ds(e);return Kr(t,0),t}function Xa(e,t,r){if(e){var n,i,a;Kr(e,e.l||0);for(var s=e.length,o=0,u=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=zd[o]||zd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,o))return}}}function _m(){var e=[],t=_t?256:2048,r=function(f){var d=Ar(f);return Kr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},s=function(){return i(),ms(e)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function x0(e,t,r){var n=Qr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Zy(e,t,r){var n=Qr(e);return n.s=x0(n.s,t.s,r),n.e=x0(n.e,t.s,r),n}function v0(e,t){if(e.cRel&&e.c<0)for(e=Qr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=P7(r)),!e.rRel&&e.rRel!=null&&(r=T7(r)),r}function Zp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Nr(e.s.c)+":"+(e.e.cRel?"":"$")+Nr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+qr(e.s.r)+":"+(e.e.rRel?"":"$")+qr(e.e.r):v0(e.s,t.biff)+":"+v0(e.e,t.biff)}function K2(e){return parseInt(A7(e),10)-1}function qr(e){return""+(e+1)}function T7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function A7(e){return e.replace(/\$(\d+)$/,"$1")}function Y2(e){for(var t=F7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Nr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function P7(e){return e.replace(/^([A-Z])/,"$$$1")}function F7(e){return e.replace(/^\$([A-Z])/,"$1")}function N7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ic(e){var t=e.indexOf(":");return t==-1?{s:Tn(e),e:Tn(e)}:{s:Tn(e.slice(0,t)),e:Tn(e.slice(t+1))}}function Ct(e,t){return typeof t>"u"||typeof t=="number"?Ct(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function lr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function e3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ci(e.z,r?Fn(t):t)}catch{}try{return e.w=Ci((e.XF||{}).numFmtId||(r?14:0),r?Fn(t):t)}catch{return""+t}}function Wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?bo[e.v]||e.v:t==null?e3(e,e.v):e3(e,t))}function Us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function F8(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Tn(n.origin):n.origin;s=u.r,o=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=lr(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var v={v:t[p][m]},g=s+p,_=o+m;if(f.s.r>g&&(f.s.r=g),f.s.c>_&&(f.s.c=_),f.e.r<g&&(f.e.r=g),f.e.c<_&&(f.e.c=_),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))v=t[p][m];else if(Array.isArray(v.v)&&(v.f=t[p][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ct[14],n.cellDates?(v.t="d",v.w=Ci(v.z,Fn(v.v))):(v.t="n",v.v=Fn(v.v),v.w=Ci(v.z,v.v))):v.t="s";if(i)a[g]||(a[g]=[]),a[g][_]&&a[g][_].z&&(v.z=a[g][_].z),a[g][_]=v;else{var k=st({c:_,r:g});a[k]&&a[k].z&&(v.z=a[k].z),a[k]=v}}}return f.s.c<1e7&&(a["!ref"]=Ct(f)),a}function ac(e,t){return F8(null,e,t)}function R7(e){return e.read_shift(4,"i")}function pn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function I7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Q2(e,t){var r=e.l,n=e.read_shift(1),i=pn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),u=0;u!=o;++u)a.push(I7(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var D7=Q2;function Ti(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Do(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var O7=pn;function q2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var b7=pn,Sm=q2;function J2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?bd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):co(t,0)>>2;return r?i/100:i}function N8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Oo=N8;function dn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function L7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=yo[i];f&&(t.rgb=Q0(f));break;case 2:t.rgb=Q0([s,o,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function M7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function R8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function B7(e){return R8(e,1)}function U7(e){return R8(e,2)}var Z2=2,Bn=3,If=11,t3=12,Ld=19,Df=64,j7=65,z7=71,V7=4108,G7=4126,zr=80,I8=81,H7=[zr,I8],W7={1:{n:"CodePage",t:Z2},2:{n:"Category",t:zr},3:{n:"PresentationFormat",t:zr},4:{n:"ByteCount",t:Bn},5:{n:"LineCount",t:Bn},6:{n:"ParagraphCount",t:Bn},7:{n:"SlideCount",t:Bn},8:{n:"NoteCount",t:Bn},9:{n:"HiddenCount",t:Bn},10:{n:"MultimediaClipCount",t:Bn},11:{n:"ScaleCrop",t:If},12:{n:"HeadingPairs",t:V7},13:{n:"TitlesOfParts",t:G7},14:{n:"Manager",t:zr},15:{n:"Company",t:zr},16:{n:"LinksUpToDate",t:If},17:{n:"CharacterCount",t:Bn},19:{n:"SharedDoc",t:If},22:{n:"HyperlinksChanged",t:If},23:{n:"AppVersion",t:Bn,p:"version"},24:{n:"DigSig",t:j7},26:{n:"ContentType",t:zr},27:{n:"ContentStatus",t:zr},28:{n:"Language",t:zr},29:{n:"Version",t:zr},255:{},2147483648:{n:"Locale",t:Ld},2147483651:{n:"Behavior",t:Ld},1919054434:{}},$7={1:{n:"CodePage",t:Z2},2:{n:"Title",t:zr},3:{n:"Subject",t:zr},4:{n:"Author",t:zr},5:{n:"Keywords",t:zr},6:{n:"Comments",t:zr},7:{n:"Template",t:zr},8:{n:"LastAuthor",t:zr},9:{n:"RevNumber",t:zr},10:{n:"EditTime",t:Df},11:{n:"LastPrinted",t:Df},12:{n:"CreatedDate",t:Df},13:{n:"ModifiedDate",t:Df},14:{n:"PageCount",t:Bn},15:{n:"WordCount",t:Bn},16:{n:"CharCount",t:Bn},17:{n:"Thumbnail",t:z7},18:{n:"Application",t:zr},19:{n:"DocSecurity",t:Bn},255:{},2147483648:{n:"Locale",t:Ld},2147483651:{n:"Behavior",t:Ld},1919054434:{}},r3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},X7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function K7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Y7=K7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yo=Qr(Y7),bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},n3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Q7(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function q7(e){var t=Q7();if(!e||!e.match)return t;var r={};if((e.match(xn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(a7,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[n3[i.ContentType]]!==void 0&&t[n3[i.ContentType]].push(i.PartName);break}}),t.xmlns!==m7.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Al={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function y0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(xn)||[]).forEach(function(i){var a=tt(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:n0(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var J7="application/vnd.oasis.opendocument.spreadsheet";function Z7(e,t){for(var r=$2(e),n,i;n=K0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==J7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var _0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],eT=function(){for(var e=new Array(_0.length),t=0;t<_0.length;++t){var r=_0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function O8(e){var t={};e=Ht(e);for(var r=0;r<_0.length;++r){var n=_0[r],i=e.match(eT[r]);i!=null&&i.length>0&&(t[n[1]]=At(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Hr(t[n[1]]))}return t}var tT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function b8(e,t,r,n){var i=[];if(typeof e=="string")i=Xy(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var s=typeof t=="string"?Xy(t,n).map(function(d){return d.v}):t,o=0,u=0;if(s.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=s.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=s.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=s.slice(o,o+u);break}o+=u}}function rT(e,t,r){var n={};return t||(t={}),e=Ht(e),tT.forEach(function(i){var a=(e.match(X0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=At(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&b8(n.HeadingPairs,n.TitlesOfParts,t,r),t}var nT=/<[^>]+>[^<]*/g;function iT(e,t){var r={},n="",i=e.match(nT);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=tt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=At(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var u=s.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=At(d);break;case"bool":r[n]=Qt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Hr(d);break;case"cy":case"error":r[n]=At(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,u)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var aT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eg;function sT(e,t,r){eg||(eg=G2(aT)),t=eg[t]||t,e[t]=r}function ex(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function L8(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function M8(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function B8(e,t,r){return t===31?M8(e):L8(e,t,r)}function km(e,t,r){return B8(e,t,r===!1?0:4)}function oT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return B8(e,t,0)}function lT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pn,""),e.l-i&2&&(e.l+=2)}return r}function cT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pn,"");return r}function uT(e){var t=e.l,r=Md(e,I8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Md(e,Bn);return[r,n]}function fT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(uT(e));return r}function i3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Pn,"").replace(r0,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function U8(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function dT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Md(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==t3&&n!==t&&H7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===t3?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return L8(e,n,4).replace(Pn,"");case 31:return M8(e);case 64:return ex(e);case 65:return U8(e);case 71:return dT(e);case 80:return km(e,n,!a.raw).replace(Pn,"");case 81:return oT(e,n).replace(Pn,"");case 4108:return fT(e);case 4126:case 4127:return n==4127?lT(e):cT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function a3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,u=-1,f={};for(s=0;s!=i;++s){var d=e.read_shift(4),p=e.read_shift(4);a[s]=[d,p+r]}a.sort(function(S,x){return S[1]-x[1]});var m={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var v=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(v=!1,e.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[a[s][0]];if(m[g.n]=Md(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vi(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(a[s][0]===1){if(o=m.CodePage=Md(e,Z2),Vi(o),u!==-1){var _=e.l;e.l=a[u][1],f=i3(e,o),e.l=_}}else if(a[s][0]===0){if(o===0){u=s,e.l=a[s+1][1];continue}f=i3(e,o)}else{var k=f[a[s][0]],E;switch(e[e.l]){case 65:e.l+=4,E=U8(e);break;case 30:e.l+=4,E=km(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=km(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=fr(e,4);break;case 64:e.l+=4,E=Hr(ex(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[k]=E}}return e.l=r+n,m}function s3(e,t,r){var n=e.content;if(!n)return{};Kr(n,0);var i,a,s,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==Et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),u=n.read_shift(4));var p=a3(n,t),m={SystemIdentifier:f};for(var v in p)m[v]=p[v];if(m.FMTID=a,i===1)return m;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var g;try{g=a3(n,null)}catch{}for(v in g)m[v]=g[v];return m.FMTID=[a,s],m}function ls(e,t){return e.read_shift(t),null}function hT(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function fr(e,t){return e.read_shift(t)===1}function yr(e){return e.read_shift(2,"u")}function j8(e,t){return hT(e,t,yr)}function pT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function cu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function gT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,u={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*s),n&&(e.l+=o),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Po(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function uu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Po(e,n,r)}function Lo(e,t,r){if(r.biff>5)return uu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function xT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pn,"");return n&&(e.l+=24),i}function vT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Pn,"");return r+s}function yT(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xT(e);case"0303000000000000c000000000000046":return vT(e);default:throw new Error("Unsupported Moniker "+r)}}function Of(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pn,""):"";return r}function _T(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,u,f="",d,p;i&16&&(a=Of(e,r-e.l)),i&128&&(s=Of(e,r-e.l)),(i&257)===257&&(o=Of(e,r-e.l)),(i&257)===1&&(u=yT(e,r-e.l)),i&8&&(f=Of(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(p=ex(e)),e.l=r;var m=s||o||u||"";m&&f&&(m+="#"+f),m||(m="#"+f),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var v={Target:m};return d&&(v.guid=d),p&&(v.time=p),a&&(v.Tooltip=a),v}function z8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function V8(e,t){var r=z8(e);return r[3]=0,r}function ma(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ST(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function wT(e,t,r){return t===0?"":Lo(e,t,r)}function kT(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function G8(e){var t=e.read_shift(2),r=J2(e);return[t,r]}function ET(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=cu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function mh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function H8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var CT=H8;function W8(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function TT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function AT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function cn(e){e.l+=2,e.l+=e.read_shift(2)}var PT={0:cn,4:cn,5:cn,6:cn,7:AT,8:cn,9:cn,10:cn,11:cn,12:cn,13:TT,14:cn,15:cn,16:cn,17:cn,18:cn,19:cn,20:cn,21:W8};function FT(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(PT[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function bf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function NT(e,t){return t===0||e.read_shift(2),1200}function RT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Lo(e,0,r);return e.read_shift(t+n-e.l),i}function IT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function DT(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=cu(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function OT(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(gT(e));return a.Count=n,a.Unique=i,a}function bT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function LT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function MT(e){var t=ST(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function BT(e){return e.read_shift(2),e.read_shift(4)}function o3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function UT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:u,TabRatio:f}}function jT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zT(){}function VT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=cu(e,0,r),n}function GT(e){var t=ma(e);return t.isst=e.read_shift(4),t}function HT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ma(e);r.biff==2&&e.l++;var a=uu(e,n-e.l,r);return i.val=a,i}function WT(e,t,r){var n=e.read_shift(2),i=Lo(e,0,r);return[n,i]}var $T=Lo;function l3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:u}}}function XT(e){var t=e.read_shift(2),r=e.read_shift(2),n=G8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(G8(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function YT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function QT(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return i.patternType=X7[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function qT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=QT(e,t,n.fStyle,r),n}function JT(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function c3(e,t,r){var n=ma(e);(r.biff==2||t==9)&&++e.l;var i=pT(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function ZT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ma(e),i=dn(e);return n.val=i,n}var u3=wT;function eA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Po(e,a),o=[];n>e.l;)o.push(uu(e));return[a,i,s,o]}function f3(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=ET(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var tA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function d3(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Po(e,s,r);i&32&&(f=tA[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||o===0||!(d>0)?[]:LN(e,d,r,o);return{chKey:a,Name:f,itab:u,rgce:p}}function $8(e,t,r){if(r.biff<8)return rA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(kT(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function rA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=cu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Po(e,n,r),s=Po(e,i,r);return[a,s]}function iA(e,t,r){var n=H8(e);e.l++;var i=e.read_shift(1);return t-=8,[MN(e,t,r),i,n]}function h3(e,t,r){var n=CT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ON(e,t,r)]}function aA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function sA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=Lo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function oA(e,t,r){return sA(e,t,r)}function lA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(mh(e));return r}function cA(e,t,r){if(r&&r.biff<8)return fA(e,t,r);var n=W8(e),i=FT(e,t-22,n[1]);return{cmo:n,ft:i}}var uA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function fA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((uA[n]||mn)(e,t,r)),{cmo:[i,n,a],ft:s}}function dA(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=mT(e,6,r);var o=e.read_shift(2);e.read_shift(2),yr(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=Po(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function hA(e,t){var r=mh(e);e.l+=16;var n=_T(e,t-24);return[r,n]}function pA(e,t){e.read_shift(2);var r=mh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pn,""),[r,n]}function gA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=r3[r]||r,r=e.read_shift(2),t[1]=r3[r]||r,t}function mA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(V8(e));return r}function xA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(V8(e));return r}function vA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function X8(e,t,r){if(!r.cellStyles)return mn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:s,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function yA(e,t){var r={};return t<32||(e.l+=16,r.header=dn(e),r.footer=dn(e),e.l+=2),r}function _A(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var SA=ma,wA=j8,kA=uu;function EA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function CA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ma(e);++e.l;var i=Lo(e,t-7,r);return n.t="str",n.val=i,n}function TA(e){var t=ma(e);++e.l;var r=dn(e);return t.t="n",t.val=r,t}function AA(e){var t=ma(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function PA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function FA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function NA(e,t,r){var n=e.l+t,i=ma(e),a=e.read_shift(2),s=Po(e,a,r);return e.l=n,i.t="str",i.val=s,i}var RA=[2,3,48,49,131,139,140,245],p3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=G2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ds(1);switch(u.type){case"base64":d=zi(ri(o));break;case"binary":d=zi(o);break;case"buffer":case"array":d=o;break}Kr(d,0);var p=d.read_shift(1),m=!!(p&136),v=!1,g=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,k=521;p==2&&(_=d.read_shift(2)),d.l+=3,p!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(k=d.read_shift(2));var E=d.read_shift(2),S=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(S=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var x=[],C={},N=Math.min(d.length,p==2?521:k-10-(v?264:0)),T=g?32:11;d.l<N&&d[d.l]!=13;)switch(C={},C.name=gs.utils.decode(S,d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,C.type=String.fromCharCode(d.read_shift(1)),p!=2&&!g&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),p==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&x.push(C),p!=2&&(d.l+=g?13:14),C.type){case"B":(!v||C.len!=8)&&u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=k-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=k;var F=0,P=0;for(f[0]=[],P=0;P!=x.length;++P)f[0][P]=x[P].name;for(;_-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,f[++F]=[],P=0,P=0;P!=x.length;++P){var I=d.slice(d.l,d.l+x[P].len);d.l+=x[P].len,Kr(I,0);var D=gs.utils.decode(S,I);switch(x[P].type){case"C":D.trim().length&&(f[F][P]=D.replace(/\s+$/,""));break;case"D":D.length===8?f[F][P]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):f[F][P]=D;break;case"F":f[F][P]=parseFloat(D.trim());break;case"+":case"I":f[F][P]=g?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":f[F][P]=!0;break;case"N":case"F":f[F][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[F][P]="##MEMO##"+(g?parseInt(D.trim(),10):I.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(f[F][P]=+D||0);break;case"@":f[F][P]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[F][P]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[F][P]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][P]=-I.read_shift(-8,"f");break;case"B":if(v&&x[P].len==8){f[F][P]=I.read_shift(8,"f");break}case"G":case"P":I.l+=x[P].len;break;case"0":if(x[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[P].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=x,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=ac(r(o,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(o,u){try{return Us(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var f=u||{};if(+f.codepage>=0&&Vi(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=_m(),p=Nm(o,{header:1,raw:!0,cellDates:!0}),m=p[0],v=p.slice(1),g=o["!cols"]||[],_=0,k=0,E=0,S=1;for(_=0;_<m.length;++_){if(((g[_]||{}).DBF||{}).name){m[_]=g[_].DBF.name,++E;continue}if(m[_]!=null){if(++E,typeof m[_]=="number"&&(m[_]=m[_].toString(10)),typeof m[_]!="string")throw new Error("DBF Invalid column name "+m[_]+" |"+typeof m[_]+"|");if(m.indexOf(m[_])!==_){for(k=0;k<1024;++k)if(m.indexOf(m[_]+"_"+k)==-1){m[_]+="_"+k;break}}}}var x=lr(o["!ref"]),C=[],N=[],T=[];for(_=0;_<=x.e.c-x.s.c;++_){var F="",P="",I=0,D=[];for(k=0;k<v.length;++k)v[k][_]!=null&&D.push(v[k][_]);if(D.length==0||m[_]==null){C[_]="?";continue}for(k=0;k<D.length;++k){switch(typeof D[k]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=D[k]instanceof Date?"D":"C";break;default:P="C"}I=Math.max(I,String(D[k]).length),F=F&&F!=P?"C":P}I>250&&(I=250),P=((g[_]||{}).DBF||{}).type,P=="C"&&g[_].DBF.len>I&&(I=g[_].DBF.len),F=="B"&&P=="N"&&(F="N",T[_]=g[_].DBF.dec,I=g[_].DBF.len),N[_]=F=="C"||P=="N"?I:a[F]||0,S+=N[_],C[_]=F}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,v.length),U.write_shift(2,296+32*E),U.write_shift(2,S),_=0;_<4;++_)U.write_shift(4,0);for(U.write_shift(4,0|(+t[W6]||3)<<8),_=0,k=0;_<m.length;++_)if(m[_]!=null){var b=d.next(32),Q=(m[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,Q,"sbcs"),b.write_shift(1,C[_]=="?"?"C":C[_],"sbcs"),b.write_shift(4,k),b.write_shift(1,N[_]||a[C[_]]||0),b.write_shift(1,T[_]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),k+=N[_]||a[C[_]]||0}var he=d.next(264);for(he.write_shift(4,13),_=0;_<65;++_)he.write_shift(4,0);for(_=0;_<v.length;++_){var te=d.next(S);for(te.write_shift(1,0),k=0;k<m.length;++k)if(m[k]!=null)switch(C[k]){case"L":te.write_shift(1,v[_][k]==null?63:v[_][k]?84:70);break;case"B":te.write_shift(8,v[_][k]||0,"f");break;case"N":var Ae="0";for(typeof v[_][k]=="number"&&(Ae=v[_][k].toFixed(T[k]||0)),E=0;E<N[k]-Ae.length;++E)te.write_shift(1,32);te.write_shift(1,Ae,"sbcs");break;case"D":v[_][k]?(te.write_shift(4,("0000"+v[_][k].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(v[_][k].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+v[_][k].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Te=String(v[_][k]!=null?v[_][k]:"").slice(0,N[k]);for(te.write_shift(1,Te,"sbcs"),E=0;E<N[k]-Te.length;++E)te.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),IA=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var g=e[v];return typeof g=="number"?Ny(g):g},n=function(m,v,g){var _=v.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return _==59?m:Ny(_)};e["|"]=254;function i(m,v){switch(v.type){case"base64":return a(ri(m),v);case"binary":return a(m,v);case"buffer":return a(_t&&Buffer.isBuffer(m)?m.toString("binary"):Io(m),v);case"array":return a(Ao(m),v)}throw new Error("Unrecognized type "+v.type)}function a(m,v){var g=m.split(/[\n\r]+/),_=-1,k=-1,E=0,S=0,x=[],C=[],N=null,T={},F=[],P=[],I=[],D=0,U;for(+v.codepage>=0&&Vi(+v.codepage);E!==g.length;++E){D=0;var b=g[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=b.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),he=Q[0],te;if(b.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&C.push(b.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,Te=!1,ie=!1,X=!1,ce=-1,Ce=-1;for(S=1;S<Q.length;++S)switch(Q[S].charAt(0)){case"A":break;case"X":k=parseInt(Q[S].slice(1))-1,Te=!0;break;case"Y":for(_=parseInt(Q[S].slice(1))-1,Te||(k=0),U=x.length;U<=_;++U)x[U]=[];break;case"K":te=Q[S].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Xi(te))?isNaN(Kl(te).getDate())||(te=Hr(te)):(te=Xi(te),N!==null&&nc(N)&&(te=gh(te))),Ae=!0;break;case"E":X=!0;var L=bl(Q[S].slice(1),{r:_,c:k});x[_][k]=[x[_][k],L];break;case"S":ie=!0,x[_][k]=[x[_][k],"S5S"];break;case"G":break;case"R":ce=parseInt(Q[S].slice(1))-1;break;case"C":Ce=parseInt(Q[S].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}if(Ae&&(x[_][k]&&x[_][k].length==2?x[_][k][0]=te:x[_][k]=te,N=null),ie){if(X)throw new Error("SYLK shared formula cannot have own formula");var q=ce>-1&&x[ce][Ce];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");x[_][k][1]=nS(q[1],{r:_-ce,c:k-Ce})}break;case"F":var Y=0;for(S=1;S<Q.length;++S)switch(Q[S].charAt(0)){case"X":k=parseInt(Q[S].slice(1))-1,++Y;break;case"Y":for(_=parseInt(Q[S].slice(1))-1,U=x.length;U<=_;++U)x[U]=[];break;case"M":D=parseInt(Q[S].slice(1))/20;break;case"F":break;case"G":break;case"P":N=C[parseInt(Q[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=Q[S].slice(1).split(" "),U=parseInt(I[0],10);U<=parseInt(I[1],10);++U)D=parseInt(I[2],10),P[U-1]=D===0?{hidden:!0}:{wch:D},Yl(P[U-1]);break;case"C":k=parseInt(Q[S].slice(1))-1,P[k]||(P[k]={});break;case"R":_=parseInt(Q[S].slice(1))-1,F[_]||(F[_]={}),D>0?(F[_].hpt=D,F[_].hpx=q0(D)):D===0&&(F[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}Y<1&&(N=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}}return F.length>0&&(T["!rows"]=F),P.length>0&&(T["!cols"]=P),v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),[x,T]}function s(m,v){var g=i(m,v),_=g[0],k=g[1],E=ac(_,v);return pa(k).forEach(function(S){E[S]=k[S]}),E}function o(m,v){return Us(s(m,v),v)}function u(m,v,g,_){var k="C;Y"+(g+1)+";X"+(_+1)+";K";switch(m.t){case"n":k+=m.v||0,m.f&&!m.F&&(k+=";E"+vF(m.f,{r:g,c:_}));break;case"b":k+=m.v?"TRUE":"FALSE";break;case"e":k+=m.w||m.v;break;case"d":k+='"'+(m.w||m.v)+'"';break;case"s":k+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function f(m,v){v.forEach(function(g,_){var k="F;W"+(_+1)+" "+(_+1)+" ";g.hidden?k+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Ud(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=jd(g.wpx)),typeof g.wch=="number"&&(k+=Math.round(g.wch))),k.charAt(k.length-1)!=" "&&m.push(k)})}function d(m,v){v.forEach(function(g,_){var k="F;";g.hidden?k+="M0;":g.hpt?k+="M"+20*g.hpt+";":g.hpx&&(k+="M"+20*eS(g.hpx)+";"),k.length>2&&m.push(k+"R"+(_+1))})}function p(m,v){var g=["ID;PWXL;N;E"],_=[],k=lr(m["!ref"]),E,S=Array.isArray(m),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&f(g,m["!cols"]),m["!rows"]&&d(g,m["!rows"]),g.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var C=k.s.r;C<=k.e.r;++C)for(var N=k.s.c;N<=k.e.c;++N){var T=st({r:C,c:N});E=S?(m[C]||[])[N]:m[T],!(!E||E.v==null&&(!E.f||E.F))&&_.push(u(E,m,C,N))}return g.join(x)+x+_.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),DA=function(){function e(a,s){switch(s.type){case"base64":return t(ri(a),s);case"binary":return t(a,s);case"buffer":return t(_t&&Buffer.isBuffer(a)?a.toString("binary"):Io(a),s);case"array":return t(Ao(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),u=-1,f=-1,d=0,p=[];d!==o.length;++d){if(o[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var m=o[d].trim().split(","),v=m[0],g=m[1];++d;for(var _=o[d]||"";(_.match(/["]/g)||[]).length&1&&d<o.length-1;)_+=`
`+o[++d];switch(_=_.trim(),+v){case-1:if(_==="BOT"){p[++u]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?p[u][f]=!0:_==="FALSE"?p[u][f]=!1:isNaN(Xi(g))?isNaN(Kl(g).getDate())?p[u][f]=g:p[u][f]=Hr(g):p[u][f]=Xi(g),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),p[u][f++]=_!==""?_:null;break}if(_==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(a,s){return ac(e(a,s),s)}function n(a,s){return Us(r(a,s),s)}var i=function(){var a=function(u,f,d,p,m){u.push(f),u.push(d+","+p),u.push('"'+m.replace(/"/g,'""')+'"')},s=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=lr(u["!ref"]),p,m=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(f,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var _=st({r:v,c:g});if(p=m?(u[v]||[])[g]:u[_],!p){s(f,1,0,"");continue}switch(p.t){case"n":var k=p.w;!k&&p.v!=null&&(k=p.v),k==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,k,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ci(p.z||ct[14],Fn(Hr(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var E=`\r
`,S=f.join(E);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),OA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var v=p.split(`
`),g=-1,_=-1,k=0,E=[];k!==v.length;++k){var S=v[k].trim().split(":");if(S[0]==="cell"){var x=Tn(S[1]);if(E.length<=x.r)for(g=E.length;g<=x.r;++g)E[g]||(E[g]=[]);switch(g=x.r,_=x.c,S[2]){case"t":E[g][_]=e(S[3]);break;case"v":E[g][_]=+S[3];break;case"vtf":var C=S[S.length-1];case"vtc":switch(S[3]){case"nl":E[g][_]=!!+S[4];break;default:E[g][_]=+S[4];break}S[2]=="vtf"&&(E[g][_]=[E[g][_],C])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(p,m){return ac(r(p,m),m)}function i(p,m){return Us(n(p,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],g,_="",k=ic(p["!ref"]),E=Array.isArray(p),S=k.s.r;S<=k.e.r;++S)for(var x=k.s.c;x<=k.e.c;++x)if(_=st({r:S,c:x}),g=E?(p[S]||[])[x]:p[_],!(!g||g.v==null||g.t==="z")){switch(v=["cell",_,"t"],g.t){case"s":case"str":v.push(t(g.v));break;case"n":g.f?(v[2]="vtf",v[3]="n",v[4]=g.v,v[5]=t(g.f)):(v[2]="v",v[3]=g.v);break;case"b":v[2]="vt"+(g.f?"f":"c"),v[3]="nl",v[4]=g.v?"1":"0",v[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var C=Fn(Hr(g.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=g.w||Ci(g.z||ct[14],C);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[a,s,o,s,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Y0=function(){function e(d,p,m,v,g){g.raw?p[m][v]=d:d===""||(d==="TRUE"?p[m][v]=!0:d==="FALSE"?p[m][v]=!1:isNaN(Xi(d))?isNaN(Kl(d).getDate())?p[m][v]=d:p[m][v]=Hr(d):p[m][v]=Xi(d))}function t(d,p){var m=p||{},v=[];if(!d||d.length===0)return v;for(var g=d.split(/[\r\n]/),_=g.length-1;_>=0&&g[_].length===0;)--_;for(var k=10,E=0,S=0;S<=_;++S)E=g[S].indexOf(" "),E==-1?E=g[S].length:E++,k=Math.max(k,E);for(S=0;S<=_;++S){v[S]=[];var x=0;for(e(g[S].slice(0,k).trim(),v,S,x,m),x=1;x<=(g[S].length-k)/10+1;++x)e(g[S].slice(k+(x-1)*10,k+x*10).trim(),v,S,x,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var p={},m=!1,v=0,g=0;v<d.length;++v)(g=d.charCodeAt(v))==34?m=!m:!m&&g in r&&(p[g]=(p[g]||0)+1);g=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([p[v],v]);if(!g.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([p[v],v])}return g.sort(function(_,k){return _[0]-k[0]||n[_[1]]-n[k[1]]}),r[g.pop()[1]]||44}function a(d,p){var m=p||{},v="",g=m.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):m&&m.FS?v=m.FS:v=i(d.slice(0,1024));var k=0,E=0,S=0,x=0,C=0,N=v.charCodeAt(0),T=!1,F=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=m.dateNF!=null?$C(m.dateNF):null;function D(){var U=d.slice(x,C),b={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)b.t="z";else if(m.raw)b.t="s",b.v=U;else if(U.trim().length===0)b.t="s",b.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(b.t="s",b.v=U.slice(2,-1).replace(/""/g,'"')):_F(U)?(b.t="n",b.f=U.slice(1)):(b.t="s",b.v=U);else if(U=="TRUE")b.t="b",b.v=!0;else if(U=="FALSE")b.t="b",b.v=!1;else if(!isNaN(S=Xi(U)))b.t="n",m.cellText!==!1&&(b.w=U),b.v=S;else if(!isNaN(Kl(U).getDate())||I&&U.match(I)){b.z=m.dateNF||ct[14];var Q=0;I&&U.match(I)&&(U=XC(U,m.dateNF,U.match(I)||[]),Q=1),m.cellDates?(b.t="d",b.v=Hr(U,Q)):(b.t="n",b.v=Fn(Hr(U,Q))),m.cellText!==!1&&(b.w=Ci(b.z,b.v instanceof Date?Fn(b.v):b.v)),m.cellNF||delete b.z}else b.t="s",b.v=U;if(b.t=="z"||(m.dense?(g[k]||(g[k]=[]),g[k][E]=b):g[st({c:E,r:k})]=b),x=C+1,P=d.charCodeAt(x),_.e.c<E&&(_.e.c=E),_.e.r<k&&(_.e.r=k),F==N)++E;else if(E=0,++k,m.sheetRows&&m.sheetRows<=k)return!0}e:for(;C<d.length;++C)switch(F=d.charCodeAt(C)){case 34:P===34&&(T=!T);break;case N:case 10:case 13:if(!T&&D())break e;break}return C-x>0&&D(),g["!ref"]=Ct(_),g}function s(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,p):ac(t(d,p),p)}function o(d,p){var m="",v=p.type=="string"?[0,0,0,0]:lx(d,p);switch(p.type){case"base64":m=ri(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):p.codepage&&typeof gs<"u"?m=gs.utils.decode(p.codepage,d):m=_t&&Buffer.isBuffer(d)?d.toString("binary"):Io(d);break;case"array":m=Ao(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=Ht(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Ht(m):p.type=="binary"&&typeof gs<"u"&&p.codepage&&(m=gs.utils.decode(p.codepage,gs.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?OA.to_sheet(p.type=="string"?m:Ht(m),p):s(m,p)}function u(d,p){return Us(o(d,p),p)}function f(d){for(var p=[],m=lr(d["!ref"]),v,g=Array.isArray(d),_=m.s.r;_<=m.e.r;++_){for(var k=[],E=m.s.c;E<=m.e.c;++E){var S=st({r:_,c:E});if(v=g?(d[_]||[])[E]:d[S],!v||v.v==null){k.push("          ");continue}for(var x=(v.w||(Wa(v),v.w)||"").slice(0,10);x.length<10;)x+=" ";k.push(x+(E===0?" ":""))}p.push(k.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}}();function bA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=IA.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Y0.to_workbook(e,t)}}var S0=function(){function e(L,q,Y){if(L){Kr(L,L.l||0);for(var K=Y.Enum||ce;L.l<L.length;){var de=L.read_shift(2),G=K[de]||K[65535],J=L.read_shift(2),ue=L.l+J,ve=G.f&&G.f(L,J,Y);if(L.l=ue,q(ve,G,de))return}}}function t(L,q){switch(q.type){case"base64":return r(zi(ri(L)),q);case"binary":return r(zi(L),q);case"buffer":case"array":return r(L,q)}throw"Unsupported type "+q.type}function r(L,q){if(!L)return L;var Y=q||{},K=Y.dense?[]:{},de="Sheet1",G="",J=0,ue={},ve=[],Be=[],V={s:{r:0,c:0},e:{r:0,c:0}},Ze=Y.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)Y.Enum=ce,e(L,function(Re,wt,Or){switch(Or){case 0:Y.vers=Re,Re>=4096&&(Y.qpro=!0);break;case 6:V=Re;break;case 204:Re&&(G=Re);break;case 222:G=Re;break;case 15:case 51:Y.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Or==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=Y.dateNF||ct[14],Y.cellDates&&(Re[1].t="d",Re[1].v=gh(Re[1].v))),Y.qpro&&Re[3]>J&&(K["!ref"]=Ct(V),ue[de]=K,ve.push(de),K=Y.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=Re[3],de=G||"Sheet"+(J+1),G="");var pr=Y.dense?(K[Re[0].r]||[])[Re[0].c]:K[st(Re[0])];if(pr){pr.t=Re[1].t,pr.v=Re[1].v,Re[1].z!=null&&(pr.z=Re[1].z),Re[1].f!=null&&(pr.f=Re[1].f);break}Y.dense?(K[Re[0].r]||(K[Re[0].r]=[]),K[Re[0].r][Re[0].c]=Re[1]):K[st(Re[0])]=Re[1];break}},Y);else if(L[2]==26||L[2]==14)Y.Enum=Ce,L[2]==14&&(Y.qpro=!0,L.l=0),e(L,function(Re,wt,Or){switch(Or){case 204:de=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>J&&(K["!ref"]=Ct(V),ue[de]=K,ve.push(de),K=Y.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},J=Re[3],de="Sheet"+(J+1)),Ze>0&&Re[0].r>=Ze)break;Y.dense?(K[Re[0].r]||(K[Re[0].r]=[]),K[Re[0].r][Re[0].c]=Re[1]):K[st(Re[0])]=Re[1],V.e.c<Re[0].c&&(V.e.c=Re[0].c),V.e.r<Re[0].r&&(V.e.r=Re[0].r);break;case 27:Re[14e3]&&(Be[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Be[Re[0]]=Re[1],Re[0]==J&&(de=Re[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(K["!ref"]=Ct(V),ue[G||de]=K,ve.push(G||de),!Be.length)return{SheetNames:ve,Sheets:ue};for(var nt={},Ye=[],Je=0;Je<Be.length;++Je)ue[ve[Je]]?(Ye.push(Be[Je]||ve[Je]),nt[Be[Je]]=ue[Be[Je]]||ue[ve[Je]]):(Ye.push(Be[Je]),nt[Be[Je]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:nt}}function n(L,q){var Y=q||{};if(+Y.codepage>=0&&Vi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var K=_m(),de=lr(L["!ref"]),G=Array.isArray(L),J=[];Li(K,0,a(1030)),Li(K,6,u(de));for(var ue=Math.min(de.e.r,8191),ve=de.s.r;ve<=ue;++ve)for(var Be=qr(ve),V=de.s.c;V<=de.e.c;++V){ve===de.s.r&&(J[V]=Nr(V));var Ze=J[V]+Be,nt=G?(L[ve]||[])[V]:L[Ze];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?Li(K,13,v(ve,V,nt.v)):Li(K,14,_(ve,V,nt.v));else{var Ye=Wa(nt);Li(K,15,p(ve,V,Ye.slice(0,239)))}}return Li(K,1),K.end()}function i(L,q){var Y=q||{};if(+Y.codepage>=0&&Vi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var K=_m();Li(K,0,s(L));for(var de=0,G=0;de<L.SheetNames.length;++de)(L.Sheets[L.SheetNames[de]]||{})["!ref"]&&Li(K,27,X(L.SheetNames[de],G++));var J=0;for(de=0;de<L.SheetNames.length;++de){var ue=L.Sheets[L.SheetNames[de]];if(!(!ue||!ue["!ref"])){for(var ve=lr(ue["!ref"]),Be=Array.isArray(ue),V=[],Ze=Math.min(ve.e.r,8191),nt=ve.s.r;nt<=Ze;++nt)for(var Ye=qr(nt),Je=ve.s.c;Je<=ve.e.c;++Je){nt===ve.s.r&&(V[Je]=Nr(Je));var Re=V[Je]+Ye,wt=Be?(ue[nt]||[])[Je]:ue[Re];if(!(!wt||wt.t=="z"))if(wt.t=="n")Li(K,23,D(nt,Je,J,wt.v));else{var Or=Wa(wt);Li(K,22,F(nt,Je,J,Or.slice(0,239)))}}++J}}return Li(K,1),K.end()}function a(L){var q=Ar(2);return q.write_shift(2,L),q}function s(L){var q=Ar(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var Y=0,K=0,de=0,G=0;G<L.SheetNames.length;++G){var J=L.SheetNames[G],ue=L.Sheets[J];if(!(!ue||!ue["!ref"])){++de;var ve=ic(ue["!ref"]);Y<ve.e.r&&(Y=ve.e.r),K<ve.e.c&&(K=ve.e.c)}}return Y>8191&&(Y=8191),q.write_shift(2,Y),q.write_shift(1,de),q.write_shift(1,K),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(L,q,Y){var K={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&Y.qpro?(K.s.c=L.read_shift(1),L.l++,K.s.r=L.read_shift(2),K.e.c=L.read_shift(1),L.l++,K.e.r=L.read_shift(2),K):(K.s.c=L.read_shift(2),K.s.r=L.read_shift(2),q==12&&Y.qpro&&(L.l+=2),K.e.c=L.read_shift(2),K.e.r=L.read_shift(2),q==12&&Y.qpro&&(L.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function u(L){var q=Ar(8);return q.write_shift(2,L.s.c),q.write_shift(2,L.s.r),q.write_shift(2,L.e.c),q.write_shift(2,L.e.r),q}function f(L,q,Y){var K=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(K[0].c=L.read_shift(1),K[3]=L.read_shift(1),K[0].r=L.read_shift(2),L.l+=2):(K[2]=L.read_shift(1),K[0].c=L.read_shift(2),K[0].r=L.read_shift(2)),K}function d(L,q,Y){var K=L.l+q,de=f(L,q,Y);if(de[1].t="s",Y.vers==20768){L.l++;var G=L.read_shift(1);return de[1].v=L.read_shift(G,"utf8"),de}return Y.qpro&&L.l++,de[1].v=L.read_shift(K-L.l,"cstr"),de}function p(L,q,Y){var K=Ar(7+Y.length);K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(1,39);for(var de=0;de<K.length;++de){var G=Y.charCodeAt(de);K.write_shift(1,G>=128?95:G)}return K.write_shift(1,0),K}function m(L,q,Y){var K=f(L,q,Y);return K[1].v=L.read_shift(2,"i"),K}function v(L,q,Y){var K=Ar(7);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(2,Y,"i"),K}function g(L,q,Y){var K=f(L,q,Y);return K[1].v=L.read_shift(8,"f"),K}function _(L,q,Y){var K=Ar(13);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(8,Y,"f"),K}function k(L,q,Y){var K=L.l+q,de=f(L,q,Y);if(de[1].v=L.read_shift(8,"f"),Y.qpro)L.l=K;else{var G=L.read_shift(2);C(L.slice(L.l,L.l+G),de),L.l+=G}return de}function E(L,q,Y){var K=q&32768;return q&=-32769,q=(K?L:0)+(q>=8192?q-16384:q),(K?"":"$")+(Y?Nr(q):qr(q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(L,q){Kr(L,0);for(var Y=[],K=0,de="",G="",J="",ue="";L.l<L.length;){var ve=L[L.l++];switch(ve){case 0:Y.push(L.read_shift(8,"f"));break;case 1:G=E(q[0].c,L.read_shift(2),!0),de=E(q[0].r,L.read_shift(2),!1),Y.push(G+de);break;case 2:{var Be=E(q[0].c,L.read_shift(2),!0),V=E(q[0].r,L.read_shift(2),!1);G=E(q[0].c,L.read_shift(2),!0),de=E(q[0].r,L.read_shift(2),!1),Y.push(Be+V+":"+G+de)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(L.read_shift(2));break;case 6:{for(var Ze="";ve=L[L.l++];)Ze+=String.fromCharCode(ve);Y.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:ue=Y.pop(),J=Y.pop(),Y.push(["AND","OR"][ve-20]+"("+J+","+ue+")");break;default:if(ve<32&&x[ve])ue=Y.pop(),J=Y.pop(),Y.push(J+x[ve]+ue);else if(S[ve]){if(K=S[ve][1],K==69&&(K=L[L.l++]),K>Y.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+Y.join("|")+"|");return}var nt=Y.slice(-K);Y.length-=K,Y.push(S[ve][0]+"("+nt.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}Y.length==1?q[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function N(L){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=L.read_shift(2),q[3]=L[L.l++],q[0].c=L[L.l++],q}function T(L,q){var Y=N(L);return Y[1].t="s",Y[1].v=L.read_shift(q-4,"cstr"),Y}function F(L,q,Y,K){var de=Ar(6+K.length);de.write_shift(2,L),de.write_shift(1,Y),de.write_shift(1,q),de.write_shift(1,39);for(var G=0;G<K.length;++G){var J=K.charCodeAt(G);de.write_shift(1,J>=128?95:J)}return de.write_shift(1,0),de}function P(L,q){var Y=N(L);Y[1].v=L.read_shift(2);var K=Y[1].v>>1;if(Y[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return Y[1].v=K,Y}function I(L,q){var Y=N(L),K=L.read_shift(4),de=L.read_shift(4),G=L.read_shift(2);if(G==65535)return K===0&&de===3221225472?(Y[1].t="e",Y[1].v=15):K===0&&de===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var J=G&32768;return G=(G&32767)-16446,Y[1].v=(1-J*2)*(de*Math.pow(2,G+32)+K*Math.pow(2,G)),Y}function D(L,q,Y,K){var de=Ar(14);if(de.write_shift(2,L),de.write_shift(1,Y),de.write_shift(1,q),K==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var G=0,J=0,ue=0,ve=0;return K<0&&(G=1,K=-K),J=Math.log2(K)|0,K/=Math.pow(2,J-31),ve=K>>>0,ve&2147483648||(K/=2,++J,ve=K>>>0),K-=ve,ve|=2147483648,ve>>>=0,K*=Math.pow(2,32),ue=K>>>0,de.write_shift(4,ue),de.write_shift(4,ve),J+=16383+(G?32768:0),de.write_shift(2,J),de}function U(L,q){var Y=I(L);return L.l+=q-14,Y}function b(L,q){var Y=N(L),K=L.read_shift(4);return Y[1].v=K>>6,Y}function Q(L,q){var Y=N(L),K=L.read_shift(8,"f");return Y[1].v=K,Y}function he(L,q){var Y=Q(L);return L.l+=q-10,Y}function te(L,q){return L[L.l+q-1]==0?L.read_shift(q,"cstr"):""}function Ae(L,q){var Y=L[L.l++];Y>q-1&&(Y=q-1);for(var K="";K.length<Y;)K+=String.fromCharCode(L[L.l++]);return K}function Te(L,q,Y){if(!(!Y.qpro||q<21)){var K=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var de=L.read_shift(q-21,"cstr");return[K,de]}}function ie(L,q){for(var Y={},K=L.l+q;L.l<K;){var de=L.read_shift(2);if(de==14e3){for(Y[de]=[0,""],Y[de][0]=L.read_shift(2);L[L.l];)Y[de][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return Y}function X(L,q){var Y=Ar(5+L.length);Y.write_shift(2,14e3),Y.write_shift(2,q);for(var K=0;K<L.length;++K){var de=L.charCodeAt(K);Y[Y.l++]=de>127?95:de}return Y[Y.l++]=0,Y}var ce={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function LA(e){var t={},r=e.match(xn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=B2[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var MA=function(){var e=X0("t"),t=X0("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:At(s[1])},u=a.match(t);return u&&(o.s=LA(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),BA=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),s.push("</"+u+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),UA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jA=/<(?:\w+:)?r>/,zA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=At(Ht(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ht(e),r&&(n.h=W2(n.t))):e.match(jA)&&(n.r=Ht(e),n.t=At(Ht((e.replace(zA,"").match(UA)||[]).join("").replace(xn,""))),r&&(n.h=BA(MA(n.r)))),n):{t:""}}var VA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GA=/<(?:\w+:)?(?:si|sstItem)>/g,HA=/<\/(?:\w+:)?(?:si|sstItem)>/;function WA(e,t){var r=[],n="";if(!e)return r;var i=e.match(VA);if(i){n=i[2].replace(GA,"").split(HA);for(var a=0;a!=n.length;++a){var s=tx(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=tt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function $A(e){return[e.read_shift(4),e.read_shift(4)]}function XA(e,t){var r=[],n=!1;return Xa(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function K8(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ba(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function KA(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function YA(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function QA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YA(e));return t}function qA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function JA(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function ZA(e){var t=JA(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Y8(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Q8(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function eP(e){var t=Ba(e);switch(t.Minor){case 2:return[t.Minor,tP(e)];case 3:return[t.Minor,rP()];case 4:return[t.Minor,nP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function tP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Y8(e,r),i=Q8(e,e.length-e.l);return{t:"Std",h:n,v:i}}function rP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function nP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(xn,function(a){var s=tt(a);switch(ga(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function iP(e,t){var r={},n=r.EncryptionVersionInfo=Ba(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Y8(e,i),t-=i,r.EncryptionVerifier=Q8(e,t),r}function aP(e){var t={},r=t.EncryptionVersionInfo=Ba(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function sP(e){var t=0,r,n=K8(e),i=n.length+1,a,s,o,u,f;for(r=Ds(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,u=t<<1&32767,f=o|u,t=f^s;return t^52811}var q8=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],u=104,f=s.length-1;f>=0;--f)for(var d=s[f],p=0;p!=7;++p)d&64&&(o^=r[u]),d*=2,--u;return o};return function(s){for(var o=K8(s),u=a(o),f=o.length,d=Ds(16),p=0;p!=16;++p)d[p]=0;var m,v,g;for((f&1)===1&&(m=u>>8,d[f]=i(e[0],m),--f,m=u&255,v=o[o.length-1],d[f]=i(v,m));f>0;)--f,m=u>>8,d[f]=i(o[f],m),--f,m=u&255,d[f]=i(o[f],m);for(f=15,g=15-o.length;g>0;)m=u>>8,d[f]=i(e[g],m),--f,--g,m=u&255,d[f]=i(o[f],m),--f,--g;return d}}(),oP=function(e,t,r,n,i){i||(i=t),n||(n=q8(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},lP=function(e){var t=0,r=q8(e);return function(n){var i=oP("",n,t,r);return t=i[1],i[0]}};function cP(e,t,r,n){var i={key:yr(e),verificationBytes:yr(e)};return r.password&&(i.verifier=sP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=lP(r.password)),i}function uP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=aP(e):n.Data=iP(e,t),n}function fP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?uP(e,t-2,n):cP(e,r.biff>=8?t:t-2,r,n),n}var dP=function(){function e(i,a){switch(a.type){case"base64":return t(ri(i),a);case"binary":return t(i,a);case"buffer":return t(_t&&Buffer.isBuffer(i)?i.toString("binary"):Io(i),a);case"array":return t(Ao(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,v=0,g,_=-1;g=m.exec(d);){switch(g[0]){case"\\cell":var k=d.slice(v,m.lastIndex-g[0].length);if(k[0]==" "&&(k=k.slice(1)),++_,k.length){var E={v:k,t:"s"};Array.isArray(o)?o[p][_]=E:o[st({r:p,c:_})]=E}break}v=m.lastIndex}_>f.e.c&&(f.e.c=_)}),o["!ref"]=Ct(f),o}function r(i,a){return Us(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=lr(i["!ref"]),o,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var p=st({r:f,c:d});o=u?(i[f]||[])[d]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Wa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function hP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Q0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function pP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,u=0,f=i+a;switch(u=s/(f>1?2-f:f),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,u,f/2]}function gP(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,s[0]+=i,s[1]+=u;break;case 1:u=i*(2-o),s[0]+=u,s[1]+=i;break;case 2:u=i*(o-2),s[1]+=i,s[2]+=u;break;case 3:u=i*(4-o),s[1]+=u,s[2]+=i;break;case 4:u=i*(o-4),s[2]+=i,s[0]+=u;break;case 5:u=i*(6-o),s[2]+=u,s[0]+=i;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Bd(e,t){if(t===0)return e;var r=pP(hP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Q0(gP(r))}var J8=6,mP=15,xP=1,Cn=J8;function Ud(e){return Math.floor((e+Math.round(128/Cn)/256)*Cn)}function jd(e){return Math.floor((e-5)/Cn*100+.5)/100}function Em(e){return Math.round((e*Cn+5)/Cn*256)/256}function tg(e){return Em(jd(Ud(e)))}function rx(e){var t=Math.abs(e-tg(e)),r=Cn;if(t>.005)for(Cn=xP;Cn<mP;++Cn)Math.abs(e-tg(e))<=t&&(t=Math.abs(e-tg(e)),r=Cn);Cn=r}function Yl(e){e.width?(e.wpx=Ud(e.width),e.wch=jd(e.wpx),e.MDW=Cn):e.wpx?(e.wch=jd(e.wpx),e.width=Em(e.wch),e.MDW=Cn):typeof e.wch=="number"&&(e.width=Em(e.wch),e.wpx=Ud(e.width),e.MDW=Cn),e.customWidth&&delete e.customWidth}var vP=96,Z8=vP;function eS(e){return e*96/Z8}function q0(e){return e*Z8/96}var yP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _P(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(xn)||[]).forEach(function(s){var o=tt(s);switch(ga(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Qt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Qt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function SP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(xn)||[]).forEach(function(s){var o=tt(s);switch(ga(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function wP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(xn)||[]).forEach(function(s){var o=tt(s);switch(ga(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Ht(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Qt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Qt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Qt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Qt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Qt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Qt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Qt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=B2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Qt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=yo[i.color.index];i.color.index==81&&(u=yo[1]),u||(u=yo[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Bd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kP(e,t,r){t.NumberFmt=[];for(var n=pa(ct),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ct[n[i]];var a=e[0].match(xn);if(a)for(i=0;i<a.length;++i){var s=tt(a[i]);switch(ga(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=At(Ht(s.formatCode)),u=parseInt(s.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}vo(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Lf=["numFmtId","fillId","fontId","borderId","xfId"],Mf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function EP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(xn)||[]).forEach(function(a){var s=tt(a),o=0;switch(ga(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<Lf.length;++o)n[Lf[o]]&&(n[Lf[o]]=parseInt(n[Lf[o]],10));for(o=0;o<Mf.length;++o)n[Mf[o]]&&(n[Mf[o]]=Qt(n[Mf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};s.vertical&&(u.vertical=s.vertical),s.horizontal&&(u.horizontal=s.horizontal),s.textRotation!=null&&(u.textRotation=s.textRotation),s.indent&&(u.indent=s.indent),s.wrapText&&(u.wrapText=Qt(s.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var CP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&kP(p,d,f),(p=o.match(i))&&wP(p,d,u,f),(p=o.match(n))&&SP(p,d,u,f),(p=o.match(a))&&_P(p,d,u,f),(p=o.match(r))&&EP(p,d,f),d}}();function TP(e,t){var r=e.read_shift(2),n=pn(e);return[r,n]}function AP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=M7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=L7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=pn(e),n}var PP=mn;function FP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var NP=mn;function RP(e,t,r){var n={};n.NumberFmt=[];for(var i in ct)n.NumberFmt[i]=ct[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return Xa(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],vo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Bd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var IP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(xn)||[]).forEach(function(i){var a=tt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[IP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function OP(){}function bP(){}var LP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UP(e,t,r){t.themeElements={};var n;[["clrScheme",LP,DP],["fontScheme",MP,OP],["fmtScheme",BP,bP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var jP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function tS(e,t){(!e||e.length===0)&&(e=zP());var r,n={};if(!(r=e.match(jP)))throw new Error("themeElements not found in theme");return UP(r[0],n,t),n.raw=e,n}function zP(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[d8];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function VP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=f8(a,{type:"array"})}catch{return}var o=qn(s,"theme/theme/theme1.xml",!0);if(o)return tS(o,r)}}function GP(e){return e.read_shift(4)}function HP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=WP(e,4);break;case 2:t.xclrValue=z8(e);break;case 3:t.xclrValue=GP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function WP(e,t){return mn(e,t)}function $P(e,t){return mn(e,t)}function XP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=HP(e);break;case 6:n[1]=$P(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(XP(e,r-e.l));return{ixfe:n,ext:a}}function YP(e,t){t.forEach(function(r){switch(r[0]){}})}function QP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:pn(e)}}function qP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JP(e){return e.l+=4,e.read_shift(4)!=0}function ZP(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return Xa(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!f.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function eF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(xn,function(o){var u=tt(o);switch(ga(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function tF(e){var t=[];if(!e)return t;var r=1;return(e.match(xn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function rF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function nF(e,t,r){var n=[];return Xa(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function iF(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Xa(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function aF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function g3(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=Tn(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var u=lr(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=Ct(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}a.c.push(d)})}function sF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=tt(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Tn(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&tx(p[1])||{r:"",t:"",h:""};f.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),f.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=m.h),n.push(f)}}}}),n}function oF(e,t){var r=[],n=!1,i={},a=0;return e.replace(xn,function(o,u){var f=tt(o);switch(ga(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+o.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function lF(e,t){var r=[],n=!1;return e.replace(xn,function(a){var s=tt(a);switch(ga(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function cF(e){var t={};t.iauthor=e.read_shift(4);var r=Oo(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}var uF=pn;function fF(e,t){var r=[],n=[],i={},a=!1;return Xa(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var dF="application/vnd.ms-office.vbaProject";function hF(e){var t=Et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Et.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Et.write(t)}function pF(){return{"!type":"dialog"}}function gF(){return{"!type":"dialog"}}function mF(){return{"!type":"macro"}}function xF(){return{"!type":"macro"}}var bl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,i+(o?"":"$")+Nr(d)+(u?"":"$")+qr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),rS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vF=function(){return function(t,r){return t.replace(rS,function(n,i,a,s,o,u){var f=Y2(s)-(a?0:r.c),d=K2(u)-(o?0:r.r),p=d==0?"":o?d+1:"["+d+"]",m=f==0?"":a?f+1:"["+f+"]";return i+"R"+p+"C"+m})}}();function nS(e,t){return e.replace(rS,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Nr(Y2(a)+t.c))+(s=="$"?s+o:qr(K2(o)+t.r))})}function yF(e,t,r){var n=ic(t),i=n.s,a=Tn(r),s={r:a.r-i.r,c:a.c-i.c};return nS(e,s)}function _F(e){return e.length!=1}function m3(e){return e.replace(/_xlfn\./g,"")}function xr(e){e.l+=1}function Os(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function iS(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return aS(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=Os(e,2),o=Os(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function aS(e){var t=Os(e,2),r=Os(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function SF(e,t,r){if(r.biff<8)return aS(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Os(e,2),s=Os(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function sS(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return wF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Os(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function wF(e){var t=Os(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function EF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return CF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function CF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function TF(e,t,r){var n=(e[e.l++]&96)>>5,i=iS(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=iS(e,a,r);return[n,i,s]}function PF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function NF(e,t,r){var n=(e[e.l++]&96)>>5,i=SF(e,t-1,r);return[n,i]}function RF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function x3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function IF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function DF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function LF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function oS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MF(e){return e.read_shift(2),oS(e)}function BF(e){return e.read_shift(2),oS(e)}function UF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=sS(e,0,r);return[n,i]}function jF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=EF(e,0,r);return[n,i]}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=sS(e,0,r);return[n,i,a]}function VF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[GN[i],uS[i],n]}function GF(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HF(e);return[i,(a[0]===0?uS:VN)[a[1]]]}function HF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WF(e,t,r){e.l+=r&&r.biff==2?3:4}function $F(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function XF(e){return e.l++,bo[e.read_shift(1)]}function KF(e){return e.l++,e.read_shift(2)}function YF(e){return e.l++,e.read_shift(1)!==0}function QF(e){return e.l++,dn(e)}function qF(e,t,r){return e.l++,cu(e,t-1,r)}function JF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=fr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=bo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=dn(e);break;case 2:r[1]=Lo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ZF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Oo:mh)(e));return i}function eN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=JF(e,r.biff);return s}function tN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function rN(e,t,r){if(r.biff==5)return nN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function nN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function iN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aN(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sN(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function oN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var lN=mn,cN=mn,uN=mn;function fu(e,t,r){return e.l+=2,[kF(e)]}function nx(e){return e.l+=6,[]}var fN=fu,dN=nx,hN=nx,pN=fu;function lS(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var gN=fu,mN=lS,xN=nx,vN=fu,yN=fu,_N=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=_N[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function wN(e){return e.l+=2,[e.read_shift(4)]}function kN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function EN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AN(e){return e.l+=4,[0,0]}var v3={1:{n:"PtgExp",f:$F},2:{n:"PtgTbl",f:uN},3:{n:"PtgAdd",f:xr},4:{n:"PtgSub",f:xr},5:{n:"PtgMul",f:xr},6:{n:"PtgDiv",f:xr},7:{n:"PtgPower",f:xr},8:{n:"PtgConcat",f:xr},9:{n:"PtgLt",f:xr},10:{n:"PtgLe",f:xr},11:{n:"PtgEq",f:xr},12:{n:"PtgGe",f:xr},13:{n:"PtgGt",f:xr},14:{n:"PtgNe",f:xr},15:{n:"PtgIsect",f:xr},16:{n:"PtgUnion",f:xr},17:{n:"PtgRange",f:xr},18:{n:"PtgUplus",f:xr},19:{n:"PtgUminus",f:xr},20:{n:"PtgPercent",f:xr},21:{n:"PtgParen",f:xr},22:{n:"PtgMissArg",f:xr},23:{n:"PtgStr",f:qF},26:{n:"PtgSheet",f:kN},27:{n:"PtgEndSheet",f:EN},28:{n:"PtgErr",f:XF},29:{n:"PtgBool",f:YF},30:{n:"PtgInt",f:KF},31:{n:"PtgNum",f:QF},32:{n:"PtgArray",f:RF},33:{n:"PtgFunc",f:VF},34:{n:"PtgFuncVar",f:GF},35:{n:"PtgName",f:tN},36:{n:"PtgRef",f:UF},37:{n:"PtgArea",f:TF},38:{n:"PtgMemArea",f:iN},39:{n:"PtgMemErr",f:lN},40:{n:"PtgMemNoMem",f:cN},41:{n:"PtgMemFunc",f:aN},42:{n:"PtgRefErr",f:sN},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:jF},45:{n:"PtgAreaN",f:NF},46:{n:"PtgMemAreaN",f:CN},47:{n:"PtgMemNoMemN",f:TN},57:{n:"PtgNameX",f:rN},58:{n:"PtgRef3d",f:zF},59:{n:"PtgArea3d",f:AF},60:{n:"PtgRefErr3d",f:oN},61:{n:"PtgAreaErr3d",f:FF},255:{}},PN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FN={1:{n:"PtgElfLel",f:lS},2:{n:"PtgElfRw",f:vN},3:{n:"PtgElfCol",f:fN},6:{n:"PtgElfRwV",f:yN},7:{n:"PtgElfColV",f:pN},10:{n:"PtgElfRadical",f:gN},11:{n:"PtgElfRadicalS",f:xN},13:{n:"PtgElfColS",f:dN},15:{n:"PtgElfColSV",f:hN},16:{n:"PtgElfRadicalLel",f:mN},25:{n:"PtgList",f:SN},29:{n:"PtgSxName",f:wN},255:{}},NN={0:{n:"PtgAttrNoop",f:AN},1:{n:"PtgAttrSemi",f:LF},2:{n:"PtgAttrIf",f:OF},4:{n:"PtgAttrChoose",f:IF},8:{n:"PtgAttrGoto",f:DF},16:{n:"PtgAttrSum",f:WF},32:{n:"PtgAttrBaxcel",f:x3},33:{n:"PtgAttrBaxcel",f:x3},64:{n:"PtgAttrSpace",f:MF},65:{n:"PtgAttrSpaceSemi",f:BF},128:{n:"PtgAttrIfError",f:bF},255:{}};function du(e,t,r,n){if(n.biff<8)return mn(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=eN(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ZF(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(mn(e,t)),a}function hu(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=v3[a]||v3[PN[a]],(a===24||a===25)&&(i=(a===24?FN:NN)[e[e.l+1]]),!i||!i.f?mn(e,t):s.push([i.n,i.f(e,t,r)]);return s}function RN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var IN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function cS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y3(e,t,r){var n=cS(e,t,r);return n=="#REF"?n:DN(n,r)}function un(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],u,f,d,p=0,m=0,v,g="";if(!e[0]||!e[0][0])return"";for(var _=-1,k="",E=0,S=e[0].length;E<S;++E){var x=e[0][E];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),_>=0){switch(e[0][_][1][0]){case 0:k=sr(" ",e[0][_][1][1]);break;case 1:k=sr("\r",e[0][_][1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}f=f+k,_=-1}o.push(f+IN[x[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=x0(x[1][1],s,i),o.push(v0(d,a));break;case"PtgRefN":d=r?x0(x[1][1],r,i):x[1][1],o.push(v0(d,a));break;case"PtgRef3d":p=x[1][1],d=x0(x[1][2],s,i),g=y3(n,p,i),o.push(g+"!"+v0(d,a));break;case"PtgFunc":case"PtgFuncVar":var C=x[1][0],N=x[1][1];C||(C=0),C&=127;var T=C==0?[]:o.slice(-C);o.length-=C,N==="User"&&(N=T.shift()),o.push(N+"("+T.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":v=Zy(x[1][1],r?{s:r}:s,i),o.push(Zp(v,i));break;case"PtgArea":v=Zy(x[1][1],s,i),o.push(Zp(v,i));break;case"PtgArea3d":p=x[1][1],v=x[1][2],g=y3(n,p,i),o.push(g+"!"+Zp(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=x[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],P=F?F.Name:"SH33TJSNAME"+String(m);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var I=x[1][1];m=x[1][2];var D;if(i.biff<=5)I<0&&(I=-I),n[I]&&(D=n[I][m]);else{var U="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][m]&&n[I][m].itab>0&&(U=n.SheetNames[n[I][m].itab-1]+"!"):U=n.SheetNames[m-1]+"!"),n[I]&&n[I][m])U+=n[I][m].Name;else if(n[0]&&n[0][m])U+=n[0][m].Name;else{var b=(cS(n,I,i)||"").split(";;");b[m-1]?U=b[m-1]:U+="SH33TJSERRX"}o.push(U);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var Q="(",he=")";if(_>=0){switch(k="",e[0][_][1][0]){case 2:Q=sr(" ",e[0][_][1][1])+Q;break;case 3:Q=sr("\r",e[0][_][1][1])+Q;break;case 4:he=sr(" ",e[0][_][1][1])+he;break;case 5:he=sr("\r",e[0][_][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}o.push(Q+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[st(d)]){var Ae=n.sharedf[st(d)];o.push(un(Ae,s,te,n,i))}else{var Te=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(un(f[1],s,te,n,i)),Te=!0;break}Te||o.push(x[1])}break;case"PtgArray":o.push("{"+RN(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ie.indexOf(e[0][E][0])==-1){x=e[0][_];var X=!0;switch(x[1][0]){case 4:X=!1;case 0:k=sr(" ",x[1][1]);break;case 5:X=!1;case 1:k=sr("\r",x[1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((X?k:"")+o.pop()+(X?"":k)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function ON(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],mn(e,t-2)];var o=hu(e,s,r);return t!==s+i&&(a=du(e,t-s-i,o,r)),e.l=n,[o,a]}function bN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],mn(e,t-2)];var o=hu(e,s,r);return t!==s+i&&(a=du(e,t-s-i,o,r)),e.l=n,[o,a]}function LN(e,t,r,n){var i=e.l+t,a=hu(e,n,r),s;return i!==e.l&&(s=du(e,i-e.l,a,r)),[a,s]}function MN(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=hu(e,a,r);return a==65535?[[],mn(e,t-2)]:(t!==a+2&&(i=du(e,n-a-2,s,r)),[s,i])}function BN(e){var t;if(ba(e,e.l+6)!==65535)return[dn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function rg(e,t,r){var n=e.l+t,i=ma(e);r.biff==2&&++e.l;var a=BN(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=bN(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function xh(e,t,r){var n=e.read_shift(4),i=hu(e,n,r),a=e.read_shift(4),s=a>0?du(e,a,i,r):null;return[i,s]}var UN=xh,vh=xh,jN=xh,zN=xh,VN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},uS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ng(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var w0={},Ll={};function k0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function fS(e,t,r,n,i,a){try{n.cellNF&&(e.z=ct[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Hr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ct[t]==null&&vo(WC[t]||"General",t),e.t==="e")e.w=e.w||bo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v);else if(e.t==="d"){var s=Fn(e.v);(s|0)===s?e.w=s.toString(10):e.w=$0(s)}else{if(e.v===void 0)return"";e.w=To(e.v,Ll)}else e.t==="d"?e.w=Ci(t,Fn(e.v),Ll):e.w=Ci(t,e.v,Ll)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Bd(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Bd(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function HN(e,t){var r=lr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ct(r))}var WN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,$N=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XN=/<(?:\w:)?hyperlink [^>]*>/mg,KN=/"(\w*:\w*)"/,YN=/<(?:\w:)?col\b[^>]*[\/]?>/g,QN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qN=/<(?:\w:)?pageMargins[^>]*\/>/g,dS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,JN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function eR(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match($N);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var m=f.match(dS);m?ix(m[0],o,i,r):(m=f.match(JN))&&tR(m[0],m[1]||"",o,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var g=f.slice(v,v+50).match(KN);g&&HN(o,g[1])}var _=f.match(ZN);_&&_[1]&&oR(_[1],i);var k=[];if(t.cellStyles){var E=f.match(YN);E&&iR(k,E)}p&&lR(p[1],o,t,u,a,s);var S=d.match(QN);S&&(o["!autofilter"]=aR(S[0]));var x=[],C=d.match(WN);if(C)for(v=0;v!=C.length;++v)x[v]=lr(C[v].slice(C[v].indexOf('"')+1));var N=d.match(XN);N&&rR(o,N,n);var T=d.match(qN);if(T&&(o["!margins"]=nR(tt(T[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=Ct(u)),t.sheetRows>0&&o["!ref"]){var F=lr(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ct(F))}return k.length>0&&(o["!cols"]=k),x.length>0&&(o["!merges"]=x),o}function ix(e,t,r,n){var i=tt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=At(Ht(i.codeName)))}function tR(e,t,r,n,i){ix(e.slice(0,e.indexOf(">")),r,n,i)}function rR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=tt(Ht(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+At(a.location))):(a.Target="#"+At(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=lr(a.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=st({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function nR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function iR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=tt(t[n],!0);i.hidden&&(i.hidden=Qt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,rx(i.width)),Yl(i);a<=s;)e[a++]=Qr(i)}}function aR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var sR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oR(e,t){t.Views||(t.Views=[{}]),(e.match(sR)||[]).forEach(function(r,n){var i=tt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Qt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var lR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=X0("v"),s=X0("f");return function(u,f,d,p,m,v){for(var g=0,_="",k=[],E=[],S=0,x=0,C=0,N="",T,F,P=0,I=0,D,U,b=0,Q=0,he=Array.isArray(v.CellXf),te,Ae=[],Te=[],ie=Array.isArray(f),X=[],ce={},Ce=!1,L=!!d.sheetStubs,q=u.split(t),Y=0,K=q.length;Y!=K;++Y){_=q[Y].trim();var de=_.length;if(de!==0){var G=0;e:for(g=0;g<de;++g)switch(_[g]){case">":if(_[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(F=tt(_.slice(G,g),!0),P=F.r!=null?parseInt(F.r,10):P+1,I=-1,d.sheetRows&&d.sheetRows<P)continue;ce={},Ce=!1,F.ht&&(Ce=!0,ce.hpt=parseFloat(F.ht),ce.hpx=q0(ce.hpt)),F.hidden=="1"&&(Ce=!0,ce.hidden=!0),F.outlineLevel!=null&&(Ce=!0,ce.level=+F.outlineLevel),Ce&&(X[P-1]=ce)}break;case"<":G=g;break}if(G>=g)break;if(F=tt(_.slice(G,g),!0),P=F.r!=null?parseInt(F.r,10):P+1,I=-1,!(d.sheetRows&&d.sheetRows<P)){p.s.r>P-1&&(p.s.r=P-1),p.e.r<P-1&&(p.e.r=P-1),d&&d.cellStyles&&(ce={},Ce=!1,F.ht&&(Ce=!0,ce.hpt=parseFloat(F.ht),ce.hpx=q0(ce.hpt)),F.hidden=="1"&&(Ce=!0,ce.hidden=!0),F.outlineLevel!=null&&(Ce=!0,ce.level=+F.outlineLevel),Ce&&(X[P-1]=ce)),k=_.slice(g).split(e);for(var J=0;J!=k.length&&k[J].trim().charAt(0)=="<";++J);for(k=k.slice(J),g=0;g!=k.length;++g)if(_=k[g].trim(),_.length!==0){if(E=_.match(r),S=g,x=0,C=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,E!=null&&E.length===2){for(S=0,N=E[1],x=0;x!=N.length&&!((C=N.charCodeAt(x)-64)<1||C>26);++x)S=26*S+C;--S,I=S}else++I;for(x=0;x!=_.length&&_.charCodeAt(x)!==62;++x);if(++x,F=tt(_.slice(0,x),!0),F.r||(F.r=st({r:P-1,c:I})),N=_.slice(x),T={t:""},(E=N.match(a))!=null&&E[1]!==""&&(T.v=At(E[1])),d.cellFormula){if((E=N.match(s))!=null&&E[1]!==""){if(T.f=At(Ht(E[1])).replace(/\r\n/g,`
`),d.xlfn||(T.f=m3(T.f)),E[0].indexOf('t="array"')>-1)T.F=(N.match(i)||[])[1],T.F.indexOf(":")>-1&&Ae.push([lr(T.F),T.F]);else if(E[0].indexOf('t="shared"')>-1){U=tt(E[0]);var ue=At(Ht(E[1]));d.xlfn||(ue=m3(ue)),Te[parseInt(U.si,10)]=[U,ue,F.r]}}else(E=N.match(/<f[^>]*\/>/))&&(U=tt(E[0]),Te[U.si]&&(T.f=yF(Te[U.si][1],Te[U.si][2],F.r)));var ve=Tn(F.r);for(x=0;x<Ae.length;++x)ve.r>=Ae[x][0].s.r&&ve.r<=Ae[x][0].e.r&&ve.c>=Ae[x][0].s.c&&ve.c<=Ae[x][0].e.c&&(T.F=Ae[x][1])}if(F.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(L)T.t="z";else continue;else T.t=F.t||"n";switch(p.s.c>I&&(p.s.c=I),p.e.c<I&&(p.e.c=I),T.t){case"n":if(T.v==""||T.v==null){if(!L)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!L)continue;T.t="z"}else D=w0[parseInt(T.v,10)],T.v=D.t,T.r=D.r,d.cellHTML&&(T.h=D.h);break;case"str":T.t="s",T.v=T.v!=null?Ht(T.v):"",d.cellHTML&&(T.h=W2(T.v));break;case"inlineStr":E=N.match(n),T.t="s",E!=null&&(D=tx(E[1]))?(T.v=D.t,d.cellHTML&&(T.h=D.h)):T.v="";break;case"b":T.v=Qt(T.v);break;case"d":d.cellDates?T.v=Hr(T.v,1):(T.v=Fn(Hr(T.v,1)),T.t="n");break;case"e":(!d||d.cellText!==!1)&&(T.w=T.v),T.v=D8[T.v];break}if(b=Q=0,te=null,he&&F.s!==void 0&&(te=v.CellXf[F.s],te!=null&&(te.numFmtId!=null&&(b=te.numFmtId),d.cellStyles&&te.fillId!=null&&(Q=te.fillId))),fS(T,b,Q,d,m,v),d.cellDates&&he&&T.t=="n"&&nc(ct[b])&&(T.t="d",T.v=gh(T.v)),F.cm&&d.xlmeta){var Be=(d.xlmeta.Cell||[])[+F.cm-1];Be&&Be.type=="XLDAPR"&&(T.D=!0)}if(ie){var V=Tn(F.r);f[V.r]||(f[V.r]=[]),f[V.r][V.c]=T}else f[F.r]=T}}}}X.length>0&&(f["!rows"]=X)}}();function cR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var uR=Oo;function fR(){}function dR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=O7(e),r}function hR(e){var t=Ti(e);return[t]}function pR(e){var t=Do(e);return[t]}function gR(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"b"]}function mR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"b"]}function xR(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"e"]}function vR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"e"]}function yR(e){var t=Ti(e),r=e.read_shift(4);return[t,r,"s"]}function _R(e){var t=Do(e),r=e.read_shift(4);return[t,r,"s"]}function SR(e){var t=Ti(e),r=dn(e);return[t,r,"n"]}function hS(e){var t=Do(e),r=dn(e);return[t,r,"n"]}function wR(e){var t=Ti(e),r=J2(e);return[t,r,"n"]}function kR(e){var t=Do(e),r=J2(e);return[t,r,"n"]}function ER(e){var t=Ti(e),r=Q2(e);return[t,r,"is"]}function CR(e){var t=Ti(e),r=pn(e);return[t,r,"str"]}function TR(e){var t=Do(e),r=pn(e);return[t,r,"str"]}function AR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=un(o,null,i,r.supbooks,r)}else e.l=n;return s}function PR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=un(o,null,i,r.supbooks,r)}else e.l=n;return s}function FR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=dn(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=un(o,null,i,r.supbooks,r)}else e.l=n;return s}function NR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=pn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=un(o,null,i,r.supbooks,r)}else e.l=n;return s}var RR=Oo;function IR(e,t){var r=e.l+t,n=Oo(e),i=q2(e),a=pn(e),s=pn(e),o=pn(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:o};return s&&(u.Tooltip=s),u}function DR(){}function OR(e,t,r){var n=e.l+t,i=N8(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=UN(e,n-e.l,r);s[1]=o}else e.l=n;return s}function bR(e,t,r){var n=e.l+t,i=Oo(e),a=[i];if(r.cellFormula){var s=zN(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}var LR=["left","right","top","bottom","header","footer"];function MR(e){var t={};return LR.forEach(function(r){t[r]=dn(e)}),t}function BR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UR(){}function jR(){}function zR(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,v,g,_,k,E,S,x,C,N,T=[];o.biff=12,o["!row"]=0;var F=0,P=!1,I=[],D={},U=o.supbooks||i.supbooks||[[]];if(U.sharedf=D,U.arrayf=I,U.SheetNames=i.SheetNames||i.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=U,i.Names))for(var b=0;b<i.Names.length;++b)U[0][b+1]=i.Names[b];var Q=[],he=[],te=!1;zd[16]={n:"BrtShortReal",f:hS};var Ae;if(Xa(e,function(X,ce,Ce){if(!m)switch(Ce){case 148:f=X;break;case 0:v=X,o.sheetRows&&o.sheetRows<=v.r&&(m=!0),C=qr(k=v.r),o["!row"]=v.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=q0(X.hpt)),he[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:X[2]},X[2]){case"n":g.v=X[1];break;case"s":x=w0[X[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!X[1];break;case"e":g.v=X[1],o.cellText!==!1&&(g.w=bo[g.v]);break;case"str":g.t="s",g.v=X[1];break;case"is":g.t="s",g.v=X[1].t;break}if((_=s.CellXf[X[0].iStyleRef])&&fS(g,_.numFmtId,null,o,a,s),E=X[0].c==-1?E+1:X[0].c,o.dense?(u[k]||(u[k]=[]),u[k][E]=g):u[Nr(E)+C]=g,o.cellFormula){for(P=!1,F=0;F<I.length;++F){var L=I[F];v.r>=L[0].s.r&&v.r<=L[0].e.r&&E>=L[0].s.c&&E<=L[0].e.c&&(g.F=Ct(L[0]),P=!0)}!P&&X.length>3&&(g.f=X[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>E&&(d.s.c=E),d.e.r<v.r&&(d.e.r=v.r),d.e.c<E&&(d.e.c=E),o.cellDates&&_&&g.t=="n"&&nc(ct[_.numFmtId])){var q=po(g.v);q&&(g.t="d",g.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;g={t:"z",v:void 0},E=X[0].c==-1?E+1:X[0].c,o.dense?(u[k]||(u[k]=[]),u[k][E]=g):u[Nr(E)+C]=g,d.s.r>v.r&&(d.s.r=v.r),d.s.c>E&&(d.s.c=E),d.e.r<v.r&&(d.e.r=v.r),d.e.c<E&&(d.e.c=E),Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 176:T.push(X);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var Y=n["!id"][X.relId];for(Y?(X.Target=Y.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=Y):X.relId==""&&(X.Target="#"+X.loc),k=X.rfx.s.r;k<=X.rfx.e.r;++k)for(E=X.rfx.s.c;E<=X.rfx.e.c;++E)o.dense?(u[k]||(u[k]=[]),u[k][E]||(u[k][E]={t:"z",v:void 0}),u[k][E].l=X):(S=st({c:E,r:k}),u[S]||(u[S]={t:"z",v:void 0}),u[S].l=X);break;case 426:if(!o.cellFormula)break;I.push(X),N=o.dense?u[k][E]:u[Nr(E)+C],N.f=un(X[1],d,{r:v.r,c:E},U,o),N.F=Ct(X[0]);break;case 427:if(!o.cellFormula)break;D[st(X[0].s)]=X[1],N=o.dense?u[k][E]:u[Nr(E)+C],N.f=un(X[1],d,{r:v.r,c:E},U,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)Q[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},te||(te=!0,rx(X.w/256)),Yl(Q[X.e+1]);break;case 161:u["!autofilter"]={ref:Ct(X)};break;case 476:u["!margins"]=X;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),X.name&&(i.Sheets[r].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!ce.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=Ct(f||d)),o.sheetRows&&u["!ref"]){var Te=lr(u["!ref"]);o.sheetRows<=+Te.e.r&&(Te.e.r=o.sheetRows-1,Te.e.r>d.e.r&&(Te.e.r=d.e.r),Te.e.r<Te.s.r&&(Te.s.r=Te.e.r),Te.e.c>d.e.c&&(Te.e.c=d.e.c),Te.e.c<Te.s.c&&(Te.s.c=Te.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ct(Te))}return T.length>0&&(u["!merges"]=T),Q.length>0&&(u["!cols"]=Q),he.length>0&&(u["!rows"]=he),u}function VR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function GR(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=VR(p);d.s.r=d.s.c=0,d.e.c=o,f=Nr(o),m[0].forEach(function(v,g){s[f+qr(g)]={t:"n",v,z:m[1]},u=g}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(s["!ref"]=Ct(d)),s}function HR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(dS);return o&&ix(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function WR(e,t){e.l+=10;var r=pn(e);return{name:r}}function $R(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Xa(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var pS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],XR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KR=[],YR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function S3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Qt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function w3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Qt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function gS(e){w3(e.WBProps,pS),w3(e.CalcPr,YR),S3(e.WBView,XR),S3(e.Sheets,KR),Ll.date1904=Qt(e.WBProps.date1904)}var QR="][*?/\\".split("");function qR(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return QR.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var JR=/<\w+:workbook/;function ZR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(xn,function(u,f){var d=tt(u);switch(ga(d[0])){case"<?xml":break;case"<workbook":u.match(JR)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":pS.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Qt(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=Ht(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=At(Ht(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ht(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Qt(d.hidden||"0")&&(a.Hidden=!0),s=f+u.length;break;case"</definedName>":a.Ref=At(Ht(e.slice(s,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),x7.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gS(r),r}function eI(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Sm(e),r.name=pn(e),r}function tI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?pn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=b7(e),s=jN(e,0,r),o=q2(e);e.l=n;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function iI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],zd[16]={n:"BrtFRTArchID$",f:rI},Xa(e,function(u,f,d){switch(d){case 156:s.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=un(u.Ptg,null,null,s,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,u]):s[0]=[d,u],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(u),s.XTI=s.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),gS(r),r.Names=a,r.supbooks=s,r}function aI(e,t,r){return t.slice(-4)===".bin"?iI(e,r):ZR(e,r)}function sI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?zR(e,n,r,i,a,s,o):eR(e,n,r,i,a,s,o)}function oI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?$R(e,n,r,i,a):HR(e,n,r,i,a)}function lI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?mF():xF()}function cI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?pF():gF()}function uI(e,t,r,n){return t.slice(-4)===".bin"?RP(e,r,n):CP(e,r,n)}function fI(e,t,r){return tS(e,r)}function dI(e,t,r){return t.slice(-4)===".bin"?XA(e,r):WA(e,r)}function hI(e,t,r){return t.slice(-4)===".bin"?fF(e,r):sF(e,r)}function pI(e,t,r){return t.slice(-4)===".bin"?nF(e):tF(e)}function gI(e,t,r,n){return r.slice(-4)===".bin"?iF(e,t,r,n):void 0}function mI(e,t,r){return t.slice(-4)===".bin"?ZP(e,t,r):eF(e,t,r)}var mS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function bi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(mS),a,s,o,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(xS),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function xI(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(mS),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(xS),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var E0;function vI(e,t){var r=E0[e]||At(e);return r==="General"?To(t):Ci(r,t)}function yI(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Qt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[At(t)]=i}function _I(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=vI(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=E0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&nc(n)){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function SI(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=yP[n.Pattern]||n.Pattern)}e[t.ID]=t}function wI(e,t,r,n,i,a,s,o,u,f){var d="General",p=n.StyleID,m={};f=f||{};var v=[],g=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);a[p]!==void 0&&(a[p].nf&&(d=a[p].nf),a[p].Interior&&v.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Qt(e);break;case"String":n.t="s",n.r=Hy(At(e)),n.v=e.indexOf("<")>-1?At(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Hr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=At(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=D8[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Hy(t||e));break}if(_I(n,d,f),f.cellFormula!==!1)if(n.Formula){var _=At(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=bl(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=bl("RC:RC",i):n.ArrayRange&&(n.F=bl(n.ArrayRange,i),u.push([lr(n.F),n.F]))}else for(g=0;g<u.length;++g)i.r>=u[g][0].s.r&&i.r<=u[g][0].e.r&&i.c>=u[g][0].s.c&&i.c<=u[g][0].e.c&&(n.F=u[g][1]);f.cellStyles&&(v.forEach(function(k){!m.patternType&&k.patternType&&(m.patternType=k.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kI(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ig(e,t){var r=t||{};i8();var n=t0($2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ht(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Qr(r);return s.type="string",Y0.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wt){i.indexOf("<"+wt)>=0&&(a=!0)}),a)return II(n,r);E0={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},p=[],m=r.dense?[]:{},v="",g={},_={},k=bi('<Data ss:Type="String">'),E=0,S=0,x=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},T={},F="",P=0,I=[],D={},U={},b=0,Q=[],he=[],te={},Ae=[],Te,ie=!1,X=[],ce=[],Ce={},L=0,q=0,Y={Sheets:[],WBProps:{date1904:!1}},K={};K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=K0.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?wI(n.slice(E,o.index),F,k,u[u.length-1][0]=="comment"?te:g,{c:S,r:x},N,Ae[S],_,X,r):(F="",k=bi(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(he.length>0&&(g.c=he),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(m[x]||(m[x]=[]),m[x][S]=g):m[Nr(S)+qr(x)]=g),g.HRef&&(g.l={Target:At(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(L=S+(parseInt(g.MergeAcross,10)|0),q=x+(parseInt(g.MergeDown,10)|0),I.push({s:{c:S,r:x},e:{c:L,r:q}})),!r.sheetStubs)g.MergeAcross?S=L+1:++S;else if(g.MergeAcross||g.MergeDown){for(var G=S;G<=L;++G)for(var J=x;J<=q;++J)(G>S||J>x)&&(r.dense?(m[J]||(m[J]=[]),m[J][G]={t:"z"}):m[Nr(G)+qr(J)]={t:"z"});S=L+1}else++S;else g=xI(o[0]),g.Index&&(S=+g.Index-1),S<C.s.c&&(C.s.c=S),S>C.e.c&&(C.e.c=S),o[0].slice(-2)==="/>"&&++S,he=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<C.s.r&&(C.s.r=x),x>C.e.r&&(C.e.r=x),o[0].slice(-2)==="/>"&&(_=bi(o[0]),_.Index&&(x=+_.Index-1)),S=0,++x):(_=bi(o[0]),_.Index&&(x=+_.Index-1),Ce={},(_.AutoFitHeight=="0"||_.Height)&&(Ce.hpx=parseInt(_.Height,10),Ce.hpt=eS(Ce.hpx),ce[x]=Ce),_.Hidden=="1"&&(Ce.hidden=!0,ce[x]=Ce));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(m["!ref"]=Ct(C),r.sheetRows&&r.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=r.sheetRows-1,m["!ref"]=Ct(C))),I.length&&(m["!merges"]=I),Ae.length>0&&(m["!cols"]=Ae),ce.length>0&&(m["!rows"]=ce),d[v]=m}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=S=0,u.push([o[3],!1]),f=bi(o[0]),v=At(f.Name),m=r.dense?[]:{},I=[],X=[],ce=[],K={name:v,Hidden:0},Y.Sheets.push(K);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),Ae=[],ie=!1}break;case"style":o[1]==="/"?SI(N,T,r):T=bi(o[0]);break;case"numberformat":T.nf=At(bi(o[0]).Format||"General"),E0[T.nf]&&(T.nf=E0[T.nf]);for(var ue=0;ue!=392&&ct[ue]!=T.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(ct[ue]==null){vo(T.nf,ue);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Te=bi(o[0]),Te.Hidden&&(Te.hidden=!0,delete Te.Hidden),Te.Width&&(Te.wpx=parseInt(Te.Width,10)),!ie&&Te.wpx>10){ie=!0,Cn=J8;for(var ve=0;ve<Ae.length;++ve)Ae[ve]&&Yl(Ae[ve])}ie&&Yl(Te),Ae[Te.Index-1||Ae.length]=Te;for(var Be=0;Be<+Te.Span;++Be)Ae[Ae.length]=Qr(Te);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var V=tt(o[0]),Ze={Name:V.Name,Ref:bl(V.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Ze.Sheet=Y.Sheets.length-1),Y.Names.push(Ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=bi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sT(D,de,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));kI(te),he.push(te)}else u.push([o[3],!1]),f=bi(o[0]),te={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var nt=bi(o[0]);m["!autofilter"]={ref:bl(nt.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return P3(n,r);var Ye=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else b=o.index+o[0].length;break;case"header":m["!margins"]||k0(m["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(m["!margins"].header=+tt(o[0]).Margin);break;case"footer":m["!margins"]||k0(m["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(m["!margins"].footer=+tt(o[0]).Margin);break;case"pagemargins":var Je=tt(o[0]);m["!margins"]||k0(m["!margins"]={},"xlml"),isNaN(+Je.Top)||(m["!margins"].top=+Je.Top),isNaN(+Je.Left)||(m["!margins"].left=+Je.Left),isNaN(+Je.Right)||(m["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(m["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?yI(U,de,Q,n.slice(b,o.index)):(Q=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var Re={};return!r.bookSheets&&!r.bookProps&&(Re.Sheets=d),Re.SheetNames=p,Re.Workbook=Y,Re.SSF=Qr(ct),Re.Props=D,Re.Custprops=U,Re}function Cm(e,t){switch(ox(t=t||{}),t.type||"base64"){case"base64":return ig(ri(e),t);case"binary":case"buffer":case"file":return ig(e,t);case"array":return ig(Io(e),t)}}function EI(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=B7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=U7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CI=[60,1084,2066,2165,2175];function TI(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var u=ba(r,r.l),f=Tm[u],d=0;f!=null&&CI.indexOf(u)>-1;)a=ba(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,f=Tm[u=ba(r,r.l)];var p=ms(s);Kr(p,0);var m=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(m),m+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function sa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ct[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=Ci(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&nc(ct[n]||String(n))){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bf(e,t,r){return{v:e,ixfe:t,t:r}}function AI(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,u=[],f="",d={},p,m="",v,g,_,k,E={},S=[],x,C,N=[],T=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},I=function(xe){return xe<8?yo[xe]:xe<64&&T[xe-8]||yo[xe]},D=function(xe,De,Le){var Ke=De.XF.data;if(!(!Ke||!Ke.patternType||!Le||!Le.cellStyles)){De.s={},De.s.patternType=Ke.patternType;var xt;(xt=Q0(I(Ke.icvFore)))&&(De.s.fgColor={rgb:xt}),(xt=Q0(I(Ke.icvBack)))&&(De.s.bgColor={rgb:xt})}},U=function(xe,De,Le){if(!(Ce>1)&&!(Le.sheetRows&&xe.r>=Le.sheetRows)){if(Le.cellStyles&&De.XF&&De.XF.data&&D(xe,De,Le),delete De.ixfe,delete De.XF,p=xe,m=st(xe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<s.s.r&&(s.s.r=xe.r),xe.c<s.s.c&&(s.s.c=xe.c),xe.r+1>s.e.r&&(s.e.r=xe.r+1),xe.c+1>s.e.c&&(s.e.c=xe.c+1),Le.cellFormula&&De.f){for(var Ke=0;Ke<S.length;++Ke)if(!(S[Ke][0].s.c>xe.c||S[Ke][0].s.r>xe.r)&&!(S[Ke][0].e.c<xe.c||S[Ke][0].e.r<xe.r)){De.F=Ct(S[Ke][0]),(S[Ke][0].s.c!=xe.c||S[Ke][0].s.r!=xe.r)&&delete De.f,De.f&&(De.f=""+un(S[Ke][1],s,xe,X,b));break}}Le.dense?(i[xe.r]||(i[xe.r]=[]),i[xe.r][xe.c]=De):i[m]=De}},b={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var Q,he=[],te=[],Ae=[],Te=[],ie=!1,X=[];X.SheetNames=b.snames,X.sharedf=b.sharedf,X.arrayf=b.arrayf,X.names=[],X.XTI=[];var ce=0,Ce=0,L=0,q=[],Y=[],K;b.codepage=1200,Vi(1200);for(var de=!1;e.l<e.length-1;){var G=e.l,J=e.read_shift(2);if(J===0&&ce===10)break;var ue=e.l===e.length?0:e.read_shift(2),ve=Tm[J];if(ve&&ve.f){if(t.bookSheets&&ce===133&&J!==133)break;if(ce=J,ve.r===2||ve.r==12){var Be=e.read_shift(2);if(ue-=2,!b.enc&&Be!==J&&((Be&255)<<8|Be>>8)!==J)throw new Error("rt mismatch: "+Be+"!="+J);ve.r==12&&(e.l+=10,ue-=10)}var V={};if(J===10?V=ve.f(e,ue,b):V=TI(J,ve,e,ue,b),Ce==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(J){case 34:r.opts.Date1904=F.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=V;break;case 66:var Ze=Number(V);switch(Ze){case 21010:Ze=1200;break;case 32768:Ze=1e4;break;case 32769:Ze=1252;break}Vi(b.codepage=Ze),de=!0;break;case 317:b.rrtabid=V;break;case 25:b.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:b.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(i["!type"]="dialog"),V.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),V.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:N.push(V);break;case 430:X.push([V]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(V);break;case 24:case 536:K={Name:V.Name,Ref:un(V.rgce,s,null,X,b)},V.itab>0&&(K.Sheet=V.itab-1),X.names.push(K),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(Y[V.itab-1]={ref:Ct(V.rgce[0][0][1][2])});break;case 22:b.ExternCount=V;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(V),X.XTI=X.XTI.concat(V);break;case 2196:if(b.biff<8)break;K!=null&&(K.Comment=V[1]);break;case 18:i["!protect"]=V;break;case 19:V!==0&&b.WTF&&console.error("Password verifier: "+V);break;case 133:a[V.pos]=V,b.snames.push(V.name);break;case 10:{if(--Ce)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=Ct(s),t.sheetRows&&t.sheetRows<=s.e.r){var nt=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ct(s),s.e.r=nt}s.e.r++,s.e.c++}he.length>0&&(i["!merges"]=he),te.length>0&&(i["!objects"]=te),Ae.length>0&&(i["!cols"]=Ae),Te.length>0&&(i["!rows"]=Te),F.Sheets.push(P)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),b.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(b.biff=5,de=!0,Vi(b.codepage=28591)),b.biff==8&&V.BIFFVer==0&&V.dt==16&&(b.biff=2),Ce++)break;if(i=t.dense?[]:{},b.biff<8&&!de&&(de=!0,Vi(b.codepage=t.codepage||1252)),b.biff<5||V.BIFFVer==0&&V.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:e.l-ue,name:f};a[Ye.pos]=Ye,b.snames.push(f)}else f=(a[G]||{name:""}).name;V.dt==32&&(i["!type"]="chart"),V.dt==64&&(i["!type"]="macro"),he=[],te=[],b.arrayf=S=[],Ae=[],Te=[],ie=!1,P={Hidden:(a[G]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[V.r]||[])[V.c]:i[st({c:V.c,r:V.r})])&&++V.c,x={ixfe:V.ixfe,XF:N[V.ixfe]||{},v:V.val,t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t);break;case 5:case 517:x={ixfe:V.ixfe,XF:N[V.ixfe],v:V.val,t:V.t},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t);break;case 638:x={ixfe:V.ixfe,XF:N[V.ixfe],v:V.rknum,t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t);break;case 189:for(var Je=V.c;Je<=V.C;++Je){var Re=V.rkrec[Je-V.c][0];x={ixfe:Re,XF:N[Re],v:V.rkrec[Je-V.c][1],t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:Je,r:V.r},x,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){o=V;break}if(x=Bf(V.val,V.cell.ixfe,V.tt),x.XF=N[x.ixfe],t.cellFormula){var wt=V.formula;if(wt&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp"){var Or=wt[0][0][1][0],pr=wt[0][0][1][1],_e=st({r:Or,c:pr});E[_e]?x.f=""+un(V.formula,s,V.cell,X,b):x.F=((t.dense?(i[Or]||[])[pr]:i[_e])||{}).F}else x.f=""+un(V.formula,s,V.cell,X,b)}L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U(V.cell,x,t),o=V}break;case 7:case 519:if(o)o.val=V,x=Bf(V,o.cell.ixfe,"s"),x.XF=N[x.ixfe],t.cellFormula&&(x.f=""+un(o.formula,s,o.cell,X,b)),L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(V);var me=st(V[0].s);if(v=t.dense?(i[V[0].s.r]||[])[V[0].s.c]:i[me],t.cellFormula&&v){if(!o||!me||!v)break;v.f=""+un(V[1],s,V[0],X,b),v.F=Ct(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;E[st(o.cell)]=V[0],v=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[st(o.cell)],(v||{}).f=""+un(V[0],s,p,X,b)}}break;case 253:x=Bf(u[V.isst].t,V.ixfe,"s"),u[V.isst].h&&(x.h=u[V.isst].h),x.XF=N[x.ixfe],L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:V.ixfe,XF:N[V.ixfe],t:"z"},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t));break;case 190:if(t.sheetStubs)for(var Se=V.c;Se<=V.C;++Se){var we=V.ixfe[Se-V.c];x={ixfe:we,XF:N[we],t:"z"},L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:Se,r:V.r},x,t)}break;case 214:case 516:case 4:x=Bf(V.val,V.ixfe,"s"),x.XF=N[x.ixfe],L>0&&(x.z=q[x.ixfe>>8&63]),sa(x,t,r.opts.Date1904),U({c:V.c,r:V.r},x,t);break;case 0:case 512:Ce===1&&(s=V);break;case 252:u=V;break;case 1054:if(b.biff==4){q[L++]=V[1];for(var Ee=0;Ee<L+163&&ct[Ee]!=V[1];++Ee);Ee>=163&&vo(V[1],L+163)}else vo(V[1],V[0]);break;case 30:{q[L++]=V;for(var Pe=0;Pe<L+163&&ct[Pe]!=V;++Pe);Pe>=163&&vo(V,L+163)}break;case 229:he=he.concat(V);break;case 93:te[V.cmo[0]]=b.lastobj=V;break;case 438:b.lastobj.TxO=V;break;case 127:b.lastobj.ImData=V;break;case 440:for(k=V[0].s.r;k<=V[0].e.r;++k)for(_=V[0].s.c;_<=V[0].e.c;++_)v=t.dense?(i[k]||[])[_]:i[st({c:_,r:k})],v&&(v.l=V[1]);break;case 2048:for(k=V[0].s.r;k<=V[0].e.r;++k)for(_=V[0].s.c;_<=V[0].e.c;++_)v=t.dense?(i[k]||[])[_]:i[st({c:_,r:k})],v&&v.l&&(v.l.Tooltip=V[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;v=t.dense?(i[V[0].r]||[])[V[0].c]:i[st(V[0])];var Me=te[V[2]];v||(t.dense?(i[V[0].r]||(i[V[0].r]=[]),v=i[V[0].r][V[0].c]={t:"z"}):v=i[st(V[0])]={t:"z"},s.e.r=Math.max(s.e.r,V[0].r),s.s.r=Math.min(s.s.r,V[0].r),s.e.c=Math.max(s.e.c,V[0].c),s.s.c=Math.min(s.s.c,V[0].c)),v.c||(v.c=[]),g={a:V[1],t:Me.TxO.t},v.c.push(g)}break;case 2173:YP(N[V.ixfe],V.ext);break;case 125:{if(!b.cellStyles)break;for(;V.e>=V.s;)Ae[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},ie||(ie=!0,rx(V.w/256)),Yl(Ae[V.e+1])}break;case 520:{var pe={};V.level!=null&&(Te[V.r]=pe,pe.level=V.level),V.hidden&&(Te[V.r]=pe,pe.hidden=!0),V.hpt&&(Te[V.r]=pe,pe.hpt=V.hpt,pe.hpx=q0(V.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||k0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=V;break;case 161:i["!margins"]||k0(i["!margins"]={}),i["!margins"].header=V.header,i["!margins"].footer=V.footer;break;case 574:V.RTL&&(F.Views[0].RTL=!0);break;case 146:T=V;break;case 2198:Q=V;break;case 140:C=V;break;case 442:f?P.CodeName=V||P.name:F.WBProps.CodeName=V||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=ue}return r.SheetNames=pa(a).sort(function(re,xe){return Number(re)-Number(xe)}).map(function(re){return a[re].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Y.forEach(function(re,xe){r.Sheets[r.SheetNames[xe]]["!autofilter"]=re}),r.Strings=u,r.SSF=Qr(ct),b.enc&&(r.Encryption=b.enc),Q&&(r.Themes=Q),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),X.names.length>0&&(F.Names=X.names),r.Workbook=F,r}var k3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PI(e,t,r){var n=Et.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=s3(n,W7,k3.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var s=Et.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=s3(s,$7,k3.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(b8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vS(e,t){t||(t={}),ox(t),$6(),t.codepage&&U2(t.codepage);var r,n;if(e.FullPaths){if(Et.find(e,"/encryption"))throw new Error("File is password-protected");r=Et.find(e,"!CompObj"),n=Et.find(e,"/Workbook")||Et.find(e,"/Book")}else{switch(t.type){case"base64":e=zi(ri(e));break;case"binary":e=zi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Kr(e,0),n={content:e}}var i,a;if(r&&EI(r),t.bookProps&&!t.bookSheets)i={};else{var s=_t?"buffer":"array";if(n&&n.content)i=AI(n.content,t);else if((a=Et.find(e,"PerfectOffice_MAIN"))&&a.content)i=S0.to_workbook(a.content,(t.type=s,t));else if((a=Et.find(e,"NativeContent_MAIN"))&&a.content)i=S0.to_workbook(a.content,(t.type=s,t));else throw(a=Et.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=hF(e))}var o={};return e.FullPaths&&PI(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var zd={0:{f:cR},1:{f:hR},2:{f:wR},3:{f:xR},4:{f:gR},5:{f:SR},6:{f:CR},7:{f:yR},8:{f:NR},9:{f:FR},10:{f:AR},11:{f:PR},12:{f:pR},13:{f:kR},14:{f:vR},15:{f:mR},16:{f:hS},17:{f:TR},18:{f:_R},19:{f:Q2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nI},40:{},42:{},43:{f:AP},44:{f:TP},45:{f:PP},46:{f:NP},47:{f:FP},48:{},49:{f:R7},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:X8},62:{f:ER},63:{f:rF},64:{f:UR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dR},148:{f:uR,p:16},151:{f:DR},152:{},153:{f:tI},154:{},155:{},156:{f:eI},157:{},158:{},159:{T:1,f:$A},160:{T:-1},161:{T:1,f:Oo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:QP},336:{T:-1},337:{f:JP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OR},427:{f:bR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uF},633:{T:1},634:{T:-1},635:{T:1,f:cF},636:{T:-1},637:{f:D7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Tm={6:{f:rg},10:{f:ls},12:{f:yr},13:{f:yr},14:{f:fr},15:{f:fr},16:{f:dn},17:{f:fr},18:{f:fr},19:{f:yr},20:{f:u3},21:{f:u3},23:{f:$8},24:{f:d3},25:{f:fr},26:{},27:{},28:{f:oA},29:{},34:{f:fr},35:{f:f3},38:{f:dn},39:{f:dn},40:{f:dn},41:{f:dn},42:{f:fr},43:{f:fr},47:{f:fP},49:{f:VT},51:{f:yr},60:{},61:{f:UT},64:{f:fr},65:{f:zT},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:RT},93:{f:cA},94:{},95:{f:fr},96:{},97:{},99:{f:fr},125:{f:X8},128:{f:JT},129:{f:IT},130:{f:yr},131:{f:fr},132:{f:fr},133:{f:DT},134:{},140:{f:gA},141:{f:yr},144:{},146:{f:xA},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:wA},161:{f:yA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KT},190:{f:YT},193:{f:ls},197:{},198:{},199:{},200:{},201:{},202:{f:fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:fr},222:{},224:{f:qT},225:{f:NT},226:{f:ls},227:{},229:{f:lA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:OT},253:{f:GT},255:{f:bT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:j8},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fr},353:{f:ls},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eA},431:{f:fr},432:{},433:{},434:{},437:{},438:{f:dA},439:{f:fr},440:{f:hA},441:{},442:{f:uu},443:{},444:{f:yr},445:{},446:{},448:{f:ls},449:{f:BT,r:2},450:{f:ls},512:{f:l3},513:{f:SA},515:{f:ZT},516:{f:HT},517:{f:c3},519:{f:kA},520:{f:LT},523:{},545:{f:h3},549:{f:o3},566:{},574:{f:jT},638:{f:XT},659:{},1048:{},1054:{f:WT},1084:{},1212:{f:iA},2048:{f:pA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ls},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vA,r:12},2173:{f:KP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nA,r:12},2197:{},2198:{f:VP,r:12},2199:{},2200:{},2201:{},2202:{f:aA,r:12},2203:{f:ls},2204:{},2205:{},2206:{},2207:{},2211:{f:MT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_A},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:l3},1:{},2:{f:AA},3:{f:TA},4:{f:CA},5:{f:c3},7:{f:PA},8:{},9:{f:bf},11:{},22:{f:yr},30:{f:$T},31:{},32:{},33:{f:h3},36:{},37:{f:o3},50:{f:FA},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:EA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:NA},223:{},234:{},354:{},421:{},518:{f:rg},521:{f:bf},536:{f:d3},547:{f:f3},561:{},579:{},1030:{f:rg},1033:{f:bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Li(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&A8(r)&&e.push(r)}}function E3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,u=e7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,m=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<u.length;++s){var _=u[s].trim(),k=_.slice(0,3).toLowerCase();if(k=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(k!="<td"&&k!="<th")){var E=_.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var S=E[o].trim();if(S.match(/<t[dh]/i)){for(var x=S,C=0;x.charAt(0)=="<"&&(C=x.indexOf(">"))>-1;)x=x.slice(C+1);for(var N=0;N<g.length;++N){var T=g[N];T.s.c==d&&T.s.r<f&&f<=T.e.r&&(d=T.e.c+1,N=-1)}var F=tt(S.slice(0,S.indexOf(">")));m=F.colspan?+F.colspan:1,((p=+F.rowspan)>1||m>1)&&g.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+m-1}});var P=F.t||F["data-t"]||"";if(!x.length){d+=m;continue}if(x=p8(x),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!x.length){d+=m;continue}var I={t:"s",v:x};r.raw||!x.trim().length||P=="s"||(x==="TRUE"?I={t:"b",v:!0}:x==="FALSE"?I={t:"b",v:!1}:isNaN(Xi(x))?isNaN(Kl(x).getDate())||(I={t:"d",v:Hr(x)},r.cellDates||(I={t:"n",v:Fn(I.v)}),I.z=r.dateNF||ct[14]):I={t:"n",v:Xi(x)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=I):n[st({r:f,c:d})]=I,d+=m}}}}return n["!ref"]=Ct(v),g.length&&(n["!merges"]=g),n}function FI(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){o=-1;break}o=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var d=st({r,c:s}),p=n.dense?(e[r]||[])[s]:e[d],m=p&&p.v!=null&&(p.h||W2(p.w||(Wa(p),p.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(g7("td",m,v))}}var g="<tr>";return g+a.join("")+"</tr>"}var NI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RI="</body></html>";function II(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Us(E3(r[0],t),t);var n=cx();return r.forEach(function(i,a){ux(n,E3(i,t),"Sheet"+(a+1))}),n}function DI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function OI(e,t){var r=t||{},n=r.header!=null?r.header:NI,i=r.footer!=null?r.footer:RI,a=[n],s=ic(e["!ref"]);r.dense=Array.isArray(e),a.push(DI(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(FI(e,s,o,r));return a.push("</table>"+i),a.join("")}function yS(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Tn(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=ic(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var p=[],m=0,v=e["!rows"]||(e["!rows"]=[]),g=0,_=0,k=0,E=0,S=0,x=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&_<u;++g){var C=o[g];if(C3(C)){if(n.display)continue;v[_]={hidden:!0}}var N=C.children;for(k=E=0;k<N.length;++k){var T=N[k];if(!(n.display&&C3(T))){var F=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):p8(T.innerHTML),P=T.getAttribute("data-z")||T.getAttribute("z");for(m=0;m<p.length;++m){var I=p[m];I.s.c==E+a&&I.s.r<_+i&&_+i<=I.e.r&&(E=I.e.c+1-a,m=-1)}x=+T.getAttribute("colspan")||1,((S=+T.getAttribute("rowspan")||1)>1||x>1)&&p.push({s:{r:_+i,c:E+a},e:{r:_+i+(S||1)-1,c:E+a+(x||1)-1}});var D={t:"s",v:F},U=T.getAttribute("data-t")||T.getAttribute("t")||"";F!=null&&(F.length==0?D.t=U||"z":n.raw||F.trim().length==0||U=="s"||(F==="TRUE"?D={t:"b",v:!0}:F==="FALSE"?D={t:"b",v:!1}:isNaN(Xi(F))?isNaN(Kl(F).getDate())||(D={t:"d",v:Hr(F)},n.cellDates||(D={t:"n",v:Fn(D.v)}),D.z=n.dateNF||ct[14]):D={t:"n",v:Xi(F)})),D.z===void 0&&P!=null&&(D.z=P);var b="",Q=T.getElementsByTagName("A");if(Q&&Q.length)for(var he=0;he<Q.length&&!(Q[he].hasAttribute("href")&&(b=Q[he].getAttribute("href"),b.charAt(0)!="#"));++he);b&&b.charAt(0)!="#"&&(D.l={Target:b}),n.dense?(e[_+i]||(e[_+i]=[]),e[_+i][E+a]=D):e[st({c:E+a,r:_+i})]=D,f.e.c<E+a&&(f.e.c=E+a),E+=x}}++_}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,_-1+i),e["!ref"]=Ct(f),_>=u&&(e["!fullref"]=Ct((f.e.r=o.length-g+_-1+i,f))),e}function _S(e,t){var r=t||{},n=r.dense?[]:{};return yS(n,e,t)}function bI(e,t){return Us(_S(e,t),t)}function C3(e){var t="",r=LI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function LI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=At(t.replace(/<[^>]*>/g,""));return[r]}var T3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function SS(e,t){var r=t||{},n=$2(e),i=[],a,s,o={name:""},u="",f=0,d,p,m={},v=[],g=r.dense?[]:{},_,k,E={value:""},S="",x=0,C=[],N=-1,T=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,I={},D=[],U={},b=0,Q=0,he=[],te=1,Ae=1,Te=[],ie={Names:[]},X={},ce=["",""],Ce=[],L={},q="",Y=0,K=!1,de=!1,G=0;for(K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=K0.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?g["!ref"]=Ct(F):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(g["!fullref"]=g["!ref"],F.e.r=r.sheetRows-1,g["!ref"]=Ct(F)),D.length&&(g["!merges"]=D),he.length&&(g["!rows"]=he),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),m[d.name]=g,de=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=tt(_[0],!1),N=T=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,g=r.dense?[]:{},D=[],he=[],de=!0);break;case"table-row-group":_[1]==="/"?--P:++P;break;case"table-row":case"":if(_[1]==="/"){N+=te,te=1;break}if(p=tt(_[0],!1),p.?N=p.-1:N==-1&&(N=0),te=+p["number-rows-repeated"]||1,te<10)for(G=0;G<te;++G)P>0&&(he[N+G]={level:P});T=-1;break;case"covered-table-cell":_[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(g[N]||(g[N]=[]),g[N][T]={t:"z"}):g[st({r:N,c:T})]={t:"z"}),S="",C=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++T,E=tt(_[0],!1),Ae=parseInt(E["number-columns-repeated"]||"1",10),k={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(k.f=_3(At(E.formula))),(E.||E["value-type"])=="string"&&(k.t="s",k.v=At(E["string-value"]||""),r.dense?(g[N]||(g[N]=[]),g[N][T]=k):g[st({r:N,c:T})]=k),T+=Ae-1;else if(_[1]!=="/"){++T,S="",x=0,C=[],Ae=1;var J=te?N+te-1:N;if(T>F.e.c&&(F.e.c=T),T<F.s.c&&(F.s.c=T),N<F.s.r&&(F.s.r=N),J>F.e.r&&(F.e.r=J),E=tt(_[0],!1),Ce=[],L={},k={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=At(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(b=parseInt(E["number-matrix-rows-spanned"],10)||0,Q=parseInt(E["number-matrix-columns-spanned"],10)||0,U={s:{r:N,c:T},e:{r:N+b-1,c:T+Q-1}},k.F=Ct(U),Te.push([U,k.F])),E.formula)k.f=_3(E.formula);else for(G=0;G<Te.length;++G)N>=Te[G][0].s.r&&N<=Te[G][0].e.r&&T>=Te[G][0].s.c&&T<=Te[G][0].e.c&&(k.F=Te[G][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(b=parseInt(E["number-rows-spanned"],10)||0,Q=parseInt(E["number-columns-spanned"],10)||0,U={s:{r:N,c:T},e:{r:N+b-1,c:T+Q-1}},D.push(U)),E["number-columns-repeated"]&&(Ae=parseInt(E["number-columns-repeated"],10)),k.t){case"boolean":k.t="b",k.v=Qt(E["boolean-value"]);break;case"float":k.t="n",k.v=parseFloat(E.value);break;case"percentage":k.t="n",k.v=parseFloat(E.value);break;case"currency":k.t="n",k.v=parseFloat(E.value);break;case"date":k.t="d",k.v=Hr(E["date-value"]),r.cellDates||(k.t="n",k.v=Fn(k.v)),k.z="m/d/yy";break;case"time":k.t="n",k.v=qC(E["time-value"])/86400,r.cellDates&&(k.t="d",k.v=gh(k.v)),k.z="HH:MM:SS";break;case"number":k.t="n",k.v=parseFloat(E.);break;default:if(k.t==="string"||k.t==="text"||!k.t)k.t="s",E["string-value"]!=null&&(S=At(E["string-value"]),C=[]);else throw new Error("Unsupported value type "+k.t)}}else{if(K=!1,k.t==="s"&&(k.v=S||"",C.length&&(k.R=C),K=x==0),X.Target&&(k.l=X),Ce.length>0&&(k.c=Ce,Ce=[]),S&&r.cellText!==!1&&(k.w=S),K&&(k.t="z",delete k.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ue=0;ue<te;++ue){if(Ae=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(g[N+ue]||(g[N+ue]=[]),g[N+ue][T]=ue==0?k:Qr(k);--Ae>0;)g[N+ue][T+Ae]=Qr(k);else for(g[st({r:N+ue,c:T})]=k;--Ae>0;)g[st({r:N+ue,c:T+Ae})]=Qr(k);F.e.c<=T&&(F.e.c=T)}Ae=parseInt(E["number-columns-repeated"]||"1",10),T+=Ae-1,Ae=0,k={},S="",C=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a;L.t=S,C.length&&(L.R=C),L.a=q,Ce.push(L)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);q="",Y=0,S="",x=0,C=[];break;case"creator":_[1]==="/"?q=n.slice(Y,_.index):Y=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);S="",x=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(I[o.name]=u,(a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(u="",o=tt(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(_[0],!1),u+=T3[_[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(_[0],!1),u+=T3[_[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,_.index);break}else f=_.index+_[0].length;break;case"named-range":s=tt(_[0],!1),ce=ng(s["cell-range-address"]);var ve={Name:s.name,Ref:ce[0]+"!"+ce[1]};de&&(ve.Sheet=v.length),ie.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!E||!E["string-value"])){var Be=MI(n.slice(x,_.index));S=(S.length>0?S+`
`:"")+Be[0]}else tt(_[0],!1),x=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ce=ng(tt(_[0])["target-range-address"]),m[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(X=tt(_[0],!1),!X.href)break;X.Target=At(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(ce=ng(X.Target.slice(1)),X.Target="#"+ce[0]+"!"+ce[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var V={Sheets:m,SheetNames:v,Workbook:ie};return r.bookSheets&&delete V.Sheets,V}function A3(e,t){t=t||{},xi(e,"META-INF/manifest.xml")&&Z7(vr(e,"META-INF/manifest.xml"),t);var r=qn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=SS(Ht(r),t);return xi(e,"meta.xml")&&(n.Props=O8(vr(e,"meta.xml"))),n}function P3(e,t){return SS(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ax(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Am(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ht(Io(e))}function Pm(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function F3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function BI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function J0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Rr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function hn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=J0(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=J0(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function sx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function UI(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=J0(e,n),a=hn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:Rr(a[1][0].data),messages:[]};a[2].forEach(function(o){var u=hn(o.data),f=Rr(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(s.merge=Rr(a[3][0].data)>>>0>0),r.push(s)}return r}function jI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=J0(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Pm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Pm(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function zI(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Pm(t)}function VI(e,t,r,n){var i=ax(e),a=i.getUint32(4,!0),s=(n>1?12:8)+F3(a&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=F3(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(s,!0),s+=4),a&32&&(f=i.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function GI(e,t,r){var n=ax(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=BI(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function HI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return VI(e,t,r,e[0]);case 5:return GI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fs(e){var t=hn(e);return J0(t[1][0].data)}function N3(e,t){var r=hn(t.data),n=Rr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=hn(s.data),u=Rr(o[1][0].data)>>>0;switch(n){case 1:a[u]=Am(o[3][0].data);break;case 8:{var f=e[Fs(o[9][0].data)][0],d=hn(f.data),p=e[Fs(d[1][0].data)][0],m=Rr(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var v=hn(p.data);a[u]=v[3].map(function(g){return Am(g.data)}).join("")}break}}),a}function WI(e,t){var r,n,i,a,s,o,u,f,d,p,m,v,g,_,k=hn(e),E=Rr(k[1][0].data)>>>0,S=Rr(k[2][0].data)>>>0,x=((n=(r=k[8])==null?void 0:r[0])==null?void 0:n.data)&&Rr(k[8][0].data)>0||!1,C,N;if((a=(i=k[7])==null?void 0:i[0])!=null&&a.data&&t!=0)C=(o=(s=k[7])==null?void 0:s[0])==null?void 0:o.data,N=(f=(u=k[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=k[4])==null?void 0:d[0])!=null&&p.data&&t!=1)C=(v=(m=k[4])==null?void 0:m[0])==null?void 0:v.data,N=(_=(g=k[3])==null?void 0:g[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=x?4:1,F=ax(C),P=[],I=0;I<C.length/2;++I){var D=F.getUint16(I*2,!0);D<65535&&P.push([I,D])}if(P.length!=S)throw"Expected ".concat(S," cells, found ").concat(P.length);var U=[];for(I=0;I<P.length-1;++I)U[P[I][0]]=N.subarray(P[I][1]*T,P[I+1][1]*T);return P.length>=1&&(U[P[P.length-1][0]]=N.subarray(P[P.length-1][1]*T)),{R:E,cells:U}}function $I(e,t){var r,n=hn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Rr(n[7][0].data)>>>0>0?1:0:-1,a=sx(n[5],function(s){return WI(s,i)});return{nrows:Rr(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(u,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=u}),s},[])}}function XI(e,t,r){var n,i=hn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Rr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Rr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ct(a);var s=hn(i[4][0].data),o=N3(e,e[Fs(s[4][0].data)][0]),u=(n=s[17])!=null&&n[0]?N3(e,e[Fs(s[17][0].data)][0]):[],f=hn(s[3][0].data),d=0;f[1].forEach(function(p){var m=hn(p.data),v=e[Fs(m[2][0].data)][0],g=Rr(v.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var _=$I(e,v);_.data.forEach(function(k,E){k.forEach(function(S,x){var C=st({r:d+E,c:x}),N=HI(S,o,u);N&&(r[C]=N)})}),d+=_.nrows})}function KI(e,t){var r=hn(t.data),n={"!ref":"A1"},i=e[Fs(r[2][0].data)],a=Rr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return XI(e,i[0],n),n}function YI(e,t){var r,n=hn(t.data),i={name:(r=n[1])!=null&&r[0]?Am(n[1][0].data):"",sheets:[]},a=sx(n[2],Fs);return a.forEach(function(s){e[s].forEach(function(o){var u=Rr(o.meta[1][0].data);u==6e3&&i.sheets.push(KI(e,o))})}),i}function QI(e,t){var r=cx(),n=hn(t.data),i=sx(n[1],Fs);if(i.forEach(function(a){e[a].forEach(function(s){var o=Rr(s.meta[1][0].data);if(o==2){var u=YI(e,s);u.sheets.forEach(function(f,d){ux(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ag(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=zI(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=UI(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){a[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Rr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(u){a[u].forEach(function(f){var d=Rr(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return QI(a,o)}function qI(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ox(e){qI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function JI(e){return Al.WS.indexOf(e)>-1?"sheet":e==Al.CS?"chart":e==Al.DS?"dialog":e==Al.MS?"macro":e&&e.length?e:"sheet"}function ZI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,JI(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eD(e,t,r,n,i,a,s,o,u,f,d,p){try{a[n]=y0(qn(e,r,!0),t);var m=vr(e,t),v;switch(o){case"sheet":v=sI(m,t,i,u,a[n],f,d,p);break;case"chart":if(v=oI(m,t,i,u,a[n],f,d,p),!v||!v["!drawel"])break;var g=n0(v["!drawel"].Target,t),_=wm(g),k=aF(qn(e,g,!0),y0(qn(e,_,!0),g)),E=n0(k,g),S=wm(E);v=GR(qn(e,E,!0),E,u,y0(qn(e,S,!0),E),f,v);break;case"macro":v=lI(m,t,i,u,a[n],f,d,p);break;case"dialog":v=cI(m,t,i,u,a[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var x=[];a&&a[n]&&pa(a[n]).forEach(function(C){var N="";if(a[n][C].Type==Al.CMNT){N=n0(a[n][C].Target,t);var T=hI(vr(e,N,!0),N,u);if(!T||!T.length)return;g3(v,T,!1)}a[n][C].Type==Al.TCMNT&&(N=n0(a[n][C].Target,t),x=x.concat(oF(vr(e,N,!0),u)))}),x&&x.length&&g3(v,x,!0,u.people||[])}catch(C){if(u.WTF)throw C}}function pi(e){return e.charAt(0)=="/"?e.slice(1):e}function tD(e,t){if(i8(),t=t||{},ox(t),xi(e,"META-INF/manifest.xml")||xi(e,"objectdata.xml"))return A3(e,t);if(xi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ag<"u"){if(e.FileIndex)return ag(e);var r=Et.utils.cfb_new();return Vy(e).forEach(function(he){r7(r,he,u8(e,he))}),ag(r)}throw new Error("Unsupported NUMBERS file")}if(!xi(e,"[Content_Types].xml"))throw xi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vy(e),i=q7(qn(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",vr(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!vr(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(w0=[],i.sst)try{w0=dI(vr(e,pi(i.sst)),i.sst,t)}catch(he){if(t.WTF)throw he}t.cellStyles&&i.themes.length&&(u=fI(qn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=uI(vr(e,pi(i.style)),i.style,u,t))}i.links.map(function(he){try{var te=y0(qn(e,wm(pi(he))),he);return gI(vr(e,pi(he)),te,he,t)}catch{}});var d=aI(vr(e,pi(i.workbooks[0])),i.workbooks[0],t),p={},m="";i.coreprops.length&&(m=vr(e,pi(i.coreprops[0]),!0),m&&(p=O8(m)),i.extprops.length!==0&&(m=vr(e,pi(i.extprops[0]),!0),m&&rT(m,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=qn(e,pi(i.custprops[0]),!0),m&&(v=iT(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(te){return te.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(g.Props=p,g.Custprops=v),t.bookSheets&&typeof s<"u"&&(g.SheetNames=s),t.bookSheets?g.SheetNames:t.bookProps))return g;s={};var _={};t.bookDeps&&i.calcchain&&(_=pI(vr(e,pi(i.calcchain)),i.calcchain));var k=0,E={},S,x;{var C=d.Sheets;p.Worksheets=C.length,p.SheetNames=[];for(var N=0;N!=C.length;++N)p.SheetNames[N]=C[N].name}var T=a?"bin":"xml",F=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,F+1)+"_rels/"+i.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");xi(e,P)||(P="xl/_rels/workbook."+T+".rels");var I=y0(qn(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mI(vr(e,pi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=lF(vr(e,pi(i.people[0])),t)),I&&(I=ZI(I,d.Sheets));var D=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(k=0;k!=p.Worksheets;++k){var U="sheet";if(I&&I[k]?(S="xl/"+I[k][1].replace(/[\/]?xl\//,""),xi(e,S)||(S=I[k][1]),xi(e,S)||(S=P.replace(/_rels\/.*$/,"")+I[k][1]),U=I[k][2]):(S="xl/worksheets/sheet"+(k+1-D)+"."+T,S=S.replace(/sheet0\./,"sheet.")),x=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(k!=t.sheets)continue e;break;case"string":if(p.SheetNames[k].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==k&&(b=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==p.SheetNames[k].toLowerCase()&&(b=1);if(!b)continue e}}eD(e,S,x,p.SheetNames[k],k,E,s,U,t,d,u,f)}return g={Directory:i,Workbook:d,Props:p,Custprops:v,Deps:_,Sheets:s,SheetNames:p.SheetNames,Strings:w0,Styles:f,Themes:u,SSF:Qr(ct)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(he,te){he=he.replace(/^Root Entry[\/]/,""),g.keys.push(he),g.files[he]=e.FileIndex[te]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=vr(e,pi(i.vba[0]),!0):i.defaults&&i.defaults.bin===dF&&(g.vbaraw=vr(e,"xl/vbaProject.bin",!0))),g}function rD(e,t){var r=t||{},n="Workbook",i=Et.find(e,n);try{if(n="/!DataSpaces/Version",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KA(i.content),n="/!DataSpaces/DataSpaceMap",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=QA(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qA(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ZA(i.content)}catch{}if(n="/EncryptionInfo",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=eP(i.content);if(n="/EncryptedPackage",i=Et.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function lx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ri(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nD(e,t){return Et.find(e,"EncryptedPackage")?rD(e,t):vS(e,t)}function iD(e,t){var r,n=e,i=t||{};return i.type||(i.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=f8(n,i),tD(r,i)}function wS(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cm(e.slice(r),t);default:break e}return Y0.to_workbook(e,t)}function aD(e,t){var r="",n=lx(e,t);switch(t.type){case"base64":r=ri(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ao(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ht(r)),t.type="binary",wS(r,t)}function sD(e,t){var r=e;return t.type=="base64"&&(r=ri(r)),r=gs.utils.decode(1200,r.slice(2),"str"),t.type="binary",wS(r,t)}function oD(e){return e.match(/[^\x00-\x7F]/)?i0(e):e}function sg(e,t,r,n){return n?(r.type="string",Y0.to_workbook(e,r)):Y0.to_workbook(t,r)}function Fm(e,t){$6();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fm(new Uint8Array(e),(r=Qr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ll={},r.dateNF&&(Ll.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=YC(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=oD(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Qr(r),r.type="array",Fm(j2(n),r)}switch((i=lx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return nD(Et.read(n,r),r);break;case 9:if(i[1]<=8)return vS(n,r);break;case 60:return Cm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return bA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?iD(n,r):sg(e,n,r,a);case 239:return i[3]===60?Cm(n,r):sg(e,n,r,a);case 255:if(i[1]===254)return sD(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return S0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return S0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return p3.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return dP.to_workbook(n,r);break;case 10:case 13:case 32:return aD(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return RA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?p3.to_workbook(n,r):sg(e,n,r,a)}function lD(e,t,r,n,i,a,s,o){var u=qr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var g=s?e[r][v]:e[n[v]+u];if(g===void 0||g.t===void 0){if(f===void 0)continue;a[v]!=null&&(m[a[v]]=f);continue}var _=g.v;switch(g.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[v]!=null){if(_==null)if(g.t=="e"&&_===null)m[a[v]]=null;else if(f!==void 0)m[a[v]]=f;else if(d&&_===null)m[a[v]]=null;else continue;else m[a[v]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?_:Wa(g,_,o);_!=null&&(p=!1)}}return{row:m,isempty:p}}function Nm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=lr(d);break;case"number":u=lr(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var p=qr(u.s.r),m=[],v=[],g=0,_=0,k=Array.isArray(e),E=u.s.r,S=0,x={};k&&!e[E]&&(e[E]=[]);var C=f.skipHidden&&e["!cols"]||[],N=f.skipHidden&&e["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(C[S]||{}).hidden)switch(m[S]=Nr(S),r=k?e[E][S]:e[m[S]+p],n){case 1:a[S]=S-u.s.c;break;case 2:a[S]=m[S];break;case 3:a[S]=f.header[S-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Wa(r,null,f),_=x[s]||0,!_)x[s]=1;else{do o=s+"_"+_++;while(x[o]);x[s]=_,x[o]=1}a[S]=o}for(E=u.s.r+i;E<=u.e.r;++E)if(!(N[E]||{}).hidden){var T=lD(e,u,E,m,n,a,k,f);(T.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[g++]=T.row)}return v.length=g,v}var R3=/"/g;function cD(e,t,r,n,i,a,s,o){for(var u=!0,f=[],d="",p=qr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=o.dense?(e[r]||[])[m]:e[n[m]+p];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:Wa(v,null,o));for(var g=0,_=0;g!==d.length;++g)if((_=d.charCodeAt(g))===i||_===a||_===34||o.forceQuotes){d='"'+d.replace(R3,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(R3,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(s)}function kS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=lr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(p[g]=Nr(g));for(var _=0,k=i.s.r;k<=i.e.r;++k)(v[k]||{}).hidden||(d=cD(e,i,k,p,s,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((_++?o:"")+d)));return delete n.dense,r.join("")}function uD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kS(e,t);return r}function fD(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=lr(e["!ref"]),a="",s=[],o,u=[],f=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Nr(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=qr(d),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function ES(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Tn(n.origin):n.origin;s=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var p=lr(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),s==-1&&(s=p.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var m=n.header||[],v=0;t.forEach(function(_,k){pa(_).forEach(function(E){(v=m.indexOf(E))==-1&&(m[v=m.length]=E);var S=_[E],x="z",C="",N=st({c:o+v,r:s+k+i});f=Z0(a,N),S&&typeof S=="object"&&!(S instanceof Date)?a[N]=S:(typeof S=="number"?x="n":typeof S=="boolean"?x="b":typeof S=="string"?x="s":S instanceof Date?(x="d",n.cellDates||(x="n",S=Fn(S)),C=n.dateNF||ct[14]):S===null&&n.nullError&&(x="e",S=0),f?(f.t=x,f.v=S,delete f.w,delete f.R,C&&(f.z=C)):a[N]=f={t:x,v:S},C&&(f.z=C))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var g=qr(s);if(i)for(v=0;v<m.length;++v)a[Nr(v+o)+g]={t:"s",v:m[v]};return a["!ref"]=Ct(d),a}function dD(e,t){return ES(null,e,t)}function Z0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Z0(e,st(t)):Z0(e,st({r:t,c:r||0}))}function hD(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function cx(){return{SheetNames:[],Sheets:{}}}function ux(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(qR(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function pD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hD(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function gD(e,t){return e.z=t,e}function CS(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mD(e,t,r){return CS(e,"#"+t,r)}function xD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vD(e,t,r,n){for(var i=typeof t!="string"?t:lr(t),a=typeof t=="string"?t:Ct(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var u=Z0(e,s,o);u.t="n",u.F=a,delete u.v,s==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var og={encode_col:Nr,encode_row:qr,encode_cell:st,encode_range:Ct,decode_col:Y2,decode_row:K2,split_cell:N7,decode_cell:Tn,decode_range:ic,format_cell:Wa,sheet_add_aoa:F8,sheet_add_json:ES,sheet_add_dom:yS,aoa_to_sheet:ac,json_to_sheet:dD,table_to_sheet:_S,table_to_book:bI,sheet_to_csv:kS,sheet_to_txt:uD,sheet_to_json:Nm,sheet_to_html:OI,sheet_to_formulae:fD,sheet_to_row_object_array:Nm,sheet_get_cell:Z0,book_new:cx,book_append_sheet:ux,book_set_sheet_visibility:pD,cell_set_number_format:gD,cell_set_hyperlink:CS,cell_set_internal_link:mD,cell_add_comment:xD,sheet_set_array_formula:vD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fx=class Rm{static async parseCSVFile(t){var r;try{const n=(r=t.name.split(".").pop())==null?void 0:r.toLowerCase();let i;return n==="xlsx"||n==="xls"?i=await this.readXLSXFileContent(t):i=await this.readFileContent(t),this.parseCSVContent(i)}catch(n){return{success:!1,pins:[],warnings:[],errors:[n.message],format:this.getDefaultFormat()}}}static async parseCSVContent(t){console.log(" Starting ultra-fast CSV parsing...");const r=this.tryVersalPatternMatching(t);if(r!==null)return await r;console.log(" About to try Intel/Altera pattern matching...");const n=this.tryIntelAlteraPatternMatching(t);return n!==null?(console.log(" Intel/Altera pattern detected, processing..."),await n):(console.log(" Versal and Intel/Altera patterns not found, using generic approach..."),this.parseCSVContentGeneric(t))}static async parseCSVContentGeneric(t){console.log(" Fallback to generic CSV processing...");const r=t.split(`
`).map(v=>v.trim()).filter(Boolean);console.log(` Processing ${r.length} lines with generic approach`);let n=-1,i=-1;for(let v=0;v<Math.min(1e3,r.length);v++){const g=r[v];if(!g||!g.includes(","))continue;const _=g.toLowerCase();if(_.includes("copyright")||_.includes("license")||_.includes("xilinx")||g.startsWith("#"))continue;const k=this.parseCSVLine(g);if(k.length>=3&&k.some(S=>{const x=S.toLowerCase().trim();return x==="pin"||x==="ball"||x.includes("pin")})){n=v,i=v+1;break}}if(n===-1)return{success:!1,pins:[],warnings:[],errors:["Pin column not found or empty"],format:this.getDefaultFormat()};const a=r[n];console.log(` Found header at line ${n+1}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,m=0;for(let v=i;v<r.length;v++){const g=r[v];if(!g||g.replace(/,/g,"").trim()==="")continue;const _=this.parseCSVLine(g);try{const k=this.parsePin(_,o,v+1);k&&(u.push(k),m++)}catch(k){d.length<20&&d.push(`Line ${v+1}: ${k.message}`)}p++,p%1e3===0&&console.log(` Generic processing: ${p} lines, ${m} pins`)}return console.log(` Generic processing complete: ${m} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static tryVersalPatternMatching(t){console.log(" Trying ultra-fast Versal pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(7e3,r.length);a++){const s=r[a];if(a%1e3===0&&console.log(` Pattern matching line ${a+1}...`),s&&s.toLowerCase().startsWith("pin,pin name,")){n=a,i=a+1,console.log(` Found Versal header at line ${a+1}: ${s.substring(0,100)}`);break}if(s&&s.toLowerCase().startsWith("pin,")&&s.toLowerCase().includes("pin name")&&s.split(",").length>=3){n=a,i=a+1,console.log(` Found Versal header variant at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Versal pattern not found"),null):this.parseCSVWithKnownHeader(r,n,i)}static tryIntelAlteraPatternMatching(t){console.log(" Trying Intel/Altera pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(20,r.length);a++){const s=r[a];if(s&&s.toLowerCase().includes("pin name/function")){n=a,i=a+1,console.log(` Found Intel/Altera header at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Intel/Altera pattern not found"),null):this.parseIntelAlteraCSV(r,n,i)}static async parseIntelAlteraCSV(t,r,n){var f,d,p,m,v,g,_,k,E;console.log(" Processing Intel/Altera CSV format...");const i=[],a=[],s=[];let o=0,u=0;for(let S=n;S<t.length;S++){const x=t[S];if(!x||x.replace(/,/g,"").trim()==="")continue;const C=this.parseCSVLine(x);if(C.length>=6){const N=(f=C[0])==null?void 0:f.trim(),T=(d=C[1])==null?void 0:d.trim(),F=(p=C[6])==null?void 0:p.trim(),P=(m=C[7])==null?void 0:m.trim();if(!N||!F||!P)continue;try{const I={row:F,col:parseInt(P,10)||1},D=this.gridToPosition(I),U={id:crypto.randomUUID(),pinNumber:N,pinName:T||N,signalName:((v=C[2])==null?void 0:v.trim())||"",direction:this.parseDirection(C[3]),pinType:this.determinePinType(T||N),voltage:((g=C[4])==null?void 0:g.trim())||"3.3V",packagePin:((_=C[5])==null?void 0:_.trim())||N,position:D,gridPosition:I,isAssigned:!!((k=C[2])!=null&&k.trim()),bank:((E=C[8])==null?void 0:E.trim())||"NA"};i.push(U),o++}catch(I){s.length<20&&s.push(`Line ${S+1}: ${I.message}`)}}u++,u%1e3===0&&console.log(` Intel/Altera processing: ${u} lines, ${o} pins`)}return console.log(` Intel/Altera processing complete: ${o} pins found from ${u} lines`),{success:i.length>0,pins:i,warnings:a,errors:s,format:{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:["Pin","Pin Name","Signal","Direction","Voltage","Package_Pin","Row","Col","Bank","Type"]}}}static async parseCSVWithKnownHeader(t,r,n){console.log(" Fast processing with known header...");const i=t.slice(n).filter(g=>!g||g.trim()===""?!1:g.replace(/,/g,"").trim()!=="");console.log(` Found ${i.length} data lines after header`);const a=t[r];console.log(` Using header line ${r}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,m=0;const v=1e3;for(let g=0;g<i.length;g++){const _=i[g];if(!_||_.replace(/,/g,"").trim()==="")continue;const k=this.parseCSVLine(_);try{const E=this.parsePin(k,o,g+n+1);E&&(u.push(E),m++)}catch(E){d.length<20&&d.push(`Line ${g+n+1}: ${E.message}`)}p++,p%v===0&&console.log(` Processed ${p}/${i.length} lines, found ${m} pins`)}return console.log(` Ultra-fast processing complete: ${m} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static async readFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;return r((s=a.target)==null?void 0:s.result)},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static async readXLSXFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=Fm(o,{type:"binary"});console.log(" XLSX Workbook info:",{sheetNames:u.SheetNames,totalSheets:u.SheetNames.length});const f=u.SheetNames[0],d=u.Sheets[f],p=og.decode_range(d["!ref"]||"A1");console.log(" Sheet range:",{sheetName:f,range:d["!ref"],rows:p.e.r-p.s.r+1,cols:p.e.c-p.s.c+1});const m=og.sheet_to_json(d,{header:1,raw:!1});console.log(" Raw data sample (first 15 rows):",m.slice(0,15)),console.log(" Total data rows:",m.length);const v=m.filter(_=>_&&Array.isArray(_)&&_.some(k=>k&&k.toString().trim()));console.log(" Non-empty rows:",v.length);const g=Rm.detectIntelAlteraFormat(m);if(console.log(" Format detection result:",g?"Intel/Altera":"Standard CSV"),g){console.log(" Intel/Altera format detected, using special processing");const _=Rm.processIntelAlteraXLSX(m);r(_)}else{const _=og.sheet_to_csv(d,{strip:!1}),k=_.split(`
`).filter(E=>E.trim());console.log(" CSV conversion result:",{originalRows:p.e.r-p.s.r+1,csvLines:k.length,firstTenLines:k.slice(0,10),linesWithCommas:k.filter(E=>E.includes(",")).length}),r(_)}}catch(o){console.error(" XLSX parsing error:",o),n(new Error(`Failed to parse XLSX file: ${o.message}`))}},i.onerror=()=>n(new Error("Failed to read XLSX file")),i.readAsBinaryString(t)})}static detectFormat(t){const r=this.parseCSVLine(t).map(a=>a.trim());return this.XILINX_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=4?{type:"xilinx",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.XILINX_HEADERS}:this.GENERIC_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=3?{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}:{type:"generic",hasHeader:!1,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static getColumnMapping(t,r){const n=this.parseCSVLine(r).map(s=>s.trim().toLowerCase());console.log(" Detected headers:",n);const i=s=>{for(const o of s){const u=n.findIndex(f=>f.includes(o.toLowerCase()));if(u!==-1)return console.log(` Found column "${o}" at index ${u}: "${n[u]}"`),u}return-1},a={pin:i(["pin","pin_number","pin number","package pin","package_pin","ball","ball_id"]),pinName:i(["pin name","pin_name","name","ball name","ball_name"]),signalName:i(["signal","signal_name","net","net name","signal name"]),direction:i(["direction","dir","type","i/o type","io_type"]),voltage:i(["voltage","volt","io_standard","io standard","vccio"]),bank:i(["bank","bank_number","bank number","io bank"]),memoryByteGroup:i(["memory byte group","byte_group","mbg","memory_byte_group"]),ioType:i(["i/o type","io_type","type","function","io_standard"])};return console.log(" Column mapping result:",a),a}static parsePin(t,r,n){var f,d,p,m,v,g,_;if(t.length===0||r.pin===-1||!t[r.pin])return null;const i=(f=t[r.pin])==null?void 0:f.trim();if(!i||i==="NA"||i===""||i.length>10||i.toLowerCase().includes("device")||!/^[A-Za-z0-9]+$/.test(i))return null;const a=((d=t[r.pinName])==null?void 0:d.trim())||i,s=this.parseGridPosition(i);if(!s)return null;const o=this.gridToPosition(s),u={id:crypto.randomUUID(),pinNumber:i,pinName:a,signalName:((p=t[r.signalName||-1])==null?void 0:p.trim())||"",direction:this.parseDirection(t[r.direction||-1]),pinType:this.determinePinType(a),voltage:((m=t[r.voltage||-1])==null?void 0:m.trim())||"3.3V",packagePin:i,position:o,gridPosition:s,isAssigned:!1,bank:(v=t[r.bank||-1])==null?void 0:v.trim(),memoryByteGroup:(g=t[r.memoryByteGroup||-1])==null?void 0:g.trim(),ioType:(_=t[r.ioType||-1])==null?void 0:_.trim()};return u.signalName&&(u.isAssigned=!0),u}static parseGridPosition(t){const r=t.match(/^([A-Z]+)(\d+)$/);return r?{row:r[1],col:parseInt(r[2],10)}:null}static gridToPosition(t){const r=Is(t.row),n=88;return{x:Math.round((t.col-1)*n),y:Math.round(r*n)}}static parseDirection(t){if(!t)return"InOut";const r=t.toLowerCase().trim();return r.includes("input")||r.includes("in")?"Input":r.includes("output")||r.includes("out")?"Output":r.includes("inout")||r.includes("bidirectional")?"InOut":r.includes("power")||r.includes("vcc")?"Power":r.includes("ground")||r.includes("gnd")?"Ground":r.includes("clock")||r.includes("clk")?"Clock":r.includes("reset")||r.includes("rst")?"Reset":"InOut"}static determinePinType(t){const r=t.toLowerCase();return r.includes("io_l")||r.includes("io_")||r.startsWith("io")?"IO":r.includes("config")||r.includes("tck")||r.includes("tdi")||r.includes("tdo")||r.includes("tms")||r.includes("done")?"CONFIG":r.includes("vcc")||r.includes("vdd")?"POWER":r.includes("gnd")||r.includes("vss")?"GROUND":r.includes("mgt")||r.includes("gt")?"MGT":r.includes("clk")||r.includes("clock")?"CLOCK":r.includes("adc")||r.includes("dac")?"ADC":r.includes("vref")||r.includes("special")?"SPECIAL":r.includes("nc")||r===""?"NC":r.includes("rsvd")||r.includes("reserved")?"RESERVED":"IO"}static parseCSVLine(t){const r=[];let n="",i=!1;for(let a=0;a<t.length;a++){const s=t[a];s==='"'?i=!i:s===","&&!i?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r}static getDefaultFormat(){return{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static createPackageFromPins(t,r="Unknown"){if(t.length===0)return{id:crypto.randomUUID(),name:r,device:"Unknown",packageType:"Unknown",dimensions:{rows:0,cols:0},pins:[],totalPins:0};const n=Math.max(...t.map(a=>Is(a.gridPosition.row)))+1,i=Math.max(...t.map(a=>a.gridPosition.col));return{id:crypto.randomUUID(),name:r,device:r.split("-")[0]||"Unknown",packageType:r.split("-")[1]||"Unknown",dimensions:{rows:n,cols:i},pins:t,totalPins:t.length}}static detectIntelAlteraFormat(t){console.log(" Detecting Intel/Altera format...");for(let r=0;r<Math.min(10,t.length);r++){const n=t[r];if(n&&Array.isArray(n)&&n.length>=4){const i=n.join(",").toLowerCase();if(console.log(`Row ${r}: "${i.substring(0,100)}..."`),i.includes("pin name/function")&&(i.includes("bank number")||i.includes("bank"))&&(i.includes("vref")||i.includes("configuration function")))return console.log(" Intel/Altera format detected!"),!0}}return console.log(" Intel/Altera format not detected"),!1}static processIntelAlteraXLSX(t){console.log(" Processing Intel/Altera XLSX format...");let r=-1,n=-1,i=-1,a=-1;for(let u=0;u<Math.min(10,t.length);u++){const f=t[u];if(f&&Array.isArray(f)&&f.length>=4){const d=f.map(p=>p?p.toString().toLowerCase().trim():"");if(d.some(p=>p.includes("pin name/function"))){r=u;for(let p=0;p<d.length;p++){const m=d[p];p===0&&(m.includes("v")||m.match(/^[a-z]\d+$/)||m.length<=3)?n=p:m.includes("pin name/function")?i=p:(m.includes("bank number")||m.includes("bank"))&&(a=p)}break}}}if(r===-1)return console.warn(" Intel/Altera header not found, fallback to standard processing"),"";console.log(" Intel/Altera format detected:",{headerRowIndex:r,pinNumberCol:n,pinNameCol:i,bankCol:a});const s=[];let o=0;s.push("Pin,Pin Name,Signal,Direction,Voltage,Package_Pin,Row,Col,Bank,Type");for(let u=r+1;u<t.length;u++){const f=t[u];if(!f||!Array.isArray(f)||f.length<4)continue;const d=f[n]?f[n].toString().trim():"",p=f[i]?f[i].toString().trim():"",m=f[a]?f[a].toString().trim():"";if(o<10&&console.log(` Processing pin ${o+1}: Number="${d}", Name="${p}", Bank="${m}"`),!d||d===""||p.toLowerCase().includes("nc")||p.toLowerCase().includes("no connect")){o<10&&console.log(` Skipping NC/empty pin: "${d}" / "${p}"`);continue}if(!d.match(/^[A-Z0-9_]+\d*$/i)){o<10&&console.log(` Skipping invalid pin format: "${d}"`);continue}let v="IO";(p.toLowerCase().includes("power")||p.toLowerCase().includes("vcc")||p.toLowerCase().includes("gnd"))&&(v="POWER");const g=d.match(/^([A-Z])(\d+)$/i),_=g?g[1].toUpperCase():"A",k=g?g[2]:"1",E=[d,p||d,"","","",d,_,k,m||"NA",v].join(",");s.push(E),o++}return console.log(` Intel/Altera processing complete: ${o} pins processed from ${t.length-r-1} data rows`),s.join(`
`)}};fx.XILINX_HEADERS=["Pin","Pin Name","Memory Byte Group","Bank","VCCAUX Group","Super Logic Region","I/O Type","No-Connect"];fx.GENERIC_HEADERS=["Pin","Signal","Direction","Voltage","Package_Pin","Row","Col"];let zc=fx;class Na{static exportToXDC(t,r){const n=t.filter(s=>s.isAssigned&&s.signalName.trim()!==""),i=["# Xilinx Design Constraints (XDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),a=n.map(s=>{const o=[];if(o.push(`set_property PACKAGE_PIN ${s.pinNumber} [get_ports ${s.signalName}]`),s.voltage){const u=s.voltage==="3.3V"?"LVCMOS33":s.voltage==="1.8V"?"LVCMOS18":s.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";o.push(`set_property IOSTANDARD ${u} [get_ports ${s.signalName}]`)}return(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property DRIVE 12 [get_ports ${s.signalName}]`),o.join(`
`)}).join(`

`);return i+a}static exportToSDC(t,r){const n=t.filter(o=>o.isAssigned&&o.signalName.trim()!==""),i=o=>o.replace(/[^\w_]/g,"_").replace(/^(\d)/,"sig_$1").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),a=["# Synopsys Design Constraints (SDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),s=n.map(o=>{const u=[],f=i(o.signalName);if(u.push(`set_location_assignment PIN_${o.pinNumber} -to ${f}`),o.voltage){const d=o.voltage==="3.3V"?"LVCMOS33":o.voltage==="1.8V"?"LVCMOS18":o.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";u.push(`set_instance_assignment -name IO_STANDARD "${d}" -to ${f}`)}return(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name CURRENT_STRENGTH_NEW "12mA" -to ${f}`),(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name SLEW_RATE 1 -to ${f}`),u.join(`
`)}).join(`

`);return a+s}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Direction","Pin Type","Voltage","Bank","I/O Type","Is Assigned"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.direction,i.pinType,i.voltage,i.bank||"",i.ioType||"",i.isAssigned?"Yes":"No"]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportReport(t,r){const n=t.filter(o=>o.isAssigned),i=t.filter(o=>!o.isAssigned),a=new Map;return t.forEach(o=>{const u=o.bank||"Unknown";a.has(u)||a.set(u,{assigned:0,total:0});const f=a.get(u);f.total++,o.isAssigned&&f.assigned++}),["# FPGA Pin Assignment Report",`# Generated: ${new Date().toLocaleString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"","## Summary",`- Total Pins: ${t.length}`,`- Assigned Pins: ${n.length}`,`- Unassigned Pins: ${i.length}`,`- Assignment Rate: ${(n.length/t.length*100).toFixed(1)}%`,"","## Bank Statistics",...Array.from(a.entries()).map(([o,u])=>`- Bank ${o}: ${u.assigned}/${u.total} (${(u.assigned/u.total*100).toFixed(1)}%)`),"","## Assigned Pins",...n.map(o=>`${o.pinNumber.padEnd(8)} | ${o.signalName.padEnd(20)} | Bank ${(o.bank||"N/A").padEnd(3)} | ${o.pinType}`),"","## Pin Type Distribution",...Object.entries(t.reduce((o,u)=>(o[u.pinType]=(o[u.pinType]||0)+1,o),{})).map(([o,u])=>`- ${o}: ${u}`)].join(`
`)}static downloadFile(t,r,n="text/plain"){const i=new Blob([t],{type:n}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}class _r{static getDifferentialPairType(t){const r=t.toLowerCase();if(r.endsWith("_p"))return"positive";if(r.endsWith("_n"))return"negative";if(r.endsWith("+"))return"positive";if(r.endsWith("-"))return"negative";if(r.endsWith("p")&&!r.endsWith("_p")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"positive"}if(r.endsWith("n")&&!r.endsWith("_n")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"negative"}const n=r.match(/^(.+_l\d+)([pn])(_.*)?$/);if(n){const i=n[2];if(i==="p")return"positive";if(i==="n")return"negative"}return null}static getPairPinName(t){const r=t.toLowerCase(),n=t;if(r.endsWith("_p"))return n.slice(0,-2)+"_N";if(r.endsWith("_n"))return n.slice(0,-2)+"_P";if(r.endsWith("+"))return n.slice(0,-1)+"-";if(r.endsWith("-"))return n.slice(0,-1)+"+";if(r.endsWith("p")&&!r.endsWith("_p")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"N"}if(r.endsWith("n")&&!r.endsWith("_n")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"P"}const i=n.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const s=i[1],o=i[2].toUpperCase(),u=i[3]||"";if(o==="P")return s+"N"+u;if(o==="N")return s+"P"+u}const a=r.match(/^(.+?)(\d+)$/);if(a){const s=a[1],o=parseInt(a[2]),u=o%2===0?o+1:o-1;return n.substring(0,s.length)+u}return null}static findPairPin(t,r){const n=this.getPairPinName(t.pinName);if(n){const a=r.find(s=>s.pinName.toLowerCase()===n.toLowerCase()&&s.bank===t.bank);if(a)return a}const i=t.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const a=i[1],o=i[2].toUpperCase()==="P"?"N":"P",u=r.find(f=>{if(f.bank!==t.bank)return!1;const d=f.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(d){const p=d[1],m=d[2].toUpperCase();return p.toLowerCase()===a.toLowerCase()&&m===o}return!1});if(u)return u}if(t.signalName){const a=this.getPairPinName(t.signalName);if(a){const s=r.find(o=>o.signalName&&o.signalName.toLowerCase()===a.toLowerCase()&&o.bank===t.bank);if(s)return s}}return null}static isDifferentialPin(t){return!!(this.getDifferentialPairType(t.pinName)!==null||t.signalName&&this.getDifferentialPairType(t.signalName)!==null)}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);const n=r.match(/^(.+?)(\d+)$/);return n?t.substring(0,n[1].length):t}static getDifferentialPriority(t){const r=this.getDifferentialPairType(t.pinName),n=t.signalName?this.getDifferentialPairType(t.signalName):null,i=r||n;return i==="positive"?1:i==="negative"?2:3}}const yD=({pin:e,isSelected:t,onSelect:r,onAssignSignal:n,isPairPin:i=!1,isDifferentialPairPartner:a=!1})=>{const s=d=>{n(e.id,d.target.value)},o=d=>({IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999"})[d]||"#666666",u=_r.getDifferentialPairType(e.pinName)||(e.signalName?_r.getDifferentialPairType(e.signalName):null),f=_r.isDifferentialPin(e);return A.jsxs("div",{className:`pin-item ${t?"selected":""}`,onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",padding:"8px 12px",margin:"2px 0",backgroundColor:t?"#444":a?"#3d4852":i?"#2d3748":"#2a2a2a",borderRadius:"4px",cursor:"pointer",border:`2px solid ${t?"#4A90E2":a?"#f59e0b":i?"#9333ea":"transparent"}`,position:"relative"},children:[f&&A.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",fontSize:"10px",color:u==="positive"?"#22c55e":"#ef4444",fontWeight:"bold"},title:`Differential ${u==="positive"?"Positive":"Negative"} Pin`,children:u==="positive"?"+":"-"}),a&&A.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"12px",color:"#f59e0b",fontWeight:"bold"},title:"Differential Pair Partner of Selected Pin",children:""}),i&&!a&&A.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"10px",color:"#9333ea",fontWeight:"bold"},title:"Differential Pair Pin",children:""}),A.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[A.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:o(e.pinType),marginRight:"8px",flexShrink:0}}),A.jsx("div",{style:{minWidth:"60px",fontFamily:"monospace",fontSize:"12px",color:"#ccc"},children:e.pinNumber}),A.jsx("div",{style:{minWidth:"120px",fontSize:"11px",color:"#999",marginRight:"8px",flex:1},children:e.pinName}),A.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:e.isAssigned?"#4AE24A":"#666",marginLeft:"8px",flexShrink:0}})]}),A.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:A.jsx("input",{type:"text",value:e.signalName,onChange:s,placeholder:"Signal name",onClick:d=>d.stopPropagation(),style:{flex:1,padding:"4px 8px",fontSize:"12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"}})}),e.bank&&A.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"11px",color:"#666"},children:[A.jsx("span",{style:{marginRight:"4px"},children:""}),A.jsxs("span",{children:["Bank ",e.bank]})]})]})},_D=({isOpen:e,onClose:t,onExport:r,pins:n,currentPackage:i})=>{const[a,s]=ke.useState("xdc"),[o,u]=ke.useState(!1);if(!e)return null;const f=[{value:"xdc",label:"XDC (Xilinx)",description:"Xilinx Design Constraints format for Vivado and ISE",icon:"",example:"set_property PACKAGE_PIN A1 [get_ports clk]"},{value:"sdc",label:"SDC (Intel/Altera)",description:"Synopsys Design Constraints format for Quartus",icon:"",example:"set_location_assignment PIN_A1 -to clk"}],d=f.find(g=>g.value===a),p=n.filter(g=>g.isAssigned&&g.signalName.trim()!=="").length,m=()=>{r(a),t()},v=()=>{if(!o)return null;const g=n.filter(_=>_.isAssigned&&_.signalName.trim()!=="").slice(0,3);return a==="xdc"?Na.exportToXDC(g,i):Na.exportToSDC(g,i)};return A.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:A.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",padding:"24px",width:"500px",maxHeight:"80vh",overflow:"auto",color:"white"},children:[A.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[A.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"Export Constraint File"}),A.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"20px",cursor:"pointer",padding:"4px"},children:""})]}),A.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#ccc"},children:[p," assigned pins will be exported"]}),A.jsxs("div",{style:{marginBottom:"20px"},children:[A.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:"Choose constraint file format:"}),f.map(g=>A.jsxs("div",{style:{border:`2px solid ${a===g.value?"#007acc":"#444"}`,borderRadius:"6px",padding:"12px",marginBottom:"8px",cursor:"pointer",backgroundColor:a===g.value?"#1a4c80":"#333",transition:"all 0.2s ease"},onClick:()=>s(g.value),children:[A.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[A.jsx("span",{style:{fontSize:"16px",marginRight:"8px"},children:g.icon}),A.jsx("span",{style:{fontWeight:"bold",fontSize:"16px"},children:g.label})]}),A.jsx("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"6px"},children:g.description}),A.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:"#bbb",backgroundColor:"#1a1a1a",padding:"4px 8px",borderRadius:"3px"},children:["Example: ",g.example]})]},g.value))]}),p>0&&A.jsxs("div",{style:{marginBottom:"20px"},children:[A.jsx("button",{onClick:()=>u(!o),style:{backgroundColor:"#444",border:"1px solid #666",borderRadius:"4px",color:"white",padding:"6px 12px",cursor:"pointer",fontSize:"12px"},children:o?"Hide Preview":"Show Preview"}),o&&A.jsx("div",{style:{marginTop:"8px",backgroundColor:"#1a1a1a",border:"1px solid #444",borderRadius:"4px",padding:"12px",maxHeight:"200px",overflow:"auto"},children:A.jsx("pre",{style:{margin:0,fontSize:"11px",color:"#ddd",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:v()})})]}),A.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[A.jsx("button",{onClick:t,style:{backgroundColor:"#666",border:"1px solid #888",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),A.jsxs("button",{onClick:m,disabled:p===0,style:{backgroundColor:p>0?"#007acc":"#555",border:"1px solid #007acc",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:p>0?"pointer":"not-allowed",fontSize:"14px",opacity:p>0?1:.6},children:["Export ",d==null?void 0:d.label]})]})]})})},lg=[{id:"overview",title:"Overview",icon:"",description:"All pins with key information",showSearch:!0,showFilters:!0,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}]},{id:"signals",title:"Signals",icon:"",description:"Assigned signal information",showSearch:!0,showFilters:!0,columns:[{key:"signalName",title:"Signal Name",width:140,editable:!0,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"direction",title:"Direction",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>!!(e.signalName&&e.signalName.trim()!==""),sort:(e,t)=>(e.signalName||"").localeCompare(t.signalName||"")},{id:"bankGroups",title:"Bank Stats",icon:"",description:"Dynamic bank groups statistics and analysis",showSearch:!1,showFilters:!1,isCustomComponent:!0,columns:[],filter:()=>!0,sort:()=>0},{id:"banks",title:"Banks",icon:"",description:"Pin organization by I/O banks",showSearch:!0,showFilters:!0,columns:[{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioType",title:"I/O Type",width:80,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>!!(e.bank&&e.bank.trim()!==""),sort:(e,t)=>{const r=parseInt(e.bank||"999"),n=parseInt(t.bank||"999");return r-n}},{id:"differential",title:"Diff Pairs",icon:"",description:"Differential pair management",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"differentialPair",title:"Pair Name",width:100,sortable:!0,customRender:(e,t)=>t.differentialPair?`${t.differentialPair.pair} (${t.differentialPair.type})`:"-"},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>e.differentialPair!==void 0,sort:(e,t)=>{var i,a;const r=((i=e.differentialPair)==null?void 0:i.pair)||"",n=((a=t.differentialPair)==null?void 0:a.pair)||"";return r.localeCompare(n)}},{id:"comments",title:"Comments",icon:"",description:"All pins with user comments",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"signalName",title:"Signal",width:100,sortable:!0},{key:"comment",title:"Comment",width:300,editable:!0},{key:"commentTimestamp",title:"Modified",width:120,render:"datetime",sortable:!0},{key:"commentAuthor",title:"Author",width:80,sortable:!0}],filter:e=>!!(e.comment&&e.comment.trim()!==""),sort:(e,t)=>{var i,a;const r=((i=e.commentTimestamp)==null?void 0:i.getTime())||0;return(((a=t.commentTimestamp)==null?void 0:a.getTime())||0)-r}},{id:"power",title:"Power",icon:"",description:"Power and ground pins",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>e.pinType==="POWER"||e.pinType==="GROUND"||e.direction==="Power"||e.direction==="Ground",sort:(e,t)=>e.pinNumber.localeCompare(t.pinNumber)}],SD=({value:e,onSave:t,options:r,editable:n=!1,placeholder:i="",className:a="",allowCustomValue:s=!1,getDisplayValue:o})=>{const[u,f]=ke.useState(!1),[d,p]=ke.useState(e||""),m=ke.useRef(null),v=()=>{d!==e&&t(d),f(!1)},g=()=>{p(e||""),f(!1)},_=E=>{E.key==="Enter"?(E.preventDefault(),v()):E.key==="Escape"&&(E.preventDefault(),g())};if(ke.useEffect(()=>{u&&m.current&&m.current.focus()},[u]),ke.useEffect(()=>{p(e||"")},[e]),!n){const E=o?o(e):e;return A.jsx("span",{className:`table-cell-readonly ${a}`,children:E||"-"})}if(u)return A.jsxs("select",{ref:m,value:d,onChange:E=>p(E.target.value),onBlur:v,onKeyDown:_,className:`table-cell-select ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"},children:[i&&A.jsx("option",{value:"",disabled:!0,children:i}),r.map(E=>A.jsx("option",{value:E,children:o?o(E):E},E)),s&&d&&!r.includes(d)&&A.jsxs("option",{value:d,children:[d," (Custom)"]})]});const k=o?o(e):e;return A.jsxs("div",{className:`table-cell-selectable ${a}`,onClick:()=>f(!0),title:"Click to select",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"pointer",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:E=>{E.currentTarget.style.borderColor="#555",E.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:E=>{E.currentTarget.style.borderColor="transparent",E.currentTarget.style.backgroundColor="transparent"},children:[A.jsx("span",{children:k||A.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:i})}),A.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:"4px"},children:""})]})},cg=({value:e,onSave:t,editable:r=!1,placeholder:n="",maxLength:i=500,className:a="",type:s="text",options:o=[],allowCustomValue:u=!1,getDisplayValue:f})=>{const[d,p]=ke.useState(!1),[m,v]=ke.useState(e||""),g=ke.useRef(null),_=()=>{m!==e&&t(m),p(!1)},k=()=>{v(e||""),p(!1)},E=S=>{S.key==="Enter"?(S.preventDefault(),_()):S.key==="Escape"&&(S.preventDefault(),k())};return ke.useEffect(()=>{d&&g.current&&(g.current.focus(),g.current.select())},[d]),ke.useEffect(()=>{v(e||"")},[e]),s==="select"?A.jsx(SD,{value:e,onSave:t,options:o,editable:r,placeholder:n,className:a,allowCustomValue:u,getDisplayValue:f}):(ke.useEffect(()=>{v(e||"")},[e]),r?d?A.jsx("input",{ref:g,type:"text",value:m,onChange:S=>v(S.target.value),onBlur:_,onKeyDown:E,placeholder:n,maxLength:i,className:`table-cell-input ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"}}):A.jsx("div",{className:`table-cell-editable ${a}`,onClick:()=>p(!0),title:"Click to edit",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"text",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:S=>{S.currentTarget.style.borderColor="#555",S.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:S=>{S.currentTarget.style.borderColor="transparent",S.currentTarget.style.backgroundColor="transparent"},children:e||A.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:n})}):A.jsx("span",{className:`table-cell-readonly ${a}`,children:e||"-"}))},wD="#e0e0e0",kD="#ccc",ED="#cccccc",CD="#FFF",TD="#000",AD="#374151",PD="#666",FD=[wD,kD,ED,CD,TD,AD,PD],ND=[{min:224,max:255,channels:["r","g","b"]},{min:0,max:48,channels:["r","g","b"]},{min:192,max:208,channels:["r","g","b"]}];function RD(e,t,r){for(const n of ND)if(n.channels.every(a=>{const s=a==="r"?e:a==="g"?t:r;return s>=n.min&&s<=n.max}))return!0;for(const n of FD){const i=parseInt(n.slice(1,3),16),a=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);if(Math.sqrt(Math.pow(e-i,2)+Math.pow(t-a,2)+Math.pow(r-s,2))<80)return!0}return!1}function ID(e){const t=[],r=.618033988749895,n=.7,i=.5;for(let a=0;a<e;a++){let s=a*r%1,o=0,u=!1;for(;!u&&o<10;){const f=DD(s,n,i);RD(f.r,f.g,f.b)?(s=(s+.1)%1,o++):(t.push(`#${f.r.toString(16).padStart(2,"0")}${f.g.toString(16).padStart(2,"0")}${f.b.toString(16).padStart(2,"0")}`),u=!0)}u||t.push(`#${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}`)}return t}function DD(e,t,r){let n,i,a;if(t===0)n=i=a=r;else{const s=(f,d,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?f+(d-f)*6*p:p<.5?d:p<.6666666666666666?f+(d-f)*(.6666666666666666-p)*6:f),o=r<.5?r*(1+t):r+t-r*t,u=2*r-o;n=s(u,o,e+1/3),i=s(u,o,e),a=s(u,o,e-1/3)}return{r:Math.round(n*255),g:Math.round(i*255),b:Math.round(a*255)}}const Vc=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#F39C12","#E74C3C","#9B59B6","#3498DB","#1ABC9C","#2ECC71","#F1C40F","#E67E22","#E91E63","#673AB7"];function go(e){if(!e||e==="NA")return"#708090";if(e==="POWER"||e==="VCC")return"#8B4513";if(e==="GROUND"||e==="GND")return"#2C2C2C";const t=parseInt(e);if(!isNaN(t)){if(t<Vc.length)return Vc[t];{const i=ID(t-Vc.length+1);return i[i.length-1]}}let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)&4294967295;const n=Math.abs(r)%Vc.length;return Vc[n]}const TS=(e,t,r)=>{if(t)return"#2d4f75";if(!e)return r?"#2a2a2a":"#1a1a1a";const n=go(e),i=OD(n,.7);return r?bD(i,.2):i},OD=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.max(0,(r>>16)-n),a=Math.max(0,(r>>8&255)-n),s=Math.max(0,(r&255)-n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},bD=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.min(255,(r>>16)+n),a=Math.min(255,(r>>8&255)+n),s=Math.min(255,(r&255)+n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},Gc=48,I3=5,LD=({pins:e,columns:t,selectedRows:r,hoveredRowId:n,onRowSelection:i,onPinSelect:a,onHover:s,renderCellContent:o})=>{const[u,f]=ke.useState(0),[d,p]=ke.useState(400),m=ke.useRef(null),v=ke.useRef(null),g=ke.useMemo(()=>{const S=Math.floor(u/Gc),x=Math.ceil(d/Gc),C=Math.min(S+x+I3*2,e.length),N=Math.max(0,S-I3);return{start:N,end:C,visibleCount:C-N}},[u,d,e.length]),_=ke.useMemo(()=>e.slice(g.start,g.end),[e,g.start,g.end]),k=ke.useCallback(S=>{const x=S.target;console.log(" Scroll Event:",{scrollTop:x.scrollTop,scrollHeight:x.scrollHeight,clientHeight:x.clientHeight,maxScroll:x.scrollHeight-x.clientHeight}),f(x.scrollTop)},[]);ke.useEffect(()=>{const S=()=>{if(m.current){const C=m.current.getBoundingClientRect();p(C.height)}};S();const x=new ResizeObserver(S);return m.current&&x.observe(m.current),()=>{x.disconnect()}},[]);const E=e.length*Gc;return ke.useEffect(()=>{console.log(" VirtualizedPinList Debug:",{totalPins:e.length,visibleCount:g.visibleCount,visiblePercent:Math.round(g.visibleCount/e.length*100),totalHeight:E,containerHeight:d,scrollTop:u,visibleStart:g.start,visibleEnd:g.end})},[g.visibleCount,e.length,E,d,u,g.start,g.end]),A.jsxs("div",{ref:m,style:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},children:[A.jsx("div",{style:{backgroundColor:"#2a2a2a",borderBottom:"2px solid #444",flexShrink:0,zIndex:10},children:A.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:A.jsx("thead",{children:A.jsxs("tr",{children:[A.jsx("th",{style:{width:"40px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",backgroundColor:"#2a2a2a",color:"#ffffff"},children:A.jsx("input",{type:"checkbox",checked:e.length>0&&r.size===e.length,onChange:S=>{const x=S.target.checked?new Set(e.map(C=>C.id)):new Set;e.forEach(C=>{r.has(C.id)!==x.has(C.id)&&i(C.id,x.has(C.id))})}})}),t.map(S=>A.jsx("th",{style:{width:`${S.width}px`,padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a"},children:S.title},S.key))]})})})}),A.jsx("div",{ref:v,onScroll:k,style:{flex:1,overflow:"auto",position:"relative",scrollbarWidth:"thin",scrollbarColor:"#555 #2a2a2a"},className:"virtualized-list-scroll",children:A.jsx("div",{style:{height:E,position:"relative"},children:A.jsx("div",{style:{position:"absolute",top:g.start*Gc,left:0,right:0},children:A.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:A.jsx("tbody",{children:_.map(S=>{const x=n===S.id,C=TS(S.bank,r.has(S.id),x);return A.jsxs("tr",{style:{backgroundColor:C,cursor:"pointer",borderBottom:"1px solid #333",color:"#ffffff",height:`${Gc}px`},onClick:()=>a==null?void 0:a(S.id),onMouseEnter:()=>s(S.id),onMouseLeave:()=>s(null),children:[A.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"40px"},children:A.jsx("input",{type:"checkbox",checked:r.has(S.id),onChange:N=>i(S.id,N.target.checked),onClick:N=>N.stopPropagation()})}),t.map(N=>A.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",fontSize:"14px",maxWidth:`${N.width}px`,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:T=>N.editable&&T.stopPropagation(),children:o(S,N)},N.key))]},S.id)})})})})})})]})};class ug{static calculateBankStatistics(t){const r=new Map;t.forEach(p=>{const m=p.bank||"UNASSIGNED";r.has(m)||r.set(m,[]),r.get(m).push(p)});const n=[];let i=0;Array.from(r.entries()).forEach(([p,m])=>{const v=m.filter(T=>{var F;return T.isAssigned||!!((F=T.signalName)!=null&&F.trim())}),g=m.filter(T=>{var F;return!T.isAssigned&&!((F=T.signalName)!=null&&F.trim())});i+=v.length;const _={};m.forEach(T=>{const F=T.pinType||"UNKNOWN";_[F]=(_[F]||0)+1});const k={};m.forEach(T=>{const F=T.voltage||"UNSPECIFIED";k[F]=(k[F]||0)+1});const E={};m.forEach(T=>{const F=T.direction||"UNSPECIFIED";E[F]=(E[F]||0)+1});const S=m.filter(T=>{var F,P;return T.differentialPair||((F=T.pinName)==null?void 0:F.includes("_P"))||((P=T.pinName)==null?void 0:P.includes("_N"))}).length/2,x=new Map;v.forEach(T=>{if(T.signalName){const F=this.inferSignalType(T.signalName);x.set(F,(x.get(F)||0)+1)}});const C=Array.from(x.entries()).filter(([T,F])=>F>=2).sort((T,F)=>F[1]-T[1]).slice(0,3).map(([T,F])=>T),N=m.length>0?v.length/m.length*100:0;n.push({bankId:p,totalPins:m.length,assignedPins:v.length,unassignedPins:g.length,utilizationRate:N,pinsByType:_,pinsByVoltage:k,pinsByDirection:E,differentialPairs:Math.floor(S),majorSignalTypes:C})}),n.sort((p,m)=>{if(p.bankId==="UNASSIGNED")return 1;if(m.bankId==="UNASSIGNED")return-1;const v=parseInt(p.bankId),g=parseInt(m.bankId);return!isNaN(v)&&!isNaN(g)?v-g:p.bankId.localeCompare(m.bankId)});const a=t.length,s=a>0?i/a*100:0,o=n.filter(p=>p.bankId!=="UNASSIGNED").map(p=>({id:p.bankId,rate:p.utilizationRate})),u=o.length>0?o.reduce((p,m)=>m.rate>p.rate?m:p):{id:"N/A",rate:0},f=o.length>0?o.reduce((p,m)=>m.rate<p.rate?m:p):{id:"N/A",rate:0},d=Array.from(new Set(t.map(p=>p.pinType).filter(Boolean))).sort();return{totalBanks:r.size,totalPins:a,overallUtilization:s,bankStats:n,mostUtilizedBank:u.id,leastUtilizedBank:f.id,bankTypes:d}}static inferSignalType(t){const r=t.toUpperCase();return r.includes("CLK")?"CLOCK":r.includes("RST")||r.includes("RESET")?"RESET":r.includes("PWR")||r.includes("VCC")||r.includes("POWER")?"POWER":r.includes("GND")||r.includes("GROUND")?"GROUND":r.includes("DATA")||r.includes("D[")?"DATA":r.includes("ADDR")||r.includes("A[")?"ADDRESS":r.includes("CS")||r.includes("CE")||r.includes("EN")?"CONTROL":r.includes("LED")?"LED":r.includes("BTN")||r.includes("SW")?"USER_INPUT":r.includes("UART")||r.includes("TX")||r.includes("RX")?"UART":r.includes("SPI")||r.includes("I2C")?"SERIAL":r.includes("USB")?"USB":r.includes("ETH")||r.includes("RMII")||r.includes("RGMII")?"ETHERNET":r.includes("DDR")||r.includes("SDRAM")?"MEMORY":r.includes("HDMI")||r.includes("LVDS")?"DISPLAY":r.includes("_P")||r.includes("_N")?"DIFFERENTIAL":"GENERAL_IO"}static exportBankStatisticsCSV(t){const r=["Bank ID","Total Pins","Assigned Pins","Unassigned Pins","Utilization (%)","Main Pin Types","Main Voltages","Differential Pairs","Major Signal Types"],n=t.bankStats.map(i=>[i.bankId,i.totalPins.toString(),i.assignedPins.toString(),i.unassignedPins.toString(),i.utilizationRate.toFixed(1),Object.entries(i.pinsByType).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),Object.entries(i.pinsByVoltage).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),i.differentialPairs.toString(),i.majorSignalTypes.join("; ")]);return[r.join(","),...n.map(i=>i.map(a=>`"${a}"`).join(","))].join(`
`)}static generateRecommendations(t){const r=[];t.overallUtilization>90?r.push(" Overall utilization is very high (>90%). Consider using a larger package or optimizing pin assignments."):t.overallUtilization<30&&r.push(" Overall utilization is low (<30%). A smaller package might be more cost-effective.");const n=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED").map(a=>a.utilizationRate);if(n.length>1){const a=Math.max(...n),s=Math.min(...n),o=a-s;o>50&&r.push(` Bank utilization is unbalanced (${o.toFixed(1)}% variance). Consider redistributing signals.`)}const i=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED"&&a.assignedPins===0);return i.length>0&&r.push(` ${i.length} banks are completely unused: ${i.map(a=>a.bankId).join(", ")}`),r}}const MD=({pins:e})=>{const[t,r]=ke.useState(null),[n,i]=ke.useState("bankId"),[a,s]=ke.useState("asc"),{visibleBanks:o,toggleBankVisibility:u,showAllBanks:f}=$i(),d=ke.useMemo(()=>ug.calculateBankStatistics(e),[e]),p=ke.useMemo(()=>{const N=[...d.bankStats];return N.sort((T,F)=>{let P=0;switch(n){case"bankId":if(T.bankId==="UNASSIGNED")P=1;else if(F.bankId==="UNASSIGNED")P=-1;else{const I=parseInt(T.bankId),D=parseInt(F.bankId);!isNaN(I)&&!isNaN(D)?P=I-D:P=T.bankId.localeCompare(F.bankId)}break;case"utilization":P=T.utilizationRate-F.utilizationRate;break;case"totalPins":P=T.totalPins-F.totalPins;break}return a==="asc"?P:-P}),N},[d.bankStats,n,a]),m=N=>{n===N?s(a==="asc"?"desc":"asc"):(i(N),s("asc"))},v=()=>{const N=ug.exportBankStatisticsCSV(d),T=new Blob([N],{type:"text/csv"}),F=URL.createObjectURL(T),P=document.createElement("a");P.href=F,P.download=`bank-statistics-${new Date().toISOString().slice(0,10)}.csv`,P.click(),URL.revokeObjectURL(F)},g=ke.useMemo(()=>ug.generateRecommendations(d),[d]),_=N=>n!==N?"":a==="asc"?"":"",k=N=>o.size===0?!0:o.has(N),E=N=>{console.log(` Bank ${N} clicked! Current visibility:`,k(N)),alert(`Bank ${N} clicked!`),u(N)},S=()=>{console.log(" Show all banks clicked"),alert("Show all banks clicked!"),f()},x=N=>{if(N==="UNASSIGNED")return{backgroundColor:"#6b7280",color:"white"};const T=go(N),F=k(N);return{backgroundColor:F?`${T}20`:`${T}05`,borderLeft:`4px solid ${T}`,color:F?"#1f2937":"#9ca3af",opacity:F?1:.5}},C=N=>`${N.toFixed(1)}%`;return A.jsxs("div",{className:"bank-groups-panel p-4 space-y-4",children:[A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Groups Statistics"}),A.jsx("button",{onClick:v,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:" Export CSV"})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[A.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[A.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Banks"}),A.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.totalBanks})]}),A.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[A.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Pins"}),A.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.totalPins})]}),A.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[A.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overall Utilization"}),A.jsx("p",{className:"text-2xl font-bold text-purple-600",children:C(d.overallUtilization)})]}),A.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[A.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Most Utilized"}),A.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["Bank ",d.mostUtilizedBank]})]})]}),g.length>0&&A.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[A.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Recommendations"}),A.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:g.map((N,T)=>A.jsxs("li",{children:[" ",N]},T))})]}),A.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[A.jsx("h3",{className:"text-sm font-medium text-red-800 mb-2",children:" Debug Test Buttons"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("button",{onClick:()=>alert("Simple button works!"),className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Test Simple Click"}),A.jsx("button",{onClick:S,className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Test Show All"}),A.jsx("button",{onClick:()=>E("TEST"),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Bank Click"})]})]}),A.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[A.jsxs("div",{className:"p-4 border-b",children:[A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Bank Details"}),A.jsx("div",{className:"flex gap-2",children:A.jsx("button",{onClick:S,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",title:"Show all banks",children:" Show All"})})]}),A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsx("p",{className:"text-sm text-gray-600 mt-1",children:" Click on any bank row to toggle its visibility in the pin list"}),A.jsxs("div",{className:"text-xs text-gray-400",children:["Visible Banks: ",o.size===0?"All":Array.from(o).join(", ")]})]})]}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"w-full",children:[A.jsx("thead",{className:"bg-gray-50",children:A.jsxs("tr",{children:[A.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("bankId"),children:["Bank ID ",_("bankId")]}),A.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("totalPins"),children:["Total Pins ",_("totalPins")]}),A.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),A.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("utilization"),children:["Utilization ",_("utilization")]}),A.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Main Types"}),A.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diff Pairs"}),A.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),A.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(N=>A.jsxs(Sr.Fragment,{children:[A.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200",style:x(N.bankId),onClick:()=>E(N.bankId),title:`Click to ${k(N.bankId)?"hide":"show"} Bank ${N.bankId} pins`,children:[A.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:A.jsxs("div",{className:"flex items-center",children:[A.jsxs("div",{className:"flex items-center mr-2",children:[A.jsx("span",{className:"text-lg mr-1",children:k(N.bankId)?"":""}),A.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.bankId==="UNASSIGNED"?"#6b7280":go(N.bankId)}})]}),A.jsx("span",{className:"text-sm font-medium",children:N.bankId==="UNASSIGNED"?"Unassigned":`Bank ${N.bankId}`})]})}),A.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:N.totalPins}),A.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[A.jsx("span",{className:"text-green-600 font-medium",children:N.assignedPins}),A.jsxs("span",{className:"text-gray-400",children:["/",N.unassignedPins]})]}),A.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:A.jsxs("div",{className:"flex items-center",children:[A.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:A.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,N.utilizationRate)}%`}})}),A.jsx("span",{className:"text-sm text-gray-700",children:C(N.utilizationRate)})]})}),A.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:Object.entries(N.pinsByType).sort((T,F)=>F[1]-T[1]).slice(0,2).map(([T,F])=>`${T}(${F})`).join(", ")}),A.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:N.differentialPairs>0?N.differentialPairs:"-"}),A.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:A.jsx("button",{onClick:T=>{T.stopPropagation(),r(t===N.bankId?null:N.bankId)},className:"text-blue-600 hover:text-blue-900 font-medium",children:t===N.bankId?"Hide":"Details"})})]}),t===N.bankId&&A.jsx("tr",{children:A.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[A.jsxs("div",{children:[A.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Pin Types"}),A.jsx("div",{className:"space-y-1",children:Object.entries(N.pinsByType).map(([T,F])=>A.jsxs("div",{className:"flex justify-between text-sm",children:[A.jsx("span",{className:"text-gray-600",children:T}),A.jsx("span",{className:"font-medium",children:F})]},T))})]}),A.jsxs("div",{children:[A.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Voltages"}),A.jsx("div",{className:"space-y-1",children:Object.entries(N.pinsByVoltage).map(([T,F])=>A.jsxs("div",{className:"flex justify-between text-sm",children:[A.jsx("span",{className:"text-gray-600",children:T}),A.jsx("span",{className:"font-medium",children:F})]},T))})]}),A.jsxs("div",{children:[A.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Major Signal Types"}),A.jsx("div",{className:"space-y-1",children:N.majorSignalTypes.length>0?N.majorSignalTypes.map(T=>A.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:T},T)):A.jsx("span",{className:"text-gray-500 text-sm",children:"No major signal types"})})]})]})})})]},N.bankId))})]})})]})]})},dx=["1.0V","1.2V","1.5V","1.8V","2.5V","3.3V","5.0V"],hx=["LVCMOS12","LVCMOS15","LVCMOS18","LVCMOS25","LVCMOS33","LVTTL","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","SSTL135","SSTL15","SSTL18_I","SSTL18_II","POD10","POD12","POD135","HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18","AUTO"],BD={"1.0V":"POD10","1.2V":"LVCMOS12","1.5V":"LVCMOS15","1.8V":"LVCMOS18","2.5V":"LVCMOS25","3.3V":"LVCMOS33","5.0V":"LVTTL"},AS={"1.0V":["POD10"],"1.2V":["LVCMOS12","POD12","SSTL135"],"1.5V":["LVCMOS15","SSTL15","HSTL_I","HSTL_II"],"1.8V":["LVCMOS18","SSTL18_I","SSTL18_II","HSTL_I_18","HSTL_II_18"],"2.5V":["LVCMOS25","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25"],"3.3V":["LVCMOS33","LVTTL"],"5.0V":["LVTTL"]};function D3(e){return AS[e]||["LVCMOS33"]}function Ql(e){return BD[e]||"LVCMOS33"}function UD(e,t){return t==="AUTO"?!0:(AS[e]||[]).includes(t)}const jD=({onPinSelect:e})=>{const{pins:t,listView:r,setActiveTab:n,setSearchQuery:i,setCommentFilter:a,updatePin:s,updateListViewState:o,bulkUpdateComments:u}=$i(),[f,d]=ke.useState(""),[p,m]=ke.useState(!1),[v,g]=ke.useState(null),_=ke.useMemo(()=>lg.find(T=>T.id===r.activeTab)||lg[0],[r.activeTab]),k=(T,F)=>{var P,I;switch(F){case"differentialPair":return T.differentialPair?`${T.differentialPair.pair}_${T.differentialPair.type}`:"";case"commentTimestamp":return((P=T.commentTimestamp)==null?void 0:P.getTime())||0;case"ioStandard":return((I=T.attributes)==null?void 0:I.IO_Standard)||T.ioType||"AUTO";default:return T[F]||""}},E=ke.useMemo(()=>{let T=t;if(_.filter&&(T=T.filter(_.filter)),r.searchQuery.trim()){const F=r.searchQuery.toLowerCase();T=T.filter(P=>P.pinNumber.toLowerCase().includes(F)||P.pinName.toLowerCase().includes(F)||(P.signalName||"").toLowerCase().includes(F)||(P.comment||"").toLowerCase().includes(F))}switch(r.commentFilter){case"with-comments":T=T.filter(F=>F.comment&&F.comment.trim()!=="");break;case"without-comments":T=T.filter(F=>!F.comment||F.comment.trim()==="");break}return r.sortColumn?T=[...T].sort((F,P)=>{const I=k(F,r.sortColumn),D=k(P,r.sortColumn);let U=0;return I<D?U=-1:I>D&&(U=1),r.sortDirection==="desc"?-U:U}):_.sort&&(T=[...T].sort(_.sort)),T},[t,_,r.searchQuery,r.commentFilter,r.sortColumn,r.sortDirection]),S=(T,F)=>{const P=k(T,F.key);if(F.customRender)return F.customRender(P,T);if(F.render==="datetime"&&T.commentTimestamp)return T.commentTimestamp.toLocaleDateString()+" "+T.commentTimestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(F.render==="boolean")return P?"":"";if(F.editable){if(F.key==="voltage")return A.jsx(cg,{value:String(P),onSave:I=>x(T.id,F.key,I),editable:!0,placeholder:"Select voltage...",type:"select",options:[...dx],allowCustomValue:!0});if(F.key==="ioStandard"||F.key==="ioType"){const I=T.voltage?D3(T.voltage):[...hx];return A.jsx(cg,{value:String(P),onSave:D=>x(T.id,F.key,D),editable:!0,placeholder:"Select I/O standard...",type:"select",options:I,allowCustomValue:!0,getDisplayValue:D=>D==="AUTO"?`Auto (${Ql(T.voltage||"3.3V")})`:D})}return A.jsx(cg,{value:String(P),onSave:I=>x(T.id,F.key,I),editable:!0,placeholder:`Enter ${F.title.toLowerCase()}...`,maxLength:F.key==="comment"?500:100})}return String(P)||"-"},x=(T,F,P)=>{var U;const I=t.find(b=>b.id===T);if(!I)return;const D={};if(F==="comment")D.comment=P,D.commentTimestamp=new Date,D.commentAuthor="current_user";else if(F==="voltage"){D.voltage=P;const b=((U=I.attributes)==null?void 0:U.IO_Standard)||I.ioType||"AUTO";if(b==="AUTO"||!D3(P).includes(b)){const Q=Ql(P);D.attributes={...I.attributes,IO_Standard:Q},D.ioType=Q}}else F==="ioStandard"||F==="ioType"?(D.attributes={...I.attributes,IO_Standard:P},D.ioType=P):D[F]=P;s(T,D)},C=(T,F)=>{const P=new Set(r.selectedRows);F?P.add(T):P.delete(T),o({selectedRows:P})},N=()=>{f.trim()&&r.selectedRows.size>0&&(u(Array.from(r.selectedRows),f),d(""),m(!1))};return A.jsxs("div",{className:"pin-list-tabs",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[!1,A.jsx("div",{className:"tab-header",style:{display:"flex",borderBottom:"1px solid #444",backgroundColor:"#2a2a2a"},children:lg.map(T=>A.jsxs("button",{className:`tab ${r.activeTab===T.id?"active":""}`,onClick:()=>n(T.id),title:T.description,style:{padding:"12px 16px",border:"none",background:r.activeTab===T.id?"#333":"transparent",borderBottom:r.activeTab===T.id?"2px solid #007acc":"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:r.activeTab===T.id?"600":"normal",color:r.activeTab===T.id?"#007acc":"#cccccc"},children:[A.jsx("span",{children:T.icon}),A.jsx("span",{children:T.title})]},T.id))}),!_.isCustomComponent&&A.jsxs("div",{className:"controls",style:{padding:"16px",display:"flex",gap:"16px",alignItems:"center",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444"},children:[_.showSearch&&A.jsx("div",{style:{flex:1,maxWidth:"300px"},children:A.jsx("input",{type:"text",placeholder:"Search pins, signals, or comments...",value:r.searchQuery,onChange:T=>i(T.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"}})}),A.jsx("div",{children:A.jsxs("select",{value:r.commentFilter,onChange:T=>a(T.target.value),style:{padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[A.jsx("option",{value:"all",children:"All Pins"}),A.jsx("option",{value:"with-comments",children:"With Comments"}),A.jsx("option",{value:"without-comments",children:"Without Comments"})]})}),A.jsxs("div",{style:{color:"#cccccc",fontSize:"14px"},children:[E.length," pins"]}),A.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[A.jsx("span",{style:{color:"#cccccc",fontSize:"12px"},children:"BANKs:"}),Array.from(new Set(E.map(T=>T.bank).filter(Boolean))).sort((T,F)=>{const P=parseInt(T),I=parseInt(F);return isNaN(P)||isNaN(I)?T.localeCompare(F):P-I}).map(T=>A.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"3px",backgroundColor:TS(T,!1,!1),border:"1px solid #555"},children:A.jsx("span",{style:{fontSize:"11px",color:"#ffffff"},children:T})},T))]}),r.selectedRows.size>0&&A.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[A.jsxs("span",{style:{fontSize:"14px",color:"#cccccc"},children:[r.selectedRows.size," selected"]}),A.jsx("button",{onClick:()=>m(!p),style:{padding:"6px 12px",border:"1px solid #007acc",borderRadius:"4px",backgroundColor:"#007acc",color:"white",fontSize:"12px",cursor:"pointer"},children:"Bulk Comment"}),A.jsx("button",{onClick:()=>u(Array.from(r.selectedRows),""),style:{padding:"6px 12px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Comments"})]})]}),!_.isCustomComponent&&p&&A.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",borderBottom:"1px solid #444",display:"flex",gap:"8px",alignItems:"center"},children:[A.jsx("input",{type:"text",placeholder:"Enter comment for selected pins...",value:f,onChange:T=>d(T.target.value),onKeyDown:T=>T.key==="Enter"&&N(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),A.jsx("button",{onClick:N,disabled:!f.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:f.trim()?"#28a745":"#ccc",color:"white",fontSize:"14px",cursor:f.trim()?"pointer":"not-allowed"},children:"Apply"}),A.jsx("button",{onClick:()=>m(!1),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#333",color:"#cccccc",fontSize:"14px",cursor:"pointer"},children:"Cancel"})]}),A.jsx("div",{style:{flex:1,minHeight:"400px",overflow:"hidden",display:"flex",flexDirection:"column"},children:_.isCustomComponent?_.id==="bankGroups"?A.jsx(MD,{pins:t}):A.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:["Custom component not implemented for ",_.id]}):E.length>0?A.jsx(LD,{pins:E,columns:_.columns,selectedRows:r.selectedRows,hoveredRowId:v,onRowSelection:C,onPinSelect:e,onHover:g,renderCellContent:S}):A.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"No pins match the current filters"})})]})};var PS={exports:{}},yh={},Vd={},ft={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof d4<"u"?d4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return e.Konva.angleDeg?i*t:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var i;return(i=e.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(i){e.glob.Konva=i}};const n=i=>{e.Konva[i.prototype.getClassName()]=i};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(ft);var ir={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=ft;class r{constructor(C=[1,0,0,1,0,0]){this.dirty=!1,this.m=C&&C.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(C){C.m[0]=this.m[0],C.m[1]=this.m[1],C.m[2]=this.m[2],C.m[3]=this.m[3],C.m[4]=this.m[4],C.m[5]=this.m[5]}point(C){const N=this.m;return{x:N[0]*C.x+N[2]*C.y+N[4],y:N[1]*C.x+N[3]*C.y+N[5]}}translate(C,N){return this.m[4]+=this.m[0]*C+this.m[2]*N,this.m[5]+=this.m[1]*C+this.m[3]*N,this}scale(C,N){return this.m[0]*=C,this.m[1]*=C,this.m[2]*=N,this.m[3]*=N,this}rotate(C){const N=Math.cos(C),T=Math.sin(C),F=this.m[0]*N+this.m[2]*T,P=this.m[1]*N+this.m[3]*T,I=this.m[0]*-T+this.m[2]*N,D=this.m[1]*-T+this.m[3]*N;return this.m[0]=F,this.m[1]=P,this.m[2]=I,this.m[3]=D,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(C,N){const T=this.m[0]+this.m[2]*N,F=this.m[1]+this.m[3]*N,P=this.m[2]+this.m[0]*C,I=this.m[3]+this.m[1]*C;return this.m[0]=T,this.m[1]=F,this.m[2]=P,this.m[3]=I,this}multiply(C){const N=this.m[0]*C.m[0]+this.m[2]*C.m[1],T=this.m[1]*C.m[0]+this.m[3]*C.m[1],F=this.m[0]*C.m[2]+this.m[2]*C.m[3],P=this.m[1]*C.m[2]+this.m[3]*C.m[3],I=this.m[0]*C.m[4]+this.m[2]*C.m[5]+this.m[4],D=this.m[1]*C.m[4]+this.m[3]*C.m[5]+this.m[5];return this.m[0]=N,this.m[1]=T,this.m[2]=F,this.m[3]=P,this.m[4]=I,this.m[5]=D,this}invert(){const C=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*C,T=-this.m[1]*C,F=-this.m[2]*C,P=this.m[0]*C,I=C*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),D=C*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=T,this.m[2]=F,this.m[3]=P,this.m[4]=I,this.m[5]=D,this}getMatrix(){return this.m}decompose(){const C=this.m[0],N=this.m[1],T=this.m[2],F=this.m[3],P=this.m[4],I=this.m[5],D=C*F-N*T,U={x:P,y:I,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(C!=0||N!=0){const b=Math.sqrt(C*C+N*N);U.rotation=N>0?Math.acos(C/b):-Math.acos(C/b),U.scaleX=b,U.scaleY=D/b,U.skewX=(C*T+N*F)/D,U.skewY=0}else if(T!=0||F!=0){const b=Math.sqrt(T*T+F*F);U.rotation=Math.PI/2-(F>0?Math.acos(-T/b):-Math.acos(T/b)),U.scaleX=D/b,U.scaleY=b,U.skewX=0,U.skewY=(C*T+N*F)/D}return U.rotation=e.Util._getRotation(U.rotation),U}}e.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,u=180/Math.PI,f="#",d="",p="0",m="Konva warning: ",v="Konva error: ",g="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},k=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let E=[];const S=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(x){setTimeout(x,60)};e.Util={_isElement(x){return!!(x&&x.nodeType==1)},_isFunction(x){return!!(x&&x.constructor&&x.call&&x.apply)},_isPlainObject(x){return!!x&&x.constructor===Object},_isArray(x){return Object.prototype.toString.call(x)===n},_isNumber(x){return Object.prototype.toString.call(x)===i&&!isNaN(x)&&isFinite(x)},_isString(x){return Object.prototype.toString.call(x)===a},_isBoolean(x){return Object.prototype.toString.call(x)===s},isObject(x){return x instanceof Object},isValidSelector(x){if(typeof x!="string")return!1;const C=x[0];return C==="#"||C==="."||C===C.toUpperCase()},_sign(x){return x===0||x>0?1:-1},requestAnimFrame(x){E.push(x),E.length===1&&S(function(){const C=E;E=[],C.forEach(function(N){N()})})},createCanvasElement(){const x=document.createElement("canvas");try{x.style=x.style||{}}catch{}return x},createImageElement(){return document.createElement("img")},_isInDocument(x){for(;x=x.parentNode;)if(x==document)return!0;return!1},_urlToImage(x,C){const N=e.Util.createImageElement();N.onload=function(){C(N)},N.src=x},_rgbToHex(x,C,N){return((1<<24)+(x<<16)+(C<<8)+N).toString(16).slice(1)},_hexToRgb(x){x=x.replace(f,d);const C=parseInt(x,16);return{r:C>>16&255,g:C>>8&255,b:C&255}},getRandomColor(){let x=(Math.random()*16777215<<0).toString(16);for(;x.length<6;)x=p+x;return f+x},getRGB(x){let C;return x in _?(C=_[x],{r:C[0],g:C[1],b:C[2]}):x[0]===f?this._hexToRgb(x.substring(1)):x.substr(0,4)===g?(C=k.exec(x.replace(/ /g,"")),{r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}):{r:0,g:0,b:0}},colorToRGBA(x){return x=x||"black",e.Util._namedColorToRBA(x)||e.Util._hex3ColorToRGBA(x)||e.Util._hex4ColorToRGBA(x)||e.Util._hex6ColorToRGBA(x)||e.Util._hex8ColorToRGBA(x)||e.Util._rgbColorToRGBA(x)||e.Util._rgbaColorToRGBA(x)||e.Util._hslColorToRGBA(x)},_namedColorToRBA(x){const C=_[x.toLowerCase()];return C?{r:C[0],g:C[1],b:C[2],a:1}:null},_rgbColorToRGBA(x){if(x.indexOf("rgb(")===0){x=x.match(/rgb\(([^)]+)\)/)[1];const C=x.split(/ *, */).map(Number);return{r:C[0],g:C[1],b:C[2],a:1}}},_rgbaColorToRGBA(x){if(x.indexOf("rgba(")===0){x=x.match(/rgba\(([^)]+)\)/)[1];const C=x.split(/ *, */).map((N,T)=>N.slice(-1)==="%"?T===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:C[0],g:C[1],b:C[2],a:C[3]}}},_hex8ColorToRGBA(x){if(x[0]==="#"&&x.length===9)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:parseInt(x.slice(7,9),16)/255}},_hex6ColorToRGBA(x){if(x[0]==="#"&&x.length===7)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:1}},_hex4ColorToRGBA(x){if(x[0]==="#"&&x.length===5)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:parseInt(x[4]+x[4],16)/255}},_hex3ColorToRGBA(x){if(x[0]==="#"&&x.length===4)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:1}},_hslColorToRGBA(x){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(x)){const[C,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(x),T=Number(N[0])/360,F=Number(N[1])/100,P=Number(N[2])/100;let I,D,U;if(F===0)return U=P*255,{r:Math.round(U),g:Math.round(U),b:Math.round(U),a:1};P<.5?I=P*(1+F):I=P+F-P*F;const b=2*P-I,Q=[0,0,0];for(let he=0;he<3;he++)D=T+1/3*-(he-1),D<0&&D++,D>1&&D--,6*D<1?U=b+(I-b)*6*D:2*D<1?U=I:3*D<2?U=b+(I-b)*(2/3-D)*6:U=b,Q[he]=U*255;return{r:Math.round(Q[0]),g:Math.round(Q[1]),b:Math.round(Q[2]),a:1}}},haveIntersection(x,C){return!(C.x>x.x+x.width||C.x+C.width<x.x||C.y>x.y+x.height||C.y+C.height<x.y)},cloneObject(x){const C={};for(const N in x)this._isPlainObject(x[N])?C[N]=this.cloneObject(x[N]):this._isArray(x[N])?C[N]=this.cloneArray(x[N]):C[N]=x[N];return C},cloneArray(x){return x.slice(0)},degToRad(x){return x*o},radToDeg(x){return x*u},_degToRad(x){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(x)},_radToDeg(x){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(x)},_getRotation(x){return t.Konva.angleDeg?e.Util.radToDeg(x):x},_capitalize(x){return x.charAt(0).toUpperCase()+x.slice(1)},throw(x){throw new Error(v+x)},error(x){console.error(v+x)},warn(x){t.Konva.showWarnings&&console.warn(m+x)},each(x,C){for(const N in x)C(N,x[N])},_inRange(x,C,N){return C<=x&&x<N},_getProjectionToSegment(x,C,N,T,F,P){let I,D,U;const b=(x-N)*(x-N)+(C-T)*(C-T);if(b==0)I=x,D=C,U=(F-N)*(F-N)+(P-T)*(P-T);else{const Q=((F-x)*(N-x)+(P-C)*(T-C))/b;Q<0?(I=x,D=C,U=(x-F)*(x-F)+(C-P)*(C-P)):Q>1?(I=N,D=T,U=(N-F)*(N-F)+(T-P)*(T-P)):(I=x+Q*(N-x),D=C+Q*(T-C),U=(I-F)*(I-F)+(D-P)*(D-P))}return[I,D,U]},_getProjectionToLine(x,C,N){const T=e.Util.cloneObject(x);let F=Number.MAX_VALUE;return C.forEach(function(P,I){if(!N&&I===C.length-1)return;const D=C[(I+1)%C.length],U=e.Util._getProjectionToSegment(P.x,P.y,D.x,D.y,x.x,x.y),b=U[0],Q=U[1],he=U[2];he<F&&(T.x=b,T.y=Q,F=he)}),T},_prepareArrayForTween(x,C,N){const T=[],F=[];if(x.length>C.length){const I=C;C=x,x=I}for(let I=0;I<x.length;I+=2)T.push({x:x[I],y:x[I+1]});for(let I=0;I<C.length;I+=2)F.push({x:C[I],y:C[I+1]});const P=[];return F.forEach(function(I){const D=e.Util._getProjectionToLine(I,T,N);P.push(D.x),P.push(D.y)}),P},_prepareToStringify(x){let C;x.visitedByCircularReferenceRemoval=!0;for(const N in x)if(x.hasOwnProperty(N)&&x[N]&&typeof x[N]=="object"){if(C=Object.getOwnPropertyDescriptor(x,N),x[N].visitedByCircularReferenceRemoval||e.Util._isElement(x[N]))if(C.configurable)delete x[N];else return null;else if(e.Util._prepareToStringify(x[N])===null)if(C.configurable)delete x[N];else return null}return delete x.visitedByCircularReferenceRemoval,x},_assign(x,C){for(const N in C)x[N]=C[N];return x},_getFirstPointerId(x){return x.touches?x.changedTouches[0].identifier:x.pointerId||999},releaseCanvas(...x){t.Konva.releaseCanvasOnDestroy&&x.forEach(C=>{C.width=0,C.height=0})},drawRoundedRectPath(x,C,N,T){let F=0,P=0,I=0,D=0;typeof T=="number"?F=P=I=D=Math.min(T,C/2,N/2):(F=Math.min(T[0]||0,C/2,N/2),P=Math.min(T[1]||0,C/2,N/2),D=Math.min(T[2]||0,C/2,N/2),I=Math.min(T[3]||0,C/2,N/2)),x.moveTo(F,0),x.lineTo(C-P,0),x.arc(C-P,P,P,Math.PI*3/2,0,!1),x.lineTo(C,N-D),x.arc(C-D,N-D,D,0,Math.PI/2,!1),x.lineTo(I,N),x.arc(I,N-I,I,Math.PI/2,Math.PI,!1),x.lineTo(0,F),x.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(ir);var Jt={},Ki={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.HitContext=Ua.SceneContext=Ua.Context=void 0;const FS=ir,zD=ft;function VD(e){const t=[],r=e.length,n=FS.Util;for(let i=0;i<r;i++){let a=e[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),t.push(a)}return t}const O3=",",GD="(",HD=")",WD="([",$D="])",XD=";",KD="()",YD="=",b3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],QD=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],qD=100;class _h{constructor(t){this.canvas=t,zD.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,r){let n=this.traceArr,i=n.length,a="",s,o,u,f;for(s=0;s<i;s++)o=n[s],u=o.method,u?(f=o.args,a+=u,t?a+=KD:FS.Util._isArray(f[0])?a+=WD+f.join(O3)+$D:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=GD+f.join(O3)+HD)):(a+=o.property,t||(a+=YD+o.val)),a+=XD;return a}clearTrace(){this.traceArr=[]}_trace(t){let r=this.traceArr,n;r.push(t),n=r.length,n>=qD&&r.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const r=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(t){const r=t.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(t){const r=t.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(t){const r=t.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(t,r){this._context[t]=r}arc(t,r,n,i,a,s){this._context.arc(t,r,n,i,a,s)}arcTo(t,r,n,i,a){this._context.arcTo(t,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,r,n,i,a,s){this._context.bezierCurveTo(t,r,n,i,a,s)}clearRect(t,r,n,i){this._context.clearRect(t,r,n,i)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,r){const n=arguments;if(n.length===2)return this._context.createImageData(t,r);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,r,n,i){return this._context.createLinearGradient(t,r,n,i)}createPattern(t,r){return this._context.createPattern(t,r)}createRadialGradient(t,r,n,i,a,s){return this._context.createRadialGradient(t,r,n,i,a,s)}drawImage(t,r,n,i,a,s,o,u,f){const d=arguments,p=this._context;d.length===3?p.drawImage(t,r,n):d.length===5?p.drawImage(t,r,n,i,a):d.length===9&&p.drawImage(t,r,n,i,a,s,o,u,f)}ellipse(t,r,n,i,a,s,o,u){this._context.ellipse(t,r,n,i,a,s,o,u)}isPointInPath(t,r,n,i){return n?this._context.isPointInPath(n,t,r,i):this._context.isPointInPath(t,r,i)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,r,n,i){this._context.fillRect(t,r,n,i)}strokeRect(t,r,n,i){this._context.strokeRect(t,r,n,i)}fillText(t,r,n,i){i?this._context.fillText(t,r,n,i):this._context.fillText(t,r,n)}measureText(t){return this._context.measureText(t)}getImageData(t,r,n,i){return this._context.getImageData(t,r,n,i)}lineTo(t,r){this._context.lineTo(t,r)}moveTo(t,r){this._context.moveTo(t,r)}rect(t,r,n,i){this._context.rect(t,r,n,i)}roundRect(t,r,n,i,a){this._context.roundRect(t,r,n,i,a)}putImageData(t,r,n){this._context.putImageData(t,r,n)}quadraticCurveTo(t,r,n,i){this._context.quadraticCurveTo(t,r,n,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,r){this._context.scale(t,r)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,r,n,i,a,s){this._context.setTransform(t,r,n,i,a,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,r,n,i){this._context.strokeText(t,r,n,i)}transform(t,r,n,i,a,s){this._context.transform(t,r,n,i,a,s)}translate(t,r){this._context.translate(t,r)}_enableTrace(){let t=this,r=b3.length,n=this.setAttr,i,a;const s=function(o){let u=t[o],f;t[o]=function(){return a=VD(Array.prototype.slice.call(arguments,0)),f=u.apply(t,arguments),t._trace({method:o,args:a}),f}};for(i=0;i<r;i++)s(b3[i]);t.setAttr=function(){n.apply(t,arguments);const o=arguments[0];let u=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:o,val:u})}}_applyGlobalCompositeOperation(t){const r=t.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ua.Context=_h;QD.forEach(function(e){Object.defineProperty(_h.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});class JD extends _h{constructor(t,{willReadFrequently:r=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(t){const r=t.fill();this.setAttr("fillStyle",r),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const r=t._getLinearGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fillRadialGradient(t){const r=t._getRadialGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fill(t){const r=t.fill(),n=t.getFillPriority();if(r&&n==="color"){this._fillColor(t);return}const i=t.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(t);return}const a=t.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(t);return}const s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}r?this._fillColor(t):i?this._fillPattern(t):a?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const r=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(t){const r=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),r&&t.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var r,n,i;const a=(r=t.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=t.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=u.x*f,p=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(p))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*p)}}Ua.SceneContext=JD;class ZD extends _h{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),i=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}Ua.HitContext=ZD;Object.defineProperty(Ki,"__esModule",{value:!0});Ki.HitCanvas=Ki.SceneCanvas=Ki.Canvas=void 0;const Gd=ir,NS=Ua,RS=ft;let Uf;function eO(){if(Uf)return Uf;const e=Gd.Util.createCanvasElement(),t=e.getContext("2d");return Uf=function(){const r=RS.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return r/n}(),Gd.Util.releaseCanvas(e),Uf}class px{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||RS.Konva.pixelRatio||eO();this.pixelRatio=n,this._canvas=Gd.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const r=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,r){this.setWidth(t||0),this.setHeight(r||0)}toDataURL(t,r){try{return this._canvas.toDataURL(t,r)}catch{try{return this._canvas.toDataURL()}catch(i){return Gd.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Ki.Canvas=px;class tO extends px{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new NS.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Ki.SceneCanvas=tO;class rO extends px{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new NS.HitContext(this),this.setSize(t.width,t.height)}}Ki.HitCanvas=rO;var Sh={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=ft,r=ir;e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];e.DD._dragElements.forEach((a,s)=>{const{node:o}=a,u=o.getStage();u.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=u._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];e.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(Sh);var pt={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.RGBComponent=nO;rt.alphaComponent=iO;rt.getNumberValidator=aO;rt.getNumberOrArrayOfNumbersValidator=sO;rt.getNumberOrAutoValidator=oO;rt.getStringValidator=lO;rt.getStringOrGradientValidator=cO;rt.getFunctionValidator=uO;rt.getNumberArrayValidator=fO;rt.getBooleanValidator=dO;rt.getComponentValidator=hO;const Ka=ft,or=ir;function Ya(e){return or.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||or.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function nO(e){return e>255?255:e<0?0:Math.round(e)}function iO(e){return e>1?1:e<1e-4?1e-4:e}function aO(){if(Ka.Konva.isUnminified)return function(e,t){return or.Util._isNumber(e)||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function sO(e){if(Ka.Konva.isUnminified)return function(t,r){let n=or.Util._isNumber(t),i=or.Util._isArray(t)&&t.length==e;return!n&&!i&&or.Util.warn(Ya(t)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function oO(){if(Ka.Konva.isUnminified)return function(e,t){return or.Util._isNumber(e)||e==="auto"||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function lO(){if(Ka.Konva.isUnminified)return function(e,t){return or.Util._isString(e)||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function cO(){if(Ka.Konva.isUnminified)return function(e,t){const r=or.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return r||n||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function uO(){if(Ka.Konva.isUnminified)return function(e,t){return or.Util._isFunction(e)||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function fO(){if(Ka.Konva.isUnminified)return function(e,t){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&e instanceof r||(or.Util._isArray(e)?e.forEach(function(n){or.Util._isNumber(n)||or.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function dO(){if(Ka.Konva.isUnminified)return function(e,t){return e===!0||e===!1||or.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function hO(e){if(Ka.Konva.isUnminified)return function(t,r){return t==null||or.Util.isObject(t)||or.Util.warn(Ya(t)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+e),t}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=ir,r=rt,n="get",i="set";e.Factory={addGetterSetter(a,s,o,u,f){e.Factory.addGetter(a,s,o),e.Factory.addSetter(a,s,u,f),e.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const u=n+t.Util._capitalize(s);a.prototype[u]=a.prototype[u]||function(){const f=this.attrs[s];return f===void 0?o:f}},addSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]||e.Factory.overWriteSetter(a,s,o,u)},overWriteSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,s)),this._setAttr(s,d),u&&u.call(this),this}},addComponentsGetterSetter(a,s,o,u,f){const d=o.length,p=t.Util._capitalize,m=n+p(s),v=i+p(s);a.prototype[m]=function(){const _={};for(let k=0;k<d;k++){const E=o[k];_[E]=this.getAttr(s+p(E))}return _};const g=(0,r.getComponentValidator)(o);a.prototype[v]=function(_){const k=this.attrs[s];u&&(_=u.call(this,_,s)),g&&g.call(this,_,s);for(const E in _)_.hasOwnProperty(E)&&this._setAttr(s+p(E),_[E]);return _||o.forEach(E=>{this._setAttr(s+p(E),void 0)}),this._fireChangeEvent(s,k,_),f&&f.call(this),this},e.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=t.Util._capitalize(s),u=i+o,f=n+o;a.prototype[s]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,o,u){t.Util.error("Adding deprecated "+s);const f=n+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){t.Util.error(d);const p=this.attrs[s];return p===void 0?o:p},e.Factory.addSetter(a,s,u,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){t.Util.each(s,function(o,u){const f=a.prototype[u],d=n+t.Util._capitalize(o),p=i+t.Util._capitalize(o);function m(){f.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}a.prototype[o]=m,a.prototype[d]=m,a.prototype[p]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(pt);Object.defineProperty(Jt,"__esModule",{value:!0});Jt.Node=void 0;const cl=Ki,gi=Sh,pu=pt,cs=ft,yt=ir,hr=rt,rd="absoluteOpacity",jf="allEventListeners",Pa="absoluteTransform",L3="absoluteScale",ao="canvas",pO="Change",gO="children",mO="konva",Im="listening",xO="mouseenter",vO="mouseleave",yO="pointerenter",_O="pointerleave",SO="touchenter",wO="touchleave",M3="set",B3="Shape",nd=" ",U3="stage",us="transform",kO="Stage",Dm="visible",EO=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(nd);let CO=1;class at{constructor(t){this._id=CO++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===us||t===Pa)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,r){let n=this._cache.get(t);return(n===void 0||(t===us||t===Pa)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(t,n)),n}_calculate(t,r,n){if(!this._attachedDepsListeners.get(t)){const i=r.map(a=>a+"Change.konva").join(nd);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(ao)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Pa&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ao)){const{scene:t,filter:r,hit:n,buffer:i}=this._cache.get(ao);yt.Util.releaseCanvas(t,r,n,i),this._cache.delete(ao)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const r=t||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,u=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,p=r.hitCanvasPixelRatio||1;if(!i||!a){yt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const m=Math.abs(Math.round(n.x)-o)>.5?1:0,v=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+m,a+=f*2+v,o-=f,u-=f;const g=new cl.SceneCanvas({pixelRatio:s,width:i,height:a}),_=new cl.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),k=new cl.HitCanvas({pixelRatio:p,width:i,height:a}),E=g.getContext(),S=k.getContext(),x=new cl.SceneCanvas({width:g.width/g.pixelRatio+Math.abs(o),height:g.height/g.pixelRatio+Math.abs(u),pixelRatio:g.pixelRatio}),C=x.getContext();return k.isCache=!0,g.isCache=!0,this._cache.delete(ao),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,_.getContext()._context.imageSmoothingEnabled=!1),E.save(),S.save(),C.save(),E.translate(-o,-u),S.translate(-o,-u),C.translate(-o,-u),x.x=o,x.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(rd),this._clearSelfAndDescendantCache(L3),this.drawScene(g,this,x),this.drawHit(k,this),this._isUnderCache=!1,E.restore(),S.restore(),d&&(E.save(),E.beginPath(),E.rect(0,0,i,a),E.closePath(),E.setAttr("strokeStyle","red"),E.setAttr("lineWidth",5),E.stroke(),E.restore()),this._cache.set(ao,{scene:g,filter:_,hit:k,buffer:x,x:o,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(ao)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,r){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const u=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=u.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();t.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()}_drawCachedHitCanvas(t){const r=this._getCanvasCache(),n=r.hit;t.save(),t.translate(r.x,r.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,u,f;if(t){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<s;u++){if(f=t[u],typeof f!="function"){yt.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,o),a.putImageData(o,0,0)}}catch(p){yt.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(t,r){if(this._cache&&this._cache.delete(jf),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(nd);for(let i=0;i<n.length;i++){const s=n[i].split("."),o=s[0],u=s[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:u,handler:r})}return this}off(t,r){let n=(t||"").split(nd),i=n.length,a,s,o,u,f,d;if(this._cache&&this._cache.delete(jf),!t)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],u=o.split("."),f=u[0],d=u[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(t){const r={target:this,type:t.type,evt:t};return this.fire(t.type,r),this}addEventListener(t,r){return this.on(t,function(n){r.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,r,n){const i=this;this.on(t,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=yt.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),gi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Pa),this._clearSelfAndDescendantCache(rd),this._clearSelfAndDescendantCache(L3),this._clearSelfAndDescendantCache(U3),this._clearSelfAndDescendantCache(Dm),this._clearSelfAndDescendantCache(Im)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const r="get"+yt.Util._capitalize(t);return yt.Util._isFunction(this[r])?this[r]():this.attrs[t]}getAncestors(){let t=this.getParent(),r=[];for(;t;)r.push(t),t=t.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let r,n;if(!t)return this;for(r in t)r!==gO&&(n=M3+yt.Util._capitalize(r),yt.Util._isFunction(this[n])?this[n](t[r]):this._setAttr(r,t[r]))}),this}isListening(){return this._getCache(Im,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Dm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,r=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let i=!1;gi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!cs.Konva.hitOnDragEnabled&&(i||cs.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),r=this,n=0,i,a,s,o;function u(d){for(i=[],a=d.length,s=0;s<a;s++)o=d[s],n++,o.nodeType!==B3&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=t&&u(i)}const f=this.getStage();return r.nodeType!==kO&&f&&u(f.getChildren()),n}getDepth(){let t=0,r=this.parent;for(;r;)t++,r=r.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(us),this._clearSelfAndDescendantCache(Pa)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const r=t.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(t){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!t&&(t=!0);const i=this.getAbsoluteTransform(t).getMatrix(),a=new yt.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(t){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(us);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:t.x,y:t.y}),this._clearCache(us),this._clearSelfAndDescendantCache(Pa),this}_setTransform(t){let r;for(r in t)this.attrs[r]=t[r]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let r=t.x,n=t.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(t,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return yt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return yt.Util.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return yt.Util.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return yt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return yt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&yt.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(rd,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(t*=r.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in t)n=t[r],s=yt.Util.isObject(n)&&!yt.Util._isPlainObject(n)&&!yt.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete t[r],a=i?i.call(this):null,t[r]=n,a!==n&&(o.attrs[r]=n));return yt.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,r,n){const i=[];r&&this._isMatch(t)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent}return i}isAncestorOf(t){return!1}findAncestor(t,r,n){return this.findAncestors(t,r,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let r=t.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],yt.Util.isValidSelector(a)||(yt.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),yt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),yt.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(U3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,r={},n){return r.target=r.target||this,n?this._fireAndBubble(t,r):this._fire(t,r),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Pa,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let r;if(t)return r=new yt.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),r;{r=this._cache.get(Pa)||new yt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(t){let r=this;for(;r;)r._isUnderCache&&(t=r),r=r.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(us,this._getTransform)}_getTransform(){var t,r;const n=this._cache.get(us)||new yt.Transform;n.reset();const i=this.x(),a=this.y(),s=cs.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,p=this.attrs.offsetX||0,m=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(o!==1||u!==1)&&n.scale(o,u),(p!==0||m!==0)&&n.translate(-1*p,-1*m),n.dirty=!1,n}clone(t){let r=yt.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in t)r[n]=t[n];const u=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(mO)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(o));return u}_toKonvaCanvas(t){t=t||{};const r=this.getClientRect(),n=this.getStage(),i=t.x!==void 0?t.x:Math.floor(r.x),a=t.y!==void 0?t.y:Math.floor(r.y),s=t.pixelRatio||1,o=new cl.SceneCanvas({width:t.width||Math.ceil(r.width)||(n?n.width():0),height:t.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),u=o.getContext(),f=new cl.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||a)&&u.translate(-1*i,-1*a),this.drawScene(o,void 0,f),u.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const r=t.mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(r,n);return t.callback&&t.callback(i),i}toImage(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,yt.Util._urlToImage(this.toDataURL(t),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob(a=>{r(a),i==null||i(a)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(i){n(i)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():cs.Konva.dragDistance}_off(t,r,n){let i=this.eventListeners[t],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,r,n){this._fire(t+pO,{oldVal:r,newVal:n})}addName(t){if(!this.hasName(t)){const r=this.name(),n=r?r+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const r=(this.name()||"").split(/\s/g),n=r.indexOf(t);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(t,r){const n=this[M3+yt.Util._capitalize(t)];return yt.Util._isFunction(n)?n.call(this,r):this._setAttr(t,r),this}_requestDraw(){if(cs.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,r){const n=this.attrs[t];n===r&&!yt.Util.isObject(r)||(r==null?delete this.attrs[t]:this.attrs[t]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,r),this._requestDraw())}_setComponentAttr(t,r,n){let i;n!==void 0&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][r]=n,this._fireChangeEvent(t,i,n))}_fireAndBubble(t,r,n){r&&this.nodeType===B3&&(r.target=this);const i=[xO,vO,yO,_O,SO,wO];if(!(i.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,r);const s=i.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,r,n):this._fireAndBubble.call(this.parent,t,r))}}_getProtoListeners(t){var r,n,i;const a=(r=this._cache.get(jf))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[t];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const u=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[t])!==null&&i!==void 0?i:[];s.push(...u),o=Object.getPrototypeOf(o)}a[t]=s,this._cache.set(jf,a)}return s}_fire(t,r){r=r||{},r.currentTarget=this,r.type=t;const n=this._getProtoListeners(t);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[t];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const r=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;gi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(t,r=!0){gi.DD._dragElements.has(this._id)||this._createDragElement(t);const n=gi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},r)}_setDragPosition(t,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,t);s?i=s:yt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(t){const r=gi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),gi.DD._endDragBefore(t),gi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=gi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||cs.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let i=!1;gi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=gi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&gi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-t.x,y:-t.y,width:r.width()+2*t.x,height:r.height()+2*t.y};return yt.Util.haveIntersection(n,this.getClientRect())}static create(t,r){return yt.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,r)}static _createNode(t,r){let n=at.prototype.getClassName.call(t),i=t.children,a,s,o;r&&(t.attrs.container=r),cs.Konva[n]||(yt.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=cs.Konva[n];if(a=new u(t.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(at._createNode(i[o]));return a}}Jt.Node=at;at.prototype.nodeType="Node";at.prototype._attrsAffectingSize=[];at.prototype.eventListeners={};at.prototype.on.call(at.prototype,EO,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(us),this._clearSelfAndDescendantCache(Pa)});at.prototype.on.call(at.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Dm)});at.prototype.on.call(at.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Im)});at.prototype.on.call(at.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(rd)});const Vt=pu.Factory.addGetterSetter;Vt(at,"zIndex");Vt(at,"absolutePosition");Vt(at,"position");Vt(at,"x",0,(0,hr.getNumberValidator)());Vt(at,"y",0,(0,hr.getNumberValidator)());Vt(at,"globalCompositeOperation","source-over",(0,hr.getStringValidator)());Vt(at,"opacity",1,(0,hr.getNumberValidator)());Vt(at,"name","",(0,hr.getStringValidator)());Vt(at,"id","",(0,hr.getStringValidator)());Vt(at,"rotation",0,(0,hr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(at,"scale",["x","y"]);Vt(at,"scaleX",1,(0,hr.getNumberValidator)());Vt(at,"scaleY",1,(0,hr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(at,"skew",["x","y"]);Vt(at,"skewX",0,(0,hr.getNumberValidator)());Vt(at,"skewY",0,(0,hr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(at,"offset",["x","y"]);Vt(at,"offsetX",0,(0,hr.getNumberValidator)());Vt(at,"offsetY",0,(0,hr.getNumberValidator)());Vt(at,"dragDistance",void 0,(0,hr.getNumberValidator)());Vt(at,"width",0,(0,hr.getNumberValidator)());Vt(at,"height",0,(0,hr.getNumberValidator)());Vt(at,"listening",!0,(0,hr.getBooleanValidator)());Vt(at,"preventDefault",!0,(0,hr.getBooleanValidator)());Vt(at,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Vt(at,"visible",!0,(0,hr.getBooleanValidator)());Vt(at,"transformsEnabled","all",(0,hr.getStringValidator)());Vt(at,"size");Vt(at,"dragBoundFunc");Vt(at,"draggable",!1,(0,hr.getBooleanValidator)());pu.Factory.backCompat(at,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.Container=void 0;const sc=pt,fg=Jt,wh=rt;class Bo extends fg.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){const r=this.children||[];return t?r.filter(t):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const r=this._generalFind(t,!0);return r.length>0?r[0]:void 0}_generalFind(t,r){const n=[];return this._descendants(i=>{const a=i._isMatch(t);return a&&n.push(i),!!(a&&r)}),n}_descendants(t){let r=!1;const n=this.getChildren();for(const i of n){if(r=t(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(t),r))return!0}return!1}toObject(){const t=fg.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(r=>{t.children.push(r.toObject())}),t}isAncestorOf(t){let r=t.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(t){const r=fg.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(t){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&r.push(n)}),r}_clearSelfAndDescendantCache(t){var r;super._clearSelfAndDescendantCache(t),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),u=o&&o.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(t,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const u=this.getAbsoluteTransform(r).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(t,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),d=typeof o=="number"&&typeof u=="number"||f,p=n===this;if(d){s.save();const v=this.getAbsoluteTransform(n);let g=v.getMatrix();s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),s.beginPath();let _;if(f)_=f.call(this,s,this);else{const k=this.clipX(),E=this.clipY();s.rect(k||0,E||0,o,u)}s.clip.apply(s,_),g=v.copy().invert().getMatrix(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const m=!p&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";m&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(v){v[t](r,n,i)}),m&&s.restore(),d&&s.restore()}getClientRect(t={}){var r;const n=t.skipTransform,i=t.relativeTo;let a,s,o,u,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(v){if(!v.visible())return;const g=v.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});g.width===0&&g.height===0||(a===void 0?(a=g.x,s=g.y,o=g.x+g.width,u=g.y+g.height):(a=Math.min(a,g.x),s=Math.min(s,g.y),o=Math.max(o,g.x+g.width),u=Math.max(u,g.y+g.height)))});const p=this.find("Shape");let m=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){m=!0;break}return m&&a!==void 0?f={x:a,y:s,width:o-a,height:u-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}Mo.Container=Bo;sc.Factory.addComponentsGetterSetter(Bo,"clip",["x","y","width","height"]);sc.Factory.addGetterSetter(Bo,"clipX",void 0,(0,wh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipY",void 0,(0,wh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipWidth",void 0,(0,wh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipHeight",void 0,(0,wh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipFunc");var IS={},js={};Object.defineProperty(js,"__esModule",{value:!0});js.getCapturedShape=AO;js.createEvent=gx;js.hasPointerCapture=PO;js.setPointerCapture=FO;js.releaseCapture=OS;const TO=ft,eu=new Map,DS=TO.Konva._global.PointerEvent!==void 0;function AO(e){return eu.get(e)}function gx(e){return{evt:e,pointerId:e.pointerId}}function PO(e,t){return eu.get(e)===t}function FO(e,t){OS(e),t.getStage()&&(eu.set(e,t),DS&&t._fire("gotpointercapture",gx(new PointerEvent("gotpointercapture"))))}function OS(e,t){const r=eu.get(e);if(!r)return;const n=r.getStage();n&&n.content,eu.delete(e),DS&&r._fire("lostpointercapture",gx(new PointerEvent("lostpointercapture")))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=ir,r=pt,n=Mo,i=ft,a=Ki,s=Sh,o=ft,u=js,f="Stage",d="string",p="px",m="mouseout",v="mouseleave",g="mouseover",_="mouseenter",k="mousemove",E="mousedown",S="mouseup",x="pointermove",C="pointerdown",N="pointerup",T="pointercancel",F="lostpointercapture",P="pointerout",I="pointerleave",D="pointerover",U="pointerenter",b="contextmenu",Q="touchstart",he="touchend",te="touchmove",Ae="touchcancel",Te="wheel",ie=5,X=[[_,"_pointerenter"],[E,"_pointerdown"],[k,"_pointermove"],[S,"_pointerup"],[v,"_pointerleave"],[Q,"_pointerdown"],[te,"_pointermove"],[he,"_pointerup"],[Ae,"_pointercancel"],[g,"_pointerover"],[Te,"_wheel"],[b,"_contextmenu"],[C,"_pointerdown"],[x,"_pointermove"],[N,"_pointerup"],[T,"_pointercancel"],[I,"_pointerleave"],[F,"_lostpointercapture"]],ce={mouse:{[P]:m,[I]:v,[D]:g,[U]:_,[x]:k,[C]:E,[N]:S,[T]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[P]:"touchout",[I]:"touchleave",[D]:"touchover",[U]:"touchenter",[x]:te,[C]:Q,[N]:he,[T]:Ae,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[P]:P,[I]:I,[D]:D,[U]:U,[x]:x,[C]:C,[N]:N,[T]:T,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Ce=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",L=de=>{const G=Ce(de);if(G==="pointer")return i.Konva.pointerEventsEnabled&&ce.pointer;if(G==="touch")return ce.touch;if(G==="mouse")return ce.mouse};function q(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class K extends n.Container{constructor(G){super(q(G)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{q(this.attrs)}),this._checkVisibility()}_validateAdd(G){const J=G.getType()==="Layer",ue=G.getType()==="FastLayer";J||ue||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const G=this.visible()?"":"none";this.content.style.display=G}setContainer(G){if(typeof G===d){let J;if(G.charAt(0)==="."){const ue=G.slice(1);G=document.getElementsByClassName(ue)[0]}else G.charAt(0)!=="#"?J=G:J=G.slice(1),G=document.getElementById(J);if(!G)throw"Can not find container in document with id "+J}return this._setAttr("container",G),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),G.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const G=this.children,J=G.length;for(let ue=0;ue<J;ue++)G[ue].clear();return this}clone(G){return G||(G={}),G.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,G)}destroy(){super.destroy();const G=this.content;G&&t.Util._isInDocument(G)&&this.container().removeChild(G);const J=e.stages.indexOf(this);return J>-1&&e.stages.splice(J,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const G=this._pointerPositions[0]||this._changedPointerPositions[0];return G?{x:G.x,y:G.y}:(t.Util.warn(Y),null)}_getPointerById(G){return this._pointerPositions.find(J=>J.id===G)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(G){G=G||{},G.x=G.x||0,G.y=G.y||0,G.width=G.width||this.width(),G.height=G.height||this.height();const J=new a.SceneCanvas({width:G.width,height:G.height,pixelRatio:G.pixelRatio||1}),ue=J.getContext()._context,ve=this.children;return(G.x||G.y)&&ue.translate(-1*G.x,-1*G.y),ve.forEach(function(Be){if(!Be.isVisible())return;const V=Be._toKonvaCanvas(G);ue.drawImage(V._canvas,G.x,G.y,V.getWidth()/V.getPixelRatio(),V.getHeight()/V.getPixelRatio())}),J}getIntersection(G){if(!G)return null;const J=this.children,ue=J.length,ve=ue-1;for(let Be=ve;Be>=0;Be--){const V=J[Be].getIntersection(G);if(V)return V}return null}_resizeDOM(){const G=this.width(),J=this.height();this.content&&(this.content.style.width=G+p,this.content.style.height=J+p),this.bufferCanvas.setSize(G,J),this.bufferHitCanvas.setSize(G,J),this.children.forEach(ue=>{ue.setSize({width:G,height:J}),ue.draw()})}add(G,...J){if(arguments.length>1){for(let ve=0;ve<arguments.length;ve++)this.add(arguments[ve]);return this}super.add(G);const ue=this.children.length;return ue>ie&&t.Util.warn("The stage has "+ue+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),G.setSize({width:this.width(),height:this.height()}),G.draw(),i.Konva.isBrowser&&this.content.appendChild(G.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(G){return u.hasPointerCapture(G,this)}setPointerCapture(G){u.setPointerCapture(G,this)}releaseCapture(G){u.releaseCapture(G,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([G,J])=>{this.content.addEventListener(G,ue=>{this[J](ue)},{passive:!1})})}_pointerenter(G){this.setPointersPositions(G);const J=L(G.type);J&&this._fire(J.pointerenter,{evt:G,target:this,currentTarget:this})}_pointerover(G){this.setPointersPositions(G);const J=L(G.type);J&&this._fire(J.pointerover,{evt:G,target:this,currentTarget:this})}_getTargetShape(G){let J=this[G+"targetShape"];return J&&!J.getStage()&&(J=null),J}_pointerleave(G){const J=L(G.type),ue=Ce(G.type);if(!J)return;this.setPointersPositions(G);const ve=this._getTargetShape(ue),Be=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;ve&&Be?(ve._fireAndBubble(J.pointerout,{evt:G}),ve._fireAndBubble(J.pointerleave,{evt:G}),this._fire(J.pointerleave,{evt:G,target:this,currentTarget:this}),this[ue+"targetShape"]=null):Be&&(this._fire(J.pointerleave,{evt:G,target:this,currentTarget:this}),this._fire(J.pointerout,{evt:G,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(G){const J=L(G.type),ue=Ce(G.type);if(!J)return;this.setPointersPositions(G);let ve=!1;this._changedPointerPositions.forEach(Be=>{const V=this.getIntersection(Be);if(s.DD.justDragged=!1,i.Konva["_"+ue+"ListenClick"]=!0,!V||!V.isListening()){this[ue+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&V.setPointerCapture(Be.id),this[ue+"ClickStartShape"]=V,V._fireAndBubble(J.pointerdown,{evt:G,pointerId:Be.id}),ve=!0;const Ze=G.type.indexOf("touch")>=0;V.preventDefault()&&G.cancelable&&Ze&&G.preventDefault()}),ve||this._fire(J.pointerdown,{evt:G,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(G){const J=L(G.type),ue=Ce(G.type);if(!J||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&G.cancelable&&G.preventDefault(),this.setPointersPositions(G),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Be={};let V=!1;const Ze=this._getTargetShape(ue);this._changedPointerPositions.forEach(nt=>{const Ye=u.getCapturedShape(nt.id)||this.getIntersection(nt),Je=nt.id,Re={evt:G,pointerId:Je},wt=Ze!==Ye;if(wt&&Ze&&(Ze._fireAndBubble(J.pointerout,{...Re},Ye),Ze._fireAndBubble(J.pointerleave,{...Re},Ye)),Ye){if(Be[Ye._id])return;Be[Ye._id]=!0}Ye&&Ye.isListening()?(V=!0,wt&&(Ye._fireAndBubble(J.pointerover,{...Re},Ze),Ye._fireAndBubble(J.pointerenter,{...Re},Ze),this[ue+"targetShape"]=Ye),Ye._fireAndBubble(J.pointermove,{...Re})):Ze&&(this._fire(J.pointerover,{evt:G,target:this,currentTarget:this,pointerId:Je}),this[ue+"targetShape"]=null)}),V||this._fire(J.pointermove,{evt:G,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(G){const J=L(G.type),ue=Ce(G.type);if(!J)return;this.setPointersPositions(G);const ve=this[ue+"ClickStartShape"],Be=this[ue+"ClickEndShape"],V={};let Ze=!1;this._changedPointerPositions.forEach(nt=>{const Ye=u.getCapturedShape(nt.id)||this.getIntersection(nt);if(Ye){if(Ye.releaseCapture(nt.id),V[Ye._id])return;V[Ye._id]=!0}const Je=nt.id,Re={evt:G,pointerId:Je};let wt=!1;i.Konva["_"+ue+"InDblClickWindow"]?(wt=!0,clearTimeout(this[ue+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+ue+"InDblClickWindow"]=!0,clearTimeout(this[ue+"DblTimeout"])),this[ue+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ue+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Ye&&Ye.isListening()?(Ze=!0,this[ue+"ClickEndShape"]=Ye,Ye._fireAndBubble(J.pointerup,{...Re}),i.Konva["_"+ue+"ListenClick"]&&ve&&ve===Ye&&(Ye._fireAndBubble(J.pointerclick,{...Re}),wt&&Be&&Be===Ye&&Ye._fireAndBubble(J.pointerdblclick,{...Re}))):(this[ue+"ClickEndShape"]=null,i.Konva["_"+ue+"ListenClick"]&&this._fire(J.pointerclick,{evt:G,target:this,currentTarget:this,pointerId:Je}),wt&&this._fire(J.pointerdblclick,{evt:G,target:this,currentTarget:this,pointerId:Je}))}),Ze||this._fire(J.pointerup,{evt:G,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ue+"ListenClick"]=!1,G.cancelable&&ue!=="touch"&&ue!=="pointer"&&G.preventDefault()}_contextmenu(G){this.setPointersPositions(G);const J=this.getIntersection(this.getPointerPosition());J&&J.isListening()?J._fireAndBubble(b,{evt:G}):this._fire(b,{evt:G,target:this,currentTarget:this})}_wheel(G){this.setPointersPositions(G);const J=this.getIntersection(this.getPointerPosition());J&&J.isListening()?J._fireAndBubble(Te,{evt:G}):this._fire(Te,{evt:G,target:this,currentTarget:this})}_pointercancel(G){this.setPointersPositions(G);const J=u.getCapturedShape(G.pointerId)||this.getIntersection(this.getPointerPosition());J&&J._fireAndBubble(N,u.createEvent(G)),u.releaseCapture(G.pointerId)}_lostpointercapture(G){u.releaseCapture(G.pointerId)}setPointersPositions(G){const J=this._getContentPosition();let ue=null,ve=null;G=G||window.event,G.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(G.touches,Be=>{this._pointerPositions.push({id:Be.identifier,x:(Be.clientX-J.left)/J.scaleX,y:(Be.clientY-J.top)/J.scaleY})}),Array.prototype.forEach.call(G.changedTouches||G.touches,Be=>{this._changedPointerPositions.push({id:Be.identifier,x:(Be.clientX-J.left)/J.scaleX,y:(Be.clientY-J.top)/J.scaleY})})):(ue=(G.clientX-J.left)/J.scaleX,ve=(G.clientY-J.top)/J.scaleY,this.pointerPos={x:ue,y:ve},this._pointerPositions=[{x:ue,y:ve,id:t.Util._getFirstPointerId(G)}],this._changedPointerPositions=[{x:ue,y:ve,id:t.Util._getFirstPointerId(G)}])}_setPointerPosition(G){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(G)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const G=this.content.getBoundingClientRect();return{top:G.top,left:G.left,scaleX:G.width/this.content.clientWidth||1,scaleY:G.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const G=this.container();if(!G)throw"Stage has no container. A container is required.";G.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),G.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(G){G.batchDraw()}),this}}e.Stage=K,K.prototype.nodeType=f,(0,o._registerNode)(K),r.Factory.addGetterSetter(K,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(de=>{de.batchDraw()})})})(IS);var gu={},Ir={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=ft,r=ir,n=pt,i=Jt,a=rt,s=ft,o=js,u="hasShadow",f="shadowRGBA",d="patternImage",p="linearGradient",m="radialGradient";let v;function g(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}e.shapes={};function _(I){const D=this.attrs.fillRule;D?I.fill(D):I.fill()}function k(I){I.stroke()}function E(I){const D=this.attrs.fillRule;D?I.fill(D):I.fill()}function S(I){I.stroke()}function x(){this._clearCache(u)}function C(){this._clearCache(f)}function N(){this._clearCache(d)}function T(){this._clearCache(p)}function F(){this._clearCache(m)}class P extends i.Node{constructor(D){super(D);let U;for(;U=r.Util.getRandomColor(),!(U&&!(U in e.shapes)););this.colorKey=U,e.shapes[U]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const U=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(U&&U.setTransform){const b=new r.Transform;b.translate(this.fillPatternX(),this.fillPatternY()),b.rotate(t.Konva.getAngle(this.fillPatternRotation())),b.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),b.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Q=b.getMatrix(),he=typeof DOMMatrix>"u"?{a:Q[0],b:Q[1],c:Q[2],d:Q[3],e:Q[4],f:Q[5]}:new DOMMatrix(Q);U.setTransform(he)}return U}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const D=this.fillLinearGradientColorStops();if(D){const U=g(),b=this.fillLinearGradientStartPoint(),Q=this.fillLinearGradientEndPoint(),he=U.createLinearGradient(b.x,b.y,Q.x,Q.y);for(let te=0;te<D.length;te+=2)he.addColorStop(D[te],D[te+1]);return he}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const D=this.fillRadialGradientColorStops();if(D){const U=g(),b=this.fillRadialGradientStartPoint(),Q=this.fillRadialGradientEndPoint(),he=U.createRadialGradient(b.x,b.y,this.fillRadialGradientStartRadius(),Q.x,Q.y,this.fillRadialGradientEndRadius());for(let te=0;te<D.length;te+=2)he.addColorStop(D[te],D[te+1]);return he}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const D=r.Util.colorToRGBA(this.shadowColor());if(D)return"rgba("+D.r+","+D.g+","+D.b+","+D.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const D=this.hitStrokeWidth();return D==="auto"?this.hasStroke():this.strokeEnabled()&&!!D}intersects(D){const U=this.getStage();if(!U)return!1;const b=U.bufferHitCanvas;return b.getContext().clear(),this.drawHit(b,void 0,!0),b.context.getImageData(Math.round(D.x),Math.round(D.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(D){var U;if(!((U=this.attrs.perfectDrawEnabled)!==null&&U!==void 0?U:!0))return!1;const Q=D||this.hasFill(),he=this.hasStroke(),te=this.getAbsoluteOpacity()!==1;if(Q&&he&&te)return!0;const Ae=this.hasShadow(),Te=this.shadowForStrokeEnabled();return!!(Q&&he&&Ae&&Te)}setStrokeHitEnabled(D){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),D?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const D=this.size();return{x:this._centroid?-D.width/2:0,y:this._centroid?-D.height/2:0,width:D.width,height:D.height}}getClientRect(D={}){let U=!1,b=this.getParent();for(;b;){if(b.isCached()){U=!0;break}b=b.getParent()}const Q=D.skipTransform,he=D.relativeTo||U&&this.getStage()||void 0,te=this.getSelfRect(),Te=!D.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,ie=te.width+Te,X=te.height+Te,ce=!D.skipShadow&&this.hasShadow(),Ce=ce?this.shadowOffsetX():0,L=ce?this.shadowOffsetY():0,q=ie+Math.abs(Ce),Y=X+Math.abs(L),K=ce&&this.shadowBlur()||0,de=q+K*2,G=Y+K*2,J={width:de,height:G,x:-(Te/2+K)+Math.min(Ce,0)+te.x,y:-(Te/2+K)+Math.min(L,0)+te.y};return Q?J:this._transformedRect(J,he)}drawScene(D,U,b){const Q=this.getLayer(),he=D||Q.getCanvas(),te=he.getContext(),Ae=this._getCanvasCache(),Te=this.getSceneFunc(),ie=this.hasShadow();let X;const ce=!1,Ce=U===this;if(!this.isVisible()&&!Ce)return this;if(Ae){te.save();const L=this.getAbsoluteTransform(U).getMatrix();return te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),this._drawCachedSceneCanvas(te),te.restore(),this}if(!Te)return this;if(te.save(),this._useBufferCanvas()&&!ce){X=this.getStage();const L=b||X.bufferCanvas,q=L.getContext();q.clear(),q.save(),q._applyLineJoin(this);const Y=this.getAbsoluteTransform(U).getMatrix();q.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),Te.call(this,q,this),q.restore();const K=L.pixelRatio;ie&&te._applyShadow(this),te._applyOpacity(this),te._applyGlobalCompositeOperation(this),te.drawImage(L._canvas,L.x||0,L.y||0,L.width/K,L.height/K)}else{if(te._applyLineJoin(this),!Ce){const L=this.getAbsoluteTransform(U).getMatrix();te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),te._applyOpacity(this),te._applyGlobalCompositeOperation(this)}ie&&te._applyShadow(this),Te.call(this,te,this)}return te.restore(),this}drawHit(D,U,b=!1){if(!this.shouldDrawHit(U,b))return this;const Q=this.getLayer(),he=D||Q.hitCanvas,te=he&&he.getContext(),Ae=this.hitFunc()||this.sceneFunc(),Te=this._getCanvasCache(),ie=Te&&Te.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),ie){te.save();const ce=this.getAbsoluteTransform(U).getMatrix();return te.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),this._drawCachedHitCanvas(te),te.restore(),this}if(!Ae)return this;if(te.save(),te._applyLineJoin(this),!(this===U)){const ce=this.getAbsoluteTransform(U).getMatrix();te.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5])}return Ae.call(this,te,this),te.restore(),this}drawHitFromCache(D=0){const U=this._getCanvasCache(),b=this._getCachedSceneCanvas(),Q=U.hit,he=Q.getContext(),te=Q.getWidth(),Ae=Q.getHeight();he.clear(),he.drawImage(b._canvas,0,0,te,Ae);try{const Te=he.getImageData(0,0,te,Ae),ie=Te.data,X=ie.length,ce=r.Util._hexToRgb(this.colorKey);for(let Ce=0;Ce<X;Ce+=4)ie[Ce+3]>D?(ie[Ce]=ce.r,ie[Ce+1]=ce.g,ie[Ce+2]=ce.b,ie[Ce+3]=255):ie[Ce+3]=0;he.putImageData(Te,0,0)}catch(Te){r.Util.error("Unable to draw hit graph from cached scene canvas. "+Te.message)}return this}hasPointerCapture(D){return o.hasPointerCapture(D,this)}setPointerCapture(D){o.setPointerCapture(D,this)}releaseCapture(D){o.releaseCapture(D,this)}}e.Shape=P,P.prototype._fillFunc=_,P.prototype._strokeFunc=k,P.prototype._fillFuncHit=E,P.prototype._strokeFuncHit=S,P.prototype._centroid=!1,P.prototype.nodeType="Shape",(0,s._registerNode)(P),P.prototype.eventListeners={},P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",T),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(P,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(P,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(P,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"lineJoin"),n.Factory.addGetterSetter(P,"lineCap"),n.Factory.addGetterSetter(P,"sceneFunc"),n.Factory.addGetterSetter(P,"hitFunc"),n.Factory.addGetterSetter(P,"dash"),n.Factory.addGetterSetter(P,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(P,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(P,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternImage"),n.Factory.addGetterSetter(P,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(P,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(P,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(P,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(P,"fillEnabled",!0),n.Factory.addGetterSetter(P,"strokeEnabled",!0),n.Factory.addGetterSetter(P,"shadowEnabled",!0),n.Factory.addGetterSetter(P,"dashEnabled",!0),n.Factory.addGetterSetter(P,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(P,"fillPriority","color"),n.Factory.addComponentsGetterSetter(P,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(P,"fillPatternRotation",0),n.Factory.addGetterSetter(P,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(P,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Ir);Object.defineProperty(gu,"__esModule",{value:!0});gu.Layer=void 0;const Aa=ir,dg=Mo,ul=Jt,mx=pt,j3=Ki,NO=rt,RO=Ir,IO=ft,DO="#",OO="beforeDraw",bO="draw",bS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],LO=bS.length;let oc=class extends dg.Container{constructor(t){super(t),this.canvas=new j3.SceneCanvas,this.hitCanvas=new j3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),t<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[t+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){ul.Node.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!ul.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(ul.Node.prototype.moveDown.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(ul.Node.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return ul.Node.prototype.remove.call(this),t&&t.parentNode&&Aa.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:r}){return this.canvas.setSize(t,r),this.hitCanvas.setSize(t,r),this._setSmoothEnabled(),this}_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&Aa.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),ul.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Aa.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Aa.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Aa.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<LO;i++){const a=bS[i],s=this._getIntersection({x:t.x+a.x*r,y:t.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(t){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*r),Math.round(t.y*r),1,1).data,i=n[3];if(i===255){const a=Aa.Util._rgbToHex(n[0],n[1],n[2]),s=RO.shapes[DO+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(OO,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),dg.Container.prototype.drawScene.call(this,a,r,n),this._fire(bO,{node:this}),this}drawHit(t,r){const n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),dg.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Aa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Aa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Aa.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};gu.Layer=oc;oc.prototype.nodeType="Layer";(0,IO._registerNode)(oc);mx.Factory.addGetterSetter(oc,"imageSmoothingEnabled",!0);mx.Factory.addGetterSetter(oc,"clearBeforeDraw",!0);mx.Factory.addGetterSetter(oc,"hitGraphEnabled",!0,(0,NO.getBooleanValidator)());var kh={};Object.defineProperty(kh,"__esModule",{value:!0});kh.FastLayer=void 0;const MO=ir,BO=gu,UO=ft;class xx extends BO.Layer{constructor(t){super(t),this.listening(!1),MO.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}kh.FastLayer=xx;xx.prototype.nodeType="FastLayer";(0,UO._registerNode)(xx);var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Group=void 0;const jO=ir,zO=Mo,VO=ft;let vx=class extends zO.Container{_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&jO.Util.throw("You may only add groups and shapes to groups.")}};lc.Group=vx;vx.prototype.nodeType="Group";(0,VO._registerNode)(vx);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Animation=void 0;const hg=ft,z3=ir,pg=function(){return hg.glob.performance&&hg.glob.performance.now?function(){return hg.glob.performance.now()}:function(){return new Date().getTime()}}();class fa{constructor(t,r){this.id=fa.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:pg(),frameRate:0},this.func=t,this.setLayers(r)}setLayers(t){let r=[];return t&&(r=Array.isArray(t)?t:[t]),this.layers=r,this}getLayers(){return this.layers}addLayer(t){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const r=fa.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=pg(),fa._addAnimation(this),this}stop(){return fa._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const r=t.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const t={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(pg());const o=a.length;let u;if(s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<o;f++){const d=a[f];d._id!==void 0&&(t[d._id]=d)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=fa;t.animations.length?(t._runFrames(),z3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,z3.Util.requestAnimFrame(this._animationLoop))}}cc.Animation=fa;fa.animations=[];fa.animIdCounter=0;fa.animRunning=!1;var LS={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=ir,r=cc,n=Jt,i=ft,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,u=3,f=["fill","stroke","shadowColor"];let d=0;class p{constructor(g,_,k,E,S,x,C){this.prop=g,this.propFunc=_,this.begin=E,this._pos=E,this.duration=x,this._change=0,this.prevPos=0,this.yoyo=C,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=k,this._change=S-this.begin,this.pause()}fire(g){const _=this[g];_&&_()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const g=this.getTimer()-this._startTime;this.state===o?this.setTime(g):this.state===u&&this.setTime(this.duration-g)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(g){const _=this,k=g.node,E=k._id,S=g.easing||e.Easings.Linear,x=!!g.yoyo;let C,N;typeof g.duration>"u"?C=.3:g.duration===0?C=.001:C=g.duration,this.node=k,this._id=d++;const T=k.getLayer()||(k instanceof i.Konva.Stage?k.getLayers():null);T||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){_.tween.onEnterFrame()},T),this.tween=new p(N,function(F){_._tweenFunc(F)},S,0,1,C*1e3,x),this._addListeners(),m.attrs[E]||(m.attrs[E]={}),m.attrs[E][this._id]||(m.attrs[E][this._id]={}),m.tweens[E]||(m.tweens[E]={});for(N in g)a[N]===void 0&&this._addAttr(N,g[N]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,_){const k=this.node,E=k._id;let S,x,C,N,T;const F=m.tweens[E][g];F&&delete m.attrs[E][F][g];let P=k.getAttr(g);if(t.Util._isArray(_))if(S=[],x=Math.max(_.length,P.length),g==="points"&&_.length!==P.length&&(_.length>P.length?(N=P,P=t.Util._prepareArrayForTween(P,_,k.closed())):(C=_,_=t.Util._prepareArrayForTween(_,P,k.closed()))),g.indexOf("fill")===0)for(let I=0;I<x;I++)if(I%2===0)S.push(_[I]-P[I]);else{const D=t.Util.colorToRGBA(P[I]);T=t.Util.colorToRGBA(_[I]),P[I]=D,S.push({r:T.r-D.r,g:T.g-D.g,b:T.b-D.b,a:T.a-D.a})}else for(let I=0;I<x;I++)S.push(_[I]-P[I]);else f.indexOf(g)!==-1?(P=t.Util.colorToRGBA(P),T=t.Util.colorToRGBA(_),S={r:T.r-P.r,g:T.g-P.g,b:T.b-P.b,a:T.a-P.a}):S=_-P;m.attrs[E][this._id][g]={start:P,diff:S,end:_,trueEnd:C,trueStart:N},m.tweens[E][g]=this._id}_tweenFunc(g){const _=this.node,k=m.attrs[_._id][this._id];let E,S,x,C,N,T,F,P;for(E in k){if(S=k[E],x=S.start,C=S.diff,P=S.end,t.Util._isArray(x))if(N=[],F=Math.max(x.length,P.length),E.indexOf("fill")===0)for(T=0;T<F;T++)T%2===0?N.push((x[T]||0)+C[T]*g):N.push("rgba("+Math.round(x[T].r+C[T].r*g)+","+Math.round(x[T].g+C[T].g*g)+","+Math.round(x[T].b+C[T].b*g)+","+(x[T].a+C[T].a*g)+")");else for(T=0;T<F;T++)N.push((x[T]||0)+C[T]*g);else f.indexOf(E)!==-1?N="rgba("+Math.round(x.r+C.r*g)+","+Math.round(x.g+C.g*g)+","+Math.round(x.b+C.b*g)+","+(x.a+C.a*g)+")":N=x+C*g;_.setAttr(E,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const g=this.node,_=m.attrs[g._id][this._id];_.points&&_.points.trueEnd&&g.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const g=this.node,_=m.attrs[g._id][this._id];_.points&&_.points.trueStart&&g.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const g=this.node._id,_=this._id,k=m.tweens[g];this.pause(),this.anim&&this.anim.stop();for(const E in k)delete m.tweens[g][E];delete m.attrs[g][_],m.tweens[g]&&(Object.keys(m.tweens[g]).length===0&&delete m.tweens[g],Object.keys(m.attrs[g]).length===0&&delete m.attrs[g])}}e.Tween=m,m.attrs={},m.tweens={},n.Node.prototype.to=function(v){const g=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),g&&g()},new m(v).play()},e.Easings={BackEaseIn(v,g,_,k){return _*(v/=k)*v*((1.70158+1)*v-1.70158)+g},BackEaseOut(v,g,_,k){return _*((v=v/k-1)*v*((1.70158+1)*v+1.70158)+1)+g},BackEaseInOut(v,g,_,k){let E=1.70158;return(v/=k/2)<1?_/2*(v*v*(((E*=1.525)+1)*v-E))+g:_/2*((v-=2)*v*(((E*=1.525)+1)*v+E)+2)+g},ElasticEaseIn(v,g,_,k,E,S){let x=0;return v===0?g:(v/=k)===1?g+_:(S||(S=k*.3),!E||E<Math.abs(_)?(E=_,x=S/4):x=S/(2*Math.PI)*Math.asin(_/E),-(E*Math.pow(2,10*(v-=1))*Math.sin((v*k-x)*(2*Math.PI)/S))+g)},ElasticEaseOut(v,g,_,k,E,S){let x=0;return v===0?g:(v/=k)===1?g+_:(S||(S=k*.3),!E||E<Math.abs(_)?(E=_,x=S/4):x=S/(2*Math.PI)*Math.asin(_/E),E*Math.pow(2,-10*v)*Math.sin((v*k-x)*(2*Math.PI)/S)+_+g)},ElasticEaseInOut(v,g,_,k,E,S){let x=0;return v===0?g:(v/=k/2)===2?g+_:(S||(S=k*(.3*1.5)),!E||E<Math.abs(_)?(E=_,x=S/4):x=S/(2*Math.PI)*Math.asin(_/E),v<1?-.5*(E*Math.pow(2,10*(v-=1))*Math.sin((v*k-x)*(2*Math.PI)/S))+g:E*Math.pow(2,-10*(v-=1))*Math.sin((v*k-x)*(2*Math.PI)/S)*.5+_+g)},BounceEaseOut(v,g,_,k){return(v/=k)<1/2.75?_*(7.5625*v*v)+g:v<2/2.75?_*(7.5625*(v-=1.5/2.75)*v+.75)+g:v<2.5/2.75?_*(7.5625*(v-=2.25/2.75)*v+.9375)+g:_*(7.5625*(v-=2.625/2.75)*v+.984375)+g},BounceEaseIn(v,g,_,k){return _-e.Easings.BounceEaseOut(k-v,0,_,k)+g},BounceEaseInOut(v,g,_,k){return v<k/2?e.Easings.BounceEaseIn(v*2,0,_,k)*.5+g:e.Easings.BounceEaseOut(v*2-k,0,_,k)*.5+_*.5+g},EaseIn(v,g,_,k){return _*(v/=k)*v+g},EaseOut(v,g,_,k){return-_*(v/=k)*(v-2)+g},EaseInOut(v,g,_,k){return(v/=k/2)<1?_/2*v*v+g:-_/2*(--v*(v-2)-1)+g},StrongEaseIn(v,g,_,k){return _*(v/=k)*v*v*v*v+g},StrongEaseOut(v,g,_,k){return _*((v=v/k-1)*v*v*v*v+1)+g},StrongEaseInOut(v,g,_,k){return(v/=k/2)<1?_/2*v*v*v*v*v+g:_/2*((v-=2)*v*v*v*v+2)+g},Linear(v,g,_,k){return _*v/k+g}}})(LS);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=ft,r=ir,n=Jt,i=Mo,a=IS,s=gu,o=kh,u=lc,f=Sh,d=Ir,p=cc,m=LS,v=Ua,g=Ki;e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:u.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:m.Tween,Easings:m.Easings,Context:v.Context,Canvas:g.Canvas}),e.default=e.Konva})(Vd);var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});Eh.Arc=void 0;const Ch=pt,GO=Ir,V3=ft,Th=rt,HO=ft;class Qa extends GO.Shape{_sceneFunc(t){const r=V3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,r,n),t.arc(0,0,this.innerRadius(),r,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=V3.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?t:r),d=s*r,p=o*(o>0?t:r),m=u*(u>0?r:t);return{x:f,y:n?-1*m:p,width:d-f,height:m-p}}}Eh.Arc=Qa;Qa.prototype._centroid=!0;Qa.prototype.className="Arc";Qa.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,HO._registerNode)(Qa);Ch.Factory.addGetterSetter(Qa,"innerRadius",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"outerRadius",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"angle",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"clockwise",!1,(0,Th.getBooleanValidator)());var Ah={},mu={};Object.defineProperty(mu,"__esModule",{value:!0});mu.Line=void 0;const Ph=pt,WO=ft,$O=Ir,MS=rt;function Om(e,t,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*o/(o+u),d=s*u/(o+u),p=r-f*(i-e),m=n-f*(a-t),v=r+d*(i-e),g=n+d*(a-t);return[p,m,v,g]}function G3(e,t){const r=e.length,n=[];for(let i=2;i<r-2;i+=2){const a=Om(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(e[i]),n.push(e[i+1]),n.push(a[2]),n.push(a[3]))}return n}let zs=class extends $O.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let o=0;if(t.beginPath(),t.moveTo(r[0],r[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(o=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);o<f-2;)t.bezierCurveTo(u[o++],u[o++],u[o++],u[o++],u[o++],u[o++]);a||t.quadraticCurveTo(u[f-2],u[f-1],r[n-2],r[n-1])}else if(s)for(o=2;o<n;)t.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)t.lineTo(r[o],r[o+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():G3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),r=t.length,n=this.tension(),i=Om(t[r-2],t[r-1],t[0],t[1],t[2],t[3],n),a=Om(t[r-4],t[r-3],t[r-2],t[r-1],t[0],t[1],n),s=G3(t,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],t[r-2],t[r-1],a[2],a[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};mu.Line=zs;zs.prototype.className="Line";zs.prototype._attrsAffectingSize=["points","bezier","tension"];(0,WO._registerNode)(zs);Ph.Factory.addGetterSetter(zs,"closed",!1);Ph.Factory.addGetterSetter(zs,"bezier",!1);Ph.Factory.addGetterSetter(zs,"tension",0,(0,MS.getNumberValidator)());Ph.Factory.addGetterSetter(zs,"points",[],(0,MS.getNumberArrayValidator)());var uc={},BS={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,o,u)=>{let f,d;const m=u/2;f=0;for(let v=0;v<20;v++)d=m*e.tValues[20][v]+m,f+=e.cValues[20][v]*n(s,o,d);return m*f};e.getCubicArcLength=t;const r=(s,o,u)=>{u===void 0&&(u=1);const f=s[0]-2*s[1]+s[2],d=o[0]-2*o[1]+o[2],p=2*s[1]-2*s[0],m=2*o[1]-2*o[0],v=4*(f*f+d*d),g=4*(f*p+d*m),_=p*p+m*m;if(v===0)return u*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const k=g/(2*v),E=_/v,S=u+k,x=E-k*k,C=S*S+x>0?Math.sqrt(S*S+x):0,N=k*k+x>0?Math.sqrt(k*k+x):0,T=k+Math.sqrt(k*k+x)!==0?x*Math.log(Math.abs((S+C)/(k+N))):0;return Math.sqrt(v)/2*(S*C-k*N+T)};e.getQuadraticArcLength=r;function n(s,o,u){const f=i(1,u,s),d=i(1,u,o),p=f*f+d*d;return Math.sqrt(p)}const i=(s,o,u)=>{const f=u.length-1;let d,p;if(f===0)return 0;if(s===0){p=0;for(let m=0;m<=f;m++)p+=e.binomialCoefficients[f][m]*Math.pow(1-o,f-m)*Math.pow(o,m)*u[m];return p}else{d=new Array(f);for(let m=0;m<f;m++)d[m]=f*(u[m+1]-u[m]);return i(s-1,o,d)}},a=(s,o,u)=>{let f=1,d=s/o,p=(s-u(d))/o,m=0;for(;f>.001;){const v=u(d+p),g=Math.abs(s-v)/o;if(g<f)f=g,d+=p;else{const _=u(d-p),k=Math.abs(s-_)/o;k<f?(f=k,d-=p):p/=2}if(m++,m>500)break}return d};e.t2length=a})(BS);Object.defineProperty(uc,"__esModule",{value:!0});uc.Path=void 0;const XO=pt,KO=ft,YO=Ir,fl=BS;class Tr extends YO.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Tr.parsePathData(this.data()),this.pathLength=Tr.getPathLength(this.dataArray)}_sceneFunc(t){const r=this.dataArray;t.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const o=s[0],u=s[1],f=s[2],d=s[3],p=s[4],m=s[5],v=s[6],g=s[7],_=f>d?f:d,k=f>d?1:f/d,E=f>d?d/f:1;t.translate(o,u),t.rotate(v),t.scale(k,E),t.arc(0,0,_,p,p+m,1-g),t.scale(1/k,1/E),t.rotate(-v),t.translate(-o,-u);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],d=u.points[5],p=u.points[4]+d;let m=Math.PI/180;if(Math.abs(f-p)<m&&(m=Math.abs(f-p)),d<0)for(let v=f-m;v>p;v-=m){const g=Tr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(g.x,g.y)}else for(let v=f+m;v<p;v+=m){const g=Tr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(g.x,g.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const d=Tr.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(d.x,d.y)}else t=t.concat(u.points)});let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return Tr.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}static getPathLength(t){let r=0;for(let n=0;n<t.length;++n)r+=t[n].pathLength;return r}static getPointAtLengthOfDataArray(t,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&t>r[i].pathLength;)t-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],o=s.points;switch(s.command){case"L":return Tr.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Tr.getPointOnCubicBezier((0,fl.t2length)(t,Tr.getPathLength(r),_=>(0,fl.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],_)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Tr.getPointOnQuadraticBezier((0,fl.t2length)(t,Tr.getPathLength(r),_=>(0,fl.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],_)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":const u=o[0],f=o[1],d=o[2],p=o[3],m=o[5],v=o[6];let g=o[4];return g+=m*t/s.pathLength,Tr.getPointOnEllipticalArc(u,f,d,p,g,v)}return null}static getPointOnLine(t,r,n,i,a,s,o){s=s??r,o=o??n;const u=this.getLineLength(r,n,i,a);if(u<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?t:-t)};const f=(a-n)/(i-r),d=Math.sqrt(t*t/(1+f*f))*(i<r?-1:1),p=f*d;if(Math.abs(o-n-f*(s-r))<1e-10)return{x:s+d,y:o+p};const m=((s-r)*(i-r)+(o-n)*(a-n))/(u*u),v=r+m*(i-r),g=n+m*(a-n),_=this.getLineLength(s,o,v,g),k=Math.sqrt(t*t-_*_),E=Math.sqrt(k*k/(1+f*f))*(i<r?-1:1),S=f*E;return{x:v+E,y:g+S}}static getPointOnCubicBezier(t,r,n,i,a,s,o,u,f){function d(k){return k*k*k}function p(k){return 3*k*k*(1-k)}function m(k){return 3*k*(1-k)*(1-k)}function v(k){return(1-k)*(1-k)*(1-k)}const g=u*d(t)+s*p(t)+i*m(t)+r*v(t),_=f*d(t)+o*p(t)+a*m(t)+n*v(t);return{x:g,y:_}}static getPointOnQuadraticBezier(t,r,n,i,a,s,o){function u(v){return v*v}function f(v){return 2*v*(1-v)}function d(v){return(1-v)*(1-v)}const p=s*u(t)+i*f(t)+r*d(t),m=o*u(t)+a*f(t)+n*d(t);return{x:p,y:m}}static getPointOnEllipticalArc(t,r,n,i,a,s){const o=Math.cos(s),u=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(f.x*o-f.y*u),y:r+(f.x*u+f.y*o)}}static parsePathData(t){if(!t)return[];let r=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let p=0;p<n.length;p++)r=r.replace(new RegExp(n[p],"g"),"|"+n[p]);const i=r.split("|"),a=[],s=[];let o=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let p=1;p<i.length;p++){let m=i[p],v=m.charAt(0);for(m=m.slice(1),s.length=0;d=f.exec(m);)s.push(d[0]);const g=[];for(let _=0,k=s.length;_<k;_++){if(s[_]==="00"){g.push(0,0);continue}const E=parseFloat(s[_]);isNaN(E)?g.push(0):g.push(E)}for(;g.length>0&&!isNaN(g[0]);){let _="",k=[];const E=o,S=u;let x,C,N,T,F,P,I,D,U,b;switch(v){case"l":o+=g.shift(),u+=g.shift(),_="L",k.push(o,u);break;case"L":o=g.shift(),u=g.shift(),k.push(o,u);break;case"m":const Q=g.shift(),he=g.shift();if(o+=Q,u+=he,_="M",a.length>2&&a[a.length-1].command==="z"){for(let te=a.length-2;te>=0;te--)if(a[te].command==="M"){o=a[te].points[0]+Q,u=a[te].points[1]+he;break}}k.push(o,u),v="l";break;case"M":o=g.shift(),u=g.shift(),_="M",k.push(o,u),v="L";break;case"h":o+=g.shift(),_="L",k.push(o,u);break;case"H":o=g.shift(),_="L",k.push(o,u);break;case"v":u+=g.shift(),_="L",k.push(o,u);break;case"V":u=g.shift(),_="L",k.push(o,u);break;case"C":k.push(g.shift(),g.shift(),g.shift(),g.shift()),o=g.shift(),u=g.shift(),k.push(o,u);break;case"c":k.push(o+g.shift(),u+g.shift(),o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),_="C",k.push(o,u);break;case"S":C=o,N=u,x=a[a.length-1],x.command==="C"&&(C=o+(o-x.points[2]),N=u+(u-x.points[3])),k.push(C,N,g.shift(),g.shift()),o=g.shift(),u=g.shift(),_="C",k.push(o,u);break;case"s":C=o,N=u,x=a[a.length-1],x.command==="C"&&(C=o+(o-x.points[2]),N=u+(u-x.points[3])),k.push(C,N,o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),_="C",k.push(o,u);break;case"Q":k.push(g.shift(),g.shift()),o=g.shift(),u=g.shift(),k.push(o,u);break;case"q":k.push(o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),_="Q",k.push(o,u);break;case"T":C=o,N=u,x=a[a.length-1],x.command==="Q"&&(C=o+(o-x.points[0]),N=u+(u-x.points[1])),o=g.shift(),u=g.shift(),_="Q",k.push(C,N,o,u);break;case"t":C=o,N=u,x=a[a.length-1],x.command==="Q"&&(C=o+(o-x.points[0]),N=u+(u-x.points[1])),o+=g.shift(),u+=g.shift(),_="Q",k.push(C,N,o,u);break;case"A":T=g.shift(),F=g.shift(),P=g.shift(),I=g.shift(),D=g.shift(),U=o,b=u,o=g.shift(),u=g.shift(),_="A",k=this.convertEndpointToCenterParameterization(U,b,o,u,I,D,T,F,P);break;case"a":T=g.shift(),F=g.shift(),P=g.shift(),I=g.shift(),D=g.shift(),U=o,b=u,o+=g.shift(),u+=g.shift(),_="A",k=this.convertEndpointToCenterParameterization(U,b,o,u,I,D,T,F,P);break}a.push({command:_||v,points:k,start:{x:E,y:S},pathLength:this.calcLength(E,S,_||v,k)})}(v==="z"||v==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,r,n,i){let a,s,o,u;const f=Tr;switch(n){case"L":return f.getLineLength(t,r,i[0],i[1]);case"C":return(0,fl.getCubicArcLength)([t,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,fl.getQuadraticArcLength)([t,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],p=i[5],m=i[4]+p;let v=Math.PI/180;if(Math.abs(d-m)<v&&(v=Math.abs(d-m)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),p<0)for(u=d-v;u>m;u-=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=d+v;u<m;u+=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],m,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(t,r,n,i,a,s,o,u,f){const d=f*(Math.PI/180),p=Math.cos(d)*(t-n)/2+Math.sin(d)*(r-i)/2,m=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(r-i)/2,v=p*p/(o*o)+m*m/(u*u);v>1&&(o*=Math.sqrt(v),u*=Math.sqrt(v));let g=Math.sqrt((o*o*(u*u)-o*o*(m*m)-u*u*(p*p))/(o*o*(m*m)+u*u*(p*p)));a===s&&(g*=-1),isNaN(g)&&(g=0);const _=g*o*m/u,k=g*-u*p/o,E=(t+n)/2+Math.cos(d)*_-Math.sin(d)*k,S=(r+i)/2+Math.sin(d)*_+Math.cos(d)*k,x=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},C=function(D,U){return(D[0]*U[0]+D[1]*U[1])/(x(D)*x(U))},N=function(D,U){return(D[0]*U[1]<D[1]*U[0]?-1:1)*Math.acos(C(D,U))},T=N([1,0],[(p-_)/o,(m-k)/u]),F=[(p-_)/o,(m-k)/u],P=[(-1*p-_)/o,(-1*m-k)/u];let I=N(F,P);return C(F,P)<=-1&&(I=Math.PI),C(F,P)>=1&&(I=0),s===0&&I>0&&(I=I-2*Math.PI),s===1&&I<0&&(I=I+2*Math.PI),[E,S,o,u,T,I,d,s]}}uc.Path=Tr;Tr.prototype.className="Path";Tr.prototype._attrsAffectingSize=["data"];(0,KO._registerNode)(Tr);XO.Factory.addGetterSetter(Tr,"data");Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Arrow=void 0;const Fh=pt,QO=mu,US=rt,qO=ft,H3=uc;class Uo extends QO.Line{_sceneFunc(t){super._sceneFunc(t);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let u,f;if(a){const m=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],v=H3.Path.calcLength(i[i.length-4],i[i.length-3],"C",m),g=H3.Path.getPointOnQuadraticBezier(Math.min(1,1-s/v),m[0],m[1],m[2],m[3],m[4],m[5]);u=n[o-2]-g.x,f=n[o-1]-g.y}else u=n[o-2]-n[o-4],f=n[o-1]-n[o-3];const d=(Math.atan2(f,u)+r)%r,p=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[o-2],n[o-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),a?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-u)+r)%r),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),r=this.pointerWidth()/2;return{x:t.x,y:t.y-r,width:t.width,height:t.height+r*2}}}Ah.Arrow=Uo;Uo.prototype.className="Arrow";(0,qO._registerNode)(Uo);Fh.Factory.addGetterSetter(Uo,"pointerLength",10,(0,US.getNumberValidator)());Fh.Factory.addGetterSetter(Uo,"pointerWidth",10,(0,US.getNumberValidator)());Fh.Factory.addGetterSetter(Uo,"pointerAtBeginning",!1);Fh.Factory.addGetterSetter(Uo,"pointerAtEnding",!0);var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Circle=void 0;const JO=pt,ZO=Ir,eb=rt,tb=ft;let fc=class extends ZO.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Nh.Circle=fc;fc.prototype._centroid=!0;fc.prototype.className="Circle";fc.prototype._attrsAffectingSize=["radius"];(0,tb._registerNode)(fc);JO.Factory.addGetterSetter(fc,"radius",0,(0,eb.getNumberValidator)());var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Ellipse=void 0;const yx=pt,rb=Ir,jS=rt,nb=ft;class Vs extends rb.Shape{_sceneFunc(t){const r=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),r!==n&&t.scale(1,n/r),t.arc(0,0,r,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Rh.Ellipse=Vs;Vs.prototype.className="Ellipse";Vs.prototype._centroid=!0;Vs.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,nb._registerNode)(Vs);yx.Factory.addComponentsGetterSetter(Vs,"radius",["x","y"]);yx.Factory.addGetterSetter(Vs,"radiusX",0,(0,jS.getNumberValidator)());yx.Factory.addGetterSetter(Vs,"radiusY",0,(0,jS.getNumberValidator)());var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Image=void 0;const gg=ir,jo=pt,ib=Ir,ab=ft,xu=rt;class Ai extends ib.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),r=this.hasShadow();return t&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,u=this.attrs.cropHeight;o&&u?s=[a,this.cropX(),this.cropY(),o,u,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?gg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){const r=this.width(),n=this.height(),i=this.cornerRadius();t.beginPath(),i?gg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,r;return(t=this.attrs.width)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var t,r;return(t=this.attrs.height)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(t,r,n=null){const i=gg.Util.createImageElement();i.onload=function(){const a=new Ai({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=t}}Ih.Image=Ai;Ai.prototype.className="Image";(0,ab._registerNode)(Ai);jo.Factory.addGetterSetter(Ai,"cornerRadius",0,(0,xu.getNumberOrArrayOfNumbersValidator)(4));jo.Factory.addGetterSetter(Ai,"image");jo.Factory.addComponentsGetterSetter(Ai,"crop",["x","y","width","height"]);jo.Factory.addGetterSetter(Ai,"cropX",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Ai,"cropY",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Ai,"cropWidth",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Ai,"cropHeight",0,(0,xu.getNumberValidator)());var ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.Tag=ql.Label=void 0;const Dh=pt,sb=Ir,ob=lc,_x=rt,zS=ft,VS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],lb="Change.konva",cb="none",bm="up",Lm="right",Mm="down",Bm="left",ub=VS.length;class Sx extends ob.Group{constructor(t){super(t),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let r=this,n;const i=function(){r._sync()};for(n=0;n<ub;n++)t.on(VS[n]+lb,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),r=this.getTag(),n,i,a,s,o,u,f;if(t&&r){switch(n=t.width(),i=t.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),o=0,u=0,a){case bm:o=n/2,u=-1*f;break;case Lm:o=n+s,u=i/2;break;case Mm:o=n/2,u=i+f;break;case Bm:o=-1*s,u=i/2;break}r.setAttrs({x:-1*o,y:-1*u,width:n,height:i}),t.setAttrs({x:-1*o,y:-1*u})}}}ql.Label=Sx;Sx.prototype.className="Label";(0,zS._registerNode)(Sx);class zo extends sb.Shape{_sceneFunc(t){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let u=0,f=0,d=0,p=0;typeof o=="number"?u=f=d=p=Math.min(o,r/2,n/2):(u=Math.min(o[0]||0,r/2,n/2),f=Math.min(o[1]||0,r/2,n/2),p=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),t.beginPath(),t.moveTo(u,0),i===bm&&(t.lineTo((r-a)/2,0),t.lineTo(r/2,-1*s),t.lineTo((r+a)/2,0)),t.lineTo(r-f,0),t.arc(r-f,f,f,Math.PI*3/2,0,!1),i===Lm&&(t.lineTo(r,(n-s)/2),t.lineTo(r+a,n/2),t.lineTo(r,(n+s)/2)),t.lineTo(r,n-p),t.arc(r-p,n-p,p,0,Math.PI/2,!1),i===Mm&&(t.lineTo((r+a)/2,n),t.lineTo(r/2,n+s),t.lineTo((r-a)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===Bm&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===bm?(r-=i,o+=i):a===Mm?o+=i:a===Bm?(t-=n*1.5,s+=n):a===Lm&&(s+=n*1.5),{x:t,y:r,width:s,height:o}}}ql.Tag=zo;zo.prototype.className="Tag";(0,zS._registerNode)(zo);Dh.Factory.addGetterSetter(zo,"pointerDirection",cb);Dh.Factory.addGetterSetter(zo,"pointerWidth",0,(0,_x.getNumberValidator)());Dh.Factory.addGetterSetter(zo,"pointerHeight",0,(0,_x.getNumberValidator)());Dh.Factory.addGetterSetter(zo,"cornerRadius",0,(0,_x.getNumberOrArrayOfNumbersValidator)(4));var vu={};Object.defineProperty(vu,"__esModule",{value:!0});vu.Rect=void 0;const fb=pt,db=Ir,hb=ft,pb=ir,gb=rt;let Oh=class extends db.Shape{_sceneFunc(t){const r=this.cornerRadius(),n=this.width(),i=this.height();t.beginPath(),r?pb.Util.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}};vu.Rect=Oh;Oh.prototype.className="Rect";(0,hb._registerNode)(Oh);fb.Factory.addGetterSetter(Oh,"cornerRadius",0,(0,gb.getNumberOrArrayOfNumbersValidator)(4));var bh={};Object.defineProperty(bh,"__esModule",{value:!0});bh.RegularPolygon=void 0;const GS=pt,mb=Ir,HS=rt,xb=ft;class Vo extends mb.Shape{_sceneFunc(t){const r=this._getPoints();t.beginPath(),t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<t;i++)n.push({x:r*Math.sin(i*2*Math.PI/t),y:-1*r*Math.cos(i*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let r=t[0].x,n=t[0].y,i=t[0].x,a=t[0].y;return t.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}bh.RegularPolygon=Vo;Vo.prototype.className="RegularPolygon";Vo.prototype._centroid=!0;Vo.prototype._attrsAffectingSize=["radius"];(0,xb._registerNode)(Vo);GS.Factory.addGetterSetter(Vo,"radius",0,(0,HS.getNumberValidator)());GS.Factory.addGetterSetter(Vo,"sides",0,(0,HS.getNumberValidator)());var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.Ring=void 0;const WS=pt,vb=Ir,$S=rt,yb=ft,W3=Math.PI*2;class Go extends vb.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,W3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),W3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Lh.Ring=Go;Go.prototype.className="Ring";Go.prototype._centroid=!0;Go.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,yb._registerNode)(Go);WS.Factory.addGetterSetter(Go,"innerRadius",0,(0,$S.getNumberValidator)());WS.Factory.addGetterSetter(Go,"outerRadius",0,(0,$S.getNumberValidator)());var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.Sprite=void 0;const Ho=pt,_b=Ir,Sb=cc,XS=rt,wb=ft;class xa extends _b.Shape{constructor(t){super(t),this._updated=!0,this.anim=new Sb.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],u=a[i+1],f=a[i+2],d=a[i+3],p=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,d),t.closePath(),t.fillStrokeShape(this)),p)if(s){const m=s[r],v=n*2;t.drawImage(p,o,u,f,d,m[v+0],m[v+1],f,d)}else t.drawImage(p,o,u,f,d,0,0,f,d)}_hitFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],u=a[i+3];if(t.beginPath(),s){const f=s[r],d=n*2;t.rect(f[d+0],f[d+1],o,u)}else t.rect(0,0,o,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}}Mh.Sprite=xa;xa.prototype.className="Sprite";(0,wb._registerNode)(xa);Ho.Factory.addGetterSetter(xa,"animation");Ho.Factory.addGetterSetter(xa,"animations");Ho.Factory.addGetterSetter(xa,"frameOffsets");Ho.Factory.addGetterSetter(xa,"image");Ho.Factory.addGetterSetter(xa,"frameIndex",0,(0,XS.getNumberValidator)());Ho.Factory.addGetterSetter(xa,"frameRate",17,(0,XS.getNumberValidator)());Ho.Factory.backCompat(xa,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Star=void 0;const wx=pt,kb=Ir,kx=rt,Eb=ft;class Gs extends kb.Shape{_sceneFunc(t){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),u=-1*s*Math.cos(a*Math.PI/i);t.lineTo(o,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Bh.Star=Gs;Gs.prototype.className="Star";Gs.prototype._centroid=!0;Gs.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Eb._registerNode)(Gs);wx.Factory.addGetterSetter(Gs,"numPoints",5,(0,kx.getNumberValidator)());wx.Factory.addGetterSetter(Gs,"innerRadius",0,(0,kx.getNumberValidator)());wx.Factory.addGetterSetter(Gs,"outerRadius",0,(0,kx.getNumberValidator)());var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Text=void 0;dc.stringToArray=lo;const Um=ir,vn=pt,Cb=Ir,mg=ft,Hs=rt,Tb=ft;function lo(e){return[...e].reduce((t,r,n,i)=>{if(/\p{Emoji}/u.test(r)){const a=i[n+1];a&&/\p{Emoji_Modifier}|\u200D/u.test(a)?(t.push(r+a),i[n+1]=""):t.push(r)}else/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?t.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?t[t.length-1]+=r:r&&t.push(r);return t},[])}const dl="auto",Ab="center",KS="inherit",Hc="justify",Pb="Change.konva",Fb="2d",$3="-",YS="left",Nb="text",Rb="Text",Ib="top",Db="bottom",X3="middle",QS="normal",Ob="px ",zf=" ",bb="right",K3="rtl",Lb="word",Mb="char",Y3="none",xg="",qS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Bb=qS.length;function Ub(e){return e.split(",").map(t=>{t=t.trim();const r=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return r&&!n&&(t=`"${t}"`),t}).join(", ")}let Vf;function vg(){return Vf||(Vf=Um.Util.createCanvasElement().getContext(Fb),Vf)}function jb(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function zb(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Vb(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}let cr=class extends Cb.Shape{constructor(t){super(Vb(t)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<Bb;r++)this.on(qS[r]+Pb,this._setTextData);this._setTextData()}_sceneFunc(t){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),u=this.direction(),f=0,d=this.align(),p=this.getWidth(),m=this.letterSpacing(),v=this.fill(),g=this.textDecoration(),_=g.indexOf("underline")!==-1,k=g.indexOf("line-through")!==-1,E;u=u===KS?t.direction:u;let S=s/2,x=X3;if(mg.Konva._fixTextRendering){const C=this.measureSize("M");x="alphabetic",S=(C.fontBoundingBoxAscent-C.fontBoundingBoxDescent)/2+s/2}for(u===K3&&t.setAttr("direction",u),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",YS),o===X3?f=(this.getHeight()-n*s-i*2)/2:o===Db&&(f=this.getHeight()-n*s-i*2),t.translate(i,f+i),E=0;E<n;E++){let C=0,N=0;const T=r[E],F=T.text,P=T.width,I=T.lastInParagraph;if(t.save(),d===bb?C+=p-P-i*2:d===Ab&&(C+=(p-P-i*2)/2),_){t.save(),t.beginPath();const D=mg.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),U=C,b=S+N+D;t.moveTo(U,b);const Q=d===Hc&&!I?p-i*2:P;t.lineTo(U+Math.round(Q),b),t.lineWidth=a/15;const he=this._getLinearGradient();t.strokeStyle=he||v,t.stroke(),t.restore()}if(k){t.save(),t.beginPath();const D=mg.Konva._fixTextRendering?-Math.round(a/4):0;t.moveTo(C,S+N+D);const U=d===Hc&&!I?p-i*2:P;t.lineTo(C+Math.round(U),S+N+D),t.lineWidth=a/15;const b=this._getLinearGradient();t.strokeStyle=b||v,t.stroke(),t.restore()}if(u!==K3&&(m!==0||d===Hc)){const D=F.split(" ").length-1,U=lo(F);for(let b=0;b<U.length;b++){const Q=U[b];Q===" "&&!I&&d===Hc&&(C+=(p-i*2-P)/D),this._partialTextX=C,this._partialTextY=S+N,this._partialText=Q,t.fillStrokeShape(this),C+=this.measureSize(Q).width+m}}else m!==0&&t.setAttr("letterSpacing",`${m}px`),this._partialTextX=C,this._partialTextY=S+N,this._partialText=F,t.fillStrokeShape(this);t.restore(),n>1&&(S+=s)}}_hitFunc(t){const r=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const r=Um.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(Nb,r),this}getWidth(){return this.attrs.width===dl||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===dl||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Um.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var r,n,i,a,s,o,u,f,d,p,m;let v=vg(),g=this.fontSize(),_;v.save(),v.font=this._getContextFont(),_=v.measureText(t),v.restore();const k=g/100;return{actualBoundingBoxAscent:(r=_.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*k,actualBoundingBoxDescent:(n=_.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=_.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*k,actualBoundingBoxRight:(a=_.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*k,alphabeticBaseline:(s=_.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=_.emHeightAscent)!==null&&o!==void 0?o:100*k,emHeightDescent:(u=_.emHeightDescent)!==null&&u!==void 0?u:-20*k,fontBoundingBoxAscent:(f=_.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*k,fontBoundingBoxDescent:(d=_.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*k,hangingBaseline:(p=_.hangingBaseline)!==null&&p!==void 0?p:72.80000305175781*k,ideographicBaseline:(m=_.ideographicBaseline)!==null&&m!==void 0?m:-21*k,width:_.width,height:g}}_getContextFont(){return this.fontStyle()+zf+this.fontVariant()+zf+(this.fontSize()+Ob)+Ub(this.fontFamily())}_addTextLine(t){this.align()===Hc&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const r=this.letterSpacing(),n=t.length;return vg().measureText(t).width+r*n}_setTextData(){let t=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==dl&&a!==void 0,u=s!==dl&&s!==void 0,f=this.padding(),d=a-f*2,p=s-f*2,m=0,v=this.wrap(),g=v!==Y3,_=v!==Mb&&g,k=this.ellipsis();this.textArr=[],vg().font=this._getContextFont();const E=k?this._getTextWidth(xg):0;for(let S=0,x=t.length;S<x;++S){let C=t[S],N=this._getTextWidth(C);if(o&&N>d)for(;C.length>0;){let T=0,F=lo(C).length,P="",I=0;for(;T<F;){const D=T+F>>>1,U=lo(C),b=U.slice(0,D+1).join(""),Q=this._getTextWidth(b);(k&&u&&m+i>p?Q+E:Q)<=d?(T=D+1,P=b,I=Q):F=D}if(P){if(_){const b=lo(C),Q=lo(P),he=b[Q.length],te=he===zf||he===$3;let Ae;if(te&&I<=d)Ae=Q.length;else{const Te=Q.lastIndexOf(zf),ie=Q.lastIndexOf($3);Ae=Math.max(Te,ie)+1}Ae>0&&(T=Ae,P=b.slice(0,T).join(""),I=this._getTextWidth(P))}if(P=P.trimRight(),this._addTextLine(P),n=Math.max(n,I),m+=i,this._shouldHandleEllipsis(m)){this._tryToAddEllipsisToLastLine();break}if(C=lo(C).slice(T).join("").trimLeft(),C.length>0&&(N=this._getTextWidth(C),N<=d)){this._addTextLine(C),m+=i,n=Math.max(n,N);break}}else break}else this._addTextLine(C),m+=i,n=Math.max(n,N),this._shouldHandleEllipsis(m)&&S<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&m+i>p)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(t){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==dl&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==Y3)||a&&t+n>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,r=t!==dl&&t!==void 0,n=this.padding(),i=t-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+xg)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+xg))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return t&&r?!0:super._useBufferCanvas()}};dc.Text=cr;cr.prototype._fillFunc=jb;cr.prototype._strokeFunc=zb;cr.prototype.className=Rb;cr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Tb._registerNode)(cr);vn.Factory.overWriteSetter(cr,"width",(0,Hs.getNumberOrAutoValidator)());vn.Factory.overWriteSetter(cr,"height",(0,Hs.getNumberOrAutoValidator)());vn.Factory.addGetterSetter(cr,"direction",KS);vn.Factory.addGetterSetter(cr,"fontFamily","Arial");vn.Factory.addGetterSetter(cr,"fontSize",12,(0,Hs.getNumberValidator)());vn.Factory.addGetterSetter(cr,"fontStyle",QS);vn.Factory.addGetterSetter(cr,"fontVariant",QS);vn.Factory.addGetterSetter(cr,"padding",0,(0,Hs.getNumberValidator)());vn.Factory.addGetterSetter(cr,"align",YS);vn.Factory.addGetterSetter(cr,"verticalAlign",Ib);vn.Factory.addGetterSetter(cr,"lineHeight",1,(0,Hs.getNumberValidator)());vn.Factory.addGetterSetter(cr,"wrap",Lb);vn.Factory.addGetterSetter(cr,"ellipsis",!1,(0,Hs.getBooleanValidator)());vn.Factory.addGetterSetter(cr,"letterSpacing",0,(0,Hs.getNumberValidator)());vn.Factory.addGetterSetter(cr,"text","",(0,Hs.getStringValidator)());vn.Factory.addGetterSetter(cr,"textDecoration","");var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.TextPath=void 0;const yg=ir,Qi=pt,Gb=Ir,Wc=uc,_g=dc,JS=rt,Hb=ft,Wb="",ZS="normal";function ew(e){e.fillText(this.partialText,0,0)}function tw(e){e.strokeText(this.partialText,0,0)}class Dr extends Gb.Shape{constructor(t){super(t),this.dummyCanvas=yg.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Wc.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const r=this.pathLength;return t-1>r?null:Wc.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Wc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&t.beginPath();for(let s=0;s<a.length;s++){t.save();const o=a[s].p0;t.translate(o.x,o.y),t.rotate(a[s].rotation),this.partialText=a[s].text,t.fillStrokeShape(this),r==="underline"&&(s===0&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}r==="underline"&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return yg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return _g.Text.prototype.setText.call(this,t)}_getContextFont(){return _g.Text.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const u=(0,_g.stringToArray)(this.text());let f=o;for(let d=0;d<u.length;d++){const p=this._getPointAtLength(f);if(!p)return;let m=this._getTextSize(u[d]).width+n;if(u[d]===" "&&i==="justify"){const S=this.text().split(" ").length-1;m+=(this.pathLength-s)/S}const v=this._getPointAtLength(f+m);if(!v)return;const g=Wc.Path.getLineLength(p.x,p.y,v.x,v.y);let _=0;if(a)try{_=a(u[d-1],u[d])*this.fontSize()}catch{_=0}p.x+=_,v.x+=_,this.textWidth+=_;const k=Wc.Path.getPointOnLine(_+g/2,p.x,p.y,v.x,v.y),E=Math.atan2(v.y-p.y,v.x-p.x);this.glyphInfo.push({transposeX:k.x,transposeY:k.y,text:u[d],rotation:E,p0:p,p1:v}),f+=m}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(f){t.push(f.p0.x),t.push(f.p0.y),t.push(f.p1.x),t.push(f.p1.y)});let r=t[0]||0,n=t[0]||0,i=t[1]||0,a=t[1]||0,s,o;for(let f=0;f<t.length/2;f++)s=t[f*2],o=t[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const u=this.fontSize();return{x:r-u/2,y:i-u/2,width:n-r+u,height:a-i+u}}destroy(){return yg.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Uh.TextPath=Dr;Dr.prototype._fillFunc=ew;Dr.prototype._strokeFunc=tw;Dr.prototype._fillFuncHit=ew;Dr.prototype._strokeFuncHit=tw;Dr.prototype.className="TextPath";Dr.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Hb._registerNode)(Dr);Qi.Factory.addGetterSetter(Dr,"data");Qi.Factory.addGetterSetter(Dr,"fontFamily","Arial");Qi.Factory.addGetterSetter(Dr,"fontSize",12,(0,JS.getNumberValidator)());Qi.Factory.addGetterSetter(Dr,"fontStyle",ZS);Qi.Factory.addGetterSetter(Dr,"align","left");Qi.Factory.addGetterSetter(Dr,"letterSpacing",0,(0,JS.getNumberValidator)());Qi.Factory.addGetterSetter(Dr,"textBaseline","middle");Qi.Factory.addGetterSetter(Dr,"fontVariant",ZS);Qi.Factory.addGetterSetter(Dr,"text",Wb);Qi.Factory.addGetterSetter(Dr,"textDecoration","");Qi.Factory.addGetterSetter(Dr,"kerningFunc",void 0);var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.Transformer=void 0;const Bt=ir,Rt=pt,Q3=Jt,$b=Ir,Xb=vu,q3=lc,Mi=ft,Ws=rt,Kb=ft,rw="tr-konva",Yb=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${rw}`).join(" "),J3="nodesRect",Qb=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],qb={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Jb="ontouchstart"in Mi.Konva._global;function Zb(e,t,r){if(e==="rotater")return r;t+=Bt.Util.degToRad(qb[e]||0);const n=(Bt.Util.radToDeg(t)%360+360)%360;return Bt.Util._inRange(n,315+22.5,360)||Bt.Util._inRange(n,0,22.5)?"ns-resize":Bt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Bt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Bt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Bt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Bt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Bt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Bt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Bt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Hd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Z3=1e8;function eL(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function nw(e,t,r){const n=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),i=r.y+(e.x-r.x)*Math.sin(t)+(e.y-r.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:n,y:i}}function tL(e,t){const r=eL(e);return nw(e,t,r)}function rL(e,t,r){let n=t;for(let i=0;i<e.length;i++){const a=Mi.Konva.getAngle(e[i]),s=Math.abs(a-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let jm=0;class St extends q3.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Yb,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Bt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return rw+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const r=t.filter(i=>i.isAncestorOf(this)?(Bt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=r,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on(Qb.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let r;t.on(`dragstart.${this._getEventNamespace()}`,n=>{r=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=t.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const u=o.getAbsolutePosition();o.setAbsolutePosition({x:u.x+a,y:u.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(J3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(J3,this.__getNodeRect)}__getNodeShape(t,r=this.rotation(),n){const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),o=i.x*a.x-t.offsetX()*a.x,u=i.y*a.y-t.offsetY()*a.y,f=(Mi.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+o*Math.cos(f)+u*Math.sin(-f),y:s.y+u*Math.cos(f)+o*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return nw(d,-Mi.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Z3,y:-Z3,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),p=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],m=f.getAbsoluteTransform();p.forEach(function(v){const g=m.point(v);r.push(g)})});const n=new Bt.Transform;n.rotate(-Mi.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),n.invert();const u=n.point({x:i,y:a});return{x:u.x,y:u.y,width:s-i,height:o-a,rotation:Mi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Hd.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const r=new Xb.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Jb?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=Mi.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=Zb(t,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const t=new $b.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*Bt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",r=>{r.cancelBubble=!0}),t.on("dragmove",r=>{r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},jm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:t.evt,target:u})})}_handleMouseMove(t){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let u={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,t)),a.setAbsolutePosition(u);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const S=this._getNodeRect();r=a.x()-S.width/2,n=-a.y()+S.height/2;let x=Math.atan2(-n,r)+Math.PI/2;S.height<0&&(x-=Math.PI);const N=Mi.Konva.getAngle(this.rotation())+x,T=Mi.Konva.getAngle(this.rotationSnapTolerance()),P=rL(this.rotationSnaps(),N,T)-S.rotation,I=tL(S,P);this._fitNodesInto(I,t);return}const p=this.shiftBehavior();let m;p==="inverted"?m=this.keepRatio()&&!t.shiftKey:p==="none"?m=this.keepRatio():m=this.keepRatio()||t.shiftKey;let v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(S.x-a.x(),2)+Math.pow(S.y-a.y(),2));const x=this.findOne(".top-left").x()>S.x?-1:1,C=this.findOne(".top-left").y()>S.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".top-left").x(S.x-r),this.findOne(".top-left").y(S.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-S.x,2)+Math.pow(S.y-a.y(),2));const x=this.findOne(".top-right").x()<S.x?-1:1,C=this.findOne(".top-right").y()>S.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".top-right").x(S.x+r),this.findOne(".top-right").y(S.y-n)}var g=a.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(S.x-a.x(),2)+Math.pow(a.y()-S.y,2));const x=S.x<a.x()?-1:1,C=a.y()<S.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,a.x(S.x-r),a.y(S.y+n)}g=a.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-S.x,2)+Math.pow(a.y()-S.y,2));const x=this.findOne(".bottom-right").x()<S.x?-1:1,C=this.findOne(".bottom-right").y()<S.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".bottom-right").x(S.x+r),this.findOne(".bottom-right").y(S.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(v=this.centeredScaling()||t.altKey,v){const S=this.findOne(".top-left"),x=this.findOne(".bottom-right"),C=S.x(),N=S.y(),T=this.getWidth()-x.x(),F=this.getHeight()-x.y();x.move({x:-C,y:-N}),S.move({x:T,y:F})}const _=this.findOne(".top-left").getAbsolutePosition();r=_.x,n=_.y;const k=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),E=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:k,height:E,rotation:Mi.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();jm--,this._fire("transformend",{evt:t,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:t,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,r){const n=this._getNodeRect(),i=1;if(Bt.Util._inRange(t.width,-this.padding()*2-i,i)){this.update();return}if(Bt.Util._inRange(t.height,-this.padding()*2-i,i)){this.update();return}const a=new Bt.Transform;if(a.rotate(Mi.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const m=a.point({x:-this.padding()*2,y:0});t.x+=m.x,t.y+=m.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const m=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const m=a.point({x:0,y:-this.padding()*2});t.x+=m.x,t.y+=m.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const m=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const m=this.boundBoxFunc()(n,t);m?t=m:Bt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new Bt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const u=new Bt.Transform,f=t.width/s,d=t.height/s;this.flipEnabled()===!1?(u.translate(t.x,t.y),u.rotate(t.rotation),u.translate(t.width<0?t.width:0,t.height<0?t.height:0),u.scale(Math.abs(f),Math.abs(d))):(u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(f,d));const p=u.multiply(o.invert());this._nodes.forEach(m=>{var v;const g=m.getParent().getAbsoluteTransform(),_=m.getTransform().copy();_.translate(m.offsetX(),m.offsetY());const k=new Bt.Transform;k.multiply(g.copy().invert()).multiply(p).multiply(g).multiply(_);const E=k.decompose();m.setAttrs(E),(v=m.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(Bt.Util._getRotation(t.rotation)),this._nodes.forEach(m=>{this._fire("transform",{evt:r,target:m}),m._fire("transform",{evt:r,target:m})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,r){this.findOne(t).setAttrs(r)}update(){var t;const r=this._getNodeRect();this.rotation(Bt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(p=>{p.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+o,offsetY:u/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-o,offsetY:u/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Bt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(p=>{d(p)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),q3.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q3.Node.prototype.toObject.call(this)}clone(t){return Q3.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}jh.Transformer=St;St.isTransforming=()=>jm>0;function nL(e){return e instanceof Array||Bt.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Hd.indexOf(t)===-1&&Bt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Hd.join(", "))}),e||[]}St.prototype.className="Transformer";(0,Kb._registerNode)(St);Rt.Factory.addGetterSetter(St,"enabledAnchors",Hd,nL);Rt.Factory.addGetterSetter(St,"flipEnabled",!0,(0,Ws.getBooleanValidator)());Rt.Factory.addGetterSetter(St,"resizeEnabled",!0);Rt.Factory.addGetterSetter(St,"anchorSize",10,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"rotateEnabled",!0);Rt.Factory.addGetterSetter(St,"rotateLineVisible",!0);Rt.Factory.addGetterSetter(St,"rotationSnaps",[]);Rt.Factory.addGetterSetter(St,"rotateAnchorOffset",50,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"rotateAnchorCursor","crosshair");Rt.Factory.addGetterSetter(St,"rotationSnapTolerance",5,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"borderEnabled",!0);Rt.Factory.addGetterSetter(St,"anchorStroke","rgb(0, 161, 255)");Rt.Factory.addGetterSetter(St,"anchorStrokeWidth",1,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"anchorFill","white");Rt.Factory.addGetterSetter(St,"anchorCornerRadius",0,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"borderStroke","rgb(0, 161, 255)");Rt.Factory.addGetterSetter(St,"borderStrokeWidth",1,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"borderDash");Rt.Factory.addGetterSetter(St,"keepRatio",!0);Rt.Factory.addGetterSetter(St,"shiftBehavior","default");Rt.Factory.addGetterSetter(St,"centeredScaling",!1);Rt.Factory.addGetterSetter(St,"ignoreStroke",!1);Rt.Factory.addGetterSetter(St,"padding",0,(0,Ws.getNumberValidator)());Rt.Factory.addGetterSetter(St,"nodes");Rt.Factory.addGetterSetter(St,"node");Rt.Factory.addGetterSetter(St,"boundBoxFunc");Rt.Factory.addGetterSetter(St,"anchorDragBoundFunc");Rt.Factory.addGetterSetter(St,"anchorStyleFunc");Rt.Factory.addGetterSetter(St,"shouldOverdrawWholeArea",!1);Rt.Factory.addGetterSetter(St,"useSingleNodeRotation",!0);Rt.Factory.backCompat(St,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});zh.Wedge=void 0;const Vh=pt,iL=Ir,aL=ft,iw=rt,sL=ft;class qa extends iL.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,aL.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}zh.Wedge=qa;qa.prototype.className="Wedge";qa.prototype._centroid=!0;qa.prototype._attrsAffectingSize=["radius"];(0,sL._registerNode)(qa);Vh.Factory.addGetterSetter(qa,"radius",0,(0,iw.getNumberValidator)());Vh.Factory.addGetterSetter(qa,"angle",0,(0,iw.getNumberValidator)());Vh.Factory.addGetterSetter(qa,"clockwise",!1);Vh.Factory.backCompat(qa,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.Blur=void 0;const e5=pt,oL=Jt,lL=rt;function t5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const cL=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],uL=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function fL(e,t){const r=e.data,n=e.width,i=e.height;let a,s,o,u,f,d,p,m,v,g,_,k,E,S,x,C,N,T,F,P;const I=t+t+1,D=n-1,U=i-1,b=t+1,Q=b*(b+1)/2,he=new t5,te=cL[t],Ae=uL[t];let Te=null,ie=he,X=null,ce=null;for(let Ce=1;Ce<I;Ce++)ie=ie.next=new t5,Ce===b&&(Te=ie);ie.next=he,o=s=0;for(let Ce=0;Ce<i;Ce++){k=E=S=x=u=f=d=p=0,m=b*(C=r[s]),v=b*(N=r[s+1]),g=b*(T=r[s+2]),_=b*(F=r[s+3]),u+=Q*C,f+=Q*N,d+=Q*T,p+=Q*F,ie=he;for(let L=0;L<b;L++)ie.r=C,ie.g=N,ie.b=T,ie.a=F,ie=ie.next;for(let L=1;L<b;L++)a=s+((D<L?D:L)<<2),u+=(ie.r=C=r[a])*(P=b-L),f+=(ie.g=N=r[a+1])*P,d+=(ie.b=T=r[a+2])*P,p+=(ie.a=F=r[a+3])*P,k+=C,E+=N,S+=T,x+=F,ie=ie.next;X=he,ce=Te;for(let L=0;L<n;L++)r[s+3]=F=p*te>>Ae,F!==0?(F=255/F,r[s]=(u*te>>Ae)*F,r[s+1]=(f*te>>Ae)*F,r[s+2]=(d*te>>Ae)*F):r[s]=r[s+1]=r[s+2]=0,u-=m,f-=v,d-=g,p-=_,m-=X.r,v-=X.g,g-=X.b,_-=X.a,a=o+((a=L+t+1)<D?a:D)<<2,k+=X.r=r[a],E+=X.g=r[a+1],S+=X.b=r[a+2],x+=X.a=r[a+3],u+=k,f+=E,d+=S,p+=x,X=X.next,m+=C=ce.r,v+=N=ce.g,g+=T=ce.b,_+=F=ce.a,k-=C,E-=N,S-=T,x-=F,ce=ce.next,s+=4;o+=n}for(let Ce=0;Ce<n;Ce++){E=S=x=k=f=d=p=u=0,s=Ce<<2,m=b*(C=r[s]),v=b*(N=r[s+1]),g=b*(T=r[s+2]),_=b*(F=r[s+3]),u+=Q*C,f+=Q*N,d+=Q*T,p+=Q*F,ie=he;for(let q=0;q<b;q++)ie.r=C,ie.g=N,ie.b=T,ie.a=F,ie=ie.next;let L=n;for(let q=1;q<=t;q++)s=L+Ce<<2,u+=(ie.r=C=r[s])*(P=b-q),f+=(ie.g=N=r[s+1])*P,d+=(ie.b=T=r[s+2])*P,p+=(ie.a=F=r[s+3])*P,k+=C,E+=N,S+=T,x+=F,ie=ie.next,q<U&&(L+=n);s=Ce,X=he,ce=Te;for(let q=0;q<i;q++)a=s<<2,r[a+3]=F=p*te>>Ae,F>0?(F=255/F,r[a]=(u*te>>Ae)*F,r[a+1]=(f*te>>Ae)*F,r[a+2]=(d*te>>Ae)*F):r[a]=r[a+1]=r[a+2]=0,u-=m,f-=v,d-=g,p-=_,m-=X.r,v-=X.g,g-=X.b,_-=X.a,a=Ce+((a=q+b)<U?a:U)*n<<2,u+=k+=X.r=r[a],f+=E+=X.g=r[a+1],d+=S+=X.b=r[a+2],p+=x+=X.a=r[a+3],X=X.next,m+=C=ce.r,v+=N=ce.g,g+=T=ce.b,_+=F=ce.a,k-=C,E-=N,S-=T,x-=F,ce=ce.next,s+=n}}const dL=function(t){const r=Math.round(this.blurRadius());r>0&&fL(t,r)};Gh.Blur=dL;e5.Factory.addGetterSetter(oL.Node,"blurRadius",0,(0,lL.getNumberValidator)(),e5.Factory.afterSetFilter);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Brighten=void 0;const r5=pt,hL=Jt,pL=rt,gL=function(e){const t=this.brightness()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=t,r[i+1]+=t,r[i+2]+=t};Hh.Brighten=gL;r5.Factory.addGetterSetter(hL.Node,"brightness",0,(0,pL.getNumberValidator)(),r5.Factory.afterSetFilter);var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Contrast=void 0;const n5=pt,mL=Jt,xL=rt,vL=function(e){const t=Math.pow((this.contrast()+100)/100,2),r=e.data,n=r.length;let i=150,a=150,s=150;for(let o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};Wh.Contrast=vL;n5.Factory.addGetterSetter(mL.Node,"contrast",0,(0,xL.getNumberValidator)(),n5.Factory.afterSetFilter);var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.Emboss=void 0;const bs=pt,Xh=Jt,yL=ir,aw=rt,_L=function(e){const t=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=e.data,s=e.width,o=e.height,u=s*4;let f=0,d=0,p=o;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:yL.Util.error("Unknown emboss direction: "+n)}do{const m=(p-1)*u;let v=f;p+v<1&&(v=0),p+v>o&&(v=0);const g=(p-1+v)*s*4;let _=s;do{const k=m+(_-1)*4;let E=d;_+E<1&&(E=0),_+E>s&&(E=0);const S=g+(_-1+E)*4,x=a[k]-a[S],C=a[k+1]-a[S+1],N=a[k+2]-a[S+2];let T=x;const F=T>0?T:-T,P=C>0?C:-C,I=N>0?N:-N;if(P>F&&(T=C),I>F&&(T=N),T*=t,i){const D=a[k]+T,U=a[k+1]+T,b=a[k+2]+T;a[k]=D>255?255:D<0?0:D,a[k+1]=U>255?255:U<0?0:U,a[k+2]=b>255?255:b<0?0:b}else{let D=r-T;D<0?D=0:D>255&&(D=255),a[k]=a[k+1]=a[k+2]=D}}while(--_)}while(--p)};$h.Emboss=_L;bs.Factory.addGetterSetter(Xh.Node,"embossStrength",.5,(0,aw.getNumberValidator)(),bs.Factory.afterSetFilter);bs.Factory.addGetterSetter(Xh.Node,"embossWhiteLevel",.5,(0,aw.getNumberValidator)(),bs.Factory.afterSetFilter);bs.Factory.addGetterSetter(Xh.Node,"embossDirection","top-left",void 0,bs.Factory.afterSetFilter);bs.Factory.addGetterSetter(Xh.Node,"embossBlend",!1,void 0,bs.Factory.afterSetFilter);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Enhance=void 0;const i5=pt,SL=Jt,wL=rt;function Sg(e,t,r,n,i){const a=r-t,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let o=(e-t)/a;return o=s*o+n,o}const kL=function(e){const t=e.data,r=t.length;let n=t[0],i=n,a,s=t[1],o=s,u,f=t[2],d=f,p;const m=this.enhance();if(m===0)return;for(let x=0;x<r;x+=4)a=t[x+0],a<n?n=a:a>i&&(i=a),u=t[x+1],u<s?s=u:u>o&&(o=u),p=t[x+2],p<f?f=p:p>d&&(d=p);i===n&&(i=255,n=0),o===s&&(o=255,s=0),d===f&&(d=255,f=0);let v,g,_,k,E,S;if(m>0)v=i+m*(255-i),g=n-m*(n-0),_=o+m*(255-o),k=s-m*(s-0),E=d+m*(255-d),S=f-m*(f-0);else{const x=(i+n)*.5;v=i+m*(i-x),g=n+m*(n-x);const C=(o+s)*.5;_=o+m*(o-C),k=s+m*(s-C);const N=(d+f)*.5;E=d+m*(d-N),S=f+m*(f-N)}for(let x=0;x<r;x+=4)t[x+0]=Sg(t[x+0],n,i,g,v),t[x+1]=Sg(t[x+1],s,o,k,_),t[x+2]=Sg(t[x+2],f,d,S,E)};Kh.Enhance=kL;i5.Factory.addGetterSetter(SL.Node,"enhance",0,(0,wL.getNumberValidator)(),i5.Factory.afterSetFilter);var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Grayscale=void 0;const EL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=i,t[n+1]=i,t[n+2]=i}};Yh.Grayscale=EL;var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.HSL=void 0;const Jl=pt,Ex=Jt,Cx=rt;Jl.Factory.addGetterSetter(Ex.Node,"hue",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);Jl.Factory.addGetterSetter(Ex.Node,"saturation",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);Jl.Factory.addGetterSetter(Ex.Node,"luminance",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);const CL=function(e){const t=e.data,r=t.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*o+.167*u,d=.587*n-.587*o+.33*u,p=.114*n-.114*o-.497*u,m=.299*n-.299*o-.328*u,v=.587*n+.413*o+.035*u,g=.114*n-.114*o+.293*u,_=.299*n-.3*o+1.25*u,k=.587*n-.586*o-1.05*u,E=.114*n+.886*o-.2*u;let S,x,C,N;for(let T=0;T<r;T+=4)S=t[T+0],x=t[T+1],C=t[T+2],N=t[T+3],t[T+0]=f*S+d*x+p*C+s,t[T+1]=m*S+v*x+g*C+s,t[T+2]=_*S+k*x+E*C+s,t[T+3]=N};Qh.HSL=CL;var qh={};Object.defineProperty(qh,"__esModule",{value:!0});qh.HSV=void 0;const Zl=pt,Tx=Jt,Ax=rt,TL=function(e){const t=e.data,r=t.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*s+.167*o,f=.587*n-.587*s+.33*o,d=.114*n-.114*s-.497*o,p=.299*n-.299*s-.328*o,m=.587*n+.413*s+.035*o,v=.114*n-.114*s+.293*o,g=.299*n-.3*s+1.25*o,_=.587*n-.586*s-1.05*o,k=.114*n+.886*s-.2*o;for(let E=0;E<r;E+=4){const S=t[E+0],x=t[E+1],C=t[E+2],N=t[E+3];t[E+0]=u*S+f*x+d*C,t[E+1]=p*S+m*x+v*C,t[E+2]=g*S+_*x+k*C,t[E+3]=N}};qh.HSV=TL;Zl.Factory.addGetterSetter(Tx.Node,"hue",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Tx.Node,"saturation",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Tx.Node,"value",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Invert=void 0;const AL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};Jh.Invert=AL;var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.Kaleidoscope=void 0;const Wd=pt,sw=Jt,a5=ir,ow=rt,PL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const m=Math.sqrt(d*d+p*p);f=m>f?m:f;const v=s,g=a,_=360/g*Math.PI/180;for(let k=0;k<g;k+=1){const E=Math.sin(k*_),S=Math.cos(k*_);for(let x=0;x<v;x+=1){d=Math.floor(o+f*x/v*S),p=Math.floor(u+f*x/v*E);let C=(p*a+d)*4;const N=n[C+0],T=n[C+1],F=n[C+2],P=n[C+3];C=(k+x*a)*4,i[C+0]=N,i[C+1]=T,i[C+2]=F,i[C+3]=P}}},FL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const m=Math.sqrt(d*d+p*p);f=m>f?m:f;const v=s,g=a,_=r.polarRotation||0;let k,E;for(d=0;d<a;d+=1)for(p=0;p<s;p+=1){const S=d-o,x=p-u,C=Math.sqrt(S*S+x*x)*v/f;let N=(Math.atan2(x,S)*180/Math.PI+360+_)%360;N=N*g/360,k=Math.floor(N),E=Math.floor(C);let T=(E*a+k)*4;const F=n[T+0],P=n[T+1],I=n[T+2],D=n[T+3];T=(p*a+d)*4,i[T+0]=F,i[T+1]=P,i[T+2]=I,i[T+3]=D}},NL=function(e){const t=e.width,r=e.height;let n,i,a,s,o,u,f,d,p,m,v=Math.round(this.kaleidoscopePower());const g=Math.round(this.kaleidoscopeAngle()),_=Math.floor(t*(g%360)/360);if(v<1)return;const k=a5.Util.createCanvasElement();k.width=t,k.height=r;const E=k.getContext("2d").getImageData(0,0,t,r);a5.Util.releaseCanvas(k),PL(e,E,{polarCenterX:t/2,polarCenterY:r/2});let S=t/Math.pow(2,v);for(;S<=8;)S=S*2,v-=1;S=Math.ceil(S);let x=S,C=0,N=x,T=1;for(_+S>t&&(C=x,N=0,T=-1),i=0;i<r;i+=1)for(n=C;n!==N;n+=T)a=Math.round(n+_)%t,p=(t*i+a)*4,o=E.data[p+0],u=E.data[p+1],f=E.data[p+2],d=E.data[p+3],m=(t*i+n)*4,E.data[m+0]=o,E.data[m+1]=u,E.data[m+2]=f,E.data[m+3]=d;for(i=0;i<r;i+=1)for(x=Math.floor(S),s=0;s<v;s+=1){for(n=0;n<x+1;n+=1)p=(t*i+n)*4,o=E.data[p+0],u=E.data[p+1],f=E.data[p+2],d=E.data[p+3],m=(t*i+x*2-n-1)*4,E.data[m+0]=o,E.data[m+1]=u,E.data[m+2]=f,E.data[m+3]=d;x*=2}FL(E,e,{polarRotation:0})};Zh.Kaleidoscope=NL;Wd.Factory.addGetterSetter(sw.Node,"kaleidoscopePower",2,(0,ow.getNumberValidator)(),Wd.Factory.afterSetFilter);Wd.Factory.addGetterSetter(sw.Node,"kaleidoscopeAngle",0,(0,ow.getNumberValidator)(),Wd.Factory.afterSetFilter);var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.Mask=void 0;const s5=pt,RL=Jt,IL=rt;function Gf(e,t,r){let n=(r*e.width+t)*4;const i=[];return i.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),i}function $c(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function DL(e){const t=[0,0,0];for(let r=0;r<e.length;r++)t[0]+=e[r][0],t[1]+=e[r][1],t[2]+=e[r][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function OL(e,t){const r=Gf(e,0,0),n=Gf(e,e.width-1,0),i=Gf(e,0,e.height-1),a=Gf(e,e.width-1,e.height-1),s=t||10;if($c(r,n)<s&&$c(n,a)<s&&$c(a,i)<s&&$c(i,r)<s){const o=DL([n,r,a,i]),u=[];for(let f=0;f<e.width*e.height;f++){const d=$c(o,[e.data[f*4],e.data[f*4+1],e.data[f*4+2]]);u[f]=d<s?0:255}return u}}function bL(e,t){for(let r=0;r<e.width*e.height;r++)e.data[4*r+3]=t[r]}function LL(e,t,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const _=v*t+g,k=n[p*i+m];d+=e[_]*k}}s[f]=d===255*8?255:0}return s}function ML(e,t,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const _=v*t+g,k=n[p*i+m];d+=e[_]*k}}s[f]=d>=255*4?255:0}return s}function BL(e,t,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const _=v*t+g,k=n[p*i+m];d+=e[_]*k}}s[f]=d}return s}const UL=function(e){const t=this.threshold();let r=OL(e,t);return r&&(r=LL(r,e.width,e.height),r=ML(r,e.width,e.height),r=BL(r,e.width,e.height),bL(e,r)),e};e1.Mask=UL;s5.Factory.addGetterSetter(RL.Node,"threshold",0,(0,IL.getNumberValidator)(),s5.Factory.afterSetFilter);var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.Noise=void 0;const o5=pt,jL=Jt,zL=rt,VL=function(e){const t=this.noise()*255,r=e.data,n=r.length,i=t/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};t1.Noise=VL;o5.Factory.addGetterSetter(jL.Node,"noise",.2,(0,zL.getNumberValidator)(),o5.Factory.afterSetFilter);var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Pixelate=void 0;const l5=pt,GL=ir,HL=Jt,WL=rt,$L=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,n=e.height,i=Math.ceil(r/t),a=Math.ceil(n/t),s=e.data;if(t<=0){GL.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let u=0;u<a;u+=1){let f=0,d=0,p=0,m=0;const v=o*t,g=v+t,_=u*t,k=_+t;let E=0;for(let S=v;S<g;S+=1)if(!(S>=r))for(let x=_;x<k;x+=1){if(x>=n)continue;const C=(r*x+S)*4;f+=s[C+0],d+=s[C+1],p+=s[C+2],m+=s[C+3],E+=1}f=f/E,d=d/E,p=p/E,m=m/E;for(let S=v;S<g;S+=1)if(!(S>=r))for(let x=_;x<k;x+=1){if(x>=n)continue;const C=(r*x+S)*4;s[C+0]=f,s[C+1]=d,s[C+2]=p,s[C+3]=m}}};r1.Pixelate=$L;l5.Factory.addGetterSetter(HL.Node,"pixelSize",8,(0,WL.getNumberValidator)(),l5.Factory.afterSetFilter);var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Posterize=void 0;const c5=pt,XL=Jt,KL=rt,YL=function(e){const t=Math.round(this.levels()*254)+1,r=e.data,n=r.length,i=255/t;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};n1.Posterize=YL;c5.Factory.addGetterSetter(XL.Node,"levels",.5,(0,KL.getNumberValidator)(),c5.Factory.afterSetFilter);var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.RGB=void 0;const $d=pt,Px=Jt,QL=rt,qL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const o=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=o*n,t[s+1]=o*i,t[s+2]=o*a,t[s+3]=t[s+3]}};i1.RGB=qL;$d.Factory.addGetterSetter(Px.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});$d.Factory.addGetterSetter(Px.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});$d.Factory.addGetterSetter(Px.Node,"blue",0,QL.RGBComponent,$d.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.RGBA=void 0;const tu=pt,s1=Jt,JL=rt,ZL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const u=1-s;t[o]=n*s+t[o]*u,t[o+1]=i*s+t[o+1]*u,t[o+2]=a*s+t[o+2]*u}};a1.RGBA=ZL;tu.Factory.addGetterSetter(s1.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});tu.Factory.addGetterSetter(s1.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});tu.Factory.addGetterSetter(s1.Node,"blue",0,JL.RGBComponent,tu.Factory.afterSetFilter);tu.Factory.addGetterSetter(s1.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.Sepia=void 0;const eM=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=t[n+0],a=t[n+1],s=t[n+2];t[n+0]=Math.min(255,i*.393+a*.769+s*.189),t[n+1]=Math.min(255,i*.349+a*.686+s*.168),t[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};o1.Sepia=eM;var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.Solarize=void 0;const tM=function(e){const t=e.data,r=e.width,n=e.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const u=s+(o-1)*4;let f=t[u],d=t[u+1],p=t[u+2];f>127&&(f=255-f),d>127&&(d=255-d),p>127&&(p=255-p),t[u]=f,t[u+1]=d,t[u+2]=p}while(--o)}while(--a)};l1.Solarize=tM;var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.Threshold=void 0;const u5=pt,rM=Jt,nM=rt,iM=function(e){const t=this.threshold()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<t?0:255};c1.Threshold=iM;u5.Factory.addGetterSetter(rM.Node,"threshold",.5,(0,nM.getNumberValidator)(),u5.Factory.afterSetFilter);Object.defineProperty(yh,"__esModule",{value:!0});yh.Konva=void 0;const f5=Vd,aM=Eh,sM=Ah,oM=Nh,lM=Rh,cM=Ih,d5=ql,uM=mu,fM=uc,dM=vu,hM=bh,pM=Lh,gM=Mh,mM=Bh,xM=dc,vM=Uh,yM=jh,_M=zh,SM=Gh,wM=Hh,kM=Wh,EM=$h,CM=Kh,TM=Yh,AM=Qh,PM=qh,FM=Jh,NM=Zh,RM=e1,IM=t1,DM=r1,OM=n1,bM=i1,LM=a1,MM=o1,BM=l1,UM=c1;yh.Konva=f5.Konva.Util._assign(f5.Konva,{Arc:aM.Arc,Arrow:sM.Arrow,Circle:oM.Circle,Ellipse:lM.Ellipse,Image:cM.Image,Label:d5.Label,Tag:d5.Tag,Line:uM.Line,Path:fM.Path,Rect:dM.Rect,RegularPolygon:hM.RegularPolygon,Ring:pM.Ring,Sprite:gM.Sprite,Star:mM.Star,Text:xM.Text,TextPath:vM.TextPath,Transformer:yM.Transformer,Wedge:_M.Wedge,Filters:{Blur:SM.Blur,Brighten:wM.Brighten,Contrast:kM.Contrast,Emboss:EM.Emboss,Enhance:CM.Enhance,Grayscale:TM.Grayscale,HSL:AM.HSL,HSV:PM.HSV,Invert:FM.Invert,Kaleidoscope:NM.Kaleidoscope,Mask:RM.Mask,Noise:IM.Noise,Pixelate:DM.Pixelate,Posterize:OM.Posterize,RGB:bM.RGB,RGBA:LM.RGBA,Sepia:MM.Sepia,Solarize:BM.Solarize,Threshold:UM.Threshold}});var jM=PS.exports;Object.defineProperty(jM,"__esModule",{value:!0});const zM=yh;PS.exports=zM.Konva;var zm={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=Vd;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Vd;e.exports=n.Konva})(zm,zm.exports);var VM=zm.exports;const ru=Xd(VM);var lw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GM=function(t){var r={},n=ke,i=s0,a=Object.assign;function s(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),g=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),N=Symbol.iterator;function T(l){return l===null||typeof l!="object"?null:(l=N&&l[N]||l["@@iterator"],typeof l=="function"?l:null)}function F(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case m:return"Profiler";case p:return"StrictMode";case k:return"Suspense";case E:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case g:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case _:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case S:return c=l.displayName||null,c!==null?c:F(l.type)||"Memo";case x:c=l._payload,l=l._init;try{return F(l(c))}catch{}}return null}function P(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(c);case 8:return c===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function I(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function D(l){if(I(l)!==l)throw Error(s(188))}function U(l){var c=l.alternate;if(!c){if(c=I(l),c===null)throw Error(s(188));return c!==l?null:l}for(var h=l,y=c;;){var w=h.return;if(w===null)break;var R=w.alternate;if(R===null){if(y=w.return,y!==null){h=y;continue}break}if(w.child===R.child){for(R=w.child;R;){if(R===h)return D(w),l;if(R===y)return D(w),c;R=R.sibling}throw Error(s(188))}if(h.return!==y.return)h=w,y=R;else{for(var B=!1,Z=w.child;Z;){if(Z===h){B=!0,h=w,y=R;break}if(Z===y){B=!0,y=w,h=R;break}Z=Z.sibling}if(!B){for(Z=R.child;Z;){if(Z===h){B=!0,h=R,y=w;break}if(Z===y){B=!0,y=R,h=w;break}Z=Z.sibling}if(!B)throw Error(s(189))}}if(h.alternate!==y)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?l:c}function b(l){return l=U(l),l!==null?Q(l):null}function Q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Q(l);if(c!==null)return c;l=l.sibling}return null}function he(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=he(l);if(c!==null)return c}l=l.sibling}return null}var te=Array.isArray,Ae=t.getPublicInstance,Te=t.getRootHostContext,ie=t.getChildHostContext,X=t.prepareForCommit,ce=t.resetAfterCommit,Ce=t.createInstance,L=t.appendInitialChild,q=t.finalizeInitialChildren,Y=t.prepareUpdate,K=t.shouldSetTextContent,de=t.createTextInstance,G=t.scheduleTimeout,J=t.cancelTimeout,ue=t.noTimeout,ve=t.isPrimaryRenderer,Be=t.supportsMutation,V=t.supportsPersistence,Ze=t.supportsHydration,nt=t.getInstanceFromNode,Ye=t.preparePortalMount,Je=t.getCurrentEventPriority,Re=t.detachDeletedInstance,wt=t.supportsMicrotasks,Or=t.scheduleMicrotask,pr=t.supportsTestSelectors,_e=t.findFiberRoot,me=t.getBoundingRect,Se=t.getTextContent,we=t.isHiddenSubtree,Ee=t.matchAccessibilityRole,Pe=t.setFocusIfFocusable,Me=t.setupIntersectionObserver,pe=t.appendChild,re=t.appendChildToContainer,xe=t.commitTextUpdate,De=t.commitMount,Le=t.commitUpdate,Ke=t.insertBefore,xt=t.insertInContainerBefore,Dt=t.removeChild,Ut=t.removeChildFromContainer,Fe=t.resetTextContent,Xe=t.hideInstance,Qe=t.hideTextInstance,qe=t.unhideInstance,kt=t.unhideTextInstance,dt=t.clearContainer,gt=t.cloneInstance,Hn=t.createContainerChildSet,yn=t.appendChildToContainerChildSet,va=t.finalizeContainerChildren,_n=t.replaceContainerChildren,Zr=t.cloneHiddenInstance,Xs=t.cloneHiddenTextInstance,$o=t.canHydrateInstance,f1=t.canHydrateTextInstance,hc=t.canHydrateSuspenseInstance,yu=t.isSuspenseInstancePending,pc=t.isSuspenseInstanceFallback,d1=t.getSuspenseInstanceFallbackErrorDetails,O=t.registerSuspenseInstanceRetry,z=t.getNextHydratableSibling,M=t.getFirstHydratableChild,j=t.getFirstHydratableChildWithinContainer,H=t.getFirstHydratableChildWithinSuspenseInstance,W=t.hydrateInstance,ae=t.hydrateTextInstance,ye=t.hydrateSuspenseInstance,ne=t.getNextHydratableInstanceAfterSuspenseInstance,se=t.commitHydratedContainer,oe=t.commitHydratedSuspenseInstance,Ne=t.clearSuspenseBoundary,Ue=t.clearSuspenseBoundaryFromContainer,Ge=t.shouldDeleteUnhydratedTailInstances,Oe=t.didNotMatchHydratedContainerTextInstance,je=t.didNotMatchHydratedTextInstance,it;function Ot(l){if(it===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);it=c&&c[1]||""}return`
`+it+l}var jt=!1;function gr(l,c){if(!l||jt)return"";jt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(be){var y=be}Reflect.construct(l,[],c)}else{try{c.call()}catch(be){y=be}l.call(c.prototype)}else{try{throw Error()}catch(be){y=be}l()}}catch(be){if(be&&y&&typeof be.stack=="string"){for(var w=be.stack.split(`
`),R=y.stack.split(`
`),B=w.length-1,Z=R.length-1;1<=B&&0<=Z&&w[B]!==R[Z];)Z--;for(;1<=B&&0<=Z;B--,Z--)if(w[B]!==R[Z]){if(B!==1||Z!==1)do if(B--,Z--,0>Z||w[B]!==R[Z]){var fe=`
`+w[B].replace(" at new "," at ");return l.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",l.displayName)),fe}while(1<=B&&0<=Z);break}}}finally{jt=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?Ot(l):""}var Ks=Object.prototype.hasOwnProperty,ya=[],ai=-1;function en(l){return{current:l}}function bt(l){0>ai||(l.current=ya[ai],ya[ai]=null,ai--)}function vt(l,c){ai++,ya[ai]=l.current,l.current=c}var Ja={},tn=en(Ja),In=en(!1),Ys=Ja;function Xo(l,c){var h=l.type.contextTypes;if(!h)return Ja;var y=l.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var w={},R;for(R in h)w[R]=c[R];return y&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=w),w}function Dn(l){return l=l.childContextTypes,l!=null}function _u(){bt(In),bt(tn)}function Rx(l,c,h){if(tn.current!==Ja)throw Error(s(168));vt(tn,c),vt(In,h)}function Ix(l,c,h){var y=l.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return h;y=y.getChildContext();for(var w in y)if(!(w in c))throw Error(s(108,P(l)||"Unknown",w));return a({},h,y)}function Su(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Ja,Ys=tn.current,vt(tn,l),vt(In,In.current),!0}function Dx(l,c,h){var y=l.stateNode;if(!y)throw Error(s(169));h?(l=Ix(l,c,Ys),y.__reactInternalMemoizedMergedChildContext=l,bt(In),bt(tn),vt(tn,l)):bt(In),vt(In,h)}var Pi=Math.clz32?Math.clz32:vw,mw=Math.log,xw=Math.LN2;function vw(l){return l>>>=0,l===0?32:31-(mw(l)/xw|0)|0}var wu=64,ku=4194304;function gc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Eu(l,c){var h=l.pendingLanes;if(h===0)return 0;var y=0,w=l.suspendedLanes,R=l.pingedLanes,B=h&268435455;if(B!==0){var Z=B&~w;Z!==0?y=gc(Z):(R&=B,R!==0&&(y=gc(R)))}else B=h&~w,B!==0?y=gc(B):R!==0&&(y=gc(R));if(y===0)return 0;if(c!==0&&c!==y&&!(c&w)&&(w=y&-y,R=c&-c,w>=R||w===16&&(R&4194240)!==0))return c;if(y&4&&(y|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=y;0<c;)h=31-Pi(c),w=1<<h,y|=l[h],c&=~w;return y}function yw(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _w(l,c){for(var h=l.suspendedLanes,y=l.pingedLanes,w=l.expirationTimes,R=l.pendingLanes;0<R;){var B=31-Pi(R),Z=1<<B,fe=w[B];fe===-1?(!(Z&h)||Z&y)&&(w[B]=yw(Z,c)):fe<=c&&(l.expiredLanes|=Z),R&=~Z}}function h1(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Ox(){var l=wu;return wu<<=1,!(wu&4194240)&&(wu=64),l}function p1(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function mc(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Pi(c),l[c]=h}function Sw(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var y=l.eventTimes;for(l=l.expirationTimes;0<h;){var w=31-Pi(h),R=1<<w;c[w]=0,y[w]=-1,l[w]=-1,h&=~R}}function g1(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var y=31-Pi(h),w=1<<y;w&c|l[y]&c&&(l[y]|=c),h&=~w}}var Pt=0;function bx(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var m1=i.unstable_scheduleCallback,Lx=i.unstable_cancelCallback,ww=i.unstable_shouldYield,kw=i.unstable_requestPaint,br=i.unstable_now,x1=i.unstable_ImmediatePriority,Ew=i.unstable_UserBlockingPriority,v1=i.unstable_NormalPriority,Cw=i.unstable_IdlePriority,Cu=null,qi=null;function Tw(l){if(qi&&typeof qi.onCommitFiberRoot=="function")try{qi.onCommitFiberRoot(Cu,l,void 0,(l.current.flags&128)===128)}catch{}}function Aw(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Fi=typeof Object.is=="function"?Object.is:Aw,_a=null,Tu=!1,y1=!1;function Mx(l){_a===null?_a=[l]:_a.push(l)}function Pw(l){Tu=!0,Mx(l)}function Ji(){if(!y1&&_a!==null){y1=!0;var l=0,c=Pt;try{var h=_a;for(Pt=1;l<h.length;l++){var y=h[l];do y=y(!0);while(y!==null)}_a=null,Tu=!1}catch(w){throw _a!==null&&(_a=_a.slice(l+1)),m1(x1,Ji),w}finally{Pt=c,y1=!1}}return null}var Ko=[],Yo=0,Au=null,Pu=0,si=[],oi=0,Qs=null,Sa=1,wa="";function qs(l,c){Ko[Yo++]=Pu,Ko[Yo++]=Au,Au=l,Pu=c}function Bx(l,c,h){si[oi++]=Sa,si[oi++]=wa,si[oi++]=Qs,Qs=l;var y=Sa;l=wa;var w=32-Pi(y)-1;y&=~(1<<w),h+=1;var R=32-Pi(c)+w;if(30<R){var B=w-w%5;R=(y&(1<<B)-1).toString(32),y>>=B,w-=B,Sa=1<<32-Pi(c)+w|h<<w|y,wa=R+l}else Sa=1<<R|h<<w|y,wa=l}function _1(l){l.return!==null&&(qs(l,1),Bx(l,1,0))}function S1(l){for(;l===Au;)Au=Ko[--Yo],Ko[Yo]=null,Pu=Ko[--Yo],Ko[Yo]=null;for(;l===Qs;)Qs=si[--oi],si[oi]=null,wa=si[--oi],si[oi]=null,Sa=si[--oi],si[oi]=null}var Wn=null,li=null,Kt=!1,xc=!1,Ni=null;function Ux(l,c){var h=hi(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function jx(l,c){switch(l.tag){case 5:return c=$o(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,li=M(c),!0):!1;case 6:return c=f1(c,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,li=null,!0):!1;case 13:if(c=hc(c),c!==null){var h=Qs!==null?{id:Sa,overflow:wa}:null;return l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=hi(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Wn=l,li=null,!0}return!1;default:return!1}}function w1(l){return(l.mode&1)!==0&&(l.flags&128)===0}function k1(l){if(Kt){var c=li;if(c){var h=c;if(!jx(l,c)){if(w1(l))throw Error(s(418));c=z(h);var y=Wn;c&&jx(l,c)?Ux(y,h):(l.flags=l.flags&-4097|2,Kt=!1,Wn=l)}}else{if(w1(l))throw Error(s(418));l.flags=l.flags&-4097|2,Kt=!1,Wn=l}}}function zx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Wn=l}function Fu(l){if(!Ze||l!==Wn)return!1;if(!Kt)return zx(l),Kt=!0,!1;if(l.tag!==3&&(l.tag!==5||Ge(l.type)&&!K(l.type,l.memoizedProps))){var c=li;if(c){if(w1(l))throw Vx(),Error(s(418));for(;c;)Ux(l,c),c=z(c)}}if(zx(l),l.tag===13){if(!Ze)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));li=ne(l)}else li=Wn?z(l.stateNode):null;return!0}function Vx(){for(var l=li;l;)l=z(l)}function Qo(){Ze&&(li=Wn=null,xc=Kt=!1)}function E1(l){Ni===null?Ni=[l]:Ni.push(l)}var Fw=o.ReactCurrentBatchConfig;function Nu(l,c){if(Fi(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),y=Object.keys(c);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var w=h[y];if(!Ks.call(c,w)||!Fi(l[w],c[w]))return!1}return!0}function Nw(l){switch(l.tag){case 5:return Ot(l.type);case 16:return Ot("Lazy");case 13:return Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 2:case 15:return l=gr(l.type,!1),l;case 11:return l=gr(l.type.render,!1),l;case 1:return l=gr(l.type,!0),l;default:return""}}function vc(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var y=h.stateNode}if(!y)throw Error(s(147,l));var w=y,R=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===R?c.ref:(c=function(B){var Z=w.refs;B===null?delete Z[R]:Z[R]=B},c._stringRef=R,c)}if(typeof l!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,l))}return l}function Ru(l,c){throw l=Object.prototype.toString.call(c),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Gx(l){var c=l._init;return c(l._payload)}function Hx(l){function c(le,ee){if(l){var ge=le.deletions;ge===null?(le.deletions=[ee],le.flags|=16):ge.push(ee)}}function h(le,ee){if(!l)return null;for(;ee!==null;)c(le,ee),ee=ee.sibling;return null}function y(le,ee){for(le=new Map;ee!==null;)ee.key!==null?le.set(ee.key,ee):le.set(ee.index,ee),ee=ee.sibling;return le}function w(le,ee){return le=as(le,ee),le.index=0,le.sibling=null,le}function R(le,ee,ge){return le.index=ge,l?(ge=le.alternate,ge!==null?(ge=ge.index,ge<ee?(le.flags|=2,ee):ge):(le.flags|=2,ee)):(le.flags|=1048576,ee)}function B(le){return l&&le.alternate===null&&(le.flags|=2),le}function Z(le,ee,ge,Ve){return ee===null||ee.tag!==6?(ee=yp(ge,le.mode,Ve),ee.return=le,ee):(ee=w(ee,ge),ee.return=le,ee)}function fe(le,ee,ge,Ve){var et=ge.type;return et===d?$e(le,ee,ge.props.children,Ve,ge.key):ee!==null&&(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===x&&Gx(et)===ee.type)?(Ve=w(ee,ge.props),Ve.ref=vc(le,ee,ge),Ve.return=le,Ve):(Ve=cf(ge.type,ge.key,ge.props,null,le.mode,Ve),Ve.ref=vc(le,ee,ge),Ve.return=le,Ve)}function be(le,ee,ge,Ve){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ge.containerInfo||ee.stateNode.implementation!==ge.implementation?(ee=_p(ge,le.mode,Ve),ee.return=le,ee):(ee=w(ee,ge.children||[]),ee.return=le,ee)}function $e(le,ee,ge,Ve,et){return ee===null||ee.tag!==7?(ee=io(ge,le.mode,Ve,et),ee.return=le,ee):(ee=w(ee,ge),ee.return=le,ee)}function ot(le,ee,ge){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=yp(""+ee,le.mode,ge),ee.return=le,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case u:return ge=cf(ee.type,ee.key,ee.props,null,le.mode,ge),ge.ref=vc(le,null,ee),ge.return=le,ge;case f:return ee=_p(ee,le.mode,ge),ee.return=le,ee;case x:var Ve=ee._init;return ot(le,Ve(ee._payload),ge)}if(te(ee)||T(ee))return ee=io(ee,le.mode,ge,null),ee.return=le,ee;Ru(le,ee)}return null}function ze(le,ee,ge,Ve){var et=ee!==null?ee.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return et!==null?null:Z(le,ee,""+ge,Ve);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:return ge.key===et?fe(le,ee,ge,Ve):null;case f:return ge.key===et?be(le,ee,ge,Ve):null;case x:return et=ge._init,ze(le,ee,et(ge._payload),Ve)}if(te(ge)||T(ge))return et!==null?null:$e(le,ee,ge,Ve,null);Ru(le,ge)}return null}function Wt(le,ee,ge,Ve,et){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return le=le.get(ge)||null,Z(ee,le,""+Ve,et);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case u:return le=le.get(Ve.key===null?ge:Ve.key)||null,fe(ee,le,Ve,et);case f:return le=le.get(Ve.key===null?ge:Ve.key)||null,be(ee,le,Ve,et);case x:var ut=Ve._init;return Wt(le,ee,ge,ut(Ve._payload),et)}if(te(Ve)||T(Ve))return le=le.get(ge)||null,$e(ee,le,Ve,et,null);Ru(ee,Ve)}return null}function zt(le,ee,ge,Ve){for(var et=null,ut=null,lt=ee,Ft=ee=0,Br=null;lt!==null&&Ft<ge.length;Ft++){lt.index>Ft?(Br=lt,lt=null):Br=lt.sibling;var Nt=ze(le,lt,ge[Ft],Ve);if(Nt===null){lt===null&&(lt=Br);break}l&&lt&&Nt.alternate===null&&c(le,lt),ee=R(Nt,ee,Ft),ut===null?et=Nt:ut.sibling=Nt,ut=Nt,lt=Br}if(Ft===ge.length)return h(le,lt),Kt&&qs(le,Ft),et;if(lt===null){for(;Ft<ge.length;Ft++)lt=ot(le,ge[Ft],Ve),lt!==null&&(ee=R(lt,ee,Ft),ut===null?et=lt:ut.sibling=lt,ut=lt);return Kt&&qs(le,Ft),et}for(lt=y(le,lt);Ft<ge.length;Ft++)Br=Wt(lt,le,Ft,ge[Ft],Ve),Br!==null&&(l&&Br.alternate!==null&&lt.delete(Br.key===null?Ft:Br.key),ee=R(Br,ee,Ft),ut===null?et=Br:ut.sibling=Br,ut=Br);return l&&lt.forEach(function(ss){return c(le,ss)}),Kt&&qs(le,Ft),et}function Mn(le,ee,ge,Ve){var et=T(ge);if(typeof et!="function")throw Error(s(150));if(ge=et.call(ge),ge==null)throw Error(s(151));for(var ut=et=null,lt=ee,Ft=ee=0,Br=null,Nt=ge.next();lt!==null&&!Nt.done;Ft++,Nt=ge.next()){lt.index>Ft?(Br=lt,lt=null):Br=lt.sibling;var ss=ze(le,lt,Nt.value,Ve);if(ss===null){lt===null&&(lt=Br);break}l&&lt&&ss.alternate===null&&c(le,lt),ee=R(ss,ee,Ft),ut===null?et=ss:ut.sibling=ss,ut=ss,lt=Br}if(Nt.done)return h(le,lt),Kt&&qs(le,Ft),et;if(lt===null){for(;!Nt.done;Ft++,Nt=ge.next())Nt=ot(le,Nt.value,Ve),Nt!==null&&(ee=R(Nt,ee,Ft),ut===null?et=Nt:ut.sibling=Nt,ut=Nt);return Kt&&qs(le,Ft),et}for(lt=y(le,lt);!Nt.done;Ft++,Nt=ge.next())Nt=Wt(lt,le,Ft,Nt.value,Ve),Nt!==null&&(l&&Nt.alternate!==null&&lt.delete(Nt.key===null?Ft:Nt.key),ee=R(Nt,ee,Ft),ut===null?et=Nt:ut.sibling=Nt,ut=Nt);return l&&lt.forEach(function(sk){return c(le,sk)}),Kt&&qs(le,Ft),et}function Ta(le,ee,ge,Ve){if(typeof ge=="object"&&ge!==null&&ge.type===d&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:e:{for(var et=ge.key,ut=ee;ut!==null;){if(ut.key===et){if(et=ge.type,et===d){if(ut.tag===7){h(le,ut.sibling),ee=w(ut,ge.props.children),ee.return=le,le=ee;break e}}else if(ut.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===x&&Gx(et)===ut.type){h(le,ut.sibling),ee=w(ut,ge.props),ee.ref=vc(le,ut,ge),ee.return=le,le=ee;break e}h(le,ut);break}else c(le,ut);ut=ut.sibling}ge.type===d?(ee=io(ge.props.children,le.mode,Ve,ge.key),ee.return=le,le=ee):(Ve=cf(ge.type,ge.key,ge.props,null,le.mode,Ve),Ve.ref=vc(le,ee,ge),Ve.return=le,le=Ve)}return B(le);case f:e:{for(ut=ge.key;ee!==null;){if(ee.key===ut)if(ee.tag===4&&ee.stateNode.containerInfo===ge.containerInfo&&ee.stateNode.implementation===ge.implementation){h(le,ee.sibling),ee=w(ee,ge.children||[]),ee.return=le,le=ee;break e}else{h(le,ee);break}else c(le,ee);ee=ee.sibling}ee=_p(ge,le.mode,Ve),ee.return=le,le=ee}return B(le);case x:return ut=ge._init,Ta(le,ee,ut(ge._payload),Ve)}if(te(ge))return zt(le,ee,ge,Ve);if(T(ge))return Mn(le,ee,ge,Ve);Ru(le,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ee!==null&&ee.tag===6?(h(le,ee.sibling),ee=w(ee,ge),ee.return=le,le=ee):(h(le,ee),ee=yp(ge,le.mode,Ve),ee.return=le,le=ee),B(le)):h(le,ee)}return Ta}var qo=Hx(!0),Wx=Hx(!1),Iu=en(null),Du=null,Jo=null,C1=null;function T1(){C1=Jo=Du=null}function $x(l,c,h){ve?(vt(Iu,c._currentValue),c._currentValue=h):(vt(Iu,c._currentValue2),c._currentValue2=h)}function A1(l){var c=Iu.current;bt(Iu),ve?l._currentValue=c:l._currentValue2=c}function P1(l,c,h){for(;l!==null;){var y=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),l===h)break;l=l.return}}function Zo(l,c){Du=l,C1=Jo=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(On=!0),l.firstContext=null)}function ci(l){var c=ve?l._currentValue:l._currentValue2;if(C1!==l)if(l={context:l,memoizedValue:c,next:null},Jo===null){if(Du===null)throw Error(s(308));Jo=l,Du.dependencies={lanes:0,firstContext:l}}else Jo=Jo.next=l;return c}var Js=null;function F1(l){Js===null?Js=[l]:Js.push(l)}function Xx(l,c,h,y){var w=c.interleaved;return w===null?(h.next=h,F1(c)):(h.next=w.next,w.next=h),c.interleaved=h,Zi(l,y)}function Zi(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var Za=!1;function N1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function ka(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function es(l,c,h){var y=l.updateQueue;if(y===null)return null;if(y=y.shared,ht&2){var w=y.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),y.pending=c,Zi(l,h)}return w=y.interleaved,w===null?(c.next=c,F1(y)):(c.next=w.next,w.next=c),y.interleaved=c,Zi(l,h)}function Ou(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var y=c.lanes;y&=l.pendingLanes,h|=y,c.lanes=h,g1(l,h)}}function Yx(l,c){var h=l.updateQueue,y=l.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var w=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var B={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};R===null?w=R=B:R=R.next=B,h=h.next}while(h!==null);R===null?w=R=c:R=R.next=c}else w=R=c;h={baseState:y.baseState,firstBaseUpdate:w,lastBaseUpdate:R,shared:y.shared,effects:y.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function bu(l,c,h,y){var w=l.updateQueue;Za=!1;var R=w.firstBaseUpdate,B=w.lastBaseUpdate,Z=w.shared.pending;if(Z!==null){w.shared.pending=null;var fe=Z,be=fe.next;fe.next=null,B===null?R=be:B.next=be,B=fe;var $e=l.alternate;$e!==null&&($e=$e.updateQueue,Z=$e.lastBaseUpdate,Z!==B&&(Z===null?$e.firstBaseUpdate=be:Z.next=be,$e.lastBaseUpdate=fe))}if(R!==null){var ot=w.baseState;B=0,$e=be=fe=null,Z=R;do{var ze=Z.lane,Wt=Z.eventTime;if((y&ze)===ze){$e!==null&&($e=$e.next={eventTime:Wt,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var zt=l,Mn=Z;switch(ze=c,Wt=h,Mn.tag){case 1:if(zt=Mn.payload,typeof zt=="function"){ot=zt.call(Wt,ot,ze);break e}ot=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Mn.payload,ze=typeof zt=="function"?zt.call(Wt,ot,ze):zt,ze==null)break e;ot=a({},ot,ze);break e;case 2:Za=!0}}Z.callback!==null&&Z.lane!==0&&(l.flags|=64,ze=w.effects,ze===null?w.effects=[Z]:ze.push(Z))}else Wt={eventTime:Wt,lane:ze,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},$e===null?(be=$e=Wt,fe=ot):$e=$e.next=Wt,B|=ze;if(Z=Z.next,Z===null){if(Z=w.shared.pending,Z===null)break;ze=Z,Z=ze.next,ze.next=null,w.lastBaseUpdate=ze,w.shared.pending=null}}while(1);if($e===null&&(fe=ot),w.baseState=fe,w.firstBaseUpdate=be,w.lastBaseUpdate=$e,c=w.shared.interleaved,c!==null){w=c;do B|=w.lane,w=w.next;while(w!==c)}else R===null&&(w.shared.lanes=0);eo|=B,l.lanes=B,l.memoizedState=ot}}function Qx(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var y=l[c],w=y.callback;if(w!==null){if(y.callback=null,y=h,typeof w!="function")throw Error(s(191,w));w.call(y)}}}var yc={},ui=en(yc),_c=en(yc),el=en(yc);function ea(l){if(l===yc)throw Error(s(174));return l}function R1(l,c){vt(el,c),vt(_c,l),vt(ui,yc),l=Te(c),bt(ui),vt(ui,l)}function tl(){bt(ui),bt(_c),bt(el)}function qx(l){var c=ea(el.current),h=ea(ui.current);c=ie(h,l.type,c),h!==c&&(vt(_c,l),vt(ui,c))}function I1(l){_c.current===l&&(bt(ui),bt(_c))}var Zt=en(0);function Lu(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||yu(h)||pc(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var D1=[];function O1(){for(var l=0;l<D1.length;l++){var c=D1[l];ve?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}D1.length=0}var Mu=o.ReactCurrentDispatcher,b1=o.ReactCurrentBatchConfig,Zs=0,er=null,kr=null,Lr=null,Bu=!1,Sc=!1,wc=0,Rw=0;function rn(){throw Error(s(321))}function L1(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!Fi(l[h],c[h]))return!1;return!0}function M1(l,c,h,y,w,R){if(Zs=R,er=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Mu.current=l===null||l.memoizedState===null?bw:Lw,l=h(y,w),Sc){R=0;do{if(Sc=!1,wc=0,25<=R)throw Error(s(301));R+=1,Lr=kr=null,c.updateQueue=null,Mu.current=Mw,l=h(y,w)}while(Sc)}if(Mu.current=zu,c=kr!==null&&kr.next!==null,Zs=0,Lr=kr=er=null,Bu=!1,c)throw Error(s(300));return l}function B1(){var l=wc!==0;return wc=0,l}function ta(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lr===null?er.memoizedState=Lr=l:Lr=Lr.next=l,Lr}function fi(){if(kr===null){var l=er.alternate;l=l!==null?l.memoizedState:null}else l=kr.next;var c=Lr===null?er.memoizedState:Lr.next;if(c!==null)Lr=c,kr=l;else{if(l===null)throw Error(s(310));kr=l,l={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Lr===null?er.memoizedState=Lr=l:Lr=Lr.next=l}return Lr}function kc(l,c){return typeof c=="function"?c(l):c}function U1(l){var c=fi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var y=kr,w=y.baseQueue,R=h.pending;if(R!==null){if(w!==null){var B=w.next;w.next=R.next,R.next=B}y.baseQueue=w=R,h.pending=null}if(w!==null){R=w.next,y=y.baseState;var Z=B=null,fe=null,be=R;do{var $e=be.lane;if((Zs&$e)===$e)fe!==null&&(fe=fe.next={lane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),y=be.hasEagerState?be.eagerState:l(y,be.action);else{var ot={lane:$e,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null};fe===null?(Z=fe=ot,B=y):fe=fe.next=ot,er.lanes|=$e,eo|=$e}be=be.next}while(be!==null&&be!==R);fe===null?B=y:fe.next=Z,Fi(y,c.memoizedState)||(On=!0),c.memoizedState=y,c.baseState=B,c.baseQueue=fe,h.lastRenderedState=y}if(l=h.interleaved,l!==null){w=l;do R=w.lane,er.lanes|=R,eo|=R,w=w.next;while(w!==l)}else w===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function j1(l){var c=fi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var y=h.dispatch,w=h.pending,R=c.memoizedState;if(w!==null){h.pending=null;var B=w=w.next;do R=l(R,B.action),B=B.next;while(B!==w);Fi(R,c.memoizedState)||(On=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),h.lastRenderedState=R}return[R,y]}function Jx(){}function Zx(l,c){var h=er,y=fi(),w=c(),R=!Fi(y.memoizedState,w);if(R&&(y.memoizedState=w,On=!0),y=y.queue,z1(rv.bind(null,h,y,l),[l]),y.getSnapshot!==c||R||Lr!==null&&Lr.memoizedState.tag&1){if(h.flags|=2048,Ec(9,tv.bind(null,h,y,w,c),void 0,null),Mr===null)throw Error(s(349));Zs&30||ev(h,c,w)}return w}function ev(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=er.updateQueue,c===null?(c={lastEffect:null,stores:null},er.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function tv(l,c,h,y){c.value=h,c.getSnapshot=y,nv(c)&&iv(l)}function rv(l,c,h){return h(function(){nv(c)&&iv(l)})}function nv(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!Fi(l,h)}catch{return!0}}function iv(l){var c=Zi(l,1);c!==null&&di(c,l,1,-1)}function av(l){var c=ta();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kc,lastRenderedState:l},c.queue=l,l=l.dispatch=Ow.bind(null,er,l),[c.memoizedState,l]}function Ec(l,c,h,y){return l={tag:l,create:c,destroy:h,deps:y,next:null},c=er.updateQueue,c===null?(c={lastEffect:null,stores:null},er.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(y=h.next,h.next=l,l.next=y,c.lastEffect=l)),l}function sv(){return fi().memoizedState}function Uu(l,c,h,y){var w=ta();er.flags|=l,w.memoizedState=Ec(1|c,h,void 0,y===void 0?null:y)}function ju(l,c,h,y){var w=fi();y=y===void 0?null:y;var R=void 0;if(kr!==null){var B=kr.memoizedState;if(R=B.destroy,y!==null&&L1(y,B.deps)){w.memoizedState=Ec(c,h,R,y);return}}er.flags|=l,w.memoizedState=Ec(1|c,h,R,y)}function ov(l,c){return Uu(8390656,8,l,c)}function z1(l,c){return ju(2048,8,l,c)}function lv(l,c){return ju(4,2,l,c)}function cv(l,c){return ju(4,4,l,c)}function uv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function fv(l,c,h){return h=h!=null?h.concat([l]):null,ju(4,4,uv.bind(null,c,l),h)}function V1(){}function dv(l,c){var h=fi();c=c===void 0?null:c;var y=h.memoizedState;return y!==null&&c!==null&&L1(c,y[1])?y[0]:(h.memoizedState=[l,c],l)}function hv(l,c){var h=fi();c=c===void 0?null:c;var y=h.memoizedState;return y!==null&&c!==null&&L1(c,y[1])?y[0]:(l=l(),h.memoizedState=[l,c],l)}function pv(l,c,h){return Zs&21?(Fi(h,c)||(h=Ox(),er.lanes|=h,eo|=h,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,On=!0),l.memoizedState=h)}function Iw(l,c){var h=Pt;Pt=h!==0&&4>h?h:4,l(!0);var y=b1.transition;b1.transition={};try{l(!1),c()}finally{Pt=h,b1.transition=y}}function gv(){return fi().memoizedState}function Dw(l,c,h){var y=ns(l);if(h={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null},mv(l))xv(c,h);else if(h=Xx(l,c,h,y),h!==null){var w=sn();di(h,l,y,w),vv(h,c,y)}}function Ow(l,c,h){var y=ns(l),w={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null};if(mv(l))xv(c,w);else{var R=l.alternate;if(l.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var B=c.lastRenderedState,Z=R(B,h);if(w.hasEagerState=!0,w.eagerState=Z,Fi(Z,B)){var fe=c.interleaved;fe===null?(w.next=w,F1(c)):(w.next=fe.next,fe.next=w),c.interleaved=w;return}}catch{}finally{}h=Xx(l,c,w,y),h!==null&&(w=sn(),di(h,l,y,w),vv(h,c,y))}}function mv(l){var c=l.alternate;return l===er||c!==null&&c===er}function xv(l,c){Sc=Bu=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function vv(l,c,h){if(h&4194240){var y=c.lanes;y&=l.pendingLanes,h|=y,c.lanes=h,g1(l,h)}}var zu={readContext:ci,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},bw={readContext:ci,useCallback:function(l,c){return ta().memoizedState=[l,c===void 0?null:c],l},useContext:ci,useEffect:ov,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,Uu(4194308,4,uv.bind(null,c,l),h)},useLayoutEffect:function(l,c){return Uu(4194308,4,l,c)},useInsertionEffect:function(l,c){return Uu(4,2,l,c)},useMemo:function(l,c){var h=ta();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var y=ta();return c=h!==void 0?h(c):c,y.memoizedState=y.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},y.queue=l,l=l.dispatch=Dw.bind(null,er,l),[y.memoizedState,l]},useRef:function(l){var c=ta();return l={current:l},c.memoizedState=l},useState:av,useDebugValue:V1,useDeferredValue:function(l){return ta().memoizedState=l},useTransition:function(){var l=av(!1),c=l[0];return l=Iw.bind(null,l[1]),ta().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var y=er,w=ta();if(Kt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=c(),Mr===null)throw Error(s(349));Zs&30||ev(y,c,h)}w.memoizedState=h;var R={value:h,getSnapshot:c};return w.queue=R,ov(rv.bind(null,y,R,l),[l]),y.flags|=2048,Ec(9,tv.bind(null,y,R,h,c),void 0,null),h},useId:function(){var l=ta(),c=Mr.identifierPrefix;if(Kt){var h=wa,y=Sa;h=(y&~(1<<32-Pi(y)-1)).toString(32)+h,c=":"+c+"R"+h,h=wc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=Rw++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},Lw={readContext:ci,useCallback:dv,useContext:ci,useEffect:z1,useImperativeHandle:fv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:hv,useReducer:U1,useRef:sv,useState:function(){return U1(kc)},useDebugValue:V1,useDeferredValue:function(l){var c=fi();return pv(c,kr.memoizedState,l)},useTransition:function(){var l=U1(kc)[0],c=fi().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:gv,unstable_isNewReconciler:!1},Mw={readContext:ci,useCallback:dv,useContext:ci,useEffect:z1,useImperativeHandle:fv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:hv,useReducer:j1,useRef:sv,useState:function(){return j1(kc)},useDebugValue:V1,useDeferredValue:function(l){var c=fi();return kr===null?c.memoizedState=l:pv(c,kr.memoizedState,l)},useTransition:function(){var l=j1(kc)[0],c=fi().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:gv,unstable_isNewReconciler:!1};function Ri(l,c){if(l&&l.defaultProps){c=a({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function G1(l,c,h,y){c=l.memoizedState,h=h(y,c),h=h==null?c:a({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var Vu={isMounted:function(l){return(l=l._reactInternals)?I(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var y=sn(),w=ns(l),R=ka(y,w);R.payload=c,h!=null&&(R.callback=h),c=es(l,R,w),c!==null&&(di(c,l,w,y),Ou(c,l,w))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var y=sn(),w=ns(l),R=ka(y,w);R.tag=1,R.payload=c,h!=null&&(R.callback=h),c=es(l,R,w),c!==null&&(di(c,l,w,y),Ou(c,l,w))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=sn(),y=ns(l),w=ka(h,y);w.tag=2,c!=null&&(w.callback=c),c=es(l,w,y),c!==null&&(di(c,l,y,h),Ou(c,l,y))}};function yv(l,c,h,y,w,R,B){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(y,R,B):c.prototype&&c.prototype.isPureReactComponent?!Nu(h,y)||!Nu(w,R):!0}function _v(l,c,h){var y=!1,w=Ja,R=c.contextType;return typeof R=="object"&&R!==null?R=ci(R):(w=Dn(c)?Ys:tn.current,y=c.contextTypes,R=(y=y!=null)?Xo(l,w):Ja),c=new c(h,R),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Vu,l.stateNode=c,c._reactInternals=l,y&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=w,l.__reactInternalMemoizedMaskedChildContext=R),c}function Sv(l,c,h,y){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,y),c.state!==l&&Vu.enqueueReplaceState(c,c.state,null)}function H1(l,c,h,y){var w=l.stateNode;w.props=h,w.state=l.memoizedState,w.refs={},N1(l);var R=c.contextType;typeof R=="object"&&R!==null?w.context=ci(R):(R=Dn(c)?Ys:tn.current,w.context=Xo(l,R)),w.state=l.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(G1(l,c,R,h),w.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(c=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),c!==w.state&&Vu.enqueueReplaceState(w,w.state,null),bu(l,h,w,y),w.state=l.memoizedState),typeof w.componentDidMount=="function"&&(l.flags|=4194308)}function rl(l,c){try{var h="",y=c;do h+=Nw(y),y=y.return;while(y);var w=h}catch(R){w=`
Error generating stack: `+R.message+`
`+R.stack}return{value:l,source:c,stack:w,digest:null}}function W1(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function $1(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var Bw=typeof WeakMap=="function"?WeakMap:Map;function wv(l,c,h){h=ka(-1,h),h.tag=3,h.payload={element:null};var y=c.value;return h.callback=function(){rf||(rf=!0,dp=y),$1(l,c)},h}function kv(l,c,h){h=ka(-1,h),h.tag=3;var y=l.type.getDerivedStateFromError;if(typeof y=="function"){var w=c.value;h.payload=function(){return y(w)},h.callback=function(){$1(l,c)}}var R=l.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(h.callback=function(){$1(l,c),typeof y!="function"&&(ts===null?ts=new Set([this]):ts.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})}),h}function Ev(l,c,h){var y=l.pingCache;if(y===null){y=l.pingCache=new Bw;var w=new Set;y.set(c,w)}else w=y.get(c),w===void 0&&(w=new Set,y.set(c,w));w.has(h)||(w.add(h),l=Jw.bind(null,l,c,h),c.then(l,l))}function Cv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Tv(l,c,h,y,w){return l.mode&1?(l.flags|=65536,l.lanes=w,l):(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=ka(-1,1),c.tag=2,es(h,c,1))),h.lanes|=1),l)}var Uw=o.ReactCurrentOwner,On=!1;function Sn(l,c,h,y){c.child=l===null?Wx(c,null,h,y):qo(c,l.child,h,y)}function Av(l,c,h,y,w){h=h.render;var R=c.ref;return Zo(c,w),y=M1(l,c,h,y,R,w),h=B1(),l!==null&&!On?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~w,Ea(l,c,w)):(Kt&&h&&_1(c),c.flags|=1,Sn(l,c,y,w),c.child)}function Pv(l,c,h,y,w){if(l===null){var R=h.type;return typeof R=="function"&&!vp(R)&&R.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=R,Fv(l,c,R,y,w)):(l=cf(h.type,null,y,c,c.mode,w),l.ref=c.ref,l.return=c,c.child=l)}if(R=l.child,!(l.lanes&w)){var B=R.memoizedProps;if(h=h.compare,h=h!==null?h:Nu,h(B,y)&&l.ref===c.ref)return Ea(l,c,w)}return c.flags|=1,l=as(R,y),l.ref=c.ref,l.return=c,c.child=l}function Fv(l,c,h,y,w){if(l!==null){var R=l.memoizedProps;if(Nu(R,y)&&l.ref===c.ref)if(On=!1,c.pendingProps=y=R,(l.lanes&w)!==0)l.flags&131072&&(On=!0);else return c.lanes=l.lanes,Ea(l,c,w)}return X1(l,c,h,y,w)}function Nv(l,c,h){var y=c.pendingProps,w=y.children,R=l!==null?l.memoizedState:null;if(y.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(il,$n),$n|=h;else{if(!(h&1073741824))return l=R!==null?R.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,vt(il,$n),$n|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=R!==null?R.baseLanes:h,vt(il,$n),$n|=y}else R!==null?(y=R.baseLanes|h,c.memoizedState=null):y=h,vt(il,$n),$n|=y;return Sn(l,c,w,h),c.child}function Rv(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function X1(l,c,h,y,w){var R=Dn(h)?Ys:tn.current;return R=Xo(c,R),Zo(c,w),h=M1(l,c,h,y,R,w),y=B1(),l!==null&&!On?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~w,Ea(l,c,w)):(Kt&&y&&_1(c),c.flags|=1,Sn(l,c,h,w),c.child)}function Iv(l,c,h,y,w){if(Dn(h)){var R=!0;Su(c)}else R=!1;if(Zo(c,w),c.stateNode===null)Hu(l,c),_v(c,h,y),H1(c,h,y,w),y=!0;else if(l===null){var B=c.stateNode,Z=c.memoizedProps;B.props=Z;var fe=B.context,be=h.contextType;typeof be=="object"&&be!==null?be=ci(be):(be=Dn(h)?Ys:tn.current,be=Xo(c,be));var $e=h.getDerivedStateFromProps,ot=typeof $e=="function"||typeof B.getSnapshotBeforeUpdate=="function";ot||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Z!==y||fe!==be)&&Sv(c,B,y,be),Za=!1;var ze=c.memoizedState;B.state=ze,bu(c,y,B,w),fe=c.memoizedState,Z!==y||ze!==fe||In.current||Za?(typeof $e=="function"&&(G1(c,h,$e,y),fe=c.memoizedState),(Z=Za||yv(c,h,Z,y,ze,fe,be))?(ot||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(c.flags|=4194308)):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=fe),B.props=y,B.state=fe,B.context=be,y=Z):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{B=c.stateNode,Kx(l,c),Z=c.memoizedProps,be=c.type===c.elementType?Z:Ri(c.type,Z),B.props=be,ot=c.pendingProps,ze=B.context,fe=h.contextType,typeof fe=="object"&&fe!==null?fe=ci(fe):(fe=Dn(h)?Ys:tn.current,fe=Xo(c,fe));var Wt=h.getDerivedStateFromProps;($e=typeof Wt=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Z!==ot||ze!==fe)&&Sv(c,B,y,fe),Za=!1,ze=c.memoizedState,B.state=ze,bu(c,y,B,w);var zt=c.memoizedState;Z!==ot||ze!==zt||In.current||Za?(typeof Wt=="function"&&(G1(c,h,Wt,y),zt=c.memoizedState),(be=Za||yv(c,h,be,y,ze,zt,fe)||!1)?($e||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(y,zt,fe),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(y,zt,fe)),typeof B.componentDidUpdate=="function"&&(c.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof B.componentDidUpdate!="function"||Z===l.memoizedProps&&ze===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Z===l.memoizedProps&&ze===l.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=zt),B.props=y,B.state=zt,B.context=fe,y=be):(typeof B.componentDidUpdate!="function"||Z===l.memoizedProps&&ze===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Z===l.memoizedProps&&ze===l.memoizedState||(c.flags|=1024),y=!1)}return K1(l,c,h,y,R,w)}function K1(l,c,h,y,w,R){Rv(l,c);var B=(c.flags&128)!==0;if(!y&&!B)return w&&Dx(c,h,!1),Ea(l,c,R);y=c.stateNode,Uw.current=c;var Z=B&&typeof h.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,l!==null&&B?(c.child=qo(c,l.child,null,R),c.child=qo(c,null,Z,R)):Sn(l,c,Z,R),c.memoizedState=y.state,w&&Dx(c,h,!0),c.child}function Dv(l){var c=l.stateNode;c.pendingContext?Rx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&Rx(l,c.context,!1),R1(l,c.containerInfo)}function Ov(l,c,h,y,w){return Qo(),E1(w),c.flags|=256,Sn(l,c,h,y),c.child}var Y1={dehydrated:null,treeContext:null,retryLane:0};function Q1(l){return{baseLanes:l,cachePool:null,transitions:null}}function bv(l,c,h){var y=c.pendingProps,w=Zt.current,R=!1,B=(c.flags&128)!==0,Z;if((Z=B)||(Z=l!==null&&l.memoizedState===null?!1:(w&2)!==0),Z?(R=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(w|=1),vt(Zt,w&1),l===null)return k1(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?pc(l)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(B=y.children,l=y.fallback,R?(y=c.mode,R=c.child,B={mode:"hidden",children:B},!(y&1)&&R!==null?(R.childLanes=0,R.pendingProps=B):R=uf(B,y,0,null),l=io(l,y,h,null),R.return=c,l.return=c,R.sibling=l,c.child=R,c.child.memoizedState=Q1(h),c.memoizedState=Y1,l):q1(c,B));if(w=l.memoizedState,w!==null&&(Z=w.dehydrated,Z!==null))return jw(l,c,B,y,Z,w,h);if(R){R=y.fallback,B=c.mode,w=l.child,Z=w.sibling;var fe={mode:"hidden",children:y.children};return!(B&1)&&c.child!==w?(y=c.child,y.childLanes=0,y.pendingProps=fe,c.deletions=null):(y=as(w,fe),y.subtreeFlags=w.subtreeFlags&14680064),Z!==null?R=as(Z,R):(R=io(R,B,h,null),R.flags|=2),R.return=c,y.return=c,y.sibling=R,c.child=y,y=R,R=c.child,B=l.child.memoizedState,B=B===null?Q1(h):{baseLanes:B.baseLanes|h,cachePool:null,transitions:B.transitions},R.memoizedState=B,R.childLanes=l.childLanes&~h,c.memoizedState=Y1,y}return R=l.child,l=R.sibling,y=as(R,{mode:"visible",children:y.children}),!(c.mode&1)&&(y.lanes=h),y.return=c,y.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=y,c.memoizedState=null,y}function q1(l,c){return c=uf({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Gu(l,c,h,y){return y!==null&&E1(y),qo(c,l.child,null,h),l=q1(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function jw(l,c,h,y,w,R,B){if(h)return c.flags&256?(c.flags&=-257,y=W1(Error(s(422))),Gu(l,c,B,y)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(R=y.fallback,w=c.mode,y=uf({mode:"visible",children:y.children},w,0,null),R=io(R,w,B,null),R.flags|=2,y.return=c,R.return=c,y.sibling=R,c.child=y,c.mode&1&&qo(c,l.child,null,B),c.child.memoizedState=Q1(B),c.memoizedState=Y1,R);if(!(c.mode&1))return Gu(l,c,B,null);if(pc(w))return y=d1(w).digest,R=Error(s(419)),y=W1(R,y,void 0),Gu(l,c,B,y);if(h=(B&l.childLanes)!==0,On||h){if(y=Mr,y!==null){switch(B&-B){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=w&(y.suspendedLanes|B)?0:w,w!==0&&w!==R.retryLane&&(R.retryLane=w,Zi(l,w),di(y,l,w,-1))}return xp(),y=W1(Error(s(421))),Gu(l,c,B,y)}return yu(w)?(c.flags|=128,c.child=l.child,c=Zw.bind(null,l),O(w,c),null):(l=R.treeContext,Ze&&(li=H(w),Wn=c,Kt=!0,Ni=null,xc=!1,l!==null&&(si[oi++]=Sa,si[oi++]=wa,si[oi++]=Qs,Sa=l.id,wa=l.overflow,Qs=c)),c=q1(c,y.children),c.flags|=4096,c)}function Lv(l,c,h){l.lanes|=c;var y=l.alternate;y!==null&&(y.lanes|=c),P1(l.return,c,h)}function J1(l,c,h,y,w){var R=l.memoizedState;R===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:w}:(R.isBackwards=c,R.rendering=null,R.renderingStartTime=0,R.last=y,R.tail=h,R.tailMode=w)}function Mv(l,c,h){var y=c.pendingProps,w=y.revealOrder,R=y.tail;if(Sn(l,c,y.children,h),y=Zt.current,y&2)y=y&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Lv(l,h,c);else if(l.tag===19)Lv(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}y&=1}if(vt(Zt,y),!(c.mode&1))c.memoizedState=null;else switch(w){case"forwards":for(h=c.child,w=null;h!==null;)l=h.alternate,l!==null&&Lu(l)===null&&(w=h),h=h.sibling;h=w,h===null?(w=c.child,c.child=null):(w=h.sibling,h.sibling=null),J1(c,!1,w,h,R);break;case"backwards":for(h=null,w=c.child,c.child=null;w!==null;){if(l=w.alternate,l!==null&&Lu(l)===null){c.child=w;break}l=w.sibling,w.sibling=h,h=w,w=l}J1(c,!0,h,null,R);break;case"together":J1(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Hu(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Ea(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),eo|=c.lanes,!(h&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(s(153));if(c.child!==null){for(l=c.child,h=as(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=as(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function zw(l,c,h){switch(c.tag){case 3:Dv(c),Qo();break;case 5:qx(c);break;case 1:Dn(c.type)&&Su(c);break;case 4:R1(c,c.stateNode.containerInfo);break;case 10:$x(c,c.type._context,c.memoizedProps.value);break;case 13:var y=c.memoizedState;if(y!==null)return y.dehydrated!==null?(vt(Zt,Zt.current&1),c.flags|=128,null):h&c.child.childLanes?bv(l,c,h):(vt(Zt,Zt.current&1),l=Ea(l,c,h),l!==null?l.sibling:null);vt(Zt,Zt.current&1);break;case 19:if(y=(h&c.childLanes)!==0,l.flags&128){if(y)return Mv(l,c,h);c.flags|=128}var w=c.memoizedState;if(w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),vt(Zt,Zt.current),y)break;return null;case 22:case 23:return c.lanes=0,Nv(l,c,h)}return Ea(l,c,h)}function ra(l){l.flags|=4}function Bv(l,c){if(l!==null&&l.child===c.child)return!0;if(c.flags&16)return!1;for(l=c.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Cc,Tc,Wu,$u;if(Be)Cc=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)L(l,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Tc=function(){},Wu=function(l,c,h,y,w){if(l=l.memoizedProps,l!==y){var R=c.stateNode,B=ea(ui.current);h=Y(R,h,l,y,w,B),(c.updateQueue=h)&&ra(c)}},$u=function(l,c,h,y){h!==y&&ra(c)};else if(V){Cc=function(l,c,h,y){for(var w=c.child;w!==null;){if(w.tag===5){var R=w.stateNode;h&&y&&(R=Zr(R,w.type,w.memoizedProps,w)),L(l,R)}else if(w.tag===6)R=w.stateNode,h&&y&&(R=Xs(R,w.memoizedProps,w)),L(l,R);else if(w.tag!==4){if(w.tag===22&&w.memoizedState!==null)R=w.child,R!==null&&(R.return=w),Cc(l,w,!0,!0);else if(w.child!==null){w.child.return=w,w=w.child;continue}}if(w===c)break;for(;w.sibling===null;){if(w.return===null||w.return===c)return;w=w.return}w.sibling.return=w.return,w=w.sibling}};var Uv=function(l,c,h,y){for(var w=c.child;w!==null;){if(w.tag===5){var R=w.stateNode;h&&y&&(R=Zr(R,w.type,w.memoizedProps,w)),yn(l,R)}else if(w.tag===6)R=w.stateNode,h&&y&&(R=Xs(R,w.memoizedProps,w)),yn(l,R);else if(w.tag!==4){if(w.tag===22&&w.memoizedState!==null)R=w.child,R!==null&&(R.return=w),Uv(l,w,!0,!0);else if(w.child!==null){w.child.return=w,w=w.child;continue}}if(w===c)break;for(;w.sibling===null;){if(w.return===null||w.return===c)return;w=w.return}w.sibling.return=w.return,w=w.sibling}};Tc=function(l,c){var h=c.stateNode;if(!Bv(l,c)){l=h.containerInfo;var y=Hn(l);Uv(y,c,!1,!1),h.pendingChildren=y,ra(c),va(l,y)}},Wu=function(l,c,h,y,w){var R=l.stateNode,B=l.memoizedProps;if((l=Bv(l,c))&&B===y)c.stateNode=R;else{var Z=c.stateNode,fe=ea(ui.current),be=null;B!==y&&(be=Y(Z,h,B,y,w,fe)),l&&be===null?c.stateNode=R:(R=gt(R,be,h,B,y,c,l,Z),q(R,h,y,w,fe)&&ra(c),c.stateNode=R,l?ra(c):Cc(R,c,!1,!1))}},$u=function(l,c,h,y){h!==y?(l=ea(el.current),h=ea(ui.current),c.stateNode=de(y,l,h,c),ra(c)):c.stateNode=l.stateNode}}else Tc=function(){},Wu=function(){},$u=function(){};function Ac(l,c){if(!Kt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:y.sibling=null}}function nn(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,y=0;if(c)for(var w=l.child;w!==null;)h|=w.lanes|w.childLanes,y|=w.subtreeFlags&14680064,y|=w.flags&14680064,w.return=l,w=w.sibling;else for(w=l.child;w!==null;)h|=w.lanes|w.childLanes,y|=w.subtreeFlags,y|=w.flags,w.return=l,w=w.sibling;return l.subtreeFlags|=y,l.childLanes=h,c}function Vw(l,c,h){var y=c.pendingProps;switch(S1(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(c),null;case 1:return Dn(c.type)&&_u(),nn(c),null;case 3:return h=c.stateNode,tl(),bt(In),bt(tn),O1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(l===null||l.child===null)&&(Fu(c)?ra(c):l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Ni!==null&&(gp(Ni),Ni=null))),Tc(l,c),nn(c),null;case 5:I1(c),h=ea(el.current);var w=c.type;if(l!==null&&c.stateNode!=null)Wu(l,c,w,y,h),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(s(166));return nn(c),null}if(l=ea(ui.current),Fu(c)){if(!Ze)throw Error(s(175));l=W(c.stateNode,c.type,c.memoizedProps,h,l,c,!xc),c.updateQueue=l,l!==null&&ra(c)}else{var R=Ce(w,y,h,l,c);Cc(R,c,!1,!1),c.stateNode=R,q(R,w,y,h,l)&&ra(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return nn(c),null;case 6:if(l&&c.stateNode!=null)$u(l,c,l.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(s(166));if(l=ea(el.current),h=ea(ui.current),Fu(c)){if(!Ze)throw Error(s(176));if(l=c.stateNode,h=c.memoizedProps,(y=ae(l,h,c,!xc))&&(w=Wn,w!==null))switch(w.tag){case 3:Oe(w.stateNode.containerInfo,l,h,(w.mode&1)!==0);break;case 5:je(w.type,w.memoizedProps,w.stateNode,l,h,(w.mode&1)!==0)}y&&ra(c)}else c.stateNode=de(y,l,h,c)}return nn(c),null;case 13:if(bt(Zt),y=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Kt&&li!==null&&c.mode&1&&!(c.flags&128))Vx(),Qo(),c.flags|=98560,w=!1;else if(w=Fu(c),y!==null&&y.dehydrated!==null){if(l===null){if(!w)throw Error(s(318));if(!Ze)throw Error(s(344));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(s(317));ye(w,c)}else Qo(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;nn(c),w=!1}else Ni!==null&&(gp(Ni),Ni=null),w=!0;if(!w)return c.flags&65536?c:null}return c.flags&128?(c.lanes=h,c):(h=y!==null,h!==(l!==null&&l.memoizedState!==null)&&h&&(c.child.flags|=8192,c.mode&1&&(l===null||Zt.current&1?Er===0&&(Er=3):xp())),c.updateQueue!==null&&(c.flags|=4),nn(c),null);case 4:return tl(),Tc(l,c),l===null&&Ye(c.stateNode.containerInfo),nn(c),null;case 10:return A1(c.type._context),nn(c),null;case 17:return Dn(c.type)&&_u(),nn(c),null;case 19:if(bt(Zt),w=c.memoizedState,w===null)return nn(c),null;if(y=(c.flags&128)!==0,R=w.rendering,R===null)if(y)Ac(w,!1);else{if(Er!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(R=Lu(l),R!==null){for(c.flags|=128,Ac(w,!1),l=R.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=h,h=c.child;h!==null;)y=h,w=l,y.flags&=14680066,R=y.alternate,R===null?(y.childLanes=0,y.lanes=w,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=R.childLanes,y.lanes=R.lanes,y.child=R.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=R.memoizedProps,y.memoizedState=R.memoizedState,y.updateQueue=R.updateQueue,y.type=R.type,w=R.dependencies,y.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext}),h=h.sibling;return vt(Zt,Zt.current&1|2),c.child}l=l.sibling}w.tail!==null&&br()>fp&&(c.flags|=128,y=!0,Ac(w,!1),c.lanes=4194304)}else{if(!y)if(l=Lu(R),l!==null){if(c.flags|=128,y=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Ac(w,!0),w.tail===null&&w.tailMode==="hidden"&&!R.alternate&&!Kt)return nn(c),null}else 2*br()-w.renderingStartTime>fp&&h!==1073741824&&(c.flags|=128,y=!0,Ac(w,!1),c.lanes=4194304);w.isBackwards?(R.sibling=c.child,c.child=R):(l=w.last,l!==null?l.sibling=R:c.child=R,w.last=R)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=br(),c.sibling=null,l=Zt.current,vt(Zt,y?l&1|2:l&1),c):(nn(c),null);case 22:case 23:return mp(),h=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==h&&(c.flags|=8192),h&&c.mode&1?$n&1073741824&&(nn(c),Be&&c.subtreeFlags&6&&(c.flags|=8192)):nn(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function Gw(l,c){switch(S1(c),c.tag){case 1:return Dn(c.type)&&_u(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return tl(),bt(In),bt(tn),O1(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return I1(c),null;case 13:if(bt(Zt),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Qo()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return bt(Zt),null;case 4:return tl(),null;case 10:return A1(c.type._context),null;case 22:case 23:return mp(),null;case 24:return null;default:return null}}var Xu=!1,an=!1,Hw=typeof WeakSet=="function"?WeakSet:Set,He=null;function nl(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(y){Yt(l,c,y)}else h.current=null}function Z1(l,c,h){try{h()}catch(y){Yt(l,c,y)}}var jv=!1;function Ww(l,c){for(X(l.containerInfo),He=c;He!==null;)if(l=He,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,He=c;else for(;He!==null;){l=He;try{var h=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var y=h.memoizedProps,w=h.memoizedState,R=l.stateNode,B=R.getSnapshotBeforeUpdate(l.elementType===l.type?y:Ri(l.type,y),w);R.__reactInternalSnapshotBeforeUpdate=B}break;case 3:Be&&dt(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(Z){Yt(l,l.return,Z)}if(c=l.sibling,c!==null){c.return=l.return,He=c;break}He=l.return}return h=jv,jv=!1,h}function Pc(l,c,h){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var w=y=y.next;do{if((w.tag&l)===l){var R=w.destroy;w.destroy=void 0,R!==void 0&&Z1(c,h,R)}w=w.next}while(w!==y)}}function Ku(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var y=h.create;h.destroy=y()}h=h.next}while(h!==c)}}function ep(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=Ae(h);break;default:l=h}typeof c=="function"?c(l):c.current=l}}function zv(l){var c=l.alternate;c!==null&&(l.alternate=null,zv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Re(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Vv(l){return l.tag===5||l.tag===3||l.tag===4}function Gv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Vv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function tp(l,c,h){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?xt(h,l,c):re(h,l);else if(y!==4&&(l=l.child,l!==null))for(tp(l,c,h),l=l.sibling;l!==null;)tp(l,c,h),l=l.sibling}function rp(l,c,h){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?Ke(h,l,c):pe(h,l);else if(y!==4&&(l=l.child,l!==null))for(rp(l,c,h),l=l.sibling;l!==null;)rp(l,c,h),l=l.sibling}var Wr=null,Ii=!1;function na(l,c,h){for(h=h.child;h!==null;)np(l,c,h),h=h.sibling}function np(l,c,h){if(qi&&typeof qi.onCommitFiberUnmount=="function")try{qi.onCommitFiberUnmount(Cu,h)}catch{}switch(h.tag){case 5:an||nl(h,c);case 6:if(Be){var y=Wr,w=Ii;Wr=null,na(l,c,h),Wr=y,Ii=w,Wr!==null&&(Ii?Ut(Wr,h.stateNode):Dt(Wr,h.stateNode))}else na(l,c,h);break;case 18:Be&&Wr!==null&&(Ii?Ue(Wr,h.stateNode):Ne(Wr,h.stateNode));break;case 4:Be?(y=Wr,w=Ii,Wr=h.stateNode.containerInfo,Ii=!0,na(l,c,h),Wr=y,Ii=w):(V&&(y=h.stateNode.containerInfo,w=Hn(y),_n(y,w)),na(l,c,h));break;case 0:case 11:case 14:case 15:if(!an&&(y=h.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){w=y=y.next;do{var R=w,B=R.destroy;R=R.tag,B!==void 0&&(R&2||R&4)&&Z1(h,c,B),w=w.next}while(w!==y)}na(l,c,h);break;case 1:if(!an&&(nl(h,c),y=h.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=h.memoizedProps,y.state=h.memoizedState,y.componentWillUnmount()}catch(Z){Yt(h,c,Z)}na(l,c,h);break;case 21:na(l,c,h);break;case 22:h.mode&1?(an=(y=an)||h.memoizedState!==null,na(l,c,h),an=y):na(l,c,h);break;default:na(l,c,h)}}function Hv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new Hw),c.forEach(function(y){var w=ek.bind(null,l,y);h.has(y)||(h.add(y),y.then(w,w))})}}function Di(l,c){var h=c.deletions;if(h!==null)for(var y=0;y<h.length;y++){var w=h[y];try{var R=l,B=c;if(Be){var Z=B;e:for(;Z!==null;){switch(Z.tag){case 5:Wr=Z.stateNode,Ii=!1;break e;case 3:Wr=Z.stateNode.containerInfo,Ii=!0;break e;case 4:Wr=Z.stateNode.containerInfo,Ii=!0;break e}Z=Z.return}if(Wr===null)throw Error(s(160));np(R,B,w),Wr=null,Ii=!1}else np(R,B,w);var fe=w.alternate;fe!==null&&(fe.return=null),w.return=null}catch(be){Yt(w,c,be)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Wv(c,l),c=c.sibling}function Wv(l,c){var h=l.alternate,y=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Di(c,l),ia(l),y&4){try{Pc(3,l,l.return),Ku(3,l)}catch(ze){Yt(l,l.return,ze)}try{Pc(5,l,l.return)}catch(ze){Yt(l,l.return,ze)}}break;case 1:Di(c,l),ia(l),y&512&&h!==null&&nl(h,h.return);break;case 5:if(Di(c,l),ia(l),y&512&&h!==null&&nl(h,h.return),Be){if(l.flags&32){var w=l.stateNode;try{Fe(w)}catch(ze){Yt(l,l.return,ze)}}if(y&4&&(w=l.stateNode,w!=null)){var R=l.memoizedProps;if(h=h!==null?h.memoizedProps:R,y=l.type,c=l.updateQueue,l.updateQueue=null,c!==null)try{Le(w,c,y,h,R,l)}catch(ze){Yt(l,l.return,ze)}}}break;case 6:if(Di(c,l),ia(l),y&4&&Be){if(l.stateNode===null)throw Error(s(162));w=l.stateNode,R=l.memoizedProps,h=h!==null?h.memoizedProps:R;try{xe(w,h,R)}catch(ze){Yt(l,l.return,ze)}}break;case 3:if(Di(c,l),ia(l),y&4){if(Be&&Ze&&h!==null&&h.memoizedState.isDehydrated)try{se(c.containerInfo)}catch(ze){Yt(l,l.return,ze)}if(V){w=c.containerInfo,R=c.pendingChildren;try{_n(w,R)}catch(ze){Yt(l,l.return,ze)}}}break;case 4:if(Di(c,l),ia(l),y&4&&V){R=l.stateNode,w=R.containerInfo,R=R.pendingChildren;try{_n(w,R)}catch(ze){Yt(l,l.return,ze)}}break;case 13:Di(c,l),ia(l),w=l.child,w.flags&8192&&(R=w.memoizedState!==null,w.stateNode.isHidden=R,!R||w.alternate!==null&&w.alternate.memoizedState!==null||(up=br())),y&4&&Hv(l);break;case 22:var B=h!==null&&h.memoizedState!==null;if(l.mode&1?(an=(h=an)||B,Di(c,l),an=h):Di(c,l),ia(l),y&8192){if(h=l.memoizedState!==null,(l.stateNode.isHidden=h)&&!B&&l.mode&1)for(He=l,y=l.child;y!==null;){for(c=He=y;He!==null;){B=He;var Z=B.child;switch(B.tag){case 0:case 11:case 14:case 15:Pc(4,B,B.return);break;case 1:nl(B,B.return);var fe=B.stateNode;if(typeof fe.componentWillUnmount=="function"){var be=B,$e=B.return;try{var ot=be;fe.props=ot.memoizedProps,fe.state=ot.memoizedState,fe.componentWillUnmount()}catch(ze){Yt(be,$e,ze)}}break;case 5:nl(B,B.return);break;case 22:if(B.memoizedState!==null){Kv(c);continue}}Z!==null?(Z.return=B,He=Z):Kv(c)}y=y.sibling}if(Be){e:if(y=null,Be)for(c=l;;){if(c.tag===5){if(y===null){y=c;try{w=c.stateNode,h?Xe(w):qe(c.stateNode,c.memoizedProps)}catch(ze){Yt(l,l.return,ze)}}}else if(c.tag===6){if(y===null)try{R=c.stateNode,h?Qe(R):kt(R,c.memoizedProps)}catch(ze){Yt(l,l.return,ze)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;y===c&&(y=null),c=c.return}y===c&&(y=null),c.sibling.return=c.return,c=c.sibling}}}break;case 19:Di(c,l),ia(l),y&4&&Hv(l);break;case 21:break;default:Di(c,l),ia(l)}}function ia(l){var c=l.flags;if(c&2){try{if(Be){e:{for(var h=l.return;h!==null;){if(Vv(h)){var y=h;break e}h=h.return}throw Error(s(160))}switch(y.tag){case 5:var w=y.stateNode;y.flags&32&&(Fe(w),y.flags&=-33);var R=Gv(l);rp(l,R,w);break;case 3:case 4:var B=y.stateNode.containerInfo,Z=Gv(l);tp(l,Z,B);break;default:throw Error(s(161))}}}catch(fe){Yt(l,l.return,fe)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function $w(l,c,h){He=l,$v(l)}function $v(l,c,h){for(var y=(l.mode&1)!==0;He!==null;){var w=He,R=w.child;if(w.tag===22&&y){var B=w.memoizedState!==null||Xu;if(!B){var Z=w.alternate,fe=Z!==null&&Z.memoizedState!==null||an;Z=Xu;var be=an;if(Xu=B,(an=fe)&&!be)for(He=w;He!==null;)B=He,fe=B.child,B.tag===22&&B.memoizedState!==null?Yv(w):fe!==null?(fe.return=B,He=fe):Yv(w);for(;R!==null;)He=R,$v(R),R=R.sibling;He=w,Xu=Z,an=be}Xv(l)}else w.subtreeFlags&8772&&R!==null?(R.return=w,He=R):Xv(l)}}function Xv(l){for(;He!==null;){var c=He;if(c.flags&8772){var h=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:an||Ku(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!an)if(h===null)y.componentDidMount();else{var w=c.elementType===c.type?h.memoizedProps:Ri(c.type,h.memoizedProps);y.componentDidUpdate(w,h.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var R=c.updateQueue;R!==null&&Qx(c,R,y);break;case 3:var B=c.updateQueue;if(B!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=Ae(c.child.stateNode);break;case 1:h=c.child.stateNode}Qx(c,B,h)}break;case 5:var Z=c.stateNode;h===null&&c.flags&4&&De(Z,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(Ze&&c.memoizedState===null){var fe=c.alternate;if(fe!==null){var be=fe.memoizedState;if(be!==null){var $e=be.dehydrated;$e!==null&&oe($e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}an||c.flags&512&&ep(c)}catch(ot){Yt(c,c.return,ot)}}if(c===l){He=null;break}if(h=c.sibling,h!==null){h.return=c.return,He=h;break}He=c.return}}function Kv(l){for(;He!==null;){var c=He;if(c===l){He=null;break}var h=c.sibling;if(h!==null){h.return=c.return,He=h;break}He=c.return}}function Yv(l){for(;He!==null;){var c=He;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Ku(4,c)}catch(fe){Yt(c,h,fe)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var w=c.return;try{y.componentDidMount()}catch(fe){Yt(c,w,fe)}}var R=c.return;try{ep(c)}catch(fe){Yt(c,R,fe)}break;case 5:var B=c.return;try{ep(c)}catch(fe){Yt(c,B,fe)}}}catch(fe){Yt(c,c.return,fe)}if(c===l){He=null;break}var Z=c.sibling;if(Z!==null){Z.return=c.return,He=Z;break}He=c.return}}var Yu=0,Qu=1,qu=2,Ju=3,Zu=4;if(typeof Symbol=="function"&&Symbol.for){var Fc=Symbol.for;Yu=Fc("selector.component"),Qu=Fc("selector.has_pseudo_class"),qu=Fc("selector.role"),Ju=Fc("selector.test_id"),Zu=Fc("selector.text")}function ip(l){var c=nt(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(s(364));return c}if(l=_e(l),l===null)throw Error(s(362));return l.stateNode.current}function ap(l,c){switch(c.$$typeof){case Yu:if(l.type===c.value)return!0;break;case Qu:e:{c=c.value,l=[l,0];for(var h=0;h<l.length;){var y=l[h++],w=l[h++],R=c[w];if(y.tag!==5||!we(y)){for(;R!=null&&ap(y,R);)w++,R=c[w];if(w===c.length){c=!0;break e}else for(y=y.child;y!==null;)l.push(y,w),y=y.sibling}}c=!1}return c;case qu:if(l.tag===5&&Ee(l.stateNode,c.value))return!0;break;case Zu:if((l.tag===5||l.tag===6)&&(l=Se(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case Ju:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function sp(l){switch(l.$$typeof){case Yu:return"<"+(F(l.value)||"Unknown")+">";case Qu:return":has("+(sp(l)||"")+")";case qu:return'[role="'+l.value+'"]';case Zu:return'"'+l.value+'"';case Ju:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function Qv(l,c){var h=[];l=[l,0];for(var y=0;y<l.length;){var w=l[y++],R=l[y++],B=c[R];if(w.tag!==5||!we(w)){for(;B!=null&&ap(w,B);)R++,B=c[R];if(R===c.length)h.push(w);else for(w=w.child;w!==null;)l.push(w,R),w=w.sibling}}return h}function op(l,c){if(!pr)throw Error(s(363));l=ip(l),l=Qv(l,c),c=[],l=Array.from(l);for(var h=0;h<l.length;){var y=l[h++];if(y.tag===5)we(y)||c.push(y.stateNode);else for(y=y.child;y!==null;)l.push(y),y=y.sibling}return c}var Xw=Math.ceil,ef=o.ReactCurrentDispatcher,lp=o.ReactCurrentOwner,ur=o.ReactCurrentBatchConfig,ht=0,Mr=null,mr=null,$r=0,$n=0,il=en(0),Er=0,Nc=null,eo=0,tf=0,cp=0,Rc=null,bn=null,up=0,fp=1/0,Ca=null;function al(){fp=br()+500}var rf=!1,dp=null,ts=null,nf=!1,rs=null,af=0,Ic=0,hp=null,sf=-1,of=0;function sn(){return ht&6?br():sf!==-1?sf:sf=br()}function ns(l){return l.mode&1?ht&2&&$r!==0?$r&-$r:Fw.transition!==null?(of===0&&(of=Ox()),of):(l=Pt,l!==0?l:Je()):1}function di(l,c,h,y){if(50<Ic)throw Ic=0,hp=null,Error(s(185));mc(l,h,y),(!(ht&2)||l!==Mr)&&(l===Mr&&(!(ht&2)&&(tf|=h),Er===4&&is(l,$r)),Ln(l,y),h===1&&ht===0&&!(c.mode&1)&&(al(),Tu&&Ji()))}function Ln(l,c){var h=l.callbackNode;_w(l,c);var y=Eu(l,l===Mr?$r:0);if(y===0)h!==null&&Lx(h),l.callbackNode=null,l.callbackPriority=0;else if(c=y&-y,l.callbackPriority!==c){if(h!=null&&Lx(h),c===1)l.tag===0?Pw(Jv.bind(null,l)):Mx(Jv.bind(null,l)),wt?Or(function(){!(ht&6)&&Ji()}):m1(x1,Ji),h=null;else{switch(bx(y)){case 1:h=x1;break;case 4:h=Ew;break;case 16:h=v1;break;case 536870912:h=Cw;break;default:h=v1}h=o4(h,qv.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function qv(l,c){if(sf=-1,of=0,ht&6)throw Error(s(327));var h=l.callbackNode;if(no()&&l.callbackNode!==h)return null;var y=Eu(l,l===Mr?$r:0);if(y===0)return null;if(y&30||y&l.expiredLanes||c)c=lf(l,y);else{c=y;var w=ht;ht|=2;var R=t4();(Mr!==l||$r!==c)&&(Ca=null,al(),to(l,c));do try{Qw();break}catch(Z){e4(l,Z)}while(1);T1(),ef.current=R,ht=w,mr!==null?c=0:(Mr=null,$r=0,c=Er)}if(c!==0){if(c===2&&(w=h1(l),w!==0&&(y=w,c=pp(l,w))),c===1)throw h=Nc,to(l,0),is(l,y),Ln(l,br()),h;if(c===6)is(l,y);else{if(w=l.current.alternate,!(y&30)&&!Kw(w)&&(c=lf(l,y),c===2&&(R=h1(l),R!==0&&(y=R,c=pp(l,R))),c===1))throw h=Nc,to(l,0),is(l,y),Ln(l,br()),h;switch(l.finishedWork=w,l.finishedLanes=y,c){case 0:case 1:throw Error(s(345));case 2:ro(l,bn,Ca);break;case 3:if(is(l,y),(y&130023424)===y&&(c=up+500-br(),10<c)){if(Eu(l,0)!==0)break;if(w=l.suspendedLanes,(w&y)!==y){sn(),l.pingedLanes|=l.suspendedLanes&w;break}l.timeoutHandle=G(ro.bind(null,l,bn,Ca),c);break}ro(l,bn,Ca);break;case 4:if(is(l,y),(y&4194240)===y)break;for(c=l.eventTimes,w=-1;0<y;){var B=31-Pi(y);R=1<<B,B=c[B],B>w&&(w=B),y&=~R}if(y=w,y=br()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*Xw(y/1960))-y,10<y){l.timeoutHandle=G(ro.bind(null,l,bn,Ca),y);break}ro(l,bn,Ca);break;case 5:ro(l,bn,Ca);break;default:throw Error(s(329))}}}return Ln(l,br()),l.callbackNode===h?qv.bind(null,l):null}function pp(l,c){var h=Rc;return l.current.memoizedState.isDehydrated&&(to(l,c).flags|=256),l=lf(l,c),l!==2&&(c=bn,bn=h,c!==null&&gp(c)),l}function gp(l){bn===null?bn=l:bn.push.apply(bn,l)}function Kw(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var y=0;y<h.length;y++){var w=h[y],R=w.getSnapshot;w=w.value;try{if(!Fi(R(),w))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function is(l,c){for(c&=~cp,c&=~tf,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-Pi(c),y=1<<h;l[h]=-1,c&=~y}}function Jv(l){if(ht&6)throw Error(s(327));no();var c=Eu(l,0);if(!(c&1))return Ln(l,br()),null;var h=lf(l,c);if(l.tag!==0&&h===2){var y=h1(l);y!==0&&(c=y,h=pp(l,y))}if(h===1)throw h=Nc,to(l,0),is(l,c),Ln(l,br()),h;if(h===6)throw Error(s(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,ro(l,bn,Ca),Ln(l,br()),null}function Zv(l){rs!==null&&rs.tag===0&&!(ht&6)&&no();var c=ht;ht|=1;var h=ur.transition,y=Pt;try{if(ur.transition=null,Pt=1,l)return l()}finally{Pt=y,ur.transition=h,ht=c,!(ht&6)&&Ji()}}function mp(){$n=il.current,bt(il)}function to(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==ue&&(l.timeoutHandle=ue,J(h)),mr!==null)for(h=mr.return;h!==null;){var y=h;switch(S1(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&_u();break;case 3:tl(),bt(In),bt(tn),O1();break;case 5:I1(y);break;case 4:tl();break;case 13:bt(Zt);break;case 19:bt(Zt);break;case 10:A1(y.type._context);break;case 22:case 23:mp()}h=h.return}if(Mr=l,mr=l=as(l.current,null),$r=$n=c,Er=0,Nc=null,cp=tf=eo=0,bn=Rc=null,Js!==null){for(c=0;c<Js.length;c++)if(h=Js[c],y=h.interleaved,y!==null){h.interleaved=null;var w=y.next,R=h.pending;if(R!==null){var B=R.next;R.next=w,y.next=B}h.pending=y}Js=null}return l}function e4(l,c){do{var h=mr;try{if(T1(),Mu.current=zu,Bu){for(var y=er.memoizedState;y!==null;){var w=y.queue;w!==null&&(w.pending=null),y=y.next}Bu=!1}if(Zs=0,Lr=kr=er=null,Sc=!1,wc=0,lp.current=null,h===null||h.return===null){Er=1,Nc=c,mr=null;break}e:{var R=l,B=h.return,Z=h,fe=c;if(c=$r,Z.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var be=fe,$e=Z,ot=$e.tag;if(!($e.mode&1)&&(ot===0||ot===11||ot===15)){var ze=$e.alternate;ze?($e.updateQueue=ze.updateQueue,$e.memoizedState=ze.memoizedState,$e.lanes=ze.lanes):($e.updateQueue=null,$e.memoizedState=null)}var Wt=Cv(B);if(Wt!==null){Wt.flags&=-257,Tv(Wt,B,Z,R,c),Wt.mode&1&&Ev(R,be,c),c=Wt,fe=be;var zt=c.updateQueue;if(zt===null){var Mn=new Set;Mn.add(fe),c.updateQueue=Mn}else zt.add(fe);break e}else{if(!(c&1)){Ev(R,be,c),xp();break e}fe=Error(s(426))}}else if(Kt&&Z.mode&1){var Ta=Cv(B);if(Ta!==null){!(Ta.flags&65536)&&(Ta.flags|=256),Tv(Ta,B,Z,R,c),E1(rl(fe,Z));break e}}R=fe=rl(fe,Z),Er!==4&&(Er=2),Rc===null?Rc=[R]:Rc.push(R),R=B;do{switch(R.tag){case 3:R.flags|=65536,c&=-c,R.lanes|=c;var le=wv(R,fe,c);Yx(R,le);break e;case 1:Z=fe;var ee=R.type,ge=R.stateNode;if(!(R.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(ts===null||!ts.has(ge)))){R.flags|=65536,c&=-c,R.lanes|=c;var Ve=kv(R,Z,c);Yx(R,Ve);break e}}R=R.return}while(R!==null)}n4(h)}catch(et){c=et,mr===h&&h!==null&&(mr=h=h.return);continue}break}while(1)}function t4(){var l=ef.current;return ef.current=zu,l===null?zu:l}function xp(){(Er===0||Er===3||Er===2)&&(Er=4),Mr===null||!(eo&268435455)&&!(tf&268435455)||is(Mr,$r)}function lf(l,c){var h=ht;ht|=2;var y=t4();(Mr!==l||$r!==c)&&(Ca=null,to(l,c));do try{Yw();break}catch(w){e4(l,w)}while(1);if(T1(),ht=h,ef.current=y,mr!==null)throw Error(s(261));return Mr=null,$r=0,Er}function Yw(){for(;mr!==null;)r4(mr)}function Qw(){for(;mr!==null&&!ww();)r4(mr)}function r4(l){var c=s4(l.alternate,l,$n);l.memoizedProps=l.pendingProps,c===null?n4(l):mr=c,lp.current=null}function n4(l){var c=l;do{var h=c.alternate;if(l=c.return,c.flags&32768){if(h=Gw(h,c),h!==null){h.flags&=32767,mr=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Er=6,mr=null;return}}else if(h=Vw(h,c,$n),h!==null){mr=h;return}if(c=c.sibling,c!==null){mr=c;return}mr=c=l}while(c!==null);Er===0&&(Er=5)}function ro(l,c,h){var y=Pt,w=ur.transition;try{ur.transition=null,Pt=1,qw(l,c,h,y)}finally{ur.transition=w,Pt=y}return null}function qw(l,c,h,y){do no();while(rs!==null);if(ht&6)throw Error(s(327));h=l.finishedWork;var w=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(s(177));l.callbackNode=null,l.callbackPriority=0;var R=h.lanes|h.childLanes;if(Sw(l,R),l===Mr&&(mr=Mr=null,$r=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||nf||(nf=!0,o4(v1,function(){return no(),null})),R=(h.flags&15990)!==0,h.subtreeFlags&15990||R){R=ur.transition,ur.transition=null;var B=Pt;Pt=1;var Z=ht;ht|=4,lp.current=null,Ww(l,h),Wv(h,l),ce(l.containerInfo),l.current=h,$w(h),kw(),ht=Z,Pt=B,ur.transition=R}else l.current=h;if(nf&&(nf=!1,rs=l,af=w),R=l.pendingLanes,R===0&&(ts=null),Tw(h.stateNode),Ln(l,br()),c!==null)for(y=l.onRecoverableError,h=0;h<c.length;h++)w=c[h],y(w.value,{componentStack:w.stack,digest:w.digest});if(rf)throw rf=!1,l=dp,dp=null,l;return af&1&&l.tag!==0&&no(),R=l.pendingLanes,R&1?l===hp?Ic++:(Ic=0,hp=l):Ic=0,Ji(),null}function no(){if(rs!==null){var l=bx(af),c=ur.transition,h=Pt;try{if(ur.transition=null,Pt=16>l?16:l,rs===null)var y=!1;else{if(l=rs,rs=null,af=0,ht&6)throw Error(s(331));var w=ht;for(ht|=4,He=l.current;He!==null;){var R=He,B=R.child;if(He.flags&16){var Z=R.deletions;if(Z!==null){for(var fe=0;fe<Z.length;fe++){var be=Z[fe];for(He=be;He!==null;){var $e=He;switch($e.tag){case 0:case 11:case 15:Pc(8,$e,R)}var ot=$e.child;if(ot!==null)ot.return=$e,He=ot;else for(;He!==null;){$e=He;var ze=$e.sibling,Wt=$e.return;if(zv($e),$e===be){He=null;break}if(ze!==null){ze.return=Wt,He=ze;break}He=Wt}}}var zt=R.alternate;if(zt!==null){var Mn=zt.child;if(Mn!==null){zt.child=null;do{var Ta=Mn.sibling;Mn.sibling=null,Mn=Ta}while(Mn!==null)}}He=R}}if(R.subtreeFlags&2064&&B!==null)B.return=R,He=B;else e:for(;He!==null;){if(R=He,R.flags&2048)switch(R.tag){case 0:case 11:case 15:Pc(9,R,R.return)}var le=R.sibling;if(le!==null){le.return=R.return,He=le;break e}He=R.return}}var ee=l.current;for(He=ee;He!==null;){B=He;var ge=B.child;if(B.subtreeFlags&2064&&ge!==null)ge.return=B,He=ge;else e:for(B=ee;He!==null;){if(Z=He,Z.flags&2048)try{switch(Z.tag){case 0:case 11:case 15:Ku(9,Z)}}catch(et){Yt(Z,Z.return,et)}if(Z===B){He=null;break e}var Ve=Z.sibling;if(Ve!==null){Ve.return=Z.return,He=Ve;break e}He=Z.return}}if(ht=w,Ji(),qi&&typeof qi.onPostCommitFiberRoot=="function")try{qi.onPostCommitFiberRoot(Cu,l)}catch{}y=!0}return y}finally{Pt=h,ur.transition=c}}return!1}function i4(l,c,h){c=rl(h,c),c=wv(l,c,1),l=es(l,c,1),c=sn(),l!==null&&(mc(l,1,c),Ln(l,c))}function Yt(l,c,h){if(l.tag===3)i4(l,l,h);else for(;c!==null;){if(c.tag===3){i4(c,l,h);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(ts===null||!ts.has(y))){l=rl(h,l),l=kv(c,l,1),c=es(c,l,1),l=sn(),c!==null&&(mc(c,1,l),Ln(c,l));break}}c=c.return}}function Jw(l,c,h){var y=l.pingCache;y!==null&&y.delete(c),c=sn(),l.pingedLanes|=l.suspendedLanes&h,Mr===l&&($r&h)===h&&(Er===4||Er===3&&($r&130023424)===$r&&500>br()-up?to(l,0):cp|=h),Ln(l,c)}function a4(l,c){c===0&&(l.mode&1?(c=ku,ku<<=1,!(ku&130023424)&&(ku=4194304)):c=1);var h=sn();l=Zi(l,c),l!==null&&(mc(l,c,h),Ln(l,h))}function Zw(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),a4(l,h)}function ek(l,c){var h=0;switch(l.tag){case 13:var y=l.stateNode,w=l.memoizedState;w!==null&&(h=w.retryLane);break;case 19:y=l.stateNode;break;default:throw Error(s(314))}y!==null&&y.delete(c),a4(l,h)}var s4;s4=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||In.current)On=!0;else{if(!(l.lanes&h)&&!(c.flags&128))return On=!1,zw(l,c,h);On=!!(l.flags&131072)}else On=!1,Kt&&c.flags&1048576&&Bx(c,Pu,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;Hu(l,c),l=c.pendingProps;var w=Xo(c,tn.current);Zo(c,h),w=M1(null,c,y,l,w,h);var R=B1();return c.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Dn(y)?(R=!0,Su(c)):R=!1,c.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,N1(c),w.updater=Vu,c.stateNode=w,w._reactInternals=c,H1(c,y,l,h),c=K1(null,c,y,!0,R,h)):(c.tag=0,Kt&&R&&_1(c),Sn(null,c,w,h),c=c.child),c;case 16:y=c.elementType;e:{switch(Hu(l,c),l=c.pendingProps,w=y._init,y=w(y._payload),c.type=y,w=c.tag=rk(y),l=Ri(y,l),w){case 0:c=X1(null,c,y,l,h);break e;case 1:c=Iv(null,c,y,l,h);break e;case 11:c=Av(null,c,y,l,h);break e;case 14:c=Pv(null,c,y,Ri(y.type,l),h);break e}throw Error(s(306,y,""))}return c;case 0:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ri(y,w),X1(l,c,y,w,h);case 1:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ri(y,w),Iv(l,c,y,w,h);case 3:e:{if(Dv(c),l===null)throw Error(s(387));y=c.pendingProps,R=c.memoizedState,w=R.element,Kx(l,c),bu(c,y,null,h);var B=c.memoizedState;if(y=B.element,Ze&&R.isDehydrated)if(R={element:y,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){w=rl(Error(s(423)),c),c=Ov(l,c,y,h,w);break e}else if(y!==w){w=rl(Error(s(424)),c),c=Ov(l,c,y,h,w);break e}else for(Ze&&(li=j(c.stateNode.containerInfo),Wn=c,Kt=!0,Ni=null,xc=!1),h=Wx(c,null,y,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Qo(),y===w){c=Ea(l,c,h);break e}Sn(l,c,y,h)}c=c.child}return c;case 5:return qx(c),l===null&&k1(c),y=c.type,w=c.pendingProps,R=l!==null?l.memoizedProps:null,B=w.children,K(y,w)?B=null:R!==null&&K(y,R)&&(c.flags|=32),Rv(l,c),Sn(l,c,B,h),c.child;case 6:return l===null&&k1(c),null;case 13:return bv(l,c,h);case 4:return R1(c,c.stateNode.containerInfo),y=c.pendingProps,l===null?c.child=qo(c,null,y,h):Sn(l,c,y,h),c.child;case 11:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ri(y,w),Av(l,c,y,w,h);case 7:return Sn(l,c,c.pendingProps,h),c.child;case 8:return Sn(l,c,c.pendingProps.children,h),c.child;case 12:return Sn(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(y=c.type._context,w=c.pendingProps,R=c.memoizedProps,B=w.value,$x(c,y,B),R!==null)if(Fi(R.value,B)){if(R.children===w.children&&!In.current){c=Ea(l,c,h);break e}}else for(R=c.child,R!==null&&(R.return=c);R!==null;){var Z=R.dependencies;if(Z!==null){B=R.child;for(var fe=Z.firstContext;fe!==null;){if(fe.context===y){if(R.tag===1){fe=ka(-1,h&-h),fe.tag=2;var be=R.updateQueue;if(be!==null){be=be.shared;var $e=be.pending;$e===null?fe.next=fe:(fe.next=$e.next,$e.next=fe),be.pending=fe}}R.lanes|=h,fe=R.alternate,fe!==null&&(fe.lanes|=h),P1(R.return,h,c),Z.lanes|=h;break}fe=fe.next}}else if(R.tag===10)B=R.type===c.type?null:R.child;else if(R.tag===18){if(B=R.return,B===null)throw Error(s(341));B.lanes|=h,Z=B.alternate,Z!==null&&(Z.lanes|=h),P1(B,h,c),B=R.sibling}else B=R.child;if(B!==null)B.return=R;else for(B=R;B!==null;){if(B===c){B=null;break}if(R=B.sibling,R!==null){R.return=B.return,B=R;break}B=B.return}R=B}Sn(l,c,w.children,h),c=c.child}return c;case 9:return w=c.type,y=c.pendingProps.children,Zo(c,h),w=ci(w),y=y(w),c.flags|=1,Sn(l,c,y,h),c.child;case 14:return y=c.type,w=Ri(y,c.pendingProps),w=Ri(y.type,w),Pv(l,c,y,w,h);case 15:return Fv(l,c,c.type,c.pendingProps,h);case 17:return y=c.type,w=c.pendingProps,w=c.elementType===y?w:Ri(y,w),Hu(l,c),c.tag=1,Dn(y)?(l=!0,Su(c)):l=!1,Zo(c,h),_v(c,y,w),H1(c,y,w,h),K1(null,c,y,!0,l,h);case 19:return Mv(l,c,h);case 22:return Nv(l,c,h)}throw Error(s(156,c.tag))};function o4(l,c){return m1(l,c)}function tk(l,c,h,y){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(l,c,h,y){return new tk(l,c,h,y)}function vp(l){return l=l.prototype,!(!l||!l.isReactComponent)}function rk(l){if(typeof l=="function")return vp(l)?1:0;if(l!=null){if(l=l.$$typeof,l===_)return 11;if(l===S)return 14}return 2}function as(l,c){var h=l.alternate;return h===null?(h=hi(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function cf(l,c,h,y,w,R){var B=2;if(y=l,typeof l=="function")vp(l)&&(B=1);else if(typeof l=="string")B=5;else e:switch(l){case d:return io(h.children,w,R,c);case p:B=8,w|=8;break;case m:return l=hi(12,h,c,w|2),l.elementType=m,l.lanes=R,l;case k:return l=hi(13,h,c,w),l.elementType=k,l.lanes=R,l;case E:return l=hi(19,h,c,w),l.elementType=E,l.lanes=R,l;case C:return uf(h,w,R,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:B=10;break e;case g:B=9;break e;case _:B=11;break e;case S:B=14;break e;case x:B=16,y=null;break e}throw Error(s(130,l==null?l:typeof l,""))}return c=hi(B,h,c,w),c.elementType=l,c.type=y,c.lanes=R,c}function io(l,c,h,y){return l=hi(7,l,y,c),l.lanes=h,l}function uf(l,c,h,y){return l=hi(22,l,y,c),l.elementType=C,l.lanes=h,l.stateNode={isHidden:!1},l}function yp(l,c,h){return l=hi(6,l,null,c),l.lanes=h,l}function _p(l,c,h){return c=hi(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function nk(l,c,h,y,w){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ue,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=p1(0),this.expirationTimes=p1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=p1(0),this.identifierPrefix=y,this.onRecoverableError=w,Ze&&(this.mutableSourceEagerHydrationData=null)}function l4(l,c,h,y,w,R,B,Z,fe){return l=new nk(l,c,h,Z,fe),c===1?(c=1,R===!0&&(c|=8)):c=0,R=hi(3,null,null,c),l.current=R,R.stateNode=l,R.memoizedState={element:y,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},N1(R),l}function c4(l){if(!l)return Ja;l=l._reactInternals;e:{if(I(l)!==l||l.tag!==1)throw Error(s(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Dn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(s(171))}if(l.tag===1){var h=l.type;if(Dn(h))return Ix(l,h,c)}return c}function u4(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=b(c),l===null?null:l.stateNode}function f4(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function ff(l,c){f4(l,c),(l=l.alternate)&&f4(l,c)}function ik(l){return l=b(l),l===null?null:l.stateNode}function ak(){return null}return r.attemptContinuousHydration=function(l){if(l.tag===13){var c=Zi(l,134217728);if(c!==null){var h=sn();di(c,l,134217728,h)}ff(l,134217728)}},r.attemptDiscreteHydration=function(l){if(l.tag===13){var c=Zi(l,1);if(c!==null){var h=sn();di(c,l,1,h)}ff(l,1)}},r.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=ns(l),h=Zi(l,c);if(h!==null){var y=sn();di(h,l,c,y)}ff(l,c)}},r.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=gc(c.pendingLanes);h!==0&&(g1(c,h|1),Ln(c,br()),!(ht&6)&&(al(),Ji()))}break;case 13:Zv(function(){var y=Zi(l,1);if(y!==null){var w=sn();di(y,l,1,w)}}),ff(l,1)}},r.batchedUpdates=function(l,c){var h=ht;ht|=1;try{return l(c)}finally{ht=h,ht===0&&(al(),Tu&&Ji())}},r.createComponentSelector=function(l){return{$$typeof:Yu,value:l}},r.createContainer=function(l,c,h,y,w,R,B){return l4(l,c,!1,null,h,y,w,R,B)},r.createHasPseudoClassSelector=function(l){return{$$typeof:Qu,value:l}},r.createHydrationContainer=function(l,c,h,y,w,R,B,Z,fe){return l=l4(h,y,!0,l,w,R,B,Z,fe),l.context=c4(null),h=l.current,y=sn(),w=ns(h),R=ka(y,w),R.callback=c??null,es(h,R,w),l.current.lanes=w,mc(l,w,y),Ln(l,y),l},r.createPortal=function(l,c,h){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:y==null?null:""+y,children:l,containerInfo:c,implementation:h}},r.createRoleSelector=function(l){return{$$typeof:qu,value:l}},r.createTestNameSelector=function(l){return{$$typeof:Ju,value:l}},r.createTextSelector=function(l){return{$$typeof:Zu,value:l}},r.deferredUpdates=function(l){var c=Pt,h=ur.transition;try{return ur.transition=null,Pt=16,l()}finally{Pt=c,ur.transition=h}},r.discreteUpdates=function(l,c,h,y,w){var R=Pt,B=ur.transition;try{return ur.transition=null,Pt=1,l(c,h,y,w)}finally{Pt=R,ur.transition=B,ht===0&&al()}},r.findAllNodes=op,r.findBoundingRects=function(l,c){if(!pr)throw Error(s(363));c=op(l,c),l=[];for(var h=0;h<c.length;h++)l.push(me(c[h]));for(c=l.length-1;0<c;c--){h=l[c];for(var y=h.x,w=y+h.width,R=h.y,B=R+h.height,Z=c-1;0<=Z;Z--)if(c!==Z){var fe=l[Z],be=fe.x,$e=be+fe.width,ot=fe.y,ze=ot+fe.height;if(y>=be&&R>=ot&&w<=$e&&B<=ze){l.splice(c,1);break}else if(y!==be||h.width!==fe.width||ze<R||ot>B){if(!(R!==ot||h.height!==fe.height||$e<y||be>w)){be>y&&(fe.width+=be-y,fe.x=y),$e<w&&(fe.width=w-be),l.splice(c,1);break}}else{ot>R&&(fe.height+=ot-R,fe.y=R),ze<B&&(fe.height=B-ot),l.splice(c,1);break}}}return l},r.findHostInstance=u4,r.findHostInstanceWithNoPortals=function(l){return l=U(l),l=l!==null?he(l):null,l===null?null:l.stateNode},r.findHostInstanceWithWarning=function(l){return u4(l)},r.flushControlled=function(l){var c=ht;ht|=1;var h=ur.transition,y=Pt;try{ur.transition=null,Pt=1,l()}finally{Pt=y,ur.transition=h,ht=c,ht===0&&(al(),Ji())}},r.flushPassiveEffects=no,r.flushSync=Zv,r.focusWithin=function(l,c){if(!pr)throw Error(s(363));for(l=ip(l),c=Qv(l,c),c=Array.from(c),l=0;l<c.length;){var h=c[l++];if(!we(h)){if(h.tag===5&&Pe(h.stateNode))return!0;for(h=h.child;h!==null;)c.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Pt},r.getFindAllNodesFailureDescription=function(l,c){if(!pr)throw Error(s(363));var h=0,y=[];l=[ip(l),0];for(var w=0;w<l.length;){var R=l[w++],B=l[w++],Z=c[B];if((R.tag!==5||!we(R))&&(ap(R,Z)&&(y.push(sp(Z)),B++,B>h&&(h=B)),B<c.length))for(R=R.child;R!==null;)l.push(R,B),R=R.sibling}if(h<c.length){for(l=[];h<c.length;h++)l.push(sp(c[h]));return`findAllNodes was able to match part of the selector:
  `+(y.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},r.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return Ae(l.child.stateNode);default:return l.child.stateNode}},r.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ik,findFiberByHostInstance:l.findFiberByHostInstance||ak,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Cu=c.inject(l),qi=c}catch{}l=!!c.checkDCE}}return l},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(l,c,h,y){if(!pr)throw Error(s(363));l=op(l,c);var w=Me(l,h,y).disconnect;return{disconnect:function(){w()}}},r.registerMutableSourceForHydration=function(l,c){var h=c._getVersion;h=h(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,h]:l.mutableSourceEagerHydrationData.push(c,h)},r.runWithPriority=function(l,c){var h=Pt;try{return Pt=l,c()}finally{Pt=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(l,c,h,y){var w=c.current,R=sn(),B=ns(w);return h=c4(h),c.context===null?c.context=h:c.pendingContext=h,c=ka(R,B),c.payload={element:l},y=y===void 0?null:y,y!==null&&(c.callback=y),l=es(w,c,B),l!==null&&(di(l,w,B,R),Ou(l,w,B)),B},r};lw.exports=GM;var HM=lw.exports;const WM=Xd(HM);var cw={exports:{}},Wo={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Wo.ConcurrentRoot=1;Wo.ContinuousEventPriority=4;Wo.DefaultEventPriority=16;Wo.DiscreteEventPriority=1;Wo.IdleEventPriority=536870912;Wo.LegacyRoot=0;cw.exports=Wo;var uw=cw.exports;const h5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let p5=!1,g5=!1;const Fx=".react-konva-event",$M=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,XM=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,KM={};function u1(e,t,r=KM){if(!p5&&"zIndex"in t&&(console.warn(XM),p5=!0),!g5&&t.draggable){var n=t.x!==void 0||t.y!==void 0,i=t.onDragEnd||t.onDragMove;n&&!i&&(console.warn($M),g5=!0)}for(var a in r)if(!h5[a]){var s=a.slice(0,2)==="on",o=r[a]!==t[a];if(s&&o){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e.off(u,r[a])}var f=!t.hasOwnProperty(a);f&&e.setAttr(a,void 0)}var d=t._useStrictMode,p={},m=!1;const v={};for(var a in t)if(!h5[a]){var s=a.slice(0,2)==="on",g=r[a]!==t[a];if(s&&g){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t[a]&&(v[u]=t[a])}!s&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(m=!0,p[a]=t[a])}m&&(e.setAttrs(p),$s(e));for(var u in v)e.on(u+Fx,v[u])}function $s(e){if(!ft.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const fw={},YM={};ru.Node.prototype._applyProps=u1;function QM(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),$s(e)}function qM(e,t,r){let n=ru[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=ru.Group);const i={},a={};for(var s in t){var o=s.slice(0,2)==="on";o?a[s]=t[s]:i[s]=t[s]}const u=new n(i);return u1(u,a),u}function JM(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function ZM(e,t,r){return!1}function eB(e){return e}function tB(){return null}function rB(){return null}function nB(e,t,r,n){return YM}function iB(){}function aB(e){}function sB(e,t){return!1}function oB(){return fw}function lB(){return fw}const cB=setTimeout,uB=clearTimeout,fB=-1;function dB(e,t){return!1}const hB=!1,pB=!0,gB=!0;function mB(e,t){t.parent===e?t.moveToTop():e.add(t),$s(e)}function xB(e,t){t.parent===e?t.moveToTop():e.add(t),$s(e)}function dw(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),$s(e)}function vB(e,t,r){dw(e,t,r)}function yB(e,t){t.destroy(),t.off(Fx),$s(e)}function _B(e,t){t.destroy(),t.off(Fx),$s(e)}function SB(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function wB(e,t,r){}function kB(e,t,r,n,i){u1(e,i,n)}function EB(e){e.hide(),$s(e)}function CB(e){}function TB(e,t){(t.visible==null||t.visible)&&e.show()}function AB(e,t){}function PB(e){}function FB(){}const NB=()=>uw.DefaultEventPriority,RB=Object.freeze(Object.defineProperty({__proto__:null,appendChild:mB,appendChildToContainer:xB,appendInitialChild:QM,cancelTimeout:uB,clearContainer:PB,commitMount:wB,commitTextUpdate:SB,commitUpdate:kB,createInstance:qM,createTextInstance:JM,detachDeletedInstance:FB,finalizeInitialChildren:ZM,getChildHostContext:lB,getCurrentEventPriority:NB,getPublicInstance:eB,getRootHostContext:oB,hideInstance:EB,hideTextInstance:CB,idlePriority:s0.unstable_IdlePriority,insertBefore:dw,insertInContainerBefore:vB,isPrimaryRenderer:hB,noTimeout:fB,now:s0.unstable_now,prepareForCommit:tB,preparePortalMount:rB,prepareUpdate:nB,removeChild:yB,removeChildFromContainer:_B,resetAfterCommit:iB,resetTextContent:aB,run:s0.unstable_runWithPriority,scheduleTimeout:cB,shouldDeprioritizeSubtree:sB,shouldSetTextContent:dB,supportsMutation:gB,unhideInstance:TB,unhideTextInstance:AB,warnsIfNotActing:pB},Symbol.toStringTag,{value:"Module"}));var IB=Object.defineProperty,DB=Object.defineProperties,OB=Object.getOwnPropertyDescriptors,m5=Object.getOwnPropertySymbols,bB=Object.prototype.hasOwnProperty,LB=Object.prototype.propertyIsEnumerable,x5=(e,t,r)=>t in e?IB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v5=(e,t)=>{for(var r in t||(t={}))bB.call(t,r)&&x5(e,r,t[r]);if(m5)for(var r of m5(t))LB.call(t,r)&&x5(e,r,t[r]);return e},MB=(e,t)=>DB(e,OB(t)),y5,_5;typeof window<"u"&&((y5=window.document)!=null&&y5.createElement||((_5=window.navigator)==null?void 0:_5.product)==="ReactNative")?ke.useLayoutEffect:ke.useEffect;function hw(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const i=hw(n,t,r);if(i)return i;n=t?null:n.sibling}}function pw(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const S5=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=S5;return}return S5.apply(this,arguments)};const Nx=pw(ke.createContext(null));class gw extends ke.Component{render(){return ke.createElement(Nx.Provider,{value:this._reactInternals},this.props.children)}}function BB(){const e=ke.useContext(Nx);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=ke.useId();return ke.useMemo(()=>{for(const n of[e,e==null?void 0:e.alternate]){if(!n)continue;const i=hw(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===t)return!0;s=s.next}});if(i)return i}},[e,t])}function UB(){const e=BB(),[t]=ke.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==Nx&&!t.has(i)&&t.set(i,ke.useContext(pw(i)))}r=r.return}return t}function jB(){const e=UB();return ke.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>ke.createElement(t,null,ke.createElement(r.Provider,MB(v5({},n),{value:e.get(r)}))),t=>ke.createElement(gw,v5({},t))),[e])}function zB(e){const t=Sr.useRef({});return Sr.useLayoutEffect(()=>{t.current=e}),Sr.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const VB=e=>{const t=Sr.useRef(),r=Sr.useRef(),n=Sr.useRef(),i=zB(e),a=jB(),s=o=>{const{forwardedRef:u}=e;u&&(typeof u=="function"?u(o):u.current=o)};return Sr.useLayoutEffect(()=>(r.current=new ru.Stage({width:e.width,height:e.height,container:t.current}),s(r.current),n.current=a0.createContainer(r.current,uw.LegacyRoot,!1,null),a0.updateContainer(Sr.createElement(a,{},e.children),n.current),()=>{ru.isBrowser&&(s(null),a0.updateContainer(null,n.current,null),r.current.destroy())}),[]),Sr.useLayoutEffect(()=>{s(r.current),u1(r.current,e,i),a0.updateContainer(Sr.createElement(a,{},e.children),n.current,null)}),Sr.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},GB="Layer",Xc="Group",Xn="Rect",Kc="Circle",w5="Line",oa="Text",a0=WM(RB);a0.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Sr.version,rendererPackageName:"react-konva"});const HB=Sr.forwardRef((e,t)=>Sr.createElement(gw,{},Sr.createElement(VB,{...e,forwardedRef:t}))),Yc=[{level:0,threshold:.1,description:"Ultra Low - Package outline only"},{level:1,threshold:.3,description:"Low - Package + major banks"},{level:2,threshold:.7,description:"Medium - + pin circles"},{level:3,threshold:1.5,description:"High - + pin/signal names"},{level:4,threshold:1/0,description:"Ultra High - All details"}];function WB(e){for(let t=0;t<Yc.length;t++)if(e<Yc[t].threshold)return Yc[t].level;return Yc[Yc.length-1].level}function $B(e,t){return e>=t}function XB(e){switch(e){case 0:return 1;case 1:return .8;case 2:return .6;case 3:return .4;case 4:return .2;default:return .5}}function KB(e){switch(e){case 0:return 50;case 1:return 200;case 2:return 500;case 3:return 1e3;case 4:return 5e3;default:return 1e3}}function YB(e,t="pin"){return e>={pin:.7,signal:.7,bank:.3}[t]}function QB(e,t=12){if(e<.5)return 0;const r=t*Math.min(e,2);return Math.max(8,Math.min(r,24))}function qB(e){return e>=.3}function JB(e){return e>=.7}class En{}En.getLODLevel=WB;En.shouldRenderAtLOD=$B;En.getPerformanceMultiplier=XB;En.getMaxElements=KB;En.shouldRenderText=YB;En.getAdaptiveTextSize=QB;En.shouldRenderDifferentialPairs=qB;En.shouldRenderPinDetails=JB;class Ur{static createVirtualizedPinList(t,r,n){const i=Math.ceil(r/n)+5;return{getVisibleRange:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length);return{startIndex:s,endIndex:o}},getVisiblePins:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length),{startIndex:u,endIndex:f}={startIndex:s,endIndex:o};return t.slice(u,f).map((d,p)=>({pin:d,index:u+p,top:(u+p)*n}))},getTotalHeight:()=>t.length*n}}static createDebouncedSearch(t,r=300){let n,i=[];return{search:a=>new Promise(s=>{if(clearTimeout(n),!a.trim()){s([]);return}n=setTimeout(()=>{i=t(a),s(i)},r)}),getLastResults:()=>i,cancel:()=>{clearTimeout(n)}}}static optimizeCanvasRendering(){return{getLODLevel:t=>t<.3?"ultra-low":t<.6?"low":t<1.2?"medium":t<2.5?"high":"ultra-high",cullPins:(t,r)=>{const i={left:r.x-100,right:r.x+r.width+100,top:r.y-100,bottom:r.y+r.height+100};return t.filter(a=>{const s=a.position.x*r.scale,o=a.position.y*r.scale;return s>=i.left&&s<=i.right&&o>=i.top&&o<=i.bottom})},batchDOMUpdates:t=>{requestAnimationFrame(()=>{t.forEach(r=>r())})}}}static createPinIndexes(t){const r=new Map,n=new Map,i=new Map,a=new Map,s=new Map;return t.forEach(o=>{r.set(o.id,o),n.set(o.pinNumber,o),o.signalName&&(i.has(o.signalName)||i.set(o.signalName,[]),i.get(o.signalName).push(o)),o.bank&&(a.has(o.bank)||a.set(o.bank,[]),a.get(o.bank).push(o)),s.has(o.pinType)||s.set(o.pinType,[]),s.get(o.pinType).push(o)}),{byId:r,byPinNumber:n,bySignalName:i,byBank:a,byPinType:s,findById:o=>r.get(o),findByPinNumber:o=>n.get(o),findBySignalName:o=>i.get(o)||[],findByBank:o=>a.get(o)||[],findByPinType:o=>s.get(o)||[]}}static startRenderMeasurement(t){this.renderMetrics.set(t,performance.now())}static endRenderMeasurement(t){const r=this.renderMetrics.get(t);if(!r)return 0;const n=performance.now()-r;return this.renderMetrics.delete(t),n}static trackFrameRate(){this.frameCount++;const t=performance.now();if(t-this.lastFrameTime>=1e3){const r=this.frameCount/((t-this.lastFrameTime)/1e3);return this.frameCount=0,this.lastFrameTime=t,r}return null}static createSmartFilter(t){return{filter:(r,n)=>{const i=[];for(const a of t){if(n&&i.length>=n)break;let s=!0;for(const o of r)if(!o(a)){s=!1;break}s&&i.push(a)}return i}}}static createPinSearchRanker(){return{rankPins:(t,r)=>{const n=r.toLowerCase(),i=[];return t.forEach(a=>{let s=0;a.pinNumber.toLowerCase()===n?s+=100:a.pinNumber.toLowerCase().startsWith(n)?s+=80:a.pinNumber.toLowerCase().includes(n)&&(s+=40),a.signalName&&a.signalName.toLowerCase().includes(n)&&(s+=60),a.pinName.toLowerCase().includes(n)&&(s+=30),a.bank&&a.bank.toLowerCase().includes(n)&&(s+=20),s>0&&i.push({pin:a,score:s})}),i.sort((a,s)=>s.score-a.score)}}}}Ur.renderMetrics=new Map;Ur.frameCount=0;Ur.lastFrameTime=performance.now();const ZB=({fileName:e,viewInfo:t})=>A.jsxs("div",{style:{width:"100%",height:"32px",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0 16px",position:"relative",zIndex:2,color:"#e0e0e0",fontSize:"12px",fontWeight:500,boxSizing:"border-box",borderBottom:"1px solid #333"},children:[A.jsx("span",{style:{transform:"translateY(-2px)"},children:t}),A.jsx("span",{style:{transform:"translateY(-2px)",marginLeft:"360px"},children:e})]}),eU=({package:e,pins:t,selectedPins:r,onPinSelect:n,onPinDoubleClick:i,zoom:a,rotation:s,isTopView:o,onZoomChange:u,resetTrigger:f=0})=>{const{togglePinSelection:d,selectPins:p,visibleBanks:m,toggleBankVisibility:v,showAllBanks:g,pins:_}=$i(),k=ke.useRef(null),E=ke.useRef(null),[S,x]=ke.useState({width:800,height:600}),[C,N]=ke.useState(null),[T,F]=ke.useState({x:0,y:0,scale:1}),[P,I]=ke.useState(!1),[D,U]=ke.useState({x:0,y:0}),[b,Q]=ke.useState(0),[he,te]=ke.useState({x:0,y:0});console.log(` PackageCanvas: Received ${t.length} pins (filtered)`);const Ae=En.getLODLevel(T.scale),Te=ke.useMemo(()=>{Ur.startRenderMeasurement("pin-indexing");const _e=Ur.createPinIndexes(t);return Ur.endRenderMeasurement("pin-indexing"),_e},[t]),ie=ke.useMemo(()=>{Ur.startRenderMeasurement("viewport-culling");const _e=S.width,me=S.height,Se={x:-T.x/T.scale-_e/(2*T.scale),y:-T.y/T.scale-me/(2*T.scale),width:_e/T.scale,height:me/T.scale,scale:T.scale},we=(Ee,Pe)=>{let{x:Me,y:pe}=Ee.position;if(s!==0){const re=s*Math.PI/180,xe=Math.cos(re),De=Math.sin(re),Le=Me*xe-pe*De,Ke=Me*De+pe*xe;Me=Le,pe=Ke}return o||(Me=-Me),Me>=Pe.x&&Me<=Pe.x+Pe.width&&pe>=Pe.y&&pe<=Pe.y+Pe.height};if(T.scale>.6){const Ee=200/T.scale,Pe={...Se,x:Se.x-Ee,y:Se.y-Ee*1.5,width:Se.width+Ee*2,height:Se.height+Ee*2.5},Me=Array.from(r).map(De=>Te.findById(De)).filter(Boolean),pe=t.filter(De=>we(De,Pe)),re=new Map;pe.forEach(De=>re.set(De.id,De)),Me.forEach(De=>re.set(De.id,De));const xe=Array.from(re.values());return Ur.endRenderMeasurement("viewport-culling"),xe}else{if(T.scale<=.2)return Ur.endRenderMeasurement("viewport-culling"),t;if(T.scale<=.4){const Pe=new Map;t.forEach(re=>{const xe=re.bank||"NA";Pe.has(xe)||Pe.set(xe,[]),Pe.get(xe).push(re)});const Me=[],pe=Array.from(r).map(re=>Te.findById(re)).filter(Boolean);return Me.push(...pe),Pe.forEach(re=>{const xe=Math.max(1,Math.floor(re.length*.85)),De=Math.max(1,Math.floor(re.length/xe));for(let Le=0;Le<re.length;Le+=De){const Ke=re[Le];r.has(Ke.id)||Me.push(Ke)}}),Ur.endRenderMeasurement("viewport-culling"),Me}else if(T.scale<=.6){const Ee=300/T.scale,Pe={x:Se.x-Ee,y:Se.y-Ee*1.5,width:Se.width+Ee*2,height:Se.height+Ee*2.5},Me=Array.from(r).map(xt=>Te.findById(xt)).filter(Boolean),pe=t.filter(xt=>we(xt,Pe)),re=t.filter(xt=>!pe.some(Dt=>Dt.id===xt.id)&&!r.has(xt.id)),xe=Math.max(1,Math.floor(re.length/200)),De=re.filter((xt,Dt)=>Dt%xe===0),Le=new Map;Me.forEach(xt=>Le.set(xt.id,xt)),pe.forEach(xt=>Le.set(xt.id,xt)),De.forEach(xt=>Le.set(xt.id,xt));const Ke=Array.from(Le.values());return Ur.endRenderMeasurement("viewport-culling"),Ke}else{const Ee=new Map;t.forEach(pe=>{const re=pe.bank||"NA";Ee.has(re)||Ee.set(re,[]),Ee.get(re).push(pe)});const Pe=Math.max(10,Math.floor(800/Ee.size)),Me=[];return Ee.forEach(pe=>{const re=pe.filter(De=>r.has(De.id));Me.push(...re);const xe=Pe-re.length;if(xe>0){const De=pe.filter(Ke=>!r.has(Ke.id)),Le=Math.max(1,Math.floor(De.length/xe));for(let Ke=0;Ke<De.length&&Me.length-re.length<xe;Ke+=Le)Me.push(De[Ke])}}),Ur.endRenderMeasurement("viewport-culling"),Me}}},[t,T,r,S,Te]),X=200,ce=8,Ce=(_e,me)=>{if(me.ctrlKey||me.metaKey)d(_e),N(_e);else if(me.shiftKey&&C){const Se=t.findIndex(Ee=>Ee.id===_e),we=t.findIndex(Ee=>Ee.id===C);if(Se!==-1&&we!==-1){const Ee=Math.min(Se,we),Pe=Math.max(Se,we),Me=t.slice(Ee,Pe+1).map(re=>re.id),pe=new Set(r);Me.forEach(re=>pe.add(re)),p(Array.from(pe))}}else n(_e),N(_e)};ke.useEffect(()=>{var we,Ee;const _e=()=>{var Me;const Pe=(Me=k.current)==null?void 0:Me.container();if(Pe){const pe=Pe.getBoundingClientRect(),re={width:Math.max(400,pe.width),height:Math.max(300,pe.height)};x(xe=>xe.width!==re.width||xe.height!==re.height?(console.log(" Canvas size updated for dynamic maximization:",re),re):xe)}},me=setTimeout(()=>{_e()},200),Se=(Ee=(we=k.current)==null?void 0:we.container())==null?void 0:Ee.parentElement;if(Se){const Pe=new ResizeObserver(()=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{_e()},16)});return Pe.observe(Se),()=>{clearTimeout(me),E.current&&clearTimeout(E.current),Pe.disconnect()}}return()=>{clearTimeout(me)}},[]),ke.useEffect(()=>{if(e&&t.length>0&&S.width>0&&S.height>0){const _e=de();if(_e){const{width:me,height:Se,centerX:we,centerY:Ee}=_e,Pe=0,Me=S.width-Pe*2,pe=S.height-Pe*2,re=Me/me,xe=pe/Se,De=Math.max(.8,Math.min(re,xe,2)),Le={x:S.width/2,y:S.height/2+30},Ke={x:Le.x-we*De,y:Le.y-Ee*De,scale:De};console.log(" Auto-fit viewport:",Ke,"for package:",me,"x",Se,"scale:",De),F(Ke)}}},[e,t.length,S]);const L=_e=>{var me;return _e.pinType==="GROUND"||_e.pinName==="GND"?go("GROUND"):_e.pinType==="POWER"||(me=_e.pinName)!=null&&me.includes("VCC")?go("POWER"):go(_e.bank)},q=_e=>({IO:"#FFF",CONFIG:"#FFD700",POWER:"#FF4500",GROUND:"#000",MGT:"#9B4AE2",CLOCK:"#FF69B4",ADC:"#00FFFF",SPECIAL:"#FF1493",MIO:"#32CD32",DDR:"#8A2BE2",NC:"#696969",RESERVED:"#999999"})[_e.pinType]||"#FFF",Y=(_e,me,Se)=>{if(!_r.isDifferentialPin(_e))return null;const we=_r.findPairPin(_e,me);if(!we)return null;const Ee=Se.has(_e.id),Pe=Se.has(we.id);return Ee||Pe?(_r.getDifferentialPairType(_e.pinName)||(_e.signalName?_r.getDifferentialPairType(_e.signalName):null))==="positive"?"#FF3333":"#FF9933":null},K=(_e,me)=>_r.isDifferentialPin(_e)?_r.findPairPin(_e,me)!==null:!1,de=()=>{if(!e||t.length===0)return{width:600,height:600,centerX:300,centerY:300,minX:0,minY:0,maxX:600,maxY:600};const _e=t.map(Ut=>{var Fe;return(Fe=Ut.gridPosition)==null?void 0:Fe.row}).filter(Boolean),me=t.map(Ut=>{var Fe;return(Fe=Ut.gridPosition)==null?void 0:Fe.col}).filter(Boolean);console.log(` Found rows: ${_e.join(", ")}`);const Se=Math.min(..._e.map(Ut=>Is(Ut))),we=Math.max(..._e.map(Ut=>Is(Ut))),Ee=Math.min(...me),Pe=Math.max(...me);console.log(` Row indices - min: ${Se} (${ol(Se)}), max: ${we} (${ol(we)})`),console.log(` Col indices - min: ${Ee}, max: ${Pe}`);const pe=88,re=(Pe-Ee+1)*pe,xe=(we-Se+1)*pe,De=0,Le=re+De*2,Ke=xe+De*2,xt=(Ee+Pe-1)*pe/2,Dt=(Se+we)*pe/2;return{width:Le,height:Ke,centerX:xt,centerY:Dt,minX:(Ee-1)*pe,minY:Se*pe,maxX:Pe*pe,maxY:(we+1)*pe,gridSpacing:pe,minRow:Se,maxRow:we,minCol:Ee,maxCol:Pe}},G=de();ke.useEffect(()=>{t.length>0&&console.log(" PackageCanvas: Package loaded with",t.length,"pins")},[t.length]);const J=_e=>{let{x:me,y:Se}=_e.position;if(s!==0){const pe=s*Math.PI/180,re=Math.cos(pe),xe=Math.sin(pe),De=me*re-Se*xe,Le=me*xe+Se*re;me=De,Se=Le}o||(me=-me);const we=S.width,Ee=S.height,Pe=me*T.scale+T.x+we/2,Me=Se*T.scale+T.y+Ee/2;return{x:Pe,y:Me}},ue=(_e,me)=>{const Se=de(),we=Se.width*me,Ee=Se.height*me,Pe=S.width,Me=S.height,pe=Pe*.5,re=Me*.8,xe=-(we/2+pe),De=we/2+pe,Le=-(Ee/2+re*1.5),Ke=Ee/2+re;return{x:Math.max(xe,Math.min(De,_e.x)),y:Math.max(Le,Math.min(Ke,_e.y))}},ve=_e=>{_e.evt.preventDefault();const me=k.current;if(!me)return;const Se=me.getPointerPosition(),we=1.05;if(_e.evt.ctrlKey){const Ee=T.scale,Pe=_e.evt.deltaY>0?Ee/we:Ee*we,Me=Math.max(.1,Math.min(5,Pe)),pe={x:(Se.x-T.x)/Ee,y:(Se.y-T.y)/Ee},re={x:Se.x-pe.x*Me,y:Se.y-pe.y*Me},xe=ue(re,Me);F({scale:Me,x:xe.x,y:xe.y}),u==null||u(Me)}else{const Ee=T.y-_e.evt.deltaY*.5,Pe=ue({x:T.x,y:Ee},T.scale);F(Me=>({...Me,x:Pe.x,y:Pe.y}))}},Be=()=>{const _e=k.current;if(!_e)return;const me=_e.getPointerPosition(),Se=Date.now();Q(Se),te(me),U(me),I(!1)},V=()=>{const _e=k.current;if(!_e)return;const me=_e.getPointerPosition(),Se=Date.now();if(!P&&b>0){const we=Se-b,Ee=Math.sqrt(Math.pow(me.x-he.x,2)+Math.pow(me.y-he.y,2));(we>X||Ee>ce)&&I(!0)}if(P){const we=me.x-D.x,Ee=me.y-D.y,Pe={x:T.x+we,y:T.y+Ee},Me=ue(Pe,T.scale);F(pe=>({...pe,x:Me.x,y:Me.y}))}U(me)},Ze=()=>{I(!1),Q(0)},nt=()=>{I(!1),Q(0)},Ye=()=>{F({x:0,y:0,scale:1}),u==null||u(1)};ke.useEffect(()=>{Math.abs(a-1)<.001?F({x:0,y:0,scale:1}):F(_e=>({..._e,scale:a}))},[a,f]),ke.useEffect(()=>{const _e=me=>{(me.key==="r"||me.key==="R")&&Ye()};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[]);const Je=(_e,me)=>{const Se=Date.now();if(b>0){const we=Se-b,Ee=k.current;if(Ee&&we<X){const Pe=Ee.getPointerPosition();Math.sqrt(Math.pow(Pe.x-he.x,2)+Math.pow(Pe.y-he.y,2))<ce&&!P&&(_e.cancelBubble=!0,Ce(me.id,_e.evt))}}},Re=(_e,me)=>{_e.cancelBubble=!0,i(me.id)},wt=_e=>{const me=Date.now();if(!P&&b>0){const Se=me-b,we=k.current;if(we&&Se<X){const Ee=we.getPointerPosition();Math.sqrt(Math.pow(Ee.x-he.x,2)+Math.pow(Ee.y-he.y,2))<ce&&_e.target===_e.target.getStage()&&n("")}}};if(!e)return A.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"No package loaded. Please import a CSV file."});if(S.width<=0||S.height<=0)return A.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"Loading canvas..."});const Or=`View: ${o?"TOP":"BOTTOM"} | Rotation: ${s} | Zoom: ${Math.round(a*100)}%`,pr=e?`${e.device}pkg.csv (${e.packageType})`:"No package loaded";return A.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column"},children:[A.jsx(ZB,{fileName:pr,viewInfo:Or}),A.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[A.jsx("div",{style:{position:"absolute",top:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:T.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:Se,minRow:we,maxRow:Ee}=G;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=me;pe<=Se;pe++){const re=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!re)continue;const De={left:J(re).x-10,top:-5};De.left>=-50&&De.left<=S.width+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...De,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`top-col-${pe}`))}else for(let pe=we;pe<=Ee;pe++){const re=ol(pe),xe=t.find(Ke=>Ke.gridPosition&&Ke.gridPosition.row===re);if(!xe)continue;const Le={left:J(xe).x-10,top:-5};Le.left>=-50&&Le.left<=S.width+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:re},`top-row-${pe}`))}return Pe})()}),A.jsx("div",{style:{position:"absolute",top:16,right:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:T.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:Se,minRow:we,maxRow:Ee}=G;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=we;pe<=Ee;pe++){const re=ol(pe),xe=t.find(Ke=>Ke.gridPosition&&Ke.gridPosition.row===re);if(!xe)continue;const Le={left:-5,top:J(xe).y-8};Le.top>=-50&&Le.top<=S.height+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:re},`right-row-${pe}`))}else for(let pe=me;pe<=Se;pe++){const re=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!re)continue;const De={left:-5,top:J(re).y-8};De.top>=-50&&De.top<=S.height+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...De,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`right-col-${pe}`))}return Pe})()}),A.jsx("div",{style:{position:"absolute",bottom:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:T.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:Se,minRow:we,maxRow:Ee}=G;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=me;pe<=Se;pe++){const re=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!re)continue;const De={left:J(re).x-10,top:-5};De.left>=-50&&De.left<=S.width+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...De,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`bottom-col-${pe}`))}else for(let pe=we;pe<=Ee;pe++){const re=ol(pe),xe=t.find(Ke=>Ke.gridPosition&&Ke.gridPosition.row===re);if(!xe)continue;const Le={left:J(xe).x-10,top:-5};Le.left>=-50&&Le.left<=S.width+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:re},`bottom-row-${pe}`))}return Pe})()}),A.jsx("div",{style:{position:"absolute",top:16,left:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:T.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:Se,minRow:we,maxRow:Ee}=G;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=we;pe<=Ee;pe++){const re=ol(pe),xe=t.find(Ke=>Ke.gridPosition&&Ke.gridPosition.row===re);if(!xe)continue;const Le={left:-5,top:J(xe).y-8};Le.top>=-50&&Le.top<=S.height+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:re},`left-row-${pe}`))}else for(let pe=me;pe<=Se;pe++){const re=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!re)continue;const De={left:-5,top:J(re).y-8};De.top>=-50&&De.top<=S.height+50&&Pe.push(A.jsx("div",{style:{position:"absolute",...De,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`left-col-${pe}`))}return Pe})()}),A.jsx("div",{style:{position:"absolute",top:16,left:16,right:16,bottom:16,overflow:"hidden"},children:A.jsx(HB,{ref:_e=>{k.current=_e,_e&&setTimeout(()=>{const me=_e.container();if(me){const Se=me.getBoundingClientRect(),we={width:Math.max(400,Se.width),height:Math.max(300,Se.height)};x(Ee=>Ee.width!==we.width||Ee.height!==we.height?(console.log(" Stage mounted - Canvas size updated:",we),we):Ee)}},50)},width:Math.max(100,S.width),height:Math.max(100,S.height),x:0,y:0,onClick:wt,onWheel:ve,onMouseDown:Be,onMouseMove:V,onMouseUp:Ze,onMouseLeave:nt,style:{cursor:P?"grabbing":"grab"},children:A.jsxs(GB,{children:[(()=>{const{gridSpacing:_e,minRow:me,maxRow:Se,minCol:we,maxCol:Ee}=G;if(!_e)return null;const Pe=(Le,Ke)=>J({position:{x:Le,y:Ke}}),Me=0,pe=Pe((we-1.5)*_e-Me,(me-.5)*_e-Me),re=Pe((Ee+.5)*_e+Me,(me-.5)*_e-Me),xe=Pe((we-1.5)*_e-Me,(Se+.5)*_e+Me),De=Pe((Ee+.5)*_e+Me,(Se+.5)*_e+Me);return A.jsx(A.Fragment,{children:A.jsx(w5,{points:[pe.x,pe.y,re.x,re.y,De.x,De.y,xe.x,xe.y,pe.x,pe.y],stroke:"#555",strokeWidth:2,dash:[5,5],closed:!0,fill:"rgba(40, 40, 40, 0.3)"})})})(),!1,(()=>{Ur.startRenderMeasurement("pin-rendering");const me=Math.max(20,88*T.scale),Se=En.shouldRenderPinDetails(T.scale),we=En.shouldRenderText(T.scale,"pin"),Ee=En.shouldRenderText(T.scale,"signal"),Pe=En.getAdaptiveTextSize(T.scale,12)/12,Me=ie,pe=Ur.endRenderMeasurement("pin-rendering");return console.log(` Smart culling: Rendering ${Me.length}/${t.length} pins (${pe.toFixed(2)}ms)`),Me.map(re=>{const xe=J(re),De=r.has(re.id),Le=L(re),Ke=q(re),xt=T.scale*10*Pe,Dt=Math.max(8,Math.min(20,xt)),Ut=Math.max(6,Math.min(16,T.scale*8*Pe)),Fe=Y(re,ie,r),Xe=K(re,t),Qe=Se||De;return A.jsxs(Xc,{children:[A.jsx(Xn,{x:xe.x-me/2,y:xe.y-me/2,width:me,height:me,fill:Le,stroke:"#000",strokeWidth:1,cornerRadius:4,onClick:qe=>Je(qe,re),onDblClick:qe=>Re(qe,re),style:{cursor:"pointer"}}),Fe&&A.jsx(Xn,{x:xe.x-me/2-2,y:xe.y-me/2-2,width:me+4,height:me+4,fill:"transparent",stroke:Fe,strokeWidth:2,cornerRadius:6,listening:!1}),A.jsx(Kc,{x:xe.x,y:xe.y,radius:Math.max(8,me*.3),fill:Ke,stroke:"#000",strokeWidth:1,listening:!1}),Xe&&!Fe&&me>40&&A.jsx(Kc,{x:xe.x+me*.3,y:xe.y-me*.3,radius:3,fill:"#FF6600",stroke:"#FFF",strokeWidth:1,listening:!1}),Fe&&A.jsx(Kc,{x:xe.x,y:xe.y,radius:Math.max(10,me*.4),fill:"transparent",stroke:Fe,strokeWidth:3,listening:!1,dash:[5,5]}),A.jsx(Xn,{x:xe.x-re.pinNumber.length*Dt/4-2,y:xe.y-Dt/2-2,width:re.pinNumber.length*Dt/2+4,height:Dt+4,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,listening:!1}),A.jsx(oa,{x:xe.x,y:xe.y-Dt/2,text:re.pinNumber,fontSize:Dt,fill:"#FFF",align:"center",onClick:qe=>Je(qe,re),onDblClick:qe=>Re(qe,re),style:{cursor:"pointer"},fontStyle:"bold",offsetX:re.pinNumber.length*Dt/4,listening:!1}),re.pinName&&Qe&&we&&me>50&&A.jsxs(A.Fragment,{children:[A.jsx(Xn,{x:xe.x-(re.pinName.length>14?17:re.pinName.length)*Ut/4-2,y:xe.y+Dt/2+1,width:(re.pinName.length>14?17:re.pinName.length)*Ut/2+4,height:Ut+4,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),A.jsx(oa,{x:xe.x,y:xe.y+Dt/2+3,text:re.pinName.length>14?re.pinName.substring(0,14)+"...":re.pinName,fontSize:Ut,fill:"#E0E0E0",align:"center",onClick:qe=>Je(qe,re),onDblClick:qe=>Re(qe,re),style:{cursor:"pointer"},offsetX:(re.pinName.length>14?17:re.pinName.length)*Ut/4,listening:!1})]}),re.signalName&&re.signalName.trim()!==""&&Ee&&A.jsxs(A.Fragment,{children:[A.jsx(Xn,{x:xe.x-(re.signalName.length>12?15:re.signalName.length)*Ut*.35-6,y:xe.y+Dt/2+3+Ut-1,width:(re.signalName.length>12?15:re.signalName.length)*Ut*.7+12,height:Ut+6,fill:"rgba(255, 215, 0, 0.9)",cornerRadius:3,listening:!1}),A.jsx(oa,{x:xe.x,y:xe.y+Dt/2+3+Ut+2,text:re.signalName.length>12?re.signalName.substring(0,12)+"...":re.signalName,fontSize:Ut,fill:"#000",align:"center",onClick:qe=>Je(qe,re),onDblClick:qe=>Re(qe,re),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(re.signalName.length>12?15:re.signalName.length)*Ut/4,listening:!1})]})]},re.id)})})(),En.shouldRenderDifferentialPairs(T.scale)&&(()=>{Ur.startRenderMeasurement("diff-pair-lines");const _e=[],me=new Set;ie.forEach(we=>{if(!me.has(we.id)&&_r.isDifferentialPin(we)){const Ee=_r.findPairPin(we,t),Pe=Ee&&ie.includes(Ee),Me=r.has(we.id)||Ee&&r.has(Ee.id);if(Ee&&!me.has(Ee.id)&&(Pe||Me)){me.add(we.id),me.add(Ee.id);const pe=J(we),re=J(Ee),xe=Y(we,ie,r),De=Y(Ee,ie,r),Le=xe||De||"#FF6600",Ke=Math.sqrt(Math.pow(re.x-pe.x,2)+Math.pow(re.y-pe.y,2));if(Ke>50&&_e.push(A.jsx(w5,{points:[pe.x,pe.y,re.x,re.y],stroke:Le,strokeWidth:2,opacity:.6,dash:[8,4],listening:!1},`diff-pair-${we.id}-${Ee.id}`)),Ke>100&&T.scale>.4){const xt=(pe.x+re.x)/2,Dt=(pe.y+re.y)/2,Fe=_r.getDifferentialPairType(we.pinName)==="positive"?"+/-":"-/+";_e.push(A.jsxs(Xc,{children:[A.jsx(Xn,{x:xt-10,y:Dt-8,width:20,height:16,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),A.jsx(oa,{x:xt,y:Dt-6,text:Fe,fontSize:10,fill:Le,align:"center",offsetX:10,listening:!1})]},`diff-label-${we.id}-${Ee.id}`))}}}});const Se=Ur.endRenderMeasurement("diff-pair-lines");return console.log(` Differential pairs: ${_e.length} lines (${Se.toFixed(2)}ms)`),_e})(),En.shouldRenderAtLOD(Ae,2)&&(()=>{Ur.startRenderMeasurement("bank-boundaries");const _e=new Map;ie.forEach(pe=>{const re=pe.bank||"NA";_e.has(re)||_e.set(re,[]),_e.get(re).push(pe)});const Se=Math.max(20,88*T.scale),we=6,Ee=new Map;Array.from(_e.entries()).forEach(([pe,re])=>{if(pe==="NA"||re.length<2)return;const xe=re.map(Le=>J(Le)),De={minX:Math.min(...xe.map(Le=>Le.x))-Se/2-we,maxX:Math.max(...xe.map(Le=>Le.x))+Se/2+we,minY:Math.min(...xe.map(Le=>Le.y))-Se/2-we,maxY:Math.max(...xe.map(Le=>Le.y))+Se/2+we,bankKey:pe,pins:re};Ee.set(pe,De)});const Pe=Array.from(Ee.entries()).map(([pe,re])=>{const xe=L(re.pins[0]);return A.jsx(Xn,{x:re.minX,y:re.minY,width:re.maxX-re.minX,height:re.maxY-re.minY,fill:`${xe}10`,stroke:"transparent",cornerRadius:6,opacity:.3,listening:!1},`bank-boundary-${pe}`)}),Me=Ur.endRenderMeasurement("bank-boundaries");return console.log(` Bank boundaries: ${Ee.size} boundaries (${Me.toFixed(2)}ms)`),Pe})(),(()=>{const me=Math.max(20,88*T.scale);return t.filter(Se=>r.has(Se.id)).map(Se=>{const we=J(Se);return A.jsx(Xn,{x:we.x-me/2-2,y:we.y-me/2-2,width:me+4,height:me+4,fill:"transparent",stroke:"#FFD700",strokeWidth:3,cornerRadius:4,onClick:Ee=>Je(Ee,Se),onDblClick:Ee=>Re(Ee,Se),style:{cursor:"pointer"}},`highlight-${Se.id}`)})})(),A.jsxs(Xc,{x:10,y:30,children:[(()=>{const _e="Bank Groups";return A.jsxs(A.Fragment,{children:[A.jsx(Xn,{x:24,y:-2,width:_e.length*6+8,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2,onClick:()=>{console.log(" Bank Groups header clicked - showing all banks!"),g()},onMouseEnter:me=>{var we;const Se=me.target;Se.fill("rgba(0, 0, 0, 0.9)"),(we=Se.getLayer())==null||we.batchDraw()},onMouseLeave:me=>{var we;const Se=me.target;Se.fill("rgba(0, 0, 0, 0.85)"),(we=Se.getLayer())==null||we.batchDraw()},style:{cursor:"pointer"}}),A.jsx(oa,{x:27,y:0,text:_e,fontSize:12,fill:"#4AE24A",onClick:()=>{console.log(" Bank Groups text clicked - showing all banks!"),g()},onMouseEnter:me=>{var we;const Se=me.target;Se.fill("#fff"),(we=Se.getLayer())==null||we.batchDraw()},onMouseLeave:me=>{var we;const Se=me.target;Se.fill("#4AE24A"),(we=Se.getLayer())==null||we.batchDraw()},style:{cursor:"pointer"}})]})})(),(()=>[...new Set(_.map(me=>me.bank).filter(Boolean))].sort((me,Se)=>{const we=parseInt(me),Ee=parseInt(Se);return we-Ee}).map((me,Se)=>{const we=m.size===0||m.has(me);return A.jsxs(Xc,{y:20+Se*18,x:27,children:[A.jsx(Xn,{x:8,y:-8,width:`Bank ${me}`.length*6+20,height:16,fill:"rgba(0, 0, 0, 0)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:1,cornerRadius:2,onClick:()=>{console.log(` BANK ${me} CLICKED!`),console.log("Before: visibleBanks =",Array.from(m)),console.log(`Before: Bank ${me} is visible =`,m.has(me)),console.log("Before: Total pins received =",t.length),v(me)},onMouseEnter:Ee=>{var Me;const Pe=Ee.target;Pe.stroke("rgba(255, 255, 255, 0.3)"),(Me=Pe.getLayer())==null||Me.batchDraw()},onMouseLeave:Ee=>{var Me;const Pe=Ee.target;Pe.stroke("rgba(255, 255, 255, 0.1)"),(Me=Pe.getLayer())==null||Me.batchDraw()},style:{cursor:"pointer"}}),A.jsx(Kc,{x:12,y:2,radius:4,fill:we?go(me):"#444",stroke:we?"#000":"#666",strokeWidth:1,listening:!1}),A.jsx(Xn,{x:23,y:-8,width:`Bank ${me}`.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),A.jsx(oa,{x:25,y:-6,text:`Bank ${me}`,fontSize:10,fill:we?"#ccc":"#666",listening:!1}),A.jsx(oa,{x:10,y:-6,text:we?"":"",fontSize:8,listening:!1})]},me)}))(),A.jsx(Xn,{x:117,y:-2,width:130,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2}),A.jsx(oa,{x:120,y:0,text:"Pin Types (Circle):",fontSize:12,fill:"#ccc"}),(()=>{const _e=[...new Set(t.map(Se=>Se.pinType).filter(Boolean))].sort(),me={IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999",MIO:"#32CD32",DDR:"#8A2BE2"};return _e.map((Se,we)=>A.jsxs(Xc,{y:20+we*18,x:120,children:[A.jsx(Kc,{x:12,y:2,radius:4,fill:me[Se]||"#666666",stroke:"#000",strokeWidth:1}),A.jsx(oa,{x:25,y:-6,text:Se,fontSize:10,fill:"#999"}),A.jsx(Xn,{x:23,y:-8,width:Se.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2}),A.jsx(oa,{x:25,y:-6,text:Se,fontSize:10,fill:"#ccc"})]},Se))})()]})]})})})]})]})};class Kn{static createSaveData(t){var n,i,a,s,o,u;const r=new Date().toISOString();return{metadata:{version:this.SAVE_VERSION,created:r,modified:r,appVersion:"1.0.0",description:`FPGA Pin Planning Project - ${((n=t.package)==null?void 0:n.device)||"Unknown Device"}`,author:"FPGA Pin Planner User"},package:{device:((i=t.package)==null?void 0:i.device)||"",packageType:((a=t.package)==null?void 0:a.packageType)||""},pins:t.pins.map(f=>({id:f.id,pinNumber:f.pinNumber,pinName:f.pinName,assignedSignalName:f.signalName,comment:f.comment,bank:f.bank,pinType:f.pinType,gridPosition:f.gridPosition,differentialPair:f.differentialPair})),viewSettings:{zoom:t.viewConfig.zoom,rotation:t.viewConfig.rotation,isTopView:t.viewConfig.isTopView,viewport:t.viewConfig.viewport||{x:0,y:0,scale:1},selectedPins:Array.from(t.selectedPins),filters:t.filters},projectSettings:{listViewActiveTab:((s=t.listView)==null?void 0:s.activeTab)||"overview",sidebarWidth:((o=t.ui)==null?void 0:o.sidebarWidth)||300,showDifferentialPairs:((u=t.ui)==null?void 0:u.showDifferentialPairs)||!1,customSettings:t.projectSettings||{}},history:t.history||{currentIndex:0,actions:[]}}}static async saveToFile(t,r){const n=t.package.device.replace(/[^a-zA-Z0-9]/g,"_"),i=new Date().toISOString().split("T")[0],a=`${n}_project_${i}${this.FILE_EXTENSION}`,s=r||a,o=JSON.stringify(t,null,2),u=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=s,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}static async loadFromFile(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=JSON.parse(o);if(!this.isCompatibleVersion(u.metadata.version))throw new Error(`Incompatible save file version: ${u.metadata.version}`);if(!u.package||!u.pins||!Array.isArray(u.pins))throw new Error("Invalid save file format: missing required fields");r(u)}catch(o){n(new Error(`Failed to parse save file: ${o}`))}},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static restoreProject(t){const r={id:`package-${Date.now()}`,name:t.package.device,device:t.package.device,packageType:t.package.packageType,dimensions:{rows:Math.max(...t.pins.map(i=>{var a;return Is(((a=i.gridPosition)==null?void 0:a.row)||"A")+1})),cols:Math.max(...t.pins.map(i=>{var a;return((a=i.gridPosition)==null?void 0:a.col)||1}))},totalPins:t.pins.length,pins:t.pins.map(i=>({id:i.id,pinNumber:i.pinNumber,pinName:i.pinName,signalName:i.assignedSignalName||i.originalSignalName||"",direction:"InOut",pinType:i.pinType,voltage:"3.3V",packagePin:i.pinNumber,position:this.gridToPosition(i.gridPosition||{row:"A",col:1}),gridPosition:i.gridPosition||{row:"A",col:1},isAssigned:!!i.assignedSignalName,bank:i.bank||"NA",comment:i.comment||"",differentialPair:i.differentialPair}))};return{id:`project-${Date.now()}`,name:t.metadata.description||`Restored Project ${new Date().toLocaleDateString()}`,description:t.metadata.description||"",created:new Date(t.metadata.created),modified:new Date(t.metadata.modified),projectInfo:{device:t.package.device,package:t.package.packageType,speedGrade:t.package.speedGrade||"-1",temperature:"C"},packageData:r,pinAssignments:r.pins,viewConfig:{rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,zoom:t.viewSettings.zoom,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},filters:{pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"pinNumber",sortOrder:"asc"}}}static restoreAppState(t,r){return{pins:r.pins.map(i=>{const a=t.pins.find(s=>s.id===i.id||s.pinNumber===i.pinNumber);return a?{...i,signalName:a.assignedSignalName||i.signalName,comment:a.comment||i.comment,differentialPair:a.differentialPair||i.differentialPair}:i}),selectedPins:new Set(t.viewSettings.selectedPins),viewConfig:{zoom:t.viewSettings.zoom,rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,viewport:t.viewSettings.viewport},filters:t.viewSettings.filters,listView:{activeTab:t.projectSettings.listViewActiveTab||"overview"},ui:{sidebarWidth:t.projectSettings.sidebarWidth,showDifferentialPairs:t.projectSettings.showDifferentialPairs},history:t.history,projectSettings:t.projectSettings.customSettings}}static isCompatibleVersion(t){const[r]=t.split(".").map(Number),[n]=this.SAVE_VERSION.split(".").map(Number);return r<=n}static quickSave(t){try{const r=this.createSaveData(t),n=this.compressData(r);localStorage.setItem(this.QUICKSAVE_KEY,n),localStorage.setItem(this.QUICKSAVE_TIMESTAMP_KEY,new Date().toISOString()),console.log(" Quick save completed")}catch(r){throw console.error("Failed to quick save:",r),new Error(`Quick save failed: ${r}`)}}static quickLoad(){try{const t=localStorage.getItem(this.QUICKSAVE_KEY);return t?this.decompressData(t):null}catch(t){return console.error("Failed to load quicksave:",t),null}}static getQuickSaveInfo(){const t=localStorage.getItem(this.QUICKSAVE_TIMESTAMP_KEY);return{exists:localStorage.getItem(this.QUICKSAVE_KEY)!==null,timestamp:t||void 0}}static clearQuickSave(){localStorage.removeItem(this.QUICKSAVE_KEY),localStorage.removeItem(this.QUICKSAVE_TIMESTAMP_KEY)}static compressData(t){const r={metadata:{version:t.metadata.version,created:t.metadata.created},package:t.package,pins:t.pins.map(n=>({id:n.id,pinNumber:n.pinNumber,assignedSignalName:n.assignedSignalName,comment:n.comment,...n.differentialPair&&{differentialPair:n.differentialPair},...n.custom&&Object.keys(n.custom).length>0&&{custom:n.custom}})),viewSettings:t.viewSettings,projectSettings:t.projectSettings};return JSON.stringify(r)}static decompressData(t){const r=JSON.parse(t);return{metadata:{version:r.metadata.version,created:r.metadata.created,modified:new Date().toISOString(),appVersion:"1.0.0",description:"Quick Save Data"},package:r.package,pins:r.pins,viewSettings:r.viewSettings,projectSettings:r.projectSettings||{},constraints:{},history:{currentIndex:0,actions:[]}}}static gridToPosition(t){const r=Is(t.row),i=88,a=(t.col-1)*i,s=r*i;return{x:Math.round(a),y:Math.round(s)}}}Kn.SAVE_VERSION="1.0.0";Kn.FILE_EXTENSION=".fpgaproj";Kn.QUICKSAVE_KEY="fpga-planner-quicksave";Kn.QUICKSAVE_TIMESTAMP_KEY="fpga-planner-quicksave-timestamp";const tU=()=>{const e=ke.useRef(null),[t,r]=ke.useState(!1),[n,i]=ke.useState(""),{package:a,pins:s,selectedPins:o,viewConfig:u,loadProject:f}=$i(),d=()=>({package:a,pins:s,selectedPins:o,viewConfig:u,listView:{activeTab:"overview"},ui:{sidebarWidth:300,showDifferentialPairs:!1},filters:{},history:{currentIndex:0,actions:[]},projectSettings:{}}),p=(S,x=3e3)=>{i(S),setTimeout(()=>i(""),x)},m=()=>typeof window.vscode<"u",v=async()=>{console.log(" handleSave called");try{if(r(!0),!a||s.length===0)throw new Error("No project data to save");const S=d(),x=Kn.createSaveData(S);if(console.log(" Save data created:",x),m()){console.log(" VS Code environment detected");try{const C=window.vscode,N=x.package.device.replace(/[^a-zA-Z0-9]/g,"_"),T=new Date().toISOString().split("T")[0],F=`${N}_project_${T}.fpgaproj`;console.log(" Default filename:",F);const P=await new Promise((I,D)=>{const U=setTimeout(()=>{window.removeEventListener("message",b),console.log(" Save dialog timeout"),D(new Error("Save dialog timeout"))},3e4),b=Q=>{console.log(" Received save dialog message:",Q.data),Q.data.command==="saveDialogResult"&&(clearTimeout(U),window.removeEventListener("message",b),console.log(" Save dialog result received:",Q.data.result),I(Q.data.result))};window.addEventListener("message",b),console.log(" Sending showSaveDialog message"),C.postMessage({command:"showSaveDialog",options:{saveLabel:"Save FPGA Project",filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}})});if(P){console.log(" Save location selected:",P);let I;if(typeof P=="string")I=P;else if(P&&typeof P=="object"){const b=P;I=b.fsPath||b.path,!I&&typeof P.toString=="function"&&(I=P.toString())}if(console.log(" Extracted file path:",I),!I)throw new Error("Failed to extract file path from URI");const D=JSON.stringify(x,null,2);console.log(" Sending file save request");const U=await new Promise(b=>{const Q=he=>{console.log(" Received save result:",he.data),he.data.command==="saveFileResult"&&(window.removeEventListener("message",Q),b(he.data.success))};window.addEventListener("message",Q),C.postMessage({command:"saveFile",filePath:I,content:D,filename:F})});if(console.log(" Save result:",U),U)p(" Project saved successfully!");else throw new Error("File save operation failed")}else console.log(" No save location selected")}catch(C){console.error("VS Code save failed:",C),await Kn.saveToFile(x),p(" Project saved successfully!")}}else await Kn.saveToFile(x),p(" Project saved successfully!")}catch(S){console.error("Save failed:",S),p(` Save failed: ${S}`,5e3)}finally{r(!1)}},g=async S=>{var C,N;const x=(C=S.target.files)==null?void 0:C[0];if(x)try{r(!0);const T=await Kn.loadFromFile(x),F=Kn.restoreProject(T);console.log("Loading project:",F.name),console.log("Package device:",(N=F.packageData)==null?void 0:N.device),console.log("Pin assignments count:",F.pinAssignments.length),f(F),console.log(" Project loaded successfully"),p(` Project loaded: ${T.metadata.description}`),S.target.value=""}catch(T){console.error("Load failed:",T),p(` Load failed: ${T}`,5e3)}finally{r(!1)}},_=()=>{try{if(!a||s.length===0)throw new Error("No project data to save");const S=d();Kn.quickSave(S),p(" Quick save completed")}catch(S){console.error("Quick save failed:",S),p(` Quick save failed: ${S}`,5e3)}},k=async()=>{try{const S=Kn.quickLoad();if(!S){p(" No quick save found");return}const x=Kn.restoreProject(S);f(x),p(" Quick save loaded")}catch(S){console.error("Quick load failed:",S),p(` Quick load failed: ${S}`,5e3)}},E=Kn.getQuickSaveInfo();return Sr.useEffect(()=>{const S=x=>{var C;if(x.ctrlKey||x.metaKey)switch(x.key.toLowerCase()){case"s":x.preventDefault(),a&&s.length>0&&_();break;case"l":x.preventDefault(),E.exists?k():(C=e.current)==null||C.click();break}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[a,s.length,E.exists]),A.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",position:"relative"},children:[A.jsx("button",{onClick:v,disabled:t||!a||s.length===0,title:"Save Project ()",style:{padding:"6px 8px",backgroundColor:"#00a8ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t||!a||s.length===0?.5:1},children:""}),A.jsx("button",{onClick:()=>{var S;return(S=e.current)==null?void 0:S.click()},disabled:t,title:"Load Project ()",style:{padding:"6px 8px",backgroundColor:"#ffa500",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t?.5:1},children:""}),A.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:g,style:{display:"none"}}),A.jsx("button",{onClick:_,disabled:t||!a||s.length===0,title:"Quick Save (Ctrl+S)",style:{padding:"6px 8px",backgroundColor:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",opacity:t||!a||s.length===0?.5:1},children:""}),n&&A.jsx("div",{style:{position:"absolute",top:"40px",right:"0",padding:"8px 12px",backgroundColor:n.includes("")?"#dc3545":"#28a745",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:n})]})},rU=({className:e=""})=>{const{canUndo:t,canRedo:r,currentActionDescription:n,nextRedoActionDescription:i,undo:a,redo:s}=$i(),o=u=>({padding:"6px",backgroundColor:u?"#333":"#222",border:"1px solid #555",borderRadius:"4px",color:u?"#ccc":"#666",cursor:u?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",transition:"background-color 0.2s"});return A.jsxs("div",{className:`flex flex-row items-center ${e}`,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[A.jsx("button",{onClick:a,disabled:!t,title:`Undo${n?`: ${n}`:""} (Ctrl+Z)`,style:{...o(t),borderRadius:"4px 0 0 4px",borderRight:"none"},onMouseEnter:u=>{t&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{t&&(u.currentTarget.style.backgroundColor="#333")},children:A.jsx(nU,{className:"w-3 h-3"})}),A.jsx("button",{onClick:s,disabled:!r,title:`Redo${i?`: ${i}`:""} (Ctrl+Y)`,style:{...o(r),borderRadius:"0 4px 4px 0"},onMouseEnter:u=>{r&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{r&&(u.currentTarget.style.backgroundColor="#333")},children:A.jsx(iU,{className:"w-3 h-3"})})]})},nU=({className:e})=>A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[A.jsx("path",{d:"M3 7v6h6"}),A.jsx("path",{d:"m21 17a9 9 0 00-9-9 9 9 0 00-6 2.3l-3 3"})]}),iU=({className:e})=>A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[A.jsx("path",{d:"M21 7v6h-6"}),A.jsx("path",{d:"m3 17a9 9 0 019-9 9 9 0 016 2.3l3 3"})]}),aU=({isOpen:e,onClose:t})=>{if(!e)return null;const r=[{key:"Ctrl+Z",description:"Undo"},{key:"Ctrl+Y",description:"Redo"},{key:"Ctrl+O",description:"Open CSV file"},{key:"Ctrl+S",description:"Save project"},{key:"Ctrl+E",description:"Export XDC file"},{key:"Ctrl+F",description:"Focus search field"},{key:"Click",description:"Select pin"},{key:"Ctrl+Click",description:"Toggle pin selection"},{key:"Shift+Click",description:"Range select pins"},{key:"Ctrl+A",description:"Select all pins"},{key:"Ctrl+D",description:"Deselect all"},{key:"Space",description:"Rotate view 90 degrees"},{key:"F",description:"Toggle top/bottom view"},{key:"R",description:"Reset zoom and pan"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"Escape",description:"Deselect all"},{key:"Delete",description:"Unassign selected pins"}];return A.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:A.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-hidden flex flex-col",children:[A.jsxs("div",{className:"flex items-center justify-between mb-4",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Keyboard Shortcuts"}),A.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-xl",children:""})]}),A.jsx("div",{className:"flex-1 overflow-y-auto",children:A.jsx("div",{className:"space-y-1",children:r.map((n,i)=>A.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-50",children:[A.jsx("span",{className:"text-sm text-gray-600",children:n.description}),A.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-gray-100 rounded border",children:n.key})]},i))})}),A.jsx("div",{className:"mt-4 pt-4 border-t",children:A.jsx("button",{onClick:t,className:"w-full py-2 px-4 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Close"})})]})})},sU=({validationResult:e,onIssueClick:t,onPinHighlight:r,className:n=""})=>{const[i,a]=ke.useState(!0),[s,o]=ke.useState("all"),[u,f]=ke.useState("all"),d=g=>{switch(g){case"pin_conflict":return"Pin Conflict";case"differential_pair":return"Differential Pair";case"bank_constraint":return"Bank Constraint";case"clock_constraint":return"Clock Constraint";default:return g}},p=(e==null?void 0:e.issues.filter(g=>{const _=s==="all"||g.severity===s,k=u==="all"||g.type===u;return _&&k}))||[],m=g=>{t==null||t(g),r==null||r(g.affectedPins)},v=g=>{switch(g){case"error":return"";case"warning":return"";case"info":return""}};return e?A.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[A.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),A.jsx("button",{onClick:()=>a(!i),className:"text-gray-500 hover:text-gray-700",children:i?"":""})]})}),A.jsx("div",{className:"flex-1 overflow-y-auto right-sidebar-scroll",children:i&&A.jsxs("div",{className:"p-4",children:[A.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.summary.errorCount}),A.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]}),A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.summary.warningCount}),A.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.summary.infoCount}),A.jsx("div",{className:"text-xs text-gray-500",children:"Info"})]})]}),A.jsxs("div",{className:"space-y-2",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Severity"}),A.jsxs("select",{value:s,onChange:g=>o(g.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsxs("option",{value:"all",children:["All Issues (",e.issues.length,")"]}),A.jsxs("option",{value:"error",children:["Errors (",e.summary.errorCount,")"]}),A.jsxs("option",{value:"warning",children:["Warnings (",e.summary.warningCount,")"]}),A.jsxs("option",{value:"info",children:["Info (",e.summary.infoCount,")"]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Type"}),A.jsxs("select",{value:u,onChange:g=>f(g.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"all",children:"All Types"}),Array.from(new Set(e.issues.map(g=>g.type))).map(g=>A.jsx("option",{value:g,children:d(g)},g))]})]})]}),A.jsx("div",{className:"mt-4 space-y-2 max-h-64 overflow-y-auto right-sidebar-scroll",children:p.map((g,_)=>A.jsxs("div",{onClick:()=>m(g),className:`p-3 rounded-lg cursor-pointer transition-colors ${g.severity==="error"?"bg-red-50 border border-red-200 hover:bg-red-100":g.severity==="warning"?"bg-yellow-50 border border-yellow-200 hover:bg-yellow-100":"bg-blue-50 border border-blue-200 hover:bg-blue-100"}`,children:[A.jsxs("div",{className:"flex items-start justify-between mb-1",children:[A.jsx("span",{className:"text-sm",children:v(g.severity)}),A.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded",children:d(g.type)})]}),A.jsx("p",{className:"text-xs mb-2 line-clamp-2",children:g.description}),g.affectedPins.length>0&&A.jsxs("div",{className:"text-xs mb-2",children:[A.jsx("span",{className:"font-medium",children:"Affected pins: "}),A.jsxs("span",{className:"font-mono",children:[g.affectedPins.slice(0,3).join(", "),g.affectedPins.length>3&&` +${g.affectedPins.length-3} more`]})]}),g.suggestion&&A.jsxs("div",{className:"text-xs mt-2 p-2 bg-white bg-opacity-50 rounded",children:[A.jsx("span",{className:"font-medium",children:" Suggestion: "}),g.suggestion]})]},_))})]})}),A.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-3 bg-white",children:A.jsx("div",{className:"text-xs text-gray-500 text-center",children:(e==null?void 0:e.lastChecked)&&A.jsxs(A.Fragment,{children:["Last checked: ",new Date(e.lastChecked).toLocaleTimeString()]})})})]}):A.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[A.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No validation data available"})]}),A.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"text-4xl mb-2",children:""}),A.jsx("div",{className:"text-sm",children:"Run validation to see results"})]})})]})},oU=({validationResult:e,className:t=""})=>{if(!e)return A.jsx("div",{className:`inline-flex items-center text-gray-400 ${t}`,children:A.jsx("span",{className:"text-sm",children:""})});const{summary:r}=e;return r.errorCount>0?A.jsxs("div",{className:`inline-flex items-center text-red-600 ${t}`,children:[A.jsx("span",{className:"text-sm",children:""}),A.jsx("span",{className:"ml-1 text-xs font-bold",children:r.errorCount})]}):r.warningCount>0?A.jsxs("div",{className:`inline-flex items-center text-yellow-600 ${t}`,children:[A.jsx("span",{className:"text-sm",children:""}),A.jsx("span",{className:"ml-1 text-xs font-bold",children:r.warningCount})]}):A.jsx("div",{className:`inline-flex items-center text-green-600 ${t}`,children:A.jsx("span",{className:"text-sm",children:""})})};class Qc{static assignArrayPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(r.startIndex>r.endIndex)throw new Error("Start index must be less than or equal to end index");const i=[];for(let s=r.startIndex;s<=r.endIndex;s+=r.step){const o=r.padding>0?s.toString().padStart(r.padding,"0"):s.toString(),u=r.indexFormat.replace("{i}",o).replace("{index}",o);i.push(r.baseName+u)}const a=Math.min(t.length,i.length);for(let s=0;s<a;s++){const o=t[s],u=i[s];if(o.pinType&&["POWER","GROUND","NC"].includes(o.pinType)){n.skippedPins++,n.errors.push(`Skipped ${o.pinNumber}: Cannot assign to ${o.pinType} pin`);continue}n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:u}),n.processedPins++}}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static assignDifferentialPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(!r.positiveFormat||!r.negativeFormat)throw new Error("Both positive and negative formats are required");t.length%2!==0&&n.errors.push(`Warning: Odd number of pins (${t.length}). Last pin will be skipped.`);const i=Math.floor(t.length/2);for(let a=0;a<i;a++){const s=t[a*2],o=t[a*2+1],u=s.pinType&&["POWER","GROUND","NC"].includes(s.pinType),f=o.pinType&&["POWER","GROUND","NC"].includes(o.pinType);if(u||f){n.skippedPins+=2,n.errors.push(`Skipped pair ${s.pinNumber}/${o.pinNumber}: Cannot assign to ${s.pinType}/${o.pinType} pins`);continue}let d=r.baseName;if(r.indexFormat&&r.startIndex!==void 0){const v=(r.startIndex||0)+a,g=r.padding&&r.padding>0?v.toString().padStart(r.padding,"0"):v.toString();d=r.indexFormat.replace("{i}",g).replace("{index}",g),d=r.baseName+d}const p=d+r.positiveFormat,m=d+r.negativeFormat;n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:s.signalName,newSignal:p}),n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:m}),n.processedPins+=2}t.length%2!==0&&n.skippedPins++}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static filterPinsByCriteria(t,r){return t.filter(n=>{if(r.pinTypes&&r.pinTypes.length>0&&(!n.pinType||!r.pinTypes.includes(n.pinType))||r.banks&&r.banks.length>0&&(!n.bank||!r.banks.includes(n.bank))||r.voltages&&r.voltages.length>0&&(!n.voltage||!r.voltages.includes(n.voltage)))return!1;if(r.assignmentStatus){const i=n.signalName&&n.signalName.trim()!=="";if(r.assignmentStatus==="assigned"&&!i||r.assignmentStatus==="unassigned"&&i)return!1}if(r.pinNumberPattern)try{if(!new RegExp(r.pinNumberPattern).test(n.pinNumber))return!1}catch{}if(r.gridRange&&n.gridPosition){const{rowStart:i,rowEnd:a,colStart:s,colEnd:o}=r.gridRange;if(i&&n.gridPosition.row<i||a&&n.gridPosition.row>a||s&&n.gridPosition.col<s||o&&n.gridPosition.col>o)return!1}return!0})}static clearSignals(t){const r={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{for(const n of t)n.signalName&&n.signalName.trim()!==""?(r.assignments.push({pinId:n.id,pinNumber:n.pinNumber,oldSignal:n.signalName,newSignal:""}),r.processedPins++):r.skippedPins++}catch(n){r.success=!1,r.errors.push(n instanceof Error?n.message:"Unknown error occurred")}return r}static validateBatchOperation(t,r){const n=[];if(t.length===0)return n.push("No pins selected for batch operation"),n;t.length>1e3&&n.push(`Warning: Large dataset (${t.length} pins). Operation may take some time.`);const i=new Set(t.map(a=>a.pinType).filter(Boolean));return i.size>1&&(i.has("POWER")||i.has("GROUND"))&&n.push("Warning: Selection includes power/ground pins which cannot be assigned signals"),r==="differential"&&(t.length<2&&n.push("At least 2 pins required for differential pair assignment"),new Set(t.map(s=>s.bank).filter(Boolean)).size>1&&n.push("Warning: Differential pairs should typically be in the same bank")),n}static previewBatchOperation(t,r,n){try{let i;return n==="array"?i=this.assignArrayPattern(t,r):i=this.assignDifferentialPattern(t,r),i.assignments.map(a=>({pinNumber:a.pinNumber,currentSignal:a.oldSignal||"",newSignal:a.newSignal}))}catch{return[]}}static setVoltageAndIO(t,r){var i,a;const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.voltage&&!r.ioStandard)throw new Error("At least voltage or I/O standard must be specified");r.voltage&&!dx.includes(r.voltage)&&n.errors.push(`Invalid voltage: ${r.voltage}`),r.ioStandard&&!hx.includes(r.ioStandard)&&r.ioStandard!=="AUTO"&&n.errors.push(`Invalid I/O standard: ${r.ioStandard}`);for(const s of t){if(!["IO","CLOCK"].includes(s.pinType)&&r.voltage){n.skippedPins++;continue}let o=s.voltage,u=((i=s.attributes)==null?void 0:i.IO_Standard)||s.ioType||"AUTO";if(r.voltage&&(o=r.voltage),r.ioStandard)if(r.ioStandard==="AUTO"||r.autoDetectIO)u=Ql(o||"3.3V");else{if(o&&!UD(o,r.ioStandard)){n.errors.push(`I/O standard ${r.ioStandard} is not compatible with voltage ${o} for pin ${s.pinNumber}`),n.skippedPins++;continue}u=r.ioStandard}else r.autoDetectIO&&o&&(u=Ql(o));n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:`${s.voltage||"Unknown"}V / ${((a=s.attributes)==null?void 0:a.IO_Standard)||s.ioType||"Unknown"}`,newSignal:`${o}V / ${u}`}),n.processedPins++}n.processedPins===0&&n.skippedPins>0&&(n.errors.push("No pins were processed. All pins were skipped."),n.success=!1)}catch(s){n.success=!1,n.errors.push(s instanceof Error?s.message:"Unknown error occurred")}return n}static setPinDirections(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!["Input","Output","InOut","Clock","Reset"].includes(r))throw new Error(`Invalid direction: ${r}`);for(const a of t){if(!["IO","CLOCK"].includes(a.pinType)){n.skippedPins++;continue}const s=a.direction||"Unknown";n.assignments.push({pinId:a.id,pinNumber:a.pinNumber,oldSignal:`Direction: ${s}`,newSignal:`Direction: ${r}`}),n.processedPins++}n.processedPins===0&&(n.errors.push("No I/O pins found to update"),n.success=!1)}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}}const lU=({isVisible:e})=>{const{pins:t,selectedPins:r,assignSignal:n}=$i(),[i,a]=ke.useState("array"),[s,o]=ke.useState("manual"),[u,f]=ke.useState(!1),[d,p]=ke.useState({baseName:"DATA",startIndex:0,endIndex:31,indexFormat:"[{i}]",padding:0,step:1}),[m,v]=ke.useState({voltage:"3.3V",ioStandard:"AUTO",autoDetectIO:!0,driveStrength:12,slewRate:"FAST"}),[g,_]=ke.useState("Input"),[k,E]=ke.useState({pinTypes:["IO"],assignmentStatus:"unassigned"}),[S,x]=ke.useState(null),C=ke.useMemo(()=>s==="manual"?t.filter(P=>r.has(P.id)):Qc.filterPinsByCriteria(t,k),[t,r,s,k]),N=ke.useMemo(()=>i==="clear"?[]:i==="voltage-io"||i==="direction"?C.length===0?["No pins selected"]:[]:C.length===0?["No pins selected"]:[],[C,i]),T=()=>{let P;switch(i){case"array":P=Qc.assignArrayPattern(C,d);break;case"voltage-io":P=Qc.setVoltageAndIO(C,m);break;case"direction":P=Qc.setPinDirections(C,g);break;case"clear":P=Qc.clearSignals(C);break;default:return}const I={...P,errors:P.errors.filter(D=>!D.includes("Need")&&!D.includes("pins, got")&&!D.includes("Not enough pins")&&!D.includes("pins selected"))};x(I),f(!0)},F=()=>{if(!S)return;const P=`Batch ${i} operation on ${S.processedPins} pins`,I=S.assignments.map(D=>({pinId:D.pinId,oldSignal:D.oldSignal||"",newSignal:D.newSignal}));Cr.recordAction("batch_operation",I,P),S.assignments.forEach(D=>{if(i==="voltage-io"){const{updatePin:U}=$i.getState();U(D.pinId,{voltage:m.voltage,attributes:{IO_Standard:m.ioStandard==="AUTO"?Ql(m.voltage||"3.3V"):m.ioStandard||"LVCMOS33"},ioType:m.ioStandard==="AUTO"?Ql(m.voltage||"3.3V"):m.ioStandard||"LVCMOS33"})}else if(i==="direction"){const{updatePin:U}=$i.getState();U(D.pinId,{direction:g})}else n(D.pinId,D.newSignal)}),f(!1),x(null)};return e?A.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[A.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Batch Operations"}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Assign patterns to multiple pins efficiently"})]}),A.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),A.jsxs("div",{className:"space-y-2",children:[A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"operationType",value:"array",checked:i==="array",onChange:P=>a(P.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:"Array Pattern (DATA[0], DATA[1], ...)"})]}),A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"operationType",value:"voltage-io",checked:i==="voltage-io",onChange:P=>a(P.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:"Voltage & I/O Standards"})]}),A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"operationType",value:"direction",checked:i==="direction",onChange:P=>a(P.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:"Pin Directions"})]}),A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"operationType",value:"clear",checked:i==="clear",onChange:P=>a(P.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:"Clear Signals"})]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Selection"}),A.jsxs("div",{className:"space-y-2",children:[A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"selectionMode",value:"manual",checked:s==="manual",onChange:P=>o(P.target.value),className:"mr-2"}),A.jsxs("span",{className:"text-sm",children:["Use Selected Pins (",r.size,")"]})]}),A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"selectionMode",value:"criteria",checked:s==="criteria",onChange:P=>o(P.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:"Auto-select by Criteria"})]})]})]}),s==="criteria"&&A.jsxs("div",{className:"space-y-4 p-3 bg-blue-50 rounded-lg",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Types"}),A.jsx("div",{className:"space-x-4",children:["IO","POWER","GROUND","CLOCK"].map(P=>{var I;return A.jsxs("label",{className:"inline-flex items-center",children:[A.jsx("input",{type:"checkbox",checked:(I=k.pinTypes)==null?void 0:I.includes(P),onChange:D=>{D.target.checked?E(U=>({...U,pinTypes:[...U.pinTypes||[],P]})):E(U=>{var b;return{...U,pinTypes:((b=U.pinTypes)==null?void 0:b.filter(Q=>Q!==P))||[]}})},className:"mr-1"}),A.jsx("span",{className:"text-xs",children:P})]},P)})})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Status"}),A.jsxs("select",{value:k.assignmentStatus,onChange:P=>E(I=>({...I,assignmentStatus:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"any",children:"Any"}),A.jsx("option",{value:"assigned",children:"Assigned"}),A.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),A.jsxs("div",{className:"text-xs text-gray-600",children:["Matches ",C.length," pins"]})]}),i==="array"&&A.jsxs("div",{className:"space-y-3 p-3 bg-green-50 rounded-lg",children:[A.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Array Pattern Configuration"}),A.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Base Name"}),A.jsx("input",{type:"text",value:d.baseName,onChange:P=>p(I=>({...I,baseName:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"DATA"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Index Format"}),A.jsx("input",{type:"text",value:d.indexFormat,onChange:P=>p(I=>({...I,indexFormat:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"[{i}]"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Index"}),A.jsx("input",{type:"number",value:d.startIndex,onChange:P=>p(I=>({...I,startIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Index"}),A.jsx("input",{type:"number",value:d.endIndex,onChange:P=>p(I=>({...I,endIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Step"}),A.jsx("input",{type:"number",value:d.step,onChange:P=>p(I=>({...I,step:parseInt(P.target.value)||1})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"1"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Padding"}),A.jsx("input",{type:"number",value:d.padding,onChange:P=>p(I=>({...I,padding:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0"})]})]}),A.jsxs("div",{className:"text-xs text-gray-600",children:["Preview: ",d.baseName,d.indexFormat.replace("{i}",d.startIndex.toString().padStart(d.padding,"0"))]})]}),i==="voltage-io"&&A.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded-lg",children:[A.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Voltage & I/O Standard Configuration"}),A.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voltage Level"}),A.jsxs("select",{value:m.voltage||"",onChange:P=>v(I=>({...I,voltage:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"",children:"Keep current"}),dx.map(P=>A.jsx("option",{value:P,children:P},P))]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"I/O Standard"}),A.jsxs("select",{value:m.ioStandard||"",onChange:P=>v(I=>({...I,ioStandard:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"",children:"Keep current"}),A.jsx("option",{value:"AUTO",children:"AUTO (based on voltage)"}),hx.map(P=>A.jsx("option",{value:P,children:P},P))]})]})]}),A.jsx("div",{className:"flex items-center space-x-4",children:A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"checkbox",checked:m.autoDetectIO||!1,onChange:P=>v(I=>({...I,autoDetectIO:P.target.checked})),className:"mr-2"}),A.jsx("span",{className:"text-xs",children:"Auto-detect I/O standard"})]})}),A.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Drive Strength (mA)"}),A.jsxs("select",{value:m.driveStrength||"",onChange:P=>v(I=>({...I,driveStrength:parseInt(P.target.value)})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"",children:"Keep current"}),A.jsx("option",{value:"2",children:"2 mA"}),A.jsx("option",{value:"4",children:"4 mA"}),A.jsx("option",{value:"6",children:"6 mA"}),A.jsx("option",{value:"8",children:"8 mA"}),A.jsx("option",{value:"12",children:"12 mA"}),A.jsx("option",{value:"16",children:"16 mA"}),A.jsx("option",{value:"20",children:"20 mA"}),A.jsx("option",{value:"24",children:"24 mA"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Slew Rate"}),A.jsxs("select",{value:m.slewRate||"",onChange:P=>v(I=>({...I,slewRate:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[A.jsx("option",{value:"",children:"Keep current"}),A.jsx("option",{value:"SLOW",children:"SLOW"}),A.jsx("option",{value:"FAST",children:"FAST"})]})]})]})]}),i==="direction"&&A.jsxs("div",{className:"space-y-3 p-3 bg-orange-50 rounded-lg",children:[A.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Pin Direction Configuration"}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Direction"}),A.jsx("div",{className:"space-y-2",children:["Input","Output","InOut","Clock","Reset"].map(P=>A.jsxs("label",{className:"flex items-center",children:[A.jsx("input",{type:"radio",name:"direction",value:P,checked:g===P,onChange:I=>_(I.target.value),className:"mr-2"}),A.jsx("span",{className:"text-sm",children:P})]},P))})]})]}),A.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg",children:[A.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Target Summary"}),A.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[A.jsxs("div",{children:["Selected pins: ",C.length]}),A.jsxs("div",{children:["Operation: ",i]}),N.length>0&&A.jsxs("div",{className:"text-red-600",children:[A.jsx("div",{className:"font-medium",children:"Validation Issues:"}),A.jsx("ul",{className:"text-xs mt-1 space-y-1",children:N.map((P,I)=>A.jsxs("li",{children:[" ",P]},I))})]})]})]}),A.jsx("div",{children:A.jsx("button",{onClick:T,disabled:C.length===0||N.length>0,className:"w-full py-3 px-4 bg-blue-500 text-black rounded-lg hover:bg-blue-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-blue-600",children:"Generate Preview"})}),u&&S&&A.jsxs("div",{className:"border rounded-lg bg-white",children:[A.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[A.jsx("h4",{className:"font-medium text-gray-800",children:"Preview Results"}),A.jsx("p",{className:"text-sm text-gray-600 mt-1",children:S.success?`${S.processedPins} pins will be assigned`:"Operation preview failed"})]}),S.errors.length>0&&A.jsxs("div",{className:"p-3 bg-red-50 border-b",children:[A.jsx("h5",{className:"text-sm font-medium text-red-800 mb-1",children:"Errors:"}),A.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:S.errors.map((P,I)=>A.jsxs("li",{children:[" ",P]},I))})]}),S.assignments.length>0&&A.jsxs("div",{className:"p-4",children:[A.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Assignments"}),A.jsx("div",{className:"max-h-48 overflow-y-auto border rounded custom-scrollbar",children:A.jsxs("table",{className:"w-full text-sm",children:[A.jsx("thead",{className:"bg-gray-50 sticky top-0",children:A.jsxs("tr",{children:[A.jsx("th",{className:"px-3 py-2 text-left",children:"Pin"}),A.jsx("th",{className:"px-3 py-2 text-left",children:"Current"}),A.jsx("th",{className:"px-3 py-2 text-left",children:"New"})]})}),A.jsxs("tbody",{children:[S.assignments.slice(0,50).map((P,I)=>A.jsxs("tr",{className:"border-t",children:[A.jsx("td",{className:"px-3 py-2 font-mono",children:P.pinNumber}),A.jsx("td",{className:"px-3 py-2 text-gray-600",children:P.oldSignal||"-"}),A.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:P.newSignal})]},I)),S.assignments.length>50&&A.jsx("tr",{children:A.jsxs("td",{colSpan:3,className:"px-3 py-2 text-center text-gray-500 italic",children:["... and ",S.assignments.length-50," more"]})})]})]})})]})]})]}),u&&S&&A.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:A.jsxs("div",{className:"flex gap-3",children:[A.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),A.jsx("button",{onClick:F,disabled:!S.success||S.processedPins===0,className:"flex-1 py-2 px-4 bg-green-500 text-black rounded-lg hover:bg-green-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-green-600",children:"Execute Operation"})]})})]}):null},Ml=class{static initialize(){this.isInitialized||(document.addEventListener("keydown",this.handleKeyDown),this.isInitialized=!0)}static cleanup(){document.removeEventListener("keydown",this.handleKeyDown),this.shortcuts.clear(),this.isInitialized=!1}static registerShortcut(t,r){this.shortcuts.set(t.toLowerCase(),r)}static unregisterShortcut(t){this.shortcuts.delete(t.toLowerCase())}static getKeyString(t){const r=[];return t.ctrlKey&&r.push("ctrl"),t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),t.metaKey&&r.push("meta"),r.push(t.key.toLowerCase()),r.join("+")}static getAvailableShortcuts(){return[{key:"ctrl+o",description:"Open CSV file"},{key:"ctrl+s",description:"Save project"},{key:"ctrl+e",description:"Export XDC"},{key:"ctrl+f",description:"Focus search"},{key:"ctrl+a",description:"Select all pins"},{key:"ctrl+d",description:"Deselect all"},{key:"r",description:"Reset zoom and pan"},{key:"space",description:"Rotate view 90"},{key:"f",description:"Flip top/bottom view"},{key:"ctrl+z",description:"Undo"},{key:"ctrl+y",description:"Redo"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"escape",description:"Clear selection"},{key:"delete",description:"Clear selected pin assignments"},{key:"ctrl+shift+?",description:"Show keyboard shortcuts"}]}};Ml.shortcuts=new Map;Ml.isInitialized=!1;Ml.handleKeyDown=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return;const t=Ml.getKeyString(e),r=Ml.shortcuts.get(t);r&&(e.preventDefault(),r())};let Mt=Ml;const cU=()=>{const{undo:e,redo:t,updateUndoRedoState:r}=$i();ke.useEffect(()=>{Cr.initialize();const n=()=>{r()};return Cr.addListener(n),Mt.initialize(),Mt.registerShortcut("ctrl+z",()=>{e()}),Mt.registerShortcut("ctrl+y",()=>{t()}),Mt.registerShortcut("ctrl+shift+z",()=>{t()}),r(),()=>{Cr.removeListener(n),Mt.unregisterShortcut("ctrl+z"),Mt.unregisterShortcut("ctrl+y"),Mt.unregisterShortcut("ctrl+shift+z")}},[e,t,r])},uU=()=>{const{clearSelection:e,resetZoom:t,rotatePins:r,flipView:n,setZoom:i,viewConfig:a,pins:s,selectPins:o}=$i();ke.useEffect(()=>(Mt.registerShortcut("escape",()=>{e()}),Mt.registerShortcut("ctrl+a",()=>{o(s.map(u=>u.id))}),Mt.registerShortcut("ctrl+d",()=>{e()}),Mt.registerShortcut("r",()=>{t()}),Mt.registerShortcut("space",()=>{r(90)}),Mt.registerShortcut("f",()=>{n()}),Mt.registerShortcut("+",()=>{const u=Math.min(a.zoom*1.2,5);i(u)}),Mt.registerShortcut("-",()=>{const u=Math.max(a.zoom/1.2,.1);i(u)}),Mt.registerShortcut("0",()=>{i(1)}),Mt.registerShortcut("ctrl+shift+?",()=>{document.dispatchEvent(new CustomEvent("showKeyboardHelp"))}),()=>{Mt.unregisterShortcut("escape"),Mt.unregisterShortcut("ctrl+a"),Mt.unregisterShortcut("ctrl+d"),Mt.unregisterShortcut("r"),Mt.unregisterShortcut("space"),Mt.unregisterShortcut("f"),Mt.unregisterShortcut("+"),Mt.unregisterShortcut("-"),Mt.unregisterShortcut("0"),Mt.unregisterShortcut("ctrl+shift+?")}),[e,t,r,n,i,a.zoom,s,o])},fU=()=>{cU(),uU(),ke.useEffect(()=>()=>{Mt.cleanup()},[])};class pl{static async validateProjectAsync(t,r){return new Promise(n=>{const i=this.validateProject(t,r);n(i)})}static validateProject(t,r){const n=[];n.push(...this.checkPinConflicts(r)),n.push(...this.checkDifferentialPairs(r)),n.push(...this.checkBankConstraints(r));const i=this.calculateSummary(n);return{issues:n,summary:i,lastChecked:Date.now()}}static checkPinConflicts(t){const r=[],n=new Map;return t.forEach(i=>{if(i.signalName&&i.signalName.trim()!==""){const a=i.signalName.trim();n.has(a)||n.set(a,[]),n.get(a).push(i)}}),n.forEach((i,a)=>{i.length>1&&r.push({id:`conflict_${a}_${Date.now()}`,type:"pin_conflict",severity:"error",title:`Duplicate assignment for signal "${a}"`,description:`Signal "${a}" is assigned to ${i.length} pins.`,affectedPins:i.map(s=>s.id),suggestion:"Each signal should be assigned to only one pin.",autoFixable:!1,timestamp:Date.now()})}),r}static checkDifferentialPairs(t){const r=[],n=new Set;return t.forEach(i=>{if(!_r.isDifferentialPin(i))return;const a=_r.getDifferentialPairType(i.pinName)||(i.signalName?_r.getDifferentialPairType(i.signalName):null);if(!a)return;const s=_r.findPairPin(i,t),o=_r.getDifferentialBaseName(i.pinName),u=`${i.id}_${(s==null?void 0:s.id)||"missing"}`;if(!n.has(u))if(n.add(u),!s)r.push({id:`diff_pair_incomplete_${i.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Incomplete differential pair: ${o}`,description:`Pin ${i.pinNumber} (${i.pinName}) has no differential pair partner.`,affectedPins:[i.id],suggestion:`Find and assign the ${a==="positive"?"negative":"positive"} side pin in the same bank.`,autoFixable:!1,timestamp:Date.now()});else{i.bank!==s.bank&&r.push({id:`diff_pair_bank_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"error",title:`Differential pair bank mismatch: ${o}`,description:`Differential pair pins are in different banks. Pin ${i.pinNumber} (Bank ${i.bank}) and Pin ${s.pinNumber} (Bank ${s.bank})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be placed in the same bank.",autoFixable:!1,timestamp:Date.now()}),i.voltage!==s.voltage&&r.push({id:`diff_pair_voltage_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Differential pair voltage mismatch: ${o}`,description:`Differential pair pins have different voltages. Pin ${i.pinNumber} (${i.voltage}) and Pin ${s.pinNumber} (${s.voltage})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be set to the same voltage level.",autoFixable:!1,timestamp:Date.now()});const f=i.signalName&&i.signalName.trim()!=="",d=s.signalName&&s.signalName.trim()!=="";if(f&&d){const p=_r.getPairPinName(i.signalName);p&&p.toLowerCase()!==s.signalName.toLowerCase()&&r.push({id:`diff_pair_signal_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`: ${o}`,description:`"${i.signalName}"  "${s.signalName}"`,affectedPins:[i.id,s.id],suggestion:`: "${i.signalName}"  "${p}"`,autoFixable:!1,timestamp:Date.now()})}else f&&!d&&r.push({id:`diff_pair_incomplete_signal_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"info",title:`: ${o}`,description:` ${i.pinNumber}  "${i.signalName}"  ${s.pinNumber} `,affectedPins:[i.id,s.id],suggestion:"",autoFixable:!1,timestamp:Date.now()})}}),r}static checkBankConstraints(t){const r=[],n=new Map;return t.forEach(i=>{i.bank&&i.signalName&&i.signalName.trim()!==""&&(n.has(i.bank)||n.set(i.bank,[]),n.get(i.bank).push(i))}),n.forEach((i,a)=>{r.push(...this.checkVCCOConsistency(a,i)),r.push(...this.checkIOStandardCompatibility(a,i)),r.push(...this.checkDifferentialPairBankConstraints(a,i)),r.push(...this.checkSpecialPinConstraints(a,i)),r.push(...this.checkHighSpeedSignalConstraints(a,i))}),r}static getIOStandard(t){var r,n,i;return((r=t.attributes)==null?void 0:r.IO_Standard)||((n=t.attributes)==null?void 0:n.io_standard)||((i=t.attributes)==null?void 0:i.iostandard)}static checkVCCOConsistency(t,r){const n=[],i=new Set(r.map(a=>a.voltage).filter(a=>a&&a!==""&&a!=="0V"));return i.size>1&&n.push({id:`bank-vcco-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`VCCO voltage mismatch in Bank ${t}`,description:`Bank ${t} contains pins with different VCCO voltages: ${Array.from(i).join(", ")}. All pins in a bank must share the same VCCO.`,affectedPins:r.map(a=>a.id),suggestion:"Configure all pins in the same bank to use the same VCCO voltage level.",autoFixable:!1,timestamp:Date.now()}),n}static checkIOStandardCompatibility(t,r){const n=[],i=r.map(o=>this.getIOStandard(o)).filter(o=>o&&o!=="");if(i.length===0)return n;const a=[...new Set(i)];if(a.length<=1)return n;const s=[{group1:["LVCMOS33","LVCMOS25","LVCMOS18","LVCMOS15","LVCMOS12"],group2:["LVDS","LVDS_25","BLVDS_25","MLVDS_25"],reason:"Single-ended and differential standards cannot share the same bank"},{group1:["SSTL135","SSTL125","SSTL15"],group2:["POD12","POD10"],reason:"SSTL and POD standards require different reference voltages"},{group1:["HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18"],group2:["LVCMOS33","LVCMOS25"],reason:"HSTL requires center-tap termination, incompatible with LVCMOS"},{group1:["MIPI_DPHY_DCI"],group2:["LVCMOS18","LVCMOS12"],reason:"MIPI DPHY requires dedicated differential signaling"}];for(const o of s){const u=o.group1.some(d=>a.includes(d)),f=o.group2.some(d=>a.includes(d));if(u&&f){const d=r.filter(p=>o.group1.includes(this.getIOStandard(p)||"")||o.group2.includes(this.getIOStandard(p)||""));n.push({id:`bank-iostd-conflict-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`Incompatible I/O standards in Bank ${t}`,description:`${o.reason}. Found: ${a.join(", ")}`,affectedPins:d.map(p=>p.id),suggestion:"Separate incompatible I/O standards into different banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkDifferentialPairBankConstraints(t,r){const n=[],i=new Map;return r.forEach(a=>{if(!a.signalName)return;const s=this.getDifferentialBaseName(a.signalName);s&&(i.has(s)||i.set(s,[]),i.get(s).push(a))}),i.forEach((a,s)=>{if(a.length===2){const[o,u]=a;o.bank!==u.bank&&n.push({id:`diff-pair-bank-cross-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair crosses bank boundary",description:`Differential pair "${s}" has pins in different banks: ${o.pinNumber} (Bank ${o.bank}) and ${u.pinNumber} (Bank ${u.bank})`,affectedPins:[o.id,u.id],suggestion:"Place both pins of a differential pair in the same bank.",autoFixable:!1,timestamp:Date.now()});const f=this.getIOStandard(o),d=this.getIOStandard(u);f&&d&&f!==d&&n.push({id:`diff-pair-iostd-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair I/O standard mismatch",description:`Differential pair "${s}" has mismatched I/O standards: ${f} vs ${d}`,affectedPins:[o.id,u.id],suggestion:"Use the same I/O standard for both pins in a differential pair.",autoFixable:!1,timestamp:Date.now()})}}),n}static checkSpecialPinConstraints(t,r){const n=[],i=r.filter(s=>{var o,u,f,d,p;return((o=s.pinType)==null?void 0:o.includes("CLOCK"))||((u=s.pinType)==null?void 0:u.includes("GLOBAL"))||((f=s.pinType)==null?void 0:f.includes("CONFIG"))||((d=s.pinName)==null?void 0:d.startsWith("IO_L"))&&((p=s.pinName)==null?void 0:p.includes("CC"))}),a=r.filter(s=>!i.includes(s));if(i.length>0&&a.length>0){const s=i.filter(o=>{var u,f;return((u=o.signalName)==null?void 0:u.toLowerCase().includes("clk"))||((f=o.signalName)==null?void 0:f.toLowerCase().includes("clock"))});if(s.length>0){const o=s.filter(u=>{var f,d,p,m;return((f=u.signalName)==null?void 0:f.includes("100"))||((d=u.signalName)==null?void 0:d.includes("200"))||((p=u.signalName)==null?void 0:p.includes("GHz"))||((m=this.getIOStandard(u))==null?void 0:m.includes("LVDS"))});o.length>0&&a.length>0&&n.push({id:`bank-clock-isolation-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`High-speed clocks mixed with regular I/O in Bank ${t}`,description:"High-speed clock signals may cause noise coupling with regular I/O signals",affectedPins:[...o.map(u=>u.id),...a.slice(0,3).map(u=>u.id)],suggestion:"Consider isolating high-speed clock signals in dedicated banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkHighSpeedSignalConstraints(t,r){const n=[],i=r.filter(s=>{var u,f,d,p;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return o.includes("ddr")||o.includes("pcie")||o.includes("serdes")||o.includes("mgt")||o.includes("lvds")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVDS"))||((d=this.getIOStandard(s))==null?void 0:d.includes("SSTL"))||((p=this.getIOStandard(s))==null?void 0:p.includes("POD"))}),a=r.filter(s=>{var u,f;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return(o.includes("gpio")||o.includes("led")||o.includes("button")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVCMOS")))&&!i.includes(s)});return i.length>0&&a.length>0&&n.push({id:`bank-speed-mix-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`Mixed signal speeds in Bank ${t}`,description:`Bank ${t} contains both high-speed (${i.length}) and low-speed (${a.length}) signals`,affectedPins:[...i.slice(0,2).map(s=>s.id),...a.slice(0,2).map(s=>s.id)],suggestion:"Consider grouping signals by speed to minimize noise coupling.",autoFixable:!1,timestamp:Date.now()}),n}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);if(r.endsWith("p")&&!r.endsWith("_p")||r.endsWith("n")&&!r.endsWith("_n")){const n=r.charAt(r.length-2);if(/[\d_-]/.test(n))return t.slice(0,-1)}return null}static calculateSummary(t){const r={totalIssues:t.length,errorCount:0,warningCount:0,infoCount:0};return t.forEach(n=>{switch(n.severity){case"error":r.errorCount++;break;case"warning":r.warningCount++;break;case"info":r.infoCount++;break}}),r}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static getIssuesForPin(t,r){return r.filter(n=>n.affectedPins.includes(t))}static getIssuesByType(t,r){return r.filter(n=>n.type===t)}static getIssuesBySeverity(t,r){return r.filter(n=>n.severity===t)}}pl.listeners=new Set;const dU=(e,t,r={})=>{const{enabled:n=!0,debounceMs:i=1e3,backgroundCheck:a=!0}=r,[s,o]=ke.useState(null),[u,f]=ke.useState(!1),d=ke.useRef(null),p=ke.useRef(""),m=ke.useCallback(async()=>{if(!n||!e||t.length===0)return;const S=JSON.stringify({packageId:e.id,pinsData:t.map(x=>({id:x.id,signalName:x.signalName,bank:x.bank,voltage:x.voltage,pinName:x.pinName}))});if(S!==p.current)if(p.current=S,a){f(!0);try{const x=await pl.validateProjectAsync(e,t);o(x)}catch(x){console.error("Validation error:",x)}finally{f(!1)}}else{const x=pl.validateProject(e,t);o(x)}},[e,t,n,a]),v=ke.useCallback(()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{m()},i)},[m,i]);ke.useEffect(()=>(n&&v(),()=>{d.current&&clearTimeout(d.current)}),[t,e,n,v]);const g=ke.useCallback(()=>{p.current="",m()},[m]),_=ke.useCallback(S=>s?pl.getIssuesForPin(S,s.issues):[],[s]),k=ke.useCallback(S=>s?pl.getIssuesByType(S,s.issues):[],[s]),E=ke.useCallback(S=>s?pl.getIssuesBySeverity(S,s.issues):[],[s]);return{validationResult:s,isValidating:u,manualValidate:g,getIssuesForPin:_,getIssuesByType:k,getIssuesBySeverity:E,hasErrors:s?s.summary.errorCount>0:!1,hasWarnings:s?s.summary.warningCount>0:!1,hasIssues:s?s.summary.totalIssues>0:!1,errorCount:(s==null?void 0:s.summary.errorCount)||0,warningCount:(s==null?void 0:s.summary.warningCount)||0,totalIssues:(s==null?void 0:s.summary.totalIssues)||0}},hU=`# Xilinx XC7A12T Package Data
# Copyright (C) 2024 Sample Data
Pin,Pin Name,Memory Byte Group,Bank,VCCAUX Group,Super Logic Region,I/O Type,No-Connect
A1,IO_L1P_T0_D00_MOSI_14,0,14,NA,X0Y0,HR,FALSE
A2,IO_L1N_T0_D01_DIN_14,0,14,NA,X0Y0,HR,FALSE
B1,VCCINT,NA,NA,NA,NA,POWER,FALSE
B2,GND,NA,NA,NA,NA,GROUND,FALSE
C1,IO_L2P_T0_D02_14,0,14,NA,X0Y0,HR,FALSE
C2,IO_L2N_T0_D03_14,0,14,NA,X0Y0,HR,FALSE
D1,CONFIG_DONE,NA,NA,NA,NA,CONFIG,FALSE
D2,MGTPRXP1_216,NA,216,NA,NA,GTP,FALSE`,pU=()=>{const e=new Blob([hU],{type:"text/csv"});return new File([e],"sample-fpga-pins.csv",{type:"text/csv"})},gU=()=>{const e=ke.useRef(null),[t,r]=ke.useState(!1),[n,i]=ke.useState(null),[a,s]=ke.useState(!1),[o,u]=ke.useState(!1),[f,d]=ke.useState("validation"),[p,m]=ke.useState(!1),[v,g]=ke.useState(!1),[_,k]=ke.useState(!1),[E,S]=ke.useState(!1),[x,C]=ke.useState(320),[N,T]=ke.useState(280),[F,P]=ke.useState(null);fU(),ke.useEffect(()=>{const Fe=Xe=>{Xe.key==="F11"&&(Xe.preventDefault(),ue())};return document.addEventListener("keydown",Fe),()=>{document.removeEventListener("keydown",Fe)}},[v,_,E]),ke.useEffect(()=>{const Fe=()=>{u(!0)};return document.addEventListener("showKeyboardHelp",Fe),()=>{document.removeEventListener("showKeyboardHelp",Fe)}},[]),ke.useEffect(()=>{const Fe=Xe=>{p&&(Xe.target.closest("[data-export-menu]")||m(!1))};return document.addEventListener("click",Fe),()=>{document.removeEventListener("click",Fe)}},[p]);const{pins:I,filteredPins:D,selectedPins:U,package:b,filters:Q,viewConfig:he,listView:te,loadPackage:Ae,selectPin:Te,assignSignal:ie,updateFilters:X,setError:ce,setLoading:Ce,setRotation:L,toggleView:q,setZoom:Y,resetZoom:K,setSortField:de,setSortOrder:G,setViewMode:J}=$i(),ue=()=>{g(!v),v?(k(!1),S(!1)):(k(!0),S(!0),setTimeout(()=>{K()},100))},ve=Fe=>Xe=>{Xe.preventDefault(),P(Fe)},Be=Fe=>{if(!F)return;const Xe=window.innerWidth;if(F==="left"){const Qe=Math.max(200,Math.min(500,Fe.clientX));C(Qe)}else if(F==="right"){const Qe=Math.max(200,Math.min(500,Xe-Fe.clientX));T(Qe)}},V=()=>{P(null)};ke.useEffect(()=>(document.addEventListener("mousemove",Be),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",Be),document.removeEventListener("mouseup",V)}),[F]),ke.useEffect(()=>{const Fe=Xe=>{console.log(" Received message from VS Code:",Xe.data);const Qe=Xe.data;switch(Qe.command){case"loadProject":try{if(Qe.projectData){console.log("Loading project from VS Code:",Qe.projectData);const qe=Qe.projectData;if(qe.package&&qe.pins){const kt=qe.pins.map(gt=>({...gt,isAssigned:!!gt.assignedSignalName,signalName:gt.assignedSignalName||""})),dt=zc.createPackageFromPins(kt,qe.package.name||"Loaded Project");Ae(dt),console.log(" Project loaded successfully from VS Code")}}}catch(qe){console.error("Failed to load project from VS Code:",qe),ce(`Failed to load project: ${qe}`)}break;case"loadSampleData":(async()=>{try{console.log("Loading sample data from VS Code command");const qe=pU();r(!0),Ce(!0),ce(null);const kt=await zc.parseCSVFile(qe);if(console.log(" Sample data parse result:",kt),kt.success){console.log(" Sample data parsed successfully:",kt.pins.length,"pins found");const dt=zc.createPackageFromPins(kt.pins,qe.name);Ae(dt),console.log(" Sample data loaded successfully from VS Code command"),kt.warnings.length>0&&console.warn(" Sample data import warnings:",kt.warnings)}else console.error(" Sample data parse failed:",kt.errors),ce(`Failed to load sample data: ${kt.errors.join(", ")}`)}catch(qe){console.error("Failed to load sample data from VS Code:",qe),ce(`Failed to load sample data: ${qe}`)}finally{r(!1),Ce(!1)}})();break}};return console.log(" Checking VS Code environment:",{hasVscode:typeof window.vscode<"u",windowKeys:Object.keys(window),userAgent:navigator.userAgent}),typeof window.vscode<"u"?(console.log(" VS Code environment detected, setting up message listener"),window.addEventListener("message",Fe),setTimeout(()=>{console.log(" Notifying VS Code extension that webview is ready"),window.vscode.postMessage({command:"webviewReady"})},500),()=>{console.log(" Cleaning up VS Code message listener"),window.removeEventListener("message",Fe)}):(console.log(" Not in VS Code environment"),()=>{})},[Ae,ce]);const{validationResult:Ze,isValidating:nt,hasErrors:Ye,hasWarnings:Je,errorCount:Re,warningCount:wt}=dU(b,I,{enabled:!0,debounceMs:1e3,backgroundCheck:!0}),Or=()=>{var Fe;(Fe=e.current)==null||Fe.click()},pr=async Fe=>{var Qe,qe;const Xe=(Qe=Fe.target.files)==null?void 0:Qe[0];if(Xe){console.log(" :",Xe.name,Xe.size,"bytes"),r(!0),Ce(!0),ce(null);try{const kt=(qe=Xe.name.split(".").pop())==null?void 0:qe.toLowerCase();console.log(" ... (",kt,")");const dt=await zc.parseCSVFile(Xe);if(console.log(" :",dt),dt.success){console.log(" :",dt.pins.length,"pins found");const gt=zc.createPackageFromPins(dt.pins,Xe.name);console.log(" :",gt),Ae(gt),console.log(" "),dt.warnings.length>0&&console.warn(" Import warnings:",dt.warnings)}else console.error(" :",dt.errors),ce(`Failed to import file: ${dt.errors.join(", ")}`)}catch(kt){console.error(" :",kt),ce(`Error reading file: ${kt.message}`)}finally{r(!1),Ce(!1),e.current&&(e.current.value="")}}},_e=Fe=>{X({searchText:Fe.target.value})},me=Fe=>{const Xe=Q.pinTypes,Qe=Xe.includes(Fe)?Xe.filter(qe=>qe!==Fe):[...Xe,Fe];X({pinTypes:Qe})},Se=()=>{const Fe=I.length,Xe=I.filter(qe=>qe.isAssigned).length,Qe=Fe-Xe;return{total:Fe,assigned:Xe,unassigned:Qe}},we=()=>{L(he.rotation+90)},Ee=()=>{Y(Math.min(3,he.zoom+.1))},Pe=()=>{Y(Math.max(.2,he.zoom-.1))},Me=Fe=>{const Xe=I.find(Qe=>Qe.id===Fe);if(Xe){const Qe=prompt("Enter signal name:",Xe.signalName);Qe!==null&&ie(Fe,Qe)}},pe=Fe=>{Te(Fe),i(Fe||null)},re=Fe=>{Te(Fe)},xe=()=>typeof window.vscode<"u",De=async(Fe,Xe,Qe,qe)=>{if(!xe())return!1;try{const kt=window.vscode,dt=await new Promise(gt=>{const Hn=yn=>{yn.data.command==="saveDialogResult"&&(window.removeEventListener("message",Hn),gt(yn.data.result))};window.addEventListener("message",Hn),kt.postMessage({command:"showSaveDialog",options:{saveLabel:qe,filters:Qe}})});if(dt){let gt;if(typeof dt=="string")gt=dt;else if(dt&&typeof dt=="object"){const yn=dt;gt=yn.fsPath||yn.path,!gt&&typeof dt.toString=="function"&&(gt=dt.toString())}return!gt||gt==="undefined"||gt==="[object Object]"?(console.error("Failed to extract valid file path from URI"),!1):await new Promise(yn=>{const va=_n=>{_n.data.command==="saveFileResult"&&(window.removeEventListener("message",va),yn(_n.data.success))};window.addEventListener("message",va),kt.postMessage({command:"saveFile",filePath:gt,content:Fe,filename:Xe})})}}catch(kt){console.error("VS Code save failed:",kt)}return!1},Le=Fe=>{console.log(" EXPORT DEBUG - handleExportConstraints:"),console.log("- pins.length:",I.length),console.log("- filteredPins.length:",D.length);const Xe=D.length>0?D:I;if(Xe.length===0){console.log(" No pins available for export");return}let Qe,qe,kt,dt,gt;Fe==="xdc"?(Qe=Na.exportToXDC(Xe,b),qe=`${(b==null?void 0:b.device)||"fpga"}_pins.xdc`,kt="text/plain",dt={"XDC Files":["xdc"],"All Files":["*"]},gt="Export XDC Constraints"):(Qe=Na.exportToSDC(Xe,b),qe=`${(b==null?void 0:b.device)||"fpga"}_pins.sdc`,kt="text/plain",dt={"SDC Files":["sdc"],"All Files":["*"]},gt="Export SDC Constraints"),De(Qe,qe,dt,gt).then(Hn=>{Hn||Na.downloadFile(Qe,qe,kt)})},Ke=async()=>{console.log(" EXPORT DEBUG - handleExportCSV:"),console.log("- pins.length:",I.length),console.log("- filteredPins.length:",D.length);const Fe=D.length>0?D:I;if(Fe.length===0){console.log(" No pins available for export");return}const Xe=Na.exportToCSV(Fe),Qe=`${(b==null?void 0:b.device)||"fpga"}_pins.csv`;await De(Xe,Qe,{"CSV Files":["csv"],"All Files":["*"]},"Export Pin Data to CSV")||Na.downloadFile(Xe,Qe,"text/csv")},xt=async()=>{console.log(" EXPORT DEBUG - handleExportReport:"),console.log("- pins.length:",I.length),console.log("- filteredPins.length:",D.length);const Fe=D.length>0?D:I;if(Fe.length===0){console.log(" No pins available for export");return}const Xe=Na.exportReport(Fe,b),Qe=`${(b==null?void 0:b.device)||"fpga"}_report.txt`;await De(Xe,Qe,{"Text Files":["txt"],"All Files":["*"]},"Export Pin Assignment Report")||Na.downloadFile(Xe,Qe,"text/plain")},Dt=Se(),{sortedPinsForList:Ut}=Sr.useMemo(()=>{const Fe=[...D];return Fe.sort((Xe,Qe)=>{var yn,va;const qe=n&&Xe.id===n,kt=n&&Qe.id===n;if(qe&&!kt)return-1;if(!qe&&kt)return 1;if(n&&!qe&&!kt){const _n=D.find(Zr=>Zr.id===n);if(_n){const Zr=_r.findPairPin(_n,D),Xs=(Zr==null?void 0:Zr.id)===Xe.id,$o=(Zr==null?void 0:Zr.id)===Qe.id;if(Xs&&!$o)return-1;if(!Xs&&$o)return 1}}let dt,gt;switch(Q.sortField){case"pinNumber":dt=Xe.pinNumber,gt=Qe.pinNumber;break;case"pinName":dt=Xe.pinName,gt=Qe.pinName;break;case"signalName":dt=Xe.signalName||"",gt=Qe.signalName||"";break;case"pinType":dt=Xe.pinType,gt=Qe.pinType;break;case"bank":dt=Xe.bank||"",gt=Qe.bank||"";break;case"grid":if(Xe.gridPosition&&Qe.gridPosition){const _n=H6(Xe.gridPosition.row,Qe.gridPosition.row);if(_n!==0)return Q.sortOrder==="asc"?_n:-_n;const Zr=Xe.gridPosition.col-Qe.gridPosition.col;return Q.sortOrder==="asc"?Zr:-Zr}dt=((yn=Xe.gridPosition)==null?void 0:yn.row)||"",gt=((va=Qe.gridPosition)==null?void 0:va.row)||"";break;default:dt=Xe.pinNumber,gt=Qe.pinNumber}const Hn=dt.localeCompare(gt,void 0,{numeric:!0,sensitivity:"base"});return Q.sortOrder==="asc"?Hn:-Hn}),{sortedPinsForList:Fe}},[D,Q.sortField,Q.sortOrder,n,I]);return A.jsxs("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',display:"flex",flexDirection:"column"},children:[A.jsxs("header",{style:{height:"36px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",flexShrink:0,minHeight:"36px"},children:[A.jsx("h1",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#4A90E2"},children:"FPGA Pin Planner"}),A.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"12px",alignItems:"center"},children:[A.jsx("button",{onClick:ue,style:{padding:"6px 12px",backgroundColor:v?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px",color:v?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},title:v?"Restore Normal View (F11)":"Maximize Viewer (F11)",children:v?" Restore":" Maximize"}),A.jsx("input",{ref:e,type:"file",accept:".csv,.txt,.xlsx,.xls",onChange:pr,style:{display:"none"}}),A.jsx("button",{onClick:Or,disabled:t,style:{padding:"8px 16px",backgroundColor:t?"#666":"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:t?"not-allowed":"pointer",fontSize:"14px"},children:t?" Loading...":" Open Pin File"}),A.jsxs("div",{style:{position:"relative"},"data-export-menu":!0,children:[A.jsxs("button",{onClick:()=>m(!p),disabled:D.length===0&&I.length===0,style:{padding:"8px 16px",backgroundColor:D.length>0||I.length>0?"#4A90E2":"#666",border:"none",borderRadius:"4px",color:"white",cursor:D.length>0||I.length>0?"pointer":"not-allowed",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},title:"Export Pin Data",children:[" Export ",p?"":""]}),p&&(D.length>0||I.length>0)&&A.jsxs("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",zIndex:1e3,minWidth:"160px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[A.jsx("button",{onClick:()=>{s(!0),m(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Fe=>Fe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Fe=>Fe.currentTarget.style.backgroundColor="transparent",children:" Constraints (XDC/SDC)"}),A.jsx("button",{onClick:()=>{Ke(),m(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Fe=>Fe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Fe=>Fe.currentTarget.style.backgroundColor="transparent",children:" CSV Data"}),A.jsx("button",{onClick:()=>{xt(),m(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px"},onMouseEnter:Fe=>Fe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Fe=>Fe.currentTarget.style.backgroundColor="transparent",children:" Report"})]})]})]})]}),A.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0,height:"100%"},children:[!_&&A.jsxs("aside",{style:{width:`${x}px`,backgroundColor:"#252525",borderRight:"1px solid #444",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%",minWidth:"200px",maxWidth:"500px"},children:[A.jsx("div",{onMouseDown:ve("left"),style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:F==="left"?"#007acc":"transparent"},title:"Drag to resize panel"}),A.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #444"},children:[A.jsx("input",{type:"text",placeholder:"Search pins...",value:Q.searchText,onChange:_e,style:{width:"100%",padding:"8px 12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),A.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",alignItems:"center"},children:[A.jsx("span",{style:{fontSize:"12px",color:"#999"},children:"Sort:"}),A.jsxs("select",{value:Q.sortField,onChange:Fe=>de(Fe.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",fontSize:"12px",cursor:"pointer"},children:[A.jsx("option",{value:"pinNumber",children:"Pin Number"}),A.jsx("option",{value:"pinName",children:"Pin Name"}),A.jsx("option",{value:"signalName",children:"Signal Name"}),A.jsx("option",{value:"pinType",children:"Pin Type"}),A.jsx("option",{value:"bank",children:"Bank"}),A.jsx("option",{value:"grid",children:"Grid Position"})]}),A.jsx("button",{onClick:()=>G(Q.sortOrder==="asc"?"desc":"asc"),style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px"},title:`Sort ${Q.sortOrder==="asc"?"Descending":"Ascending"}`,children:Q.sortOrder==="asc"?"":""})]}),A.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",flexWrap:"wrap"},children:[A.jsxs("button",{onClick:()=>X({pinTypes:[]}),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.length===0?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["All (",I.length,")"]}),A.jsxs("button",{onClick:()=>me("IO"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("IO")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["I/O (",I.filter(Fe=>Fe.pinType==="IO").length,")"]}),A.jsxs("button",{onClick:()=>me("POWER"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("POWER")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["Power (",I.filter(Fe=>Fe.pinType==="POWER").length,")"]})]})]}),A.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:I.length===0?A.jsxs(A.Fragment,{children:[A.jsx("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px"},children:"No package loaded"}),A.jsxs("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:["Debug: pins=",I.length,", package=",(b==null?void 0:b.name)||"null"]}),A.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"14px"},children:[A.jsx("div",{style:{marginBottom:"12px"},children:""}),A.jsx("div",{children:"Load a CSV file to start"})]})]}):A.jsxs(A.Fragment,{children:[A.jsxs("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px",display:"flex",justifyContent:"space-between"},children:[A.jsx("span",{children:(b==null?void 0:b.name)||"Package"}),A.jsxs("span",{children:["Showing ",D.length," of ",I.length]})]}),A.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:Ut.map(Fe=>{const Xe=n?I.find(kt=>kt.id===n):null,Qe=Xe?_r.findPairPin(Xe,I):null,qe=(Qe==null?void 0:Qe.id)===Fe.id;return A.jsx(yD,{pin:Fe,isSelected:U.has(Fe.id),onSelect:re,onAssignSignal:ie,isPairPin:!1,isDifferentialPairPartner:qe},Fe.id)})})]})})]}),A.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0,minHeight:0},children:[A.jsxs("div",{className:"toolbar-scrollbar",style:{height:"32px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 12px",gap:"8px",overflowX:"auto",overflowY:"hidden",flexShrink:0,minHeight:"32px"},children:[A.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[A.jsx("button",{onClick:()=>J("grid"),style:{padding:"4px 8px",backgroundColor:te.viewMode==="grid"?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px 0 0 4px",color:te.viewMode==="grid"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"Grid View",children:" Grid"}),A.jsx("button",{onClick:()=>J("list"),style:{padding:"4px 8px",backgroundColor:te.viewMode==="list"?"#007acc":"#333",border:"1px solid #555",borderRadius:"0 4px 4px 0",color:te.viewMode==="list"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"List View",children:" List"})]}),A.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),A.jsx("button",{onClick:we,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Rotate 90"}),A.jsx("button",{onClick:q,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Flip View"}),A.jsx("div",{style:{flexShrink:0},children:A.jsx(tU,{})}),A.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),A.jsx("div",{style:{flexShrink:0},children:A.jsx(rU,{})}),A.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),A.jsxs("button",{onClick:()=>d(f==="validation"?null:"validation"),style:{padding:"6px 12px",backgroundColor:f==="validation"?"#4a5568":Ye?"#dc2626":Je?"#d97706":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:`Validation: ${Re} errors, ${wt} warnings (click for details)`,children:[A.jsx(oU,{validationResult:Ze}),A.jsx("span",{children:"Validation"}),nt&&A.jsx("span",{className:"animate-spin",children:""})]}),A.jsxs("button",{onClick:()=>d(f==="batch"?null:"batch"),style:{padding:"6px 12px",backgroundColor:f==="batch"?"#4a5568":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:"Batch Operations - Assign patterns to multiple pins",children:[A.jsx("span",{children:""}),A.jsx("span",{children:"Batch Ops"})]}),A.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),A.jsx("button",{onClick:()=>u(!0),style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},title:"Keyboard Shortcuts (Ctrl+Shift+?)",children:" Shortcuts"}),A.jsx("div",{style:{flex:1,minWidth:"20px"}}),A.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0,backgroundColor:"#2a2a2a",padding:"0 8px",borderRadius:"4px"},children:[A.jsx("span",{style:{fontSize:"12px",color:"#999",whiteSpace:"nowrap"},children:"Zoom:"}),A.jsx("button",{onClick:Pe,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"-"}),A.jsxs("button",{onClick:K,style:{padding:"4px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",minWidth:"50px",whiteSpace:"nowrap"},title:"Reset zoom to 100%",children:[Math.round(he.zoom*100),"%"]}),A.jsx("button",{onClick:Ee,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"+"})]})]}),A.jsxs("div",{style:{flex:1,minWidth:"0",backgroundColor:"#1a1a1a",overflow:"hidden",display:"flex",flexShrink:1,width:"100%",minHeight:0,height:"100%"},children:[A.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minWidth:0,width:"100%",minHeight:0,height:"100%"},children:te.viewMode==="grid"?A.jsx(eU,{package:b,pins:D,selectedPins:U,onPinSelect:pe,onPinDoubleClick:Me,zoom:he.zoom,rotation:he.rotation,isTopView:he.isTopView,onZoomChange:Y}):A.jsx("div",{style:{height:"100%",backgroundColor:"#1a1a1a",overflow:"hidden",width:"100%",minHeight:0},children:A.jsx(jD,{onPinSelect:re})})}),!_&&f&&A.jsxs("div",{style:{width:`${N}px`,minWidth:"200px",maxWidth:"500px",borderLeft:"1px solid #555",backgroundColor:"#1e1e1e",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minHeight:0,position:"relative"},children:[A.jsx("div",{onMouseDown:ve("right"),style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:F==="right"?"#007acc":"transparent"},title:"Drag to resize panel"}),f==="validation"&&A.jsx("div",{style:{height:"100%",overflow:"hidden"},className:"custom-scrollbar",children:A.jsx(sU,{validationResult:Ze,onIssueClick:Fe=>{Fe.affectedPins&&Fe.affectedPins.length>0&&console.log("Pins to highlight:",Fe.affectedPins)}})}),f==="batch"&&A.jsx("div",{style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:A.jsx(lU,{isVisible:!0})})]})]})]})]}),!E&&A.jsxs("footer",{style:{height:"16px",backgroundColor:"#2a2a2a",borderTop:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",fontSize:"10px",color:"#999",flexShrink:0},children:[A.jsx("span",{children:"Ready"}),A.jsx("div",{style:{marginLeft:"auto"},children:A.jsxs("span",{children:["Pins: ",Dt.total," | Assigned: ",Dt.assigned," | Unassigned: ",Dt.unassigned]})})]}),A.jsx(_D,{isOpen:a,onClose:()=>s(!1),onExport:Le,pins:I,currentPackage:b}),A.jsx(aU,{isOpen:o,onClose:()=>u(!1)})]})};wg.createRoot(document.getElementById("root")).render(A.jsx(Sr.StrictMode,{children:A.jsx(gU,{})}));
