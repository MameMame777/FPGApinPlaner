(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var hy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var C5={exports:{}},qd={},E5={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var su=Symbol.for("react.element"),lk=Symbol.for("react.portal"),ck=Symbol.for("react.fragment"),uk=Symbol.for("react.strict_mode"),fk=Symbol.for("react.profiler"),dk=Symbol.for("react.provider"),hk=Symbol.for("react.context"),pk=Symbol.for("react.forward_ref"),gk=Symbol.for("react.suspense"),mk=Symbol.for("react.memo"),xk=Symbol.for("react.lazy"),py=Symbol.iterator;function vk(e){return e===null||typeof e!="object"?null:(e=py&&e[py]||e["@@iterator"],typeof e=="function"?e:null)}var T5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A5=Object.assign,P5={};function nc(e,t,r){this.props=e,this.context=t,this.refs=P5,this.updater=r||T5}nc.prototype.isReactComponent={};nc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};nc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function N5(){}N5.prototype=nc.prototype;function Gm(e,t,r){this.props=e,this.context=t,this.refs=P5,this.updater=r||T5}var Hm=Gm.prototype=new N5;Hm.constructor=Gm;A5(Hm,nc.prototype);Hm.isPureReactComponent=!0;var gy=Array.isArray,F5=Object.prototype.hasOwnProperty,Wm={current:null},R5={key:!0,ref:!0,__self:!0,__source:!0};function b5(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)F5.call(t,n)&&!R5.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),f=0;f<o;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:su,type:e,key:a,ref:s,props:i,_owner:Wm.current}}function yk(e,t){return{$$typeof:su,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $m(e){return typeof e=="object"&&e!==null&&e.$$typeof===su}function _k(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var my=/\/+/g;function kp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_k(""+e.key):t.toString(36)}function Xf(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case su:case lk:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+kp(s,0):n,gy(i)?(r="",e!=null&&(r=e.replace(my,"$&/")+"/"),Xf(i,t,r,"",function(f){return f})):i!=null&&($m(i)&&(i=yk(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(my,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",gy(e))for(var o=0;o<e.length;o++){a=e[o];var u=n+kp(a,o);s+=Xf(a,t,r,u,i)}else if(u=vk(e),typeof u=="function")for(e=u.call(e),o=0;!(a=e.next()).done;)a=a.value,u=n+kp(a,o++),s+=Xf(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function gf(e,t,r){if(e==null)return e;var n=[],i=0;return Xf(e,n,"","",function(a){return t.call(r,a,i++)}),n}function Sk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Fn={current:null},Kf={transition:null},wk={ReactCurrentDispatcher:Fn,ReactCurrentBatchConfig:Kf,ReactCurrentOwner:Wm};function I5(){throw Error("act(...) is not supported in production builds of React.")}pt.Children={map:gf,forEach:function(e,t,r){gf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return gf(e,function(){t++}),t},toArray:function(e){return gf(e,function(t){return t})||[]},only:function(e){if(!$m(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pt.Component=nc;pt.Fragment=ck;pt.Profiler=fk;pt.PureComponent=Gm;pt.StrictMode=uk;pt.Suspense=gk;pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wk;pt.act=I5;pt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=A5({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Wm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)F5.call(t,u)&&!R5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var f=0;f<u;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:su,type:e.type,key:i,ref:a,props:n,_owner:s}};pt.createContext=function(e){return e={$$typeof:hk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dk,_context:e},e.Consumer=e};pt.createElement=b5;pt.createFactory=function(e){var t=b5.bind(null,e);return t.type=e,t};pt.createRef=function(){return{current:null}};pt.forwardRef=function(e){return{$$typeof:pk,render:e}};pt.isValidElement=$m;pt.lazy=function(e){return{$$typeof:xk,_payload:{_status:-1,_result:e},_init:Sk}};pt.memo=function(e,t){return{$$typeof:mk,type:e,compare:t===void 0?null:t}};pt.startTransition=function(e){var t=Kf.transition;Kf.transition={};try{e()}finally{Kf.transition=t}};pt.unstable_act=I5;pt.useCallback=function(e,t){return Fn.current.useCallback(e,t)};pt.useContext=function(e){return Fn.current.useContext(e)};pt.useDebugValue=function(){};pt.useDeferredValue=function(e){return Fn.current.useDeferredValue(e)};pt.useEffect=function(e,t){return Fn.current.useEffect(e,t)};pt.useId=function(){return Fn.current.useId()};pt.useImperativeHandle=function(e,t,r){return Fn.current.useImperativeHandle(e,t,r)};pt.useInsertionEffect=function(e,t){return Fn.current.useInsertionEffect(e,t)};pt.useLayoutEffect=function(e,t){return Fn.current.useLayoutEffect(e,t)};pt.useMemo=function(e,t){return Fn.current.useMemo(e,t)};pt.useReducer=function(e,t,r){return Fn.current.useReducer(e,t,r)};pt.useRef=function(e){return Fn.current.useRef(e)};pt.useState=function(e){return Fn.current.useState(e)};pt.useSyncExternalStore=function(e,t,r){return Fn.current.useSyncExternalStore(e,t,r)};pt.useTransition=function(){return Fn.current.useTransition()};pt.version="18.3.1";E5.exports=pt;var Se=E5.exports;const wr=Qd(Se);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kk=Se,Ck=Symbol.for("react.element"),Ek=Symbol.for("react.fragment"),Tk=Object.prototype.hasOwnProperty,Ak=kk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pk={key:!0,ref:!0,__self:!0,__source:!0};function D5(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Tk.call(t,n)&&!Pk.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Ck,type:e,key:a,ref:s,props:i,_owner:Ak.current}}qd.Fragment=Ek;qd.jsx=D5;qd.jsxs=D5;C5.exports=qd;var w=C5.exports,kg={},O5={exports:{}},ni={},L5={exports:{}},M5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,X){var he=re.length;re.push(X);e:for(;0<he;){var Te=he-1>>>1,L=re[Te];if(0<i(L,X))re[Te]=X,re[he]=L,he=Te;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var X=re[0],he=re.pop();if(he!==X){re[0]=he;e:for(var Te=0,L=re.length,Q=L>>>1;Te<Q;){var Y=2*(Te+1)-1,K=re[Y],ue=Y+1,V=re[ue];if(0>i(K,he))ue<L&&0>i(V,K)?(re[Te]=V,re[ue]=he,Te=ue):(re[Te]=K,re[Y]=he,Te=Y);else if(ue<L&&0>i(V,he))re[Te]=V,re[ue]=he,Te=ue;else break e}}return X}function i(re,X){var he=re.sortIndex-X.sortIndex;return he!==0?he:re.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],f=[],d=1,p=null,m=3,v=!1,g=!1,y=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(re){for(var X=r(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=re)n(f),X.sortIndex=X.expirationTime,t(u,X);else break;X=r(f)}}function T(re){if(y=!1,x(re),!g)if(r(u)!==null)g=!0,Ae(F);else{var X=r(f);X!==null&&Ee(T,X.startTime-re)}}function F(re,X){g=!1,y&&(y=!1,E(P),P=-1),v=!0;var he=m;try{for(x(X),p=r(u);p!==null&&(!(p.expirationTime>X)||re&&!O());){var Te=p.callback;if(typeof Te=="function"){p.callback=null,m=p.priorityLevel;var L=Te(p.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?p.callback=L:p===r(u)&&n(u),x(X)}else n(u);p=r(u)}if(p!==null)var Q=!0;else{var Y=r(f);Y!==null&&Ee(T,Y.startTime-X),Q=!1}return Q}finally{p=null,m=he,v=!1}}var N=!1,A=null,P=-1,b=5,I=-1;function O(){return!(e.unstable_now()-I<b)}function j(){if(A!==null){var re=e.unstable_now();I=re;var X=!0;try{X=A(!0,re)}finally{X?q():(N=!1,A=null)}}else N=!1}var q;if(typeof S=="function")q=function(){S(j)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,te=ie.port2;ie.port1.onmessage=j,q=function(){te.postMessage(null)}}else q=function(){C(j,0)};function Ae(re){A=re,N||(N=!0,q())}function Ee(re,X){P=C(function(){re(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){g||v||(g=!0,Ae(F))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(re){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var he=m;m=X;try{return re()}finally{m=he}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,X){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var he=m;m=re;try{return X()}finally{m=he}},e.unstable_scheduleCallback=function(re,X,he){var Te=e.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Te+he:Te):he=Te,re){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=he+L,re={id:d++,callback:X,priorityLevel:re,startTime:he,expirationTime:L,sortIndex:-1},he>Te?(re.sortIndex=he,t(f,re),r(u)===null&&re===r(f)&&(y?(E(P),P=-1):y=!0,Ee(T,he-Te))):(re.sortIndex=L,t(u,re),g||v||(g=!0,Ae(F))),re},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(re){var X=m;return function(){var he=m;m=X;try{return re.apply(this,arguments)}finally{m=he}}}})(M5);L5.exports=M5;var c0=L5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nk=Se,ei=c0;function Re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B5=new Set,P0={};function Ro(e,t){Ul(e,t),Ul(e+"Capture",t)}function Ul(e,t){for(P0[e]=t,e=0;e<t.length;e++)B5.add(t[e])}var za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cg=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xy={},vy={};function Rk(e){return Cg.call(vy,e)?!0:Cg.call(xy,e)?!1:Fk.test(e)?vy[e]=!0:(xy[e]=!0,!1)}function bk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ik(e,t,r,n){if(t===null||typeof t>"u"||bk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Rn(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var Zr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zr[e]=new Rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zr[t]=new Rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zr[e]=new Rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zr[e]=new Rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zr[e]=new Rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zr[e]=new Rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zr[e]=new Rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zr[e]=new Rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zr[e]=new Rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Xm=/[\-:]([a-z])/g;function Km(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Xm,Km);Zr[t]=new Rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Xm,Km);Zr[t]=new Rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Xm,Km);Zr[t]=new Rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zr[e]=new Rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Zr.xlinkHref=new Rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zr[e]=new Rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ym(e,t,r,n){var i=Zr.hasOwnProperty(t)?Zr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ik(t,r,i,n)&&(r=null),n||i===null?Rk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Xa=Nk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mf=Symbol.for("react.element"),xl=Symbol.for("react.portal"),vl=Symbol.for("react.fragment"),Qm=Symbol.for("react.strict_mode"),Eg=Symbol.for("react.profiler"),j5=Symbol.for("react.provider"),U5=Symbol.for("react.context"),qm=Symbol.for("react.forward_ref"),Tg=Symbol.for("react.suspense"),Ag=Symbol.for("react.suspense_list"),Jm=Symbol.for("react.memo"),ps=Symbol.for("react.lazy"),z5=Symbol.for("react.offscreen"),yy=Symbol.iterator;function Oc(e){return e===null||typeof e!="object"?null:(e=yy&&e[yy]||e["@@iterator"],typeof e=="function"?e:null)}var nr=Object.assign,Cp;function e0(e){if(Cp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cp=t&&t[1]||""}return`
`+Cp+e}var Ep=!1;function Tp(e,t){if(!e||Ep)return"";Ep=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=o);break}}}finally{Ep=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?e0(e):""}function Dk(e){switch(e.tag){case 5:return e0(e.type);case 16:return e0("Lazy");case 13:return e0("Suspense");case 19:return e0("SuspenseList");case 0:case 2:case 15:return e=Tp(e.type,!1),e;case 11:return e=Tp(e.type.render,!1),e;case 1:return e=Tp(e.type,!0),e;default:return""}}function Pg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vl:return"Fragment";case xl:return"Portal";case Eg:return"Profiler";case Qm:return"StrictMode";case Tg:return"Suspense";case Ag:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case U5:return(e.displayName||"Context")+".Consumer";case j5:return(e._context.displayName||"Context")+".Provider";case qm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jm:return t=e.displayName||null,t!==null?t:Pg(e.type)||"Memo";case ps:t=e._payload,e=e._init;try{return Pg(e(t))}catch{}}return null}function Ok(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pg(t);case 8:return t===Qm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Is(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function V5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Lk(e){var t=V5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xf(e){e._valueTracker||(e._valueTracker=Lk(e))}function G5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=V5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function od(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ng(e,t){var r=t.checked;return nr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function _y(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Is(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function H5(e,t){t=t.checked,t!=null&&Ym(e,"checked",t,!1)}function Fg(e,t){H5(e,t);var r=Is(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Rg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Rg(e,t.type,Is(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Sy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Rg(e,t,r){(t!=="number"||od(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var t0=Array.isArray;function Fl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Is(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function bg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Re(91));return nr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function wy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Re(92));if(t0(r)){if(1<r.length)throw Error(Re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Is(r)}}function W5(e,t){var r=Is(t.value),n=Is(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ky(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ig(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var vf,X5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(vf=vf||document.createElement("div"),vf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=vf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function N0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var u0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mk=["Webkit","ms","Moz","O"];Object.keys(u0).forEach(function(e){Mk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),u0[t]=u0[e]})});function K5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||u0.hasOwnProperty(e)&&u0[e]?(""+t).trim():t+"px"}function Y5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=K5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Bk=nr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dg(e,t){if(t){if(Bk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Re(62))}}function Og(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lg=null;function Zm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mg=null,Rl=null,bl=null;function Cy(e){if(e=cu(e)){if(typeof Mg!="function")throw Error(Re(280));var t=e.stateNode;t&&(t=rh(t),Mg(e.stateNode,e.type,t))}}function Q5(e){Rl?bl?bl.push(e):bl=[e]:Rl=e}function q5(){if(Rl){var e=Rl,t=bl;if(bl=Rl=null,Cy(e),t)for(e=0;e<t.length;e++)Cy(t[e])}}function J5(e,t){return e(t)}function Z5(){}var Ap=!1;function e_(e,t,r){if(Ap)return e(t,r);Ap=!0;try{return J5(e,t,r)}finally{Ap=!1,(Rl!==null||bl!==null)&&(Z5(),q5())}}function F0(e,t){var r=e.stateNode;if(r===null)return null;var n=rh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Re(231,t,typeof r));return r}var Bg=!1;if(za)try{var Lc={};Object.defineProperty(Lc,"passive",{get:function(){Bg=!0}}),window.addEventListener("test",Lc,Lc),window.removeEventListener("test",Lc,Lc)}catch{Bg=!1}function jk(e,t,r,n,i,a,s,o,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var f0=!1,ld=null,cd=!1,jg=null,Uk={onError:function(e){f0=!0,ld=e}};function zk(e,t,r,n,i,a,s,o,u){f0=!1,ld=null,jk.apply(Uk,arguments)}function Vk(e,t,r,n,i,a,s,o,u){if(zk.apply(this,arguments),f0){if(f0){var f=ld;f0=!1,ld=null}else throw Error(Re(198));cd||(cd=!0,jg=f)}}function bo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function t_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ey(e){if(bo(e)!==e)throw Error(Re(188))}function Gk(e){var t=e.alternate;if(!t){if(t=bo(e),t===null)throw Error(Re(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Ey(i),e;if(a===n)return Ey(i),t;a=a.sibling}throw Error(Re(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Re(189))}}if(r.alternate!==n)throw Error(Re(190))}if(r.tag!==3)throw Error(Re(188));return r.stateNode.current===r?e:t}function r_(e){return e=Gk(e),e!==null?n_(e):null}function n_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=n_(e);if(t!==null)return t;e=e.sibling}return null}var i_=ei.unstable_scheduleCallback,Ty=ei.unstable_cancelCallback,Hk=ei.unstable_shouldYield,Wk=ei.unstable_requestPaint,hr=ei.unstable_now,$k=ei.unstable_getCurrentPriorityLevel,e2=ei.unstable_ImmediatePriority,a_=ei.unstable_UserBlockingPriority,ud=ei.unstable_NormalPriority,Xk=ei.unstable_LowPriority,s_=ei.unstable_IdlePriority,Jd=null,pa=null;function Kk(e){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(Jd,e,void 0,(e.current.flags&128)===128)}catch{}}var Hi=Math.clz32?Math.clz32:qk,Yk=Math.log,Qk=Math.LN2;function qk(e){return e>>>=0,e===0?32:31-(Yk(e)/Qk|0)|0}var yf=64,_f=4194304;function r0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function fd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=r0(o):(a&=s,a!==0&&(n=r0(a)))}else s=r&~i,s!==0?n=r0(s):a!==0&&(n=r0(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Hi(t),i=1<<r,n|=e[r],t&=~i;return n}function Jk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Hi(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=Jk(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}function Ug(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function o_(){var e=yf;return yf<<=1,!(yf&4194240)&&(yf=64),e}function Pp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ou(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hi(t),e[t]=r}function e9(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Hi(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function t2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Hi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ot=0;function l_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var c_,r2,u_,f_,d_,zg=!1,Sf=[],Cs=null,Es=null,Ts=null,R0=new Map,b0=new Map,ms=[],t9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ay(e,t){switch(e){case"focusin":case"focusout":Cs=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Ts=null;break;case"pointerover":case"pointerout":R0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":b0.delete(t.pointerId)}}function Mc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=cu(t),t!==null&&r2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function r9(e,t,r,n,i){switch(t){case"focusin":return Cs=Mc(Cs,e,t,r,n,i),!0;case"dragenter":return Es=Mc(Es,e,t,r,n,i),!0;case"mouseover":return Ts=Mc(Ts,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return R0.set(a,Mc(R0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,b0.set(a,Mc(b0.get(a)||null,e,t,r,n,i)),!0}return!1}function h_(e){var t=ho(e.target);if(t!==null){var r=bo(t);if(r!==null){if(t=r.tag,t===13){if(t=t_(r),t!==null){e.blockedOn=t,d_(e.priority,function(){u_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Vg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lg=n,r.target.dispatchEvent(n),Lg=null}else return t=cu(r),t!==null&&r2(t),e.blockedOn=r,!1;t.shift()}return!0}function Py(e,t,r){Yf(e)&&r.delete(t)}function n9(){zg=!1,Cs!==null&&Yf(Cs)&&(Cs=null),Es!==null&&Yf(Es)&&(Es=null),Ts!==null&&Yf(Ts)&&(Ts=null),R0.forEach(Py),b0.forEach(Py)}function Bc(e,t){e.blockedOn===t&&(e.blockedOn=null,zg||(zg=!0,ei.unstable_scheduleCallback(ei.unstable_NormalPriority,n9)))}function I0(e){function t(i){return Bc(i,e)}if(0<Sf.length){Bc(Sf[0],e);for(var r=1;r<Sf.length;r++){var n=Sf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Cs!==null&&Bc(Cs,e),Es!==null&&Bc(Es,e),Ts!==null&&Bc(Ts,e),R0.forEach(t),b0.forEach(t),r=0;r<ms.length;r++)n=ms[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ms.length&&(r=ms[0],r.blockedOn===null);)h_(r),r.blockedOn===null&&ms.shift()}var Il=Xa.ReactCurrentBatchConfig,dd=!0;function i9(e,t,r,n){var i=Ot,a=Il.transition;Il.transition=null;try{Ot=1,n2(e,t,r,n)}finally{Ot=i,Il.transition=a}}function a9(e,t,r,n){var i=Ot,a=Il.transition;Il.transition=null;try{Ot=4,n2(e,t,r,n)}finally{Ot=i,Il.transition=a}}function n2(e,t,r,n){if(dd){var i=Vg(e,t,r,n);if(i===null)Bp(e,t,n,hd,r),Ay(e,n);else if(r9(i,e,t,r,n))n.stopPropagation();else if(Ay(e,n),t&4&&-1<t9.indexOf(e)){for(;i!==null;){var a=cu(i);if(a!==null&&c_(a),a=Vg(e,t,r,n),a===null&&Bp(e,t,n,hd,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Bp(e,t,n,null,r)}}var hd=null;function Vg(e,t,r,n){if(hd=null,e=Zm(n),e=ho(e),e!==null)if(t=bo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=t_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hd=e,null}function p_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($k()){case e2:return 1;case a_:return 4;case ud:case Xk:return 16;case s_:return 536870912;default:return 16}default:return 16}}var _s=null,i2=null,Qf=null;function g_(){if(Qf)return Qf;var e,t=i2,r=t.length,n,i="value"in _s?_s.value:_s.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return Qf=i.slice(e,1<n?1-n:void 0)}function qf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wf(){return!0}function Ny(){return!1}function ii(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?wf:Ny,this.isPropagationStopped=Ny,this}return nr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wf)},persist:function(){},isPersistent:wf}),t}var ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},a2=ii(ic),lu=nr({},ic,{view:0,detail:0}),s9=ii(lu),Np,Fp,jc,Zd=nr({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jc&&(jc&&e.type==="mousemove"?(Np=e.screenX-jc.screenX,Fp=e.screenY-jc.screenY):Fp=Np=0,jc=e),Np)},movementY:function(e){return"movementY"in e?e.movementY:Fp}}),Fy=ii(Zd),o9=nr({},Zd,{dataTransfer:0}),l9=ii(o9),c9=nr({},lu,{relatedTarget:0}),Rp=ii(c9),u9=nr({},ic,{animationName:0,elapsedTime:0,pseudoElement:0}),f9=ii(u9),d9=nr({},ic,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),h9=ii(d9),p9=nr({},ic,{data:0}),Ry=ii(p9),g9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},m9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function v9(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=x9[e])?!!t[e]:!1}function s2(){return v9}var y9=nr({},lu,{key:function(e){if(e.key){var t=g9[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?m9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s2,charCode:function(e){return e.type==="keypress"?qf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_9=ii(y9),S9=nr({},Zd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),by=ii(S9),w9=nr({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s2}),k9=ii(w9),C9=nr({},ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),E9=ii(C9),T9=nr({},Zd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),A9=ii(T9),P9=[9,13,27,32],o2=za&&"CompositionEvent"in window,d0=null;za&&"documentMode"in document&&(d0=document.documentMode);var N9=za&&"TextEvent"in window&&!d0,m_=za&&(!o2||d0&&8<d0&&11>=d0),Iy=String.fromCharCode(32),Dy=!1;function x_(e,t){switch(e){case"keyup":return P9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yl=!1;function F9(e,t){switch(e){case"compositionend":return v_(t);case"keypress":return t.which!==32?null:(Dy=!0,Iy);case"textInput":return e=t.data,e===Iy&&Dy?null:e;default:return null}}function R9(e,t){if(yl)return e==="compositionend"||!o2&&x_(e,t)?(e=g_(),Qf=i2=_s=null,yl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return m_&&t.locale!=="ko"?null:t.data;default:return null}}var b9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!b9[e.type]:t==="textarea"}function y_(e,t,r,n){Q5(n),t=pd(t,"onChange"),0<t.length&&(r=new a2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var h0=null,D0=null;function I9(e){F_(e,0)}function eh(e){var t=wl(e);if(G5(t))return e}function D9(e,t){if(e==="change")return t}var __=!1;if(za){var bp;if(za){var Ip="oninput"in document;if(!Ip){var Ly=document.createElement("div");Ly.setAttribute("oninput","return;"),Ip=typeof Ly.oninput=="function"}bp=Ip}else bp=!1;__=bp&&(!document.documentMode||9<document.documentMode)}function My(){h0&&(h0.detachEvent("onpropertychange",S_),D0=h0=null)}function S_(e){if(e.propertyName==="value"&&eh(D0)){var t=[];y_(t,D0,e,Zm(e)),e_(I9,t)}}function O9(e,t,r){e==="focusin"?(My(),h0=t,D0=r,h0.attachEvent("onpropertychange",S_)):e==="focusout"&&My()}function L9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return eh(D0)}function M9(e,t){if(e==="click")return eh(t)}function B9(e,t){if(e==="input"||e==="change")return eh(t)}function j9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yi=typeof Object.is=="function"?Object.is:j9;function O0(e,t){if(Yi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Cg.call(t,i)||!Yi(e[i],t[i]))return!1}return!0}function By(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jy(e,t){var r=By(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=By(r)}}function w_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?w_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function k_(){for(var e=window,t=od();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=od(e.document)}return t}function l2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function U9(e){var t=k_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&w_(r.ownerDocument.documentElement,r)){if(n!==null&&l2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=jy(r,a);var s=jy(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var z9=za&&"documentMode"in document&&11>=document.documentMode,_l=null,Gg=null,p0=null,Hg=!1;function Uy(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Hg||_l==null||_l!==od(n)||(n=_l,"selectionStart"in n&&l2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),p0&&O0(p0,n)||(p0=n,n=pd(Gg,"onSelect"),0<n.length&&(t=new a2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=_l)))}function kf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Sl={animationend:kf("Animation","AnimationEnd"),animationiteration:kf("Animation","AnimationIteration"),animationstart:kf("Animation","AnimationStart"),transitionend:kf("Transition","TransitionEnd")},Dp={},C_={};za&&(C_=document.createElement("div").style,"AnimationEvent"in window||(delete Sl.animationend.animation,delete Sl.animationiteration.animation,delete Sl.animationstart.animation),"TransitionEvent"in window||delete Sl.transitionend.transition);function th(e){if(Dp[e])return Dp[e];if(!Sl[e])return e;var t=Sl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in C_)return Dp[e]=t[r];return e}var E_=th("animationend"),T_=th("animationiteration"),A_=th("animationstart"),P_=th("transitionend"),N_=new Map,zy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function js(e,t){N_.set(e,t),Ro(t,[e])}for(var Op=0;Op<zy.length;Op++){var Lp=zy[Op],V9=Lp.toLowerCase(),G9=Lp[0].toUpperCase()+Lp.slice(1);js(V9,"on"+G9)}js(E_,"onAnimationEnd");js(T_,"onAnimationIteration");js(A_,"onAnimationStart");js("dblclick","onDoubleClick");js("focusin","onFocus");js("focusout","onBlur");js(P_,"onTransitionEnd");Ul("onMouseEnter",["mouseout","mouseover"]);Ul("onMouseLeave",["mouseout","mouseover"]);Ul("onPointerEnter",["pointerout","pointerover"]);Ul("onPointerLeave",["pointerout","pointerover"]);Ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var n0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H9=new Set("cancel close invalid load scroll toggle".split(" ").concat(n0));function Vy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Vk(n,t,void 0,e),e.currentTarget=null}function F_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,f=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;Vy(i,o,f),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,f=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;Vy(i,o,f),a=u}}}if(cd)throw e=jg,cd=!1,jg=null,e}function $t(e,t){var r=t[Yg];r===void 0&&(r=t[Yg]=new Set);var n=e+"__bubble";r.has(n)||(R_(t,e,2,!1),r.add(n))}function Mp(e,t,r){var n=0;t&&(n|=4),R_(r,e,n,t)}var Cf="_reactListening"+Math.random().toString(36).slice(2);function L0(e){if(!e[Cf]){e[Cf]=!0,B5.forEach(function(r){r!=="selectionchange"&&(H9.has(r)||Mp(r,!1,e),Mp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cf]||(t[Cf]=!0,Mp("selectionchange",!1,t))}}function R_(e,t,r,n){switch(p_(t)){case 1:var i=i9;break;case 4:i=a9;break;default:i=n2}r=i.bind(null,t,r,e),i=void 0,!Bg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Bp(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=ho(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}e_(function(){var f=a,d=Zm(r),p=[];e:{var m=N_.get(e);if(m!==void 0){var v=a2,g=e;switch(e){case"keypress":if(qf(r)===0)break e;case"keydown":case"keyup":v=_9;break;case"focusin":g="focus",v=Rp;break;case"focusout":g="blur",v=Rp;break;case"beforeblur":case"afterblur":v=Rp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Fy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=l9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=k9;break;case E_:case T_:case A_:v=f9;break;case P_:v=E9;break;case"scroll":v=s9;break;case"wheel":v=A9;break;case"copy":case"cut":case"paste":v=h9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=by}var y=(t&4)!==0,C=!y&&e==="scroll",E=y?m!==null?m+"Capture":null:m;y=[];for(var S=f,x;S!==null;){x=S;var T=x.stateNode;if(x.tag===5&&T!==null&&(x=T,E!==null&&(T=F0(S,E),T!=null&&y.push(M0(S,T,x)))),C)break;S=S.return}0<y.length&&(m=new v(m,g,null,r,d),p.push({event:m,listeners:y}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",m&&r!==Lg&&(g=r.relatedTarget||r.fromElement)&&(ho(g)||g[Va]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(g=r.relatedTarget||r.toElement,v=f,g=g?ho(g):null,g!==null&&(C=bo(g),g!==C||g.tag!==5&&g.tag!==6)&&(g=null)):(v=null,g=f),v!==g)){if(y=Fy,T="onMouseLeave",E="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(y=by,T="onPointerLeave",E="onPointerEnter",S="pointer"),C=v==null?m:wl(v),x=g==null?m:wl(g),m=new y(T,S+"leave",v,r,d),m.target=C,m.relatedTarget=x,T=null,ho(d)===f&&(y=new y(E,S+"enter",g,r,d),y.target=x,y.relatedTarget=C,T=y),C=T,v&&g)t:{for(y=v,E=g,S=0,x=y;x;x=ll(x))S++;for(x=0,T=E;T;T=ll(T))x++;for(;0<S-x;)y=ll(y),S--;for(;0<x-S;)E=ll(E),x--;for(;S--;){if(y===E||E!==null&&y===E.alternate)break t;y=ll(y),E=ll(E)}y=null}else y=null;v!==null&&Gy(p,m,v,y,!1),g!==null&&C!==null&&Gy(p,C,g,y,!0)}}e:{if(m=f?wl(f):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var F=D9;else if(Oy(m))if(__)F=B9;else{F=L9;var N=O9}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=M9);if(F&&(F=F(e,f))){y_(p,F,r,d);break e}N&&N(e,m,f),e==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&Rg(m,"number",m.value)}switch(N=f?wl(f):window,e){case"focusin":(Oy(N)||N.contentEditable==="true")&&(_l=N,Gg=f,p0=null);break;case"focusout":p0=Gg=_l=null;break;case"mousedown":Hg=!0;break;case"contextmenu":case"mouseup":case"dragend":Hg=!1,Uy(p,r,d);break;case"selectionchange":if(z9)break;case"keydown":case"keyup":Uy(p,r,d)}var A;if(o2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else yl?x_(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(m_&&r.locale!=="ko"&&(yl||P!=="onCompositionStart"?P==="onCompositionEnd"&&yl&&(A=g_()):(_s=d,i2="value"in _s?_s.value:_s.textContent,yl=!0)),N=pd(f,P),0<N.length&&(P=new Ry(P,e,null,r,d),p.push({event:P,listeners:N}),A?P.data=A:(A=v_(r),A!==null&&(P.data=A)))),(A=N9?F9(e,r):R9(e,r))&&(f=pd(f,"onBeforeInput"),0<f.length&&(d=new Ry("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:f}),d.data=A))}F_(p,t)})}function M0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function pd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=F0(e,r),a!=null&&n.unshift(M0(e,a,i)),a=F0(e,t),a!=null&&n.push(M0(e,a,i))),e=e.return}return n}function ll(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gy(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,f=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&f!==null&&(o=f,i?(u=F0(r,a),u!=null&&s.unshift(M0(r,u,o))):i||(u=F0(r,a),u!=null&&s.push(M0(r,u,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var W9=/\r\n?/g,$9=/\u0000|\uFFFD/g;function Hy(e){return(typeof e=="string"?e:""+e).replace(W9,`
`).replace($9,"")}function Ef(e,t,r){if(t=Hy(t),Hy(e)!==t&&r)throw Error(Re(425))}function gd(){}var Wg=null,$g=null;function Xg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Kg=typeof setTimeout=="function"?setTimeout:void 0,X9=typeof clearTimeout=="function"?clearTimeout:void 0,Wy=typeof Promise=="function"?Promise:void 0,K9=typeof queueMicrotask=="function"?queueMicrotask:typeof Wy<"u"?function(e){return Wy.resolve(null).then(e).catch(Y9)}:Kg;function Y9(e){setTimeout(function(){throw e})}function jp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),I0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);I0(t)}function As(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $y(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ac=Math.random().toString(36).slice(2),da="__reactFiber$"+ac,B0="__reactProps$"+ac,Va="__reactContainer$"+ac,Yg="__reactEvents$"+ac,Q9="__reactListeners$"+ac,q9="__reactHandles$"+ac;function ho(e){var t=e[da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Va]||r[da]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$y(e);e!==null;){if(r=e[da])return r;e=$y(e)}return t}e=r,r=e.parentNode}return null}function cu(e){return e=e[da]||e[Va],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Re(33))}function rh(e){return e[B0]||null}var Qg=[],kl=-1;function Us(e){return{current:e}}function Xt(e){0>kl||(e.current=Qg[kl],Qg[kl]=null,kl--)}function Gt(e,t){kl++,Qg[kl]=e.current,e.current=t}var Ds={},mn=Us(Ds),Vn=Us(!1),wo=Ds;function zl(e,t){var r=e.type.contextTypes;if(!r)return Ds;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Gn(e){return e=e.childContextTypes,e!=null}function md(){Xt(Vn),Xt(mn)}function Xy(e,t,r){if(mn.current!==Ds)throw Error(Re(168));Gt(mn,t),Gt(Vn,r)}function b_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Re(108,Ok(e)||"Unknown",i));return nr({},r,n)}function xd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ds,wo=mn.current,Gt(mn,e),Gt(Vn,Vn.current),!0}function Ky(e,t,r){var n=e.stateNode;if(!n)throw Error(Re(169));r?(e=b_(e,t,wo),n.__reactInternalMemoizedMergedChildContext=e,Xt(Vn),Xt(mn),Gt(mn,e)):Xt(Vn),Gt(Vn,r)}var ba=null,nh=!1,Up=!1;function I_(e){ba===null?ba=[e]:ba.push(e)}function J9(e){nh=!0,I_(e)}function zs(){if(!Up&&ba!==null){Up=!0;var e=0,t=Ot;try{var r=ba;for(Ot=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ba=null,nh=!1}catch(i){throw ba!==null&&(ba=ba.slice(e+1)),i_(e2,zs),i}finally{Ot=t,Up=!1}}return null}var Cl=[],El=0,vd=null,yd=0,vi=[],yi=0,ko=null,Da=1,Oa="";function lo(e,t){Cl[El++]=yd,Cl[El++]=vd,vd=e,yd=t}function D_(e,t,r){vi[yi++]=Da,vi[yi++]=Oa,vi[yi++]=ko,ko=e;var n=Da;e=Oa;var i=32-Hi(n)-1;n&=~(1<<i),r+=1;var a=32-Hi(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Da=1<<32-Hi(t)+i|r<<i|n,Oa=a+e}else Da=1<<a|r<<i|n,Oa=e}function c2(e){e.return!==null&&(lo(e,1),D_(e,1,0))}function u2(e){for(;e===vd;)vd=Cl[--El],Cl[El]=null,yd=Cl[--El],Cl[El]=null;for(;e===ko;)ko=vi[--yi],vi[yi]=null,Oa=vi[--yi],vi[yi]=null,Da=vi[--yi],vi[yi]=null}var Zn=null,Jn=null,qt=!1,Ui=null;function O_(e,t){var r=Si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=As(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ko!==null?{id:Da,overflow:Oa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Zn=e,Jn=null,!0):!1;default:return!1}}function qg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Jg(e){if(qt){var t=Jn;if(t){var r=t;if(!Yy(e,t)){if(qg(e))throw Error(Re(418));t=As(r.nextSibling);var n=Zn;t&&Yy(e,t)?O_(n,r):(e.flags=e.flags&-4097|2,qt=!1,Zn=e)}}else{if(qg(e))throw Error(Re(418));e.flags=e.flags&-4097|2,qt=!1,Zn=e}}}function Qy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zn=e}function Tf(e){if(e!==Zn)return!1;if(!qt)return Qy(e),qt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xg(e.type,e.memoizedProps)),t&&(t=Jn)){if(qg(e))throw L_(),Error(Re(418));for(;t;)O_(e,t),t=As(t.nextSibling)}if(Qy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Jn=As(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Jn=null}}else Jn=Zn?As(e.stateNode.nextSibling):null;return!0}function L_(){for(var e=Jn;e;)e=As(e.nextSibling)}function Vl(){Jn=Zn=null,qt=!1}function f2(e){Ui===null?Ui=[e]:Ui.push(e)}var Z9=Xa.ReactCurrentBatchConfig;function Uc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Re(309));var n=r.stateNode}if(!n)throw Error(Re(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(Re(284));if(!r._owner)throw Error(Re(290,e))}return e}function Af(e,t){throw e=Object.prototype.toString.call(t),Error(Re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function qy(e){var t=e._init;return t(e._payload)}function M_(e){function t(E,S){if(e){var x=E.deletions;x===null?(E.deletions=[S],E.flags|=16):x.push(S)}}function r(E,S){if(!e)return null;for(;S!==null;)t(E,S),S=S.sibling;return null}function n(E,S){for(E=new Map;S!==null;)S.key!==null?E.set(S.key,S):E.set(S.index,S),S=S.sibling;return E}function i(E,S){return E=Rs(E,S),E.index=0,E.sibling=null,E}function a(E,S,x){return E.index=x,e?(x=E.alternate,x!==null?(x=x.index,x<S?(E.flags|=2,S):x):(E.flags|=2,S)):(E.flags|=1048576,S)}function s(E){return e&&E.alternate===null&&(E.flags|=2),E}function o(E,S,x,T){return S===null||S.tag!==6?(S=Xp(x,E.mode,T),S.return=E,S):(S=i(S,x),S.return=E,S)}function u(E,S,x,T){var F=x.type;return F===vl?d(E,S,x.props.children,T,x.key):S!==null&&(S.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ps&&qy(F)===S.type)?(T=i(S,x.props),T.ref=Uc(E,S,x),T.return=E,T):(T=id(x.type,x.key,x.props,null,E.mode,T),T.ref=Uc(E,S,x),T.return=E,T)}function f(E,S,x,T){return S===null||S.tag!==4||S.stateNode.containerInfo!==x.containerInfo||S.stateNode.implementation!==x.implementation?(S=Kp(x,E.mode,T),S.return=E,S):(S=i(S,x.children||[]),S.return=E,S)}function d(E,S,x,T,F){return S===null||S.tag!==7?(S=yo(x,E.mode,T,F),S.return=E,S):(S=i(S,x),S.return=E,S)}function p(E,S,x){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Xp(""+S,E.mode,x),S.return=E,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case mf:return x=id(S.type,S.key,S.props,null,E.mode,x),x.ref=Uc(E,null,S),x.return=E,x;case xl:return S=Kp(S,E.mode,x),S.return=E,S;case ps:var T=S._init;return p(E,T(S._payload),x)}if(t0(S)||Oc(S))return S=yo(S,E.mode,x,null),S.return=E,S;Af(E,S)}return null}function m(E,S,x,T){var F=S!==null?S.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return F!==null?null:o(E,S,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case mf:return x.key===F?u(E,S,x,T):null;case xl:return x.key===F?f(E,S,x,T):null;case ps:return F=x._init,m(E,S,F(x._payload),T)}if(t0(x)||Oc(x))return F!==null?null:d(E,S,x,T,null);Af(E,x)}return null}function v(E,S,x,T,F){if(typeof T=="string"&&T!==""||typeof T=="number")return E=E.get(x)||null,o(S,E,""+T,F);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case mf:return E=E.get(T.key===null?x:T.key)||null,u(S,E,T,F);case xl:return E=E.get(T.key===null?x:T.key)||null,f(S,E,T,F);case ps:var N=T._init;return v(E,S,x,N(T._payload),F)}if(t0(T)||Oc(T))return E=E.get(x)||null,d(S,E,T,F,null);Af(S,T)}return null}function g(E,S,x,T){for(var F=null,N=null,A=S,P=S=0,b=null;A!==null&&P<x.length;P++){A.index>P?(b=A,A=null):b=A.sibling;var I=m(E,A,x[P],T);if(I===null){A===null&&(A=b);break}e&&A&&I.alternate===null&&t(E,A),S=a(I,S,P),N===null?F=I:N.sibling=I,N=I,A=b}if(P===x.length)return r(E,A),qt&&lo(E,P),F;if(A===null){for(;P<x.length;P++)A=p(E,x[P],T),A!==null&&(S=a(A,S,P),N===null?F=A:N.sibling=A,N=A);return qt&&lo(E,P),F}for(A=n(E,A);P<x.length;P++)b=v(A,E,P,x[P],T),b!==null&&(e&&b.alternate!==null&&A.delete(b.key===null?P:b.key),S=a(b,S,P),N===null?F=b:N.sibling=b,N=b);return e&&A.forEach(function(O){return t(E,O)}),qt&&lo(E,P),F}function y(E,S,x,T){var F=Oc(x);if(typeof F!="function")throw Error(Re(150));if(x=F.call(x),x==null)throw Error(Re(151));for(var N=F=null,A=S,P=S=0,b=null,I=x.next();A!==null&&!I.done;P++,I=x.next()){A.index>P?(b=A,A=null):b=A.sibling;var O=m(E,A,I.value,T);if(O===null){A===null&&(A=b);break}e&&A&&O.alternate===null&&t(E,A),S=a(O,S,P),N===null?F=O:N.sibling=O,N=O,A=b}if(I.done)return r(E,A),qt&&lo(E,P),F;if(A===null){for(;!I.done;P++,I=x.next())I=p(E,I.value,T),I!==null&&(S=a(I,S,P),N===null?F=I:N.sibling=I,N=I);return qt&&lo(E,P),F}for(A=n(E,A);!I.done;P++,I=x.next())I=v(A,E,P,I.value,T),I!==null&&(e&&I.alternate!==null&&A.delete(I.key===null?P:I.key),S=a(I,S,P),N===null?F=I:N.sibling=I,N=I);return e&&A.forEach(function(j){return t(E,j)}),qt&&lo(E,P),F}function C(E,S,x,T){if(typeof x=="object"&&x!==null&&x.type===vl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case mf:e:{for(var F=x.key,N=S;N!==null;){if(N.key===F){if(F=x.type,F===vl){if(N.tag===7){r(E,N.sibling),S=i(N,x.props.children),S.return=E,E=S;break e}}else if(N.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ps&&qy(F)===N.type){r(E,N.sibling),S=i(N,x.props),S.ref=Uc(E,N,x),S.return=E,E=S;break e}r(E,N);break}else t(E,N);N=N.sibling}x.type===vl?(S=yo(x.props.children,E.mode,T,x.key),S.return=E,E=S):(T=id(x.type,x.key,x.props,null,E.mode,T),T.ref=Uc(E,S,x),T.return=E,E=T)}return s(E);case xl:e:{for(N=x.key;S!==null;){if(S.key===N)if(S.tag===4&&S.stateNode.containerInfo===x.containerInfo&&S.stateNode.implementation===x.implementation){r(E,S.sibling),S=i(S,x.children||[]),S.return=E,E=S;break e}else{r(E,S);break}else t(E,S);S=S.sibling}S=Kp(x,E.mode,T),S.return=E,E=S}return s(E);case ps:return N=x._init,C(E,S,N(x._payload),T)}if(t0(x))return g(E,S,x,T);if(Oc(x))return y(E,S,x,T);Af(E,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,S!==null&&S.tag===6?(r(E,S.sibling),S=i(S,x),S.return=E,E=S):(r(E,S),S=Xp(x,E.mode,T),S.return=E,E=S),s(E)):r(E,S)}return C}var Gl=M_(!0),B_=M_(!1),_d=Us(null),Sd=null,Tl=null,d2=null;function h2(){d2=Tl=Sd=null}function p2(e){var t=_d.current;Xt(_d),e._currentValue=t}function Zg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Dl(e,t){Sd=e,d2=Tl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zn=!0),e.firstContext=null)}function ki(e){var t=e._currentValue;if(d2!==e)if(e={context:e,memoizedValue:t,next:null},Tl===null){if(Sd===null)throw Error(Re(308));Tl=e,Sd.dependencies={lanes:0,firstContext:e}}else Tl=Tl.next=e;return t}var po=null;function g2(e){po===null?po=[e]:po.push(e)}function j_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,g2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ga(e,n)}function Ga(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var gs=!1;function m2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ma(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ps(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ct&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ga(e,r)}return i=n.interleaved,i===null?(t.next=t,g2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ga(e,r)}function Jf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,t2(e,r)}}function Jy(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wd(e,t,r,n){var i=e.updateQueue;gs=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,f=u.next;u.next=null,s===null?a=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=f:o.next=f,d.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;s=0,d=f=u=null,o=a;do{var m=o.lane,v=o.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,y=o;switch(m=t,v=r,y.tag){case 1:if(g=y.payload,typeof g=="function"){p=g.call(v,p,m);break e}p=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,m=typeof g=="function"?g.call(v,p,m):g,m==null)break e;p=nr({},p,m);break e;case 2:gs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[o]:m.push(o))}else v={eventTime:v,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(f=d=v,u=p):d=d.next=v,s|=m;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Eo|=s,e.lanes=s,e.memoizedState=p}}function Zy(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Re(191,i));i.call(n)}}}var uu={},ga=Us(uu),j0=Us(uu),U0=Us(uu);function go(e){if(e===uu)throw Error(Re(174));return e}function x2(e,t){switch(Gt(U0,t),Gt(j0,e),Gt(ga,uu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ig(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ig(t,e)}Xt(ga),Gt(ga,t)}function Hl(){Xt(ga),Xt(j0),Xt(U0)}function z_(e){go(U0.current);var t=go(ga.current),r=Ig(t,e.type);t!==r&&(Gt(j0,e),Gt(ga,r))}function v2(e){j0.current===e&&(Xt(ga),Xt(j0))}var tr=Us(0);function kd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zp=[];function y2(){for(var e=0;e<zp.length;e++)zp[e]._workInProgressVersionPrimary=null;zp.length=0}var Zf=Xa.ReactCurrentDispatcher,Vp=Xa.ReactCurrentBatchConfig,Co=0,rr=null,Nr=null,Gr=null,Cd=!1,g0=!1,z0=0,eC=0;function ln(){throw Error(Re(321))}function _2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yi(e[r],t[r]))return!1;return!0}function S2(e,t,r,n,i,a){if(Co=a,rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zf.current=e===null||e.memoizedState===null?iC:aC,e=r(n,i),g0){a=0;do{if(g0=!1,z0=0,25<=a)throw Error(Re(301));a+=1,Gr=Nr=null,t.updateQueue=null,Zf.current=sC,e=r(n,i)}while(g0)}if(Zf.current=Ed,t=Nr!==null&&Nr.next!==null,Co=0,Gr=Nr=rr=null,Cd=!1,t)throw Error(Re(300));return e}function w2(){var e=z0!==0;return z0=0,e}function fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?rr.memoizedState=Gr=e:Gr=Gr.next=e,Gr}function Ci(){if(Nr===null){var e=rr.alternate;e=e!==null?e.memoizedState:null}else e=Nr.next;var t=Gr===null?rr.memoizedState:Gr.next;if(t!==null)Gr=t,Nr=e;else{if(e===null)throw Error(Re(310));Nr=e,e={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Gr===null?rr.memoizedState=Gr=e:Gr=Gr.next=e}return Gr}function V0(e,t){return typeof t=="function"?t(e):t}function Gp(e){var t=Ci(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=Nr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,f=a;do{var d=f.lane;if((Co&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(o=u=p,s=n):u=u.next=p,rr.lanes|=d,Eo|=d}f=f.next}while(f!==null&&f!==a);u===null?s=n:u.next=o,Yi(n,t.memoizedState)||(zn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,rr.lanes|=a,Eo|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Hp(e){var t=Ci(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Yi(a,t.memoizedState)||(zn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function V_(){}function G_(e,t){var r=rr,n=Ci(),i=t(),a=!Yi(n.memoizedState,i);if(a&&(n.memoizedState=i,zn=!0),n=n.queue,k2($_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Gr!==null&&Gr.memoizedState.tag&1){if(r.flags|=2048,G0(9,W_.bind(null,r,n,i,t),void 0,null),Hr===null)throw Error(Re(349));Co&30||H_(r,t,i)}return i}function H_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function W_(e,t,r,n){t.value=r,t.getSnapshot=n,X_(t)&&K_(e)}function $_(e,t,r){return r(function(){X_(t)&&K_(e)})}function X_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yi(e,r)}catch{return!0}}function K_(e){var t=Ga(e,1);t!==null&&Wi(t,e,1,-1)}function e4(e){var t=fa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:V0,lastRenderedState:e},t.queue=e,e=e.dispatch=nC.bind(null,rr,e),[t.memoizedState,e]}function G0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Y_(){return Ci().memoizedState}function ed(e,t,r,n){var i=fa();rr.flags|=e,i.memoizedState=G0(1|t,r,void 0,n===void 0?null:n)}function ih(e,t,r,n){var i=Ci();n=n===void 0?null:n;var a=void 0;if(Nr!==null){var s=Nr.memoizedState;if(a=s.destroy,n!==null&&_2(n,s.deps)){i.memoizedState=G0(t,r,a,n);return}}rr.flags|=e,i.memoizedState=G0(1|t,r,a,n)}function t4(e,t){return ed(8390656,8,e,t)}function k2(e,t){return ih(2048,8,e,t)}function Q_(e,t){return ih(4,2,e,t)}function q_(e,t){return ih(4,4,e,t)}function J_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Z_(e,t,r){return r=r!=null?r.concat([e]):null,ih(4,4,J_.bind(null,t,e),r)}function C2(){}function e6(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function t6(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&_2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function r6(e,t,r){return Co&21?(Yi(r,t)||(r=o_(),rr.lanes|=r,Eo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zn=!0),e.memoizedState=r)}function tC(e,t){var r=Ot;Ot=r!==0&&4>r?r:4,e(!0);var n=Vp.transition;Vp.transition={};try{e(!1),t()}finally{Ot=r,Vp.transition=n}}function n6(){return Ci().memoizedState}function rC(e,t,r){var n=Fs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},i6(e))a6(t,r);else if(r=j_(e,t,r,n),r!==null){var i=An();Wi(r,e,n,i),s6(r,t,n)}}function nC(e,t,r){var n=Fs(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(i6(e))a6(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Yi(o,s)){var u=t.interleaved;u===null?(i.next=i,g2(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=j_(e,t,i,n),r!==null&&(i=An(),Wi(r,e,n,i),s6(r,t,n))}}function i6(e){var t=e.alternate;return e===rr||t!==null&&t===rr}function a6(e,t){g0=Cd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function s6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,t2(e,r)}}var Ed={readContext:ki,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useInsertionEffect:ln,useLayoutEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useMutableSource:ln,useSyncExternalStore:ln,useId:ln,unstable_isNewReconciler:!1},iC={readContext:ki,useCallback:function(e,t){return fa().memoizedState=[e,t===void 0?null:t],e},useContext:ki,useEffect:t4,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ed(4194308,4,J_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ed(4194308,4,e,t)},useInsertionEffect:function(e,t){return ed(4,2,e,t)},useMemo:function(e,t){var r=fa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=rC.bind(null,rr,e),[n.memoizedState,e]},useRef:function(e){var t=fa();return e={current:e},t.memoizedState=e},useState:e4,useDebugValue:C2,useDeferredValue:function(e){return fa().memoizedState=e},useTransition:function(){var e=e4(!1),t=e[0];return e=tC.bind(null,e[1]),fa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rr,i=fa();if(qt){if(r===void 0)throw Error(Re(407));r=r()}else{if(r=t(),Hr===null)throw Error(Re(349));Co&30||H_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,t4($_.bind(null,n,a,e),[e]),n.flags|=2048,G0(9,W_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=fa(),t=Hr.identifierPrefix;if(qt){var r=Oa,n=Da;r=(n&~(1<<32-Hi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=z0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=eC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},aC={readContext:ki,useCallback:e6,useContext:ki,useEffect:k2,useImperativeHandle:Z_,useInsertionEffect:Q_,useLayoutEffect:q_,useMemo:t6,useReducer:Gp,useRef:Y_,useState:function(){return Gp(V0)},useDebugValue:C2,useDeferredValue:function(e){var t=Ci();return r6(t,Nr.memoizedState,e)},useTransition:function(){var e=Gp(V0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:V_,useSyncExternalStore:G_,useId:n6,unstable_isNewReconciler:!1},sC={readContext:ki,useCallback:e6,useContext:ki,useEffect:k2,useImperativeHandle:Z_,useInsertionEffect:Q_,useLayoutEffect:q_,useMemo:t6,useReducer:Hp,useRef:Y_,useState:function(){return Hp(V0)},useDebugValue:C2,useDeferredValue:function(e){var t=Ci();return Nr===null?t.memoizedState=e:r6(t,Nr.memoizedState,e)},useTransition:function(){var e=Hp(V0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:V_,useSyncExternalStore:G_,useId:n6,unstable_isNewReconciler:!1};function Bi(e,t){if(e&&e.defaultProps){t=nr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function em(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ah={isMounted:function(e){return(e=e._reactInternals)?bo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=An(),i=Fs(e),a=Ma(n,i);a.payload=t,r!=null&&(a.callback=r),t=Ps(e,a,i),t!==null&&(Wi(t,e,i,n),Jf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=An(),i=Fs(e),a=Ma(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ps(e,a,i),t!==null&&(Wi(t,e,i,n),Jf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=An(),n=Fs(e),i=Ma(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ps(e,i,n),t!==null&&(Wi(t,e,n,r),Jf(t,e,n))}};function r4(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!O0(r,n)||!O0(i,a):!0}function o6(e,t,r){var n=!1,i=Ds,a=t.contextType;return typeof a=="object"&&a!==null?a=ki(a):(i=Gn(t)?wo:mn.current,n=t.contextTypes,a=(n=n!=null)?zl(e,i):Ds),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ah,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function n4(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ah.enqueueReplaceState(t,t.state,null)}function tm(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},m2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=ki(a):(a=Gn(t)?wo:mn.current,i.context=zl(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(em(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ah.enqueueReplaceState(i,i.state,null),wd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Wl(e,t){try{var r="",n=t;do r+=Dk(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Wp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function rm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var oC=typeof WeakMap=="function"?WeakMap:Map;function l6(e,t,r){r=Ma(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ad||(Ad=!0,dm=n),rm(e,t)},r}function c6(e,t,r){r=Ma(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){rm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){rm(e,t),typeof n!="function"&&(Ns===null?Ns=new Set([this]):Ns.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function i4(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new oC;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=SC.bind(null,e,t,r),t.then(e,e))}function a4(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function s4(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ma(-1,1),t.tag=2,Ps(r,t,1))),r.lanes|=1),e)}var lC=Xa.ReactCurrentOwner,zn=!1;function wn(e,t,r,n){t.child=e===null?B_(t,null,r,n):Gl(t,e.child,r,n)}function o4(e,t,r,n,i){r=r.render;var a=t.ref;return Dl(t,i),n=S2(e,t,r,n,a,i),r=w2(),e!==null&&!zn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i)):(qt&&r&&c2(t),t.flags|=1,wn(e,t,n,i),t.child)}function l4(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!b2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,u6(e,t,a,n,i)):(e=id(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:O0,r(s,n)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,e=Rs(a,n),e.ref=t.ref,e.return=t,t.child=e}function u6(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(O0(a,n)&&e.ref===t.ref)if(zn=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(zn=!0);else return t.lanes=e.lanes,Ha(e,t,i)}return nm(e,t,r,n,i)}function f6(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Pl,Yn),Yn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Gt(Pl,Yn),Yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Gt(Pl,Yn),Yn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Gt(Pl,Yn),Yn|=n;return wn(e,t,i,r),t.child}function d6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function nm(e,t,r,n,i){var a=Gn(r)?wo:mn.current;return a=zl(t,a),Dl(t,i),r=S2(e,t,r,n,a,i),n=w2(),e!==null&&!zn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i)):(qt&&n&&c2(t),t.flags|=1,wn(e,t,r,i),t.child)}function c4(e,t,r,n,i){if(Gn(r)){var a=!0;xd(t)}else a=!1;if(Dl(t,i),t.stateNode===null)td(e,t),o6(t,r,n),tm(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=ki(f):(f=Gn(r)?wo:mn.current,f=zl(t,f));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==f)&&n4(t,s,n,f),gs=!1;var m=t.memoizedState;s.state=m,wd(t,n,s,i),u=t.memoizedState,o!==n||m!==u||Vn.current||gs?(typeof d=="function"&&(em(t,r,d,n),u=t.memoizedState),(o=gs||r4(t,r,o,n,m,u,f))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=f,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,U_(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:Bi(t.type,o),s.props=f,p=t.pendingProps,m=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=ki(u):(u=Gn(r)?wo:mn.current,u=zl(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==p||m!==u)&&n4(t,s,n,u),gs=!1,m=t.memoizedState,s.state=m,wd(t,n,s,i);var g=t.memoizedState;o!==p||m!==g||Vn.current||gs?(typeof v=="function"&&(em(t,r,v,n),g=t.memoizedState),(f=gs||r4(t,r,f,n,m,g,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),s.props=n,s.state=g,s.context=u,n=f):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return im(e,t,r,n,a,i)}function im(e,t,r,n,i,a){d6(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&Ky(t,r,!1),Ha(e,t,a);n=t.stateNode,lC.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Gl(t,e.child,null,a),t.child=Gl(t,null,o,a)):wn(e,t,o,a),t.memoizedState=n.state,i&&Ky(t,r,!0),t.child}function h6(e){var t=e.stateNode;t.pendingContext?Xy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Xy(e,t.context,!1),x2(e,t.containerInfo)}function u4(e,t,r,n,i){return Vl(),f2(i),t.flags|=256,wn(e,t,r,n),t.child}var am={dehydrated:null,treeContext:null,retryLane:0};function sm(e){return{baseLanes:e,cachePool:null,transitions:null}}function p6(e,t,r){var n=t.pendingProps,i=tr.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Gt(tr,i&1),e===null)return Jg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=lh(s,n,0,null),e=yo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=sm(r),t.memoizedState=am,e):E2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return cC(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Rs(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Rs(o,a):(a=yo(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?sm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=am,n}return a=e.child,e=a.sibling,n=Rs(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function E2(e,t){return t=lh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pf(e,t,r,n){return n!==null&&f2(n),Gl(t,e.child,null,r),e=E2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cC(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=Wp(Error(Re(422))),Pf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=lh({mode:"visible",children:n.children},i,0,null),a=yo(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Gl(t,e.child,null,s),t.child.memoizedState=sm(s),t.memoizedState=am,a);if(!(t.mode&1))return Pf(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Re(419)),n=Wp(a,n,void 0),Pf(e,t,s,n)}if(o=(s&e.childLanes)!==0,zn||o){if(n=Hr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ga(e,i),Wi(n,e,i,-1))}return R2(),n=Wp(Error(Re(421))),Pf(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=wC.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Jn=As(i.nextSibling),Zn=t,qt=!0,Ui=null,e!==null&&(vi[yi++]=Da,vi[yi++]=Oa,vi[yi++]=ko,Da=e.id,Oa=e.overflow,ko=t),t=E2(t,n.children),t.flags|=4096,t)}function f4(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Zg(e.return,t,r)}function $p(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function g6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wn(e,t,n.children,r),n=tr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&f4(e,r,t);else if(e.tag===19)f4(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Gt(tr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&kd(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),$p(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&kd(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}$p(t,!0,r,null,a);break;case"together":$p(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function td(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Eo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Re(153));if(t.child!==null){for(e=t.child,r=Rs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Rs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function uC(e,t,r){switch(t.tag){case 3:h6(t),Vl();break;case 5:z_(t);break;case 1:Gn(t.type)&&xd(t);break;case 4:x2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Gt(_d,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Gt(tr,tr.current&1),t.flags|=128,null):r&t.child.childLanes?p6(e,t,r):(Gt(tr,tr.current&1),e=Ha(e,t,r),e!==null?e.sibling:null);Gt(tr,tr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return g6(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Gt(tr,tr.current),n)break;return null;case 22:case 23:return t.lanes=0,f6(e,t,r)}return Ha(e,t,r)}var m6,om,x6,v6;m6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};om=function(){};x6=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,go(ga.current);var a=null;switch(r){case"input":i=Ng(e,i),n=Ng(e,n),a=[];break;case"select":i=nr({},i,{value:void 0}),n=nr({},n,{value:void 0}),a=[];break;case"textarea":i=bg(e,i),n=bg(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=gd)}Dg(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var o=i[f];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(P0.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(o=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==o&&(u!=null||o!=null))if(f==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(P0.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&$t("scroll",e),a||o===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};v6=function(e,t,r,n){r!==n&&(t.flags|=4)};function zc(e,t){if(!qt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function fC(e,t,r){var n=t.pendingProps;switch(u2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return Gn(t.type)&&md(),cn(t),null;case 3:return n=t.stateNode,Hl(),Xt(Vn),Xt(mn),y2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Tf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ui!==null&&(gm(Ui),Ui=null))),om(e,t),cn(t),null;case 5:v2(t);var i=go(U0.current);if(r=t.type,e!==null&&t.stateNode!=null)x6(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Re(166));return cn(t),null}if(e=go(ga.current),Tf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[da]=t,n[B0]=a,e=(t.mode&1)!==0,r){case"dialog":$t("cancel",n),$t("close",n);break;case"iframe":case"object":case"embed":$t("load",n);break;case"video":case"audio":for(i=0;i<n0.length;i++)$t(n0[i],n);break;case"source":$t("error",n);break;case"img":case"image":case"link":$t("error",n),$t("load",n);break;case"details":$t("toggle",n);break;case"input":_y(n,a),$t("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},$t("invalid",n);break;case"textarea":wy(n,a),$t("invalid",n)}Dg(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Ef(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Ef(n.textContent,o,e),i=["children",""+o]):P0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&$t("scroll",n)}switch(r){case"input":xf(n),Sy(n,a,!0);break;case"textarea":xf(n),ky(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=gd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[da]=t,e[B0]=n,m6(e,t,!1,!1),t.stateNode=e;e:{switch(s=Og(r,n),r){case"dialog":$t("cancel",e),$t("close",e),i=n;break;case"iframe":case"object":case"embed":$t("load",e),i=n;break;case"video":case"audio":for(i=0;i<n0.length;i++)$t(n0[i],e);i=n;break;case"source":$t("error",e),i=n;break;case"img":case"image":case"link":$t("error",e),$t("load",e),i=n;break;case"details":$t("toggle",e),i=n;break;case"input":_y(e,n),i=Ng(e,n),$t("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=nr({},n,{value:void 0}),$t("invalid",e);break;case"textarea":wy(e,n),i=bg(e,n),$t("invalid",e);break;default:i=n}Dg(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?Y5(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&X5(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&N0(e,u):typeof u=="number"&&N0(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(P0.hasOwnProperty(a)?u!=null&&a==="onScroll"&&$t("scroll",e):u!=null&&Ym(e,a,u,s))}switch(r){case"input":xf(e),Sy(e,n,!1);break;case"textarea":xf(e),ky(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Is(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Fl(e,!!n.multiple,a,!1):n.defaultValue!=null&&Fl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=gd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cn(t),null;case 6:if(e&&t.stateNode!=null)v6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Re(166));if(r=go(U0.current),go(ga.current),Tf(t)){if(n=t.stateNode,r=t.memoizedProps,n[da]=t,(a=n.nodeValue!==r)&&(e=Zn,e!==null))switch(e.tag){case 3:Ef(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ef(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[da]=t,t.stateNode=n}return cn(t),null;case 13:if(Xt(tr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qt&&Jn!==null&&t.mode&1&&!(t.flags&128))L_(),Vl(),t.flags|=98560,a=!1;else if(a=Tf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Re(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Re(317));a[da]=t}else Vl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cn(t),a=!1}else Ui!==null&&(gm(Ui),Ui=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tr.current&1?Fr===0&&(Fr=3):R2())),t.updateQueue!==null&&(t.flags|=4),cn(t),null);case 4:return Hl(),om(e,t),e===null&&L0(t.stateNode.containerInfo),cn(t),null;case 10:return p2(t.type._context),cn(t),null;case 17:return Gn(t.type)&&md(),cn(t),null;case 19:if(Xt(tr),a=t.memoizedState,a===null)return cn(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)zc(a,!1);else{if(Fr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=kd(e),s!==null){for(t.flags|=128,zc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Gt(tr,tr.current&1|2),t.child}e=e.sibling}a.tail!==null&&hr()>$l&&(t.flags|=128,n=!0,zc(a,!1),t.lanes=4194304)}else{if(!n)if(e=kd(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),zc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!qt)return cn(t),null}else 2*hr()-a.renderingStartTime>$l&&r!==1073741824&&(t.flags|=128,n=!0,zc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=hr(),t.sibling=null,r=tr.current,Gt(tr,n?r&1|2:r&1),t):(cn(t),null);case 22:case 23:return F2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yn&1073741824&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),null;case 24:return null;case 25:return null}throw Error(Re(156,t.tag))}function dC(e,t){switch(u2(t),t.tag){case 1:return Gn(t.type)&&md(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hl(),Xt(Vn),Xt(mn),y2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return v2(t),null;case 13:if(Xt(tr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Re(340));Vl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Xt(tr),null;case 4:return Hl(),null;case 10:return p2(t.type._context),null;case 22:case 23:return F2(),null;case 24:return null;default:return null}}var Nf=!1,dn=!1,hC=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Al(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){sr(e,t,n)}else r.current=null}function lm(e,t,r){try{r()}catch(n){sr(e,t,n)}}var d4=!1;function pC(e,t){if(Wg=dd,e=k_(),l2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,f=0,d=0,p=e,m=null;t:for(;;){for(var v;p!==r||i!==0&&p.nodeType!==3||(o=s+i),p!==a||n!==0&&p.nodeType!==3||(u=s+n),p.nodeType===3&&(s+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===e)break t;if(m===r&&++f===i&&(o=s),m===a&&++d===n&&(u=s),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for($g={focusedElem:e,selectionRange:r},dd=!1,$e=t;$e!==null;)if(t=$e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$e=e;else for(;$e!==null;){t=$e;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,C=g.memoizedState,E=t.stateNode,S=E.getSnapshotBeforeUpdate(t.elementType===t.type?y:Bi(t.type,y),C);E.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(T){sr(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,$e=e;break}$e=t.return}return g=d4,d4=!1,g}function m0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&lm(t,r,a)}i=i.next}while(i!==n)}}function sh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function cm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function y6(e){var t=e.alternate;t!==null&&(e.alternate=null,y6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[da],delete t[B0],delete t[Yg],delete t[Q9],delete t[q9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _6(e){return e.tag===5||e.tag===3||e.tag===4}function h4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function um(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=gd));else if(n!==4&&(e=e.child,e!==null))for(um(e,t,r),e=e.sibling;e!==null;)um(e,t,r),e=e.sibling}function fm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(fm(e,t,r),e=e.sibling;e!==null;)fm(e,t,r),e=e.sibling}var Kr=null,ji=!1;function us(e,t,r){for(r=r.child;r!==null;)S6(e,t,r),r=r.sibling}function S6(e,t,r){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(Jd,r)}catch{}switch(r.tag){case 5:dn||Al(r,t);case 6:var n=Kr,i=ji;Kr=null,us(e,t,r),Kr=n,ji=i,Kr!==null&&(ji?(e=Kr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Kr.removeChild(r.stateNode));break;case 18:Kr!==null&&(ji?(e=Kr,r=r.stateNode,e.nodeType===8?jp(e.parentNode,r):e.nodeType===1&&jp(e,r),I0(e)):jp(Kr,r.stateNode));break;case 4:n=Kr,i=ji,Kr=r.stateNode.containerInfo,ji=!0,us(e,t,r),Kr=n,ji=i;break;case 0:case 11:case 14:case 15:if(!dn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&lm(r,t,s),i=i.next}while(i!==n)}us(e,t,r);break;case 1:if(!dn&&(Al(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){sr(r,t,o)}us(e,t,r);break;case 21:us(e,t,r);break;case 22:r.mode&1?(dn=(n=dn)||r.memoizedState!==null,us(e,t,r),dn=n):us(e,t,r);break;default:us(e,t,r)}}function p4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new hC),t.forEach(function(n){var i=kC.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Di(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Kr=o.stateNode,ji=!1;break e;case 3:Kr=o.stateNode.containerInfo,ji=!0;break e;case 4:Kr=o.stateNode.containerInfo,ji=!0;break e}o=o.return}if(Kr===null)throw Error(Re(160));S6(a,s,i),Kr=null,ji=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){sr(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)w6(t,e),t=t.sibling}function w6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Di(t,e),oa(e),n&4){try{m0(3,e,e.return),sh(3,e)}catch(y){sr(e,e.return,y)}try{m0(5,e,e.return)}catch(y){sr(e,e.return,y)}}break;case 1:Di(t,e),oa(e),n&512&&r!==null&&Al(r,r.return);break;case 5:if(Di(t,e),oa(e),n&512&&r!==null&&Al(r,r.return),e.flags&32){var i=e.stateNode;try{N0(i,"")}catch(y){sr(e,e.return,y)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&H5(i,a),Og(o,s);var f=Og(o,a);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];d==="style"?Y5(i,p):d==="dangerouslySetInnerHTML"?X5(i,p):d==="children"?N0(i,p):Ym(i,d,p,f)}switch(o){case"input":Fg(i,a);break;case"textarea":W5(i,a);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Fl(i,!!a.multiple,v,!1):m!==!!a.multiple&&(a.defaultValue!=null?Fl(i,!!a.multiple,a.defaultValue,!0):Fl(i,!!a.multiple,a.multiple?[]:"",!1))}i[B0]=a}catch(y){sr(e,e.return,y)}}break;case 6:if(Di(t,e),oa(e),n&4){if(e.stateNode===null)throw Error(Re(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(y){sr(e,e.return,y)}}break;case 3:if(Di(t,e),oa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{I0(t.containerInfo)}catch(y){sr(e,e.return,y)}break;case 4:Di(t,e),oa(e);break;case 13:Di(t,e),oa(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(P2=hr())),n&4&&p4(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(dn=(f=dn)||d,Di(t,e),dn=f):Di(t,e),oa(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for($e=e,d=e.child;d!==null;){for(p=$e=d;$e!==null;){switch(m=$e,v=m.child,m.tag){case 0:case 11:case 14:case 15:m0(4,m,m.return);break;case 1:Al(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(y){sr(n,r,y)}}break;case 5:Al(m,m.return);break;case 22:if(m.memoizedState!==null){m4(p);continue}}v!==null?(v.return=m,$e=v):m4(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,u=p.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=K5("display",s))}catch(y){sr(e,e.return,y)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(y){sr(e,e.return,y)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Di(t,e),oa(e),n&4&&p4(e);break;case 21:break;default:Di(t,e),oa(e)}}function oa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_6(r)){var n=r;break e}r=r.return}throw Error(Re(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(N0(i,""),n.flags&=-33);var a=h4(e);fm(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=h4(e);um(e,o,s);break;default:throw Error(Re(161))}}catch(u){sr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gC(e,t,r){$e=e,k6(e)}function k6(e,t,r){for(var n=(e.mode&1)!==0;$e!==null;){var i=$e,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Nf;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||dn;o=Nf;var f=dn;if(Nf=s,(dn=u)&&!f)for($e=i;$e!==null;)s=$e,u=s.child,s.tag===22&&s.memoizedState!==null?x4(i):u!==null?(u.return=s,$e=u):x4(i);for(;a!==null;)$e=a,k6(a),a=a.sibling;$e=i,Nf=o,dn=f}g4(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,$e=a):g4(e)}}function g4(e){for(;$e!==null;){var t=$e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dn||sh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Bi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Zy(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Zy(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&I0(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}dn||t.flags&512&&cm(t)}catch(m){sr(t,t.return,m)}}if(t===e){$e=null;break}if(r=t.sibling,r!==null){r.return=t.return,$e=r;break}$e=t.return}}function m4(e){for(;$e!==null;){var t=$e;if(t===e){$e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,$e=r;break}$e=t.return}}function x4(e){for(;$e!==null;){var t=$e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{sh(4,t)}catch(u){sr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){sr(t,i,u)}}var a=t.return;try{cm(t)}catch(u){sr(t,a,u)}break;case 5:var s=t.return;try{cm(t)}catch(u){sr(t,s,u)}}}catch(u){sr(t,t.return,u)}if(t===e){$e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,$e=o;break}$e=t.return}}var mC=Math.ceil,Td=Xa.ReactCurrentDispatcher,T2=Xa.ReactCurrentOwner,wi=Xa.ReactCurrentBatchConfig,Ct=0,Hr=null,kr=null,Qr=0,Yn=0,Pl=Us(0),Fr=0,H0=null,Eo=0,oh=0,A2=0,x0=null,Un=null,P2=0,$l=1/0,Fa=null,Ad=!1,dm=null,Ns=null,Ff=!1,Ss=null,Pd=0,v0=0,hm=null,rd=-1,nd=0;function An(){return Ct&6?hr():rd!==-1?rd:rd=hr()}function Fs(e){return e.mode&1?Ct&2&&Qr!==0?Qr&-Qr:Z9.transition!==null?(nd===0&&(nd=o_()),nd):(e=Ot,e!==0||(e=window.event,e=e===void 0?16:p_(e.type)),e):1}function Wi(e,t,r,n){if(50<v0)throw v0=0,hm=null,Error(Re(185));ou(e,r,n),(!(Ct&2)||e!==Hr)&&(e===Hr&&(!(Ct&2)&&(oh|=r),Fr===4&&xs(e,Qr)),Hn(e,n),r===1&&Ct===0&&!(t.mode&1)&&($l=hr()+500,nh&&zs()))}function Hn(e,t){var r=e.callbackNode;Zk(e,t);var n=fd(e,e===Hr?Qr:0);if(n===0)r!==null&&Ty(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ty(r),t===1)e.tag===0?J9(v4.bind(null,e)):I_(v4.bind(null,e)),K9(function(){!(Ct&6)&&zs()}),r=null;else{switch(l_(n)){case 1:r=e2;break;case 4:r=a_;break;case 16:r=ud;break;case 536870912:r=s_;break;default:r=ud}r=R6(r,C6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function C6(e,t){if(rd=-1,nd=0,Ct&6)throw Error(Re(327));var r=e.callbackNode;if(Ol()&&e.callbackNode!==r)return null;var n=fd(e,e===Hr?Qr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Nd(e,n);else{t=n;var i=Ct;Ct|=2;var a=T6();(Hr!==e||Qr!==t)&&(Fa=null,$l=hr()+500,vo(e,t));do try{yC();break}catch(o){E6(e,o)}while(1);h2(),Td.current=a,Ct=i,kr!==null?t=0:(Hr=null,Qr=0,t=Fr)}if(t!==0){if(t===2&&(i=Ug(e),i!==0&&(n=i,t=pm(e,i))),t===1)throw r=H0,vo(e,0),xs(e,n),Hn(e,hr()),r;if(t===6)xs(e,n);else{if(i=e.current.alternate,!(n&30)&&!xC(i)&&(t=Nd(e,n),t===2&&(a=Ug(e),a!==0&&(n=a,t=pm(e,a))),t===1))throw r=H0,vo(e,0),xs(e,n),Hn(e,hr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Re(345));case 2:co(e,Un,Fa);break;case 3:if(xs(e,n),(n&130023424)===n&&(t=P2+500-hr(),10<t)){if(fd(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){An(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Kg(co.bind(null,e,Un,Fa),t);break}co(e,Un,Fa);break;case 4:if(xs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Hi(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=hr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mC(n/1960))-n,10<n){e.timeoutHandle=Kg(co.bind(null,e,Un,Fa),n);break}co(e,Un,Fa);break;case 5:co(e,Un,Fa);break;default:throw Error(Re(329))}}}return Hn(e,hr()),e.callbackNode===r?C6.bind(null,e):null}function pm(e,t){var r=x0;return e.current.memoizedState.isDehydrated&&(vo(e,t).flags|=256),e=Nd(e,t),e!==2&&(t=Un,Un=r,t!==null&&gm(t)),e}function gm(e){Un===null?Un=e:Un.push.apply(Un,e)}function xC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Yi(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xs(e,t){for(t&=~A2,t&=~oh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hi(t),n=1<<r;e[r]=-1,t&=~n}}function v4(e){if(Ct&6)throw Error(Re(327));Ol();var t=fd(e,0);if(!(t&1))return Hn(e,hr()),null;var r=Nd(e,t);if(e.tag!==0&&r===2){var n=Ug(e);n!==0&&(t=n,r=pm(e,n))}if(r===1)throw r=H0,vo(e,0),xs(e,t),Hn(e,hr()),r;if(r===6)throw Error(Re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,co(e,Un,Fa),Hn(e,hr()),null}function N2(e,t){var r=Ct;Ct|=1;try{return e(t)}finally{Ct=r,Ct===0&&($l=hr()+500,nh&&zs())}}function To(e){Ss!==null&&Ss.tag===0&&!(Ct&6)&&Ol();var t=Ct;Ct|=1;var r=wi.transition,n=Ot;try{if(wi.transition=null,Ot=1,e)return e()}finally{Ot=n,wi.transition=r,Ct=t,!(Ct&6)&&zs()}}function F2(){Yn=Pl.current,Xt(Pl)}function vo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,X9(r)),kr!==null)for(r=kr.return;r!==null;){var n=r;switch(u2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&md();break;case 3:Hl(),Xt(Vn),Xt(mn),y2();break;case 5:v2(n);break;case 4:Hl();break;case 13:Xt(tr);break;case 19:Xt(tr);break;case 10:p2(n.type._context);break;case 22:case 23:F2()}r=r.return}if(Hr=e,kr=e=Rs(e.current,null),Qr=Yn=t,Fr=0,H0=null,A2=oh=Eo=0,Un=x0=null,po!==null){for(t=0;t<po.length;t++)if(r=po[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}po=null}return e}function E6(e,t){do{var r=kr;try{if(h2(),Zf.current=Ed,Cd){for(var n=rr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Cd=!1}if(Co=0,Gr=Nr=rr=null,g0=!1,z0=0,T2.current=null,r===null||r.return===null){Fr=1,H0=t,kr=null;break}e:{var a=e,s=r.return,o=r,u=t;if(t=Qr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=o,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=a4(s);if(v!==null){v.flags&=-257,s4(v,s,o,a,t),v.mode&1&&i4(a,f,t),t=v,u=f;var g=t.updateQueue;if(g===null){var y=new Set;y.add(u),t.updateQueue=y}else g.add(u);break e}else{if(!(t&1)){i4(a,f,t),R2();break e}u=Error(Re(426))}}else if(qt&&o.mode&1){var C=a4(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),s4(C,s,o,a,t),f2(Wl(u,o));break e}}a=u=Wl(u,o),Fr!==4&&(Fr=2),x0===null?x0=[a]:x0.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var E=l6(a,u,t);Jy(a,E);break e;case 1:o=u;var S=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof S.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ns===null||!Ns.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var T=c6(a,o,t);Jy(a,T);break e}}a=a.return}while(a!==null)}P6(r)}catch(F){t=F,kr===r&&r!==null&&(kr=r=r.return);continue}break}while(1)}function T6(){var e=Td.current;return Td.current=Ed,e===null?Ed:e}function R2(){(Fr===0||Fr===3||Fr===2)&&(Fr=4),Hr===null||!(Eo&268435455)&&!(oh&268435455)||xs(Hr,Qr)}function Nd(e,t){var r=Ct;Ct|=2;var n=T6();(Hr!==e||Qr!==t)&&(Fa=null,vo(e,t));do try{vC();break}catch(i){E6(e,i)}while(1);if(h2(),Ct=r,Td.current=n,kr!==null)throw Error(Re(261));return Hr=null,Qr=0,Fr}function vC(){for(;kr!==null;)A6(kr)}function yC(){for(;kr!==null&&!Hk();)A6(kr)}function A6(e){var t=F6(e.alternate,e,Yn);e.memoizedProps=e.pendingProps,t===null?P6(e):kr=t,T2.current=null}function P6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=dC(r,t),r!==null){r.flags&=32767,kr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fr=6,kr=null;return}}else if(r=fC(r,t,Yn),r!==null){kr=r;return}if(t=t.sibling,t!==null){kr=t;return}kr=t=e}while(t!==null);Fr===0&&(Fr=5)}function co(e,t,r){var n=Ot,i=wi.transition;try{wi.transition=null,Ot=1,_C(e,t,r,n)}finally{wi.transition=i,Ot=n}return null}function _C(e,t,r,n){do Ol();while(Ss!==null);if(Ct&6)throw Error(Re(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Re(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(e9(e,a),e===Hr&&(kr=Hr=null,Qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ff||(Ff=!0,R6(ud,function(){return Ol(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=wi.transition,wi.transition=null;var s=Ot;Ot=1;var o=Ct;Ct|=4,T2.current=null,pC(e,r),w6(r,e),U9($g),dd=!!Wg,$g=Wg=null,e.current=r,gC(r),Wk(),Ct=o,Ot=s,wi.transition=a}else e.current=r;if(Ff&&(Ff=!1,Ss=e,Pd=i),a=e.pendingLanes,a===0&&(Ns=null),Kk(r.stateNode),Hn(e,hr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ad)throw Ad=!1,e=dm,dm=null,e;return Pd&1&&e.tag!==0&&Ol(),a=e.pendingLanes,a&1?e===hm?v0++:(v0=0,hm=e):v0=0,zs(),null}function Ol(){if(Ss!==null){var e=l_(Pd),t=wi.transition,r=Ot;try{if(wi.transition=null,Ot=16>e?16:e,Ss===null)var n=!1;else{if(e=Ss,Ss=null,Pd=0,Ct&6)throw Error(Re(331));var i=Ct;for(Ct|=4,$e=e.current;$e!==null;){var a=$e,s=a.child;if($e.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var f=o[u];for($e=f;$e!==null;){var d=$e;switch(d.tag){case 0:case 11:case 15:m0(8,d,a)}var p=d.child;if(p!==null)p.return=d,$e=p;else for(;$e!==null;){d=$e;var m=d.sibling,v=d.return;if(y6(d),d===f){$e=null;break}if(m!==null){m.return=v,$e=m;break}$e=v}}}var g=a.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var C=y.sibling;y.sibling=null,y=C}while(y!==null)}}$e=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,$e=s;else e:for(;$e!==null;){if(a=$e,a.flags&2048)switch(a.tag){case 0:case 11:case 15:m0(9,a,a.return)}var E=a.sibling;if(E!==null){E.return=a.return,$e=E;break e}$e=a.return}}var S=e.current;for($e=S;$e!==null;){s=$e;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,$e=x;else e:for(s=S;$e!==null;){if(o=$e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:sh(9,o)}}catch(F){sr(o,o.return,F)}if(o===s){$e=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,$e=T;break e}$e=o.return}}if(Ct=i,zs(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(Jd,e)}catch{}n=!0}return n}finally{Ot=r,wi.transition=t}}return!1}function y4(e,t,r){t=Wl(r,t),t=l6(e,t,1),e=Ps(e,t,1),t=An(),e!==null&&(ou(e,1,t),Hn(e,t))}function sr(e,t,r){if(e.tag===3)y4(e,e,r);else for(;t!==null;){if(t.tag===3){y4(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ns===null||!Ns.has(n))){e=Wl(r,e),e=c6(t,e,1),t=Ps(t,e,1),e=An(),t!==null&&(ou(t,1,e),Hn(t,e));break}}t=t.return}}function SC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=An(),e.pingedLanes|=e.suspendedLanes&r,Hr===e&&(Qr&r)===r&&(Fr===4||Fr===3&&(Qr&130023424)===Qr&&500>hr()-P2?vo(e,0):A2|=r),Hn(e,t)}function N6(e,t){t===0&&(e.mode&1?(t=_f,_f<<=1,!(_f&130023424)&&(_f=4194304)):t=1);var r=An();e=Ga(e,t),e!==null&&(ou(e,t,r),Hn(e,r))}function wC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),N6(e,r)}function kC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Re(314))}n!==null&&n.delete(t),N6(e,r)}var F6;F6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vn.current)zn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return zn=!1,uC(e,t,r);zn=!!(e.flags&131072)}else zn=!1,qt&&t.flags&1048576&&D_(t,yd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;td(e,t),e=t.pendingProps;var i=zl(t,mn.current);Dl(t,r),i=S2(null,t,n,e,i,r);var a=w2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gn(n)?(a=!0,xd(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,m2(t),i.updater=ah,t.stateNode=i,i._reactInternals=t,tm(t,n,e,r),t=im(null,t,n,!0,a,r)):(t.tag=0,qt&&a&&c2(t),wn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(td(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=EC(n),e=Bi(n,e),i){case 0:t=nm(null,t,n,e,r);break e;case 1:t=c4(null,t,n,e,r);break e;case 11:t=o4(null,t,n,e,r);break e;case 14:t=l4(null,t,n,Bi(n.type,e),r);break e}throw Error(Re(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),nm(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),c4(e,t,n,i,r);case 3:e:{if(h6(t),e===null)throw Error(Re(387));n=t.pendingProps,a=t.memoizedState,i=a.element,U_(e,t),wd(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Wl(Error(Re(423)),t),t=u4(e,t,n,r,i);break e}else if(n!==i){i=Wl(Error(Re(424)),t),t=u4(e,t,n,r,i);break e}else for(Jn=As(t.stateNode.containerInfo.firstChild),Zn=t,qt=!0,Ui=null,r=B_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Vl(),n===i){t=Ha(e,t,r);break e}wn(e,t,n,r)}t=t.child}return t;case 5:return z_(t),e===null&&Jg(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,Xg(n,i)?s=null:a!==null&&Xg(n,a)&&(t.flags|=32),d6(e,t),wn(e,t,s,r),t.child;case 6:return e===null&&Jg(t),null;case 13:return p6(e,t,r);case 4:return x2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Gl(t,null,n,r):wn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),o4(e,t,n,i,r);case 7:return wn(e,t,t.pendingProps,r),t.child;case 8:return wn(e,t,t.pendingProps.children,r),t.child;case 12:return wn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Gt(_d,n._currentValue),n._currentValue=s,a!==null)if(Yi(a.value,s)){if(a.children===i.children&&!Vn.current){t=Ha(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=Ma(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),Zg(a.return,r,t),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Re(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Zg(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}wn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Dl(t,r),i=ki(i),n=n(i),t.flags|=1,wn(e,t,n,r),t.child;case 14:return n=t.type,i=Bi(n,t.pendingProps),i=Bi(n.type,i),l4(e,t,n,i,r);case 15:return u6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bi(n,i),td(e,t),t.tag=1,Gn(n)?(e=!0,xd(t)):e=!1,Dl(t,r),o6(t,n,i),tm(t,n,i,r),im(null,t,n,!0,e,r);case 19:return g6(e,t,r);case 22:return f6(e,t,r)}throw Error(Re(156,t.tag))};function R6(e,t){return i_(e,t)}function CC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,r,n){return new CC(e,t,r,n)}function b2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function EC(e){if(typeof e=="function")return b2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===qm)return 11;if(e===Jm)return 14}return 2}function Rs(e,t){var r=e.alternate;return r===null?(r=Si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function id(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")b2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case vl:return yo(r.children,i,a,t);case Qm:s=8,i|=8;break;case Eg:return e=Si(12,r,t,i|2),e.elementType=Eg,e.lanes=a,e;case Tg:return e=Si(13,r,t,i),e.elementType=Tg,e.lanes=a,e;case Ag:return e=Si(19,r,t,i),e.elementType=Ag,e.lanes=a,e;case z5:return lh(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case j5:s=10;break e;case U5:s=9;break e;case qm:s=11;break e;case Jm:s=14;break e;case ps:s=16,n=null;break e}throw Error(Re(130,e==null?e:typeof e,""))}return t=Si(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function yo(e,t,r,n){return e=Si(7,e,n,t),e.lanes=r,e}function lh(e,t,r,n){return e=Si(22,e,n,t),e.elementType=z5,e.lanes=r,e.stateNode={isHidden:!1},e}function Xp(e,t,r){return e=Si(6,e,null,t),e.lanes=r,e}function Kp(e,t,r){return t=Si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function TC(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pp(0),this.expirationTimes=Pp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,a,s,o,u){return e=new TC(e,t,r,o,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Si(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},m2(a),e}function AC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function b6(e){if(!e)return Ds;e=e._reactInternals;e:{if(bo(e)!==e||e.tag!==1)throw Error(Re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Re(171))}if(e.tag===1){var r=e.type;if(Gn(r))return b_(e,r,t)}return t}function I6(e,t,r,n,i,a,s,o,u){return e=I2(r,n,!0,e,i,a,s,o,u),e.context=b6(null),r=e.current,n=An(),i=Fs(r),a=Ma(n,i),a.callback=t??null,Ps(r,a,i),e.current.lanes=i,ou(e,i,n),Hn(e,n),e}function ch(e,t,r,n){var i=t.current,a=An(),s=Fs(i);return r=b6(r),t.context===null?t.context=r:t.pendingContext=r,t=Ma(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ps(i,t,s),e!==null&&(Wi(e,i,s,a),Jf(e,i,s)),s}function Fd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function D2(e,t){_4(e,t),(e=e.alternate)&&_4(e,t)}function PC(){return null}var D6=typeof reportError=="function"?reportError:function(e){console.error(e)};function O2(e){this._internalRoot=e}uh.prototype.render=O2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Re(409));ch(e,t,null,null)};uh.prototype.unmount=O2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;To(function(){ch(null,e,null,null)}),t[Va]=null}};function uh(e){this._internalRoot=e}uh.prototype.unstable_scheduleHydration=function(e){if(e){var t=f_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ms.length&&t!==0&&t<ms[r].priority;r++);ms.splice(r,0,e),r===0&&h_(e)}};function L2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function S4(){}function NC(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Fd(s);a.call(f)}}var s=I6(t,n,e,0,null,!1,!1,"",S4);return e._reactRootContainer=s,e[Va]=s.current,L0(e.nodeType===8?e.parentNode:e),To(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var f=Fd(u);o.call(f)}}var u=I2(e,0,!1,null,null,!1,!1,"",S4);return e._reactRootContainer=u,e[Va]=u.current,L0(e.nodeType===8?e.parentNode:e),To(function(){ch(t,u,r,n)}),u}function dh(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=Fd(s);o.call(u)}}ch(t,s,e,i)}else s=NC(r,t,e,i,n);return Fd(s)}c_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=r0(t.pendingLanes);r!==0&&(t2(t,r|1),Hn(t,hr()),!(Ct&6)&&($l=hr()+500,zs()))}break;case 13:To(function(){var n=Ga(e,1);if(n!==null){var i=An();Wi(n,e,1,i)}}),D2(e,1)}};r2=function(e){if(e.tag===13){var t=Ga(e,134217728);if(t!==null){var r=An();Wi(t,e,134217728,r)}D2(e,134217728)}};u_=function(e){if(e.tag===13){var t=Fs(e),r=Ga(e,t);if(r!==null){var n=An();Wi(r,e,t,n)}D2(e,t)}};f_=function(){return Ot};d_=function(e,t){var r=Ot;try{return Ot=e,t()}finally{Ot=r}};Mg=function(e,t,r){switch(t){case"input":if(Fg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=rh(n);if(!i)throw Error(Re(90));G5(n),Fg(n,i)}}}break;case"textarea":W5(e,r);break;case"select":t=r.value,t!=null&&Fl(e,!!r.multiple,t,!1)}};J5=N2;Z5=To;var FC={usingClientEntryPoint:!1,Events:[cu,wl,rh,Q5,q5,N2]},Vc={findFiberByHostInstance:ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RC={bundleType:Vc.bundleType,version:Vc.version,rendererPackageName:Vc.rendererPackageName,rendererConfig:Vc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=r_(e),e===null?null:e.stateNode},findFiberByHostInstance:Vc.findFiberByHostInstance||PC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rf.isDisabled&&Rf.supportsFiber)try{Jd=Rf.inject(RC),pa=Rf}catch{}}ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FC;ni.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L2(t))throw Error(Re(200));return AC(e,t,null,r)};ni.createRoot=function(e,t){if(!L2(e))throw Error(Re(299));var r=!1,n="",i=D6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[Va]=t.current,L0(e.nodeType===8?e.parentNode:e),new O2(t)};ni.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Re(188)):(e=Object.keys(e).join(","),Error(Re(268,e)));return e=r_(t),e=e===null?null:e.stateNode,e};ni.flushSync=function(e){return To(e)};ni.hydrate=function(e,t,r){if(!fh(t))throw Error(Re(200));return dh(null,e,t,!0,r)};ni.hydrateRoot=function(e,t,r){if(!L2(e))throw Error(Re(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=D6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=I6(t,null,e,1,r??null,i,!1,a,s),e[Va]=t.current,L0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new uh(t)};ni.render=function(e,t,r){if(!fh(t))throw Error(Re(200));return dh(null,e,t,!1,r)};ni.unmountComponentAtNode=function(e){if(!fh(e))throw Error(Re(40));return e._reactRootContainer?(To(function(){dh(null,null,e,!1,function(){e._reactRootContainer=null,e[Va]=null})}),!0):!1};ni.unstable_batchedUpdates=N2;ni.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!fh(r))throw Error(Re(200));if(e==null||e._reactInternals===void 0)throw Error(Re(38));return dh(e,t,r,!1,n)};ni.version="18.3.1-next-f1338f8080-20240426";function O6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O6)}catch(e){console.error(e)}}O6(),O5.exports=ni;var bC=O5.exports,w4=bC;kg.createRoot=w4.createRoot,kg.hydrateRoot=w4.hydrateRoot;const k4=e=>{let t;const r=new Set,n=(d,p)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const v=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(g=>g(t,v))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>f,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},f=t=e(n,i,u);return u},IC=e=>e?k4(e):k4;var L6={exports:{}},M6={},B6={exports:{}},j6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xl=Se;function DC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var OC=typeof Object.is=="function"?Object.is:DC,LC=Xl.useState,MC=Xl.useEffect,BC=Xl.useLayoutEffect,jC=Xl.useDebugValue;function UC(e,t){var r=t(),n=LC({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return BC(function(){i.value=r,i.getSnapshot=t,Yp(i)&&a({inst:i})},[e,r,t]),MC(function(){return Yp(i)&&a({inst:i}),e(function(){Yp(i)&&a({inst:i})})},[e]),jC(r),r}function Yp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!OC(e,r)}catch{return!0}}function zC(e,t){return t()}var VC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?zC:UC;j6.useSyncExternalStore=Xl.useSyncExternalStore!==void 0?Xl.useSyncExternalStore:VC;B6.exports=j6;var GC=B6.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hh=Se,HC=GC;function WC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $C=typeof Object.is=="function"?Object.is:WC,XC=HC.useSyncExternalStore,KC=hh.useRef,YC=hh.useEffect,QC=hh.useMemo,qC=hh.useDebugValue;M6.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=KC(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=QC(function(){function u(v){if(!f){if(f=!0,d=v,v=n(v),i!==void 0&&s.hasValue){var g=s.value;if(i(g,v))return p=g}return p=v}if(g=p,$C(d,v))return g;var y=n(v);return i!==void 0&&i(g,y)?(d=v,g):(d=v,p=y)}var f=!1,d,p,m=r===void 0?null:r;return[function(){return u(t())},m===null?void 0:function(){return u(m())}]},[t,r,n,i]);var o=XC(e,a[0],a[1]);return YC(function(){s.hasValue=!0,s.value=o},[o]),qC(o),o};L6.exports=M6;var JC=L6.exports;const ZC=Qd(JC),{useDebugValue:eE}=wr,{useSyncExternalStoreWithSelector:tE}=ZC;const rE=e=>e;function nE(e,t=rE,r){const n=tE(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return eE(n),n}const C4=e=>{const t=typeof e=="function"?IC(e):e,r=(n,i)=>nE(t,n,i);return Object.assign(r,t),r},iE=e=>e?C4(e):C4;var U6=Symbol.for("immer-nothing"),E4=Symbol.for("immer-draftable"),bt=Symbol.for("immer-state");function _i(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Kl=Object.getPrototypeOf;function Yl(e){return!!e&&!!e[bt]}function Wa(e){var t;return e?z6(e)||Array.isArray(e)||!!e[E4]||!!((t=e.constructor)!=null&&t[E4])||gh(e)||mh(e):!1}var aE=Object.prototype.constructor.toString();function z6(e){if(!e||typeof e!="object")return!1;const t=Kl(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===aE}function W0(e,t){ph(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ph(e){const t=e[bt];return t?t.type_:Array.isArray(e)?1:gh(e)?2:mh(e)?3:0}function mm(e,t){return ph(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function V6(e,t,r){const n=ph(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function sE(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function gh(e){return e instanceof Map}function mh(e){return e instanceof Set}function zr(e){return e.copy_||e.base_}function xm(e,t){if(gh(e))return new Map(e);if(mh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=z6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[bt];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Kl(e),n)}else{const n=Kl(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function M2(e,t=!1){return xh(e)||Yl(e)||!Wa(e)||(ph(e)>1&&(e.set=e.add=e.clear=e.delete=oE),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>M2(n,!0))),e}function oE(){_i(2)}function xh(e){return Object.isFrozen(e)}var vm={};function Ao(e){const t=vm[e];return t||_i(0,e),t}function lE(e,t){vm[e]||(vm[e]=t)}var $0;function Rd(){return $0}function cE(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function T4(e,t){t&&(Ao("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ym(e){_m(e),e.drafts_.forEach(uE),e.drafts_=null}function _m(e){e===$0&&($0=e.parent_)}function A4(e){return $0=cE($0,e)}function uE(e){const t=e[bt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function P4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[bt].modified_&&(ym(t),_i(4)),Wa(e)&&(e=bd(t,e),t.parent_||Id(t,e)),t.patches_&&Ao("Patches").generateReplacementPatches_(r[bt].base_,e,t.patches_,t.inversePatches_)):e=bd(t,r,[]),ym(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==U6?e:void 0}function bd(e,t,r){if(xh(t))return t;const n=t[bt];if(!n)return W0(t,(i,a)=>N4(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Id(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),W0(a,(o,u)=>N4(e,n,i,o,u,r,s)),Id(e,i,!1),r&&e.patches_&&Ao("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function N4(e,t,r,n,i,a,s){if(Yl(i)){const o=a&&t&&t.type_!==3&&!mm(t.assigned_,n)?a.concat(n):void 0,u=bd(e,i,o);if(V6(r,n,u),Yl(u))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Wa(i)&&!xh(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;bd(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Id(e,i)}}function Id(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&M2(t,r)}function fE(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Rd(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=B2;r&&(i=[n],a=X0);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var B2={get(e,t){if(t===bt)return e;const r=zr(e);if(!mm(r,t))return dE(e,r,t);const n=r[t];return e.finalized_||!Wa(n)?n:n===Qp(e.base_,t)?(qp(e),e.copy_[t]=K0(n,e)):n},has(e,t){return t in zr(e)},ownKeys(e){return Reflect.ownKeys(zr(e))},set(e,t,r){const n=G6(zr(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Qp(zr(e),t),a=i==null?void 0:i[bt];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(sE(r,i)&&(r!==void 0||mm(e.base_,t)))return!0;qp(e),Ia(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Qp(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,qp(e),Ia(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=zr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){_i(11)},getPrototypeOf(e){return Kl(e.base_)},setPrototypeOf(){_i(12)}},X0={};W0(B2,(e,t)=>{X0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});X0.deleteProperty=function(e,t){return X0.set.call(this,e,t,void 0)};X0.set=function(e,t,r){return B2.set.call(this,e[0],t,r,e[0])};function Qp(e,t){const r=e[bt];return(r?zr(r):e)[t]}function dE(e,t,r){var i;const n=G6(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function G6(e,t){if(!(t in e))return;let r=Kl(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Kl(r)}}function Ia(e){e.modified_||(e.modified_=!0,e.parent_&&Ia(e.parent_))}function qp(e){e.copy_||(e.copy_=xm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var hE=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(u=a,...f){return s.produce(u,d=>r.call(this,d,...f))}}typeof r!="function"&&_i(6),n!==void 0&&typeof n!="function"&&_i(7);let i;if(Wa(t)){const a=A4(this),s=K0(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?ym(a):_m(a)}return T4(a,n),P4(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===U6&&(i=void 0),this.autoFreeze_&&M2(i,!0),n){const a=[],s=[];Ao("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else _i(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,u=>t(u,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Wa(e)||_i(8),Yl(e)&&(e=pE(e));const t=A4(this),r=K0(e,void 0);return r[bt].isManual_=!0,_m(t),r}finishDraft(e,t){const r=e&&e[bt];(!r||!r.isManual_)&&_i(9);const{scope_:n}=r;return T4(n,t),P4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Ao("Patches").applyPatches_;return Yl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function K0(e,t){const r=gh(e)?Ao("MapSet").proxyMap_(e,t):mh(e)?Ao("MapSet").proxySet_(e,t):fE(e,t);return(t?t.scope_:Rd()).drafts_.push(r),r}function pE(e){return Yl(e)||_i(10,e),H6(e)}function H6(e){if(!Wa(e)||xh(e))return e;const t=e[bt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=xm(e,t.scope_.immer_.useStrictShallowCopy_)}else r=xm(e,!0);return W0(r,(n,i)=>{V6(r,n,H6(i))}),t&&(t.finalized_=!1),r}function gE(){class e extends Map{constructor(u,f){super(),this[bt]={type_:2,parent_:f,scope_:f?f.scope_:Rd(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:u,draft_:this,isManual_:!1,revoked_:!1}}get size(){return zr(this[bt]).size}has(u){return zr(this[bt]).has(u)}set(u,f){const d=this[bt];return s(d),(!zr(d).has(u)||zr(d).get(u)!==f)&&(r(d),Ia(d),d.assigned_.set(u,!0),d.copy_.set(u,f),d.assigned_.set(u,!0)),this}delete(u){if(!this.has(u))return!1;const f=this[bt];return s(f),r(f),Ia(f),f.base_.has(u)?f.assigned_.set(u,!1):f.assigned_.delete(u),f.copy_.delete(u),!0}clear(){const u=this[bt];s(u),zr(u).size&&(r(u),Ia(u),u.assigned_=new Map,W0(u.base_,f=>{u.assigned_.set(f,!1)}),u.copy_.clear())}forEach(u,f){const d=this[bt];zr(d).forEach((p,m,v)=>{u.call(f,this.get(m),m,this)})}get(u){const f=this[bt];s(f);const d=zr(f).get(u);if(f.finalized_||!Wa(d)||d!==f.base_.get(u))return d;const p=K0(d,f);return r(f),f.copy_.set(u,p),p}keys(){return zr(this[bt]).keys()}values(){const u=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const f=u.next();return f.done?f:{done:!1,value:this.get(f.value)}}}}entries(){const u=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const f=u.next();if(f.done)return f;const d=this.get(f.value);return{done:!1,value:[f.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,u){return new e(o,u)}function r(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class n extends Set{constructor(u,f){super(),this[bt]={type_:3,parent_:f,scope_:f?f.scope_:Rd(),modified_:!1,finalized_:!1,copy_:void 0,base_:u,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return zr(this[bt]).size}has(u){const f=this[bt];return s(f),f.copy_?!!(f.copy_.has(u)||f.drafts_.has(u)&&f.copy_.has(f.drafts_.get(u))):f.base_.has(u)}add(u){const f=this[bt];return s(f),this.has(u)||(a(f),Ia(f),f.copy_.add(u)),this}delete(u){if(!this.has(u))return!1;const f=this[bt];return s(f),a(f),Ia(f),f.copy_.delete(u)||(f.drafts_.has(u)?f.copy_.delete(f.drafts_.get(u)):!1)}clear(){const u=this[bt];s(u),zr(u).size&&(a(u),Ia(u),u.copy_.clear())}values(){const u=this[bt];return s(u),a(u),u.copy_.values()}entries(){const u=this[bt];return s(u),a(u),u.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(u,f){const d=this.values();let p=d.next();for(;!p.done;)u.call(f,p.value,p.value,this),p=d.next()}}function i(o,u){return new n(o,u)}function a(o){o.copy_||(o.copy_=new Set,o.base_.forEach(u=>{if(Wa(u)){const f=K0(u,o);o.drafts_.set(u,f),o.copy_.add(f)}else o.copy_.add(u)}))}function s(o){o.revoked_&&_i(3,JSON.stringify(zr(o)))}lE("MapSet",{proxyMap_:t,proxySet_:i})}var ti=new hE,mE=ti.produce;ti.produceWithPatches.bind(ti);ti.setAutoFreeze.bind(ti);ti.setUseStrictShallowCopy.bind(ti);ti.applyPatches.bind(ti);ti.createDraft.bind(ti);ti.finishDraft.bind(ti);const xE=e=>(t,r,n)=>(n.setState=(i,a,...s)=>{const o=typeof i=="function"?mE(i):i;return t(o,a,...s)},e(n.setState,r,n)),vE=xE;class Tr{static initialize(t=50){this.state.maxHistorySize=t}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static notifyListeners(){this.listeners.forEach(t=>t())}static recordAction(t,r,n){const i={id:crypto.randomUUID(),type:t,timestamp:new Date,data:JSON.parse(JSON.stringify(r)),description:n};return this.state.history=this.state.history.slice(0,this.state.currentIndex+1),this.state.history.push(i),this.state.currentIndex++,this.state.history.length>this.state.maxHistorySize&&(this.state.history.shift(),this.state.currentIndex--),this.notifyListeners(),i.id}static canUndo(){return this.state.currentIndex>=0}static canRedo(){return this.state.currentIndex<this.state.history.length-1}static undo(){if(!this.canUndo())return null;const t=this.state.history[this.state.currentIndex];return this.state.currentIndex--,this.notifyListeners(),t}static redo(){if(!this.canRedo())return null;this.state.currentIndex++;const t=this.state.history[this.state.currentIndex];return this.notifyListeners(),t}static getHistory(){return[...this.state.history]}static getCurrentIndex(){return this.state.currentIndex}static clear(){this.state.history=[],this.state.currentIndex=-1,this.notifyListeners()}static createPinAssignmentAction(t,r,n){return{type:"PIN_ASSIGNMENT",data:{pinId:t,oldSignal:r,newSignal:n}}}static createBulkAssignmentAction(t){return{type:"BULK_ASSIGNMENT",data:{assignments:t}}}static createSelectionAction(t,r){return{type:"SELECTION_CHANGE",data:{oldSelection:Array.from(t),newSelection:Array.from(r)}}}static createViewChangeAction(t,r){return{type:"VIEW_CHANGE",data:{oldView:t,newView:r}}}static getActionDescription(t){switch(t.type){case"PIN_ASSIGNMENT":const{pinId:r,oldSignal:n,newSignal:i}=t.data;return i?`Assigned "${i}" to pin ${r}`:`Cleared assignment from pin ${r}`;case"BULK_ASSIGNMENT":return`Bulk assignment to ${t.data.assignments.length} pins`;case"SELECTION_CHANGE":return`Selected ${t.data.newSelection.length} pin(s)`;case"VIEW_CHANGE":return"Changed view settings";default:return t.description||`Unknown action: ${t.type}`}}}Tr.state={history:[],currentIndex:-1,maxHistorySize:50};Tr.listeners=new Set;function Os(e){if(e.length===1)return e.charCodeAt(0)-65;if(e.length===2){const t=e.charCodeAt(0)-65,r=e.charCodeAt(1)-65;return 26+t*26+r}return 0}function cl(e){if(e<0)return console.warn(` Invalid index ${e}, defaulting to 'A'`),"A";if(e<26)return String.fromCharCode(65+e);{const t=e-26,r=Math.floor(t/26),n=t%26;return String.fromCharCode(65+r)+String.fromCharCode(65+n)}}function W6(e,t){const r=Os(e),n=Os(t);return r-n}gE();const Jp={rotation:0,isTopView:!0,zoom:1,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},bf={pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"grid",sortOrder:"asc"},yE={activeTab:"overview",viewMode:"grid",searchQuery:"",selectedRows:new Set,sortColumn:void 0,sortDirection:"asc",commentFilter:"all"},$i=iE()(vE((e,t)=>({currentProject:null,package:null,pins:[],filteredPins:[],selectedPins:new Set,visibleBanks:new Set,viewConfig:Jp,listView:yE,pinColorMode:"bank",filters:bf,isLoading:!1,error:null,recentFiles:[],canUndo:!1,canRedo:!1,currentActionDescription:null,nextRedoActionDescription:null,loadProject:r=>{e(n=>{n.currentProject=r,n.package=r.packageData,n.pins=r.pinAssignments,n.viewConfig=r.viewConfig,n.filters=r.filters}),t().applyFilters()},createNewProject:(r,n)=>e(i=>{const a={id:crypto.randomUUID(),name:r,description:"",created:new Date,modified:new Date,projectInfo:{device:n.device,package:n.packageType,speedGrade:"-1",temperature:"C"},packageData:n,pinAssignments:n.pins,viewConfig:Jp,filters:bf};i.currentProject=a,i.package=n,i.pins=n.pins,i.filteredPins=n.pins,i.viewConfig=Jp,i.filters=bf;const s=new Set;n.pins.forEach(o=>{const u=o.bank||"NA";s.add(u)}),i.visibleBanks=s,console.log(" : newProject -  visibleBanks:",Array.from(s)),t().applyFilters()}),saveProject:()=>e(r=>{r.currentProject&&(r.currentProject.modified=new Date,r.currentProject.pinAssignments=r.pins,r.currentProject.viewConfig=r.viewConfig,r.currentProject.filters=r.filters)}),loadPackage:r=>e(n=>{var a;console.log(" : loadPackage",r),n.package=r,n.pins=r.pins,n.filteredPins=r.pins,n.selectedPins.clear();const i=new Set;r.pins.forEach(s=>{const o=s.bank||"NA";i.add(o)}),n.visibleBanks=i,console.log(" :  visibleBanks:",Array.from(i)),console.log(" :",{packageName:(a=n.package)==null?void 0:a.name,pinsCount:n.pins.length,filteredPinsCount:n.filteredPins.length})}),updatePin:(r,n)=>e(i=>{const a=i.pins.find(s=>s.id===r);a&&(Object.assign(a,n),n.signalName!==void 0&&(a.isAssigned=n.signalName!==""))}),updatePins:r=>e(n=>{r.forEach((i,a)=>{const s=n.pins.find(o=>o.id===a);s&&(Object.assign(s,i),i.signalName!==void 0&&(s.isAssigned=i.signalName!==""))})}),assignSignal:(r,n)=>{const a=t().pins.find(u=>u.id===r);if(!a)return;const s=a.signalName,o=Tr.createPinAssignmentAction(r,s,n);Tr.recordAction(o.type,o.data,n?` "${n}"  ${r} `:` ${r} `),e(u=>{const f=u.pins.find(d=>d.id===r);f&&(f.signalName=n,f.isAssigned=n!=="")}),t().applyFilters(),t().updateUndoRedoState()},clearSignal:r=>{const i=t().pins.find(o=>o.id===r);if(!i||!i.signalName)return;const a=i.signalName,s=Tr.createPinAssignmentAction(r,a,"");Tr.recordAction(s.type,s.data,` ${r} `),e(o=>{const u=o.pins.find(f=>f.id===r);u&&(u.signalName="",u.isAssigned=!1)}),t().applyFilters(),t().updateUndoRedoState()},selectPin:r=>e(n=>{n.selectedPins.clear(),n.selectedPins.add(r)}),selectPins:r=>e(n=>{n.selectedPins.clear(),r.forEach(i=>n.selectedPins.add(i))}),clearSelection:()=>e(r=>{r.selectedPins.clear()}),togglePinSelection:r=>e(n=>{n.selectedPins.has(r)?n.selectedPins.delete(r):n.selectedPins.add(r)}),setRotation:r=>e(n=>{n.viewConfig.rotation=r%360}),toggleView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setZoom:r=>e(n=>{n.viewConfig.zoom=Math.max(.1,Math.min(5,r))}),resetZoom:()=>e(r=>{r.viewConfig.zoom=1}),updateViewConfig:r=>e(n=>{Object.assign(n.viewConfig,r)}),updateFilters:r=>e(n=>{Object.assign(n.filters,r);let i=[...n.pins];if(n.filters.pinTypes.length>0&&(i=i.filter(a=>n.filters.pinTypes.includes(a.pinType))),n.filters.banks.length>0&&(i=i.filter(a=>a.bank&&n.filters.banks.includes(a.bank))),n.filters.searchText){const a=n.filters.searchText.toLowerCase();i=i.filter(s=>s.pinNumber.toLowerCase().includes(a)||s.pinName.toLowerCase().includes(a)||s.signalName.toLowerCase().includes(a))}n.filters.voltageFilter.length>0&&(i=i.filter(a=>n.filters.voltageFilter.includes(a.voltage))),n.filters.assignmentStatus!=="all"&&(i=i.filter(a=>n.filters.assignmentStatus==="assigned"?a.isAssigned:!a.isAssigned)),n.filters.showOnlyDifferentialPairs&&(i=i.filter(a=>a.differentialPair)),i.sort((a,s)=>{var d,p;let o,u;switch(n.filters.sortField){case"pinNumber":o=a.pinNumber,u=s.pinNumber;break;case"pinName":o=a.pinName,u=s.pinName;break;case"signalName":o=a.signalName,u=s.signalName;break;case"pinType":o=a.pinType,u=s.pinType;break;case"bank":o=a.bank||"",u=s.bank||"";break;case"grid":if(a.gridPosition&&s.gridPosition){const m=W6(a.gridPosition.row,s.gridPosition.row);if(m!==0)return n.filters.sortOrder==="asc"?m:-m;const v=a.gridPosition.col-s.gridPosition.col;return n.filters.sortOrder==="asc"?v:-v}o=((d=a.gridPosition)==null?void 0:d.row)||"",u=((p=s.gridPosition)==null?void 0:p.row)||"";break;default:o=a.pinNumber,u=s.pinNumber}const f=o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"});return n.filters.sortOrder==="asc"?f:-f}),n.filteredPins=i}),clearFilters:()=>e(r=>{r.filters={...bf},r.filteredPins=r.pins}),applyFilters:()=>e(r=>{let n=[...r.pins];if(console.log(" applyFilters: visibleBanks =",Array.from(r.visibleBanks)),console.log(" applyFilters: pins before bank filter =",n.length),r.visibleBanks.size>0){const i=n.length;n=n.filter(a=>{const s=a.bank||"UNASSIGNED";return r.visibleBanks.has(s)}),console.log(` applyFilters: filtered from ${i} to ${n.length} pins`)}else console.log(" applyFilters: visibleBanks is empty, showing all pins");if(r.filters.pinTypes.length>0&&(n=n.filter(i=>r.filters.pinTypes.includes(i.pinType))),r.filters.banks.length>0&&(n=n.filter(i=>i.bank&&r.filters.banks.includes(i.bank))),r.filters.searchText){const i=r.filters.searchText.toLowerCase();n=n.filter(a=>a.pinNumber.toLowerCase().includes(i)||a.pinName.toLowerCase().includes(i)||a.signalName.toLowerCase().includes(i))}r.filters.voltageFilter.length>0&&(n=n.filter(i=>r.filters.voltageFilter.includes(i.voltage))),r.filters.assignmentStatus!=="all"&&(n=n.filter(i=>r.filters.assignmentStatus==="assigned"?i.isAssigned:!i.isAssigned)),r.filters.showOnlyDifferentialPairs&&(n=n.filter(i=>i.differentialPair)),n.sort((i,a)=>{let s,o;switch(r.filters.sortField){case"pinNumber":s=i.pinNumber,o=a.pinNumber;break;case"pinName":s=i.pinName,o=a.pinName;break;case"signalName":s=i.signalName||"",o=a.signalName||"";break;case"pinType":s=i.pinType,o=a.pinType;break;case"bank":s=i.bank||"",o=a.bank||"";break;default:s=i.pinNumber,o=a.pinNumber}const u=s.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"});return r.filters.sortOrder==="asc"?u:-u}),r.filteredPins=n}),setSortField:r=>e(n=>{n.filters.sortField=r,t().applyFilters()}),setSortOrder:r=>e(n=>{n.filters.sortOrder=r,t().applyFilters()}),toggleBankVisibility:r=>{e(n=>{console.log(` toggleBankVisibility called for Bank ${r}`),console.log(" Before: visibleBanks =",Array.from(n.visibleBanks)),n.visibleBanks.has(r)?(n.visibleBanks.delete(r),console.log(` Removed Bank ${r} from visibleBanks`)):(n.visibleBanks.add(r),console.log(` Added Bank ${r} to visibleBanks`)),console.log(" After: visibleBanks =",Array.from(n.visibleBanks))}),console.log(" Calling applyFilters after state update..."),t().applyFilters()},setBankVisibility:(r,n)=>{e(i=>{n?i.visibleBanks.add(r):i.visibleBanks.delete(r)}),t().applyFilters()},showAllBanks:()=>{e(r=>{console.log(" showAllBanks: clearing visibleBanks"),r.visibleBanks.clear()}),t().applyFilters()},assignDifferentialPair:(r,n,i)=>e(a=>{const s=a.pins.find(u=>u.id===r),o=a.pins.find(u=>u.id===n);s&&o&&(s.signalName=`${i}_P`,s.isAssigned=!0,s.differentialPair={pair:n,type:"positive"},o.signalName=`${i}_N`,o.isAssigned=!0,o.differentialPair={pair:r,type:"negative"})}),clearDifferentialPair:r=>e(n=>{const i=n.pins.find(a=>a.id===r);if(i&&i.differentialPair){const a=n.pins.find(s=>s.id===i.differentialPair.pair);i.differentialPair=void 0,i.signalName="",i.isAssigned=!1,a&&(a.differentialPair=void 0,a.signalName="",a.isAssigned=!1)}}),rotatePins:r=>e(n=>{n.viewConfig.rotation=(n.viewConfig.rotation+r)%360}),flipView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setLoading:r=>e(n=>{n.isLoading=r}),setError:r=>e(n=>{n.error=r}),setViewMode:r=>e(n=>{n.listView.viewMode=r}),setActiveTab:r=>e(n=>{n.listView.activeTab=r}),setSearchQuery:r=>e(n=>{n.listView.searchQuery=r}),setCommentFilter:r=>e(n=>{n.listView.commentFilter=r}),updateListViewState:r=>e(n=>{Object.assign(n.listView,r)}),bulkUpdateComments:(r,n)=>e(i=>{const a=new Date;r.forEach(s=>{const o=i.pins.find(u=>u.id===s);o&&(o.comment=n,o.commentTimestamp=a,o.commentAuthor="current_user")}),i.listView.selectedRows.clear()}),setPinColorMode:r=>e(n=>{n.pinColorMode=r}),addRecentFile:r=>e(n=>{const i=n.recentFiles.filter(a=>a!==r);n.recentFiles=[r,...i].slice(0,10)}),undo:()=>{const r=Tr.undo();r&&(t().handleUndoRedoAction(r,"undo"),t().updateUndoRedoState())},redo:()=>{const r=Tr.redo();r&&(t().handleUndoRedoAction(r,"redo"),t().updateUndoRedoState())},updateUndoRedoState:()=>e(r=>{r.canUndo=Tr.canUndo(),r.canRedo=Tr.canRedo();const n=Tr.getHistory(),i=Tr.getCurrentIndex();i>=0&&i<n.length?r.currentActionDescription=Tr.getActionDescription(n[i]):r.currentActionDescription=null,i+1<n.length?r.nextRedoActionDescription=Tr.getActionDescription(n[i+1]):r.nextRedoActionDescription=null}),clearHistory:()=>{Tr.clear(),t().updateUndoRedoState()},handleUndoRedoAction:(r,n)=>{const{type:i,data:a}=r;switch(i){case"PIN_ASSIGNMENT":const{pinId:s,oldSignal:o,newSignal:u}=a,f=n==="undo"?o:u;e(E=>{const S=E.pins.find(x=>x.id===s);S&&(S.signalName=f||"",S.isAssigned=!!f)}),t().applyFilters();break;case"BULK_ASSIGNMENT":const{assignments:d}=a;e(E=>{d.forEach(({pinId:S,oldSignal:x,newSignal:T})=>{const F=E.pins.find(N=>N.id===S);if(F){const N=n==="undo"?x:T;F.signalName=N||"",F.isAssigned=!!N}})}),t().applyFilters();break;case"SELECTION_CHANGE":const{oldSelection:p,newSelection:m}=a,v=n==="undo"?p:m;e(E=>{E.selectedPins=new Set(v)});break;case"VIEW_CHANGE":const{oldView:g,newView:y}=a,C=n==="undo"?g:y;e(E=>{Object.assign(E.viewConfig,C)});break;default:console.warn(`Unhandled undo/redo action type: ${i}`);break}}})));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $6=1252,_E=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],j2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},U2=function(e){_E.indexOf(e)!=-1&&($6=j2[0]=e)};function SE(){U2(1252)}var Vi=function(e){U2(e)};function X6(){Vi(1200),SE()}function F4(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function wE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function K6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var i0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?wE(e.slice(2)):t==254&&r==255?K6(e.slice(2)):t==65279?e.slice(1):e},If=function(t){return String.fromCharCode(t)},R4=function(t){return String.fromCharCode(t)},vs,ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b4(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,i=e.charCodeAt(f++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),t+=ws.charAt(a)+ws.charAt(s)+ws.charAt(o)+ws.charAt(u);return t}function ri(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=ws.indexOf(e.charAt(f++)),s=ws.indexOf(e.charAt(f++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=ws.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=ws.indexOf(e.charAt(f++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Io=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ls(e){return yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function I4(e){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zi=function(t){return yt?Io(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function z2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return z2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ys=yt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Io(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function kE(e){for(var t=[],r=0,n=e.length+250,i=Ls(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ls(65535),n=65530)}return t.push(i.slice(0,r)),ys(t)}var Pn=/\u0000/g,a0=/[\u0001-\u0006]/g;function Ll(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gi(e,t){var r=""+e;return r.length>=t?r:or("0",t-r.length)+r}function V2(e,t){var r=""+e;return r.length>=t?r:or(" ",t-r.length)+r}function Dd(e,t){var r=""+e;return r.length>=t?r:r+or(" ",t-r.length)}function CE(e,t){var r=""+Math.round(e);return r.length>=t?r:or("0",t-r.length)+r}function EE(e,t){var r=""+e;return r.length>=t?r:or("0",t-r.length)+r}var D4=Math.pow(2,32);function ul(e,t){if(e>D4||e<-D4)return CE(e,t);var r=Math.round(e);return EE(r,t)}function Od(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var O4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function TE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},L4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},AE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ld(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),o=p*s+a,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),a=s,s=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=a):(d=f,o=s)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function mo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=IE(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var Y6=new Date(1899,11,31,0,0,0),PE=Y6.getTime(),NE=new Date(1900,2,1,0,0,0);function Q6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=NE&&(r+=24*60*60*1e3),(r-(PE+(e.getTimezoneOffset()-Y6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function G2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function RE(e){var t=e<0?12:11,r=G2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function bE(e){var t=G2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Y0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=RE(e):t===10?r=e.toFixed(10).substr(0,12):r=bE(e),G2(FE(r.toUpperCase()))}function Po(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Y0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ei(14,Q6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function IE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function DE(e,t,r,n){var i="",a=0,s=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Zp[r.m-1][1];case 5:return Zp[r.m-1][0];default:return Zp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return O4[r.q][0];default:return O4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Gi(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?Gi(u,f):"";return d}function ks(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var q6=/%/g;function OE(e,t,r){var n=t.replace(q6,""),i=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*i))+or("%",i)}function LE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function J6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+J6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Z6=/# (\?+)( ?)\/( ?)(\d+)/;function ME(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?or(" ",e[1].length+1+e[4].length):V2(s,e[1].length)+e[2]+"/"+e[3]+Gi(o,e[4].length))}function BE(e,t,r){return r+(t===0?"":""+t)+or(" ",e[1].length+2+e[4].length)}var eS=/^#*0*\.([0#]+)/,tS=/\).*[0#]/,rS=/\(###\) ###\\?-####/;function kn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function M4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function B4(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function UE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function mi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(tS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mi("n",n,r):"("+mi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return LE(e,t,r);if(t.indexOf("%")!==-1)return OE(e,t,r);if(t.indexOf("E")!==-1)return J6(t,r);if(t.charCodeAt(0)===36)return"$"+mi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ul(u,t.length);if(t.match(/^[#?]+$/))return i=ul(r,0),i==="0"&&(i=""),i.length>t.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(Z6))return ME(a,u,f);if(t.match(/^#+0+$/))return f+ul(u,t.length-t.indexOf("0"));if(a=t.match(eS))return i=M4(r,a[1].length).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])).replace(/\.(\d*)$/,function(g,y){return"."+y+or("0",kn(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+M4(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ks(ul(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mi(e,t,-r):ks(""+(Math.floor(r)+jE(r,a[1].length)))+"."+Gi(B4(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return mi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(mi(e,t.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(rS))return i=mi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Ld(u,Math.pow(10,s)-1,!1),i=""+f,d=Ba("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Dd(o[2],s),d.length<a[4].length&&(d=kn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Ld(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V2(o[1],s)+a[2]+"/"+a[3]+Dd(o[2],s):or(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ul(r,0),t.length<=i.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,m=t.length-i.length-p;return kn(t.substr(0,p)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=B4(r,a[1].length),r<0?"-"+mi(e,t,-r):ks(UE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gi(0,3-g.length):"")+g})+"."+Gi(s,a[1].length);switch(t){case"###,##0.00":return mi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=ks(ul(u,0));return v!=="0"?f+v:"";case"###,###.00":return mi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return mi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function zE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function VE(e,t,r){var n=t.replace(q6,""),i=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*i))+or("%",i)}function nS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+nS(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ua(e,t,r){if(e.charCodeAt(0)===40&&!t.match(tS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ua("n",n,r):"("+ua("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return zE(e,t,r);if(t.indexOf("%")!==-1)return VE(e,t,r);if(t.indexOf("E")!==-1)return nS(t,r);if(t.charCodeAt(0)===36)return"$"+ua(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Gi(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(Z6))return BE(a,u,f);if(t.match(/^#+0+$/))return f+Gi(u,t.length-t.indexOf("0"));if(a=t.match(eS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kn(a[1])).replace(/\.$/,"."+kn(a[1])),i=i.replace(/\.(\d*)$/,function(g,y){return"."+y+or("0",kn(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ks(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):ks(""+r)+"."+or("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ua(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(ua(e,t.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<i.length?i.charAt(s++):g==="0"?"0":""}));if(t.match(rS))return i=ua(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Ld(u,Math.pow(10,s)-1,!1),i=""+f,d=Ba("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Dd(o[2],s),d.length<a[4].length&&(d=kn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Ld(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V2(o[1],s)+a[2]+"/"+a[3]+Dd(o[2],s):or(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:kn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,m=t.length-i.length-p;return kn(t.substr(0,p)+i+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):ks(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Gi(0,3-g.length):"")+g})+"."+Gi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=ks(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return ua(e,t.slice(0,t.lastIndexOf(".")),r)+kn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ba(e,t,r){return(r|0)===r?ua(e,t,r):mi(e,t,r)}function GE(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var iS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function sc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Od(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(iS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function HE(e,t,r,n){for(var i=[],a="",s=0,o="",u="t",f,d,p,m="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Od(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(p=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++s;break;case"\\":var v=e.charAt(++s),g=v==="("||v===")"?v:"t";i[i.length]={t:g,v},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=mo(t,r,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=mo(t,r),f==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:a},u=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=mo(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",m="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,m="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",s+=5,m="h"):(y.t="t",++s),f==null&&y.t==="T")return"";i[i.length]=y,u=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(iS)){if(f==null&&(f=mo(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",sc(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var C=0,E=0,S;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=m,u="h",C<1&&(C=1);break;case"s":(S=i[s].v.match(/\.0+$/))&&(E=Math.max(E,S[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&i[s].v.match(/[Hh]/)&&(C=1),C<2&&i[s].v.match(/[Mm]/)&&(C=2),C<3&&i[s].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",T;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=DE(i[s].t.charCodeAt(0),i[s].v,f,E),i[s].t="t";break;case"n":case"?":for(T=s+1;i[T]!=null&&((o=i[T].t)==="?"||o==="D"||(o===" "||o==="t")&&i[T+1]!=null&&(i[T+1].t==="?"||i[T+1].t==="t"&&i[T+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[T].v==="/"||i[T].v===" "&&i[T+1]!=null&&i[T+1].t=="?"));)i[s].v+=i[T].v,i[T]={v:"",t:";"},++T;x+=i[s].v,s=T-1;break;case"G":i[s].t="t",i[s].v=Po(t,r);break}var F="",N,A;if(x.length>0){x.charCodeAt(0)==40?(N=t<0&&x.charCodeAt(0)===45?-t:t,A=Ba("n",x,N)):(N=t<0&&n>1?-t:t,A=Ba("n",x,N),N<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),T=A.length-1;var P=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){P=s;break}var b=i.length;if(P===i.length&&A.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(T>=i[s].v.length-1?(T-=i[s].v.length,i[s].v=A.substr(T+1,i[s].v.length)):T<0?i[s].v="":(i[s].v=A.substr(0,T+1),T=-1),i[s].t="t",b=s);T>=0&&b<i.length&&(i[b].v=A.substr(0,T+1)+i[b].v)}else if(P!==i.length&&A.indexOf("E")===-1){for(T=A.indexOf(".")-1,s=P;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")-1:i[s].v.length-1,F=i[s].v.substr(d+1);d>=0;--d)T>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(F=A.charAt(T--)+F);i[s].v=F,i[s].t="t",b=s}for(T>=0&&b<i.length&&(i[b].v=A.substr(0,T+1)+i[b].v),T=A.indexOf(".")+1,s=P;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==P)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")+1:0,F=i[s].v.substr(0,d);d<i[s].v.length;++d)T<A.length&&(F+=A.charAt(T++));i[s].v=F,i[s].t="t",b=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(N=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Ba(i[s].t,i[s].v,N),i[s].t="t");var I="";for(s=0;s!==i.length;++s)i[s]!=null&&(I+=i[s].v);return I}var j4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function U4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function WE(e,t){var r=GE(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(j4),o=r[1].match(j4);return U4(t,s)?[n,r[0]]:U4(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Ei(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ct)[e],n==null&&(n=r.table&&r.table[L4[e]]||ct[L4[e]]),n==null&&(n=AE[e]||"General");break}if(Od(n,0))return Po(t,r);t instanceof Date&&(t=Q6(t,r.date1904));var i=WE(n,t);if(Od(i[1]))return Po(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return HE(i[1],t,r,i[0])}function _o(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ct[r]==null){t<0&&(t=r);continue}if(ct[r]==e){t=r;break}}t<0&&(t=391)}return ct[t]=e,t}function aS(){ct=TE()}var $E={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},sS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function XE(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(sS,"(\\d+)"),new RegExp("^"+t+"$")}function KE(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,u=-1;(t.match(sS)||[]).forEach(function(p,m){var v=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":s=v;break;case"s":u=v;break;case"m":s>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var YE=function(){var e={};e.version="1.2.0";function t(){for(var A=0,P=new Array(256),b=0;b!=256;++b)A=b,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[b]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(A){var P=0,b=0,I=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)O[I]=A[I];for(I=0;I!=256;++I)for(b=A[I],P=256+I;P<4096;P+=256)b=O[P]=b>>>8^A[b&255];var j=[];for(I=1;I!=16;++I)j[I-1]=typeof Int32Array<"u"?O.subarray(I*256,I*256+256):O.slice(I*256,I*256+256);return j}var i=n(r),a=i[0],s=i[1],o=i[2],u=i[3],f=i[4],d=i[5],p=i[6],m=i[7],v=i[8],g=i[9],y=i[10],C=i[11],E=i[12],S=i[13],x=i[14];function T(A,P){for(var b=P^-1,I=0,O=A.length;I<O;)b=b>>>8^r[(b^A.charCodeAt(I++))&255];return~b}function F(A,P){for(var b=P^-1,I=A.length-15,O=0;O<I;)b=x[A[O++]^b&255]^S[A[O++]^b>>8&255]^E[A[O++]^b>>16&255]^C[A[O++]^b>>>24]^y[A[O++]]^g[A[O++]]^v[A[O++]]^m[A[O++]]^p[A[O++]]^d[A[O++]]^f[A[O++]]^u[A[O++]]^o[A[O++]]^s[A[O++]]^a[A[O++]]^r[A[O++]];for(I+=15;O<I;)b=b>>>8^r[(b^A[O++])&255];return~b}function N(A,P){for(var b=P^-1,I=0,O=A.length,j=0,q=0;I<O;)j=A.charCodeAt(I++),j<128?b=b>>>8^r[(b^j)&255]:j<2048?(b=b>>>8^r[(b^(192|j>>6&31))&255],b=b>>>8^r[(b^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,q=A.charCodeAt(I++)&1023,b=b>>>8^r[(b^(240|j>>8&7))&255],b=b>>>8^r[(b^(128|j>>2&63))&255],b=b>>>8^r[(b^(128|q>>6&15|(j&3)<<4))&255],b=b>>>8^r[(b^(128|q&63))&255]):(b=b>>>8^r[(b^(224|j>>12&15))&255],b=b>>>8^r[(b^(128|j>>6&63))&255],b=b>>>8^r[(b^(128|j&63))&255]);return~b}return e.table=r,e.bstr=T,e.buf=F,e.str=N,e}(),wt=function(){var t={};t.version="1.2.1";function r(D,z){for(var M=D.split("/"),U=z.split("/"),H=0,W=0,se=Math.min(M.length,U.length);H<se;++H){if(W=M[H].length-U[H].length)return W;if(M[H]!=U[H])return M[H]<U[H]?-1:1}return M.length-U.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var z=D.lastIndexOf("/");return z===-1?D:D.slice(0,z+1)}function i(D){if(D.charAt(D.length-1)=="/")return i(D.slice(0,-1));var z=D.lastIndexOf("/");return z===-1?D:D.slice(z+1)}function a(D,z){typeof z=="string"&&(z=new Date(z));var M=z.getHours();M=M<<6|z.getMinutes(),M=M<<5|z.getSeconds()>>>1,D.write_shift(2,M);var U=z.getFullYear()-1980;U=U<<4|z.getMonth()+1,U=U<<5|z.getDate(),D.write_shift(2,U)}function s(D){var z=D.read_shift(2)&65535,M=D.read_shift(2)&65535,U=new Date,H=M&31;M>>>=5;var W=M&15;M>>>=4,U.setMilliseconds(0),U.setFullYear(M+1980),U.setMonth(W-1),U.setDate(H);var se=z&31;z>>>=5;var ye=z&63;return z>>>=6,U.setHours(z),U.setMinutes(ye),U.setSeconds(se<<1),U}function o(D){Yr(D,0);for(var z={},M=0;D.l<=D.length-4;){var U=D.read_shift(2),H=D.read_shift(2),W=D.l+H,se={};switch(U){case 21589:M=D.read_shift(1),M&1&&(se.mtime=D.read_shift(4)),H>5&&(M&2&&(se.atime=D.read_shift(4)),M&4&&(se.ctime=D.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}D.l=W,z[U]=se}return z}var u;function f(){return u||(u={})}function d(D,z){if(D[0]==80&&D[1]==75)return Ue(D,z);if((D[0]|32)==109&&(D[1]|32)==105)return bn(D,z);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var M=3,U=512,H=0,W=0,se=0,ye=0,ne=0,oe=[],le=D.slice(0,512);Yr(le,0);var Ne=p(le);switch(M=Ne[0],M){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ne[1]==0)return Ue(D,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}U!==512&&(le=D.slice(0,U),Yr(le,28));var je=D.slice(0,U);m(le,M);var He=le.read_shift(4,"i");if(M===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);le.l+=4,se=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ye=le.read_shift(4,"i"),H=le.read_shift(4,"i"),ne=le.read_shift(4,"i"),W=le.read_shift(4,"i");for(var Ie=-1,ze=0;ze<109&&(Ie=le.read_shift(4,"i"),!(Ie<0));++ze)oe[ze]=Ie;var nt=v(D,U);C(ne,W,nt,U,oe);var It=S(nt,se,oe,U);It[se].name="!Directory",H>0&&ye!==q&&(It[ye].name="!MiniFAT"),It[oe[0]].name="!FAT",It.fat_addrs=oe,It.ssz=U;var Ut={},mr=[],Qs=[],_a=[];x(se,It,nt,mr,H,Ut,Qs,ye),g(Qs,_a,mr),mr.shift();var ai={FileIndex:Qs,FullPaths:_a};return z&&z.raw&&(ai.raw={header:je,sectors:nt}),ai}function p(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ie,"Header Signature: "),D.l+=16;var z=D.read_shift(2,"u");return[D.read_shift(2,"u"),z]}function m(D,z){var M=9;switch(D.l+=2,M=D.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function v(D,z){for(var M=Math.ceil(D.length/z)-1,U=[],H=1;H<M;++H)U[H-1]=D.slice(H*z,(H+1)*z);return U[M-1]=D.slice(M*z),U}function g(D,z,M){for(var U=0,H=0,W=0,se=0,ye=0,ne=M.length,oe=[],le=[];U<ne;++U)oe[U]=le[U]=U,z[U]=M[U];for(;ye<le.length;++ye)U=le[ye],H=D[U].L,W=D[U].R,se=D[U].C,oe[U]===U&&(H!==-1&&oe[H]!==H&&(oe[U]=oe[H]),W!==-1&&oe[W]!==W&&(oe[U]=oe[W])),se!==-1&&(oe[se]=U),H!==-1&&U!=oe[U]&&(oe[H]=oe[U],le.lastIndexOf(H)<ye&&le.push(H)),W!==-1&&U!=oe[U]&&(oe[W]=oe[U],le.lastIndexOf(W)<ye&&le.push(W));for(U=1;U<ne;++U)oe[U]===U&&(W!==-1&&oe[W]!==W?oe[U]=oe[W]:H!==-1&&oe[H]!==H&&(oe[U]=oe[H]));for(U=1;U<ne;++U)if(D[U].type!==0){if(ye=U,ye!=oe[ye])do ye=oe[ye],z[U]=z[ye]+"/"+z[U];while(ye!==0&&oe[ye]!==-1&&ye!=oe[ye]);oe[U]=-1}for(z[0]+="/",U=1;U<ne;++U)D[U].type!==2&&(z[U]+="/")}function y(D,z,M){for(var U=D.start,H=D.size,W=[],se=U;M&&H>0&&se>=0;)W.push(z.slice(se*j,se*j+j)),H-=j,se=fo(M,se*4);return W.length===0?Pr(0):ys(W).slice(0,D.size)}function C(D,z,M,U,H){var W=q;if(D===q){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var se=M[D],ye=(U>>>2)-1;if(!se)return;for(var ne=0;ne<ye&&(W=fo(se,ne*4))!==q;++ne)H.push(W);C(fo(se,U-4),z-1,M,U,H)}}function E(D,z,M,U,H){var W=[],se=[];H||(H=[]);var ye=U-1,ne=0,oe=0;for(ne=z;ne>=0;){H[ne]=!0,W[W.length]=ne,se.push(D[ne]);var le=M[Math.floor(ne*4/U)];if(oe=ne*4&ye,U<4+oe)throw new Error("FAT boundary crossed: "+ne+" 4 "+U);if(!D[le])break;ne=fo(D[le],oe)}return{nodes:W,data:Q4([se])}}function S(D,z,M,U){var H=D.length,W=[],se=[],ye=[],ne=[],oe=U-1,le=0,Ne=0,je=0,He=0;for(le=0;le<H;++le)if(ye=[],je=le+z,je>=H&&(je-=H),!se[je]){ne=[];var Ie=[];for(Ne=je;Ne>=0;){Ie[Ne]=!0,se[Ne]=!0,ye[ye.length]=Ne,ne.push(D[Ne]);var ze=M[Math.floor(Ne*4/U)];if(He=Ne*4&oe,U<4+He)throw new Error("FAT boundary crossed: "+Ne+" 4 "+U);if(!D[ze]||(Ne=fo(D[ze],He),Ie[Ne]))break}W[je]={nodes:ye,data:Q4([ne])}}return W}function x(D,z,M,U,H,W,se,ye){for(var ne=0,oe=U.length?2:0,le=z[D].data,Ne=0,je=0,He;Ne<le.length;Ne+=128){var Ie=le.slice(Ne,Ne+128);Yr(Ie,64),je=Ie.read_shift(2),He=K2(Ie,0,je-oe),U.push(He);var ze={name:He,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},nt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);nt!==0&&(ze.ct=T(Ie,Ie.l-8));var It=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);It!==0&&(ze.mt=T(Ie,Ie.l-8)),ze.start=Ie.read_shift(4,"i"),ze.size=Ie.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=q,ze.name=""),ze.type===5?(ne=ze.start,H>0&&ne!==q&&(z[ne].name="!StreamData")):ze.size>=4096?(ze.storage="fat",z[ze.start]===void 0&&(z[ze.start]=E(M,ze.start,z.fat_addrs,z.ssz)),z[ze.start].name=ze.name,ze.content=z[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ne!==q&&ze.start!==q&&z[ne]&&(ze.content=y(ze,z[ne].data,(z[ye]||{}).data))),ze.content&&Yr(ze.content,0),W[He]=ze,se.push(ze)}}function T(D,z){return new Date((Qn(D,z+4)/1e7*Math.pow(2,32)+Qn(D,z)/1e7-11644473600)*1e3)}function F(D,z){return f(),d(u.readFileSync(D),z)}function N(D,z){var M=z&&z.type;switch(M||yt&&Buffer.isBuffer(D)&&(M="buffer"),M||"base64"){case"file":return F(D,z);case"base64":return d(zi(ri(D)),z);case"binary":return d(zi(D),z)}return d(D,z)}function A(D,z){var M=z||{},U=M.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=U+"/",D.FileIndex[0]={name:U,type:5}),M.CLSID&&(D.FileIndex[0].clsid=M.CLSID),P(D)}function P(D){var z="Sh33tJ5";if(!wt.find(D,"/"+z)){var M=Pr(4);M[0]=55,M[1]=M[3]=50,M[2]=54,D.FileIndex.push({name:z,type:2,content:M,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+z),b(D)}}function b(D,z){A(D);for(var M=!1,U=!1,H=D.FullPaths.length-1;H>=0;--H){var W=D.FileIndex[H];switch(W.type){case 0:U?M=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(W.R*W.L*W.C)&&(M=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!z)){var se=new Date(1987,1,19),ye=0,ne=Object.create?Object.create(null):{},oe=[];for(H=0;H<D.FullPaths.length;++H)ne[D.FullPaths[H]]=!0,D.FileIndex[H].type!==0&&oe.push([D.FullPaths[H],D.FileIndex[H]]);for(H=0;H<oe.length;++H){var le=n(oe[H][0]);U=ne[le],U||(oe.push([le,{name:i(le).replace("/",""),type:1,clsid:Ae,ct:se,mt:se,content:null}]),ne[le]=!0)}for(oe.sort(function(He,Ie){return r(He[0],Ie[0])}),D.FullPaths=[],D.FileIndex=[],H=0;H<oe.length;++H)D.FullPaths[H]=oe[H][0],D.FileIndex[H]=oe[H][1];for(H=0;H<oe.length;++H){var Ne=D.FileIndex[H],je=D.FullPaths[H];if(Ne.name=i(je).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Ae,H===0)Ne.C=oe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(je.slice(-1)=="/"){for(ye=H+1;ye<oe.length&&n(D.FullPaths[ye])!=je;++ye);for(Ne.C=ye>=oe.length?-1:ye,ye=H+1;ye<oe.length&&n(D.FullPaths[ye])!=n(je);++ye);Ne.R=ye>=oe.length?-1:ye,Ne.type=1}else n(D.FullPaths[H+1]||"")==n(je)&&(Ne.R=H+1),Ne.type=2}}}function I(D,z){var M=z||{};if(M.fileType=="mad")return _n(D,M);switch(b(D),M.fileType){case"zip":return at(D,M)}var U=function(He){for(var Ie=0,ze=0,nt=0;nt<He.FileIndex.length;++nt){var It=He.FileIndex[nt];if(It.content){var Ut=It.content.length;Ut>0&&(Ut<4096?Ie+=Ut+63>>6:ze+=Ut+511>>9)}}for(var mr=He.FullPaths.length+3>>2,Qs=Ie+7>>3,_a=Ie+127>>7,ai=Qs+ze+mr+_a,tn=ai+127>>7,Dt=tn<=109?0:Math.ceil((tn-109)/127);ai+tn+Dt+127>>7>tn;)Dt=++tn<=109?0:Math.ceil((tn-109)/127);var mt=[1,Dt,tn,_a,mr,ze,Ie,0];return He.FileIndex[0].size=Ie<<6,mt[7]=(He.FileIndex[0].start=mt[0]+mt[1]+mt[2]+mt[3]+mt[4]+mt[5])+(mt[6]+7>>3),mt}(D),H=Pr(U[7]<<9),W=0,se=0;{for(W=0;W<8;++W)H.write_shift(1,te[W]);for(W=0;W<8;++W)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),W=0;W<3;++W)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,U[2]),H.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:q),H.write_shift(4,U[3]),H.write_shift(-4,U[1]?U[0]-1:q),H.write_shift(4,U[1]),W=0;W<109;++W)H.write_shift(-4,W<U[2]?U[1]+W:-1)}if(U[1])for(se=0;se<U[1];++se){for(;W<236+se*127;++W)H.write_shift(-4,W<U[2]?U[1]+W:-1);H.write_shift(-4,se===U[1]-1?q:se+1)}var ye=function(He){for(se+=He;W<se-1;++W)H.write_shift(-4,W+1);He&&(++W,H.write_shift(-4,q))};for(se=W=0,se+=U[1];W<se;++W)H.write_shift(-4,Ee.DIFSECT);for(se+=U[2];W<se;++W)H.write_shift(-4,Ee.FATSECT);ye(U[3]),ye(U[4]);for(var ne=0,oe=0,le=D.FileIndex[0];ne<D.FileIndex.length;++ne)le=D.FileIndex[ne],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=se,ye(oe+511>>9)));for(ye(U[6]+7>>3);H.l&511;)H.write_shift(-4,Ee.ENDOFCHAIN);for(se=W=0,ne=0;ne<D.FileIndex.length;++ne)le=D.FileIndex[ne],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=se,ye(oe+63>>6)));for(;H.l&511;)H.write_shift(-4,Ee.ENDOFCHAIN);for(W=0;W<U[4]<<2;++W){var Ne=D.FullPaths[W];if(!Ne||Ne.length===0){for(ne=0;ne<17;++ne)H.write_shift(4,0);for(ne=0;ne<3;++ne)H.write_shift(4,-1);for(ne=0;ne<12;++ne)H.write_shift(4,0);continue}le=D.FileIndex[W],W===0&&(le.start=le.size?le.start-1:q);var je=W===0&&M.root||le.name;if(oe=2*(je.length+1),H.write_shift(64,je,"utf16le"),H.write_shift(2,oe),H.write_shift(1,le.type),H.write_shift(1,le.color),H.write_shift(-4,le.L),H.write_shift(-4,le.R),H.write_shift(-4,le.C),le.clsid)H.write_shift(16,le.clsid,"hex");else for(ne=0;ne<4;++ne)H.write_shift(4,0);H.write_shift(4,le.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,le.start),H.write_shift(4,le.size),H.write_shift(4,0)}for(W=1;W<D.FileIndex.length;++W)if(le=D.FileIndex[W],le.size>=4096)if(H.l=le.start+1<<9,yt&&Buffer.isBuffer(le.content))le.content.copy(H,H.l,0,le.size),H.l+=le.size+511&-512;else{for(ne=0;ne<le.size;++ne)H.write_shift(1,le.content[ne]);for(;ne&511;++ne)H.write_shift(1,0)}for(W=1;W<D.FileIndex.length;++W)if(le=D.FileIndex[W],le.size>0&&le.size<4096)if(yt&&Buffer.isBuffer(le.content))le.content.copy(H,H.l,0,le.size),H.l+=le.size+63&-64;else{for(ne=0;ne<le.size;++ne)H.write_shift(1,le.content[ne]);for(;ne&63;++ne)H.write_shift(1,0)}if(yt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function O(D,z){var M=D.FullPaths.map(function(ne){return ne.toUpperCase()}),U=M.map(function(ne){var oe=ne.split("/");return oe[oe.length-(ne.slice(-1)=="/"?2:1)]}),H=!1;z.charCodeAt(0)===47?(H=!0,z=M[0].slice(0,-1)+z):H=z.indexOf("/")!==-1;var W=z.toUpperCase(),se=H===!0?M.indexOf(W):U.indexOf(W);if(se!==-1)return D.FileIndex[se];var ye=!W.match(a0);for(W=W.replace(Pn,""),ye&&(W=W.replace(a0,"!")),se=0;se<M.length;++se)if((ye?M[se].replace(a0,"!"):M[se]).replace(Pn,"")==W||(ye?U[se].replace(a0,"!"):U[se]).replace(Pn,"")==W)return D.FileIndex[se];return null}var j=64,q=-2,ie="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(D,z,M){f();var U=I(D,M);u.writeFileSync(z,U)}function X(D){for(var z=new Array(D.length),M=0;M<D.length;++M)z[M]=String.fromCharCode(D[M]);return z.join("")}function he(D,z){var M=I(D,z);switch(z&&z.type||"buffer"){case"file":return f(),u.writeFileSync(z.filename,M),M;case"binary":return typeof M=="string"?M:X(M);case"base64":return b4(typeof M=="string"?M:X(M));case"buffer":if(yt)return Buffer.isBuffer(M)?M:Io(M);case"array":return typeof M=="string"?zi(M):M}return M}var Te;function L(D){try{var z=D.InflateRaw,M=new z;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Te=D;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function Q(D,z){if(!Te)return Za(D,z);var M=Te.InflateRaw,U=new M,H=U._processChunk(D.slice(D.l),U._finishFlushFlag);return D.l+=U.bytesRead,H}function Y(D){return Te?Te.deflateRawSync(D):xe(D)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Z(D){var z=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(z>>16|z>>8|z)&255}for(var fe=typeof Uint8Array<"u",ve=fe?new Uint8Array(256):[],Be=0;Be<256;++Be)ve[Be]=Z(Be);function G(D,z){var M=ve[D&255];return z<=8?M>>>8-z:(M=M<<8|ve[D>>8&255],z<=16?M>>>16-z:(M=M<<8|ve[D>>16&255],M>>>24-z))}function qe(D,z){var M=z&7,U=z>>>3;return(D[U]|(M<=6?0:D[U+1]<<8))>>>M&3}function et(D,z){var M=z&7,U=z>>>3;return(D[U]|(M<=5?0:D[U+1]<<8))>>>M&7}function Ye(D,z){var M=z&7,U=z>>>3;return(D[U]|(M<=4?0:D[U+1]<<8))>>>M&15}function Qe(D,z){var M=z&7,U=z>>>3;return(D[U]|(M<=3?0:D[U+1]<<8))>>>M&31}function Fe(D,z){var M=z&7,U=z>>>3;return(D[U]|(M<=1?0:D[U+1]<<8))>>>M&127}function St(D,z,M){var U=z&7,H=z>>>3,W=(1<<M)-1,se=D[H]>>>U;return M<8-U||(se|=D[H+1]<<8-U,M<16-U)||(se|=D[H+2]<<16-U,M<24-U)||(se|=D[H+3]<<24-U),se&W}function Or(D,z,M){var U=z&7,H=z>>>3;return U<=5?D[H]|=(M&7)<<U:(D[H]|=M<<U&255,D[H+1]=(M&7)>>8-U),z+3}function gr(D,z,M){var U=z&7,H=z>>>3;return M=(M&1)<<U,D[H]|=M,z+1}function _e(D,z,M){var U=z&7,H=z>>>3;return M<<=U,D[H]|=M&255,M>>>=8,D[H+1]=M,z+8}function me(D,z,M){var U=z&7,H=z>>>3;return M<<=U,D[H]|=M&255,M>>>=8,D[H+1]=M&255,D[H+2]=M>>>8,z+16}function ke(D,z){var M=D.length,U=2*M>z?2*M:z+5,H=0;if(M>=z)return D;if(yt){var W=I4(U);if(D.copy)D.copy(W);else for(;H<D.length;++H)W[H]=D[H];return W}else if(fe){var se=new Uint8Array(U);if(se.set)se.set(D);else for(;H<M;++H)se[H]=D[H];return se}return D.length=U,D}function we(D){for(var z=new Array(D),M=0;M<D;++M)z[M]=0;return z}function Ce(D,z,M){var U=1,H=0,W=0,se=0,ye=0,ne=D.length,oe=fe?new Uint16Array(32):we(32);for(W=0;W<32;++W)oe[W]=0;for(W=ne;W<M;++W)D[W]=0;ne=D.length;var le=fe?new Uint16Array(ne):we(ne);for(W=0;W<ne;++W)oe[H=D[W]]++,U<H&&(U=H),le[W]=0;for(oe[0]=0,W=1;W<=U;++W)oe[W+16]=ye=ye+oe[W-1]<<1;for(W=0;W<ne;++W)ye=D[W],ye!=0&&(le[W]=oe[ye+16]++);var Ne=0;for(W=0;W<ne;++W)if(Ne=D[W],Ne!=0)for(ye=G(le[W],U)>>U-Ne,se=(1<<U+4-Ne)-1;se>=0;--se)z[ye|se<<Ne]=Ne&15|W<<4;return U}var Pe=fe?new Uint16Array(512):we(512),Me=fe?new Uint16Array(32):we(32);if(!fe){for(var pe=0;pe<512;++pe)Pe[pe]=0;for(pe=0;pe<32;++pe)Me[pe]=0}(function(){for(var D=[],z=0;z<32;z++)D.push(5);Ce(D,Me,32);var M=[];for(z=0;z<=143;z++)M.push(8);for(;z<=255;z++)M.push(9);for(;z<=279;z++)M.push(7);for(;z<=287;z++)M.push(8);Ce(M,Pe,288)})();var ae=function(){for(var z=fe?new Uint8Array(32768):[],M=0,U=0;M<V.length-1;++M)for(;U<V[M+1];++U)z[U]=M;for(;U<32768;++U)z[U]=29;var H=fe?new Uint8Array(259):[];for(M=0,U=0;M<ue.length-1;++M)for(;U<ue[M+1];++U)H[U]=M;function W(ye,ne){for(var oe=0;oe<ye.length;){var le=Math.min(65535,ye.length-oe),Ne=oe+le==ye.length;for(ne.write_shift(1,+Ne),ne.write_shift(2,le),ne.write_shift(2,~le&65535);le-- >0;)ne[ne.l++]=ye[oe++]}return ne.l}function se(ye,ne){for(var oe=0,le=0,Ne=fe?new Uint16Array(32768):[];le<ye.length;){var je=Math.min(65535,ye.length-le);if(je<10){for(oe=Or(ne,oe,+(le+je==ye.length)),oe&7&&(oe+=8-(oe&7)),ne.l=oe/8|0,ne.write_shift(2,je),ne.write_shift(2,~je&65535);je-- >0;)ne[ne.l++]=ye[le++];oe=ne.l*8;continue}oe=Or(ne,oe,+(le+je==ye.length)+2);for(var He=0;je-- >0;){var Ie=ye[le];He=(He<<5^Ie)&32767;var ze=-1,nt=0;if((ze=Ne[He])&&(ze|=le&-32768,ze>le&&(ze-=32768),ze<le))for(;ye[ze+nt]==ye[le+nt]&&nt<250;)++nt;if(nt>2){Ie=H[nt],Ie<=22?oe=_e(ne,oe,ve[Ie+1]>>1)-1:(_e(ne,oe,3),oe+=5,_e(ne,oe,ve[Ie-23]>>5),oe+=3);var It=Ie<8?0:Ie-4>>2;It>0&&(me(ne,oe,nt-ue[Ie]),oe+=It),Ie=z[le-ze],oe=_e(ne,oe,ve[Ie]>>3),oe-=3;var Ut=Ie<4?0:Ie-2>>1;Ut>0&&(me(ne,oe,le-ze-V[Ie]),oe+=Ut);for(var mr=0;mr<nt;++mr)Ne[He]=le&32767,He=(He<<5^ye[le])&32767,++le;je-=nt-1}else Ie<=143?Ie=Ie+48:oe=gr(ne,oe,1),oe=_e(ne,oe,ve[Ie]),Ne[He]=le&32767,++le}oe=_e(ne,oe,0)-1}return ne.l=(oe+7)/8|0,ne.l}return function(ne,oe){return ne.length<8?W(ne,oe):se(ne,oe)}}();function xe(D){var z=Pr(50+Math.floor(D.length*1.1)),M=ae(D,z);return z.slice(0,M)}var be=fe?new Uint16Array(32768):we(32768),Le=fe?new Uint16Array(32768):we(32768),Xe=fe?new Uint16Array(128):we(128),gt=1,Bt=1;function jt(D,z){var M=Qe(D,z)+257;z+=5;var U=Qe(D,z)+1;z+=5;var H=Ye(D,z)+4;z+=4;for(var W=0,se=fe?new Uint8Array(19):we(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,oe=fe?new Uint8Array(8):we(8),le=fe?new Uint8Array(8):we(8),Ne=se.length,je=0;je<H;++je)se[K[je]]=W=et(D,z),ne<W&&(ne=W),oe[W]++,z+=3;var He=0;for(oe[0]=0,je=1;je<=ne;++je)le[je]=He=He+oe[je-1]<<1;for(je=0;je<Ne;++je)(He=se[je])!=0&&(ye[je]=le[He]++);var Ie=0;for(je=0;je<Ne;++je)if(Ie=se[je],Ie!=0){He=ve[ye[je]]>>8-Ie;for(var ze=(1<<7-Ie)-1;ze>=0;--ze)Xe[He|ze<<Ie]=Ie&7|je<<3}var nt=[];for(ne=1;nt.length<M+U;)switch(He=Xe[Fe(D,z)],z+=He&7,He>>>=3){case 16:for(W=3+qe(D,z),z+=2,He=nt[nt.length-1];W-- >0;)nt.push(He);break;case 17:for(W=3+et(D,z),z+=3;W-- >0;)nt.push(0);break;case 18:for(W=11+Fe(D,z),z+=7;W-- >0;)nt.push(0);break;default:nt.push(He),ne<He&&(ne=He);break}var It=nt.slice(0,M),Ut=nt.slice(M);for(je=M;je<286;++je)It[je]=0;for(je=U;je<30;++je)Ut[je]=0;return gt=Ce(It,be,286),Bt=Ce(Ut,Le,30),z}function ar(D,z){if(D[0]==3&&!(D[1]&3))return[Ls(z),2];for(var M=0,U=0,H=I4(z||1<<18),W=0,se=H.length>>>0,ye=0,ne=0;!(U&1);){if(U=et(D,M),M+=3,U>>>1)U>>1==1?(ye=9,ne=5):(M=jt(D,M),ye=gt,ne=Bt);else{M&7&&(M+=8-(M&7));var oe=D[M>>>3]|D[(M>>>3)+1]<<8;if(M+=32,oe>0)for(!z&&se<W+oe&&(H=ke(H,W+oe),se=H.length);oe-- >0;)H[W++]=D[M>>>3],M+=8;continue}for(;;){!z&&se<W+32767&&(H=ke(H,W+32767),se=H.length);var le=St(D,M,ye),Ne=U>>>1==1?Pe[le]:be[le];if(M+=Ne&15,Ne>>>=4,!(Ne>>>8&255))H[W++]=Ne;else{if(Ne==256)break;Ne-=257;var je=Ne<8?0:Ne-4>>2;je>5&&(je=0);var He=W+ue[Ne];je>0&&(He+=St(D,M,je),M+=je),le=St(D,M,ne),Ne=U>>>1==1?Me[le]:Le[le],M+=Ne&15,Ne>>>=4;var Ie=Ne<4?0:Ne-2>>1,ze=V[Ne];for(Ie>0&&(ze+=St(D,M,Ie),M+=Ie),!z&&se<He&&(H=ke(H,He+100),se=H.length);W<He;)H[W]=H[W-ze],++W}}}return z?[H,M+7>>>3]:[H.slice(0,W),M+7>>>3]}function Za(D,z){var M=D.slice(D.l||0),U=ar(M,z);return D.l+=U[1],U[0]}function Oe(D,z){if(D)typeof console<"u"&&console.error(z);else throw new Error(z)}function Ue(D,z){var M=D;Yr(M,0);var U=[],H=[],W={FileIndex:U,FullPaths:H};A(W,{root:z.root});for(var se=M.length-4;(M[se]!=80||M[se+1]!=75||M[se+2]!=5||M[se+3]!=6)&&se>=0;)--se;M.l=se+4,M.l+=4;var ye=M.read_shift(2);M.l+=6;var ne=M.read_shift(4);for(M.l=ne,se=0;se<ye;++se){M.l+=20;var oe=M.read_shift(4),le=M.read_shift(4),Ne=M.read_shift(2),je=M.read_shift(2),He=M.read_shift(2);M.l+=8;var Ie=M.read_shift(4),ze=o(M.slice(M.l+Ne,M.l+Ne+je));M.l+=Ne+je+He;var nt=M.l;M.l=Ie+4,Ze(M,oe,le,W,ze),M.l=nt}return W}function Ze(D,z,M,U,H){D.l+=2;var W=D.read_shift(2),se=D.read_shift(2),ye=s(D);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ne=D.read_shift(4),oe=D.read_shift(4),le=D.read_shift(4),Ne=D.read_shift(2),je=D.read_shift(2),He="",Ie=0;Ie<Ne;++Ie)He+=String.fromCharCode(D[D.l++]);if(je){var ze=o(D.slice(D.l,D.l+je));(ze[21589]||{}).mt&&(ye=ze[21589].mt),((H||{})[21589]||{}).mt&&(ye=H[21589].mt)}D.l+=je;var nt=D.slice(D.l,D.l+oe);switch(se){case 8:nt=Q(D,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var It=!1;W&8&&(ne=D.read_shift(4),ne==134695760&&(ne=D.read_shift(4),It=!0),oe=D.read_shift(4),le=D.read_shift(4)),oe!=z&&Oe(It,"Bad compressed size: "+z+" != "+oe),le!=M&&Oe(It,"Bad uncompressed size: "+M+" != "+le),es(U,He,nt,{unsafe:!0,mt:ye})}function at(D,z){var M=z||{},U=[],H=[],W=Pr(1),se=M.compression?8:0,ye=0,ne=0,oe=0,le=0,Ne=0,je=D.FullPaths[0],He=je,Ie=D.FileIndex[0],ze=[],nt=0;for(ne=1;ne<D.FullPaths.length;++ne)if(He=D.FullPaths[ne].slice(je.length),Ie=D.FileIndex[ne],!(!Ie.size||!Ie.content||He=="Sh33tJ5")){var It=le,Ut=Pr(He.length);for(oe=0;oe<He.length;++oe)Ut.write_shift(1,He.charCodeAt(oe)&127);Ut=Ut.slice(0,Ut.l),ze[Ne]=YE.buf(Ie.content,0);var mr=Ie.content;se==8&&(mr=Y(mr)),W=Pr(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,se),Ie.mt?a(W,Ie.mt):W.write_shift(4,0),W.write_shift(-4,ze[Ne]),W.write_shift(4,mr.length),W.write_shift(4,Ie.content.length),W.write_shift(2,Ut.length),W.write_shift(2,0),le+=W.length,U.push(W),le+=Ut.length,U.push(Ut),le+=mr.length,U.push(mr),W=Pr(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,se),W.write_shift(4,0),W.write_shift(-4,ze[Ne]),W.write_shift(4,mr.length),W.write_shift(4,Ie.content.length),W.write_shift(2,Ut.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,It),nt+=W.l,H.push(W),nt+=Ut.length,H.push(Ut),++Ne}return W=Pr(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Ne),W.write_shift(2,Ne),W.write_shift(4,nt),W.write_shift(4,le),W.write_shift(2,0),ys([ys(U),ys(H),W])}var vt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ft(D,z){if(D.ctype)return D.ctype;var M=D.name||"",U=M.match(/\.([^\.]+)$/);return U&&vt[U[1]]||z&&(U=(M=z).match(/[\.\\]([^\.\\])+$/),U&&vt[U[1]])?vt[U[1]]:"application/octet-stream"}function Rt(D){for(var z=b4(D),M=[],U=0;U<z.length;U+=76)M.push(z.slice(U,U+76));return M.join(`\r
`)+`\r
`}function qi(D){var z=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],U=z.split(`\r
`),H=0;H<U.length;++H){var W=U[H];if(W.length==0){M.push("");continue}for(var se=0;se<W.length;){var ye=76,ne=W.slice(se,se+ye);ne.charAt(ye-1)=="="?ye--:ne.charAt(ye-2)=="="?ye-=2:ne.charAt(ye-3)=="="&&(ye-=3),ne=W.slice(se,se+ye),se+=ye,se<W.length&&(ne+="="),M.push(ne)}}return M.join(`\r
`)}function en(D){for(var z=[],M=0;M<D.length;++M){for(var U=D[M];M<=D.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+D[++M];z.push(U)}for(var H=0;H<z.length;++H)z[H]=z[H].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return zi(z.join(`\r
`))}function Ji(D,z,M){for(var U="",H="",W="",se,ye=0;ye<10;++ye){var ne=z[ye];if(!ne||ne.match(/^\s*$/))break;var oe=ne.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":U=oe[2].trim();break;case"content-type":W=oe[2].trim();break;case"content-transfer-encoding":H=oe[2].trim();break}}switch(++ye,H.toLowerCase()){case"base64":se=zi(ri(z.slice(ye).join("")));break;case"quoted-printable":se=en(z.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var le=es(D,U.slice(M.length),se,{unsafe:!0});W&&(le.ctype=W)}function bn(D,z){if(X(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=z&&z.root||"",U=(yt&&Buffer.isBuffer(D)?D.toString("binary"):X(D)).split(`\r
`),H=0,W="";for(H=0;H<U.length;++H)if(W=U[H],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),M||(M=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),W.slice(0,M.length)!=M););var se=(U[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ye="--"+(se[1]||""),ne=[],oe=[],le={FileIndex:ne,FullPaths:oe};A(le);var Ne,je=0;for(H=0;H<U.length;++H){var He=U[H];He!==ye&&He!==ye+"--"||(je++&&Ji(le,U.slice(Ne,H),M),Ne=H)}return le}function _n(D,z){var M=z||{},U=M.boundary||"SheetJS";U="------="+U;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],W=D.FullPaths[0],se=W,ye=D.FileIndex[0],ne=1;ne<D.FullPaths.length;++ne)if(se=D.FullPaths[ne].slice(W.length),ye=D.FileIndex[ne],!(!ye.size||!ye.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var oe=ye.content,le=yt&&Buffer.isBuffer(oe)?oe.toString("binary"):X(oe),Ne=0,je=Math.min(1024,le.length),He=0,Ie=0;Ie<=je;++Ie)(He=le.charCodeAt(Ie))>=32&&He<128&&++Ne;var ze=Ne>=je*4/5;H.push(U),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+se),H.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),H.push("Content-Type: "+Ft(ye,se)),H.push(""),H.push(ze?qi(le):Rt(le))}return H.push(U+`--\r
`),H.join(`\r
`)}function Ko(D){var z={};return A(z,D),z}function es(D,z,M,U){var H=U&&U.unsafe;H||A(D);var W=!H&&wt.find(D,z);if(!W){var se=D.FullPaths[0];z.slice(0,se.length)==se?se=z:(se.slice(-1)!="/"&&(se+="/"),se=(se+z).replace("//","/")),W={name:i(z),type:2},D.FileIndex.push(W),D.FullPaths.push(se),H||wt.utils.cfb_gc(D)}return W.content=M,W.size=M?M.length:0,U&&(U.CLSID&&(W.clsid=U.CLSID),U.mt&&(W.mt=U.mt),U.ct&&(W.ct=U.ct)),W}function wu(D,z){A(D);var M=wt.find(D,z);if(M){for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==M)return D.FileIndex.splice(U,1),D.FullPaths.splice(U,1),!0}return!1}function mc(D,z,M){A(D);var U=wt.find(D,z);if(U){for(var H=0;H<D.FileIndex.length;++H)if(D.FileIndex[H]==U)return D.FileIndex[H].name=i(M),D.FullPaths[H]=M,!0}return!1}function p1(D){b(D,!0)}return t.find=O,t.read=N,t.parse=d,t.write=he,t.writeFile=re,t.utils={cfb_new:Ko,cfb_add:es,cfb_del:wu,cfb_mov:mc,cfb_gc:p1,ReadShift:y0,CheckField:NS,prep_blob:Yr,bconcat:ys,use_zlib:L,_deflateRaw:xe,_inflateRaw:Za,consts:Ee},t}();function QE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ma(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function H2(e){for(var t=[],r=ma(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Md=new Date(1899,11,30,0,0,0);function Nn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Md.getTime()+(e.getTimezoneOffset()-Md.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var oS=new Date,qE=Md.getTime()+(oS.getTimezoneOffset()-Md.getTimezoneOffset())*6e4,z4=oS.getTimezoneOffset();function vh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+qE),t.getTimezoneOffset()!==z4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-z4)*6e4),t}function JE(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var V4=new Date("2017-02-19T19:06:09.000Z"),lS=isNaN(V4.getFullYear())?new Date("2/19/17"):V4,ZE=lS.getFullYear()==2017;function Wr(e,t){var r=new Date(e);if(ZE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(lS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function No(e,t){if(yt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return o0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return o0(K6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return o0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return o0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function qr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qr(e[r]));return t}function or(e,t){for(var r="";r.length<t;)r+=e;return r}function Xi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var e7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ql(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&e7.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var t7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function cS(e){return e?e.content&&e.type?No(e.content,!0):e.data?i0(e.data):e.asNodeBuffer&&yt?i0(e.asNodeBuffer().toString("binary")):e.asBinary?i0(e.asBinary()):e._data&&e._data.getContent?i0(No(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function uS(e){if(!e)return null;if(e.data)return F4(e.data);if(e.asNodeBuffer&&yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?F4(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function r7(e){return e&&e.name.slice(-4)===".bin"?uS(e):cS(e)}function xi(e,t){for(var r=e.FullPaths||ma(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function W2(e,t){var r=xi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function yr(e,t,r){if(!r)return r7(W2(e,t));if(!t)return null;try{return yr(e,t)}catch{return null}}function qn(e,t,r){if(!r)return cS(W2(e,t));if(!t)return null;try{return qn(e,t)}catch{return null}}function fS(e,t,r){if(!r)return uS(W2(e,t));if(!t)return null;try{return fS(e,t)}catch{return null}}function G4(e){for(var t=e.FullPaths||ma(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function n7(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return yt?n=Io(r):n=kE(r),wt.utils.cfb_add(e,t,n)}wt.utils.cfb_add(e,t,r)}else e.file(t,r)}function dS(e,t){switch(t.type){case"base64":return wt.read(e,{type:"base64"});case"binary":return wt.read(e,{type:"binary"});case"buffer":case"array":return wt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function s0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var hS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,i7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,H4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,a7=/<[^>]*>/g,vn=hS.match(H4)?H4:a7,s7=/<\w*:/,o7=/<(\/?)\w+:/;function tt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(i7),o=0,u="",f=0,d="",p="",m=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(d=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(m=(i=p.charCodeAt(a+1))==34||i==39?1:0,u=p.slice(a+1+m,p.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,r||(n[d.toLowerCase()]=u);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=u,r||(n[v.toLowerCase()]=u)}}return n}function xa(e){return e.replace(o7,"<$1")}var pS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},l7=H2(pS),Et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,u){return pS[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),c7=/[&<>'"]/g,u7=/[\u0000-\u001f]/g;function $2(e){var t=e+"";return t.replace(c7,function(r){return l7[r]}).replace(/\n/g,"<br/>").replace(u7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var W4=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Qt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function eg(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function $4(e){var t=Ls(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function X4(e){return Io(e,"binary").toString("utf8")}var Df="foo bar baz",Ht=yt&&(X4(Df)==eg(Df)&&X4||$4(Df)==eg(Df)&&$4)||eg,o0=yt?function(e){return Io(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Q0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),gS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),f7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),d7=/<\/?(?:vt:)?variant>/g,h7=/<(?:vt:)([^>]*)>([\s\S]*)</;function K4(e,t){var r=tt(e),n=e.match(f7(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(d7,"").match(h7);s&&i.push({v:Ht(s[2]),t:s[1]})}),i}var p7=/(^\s|\s$|\n)/;function g7(e){return ma(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function m7(e,t,r){return"<"+e+(r!=null?g7(r):"")+(t!=null?(t.match(p7)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function X2(e){if(yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ht(Do(z2(e)));throw new Error("Bad input format: expected Buffer or string")}var q0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,x7={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},v7=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function y7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function _7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Y4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Q4=yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Io(t)})):Y4(e)}:Y4,q4=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(La(e,i)));return n.join("").replace(Pn,"")},K2=yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pn,""):q4(e,t,r)}:q4,J4=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},mS=yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):J4(e,t,r)}:J4,Z4=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(gl(e,i)));return n.join("")},fu=yt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Z4(t,r,n)}:Z4,xS=function(e,t){var r=Qn(e,t);return r>0?fu(e,t+4,t+4+r-1):""},vS=xS,yS=function(e,t){var r=Qn(e,t);return r>0?fu(e,t+4,t+4+r-1):""},_S=yS,SS=function(e,t){var r=2*Qn(e,t);return r>0?fu(e,t+4,t+4+r-1):""},wS=SS,kS=function(t,r){var n=Qn(t,r);return n>0?K2(t,r+4,r+4+n):""},CS=kS,ES=function(e,t){var r=Qn(e,t);return r>0?fu(e,t+4,t+4+r):""},TS=ES,AS=function(e,t){return y7(e,t)},Bd=AS,PS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};yt&&(vS=function(t,r){if(!Buffer.isBuffer(t))return xS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_S=function(t,r){if(!Buffer.isBuffer(t))return yS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},wS=function(t,r){if(!Buffer.isBuffer(t))return SS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},CS=function(t,r){if(!Buffer.isBuffer(t))return kS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},TS=function(t,r){if(!Buffer.isBuffer(t))return ES(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Bd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):AS(t,r)},PS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var gl=function(e,t){return e[t]},La=function(e,t){return e[t+1]*256+e[t]},S7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},fo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},w7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function y0(e,t){var r="",n,i,a=[],s,o,u,f;switch(t){case"dbcs":if(f=this.l,yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(La(this,f)),f+=2;e*=2;break;case"utf8":r=fu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=K2(this,this.l,this.l+e);break;case"wstr":return y0.call(this,e,"dbcs");case"lpstr-ansi":r=vS(this,this.l),e=4+Qn(this,this.l);break;case"lpstr-cp":r=_S(this,this.l),e=4+Qn(this,this.l);break;case"lpwstr":r=wS(this,this.l),e=4+2*Qn(this,this.l);break;case"lpp4":e=4+Qn(this,this.l),r=CS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qn(this,this.l),r=TS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=gl(this,this.l+e++))!==0;)a.push(If(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=La(this,this.l+e))!==0;)a.push(If(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=gl(this,f),this.l=f+1,o=y0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(If(La(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=gl(this,f),this.l=f+1,o=y0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(If(gl(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=gl(this,this.l),this.l++,n;case 2:return n=(t==="i"?S7:La)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?fo:w7)(this,this.l),this.l+=4,n):(i=Qn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Bd(this,this.l):i=Bd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=mS(this,this.l,e);break}}return this.l+=e,r}var k7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},C7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},E7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function T7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)E7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,k7(this,t,this.l);break;case 8:if(n=8,r==="f"){_7(this,t,this.l);break}case 16:break;case-4:n=4,C7(this,t,this.l);break}return this.l+=n,this}function NS(e,t){var r=mS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Yr(e,t){e.l=t,e.read_shift=y0,e.chk=NS,e.write_shift=T7}function xn(e,t){e.l+=t}function Pr(e){var t=Ls(e);return Yr(t,0),t}function Ka(e,t,r){if(e){var n,i,a;Yr(e,e.l||0);for(var s=e.length,o=0,u=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=Hd[o]||Hd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,o))return}}}function Sm(){var e=[],t=yt?256:2048,r=function(f){var d=Pr(f);return Yr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},s=function(){return i(),ys(e)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function _0(e,t,r){var n=qr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function e3(e,t,r){var n=qr(e);return n.s=_0(n.s,t.s,r),n.e=_0(n.e,t.s,r),n}function S0(e,t){if(e.cRel&&e.c<0)for(e=qr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=N7(r)),!e.rRel&&e.rRel!=null&&(r=A7(r)),r}function tg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rr(e.s.c)+":"+(e.e.cRel?"":"$")+Rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jr(e.s.r)+":"+(e.e.rRel?"":"$")+Jr(e.e.r):S0(e.s,t.biff)+":"+S0(e.e,t.biff)}function Y2(e){return parseInt(P7(e),10)-1}function Jr(e){return""+(e+1)}function A7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function P7(e){return e.replace(/\$(\d+)$/,"$1")}function Q2(e){for(var t=F7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function N7(e){return e.replace(/^([A-Z])/,"$$$1")}function F7(e){return e.replace(/^\$([A-Z])/,"$1")}function R7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function oc(e){var t=e.indexOf(":");return t==-1?{s:Tn(e),e:Tn(e)}:{s:Tn(e.slice(0,t)),e:Tn(e.slice(t+1))}}function kt(e,t){return typeof t>"u"||typeof t=="number"?kt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function cr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function t3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ei(e.z,r?Nn(t):t)}catch{}try{return e.w=Ei((e.XF||{}).numFmtId||(r?14:0),r?Nn(t):t)}catch{return""+t}}function $a(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mo[e.v]||e.v:t==null?t3(e,e.v):t3(e,t))}function Vs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function FS(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Tn(n.origin):n.origin;s=u.r,o=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=cr(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var v={v:t[p][m]},g=s+p,y=o+m;if(f.s.r>g&&(f.s.r=g),f.s.c>y&&(f.s.c=y),f.e.r<g&&(f.e.r=g),f.e.c<y&&(f.e.c=y),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))v=t[p][m];else if(Array.isArray(v.v)&&(v.f=t[p][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ct[14],n.cellDates?(v.t="d",v.w=Ei(v.z,Nn(v.v))):(v.t="n",v.v=Nn(v.v),v.w=Ei(v.z,v.v))):v.t="s";if(i)a[g]||(a[g]=[]),a[g][y]&&a[g][y].z&&(v.z=a[g][y].z),a[g][y]=v;else{var C=st({c:y,r:g});a[C]&&a[C].z&&(v.z=a[C].z),a[C]=v}}}return f.s.c<1e7&&(a["!ref"]=kt(f)),a}function lc(e,t){return FS(null,e,t)}function b7(e){return e.read_shift(4,"i")}function gn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function I7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function q2(e,t){var r=e.l,n=e.read_shift(1),i=gn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),u=0;u!=o;++u)a.push(I7(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var D7=q2;function Ti(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Oo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var O7=gn;function J2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var L7=gn,wm=J2;function Z2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Bd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):fo(t,0)>>2;return r?i/100:i}function RS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Lo=RS;function hn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function M7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=So[i];f&&(t.rgb=Z0(f));break;case 2:t.rgb=Z0([s,o,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function B7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function bS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function j7(e){return bS(e,1)}function U7(e){return bS(e,2)}var ex=2,jn=3,Of=11,r3=12,jd=19,Lf=64,z7=65,V7=71,G7=4108,H7=4126,Vr=80,IS=81,W7=[Vr,IS],$7={1:{n:"CodePage",t:ex},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:jn},5:{n:"LineCount",t:jn},6:{n:"ParagraphCount",t:jn},7:{n:"SlideCount",t:jn},8:{n:"NoteCount",t:jn},9:{n:"HiddenCount",t:jn},10:{n:"MultimediaClipCount",t:jn},11:{n:"ScaleCrop",t:Of},12:{n:"HeadingPairs",t:G7},13:{n:"TitlesOfParts",t:H7},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:Of},17:{n:"CharacterCount",t:jn},19:{n:"SharedDoc",t:Of},22:{n:"HyperlinksChanged",t:Of},23:{n:"AppVersion",t:jn,p:"version"},24:{n:"DigSig",t:z7},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:jd},2147483651:{n:"Behavior",t:jd},1919054434:{}},X7={1:{n:"CodePage",t:ex},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:Lf},11:{n:"LastPrinted",t:Lf},12:{n:"CreatedDate",t:Lf},13:{n:"ModifiedDate",t:Lf},14:{n:"PageCount",t:jn},15:{n:"WordCount",t:jn},16:{n:"CharCount",t:jn},17:{n:"Thumbnail",t:V7},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:jn},255:{},2147483648:{n:"Locale",t:jd},2147483651:{n:"Behavior",t:jd},1919054434:{}},n3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},K7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Y7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Q7=Y7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),So=qr(Q7),Mo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},DS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},i3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function q7(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function J7(e){var t=q7();if(!e||!e.match)return t;var r={};if((e.match(vn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(s7,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[i3[i.ContentType]]!==void 0&&t[i3[i.ContentType]].push(i.PartName);break}}),t.xmlns!==x7.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Nl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function km(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function w0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(vn)||[]).forEach(function(i){var a=tt(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:s0(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var Z7="application/vnd.oasis.opendocument.spreadsheet";function eT(e,t){for(var r=X2(e),n,i;n=q0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==Z7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var k0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tT=function(){for(var e=new Array(k0.length),t=0;t<k0.length;++t){var r=k0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function OS(e){var t={};e=Ht(e);for(var r=0;r<k0.length;++r){var n=k0[r],i=e.match(tT[r]);i!=null&&i.length>0&&(t[n[1]]=Et(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Wr(t[n[1]]))}return t}var rT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function LS(e,t,r,n){var i=[];if(typeof e=="string")i=K4(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var s=typeof t=="string"?K4(t,n).map(function(d){return d.v}):t,o=0,u=0;if(s.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=s.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=s.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=s.slice(o,o+u);break}o+=u}}function nT(e,t,r){var n={};return t||(t={}),e=Ht(e),rT.forEach(function(i){var a=(e.match(Q0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Et(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&LS(n.HeadingPairs,n.TitlesOfParts,t,r),t}var iT=/<[^>]+>[^<]*/g;function aT(e,t){var r={},n="",i=e.match(iT);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=tt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Et(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var u=s.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Et(d);break;case"bool":r[n]=Qt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Wr(d);break;case"cy":case"error":r[n]=Et(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,u)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var sT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rg;function oT(e,t,r){rg||(rg=H2(sT)),t=rg[t]||t,e[t]=r}function tx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function MS(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function BS(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function jS(e,t,r){return t===31?BS(e):MS(e,t,r)}function Cm(e,t,r){return jS(e,t,r===!1?0:4)}function lT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return jS(e,t,0)}function cT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pn,""),e.l-i&2&&(e.l+=2)}return r}function uT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pn,"");return r}function fT(e){var t=e.l,r=Ud(e,IS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ud(e,jn);return[r,n]}function dT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(fT(e));return r}function a3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Pn,"").replace(a0,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function US(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function hT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ud(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==r3&&n!==t&&W7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===r3?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return MS(e,n,4).replace(Pn,"");case 31:return BS(e);case 64:return tx(e);case 65:return US(e);case 71:return hT(e);case 80:return Cm(e,n,!a.raw).replace(Pn,"");case 81:return lT(e,n).replace(Pn,"");case 4108:return dT(e);case 4126:case 4127:return n==4127?cT(e):uT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function s3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,u=-1,f={};for(s=0;s!=i;++s){var d=e.read_shift(4),p=e.read_shift(4);a[s]=[d,p+r]}a.sort(function(S,x){return S[1]-x[1]});var m={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var v=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(v=!1,e.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[a[s][0]];if(m[g.n]=Ud(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vi(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(a[s][0]===1){if(o=m.CodePage=Ud(e,ex),Vi(o),u!==-1){var y=e.l;e.l=a[u][1],f=a3(e,o),e.l=y}}else if(a[s][0]===0){if(o===0){u=s,e.l=a[s+1][1];continue}f=a3(e,o)}else{var C=f[a[s][0]],E;switch(e[e.l]){case 65:e.l+=4,E=US(e);break;case 30:e.l+=4,E=Cm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Cm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=dr(e,4);break;case 64:e.l+=4,E=Wr(tx(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[C]=E}}return e.l=r+n,m}function o3(e,t,r){var n=e.content;if(!n)return{};Yr(n,0);var i,a,s,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==wt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),u=n.read_shift(4));var p=s3(n,t),m={SystemIdentifier:f};for(var v in p)m[v]=p[v];if(m.FMTID=a,i===1)return m;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var g;try{g=s3(n,null)}catch{}for(v in g)m[v]=g[v];return m.FMTID=[a,s],m}function fs(e,t){return e.read_shift(t),null}function pT(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function dr(e,t){return e.read_shift(t)===1}function _r(e){return e.read_shift(2,"u")}function zS(e,t){return pT(e,t,_r)}function gT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function du(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function mT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,u={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*s),n&&(e.l+=o),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Fo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function hu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Fo(e,n,r)}function Bo(e,t,r){if(r.biff>5)return hu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function xT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function vT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pn,"");return n&&(e.l+=24),i}function yT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Pn,"");return r+s}function _T(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return vT(e);case"0303000000000000c000000000000046":return yT(e);default:throw new Error("Unsupported Moniker "+r)}}function Mf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pn,""):"";return r}function ST(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,u,f="",d,p;i&16&&(a=Mf(e,r-e.l)),i&128&&(s=Mf(e,r-e.l)),(i&257)===257&&(o=Mf(e,r-e.l)),(i&257)===1&&(u=_T(e,r-e.l)),i&8&&(f=Mf(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(p=tx(e)),e.l=r;var m=s||o||u||"";m&&f&&(m+="#"+f),m||(m="#"+f),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var v={Target:m};return d&&(v.guid=d),p&&(v.time=p),a&&(v.Tooltip=a),v}function VS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function GS(e,t){var r=VS(e);return r[3]=0,r}function va(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function wT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function kT(e,t,r){return t===0?"":Bo(e,t,r)}function CT(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function HS(e){var t=e.read_shift(2),r=Z2(e);return[t,r]}function ET(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=du(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function yh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function WS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var TT=WS;function $S(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function AT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function PT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function un(e){e.l+=2,e.l+=e.read_shift(2)}var NT={0:un,4:un,5:un,6:un,7:PT,8:un,9:un,10:un,11:un,12:un,13:AT,14:un,15:un,16:un,17:un,18:un,19:un,20:un,21:$S};function FT(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(NT[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Bf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function RT(e,t){return t===0||e.read_shift(2),1200}function bT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Bo(e,0,r);return e.read_shift(t+n-e.l),i}function IT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function DT(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=du(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function OT(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(mT(e));return a.Count=n,a.Unique=i,a}function LT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function MT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function BT(e){var t=wT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function jT(e){return e.read_shift(2),e.read_shift(4)}function l3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function UT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:u,TabRatio:f}}function zT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function VT(){}function GT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=du(e,0,r),n}function HT(e){var t=va(e);return t.isst=e.read_shift(4),t}function WT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=va(e);r.biff==2&&e.l++;var a=hu(e,n-e.l,r);return i.val=a,i}function $T(e,t,r){var n=e.read_shift(2),i=Bo(e,0,r);return[n,i]}var XT=Bo;function c3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:u}}}function KT(e){var t=e.read_shift(2),r=e.read_shift(2),n=HS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function YT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(HS(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function QT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function qT(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return i.patternType=K7[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function JT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=qT(e,t,n.fStyle,r),n}function ZT(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function u3(e,t,r){var n=va(e);(r.biff==2||t==9)&&++e.l;var i=gT(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function eA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=va(e),i=hn(e);return n.val=i,n}var f3=kT;function tA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Fo(e,a),o=[];n>e.l;)o.push(hu(e));return[a,i,s,o]}function d3(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=ET(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var rA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h3(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Fo(e,s,r);i&32&&(f=rA[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||o===0||!(d>0)?[]:MF(e,d,r,o);return{chKey:a,Name:f,itab:u,rgce:p}}function XS(e,t,r){if(r.biff<8)return nA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(CT(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function nA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=du(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function iA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Fo(e,n,r),s=Fo(e,i,r);return[a,s]}function aA(e,t,r){var n=WS(e);e.l++;var i=e.read_shift(1);return t-=8,[BF(e,t,r),i,n]}function p3(e,t,r){var n=TT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,OF(e,t,r)]}function sA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function oA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=Bo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function lA(e,t,r){return oA(e,t,r)}function cA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(yh(e));return r}function uA(e,t,r){if(r&&r.biff<8)return dA(e,t,r);var n=$S(e),i=FT(e,t-22,n[1]);return{cmo:n,ft:i}}var fA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function dA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((fA[n]||xn)(e,t,r)),{cmo:[i,n,a],ft:s}}function hA(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=xT(e,6,r);var o=e.read_shift(2);e.read_shift(2),_r(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=Fo(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function pA(e,t){var r=yh(e);e.l+=16;var n=ST(e,t-24);return[r,n]}function gA(e,t){e.read_shift(2);var r=yh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pn,""),[r,n]}function mA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=n3[r]||r,r=e.read_shift(2),t[1]=n3[r]||r,t}function xA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GS(e));return r}function vA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GS(e));return r}function yA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function KS(e,t,r){if(!r.cellStyles)return xn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:s,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function _A(e,t){var r={};return t<32||(e.l+=16,r.header=hn(e),r.footer=hn(e),e.l+=2),r}function SA(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var wA=va,kA=zS,CA=hu;function EA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function TA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=va(e);++e.l;var i=Bo(e,t-7,r);return n.t="str",n.val=i,n}function AA(e){var t=va(e);++e.l;var r=hn(e);return t.t="n",t.val=r,t}function PA(e){var t=va(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function NA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function FA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RA(e,t,r){var n=e.l+t,i=va(e),a=e.read_shift(2),s=Fo(e,a,r);return e.l=n,i.t="str",i.val=s,i}var bA=[2,3,48,49,131,139,140,245],g3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=H2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ls(1);switch(u.type){case"base64":d=zi(ri(o));break;case"binary":d=zi(o);break;case"buffer":case"array":d=o;break}Yr(d,0);var p=d.read_shift(1),m=!!(p&136),v=!1,g=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,C=521;p==2&&(y=d.read_shift(2)),d.l+=3,p!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(C=d.read_shift(2));var E=d.read_shift(2),S=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(S=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var x=[],T={},F=Math.min(d.length,p==2?521:C-10-(v?264:0)),N=g?32:11;d.l<F&&d[d.l]!=13;)switch(T={},T.name=vs.utils.decode(S,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,T.type=String.fromCharCode(d.read_shift(1)),p!=2&&!g&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),p==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&x.push(T),p!=2&&(d.l+=g?13:14),T.type){case"B":(!v||T.len!=8)&&u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=C-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=C;var A=0,P=0;for(f[0]=[],P=0;P!=x.length;++P)f[0][P]=x[P].name;for(;y-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,f[++A]=[],P=0,P=0;P!=x.length;++P){var b=d.slice(d.l,d.l+x[P].len);d.l+=x[P].len,Yr(b,0);var I=vs.utils.decode(S,b);switch(x[P].type){case"C":I.trim().length&&(f[A][P]=I.replace(/\s+$/,""));break;case"D":I.length===8?f[A][P]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):f[A][P]=I;break;case"F":f[A][P]=parseFloat(I.trim());break;case"+":case"I":f[A][P]=g?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":f[A][P]=!0;break;case"N":case"F":f[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[A][P]="##MEMO##"+(g?parseInt(I.trim(),10):b.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(f[A][P]=+I||0);break;case"@":f[A][P]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":f[A][P]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":f[A][P]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[A][P]=-b.read_shift(-8,"f");break;case"B":if(v&&x[P].len==8){f[A][P]=b.read_shift(8,"f");break}case"G":case"P":b.l+=x[P].len;break;case"0":if(x[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[P].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=x,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=lc(r(o,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(o,u){try{return Vs(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var f=u||{};if(+f.codepage>=0&&Vi(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=Sm(),p=Rm(o,{header:1,raw:!0,cellDates:!0}),m=p[0],v=p.slice(1),g=o["!cols"]||[],y=0,C=0,E=0,S=1;for(y=0;y<m.length;++y){if(((g[y]||{}).DBF||{}).name){m[y]=g[y].DBF.name,++E;continue}if(m[y]!=null){if(++E,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(C=0;C<1024;++C)if(m.indexOf(m[y]+"_"+C)==-1){m[y]+="_"+C;break}}}}var x=cr(o["!ref"]),T=[],F=[],N=[];for(y=0;y<=x.e.c-x.s.c;++y){var A="",P="",b=0,I=[];for(C=0;C<v.length;++C)v[C][y]!=null&&I.push(v[C][y]);if(I.length==0||m[y]==null){T[y]="?";continue}for(C=0;C<I.length;++C){switch(typeof I[C]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=I[C]instanceof Date?"D":"C";break;default:P="C"}b=Math.max(b,String(I[C]).length),A=A&&A!=P?"C":P}b>250&&(b=250),P=((g[y]||{}).DBF||{}).type,P=="C"&&g[y].DBF.len>b&&(b=g[y].DBF.len),A=="B"&&P=="N"&&(A="N",N[y]=g[y].DBF.dec,b=g[y].DBF.len),F[y]=A=="C"||P=="N"?b:a[A]||0,S+=F[y],T[y]=A}var O=d.next(32);for(O.write_shift(4,318902576),O.write_shift(4,v.length),O.write_shift(2,296+32*E),O.write_shift(2,S),y=0;y<4;++y)O.write_shift(4,0);for(O.write_shift(4,0|(+t[$6]||3)<<8),y=0,C=0;y<m.length;++y)if(m[y]!=null){var j=d.next(32),q=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,q,"sbcs"),j.write_shift(1,T[y]=="?"?"C":T[y],"sbcs"),j.write_shift(4,C),j.write_shift(1,F[y]||a[T[y]]||0),j.write_shift(1,N[y]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),C+=F[y]||a[T[y]]||0}var ie=d.next(264);for(ie.write_shift(4,13),y=0;y<65;++y)ie.write_shift(4,0);for(y=0;y<v.length;++y){var te=d.next(S);for(te.write_shift(1,0),C=0;C<m.length;++C)if(m[C]!=null)switch(T[C]){case"L":te.write_shift(1,v[y][C]==null?63:v[y][C]?84:70);break;case"B":te.write_shift(8,v[y][C]||0,"f");break;case"N":var Ae="0";for(typeof v[y][C]=="number"&&(Ae=v[y][C].toFixed(N[C]||0)),E=0;E<F[C]-Ae.length;++E)te.write_shift(1,32);te.write_shift(1,Ae,"sbcs");break;case"D":v[y][C]?(te.write_shift(4,("0000"+v[y][C].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(v[y][C].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+v[y][C].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(v[y][C]!=null?v[y][C]:"").slice(0,F[C]);for(te.write_shift(1,Ee,"sbcs"),E=0;E<F[C]-Ee.length;++E)te.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),IA=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ma(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var g=e[v];return typeof g=="number"?R4(g):g},n=function(m,v,g){var y=v.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return y==59?m:R4(y)};e["|"]=254;function i(m,v){switch(v.type){case"base64":return a(ri(m),v);case"binary":return a(m,v);case"buffer":return a(yt&&Buffer.isBuffer(m)?m.toString("binary"):Do(m),v);case"array":return a(No(m),v)}throw new Error("Unrecognized type "+v.type)}function a(m,v){var g=m.split(/[\n\r]+/),y=-1,C=-1,E=0,S=0,x=[],T=[],F=null,N={},A=[],P=[],b=[],I=0,O;for(+v.codepage>=0&&Vi(+v.codepage);E!==g.length;++E){I=0;var j=g[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=j.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),ie=q[0],te;if(j.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&T.push(j.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,Ee=!1,re=!1,X=!1,he=-1,Te=-1;for(S=1;S<q.length;++S)switch(q[S].charAt(0)){case"A":break;case"X":C=parseInt(q[S].slice(1))-1,Ee=!0;break;case"Y":for(y=parseInt(q[S].slice(1))-1,Ee||(C=0),O=x.length;O<=y;++O)x[O]=[];break;case"K":te=q[S].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Xi(te))?isNaN(Ql(te).getDate())||(te=Wr(te)):(te=Xi(te),F!==null&&sc(F)&&(te=vh(te))),Ae=!0;break;case"E":X=!0;var L=Ml(q[S].slice(1),{r:y,c:C});x[y][C]=[x[y][C],L];break;case"S":re=!0,x[y][C]=[x[y][C],"S5S"];break;case"G":break;case"R":he=parseInt(q[S].slice(1))-1;break;case"C":Te=parseInt(q[S].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+j)}if(Ae&&(x[y][C]&&x[y][C].length==2?x[y][C][0]=te:x[y][C]=te,F=null),re){if(X)throw new Error("SYLK shared formula cannot have own formula");var Q=he>-1&&x[he][Te];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");x[y][C][1]=i8(Q[1],{r:y-he,c:C-Te})}break;case"F":var Y=0;for(S=1;S<q.length;++S)switch(q[S].charAt(0)){case"X":C=parseInt(q[S].slice(1))-1,++Y;break;case"Y":for(y=parseInt(q[S].slice(1))-1,O=x.length;O<=y;++O)x[O]=[];break;case"M":I=parseInt(q[S].slice(1))/20;break;case"F":break;case"G":break;case"P":F=T[parseInt(q[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=q[S].slice(1).split(" "),O=parseInt(b[0],10);O<=parseInt(b[1],10);++O)I=parseInt(b[2],10),P[O-1]=I===0?{hidden:!0}:{wch:I},ql(P[O-1]);break;case"C":C=parseInt(q[S].slice(1))-1,P[C]||(P[C]={});break;case"R":y=parseInt(q[S].slice(1))-1,A[y]||(A[y]={}),I>0?(A[y].hpt=I,A[y].hpx=eu(I)):I===0&&(A[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+j)}Y<1&&(F=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+j)}}return A.length>0&&(N["!rows"]=A),P.length>0&&(N["!cols"]=P),v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),[x,N]}function s(m,v){var g=i(m,v),y=g[0],C=g[1],E=lc(y,v);return ma(C).forEach(function(S){E[S]=C[S]}),E}function o(m,v){return Vs(s(m,v),v)}function u(m,v,g,y){var C="C;Y"+(g+1)+";X"+(y+1)+";K";switch(m.t){case"n":C+=m.v||0,m.f&&!m.F&&(C+=";E"+yN(m.f,{r:g,c:y}));break;case"b":C+=m.v?"TRUE":"FALSE";break;case"e":C+=m.w||m.v;break;case"d":C+='"'+(m.w||m.v)+'"';break;case"s":C+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function f(m,v){v.forEach(function(g,y){var C="F;W"+(y+1)+" "+(y+1)+" ";g.hidden?C+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Vd(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Gd(g.wpx)),typeof g.wch=="number"&&(C+=Math.round(g.wch))),C.charAt(C.length-1)!=" "&&m.push(C)})}function d(m,v){v.forEach(function(g,y){var C="F;";g.hidden?C+="M0;":g.hpt?C+="M"+20*g.hpt+";":g.hpx&&(C+="M"+20*t8(g.hpx)+";"),C.length>2&&m.push(C+"R"+(y+1))})}function p(m,v){var g=["ID;PWXL;N;E"],y=[],C=cr(m["!ref"]),E,S=Array.isArray(m),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&f(g,m["!cols"]),m["!rows"]&&d(g,m["!rows"]),g.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var T=C.s.r;T<=C.e.r;++T)for(var F=C.s.c;F<=C.e.c;++F){var N=st({r:T,c:F});E=S?(m[T]||[])[F]:m[N],!(!E||E.v==null&&(!E.f||E.F))&&y.push(u(E,m,T,F))}return g.join(x)+x+y.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),DA=function(){function e(a,s){switch(s.type){case"base64":return t(ri(a),s);case"binary":return t(a,s);case"buffer":return t(yt&&Buffer.isBuffer(a)?a.toString("binary"):Do(a),s);case"array":return t(No(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),u=-1,f=-1,d=0,p=[];d!==o.length;++d){if(o[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var m=o[d].trim().split(","),v=m[0],g=m[1];++d;for(var y=o[d]||"";(y.match(/["]/g)||[]).length&1&&d<o.length-1;)y+=`
`+o[++d];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[u][f]=!0:y==="FALSE"?p[u][f]=!1:isNaN(Xi(g))?isNaN(Ql(g).getDate())?p[u][f]=g:p[u][f]=Wr(g):p[u][f]=Xi(g),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(a,s){return lc(e(a,s),s)}function n(a,s){return Vs(r(a,s),s)}var i=function(){var a=function(u,f,d,p,m){u.push(f),u.push(d+","+p),u.push('"'+m.replace(/"/g,'""')+'"')},s=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=cr(u["!ref"]),p,m=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(f,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var y=st({r:v,c:g});if(p=m?(u[v]||[])[g]:u[y],!p){s(f,1,0,"");continue}switch(p.t){case"n":var C=p.w;!C&&p.v!=null&&(C=p.v),C==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,C,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ei(p.z||ct[14],Nn(Wr(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var E=`\r
`,S=f.join(E);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),OA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var v=p.split(`
`),g=-1,y=-1,C=0,E=[];C!==v.length;++C){var S=v[C].trim().split(":");if(S[0]==="cell"){var x=Tn(S[1]);if(E.length<=x.r)for(g=E.length;g<=x.r;++g)E[g]||(E[g]=[]);switch(g=x.r,y=x.c,S[2]){case"t":E[g][y]=e(S[3]);break;case"v":E[g][y]=+S[3];break;case"vtf":var T=S[S.length-1];case"vtc":switch(S[3]){case"nl":E[g][y]=!!+S[4];break;default:E[g][y]=+S[4];break}S[2]=="vtf"&&(E[g][y]=[E[g][y],T])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(p,m){return lc(r(p,m),m)}function i(p,m){return Vs(n(p,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],g,y="",C=oc(p["!ref"]),E=Array.isArray(p),S=C.s.r;S<=C.e.r;++S)for(var x=C.s.c;x<=C.e.c;++x)if(y=st({r:S,c:x}),g=E?(p[S]||[])[x]:p[y],!(!g||g.v==null||g.t==="z")){switch(v=["cell",y,"t"],g.t){case"s":case"str":v.push(t(g.v));break;case"n":g.f?(v[2]="vtf",v[3]="n",v[4]=g.v,v[5]=t(g.f)):(v[2]="v",v[3]=g.v);break;case"b":v[2]="vt"+(g.f?"f":"c"),v[3]="nl",v[4]=g.v?"1":"0",v[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var T=Nn(Wr(g.v));v[2]="vtc",v[3]="nd",v[4]=""+T,v[5]=g.w||Ei(g.z||ct[14],T);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[a,s,o,s,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),J0=function(){function e(d,p,m,v,g){g.raw?p[m][v]=d:d===""||(d==="TRUE"?p[m][v]=!0:d==="FALSE"?p[m][v]=!1:isNaN(Xi(d))?isNaN(Ql(d).getDate())?p[m][v]=d:p[m][v]=Wr(d):p[m][v]=Xi(d))}function t(d,p){var m=p||{},v=[];if(!d||d.length===0)return v;for(var g=d.split(/[\r\n]/),y=g.length-1;y>=0&&g[y].length===0;)--y;for(var C=10,E=0,S=0;S<=y;++S)E=g[S].indexOf(" "),E==-1?E=g[S].length:E++,C=Math.max(C,E);for(S=0;S<=y;++S){v[S]=[];var x=0;for(e(g[S].slice(0,C).trim(),v,S,x,m),x=1;x<=(g[S].length-C)/10+1;++x)e(g[S].slice(C+(x-1)*10,C+x*10).trim(),v,S,x,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var p={},m=!1,v=0,g=0;v<d.length;++v)(g=d.charCodeAt(v))==34?m=!m:!m&&g in r&&(p[g]=(p[g]||0)+1);g=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([p[v],v]);if(!g.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&g.push([p[v],v])}return g.sort(function(y,C){return y[0]-C[0]||n[y[1]]-n[C[1]]}),r[g.pop()[1]]||44}function a(d,p){var m=p||{},v="",g=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):m&&m.FS?v=m.FS:v=i(d.slice(0,1024));var C=0,E=0,S=0,x=0,T=0,F=v.charCodeAt(0),N=!1,A=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var b=m.dateNF!=null?XE(m.dateNF):null;function I(){var O=d.slice(x,T),j={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)j.t="z";else if(m.raw)j.t="s",j.v=O;else if(O.trim().length===0)j.t="s",j.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(j.t="s",j.v=O.slice(2,-1).replace(/""/g,'"')):SN(O)?(j.t="n",j.f=O.slice(1)):(j.t="s",j.v=O);else if(O=="TRUE")j.t="b",j.v=!0;else if(O=="FALSE")j.t="b",j.v=!1;else if(!isNaN(S=Xi(O)))j.t="n",m.cellText!==!1&&(j.w=O),j.v=S;else if(!isNaN(Ql(O).getDate())||b&&O.match(b)){j.z=m.dateNF||ct[14];var q=0;b&&O.match(b)&&(O=KE(O,m.dateNF,O.match(b)||[]),q=1),m.cellDates?(j.t="d",j.v=Wr(O,q)):(j.t="n",j.v=Nn(Wr(O,q))),m.cellText!==!1&&(j.w=Ei(j.z,j.v instanceof Date?Nn(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=O;if(j.t=="z"||(m.dense?(g[C]||(g[C]=[]),g[C][E]=j):g[st({c:E,r:C})]=j),x=T+1,P=d.charCodeAt(x),y.e.c<E&&(y.e.c=E),y.e.r<C&&(y.e.r=C),A==F)++E;else if(E=0,++C,m.sheetRows&&m.sheetRows<=C)return!0}e:for(;T<d.length;++T)switch(A=d.charCodeAt(T)){case 34:P===34&&(N=!N);break;case F:case 10:case 13:if(!N&&I())break e;break}return T-x>0&&I(),g["!ref"]=kt(y),g}function s(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,p):lc(t(d,p),p)}function o(d,p){var m="",v=p.type=="string"?[0,0,0,0]:cx(d,p);switch(p.type){case"base64":m=ri(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):p.codepage&&typeof vs<"u"?m=vs.utils.decode(p.codepage,d):m=yt&&Buffer.isBuffer(d)?d.toString("binary"):Do(d);break;case"array":m=No(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=Ht(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Ht(m):p.type=="binary"&&typeof vs<"u"&&p.codepage&&(m=vs.utils.decode(p.codepage,vs.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?OA.to_sheet(p.type=="string"?m:Ht(m),p):s(m,p)}function u(d,p){return Vs(o(d,p),p)}function f(d){for(var p=[],m=cr(d["!ref"]),v,g=Array.isArray(d),y=m.s.r;y<=m.e.r;++y){for(var C=[],E=m.s.c;E<=m.e.c;++E){var S=st({r:y,c:E});if(v=g?(d[y]||[])[E]:d[S],!v||v.v==null){C.push("          ");continue}for(var x=(v.w||($a(v),v.w)||"").slice(0,10);x.length<10;)x+=" ";C.push(x+(E===0?" ":""))}p.push(C.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}}();function LA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=IA.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return J0.to_workbook(e,t)}}var C0=function(){function e(L,Q,Y){if(L){Yr(L,L.l||0);for(var K=Y.Enum||he;L.l<L.length;){var ue=L.read_shift(2),V=K[ue]||K[65535],Z=L.read_shift(2),fe=L.l+Z,ve=V.f&&V.f(L,Z,Y);if(L.l=fe,Q(ve,V,ue))return}}}function t(L,Q){switch(Q.type){case"base64":return r(zi(ri(L)),Q);case"binary":return r(zi(L),Q);case"buffer":case"array":return r(L,Q)}throw"Unsupported type "+Q.type}function r(L,Q){if(!L)return L;var Y=Q||{},K=Y.dense?[]:{},ue="Sheet1",V="",Z=0,fe={},ve=[],Be=[],G={s:{r:0,c:0},e:{r:0,c:0}},qe=Y.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)Y.Enum=he,e(L,function(Fe,St,Or){switch(Or){case 0:Y.vers=Fe,Fe>=4096&&(Y.qpro=!0);break;case 6:G=Fe;break;case 204:Fe&&(V=Fe);break;case 222:V=Fe;break;case 15:case 51:Y.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:Or==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=Y.dateNF||ct[14],Y.cellDates&&(Fe[1].t="d",Fe[1].v=vh(Fe[1].v))),Y.qpro&&Fe[3]>Z&&(K["!ref"]=kt(G),fe[ue]=K,ve.push(ue),K=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Z=Fe[3],ue=V||"Sheet"+(Z+1),V="");var gr=Y.dense?(K[Fe[0].r]||[])[Fe[0].c]:K[st(Fe[0])];if(gr){gr.t=Fe[1].t,gr.v=Fe[1].v,Fe[1].z!=null&&(gr.z=Fe[1].z),Fe[1].f!=null&&(gr.f=Fe[1].f);break}Y.dense?(K[Fe[0].r]||(K[Fe[0].r]=[]),K[Fe[0].r][Fe[0].c]=Fe[1]):K[st(Fe[0])]=Fe[1];break}},Y);else if(L[2]==26||L[2]==14)Y.Enum=Te,L[2]==14&&(Y.qpro=!0,L.l=0),e(L,function(Fe,St,Or){switch(Or){case 204:ue=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>Z&&(K["!ref"]=kt(G),fe[ue]=K,ve.push(ue),K=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Z=Fe[3],ue="Sheet"+(Z+1)),qe>0&&Fe[0].r>=qe)break;Y.dense?(K[Fe[0].r]||(K[Fe[0].r]=[]),K[Fe[0].r][Fe[0].c]=Fe[1]):K[st(Fe[0])]=Fe[1],G.e.c<Fe[0].c&&(G.e.c=Fe[0].c),G.e.r<Fe[0].r&&(G.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(Be[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:Be[Fe[0]]=Fe[1],Fe[0]==Z&&(ue=Fe[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(K["!ref"]=kt(G),fe[V||ue]=K,ve.push(V||ue),!Be.length)return{SheetNames:ve,Sheets:fe};for(var et={},Ye=[],Qe=0;Qe<Be.length;++Qe)fe[ve[Qe]]?(Ye.push(Be[Qe]||ve[Qe]),et[Be[Qe]]=fe[Be[Qe]]||fe[ve[Qe]]):(Ye.push(Be[Qe]),et[Be[Qe]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:et}}function n(L,Q){var Y=Q||{};if(+Y.codepage>=0&&Vi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Sm(),ue=cr(L["!ref"]),V=Array.isArray(L),Z=[];Li(K,0,a(1030)),Li(K,6,u(ue));for(var fe=Math.min(ue.e.r,8191),ve=ue.s.r;ve<=fe;++ve)for(var Be=Jr(ve),G=ue.s.c;G<=ue.e.c;++G){ve===ue.s.r&&(Z[G]=Rr(G));var qe=Z[G]+Be,et=V?(L[ve]||[])[G]:L[qe];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?Li(K,13,v(ve,G,et.v)):Li(K,14,y(ve,G,et.v));else{var Ye=$a(et);Li(K,15,p(ve,G,Ye.slice(0,239)))}}return Li(K,1),K.end()}function i(L,Q){var Y=Q||{};if(+Y.codepage>=0&&Vi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Sm();Li(K,0,s(L));for(var ue=0,V=0;ue<L.SheetNames.length;++ue)(L.Sheets[L.SheetNames[ue]]||{})["!ref"]&&Li(K,27,X(L.SheetNames[ue],V++));var Z=0;for(ue=0;ue<L.SheetNames.length;++ue){var fe=L.Sheets[L.SheetNames[ue]];if(!(!fe||!fe["!ref"])){for(var ve=cr(fe["!ref"]),Be=Array.isArray(fe),G=[],qe=Math.min(ve.e.r,8191),et=ve.s.r;et<=qe;++et)for(var Ye=Jr(et),Qe=ve.s.c;Qe<=ve.e.c;++Qe){et===ve.s.r&&(G[Qe]=Rr(Qe));var Fe=G[Qe]+Ye,St=Be?(fe[et]||[])[Qe]:fe[Fe];if(!(!St||St.t=="z"))if(St.t=="n")Li(K,23,I(et,Qe,Z,St.v));else{var Or=$a(St);Li(K,22,A(et,Qe,Z,Or.slice(0,239)))}}++Z}}return Li(K,1),K.end()}function a(L){var Q=Pr(2);return Q.write_shift(2,L),Q}function s(L){var Q=Pr(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var Y=0,K=0,ue=0,V=0;V<L.SheetNames.length;++V){var Z=L.SheetNames[V],fe=L.Sheets[Z];if(!(!fe||!fe["!ref"])){++ue;var ve=oc(fe["!ref"]);Y<ve.e.r&&(Y=ve.e.r),K<ve.e.c&&(K=ve.e.c)}}return Y>8191&&(Y=8191),Q.write_shift(2,Y),Q.write_shift(1,ue),Q.write_shift(1,K),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function o(L,Q,Y){var K={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&Y.qpro?(K.s.c=L.read_shift(1),L.l++,K.s.r=L.read_shift(2),K.e.c=L.read_shift(1),L.l++,K.e.r=L.read_shift(2),K):(K.s.c=L.read_shift(2),K.s.r=L.read_shift(2),Q==12&&Y.qpro&&(L.l+=2),K.e.c=L.read_shift(2),K.e.r=L.read_shift(2),Q==12&&Y.qpro&&(L.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function u(L){var Q=Pr(8);return Q.write_shift(2,L.s.c),Q.write_shift(2,L.s.r),Q.write_shift(2,L.e.c),Q.write_shift(2,L.e.r),Q}function f(L,Q,Y){var K=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(K[0].c=L.read_shift(1),K[3]=L.read_shift(1),K[0].r=L.read_shift(2),L.l+=2):(K[2]=L.read_shift(1),K[0].c=L.read_shift(2),K[0].r=L.read_shift(2)),K}function d(L,Q,Y){var K=L.l+Q,ue=f(L,Q,Y);if(ue[1].t="s",Y.vers==20768){L.l++;var V=L.read_shift(1);return ue[1].v=L.read_shift(V,"utf8"),ue}return Y.qpro&&L.l++,ue[1].v=L.read_shift(K-L.l,"cstr"),ue}function p(L,Q,Y){var K=Pr(7+Y.length);K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,L),K.write_shift(1,39);for(var ue=0;ue<K.length;++ue){var V=Y.charCodeAt(ue);K.write_shift(1,V>=128?95:V)}return K.write_shift(1,0),K}function m(L,Q,Y){var K=f(L,Q,Y);return K[1].v=L.read_shift(2,"i"),K}function v(L,Q,Y){var K=Pr(7);return K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,L),K.write_shift(2,Y,"i"),K}function g(L,Q,Y){var K=f(L,Q,Y);return K[1].v=L.read_shift(8,"f"),K}function y(L,Q,Y){var K=Pr(13);return K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,L),K.write_shift(8,Y,"f"),K}function C(L,Q,Y){var K=L.l+Q,ue=f(L,Q,Y);if(ue[1].v=L.read_shift(8,"f"),Y.qpro)L.l=K;else{var V=L.read_shift(2);T(L.slice(L.l,L.l+V),ue),L.l+=V}return ue}function E(L,Q,Y){var K=Q&32768;return Q&=-32769,Q=(K?L:0)+(Q>=8192?Q-16384:Q),(K?"":"$")+(Y?Rr(Q):Jr(Q))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(L,Q){Yr(L,0);for(var Y=[],K=0,ue="",V="",Z="",fe="";L.l<L.length;){var ve=L[L.l++];switch(ve){case 0:Y.push(L.read_shift(8,"f"));break;case 1:V=E(Q[0].c,L.read_shift(2),!0),ue=E(Q[0].r,L.read_shift(2),!1),Y.push(V+ue);break;case 2:{var Be=E(Q[0].c,L.read_shift(2),!0),G=E(Q[0].r,L.read_shift(2),!1);V=E(Q[0].c,L.read_shift(2),!0),ue=E(Q[0].r,L.read_shift(2),!1),Y.push(Be+G+":"+V+ue)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(L.read_shift(2));break;case 6:{for(var qe="";ve=L[L.l++];)qe+=String.fromCharCode(ve);Y.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:fe=Y.pop(),Z=Y.pop(),Y.push(["AND","OR"][ve-20]+"("+Z+","+fe+")");break;default:if(ve<32&&x[ve])fe=Y.pop(),Z=Y.pop(),Y.push(Z+x[ve]+fe);else if(S[ve]){if(K=S[ve][1],K==69&&(K=L[L.l++]),K>Y.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+Y.join("|")+"|");return}var et=Y.slice(-K);Y.length-=K,Y.push(S[ve][0]+"("+et.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}Y.length==1?Q[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function F(L){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=L.read_shift(2),Q[3]=L[L.l++],Q[0].c=L[L.l++],Q}function N(L,Q){var Y=F(L);return Y[1].t="s",Y[1].v=L.read_shift(Q-4,"cstr"),Y}function A(L,Q,Y,K){var ue=Pr(6+K.length);ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,Q),ue.write_shift(1,39);for(var V=0;V<K.length;++V){var Z=K.charCodeAt(V);ue.write_shift(1,Z>=128?95:Z)}return ue.write_shift(1,0),ue}function P(L,Q){var Y=F(L);Y[1].v=L.read_shift(2);var K=Y[1].v>>1;if(Y[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return Y[1].v=K,Y}function b(L,Q){var Y=F(L),K=L.read_shift(4),ue=L.read_shift(4),V=L.read_shift(2);if(V==65535)return K===0&&ue===3221225472?(Y[1].t="e",Y[1].v=15):K===0&&ue===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Z=V&32768;return V=(V&32767)-16446,Y[1].v=(1-Z*2)*(ue*Math.pow(2,V+32)+K*Math.pow(2,V)),Y}function I(L,Q,Y,K){var ue=Pr(14);if(ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,Q),K==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var V=0,Z=0,fe=0,ve=0;return K<0&&(V=1,K=-K),Z=Math.log2(K)|0,K/=Math.pow(2,Z-31),ve=K>>>0,ve&2147483648||(K/=2,++Z,ve=K>>>0),K-=ve,ve|=2147483648,ve>>>=0,K*=Math.pow(2,32),fe=K>>>0,ue.write_shift(4,fe),ue.write_shift(4,ve),Z+=16383+(V?32768:0),ue.write_shift(2,Z),ue}function O(L,Q){var Y=b(L);return L.l+=Q-14,Y}function j(L,Q){var Y=F(L),K=L.read_shift(4);return Y[1].v=K>>6,Y}function q(L,Q){var Y=F(L),K=L.read_shift(8,"f");return Y[1].v=K,Y}function ie(L,Q){var Y=q(L);return L.l+=Q-10,Y}function te(L,Q){return L[L.l+Q-1]==0?L.read_shift(Q,"cstr"):""}function Ae(L,Q){var Y=L[L.l++];Y>Q-1&&(Y=Q-1);for(var K="";K.length<Y;)K+=String.fromCharCode(L[L.l++]);return K}function Ee(L,Q,Y){if(!(!Y.qpro||Q<21)){var K=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ue=L.read_shift(Q-21,"cstr");return[K,ue]}}function re(L,Q){for(var Y={},K=L.l+Q;L.l<K;){var ue=L.read_shift(2);if(ue==14e3){for(Y[ue]=[0,""],Y[ue][0]=L.read_shift(2);L[L.l];)Y[ue][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return Y}function X(L,Q){var Y=Pr(5+L.length);Y.write_shift(2,14e3),Y.write_shift(2,Q);for(var K=0;K<L.length;++K){var ue=L.charCodeAt(K);Y[Y.l++]=ue>127?95:ue}return Y[Y.l++]=0,Y}var he={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function MA(e){var t={},r=e.match(vn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=j2[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var BA=function(){var e=Q0("t"),t=Q0("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Et(s[1])},u=a.match(t);return u&&(o.s=MA(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),jA=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),s.push("</"+u+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),UA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zA=/<(?:\w+:)?r>/,VA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Et(Ht(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ht(e),r&&(n.h=$2(n.t))):e.match(zA)&&(n.r=Ht(e),n.t=Et(Ht((e.replace(VA,"").match(UA)||[]).join("").replace(vn,""))),r&&(n.h=jA(BA(n.r)))),n):{t:""}}var GA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HA=/<(?:\w+:)?(?:si|sstItem)>/g,WA=/<\/(?:\w+:)?(?:si|sstItem)>/;function $A(e,t){var r=[],n="";if(!e)return r;var i=e.match(GA);if(i){n=i[2].replace(HA,"").split(WA);for(var a=0;a!=n.length;++a){var s=rx(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=tt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function XA(e){return[e.read_shift(4),e.read_shift(4)]}function KA(e,t){var r=[],n=!1;return Ka(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function YS(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ja(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function YA(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function QA(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function qA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(QA(e));return t}function JA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function ZA(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function eP(e){var t=ZA(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function QS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function qS(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function tP(e){var t=ja(e);switch(t.Minor){case 2:return[t.Minor,rP(e)];case 3:return[t.Minor,nP()];case 4:return[t.Minor,iP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function rP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=QS(e,r),i=qS(e,e.length-e.l);return{t:"Std",h:n,v:i}}function nP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(vn,function(a){var s=tt(a);switch(xa(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function aP(e,t){var r={},n=r.EncryptionVersionInfo=ja(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=QS(e,i),t-=i,r.EncryptionVerifier=qS(e,t),r}function sP(e){var t={},r=t.EncryptionVersionInfo=ja(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function oP(e){var t=0,r,n=YS(e),i=n.length+1,a,s,o,u,f;for(r=Ls(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,u=t<<1&32767,f=o|u,t=f^s;return t^52811}var JS=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],u=104,f=s.length-1;f>=0;--f)for(var d=s[f],p=0;p!=7;++p)d&64&&(o^=r[u]),d*=2,--u;return o};return function(s){for(var o=YS(s),u=a(o),f=o.length,d=Ls(16),p=0;p!=16;++p)d[p]=0;var m,v,g;for((f&1)===1&&(m=u>>8,d[f]=i(e[0],m),--f,m=u&255,v=o[o.length-1],d[f]=i(v,m));f>0;)--f,m=u>>8,d[f]=i(o[f],m),--f,m=u&255,d[f]=i(o[f],m);for(f=15,g=15-o.length;g>0;)m=u>>8,d[f]=i(e[g],m),--f,--g,m=u&255,d[f]=i(o[f],m),--f,--g;return d}}(),lP=function(e,t,r,n,i){i||(i=t),n||(n=JS(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},cP=function(e){var t=0,r=JS(e);return function(n){var i=lP("",n,t,r);return t=i[1],i[0]}};function uP(e,t,r,n){var i={key:_r(e),verificationBytes:_r(e)};return r.password&&(i.verifier=oP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=cP(r.password)),i}function fP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=sP(e):n.Data=aP(e,t),n}function dP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?fP(e,t-2,n):uP(e,r.biff>=8?t:t-2,r,n),n}var hP=function(){function e(i,a){switch(a.type){case"base64":return t(ri(i),a);case"binary":return t(i,a);case"buffer":return t(yt&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),a);case"array":return t(No(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,v=0,g,y=-1;g=m.exec(d);){switch(g[0]){case"\\cell":var C=d.slice(v,m.lastIndex-g[0].length);if(C[0]==" "&&(C=C.slice(1)),++y,C.length){var E={v:C,t:"s"};Array.isArray(o)?o[p][y]=E:o[st({r:p,c:y})]=E}break}v=m.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=kt(f),o}function r(i,a){return Vs(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=cr(i["!ref"]),o,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var p=st({r:f,c:d});o=u?(i[f]||[])[d]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||($a(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function pP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Z0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function gP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,u=0,f=i+a;switch(u=s/(f>1?2-f:f),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,u,f/2]}function mP(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,s[0]+=i,s[1]+=u;break;case 1:u=i*(2-o),s[0]+=u,s[1]+=i;break;case 2:u=i*(o-2),s[1]+=i,s[2]+=u;break;case 3:u=i*(4-o),s[1]+=u,s[2]+=i;break;case 4:u=i*(o-4),s[2]+=i,s[0]+=u;break;case 5:u=i*(6-o),s[2]+=u,s[0]+=i;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function zd(e,t){if(t===0)return e;var r=gP(pP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Z0(mP(r))}var ZS=6,xP=15,vP=1,En=ZS;function Vd(e){return Math.floor((e+Math.round(128/En)/256)*En)}function Gd(e){return Math.floor((e-5)/En*100+.5)/100}function Em(e){return Math.round((e*En+5)/En*256)/256}function ng(e){return Em(Gd(Vd(e)))}function nx(e){var t=Math.abs(e-ng(e)),r=En;if(t>.005)for(En=vP;En<xP;++En)Math.abs(e-ng(e))<=t&&(t=Math.abs(e-ng(e)),r=En);En=r}function ql(e){e.width?(e.wpx=Vd(e.width),e.wch=Gd(e.wpx),e.MDW=En):e.wpx?(e.wch=Gd(e.wpx),e.width=Em(e.wch),e.MDW=En):typeof e.wch=="number"&&(e.width=Em(e.wch),e.wpx=Vd(e.width),e.MDW=En),e.customWidth&&delete e.customWidth}var yP=96,e8=yP;function t8(e){return e*96/e8}function eu(e){return e*e8/96}var _P={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function SP(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(xa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Qt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Qt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function wP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(xa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function kP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(xa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Ht(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Qt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Qt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Qt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Qt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Qt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Qt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Qt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=j2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Qt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=So[i.color.index];i.color.index==81&&(u=So[1]),u||(u=So[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=zd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function CP(e,t,r){t.NumberFmt=[];for(var n=ma(ct),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ct[n[i]];var a=e[0].match(vn);if(a)for(i=0;i<a.length;++i){var s=tt(a[i]);switch(xa(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Et(Ht(s.formatCode)),u=parseInt(s.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}_o(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var jf=["numFmtId","fillId","fontId","borderId","xfId"],Uf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function EP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(vn)||[]).forEach(function(a){var s=tt(a),o=0;switch(xa(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<jf.length;++o)n[jf[o]]&&(n[jf[o]]=parseInt(n[jf[o]],10));for(o=0;o<Uf.length;++o)n[Uf[o]]&&(n[Uf[o]]=Qt(n[Uf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};s.vertical&&(u.vertical=s.vertical),s.horizontal&&(u.horizontal=s.horizontal),s.textRotation!=null&&(u.textRotation=s.textRotation),s.indent&&(u.indent=s.indent),s.wrapText&&(u.wrapText=Qt(s.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var TP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&CP(p,d,f),(p=o.match(i))&&kP(p,d,u,f),(p=o.match(n))&&wP(p,d,u,f),(p=o.match(a))&&SP(p,d,u,f),(p=o.match(r))&&EP(p,d,f),d}}();function AP(e,t){var r=e.read_shift(2),n=gn(e);return[r,n]}function PP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=B7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=M7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gn(e),n}var NP=xn;function FP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var RP=xn;function bP(e,t,r){var n={};n.NumberFmt=[];for(var i in ct)n.NumberFmt[i]=ct[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return Ka(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],_o(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=zd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var IP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(vn)||[]).forEach(function(i){var a=tt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[IP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function OP(){}function LP(){}var MP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,BP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UP(e,t,r){t.themeElements={};var n;[["clrScheme",MP,DP],["fontScheme",BP,OP],["fmtScheme",jP,LP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var zP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function r8(e,t){(!e||e.length===0)&&(e=VP());var r,n={};if(!(r=e.match(zP)))throw new Error("themeElements not found in theme");return UP(r[0],n,t),n.raw=e,n}function VP(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[hS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function GP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=dS(a,{type:"array"})}catch{return}var o=qn(s,"theme/theme/theme1.xml",!0);if(o)return r8(o,r)}}function HP(e){return e.read_shift(4)}function WP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=$P(e,4);break;case 2:t.xclrValue=VS(e);break;case 3:t.xclrValue=HP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function $P(e,t){return xn(e,t)}function XP(e,t){return xn(e,t)}function KP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WP(e);break;case 6:n[1]=XP(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function YP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(KP(e,r-e.l));return{ixfe:n,ext:a}}function QP(e,t){t.forEach(function(r){switch(r[0]){}})}function qP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:gn(e)}}function JP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ZP(e){return e.l+=4,e.read_shift(4)!=0}function eN(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return Ka(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!f.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function tN(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(vn,function(o){var u=tt(o);switch(xa(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function rN(e){var t=[];if(!e)return t;var r=1;return(e.match(vn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function nN(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function iN(e,t,r){var n=[];return Ka(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function aN(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Ka(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function sN(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function m3(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=Tn(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var u=cr(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=kt(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}a.c.push(d)})}function oN(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=tt(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Tn(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&rx(p[1])||{r:"",t:"",h:""};f.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),f.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=m.h),n.push(f)}}}}),n}function lN(e,t){var r=[],n=!1,i={},a=0;return e.replace(vn,function(o,u){var f=tt(o);switch(xa(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+o.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function cN(e,t){var r=[],n=!1;return e.replace(vn,function(a){var s=tt(a);switch(xa(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function uN(e){var t={};t.iauthor=e.read_shift(4);var r=Lo(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}var fN=gn;function dN(e,t){var r=[],n=[],i={},a=!1;return Ka(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var hN="application/vnd.ms-office.vbaProject";function pN(e){var t=wt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),wt.write(t)}function gN(){return{"!type":"dialog"}}function mN(){return{"!type":"dialog"}}function xN(){return{"!type":"macro"}}function vN(){return{"!type":"macro"}}var Ml=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,i+(o?"":"$")+Rr(d)+(u?"":"$")+Jr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),n8=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yN=function(){return function(t,r){return t.replace(n8,function(n,i,a,s,o,u){var f=Q2(s)-(a?0:r.c),d=Y2(u)-(o?0:r.r),p=d==0?"":o?d+1:"["+d+"]",m=f==0?"":a?f+1:"["+f+"]";return i+"R"+p+"C"+m})}}();function i8(e,t){return e.replace(n8,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Rr(Q2(a)+t.c))+(s=="$"?s+o:Jr(Y2(o)+t.r))})}function _N(e,t,r){var n=oc(t),i=n.s,a=Tn(r),s={r:a.r-i.r,c:a.c-i.c};return i8(e,s)}function SN(e){return e.length!=1}function x3(e){return e.replace(/_xlfn\./g,"")}function vr(e){e.l+=1}function Ms(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function a8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return s8(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=Ms(e,2),o=Ms(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function s8(e){var t=Ms(e,2),r=Ms(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function wN(e,t,r){if(r.biff<8)return s8(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Ms(e,2),s=Ms(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function o8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return kN(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Ms(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function kN(e){var t=Ms(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function CN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function EN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TN(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function TN(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function AN(e,t,r){var n=(e[e.l++]&96)>>5,i=a8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function PN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=a8(e,a,r);return[n,i,s]}function NN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function RN(e,t,r){var n=(e[e.l++]&96)>>5,i=wN(e,t-1,r);return[n,i]}function bN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function IN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function DN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ON(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function MN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function l8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function BN(e){return e.read_shift(2),l8(e)}function jN(e){return e.read_shift(2),l8(e)}function UN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=o8(e,0,r);return[n,i]}function zN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=EN(e,0,r);return[n,i]}function VN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=o8(e,0,r);return[n,i,a]}function GN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[HF[i],f8[i],n]}function HN(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:WN(e);return[i,(a[0]===0?f8:GF)[a[1]]]}function WN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function $N(e,t,r){e.l+=r&&r.biff==2?3:4}function XN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function KN(e){return e.l++,Mo[e.read_shift(1)]}function YN(e){return e.l++,e.read_shift(2)}function QN(e){return e.l++,e.read_shift(1)!==0}function qN(e){return e.l++,hn(e)}function JN(e,t,r){return e.l++,du(e,t-1,r)}function ZN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=dr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=hn(e);break;case 2:r[1]=Bo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function eF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Lo:yh)(e));return i}function tF(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=ZN(e,r.biff);return s}function rF(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function nF(e,t,r){if(r.biff==5)return iF(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function iF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function aF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sF(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function oF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var cF=xn,uF=xn,fF=xn;function pu(e,t,r){return e.l+=2,[CN(e)]}function ix(e){return e.l+=6,[]}var dF=pu,hF=ix,pF=ix,gF=pu;function c8(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var mF=pu,xF=c8,vF=ix,yF=pu,_F=pu,SF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=SF[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function kF(e){return e.l+=2,[e.read_shift(4)]}function CF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function EF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function TF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PF(e){return e.l+=4,[0,0]}var y3={1:{n:"PtgExp",f:XN},2:{n:"PtgTbl",f:fF},3:{n:"PtgAdd",f:vr},4:{n:"PtgSub",f:vr},5:{n:"PtgMul",f:vr},6:{n:"PtgDiv",f:vr},7:{n:"PtgPower",f:vr},8:{n:"PtgConcat",f:vr},9:{n:"PtgLt",f:vr},10:{n:"PtgLe",f:vr},11:{n:"PtgEq",f:vr},12:{n:"PtgGe",f:vr},13:{n:"PtgGt",f:vr},14:{n:"PtgNe",f:vr},15:{n:"PtgIsect",f:vr},16:{n:"PtgUnion",f:vr},17:{n:"PtgRange",f:vr},18:{n:"PtgUplus",f:vr},19:{n:"PtgUminus",f:vr},20:{n:"PtgPercent",f:vr},21:{n:"PtgParen",f:vr},22:{n:"PtgMissArg",f:vr},23:{n:"PtgStr",f:JN},26:{n:"PtgSheet",f:CF},27:{n:"PtgEndSheet",f:EF},28:{n:"PtgErr",f:KN},29:{n:"PtgBool",f:QN},30:{n:"PtgInt",f:YN},31:{n:"PtgNum",f:qN},32:{n:"PtgArray",f:bN},33:{n:"PtgFunc",f:GN},34:{n:"PtgFuncVar",f:HN},35:{n:"PtgName",f:rF},36:{n:"PtgRef",f:UN},37:{n:"PtgArea",f:AN},38:{n:"PtgMemArea",f:aF},39:{n:"PtgMemErr",f:cF},40:{n:"PtgMemNoMem",f:uF},41:{n:"PtgMemFunc",f:sF},42:{n:"PtgRefErr",f:oF},43:{n:"PtgAreaErr",f:NN},44:{n:"PtgRefN",f:zN},45:{n:"PtgAreaN",f:RN},46:{n:"PtgMemAreaN",f:TF},47:{n:"PtgMemNoMemN",f:AF},57:{n:"PtgNameX",f:nF},58:{n:"PtgRef3d",f:VN},59:{n:"PtgArea3d",f:PN},60:{n:"PtgRefErr3d",f:lF},61:{n:"PtgAreaErr3d",f:FN},255:{}},NF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FF={1:{n:"PtgElfLel",f:c8},2:{n:"PtgElfRw",f:yF},3:{n:"PtgElfCol",f:dF},6:{n:"PtgElfRwV",f:_F},7:{n:"PtgElfColV",f:gF},10:{n:"PtgElfRadical",f:mF},11:{n:"PtgElfRadicalS",f:vF},13:{n:"PtgElfColS",f:hF},15:{n:"PtgElfColSV",f:pF},16:{n:"PtgElfRadicalLel",f:xF},25:{n:"PtgList",f:wF},29:{n:"PtgSxName",f:kF},255:{}},RF={0:{n:"PtgAttrNoop",f:PF},1:{n:"PtgAttrSemi",f:MN},2:{n:"PtgAttrIf",f:ON},4:{n:"PtgAttrChoose",f:IN},8:{n:"PtgAttrGoto",f:DN},16:{n:"PtgAttrSum",f:$N},32:{n:"PtgAttrBaxcel",f:v3},33:{n:"PtgAttrBaxcel",f:v3},64:{n:"PtgAttrSpace",f:BN},65:{n:"PtgAttrSpaceSemi",f:jN},128:{n:"PtgAttrIfError",f:LN},255:{}};function gu(e,t,r,n){if(n.biff<8)return xn(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=tF(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=eF(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(xn(e,t)),a}function mu(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=y3[a]||y3[NF[a]],(a===24||a===25)&&(i=(a===24?FF:RF)[e[e.l+1]]),!i||!i.f?xn(e,t):s.push([i.n,i.f(e,t,r)]);return s}function bF(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var IF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DF(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function u8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _3(e,t,r){var n=u8(e,t,r);return n=="#REF"?n:DF(n,r)}function fn(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],u,f,d,p=0,m=0,v,g="";if(!e[0]||!e[0][0])return"";for(var y=-1,C="",E=0,S=e[0].length;E<S;++E){var x=e[0][E];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:C=or(" ",e[0][y][1][1]);break;case 1:C=or("\r",e[0][y][1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+C,y=-1}o.push(f+IF[x[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_0(x[1][1],s,i),o.push(S0(d,a));break;case"PtgRefN":d=r?_0(x[1][1],r,i):x[1][1],o.push(S0(d,a));break;case"PtgRef3d":p=x[1][1],d=_0(x[1][2],s,i),g=_3(n,p,i),o.push(g+"!"+S0(d,a));break;case"PtgFunc":case"PtgFuncVar":var T=x[1][0],F=x[1][1];T||(T=0),T&=127;var N=T==0?[]:o.slice(-T);o.length-=T,F==="User"&&(F=N.shift()),o.push(F+"("+N.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":v=e3(x[1][1],r?{s:r}:s,i),o.push(tg(v,i));break;case"PtgArea":v=e3(x[1][1],s,i),o.push(tg(v,i));break;case"PtgArea3d":p=x[1][1],v=x[1][2],g=_3(n,p,i),o.push(g+"!"+tg(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=x[1][2];var A=(n.names||[])[m-1]||(n[0]||[])[m],P=A?A.Name:"SH33TJSNAME"+String(m);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var b=x[1][1];m=x[1][2];var I;if(i.biff<=5)b<0&&(b=-b),n[b]&&(I=n[b][m]);else{var O="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][m]&&n[b][m].itab>0&&(O=n.SheetNames[n[b][m].itab-1]+"!"):O=n.SheetNames[m-1]+"!"),n[b]&&n[b][m])O+=n[b][m].Name;else if(n[0]&&n[0][m])O+=n[0][m].Name;else{var j=(u8(n,b,i)||"").split(";;");j[m-1]?O=j[m-1]:O+="SH33TJSERRX"}o.push(O);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var q="(",ie=")";if(y>=0){switch(C="",e[0][y][1][0]){case 2:q=or(" ",e[0][y][1][1])+q;break;case 3:q=or("\r",e[0][y][1][1])+q;break;case 4:ie=or(" ",e[0][y][1][1])+ie;break;case 5:ie=or("\r",e[0][y][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(q+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[st(d)]){var Ae=n.sharedf[st(d)];o.push(fn(Ae,s,te,n,i))}else{var Ee=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(fn(f[1],s,te,n,i)),Ee=!0;break}Ee||o.push(x[1])}break;case"PtgArray":o.push("{"+bF(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&re.indexOf(e[0][E][0])==-1){x=e[0][y];var X=!0;switch(x[1][0]){case 4:X=!1;case 0:C=or(" ",x[1][1]);break;case 5:X=!1;case 1:C=or("\r",x[1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((X?C:"")+o.pop()+(X?"":C)),y=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function OF(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],xn(e,t-2)];var o=mu(e,s,r);return t!==s+i&&(a=gu(e,t-s-i,o,r)),e.l=n,[o,a]}function LF(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],xn(e,t-2)];var o=mu(e,s,r);return t!==s+i&&(a=gu(e,t-s-i,o,r)),e.l=n,[o,a]}function MF(e,t,r,n){var i=e.l+t,a=mu(e,n,r),s;return i!==e.l&&(s=gu(e,i-e.l,a,r)),[a,s]}function BF(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=mu(e,a,r);return a==65535?[[],xn(e,t-2)]:(t!==a+2&&(i=gu(e,n-a-2,s,r)),[s,i])}function jF(e){var t;if(La(e,e.l+6)!==65535)return[hn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function ig(e,t,r){var n=e.l+t,i=va(e);r.biff==2&&++e.l;var a=jF(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=LF(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function _h(e,t,r){var n=e.read_shift(4),i=mu(e,n,r),a=e.read_shift(4),s=a>0?gu(e,a,i,r):null;return[i,s]}var UF=_h,Sh=_h,zF=_h,VF=_h,GF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},f8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},HF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function S3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ag(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var E0={},Bl={};function T0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function d8(e,t,r,n,i,a){try{n.cellNF&&(e.z=ct[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ct[t]==null&&_o($E[t]||"General",t),e.t==="e")e.w=e.w||Mo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v);else if(e.t==="d"){var s=Nn(e.v);(s|0)===s?e.w=s.toString(10):e.w=Y0(s)}else{if(e.v===void 0)return"";e.w=Po(e.v,Bl)}else e.t==="d"?e.w=Ei(t,Nn(e.v),Bl):e.w=Ei(t,e.v,Bl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zd(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zd(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function WF(e,t){var r=cr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=kt(r))}var $F=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,XF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,KF=/<(?:\w:)?hyperlink [^>]*>/mg,YF=/"(\w*:\w*)"/,QF=/<(?:\w:)?col\b[^>]*[\/]?>/g,qF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JF=/<(?:\w:)?pageMargins[^>]*\/>/g,h8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ZF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tR(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match(XF);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var m=f.match(h8);m?ax(m[0],o,i,r):(m=f.match(ZF))&&rR(m[0],m[1]||"",o,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var g=f.slice(v,v+50).match(YF);g&&WF(o,g[1])}var y=f.match(eR);y&&y[1]&&lR(y[1],i);var C=[];if(t.cellStyles){var E=f.match(QF);E&&aR(C,E)}p&&cR(p[1],o,t,u,a,s);var S=d.match(qF);S&&(o["!autofilter"]=sR(S[0]));var x=[],T=d.match($F);if(T)for(v=0;v!=T.length;++v)x[v]=cr(T[v].slice(T[v].indexOf('"')+1));var F=d.match(KF);F&&nR(o,F,n);var N=d.match(JF);if(N&&(o["!margins"]=iR(tt(N[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=kt(u)),t.sheetRows>0&&o["!ref"]){var A=cr(o["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=kt(A))}return C.length>0&&(o["!cols"]=C),x.length>0&&(o["!merges"]=x),o}function ax(e,t,r,n){var i=tt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Et(Ht(i.codeName)))}function rR(e,t,r,n,i){ax(e.slice(0,e.indexOf(">")),r,n,i)}function nR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=tt(Ht(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Et(a.location))):(a.Target="#"+Et(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=cr(a.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=st({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function iR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function aR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=tt(t[n],!0);i.hidden&&(i.hidden=Qt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,nx(i.width)),ql(i);a<=s;)e[a++]=qr(i)}}function sR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var oR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function lR(e,t){t.Views||(t.Views=[{}]),(e.match(oR)||[]).forEach(function(r,n){var i=tt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Qt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var cR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Q0("v"),s=Q0("f");return function(u,f,d,p,m,v){for(var g=0,y="",C=[],E=[],S=0,x=0,T=0,F="",N,A,P=0,b=0,I,O,j=0,q=0,ie=Array.isArray(v.CellXf),te,Ae=[],Ee=[],re=Array.isArray(f),X=[],he={},Te=!1,L=!!d.sheetStubs,Q=u.split(t),Y=0,K=Q.length;Y!=K;++Y){y=Q[Y].trim();var ue=y.length;if(ue!==0){var V=0;e:for(g=0;g<ue;++g)switch(y[g]){case">":if(y[g-1]!="/"){++g;break e}if(d&&d.cellStyles){if(A=tt(y.slice(V,g),!0),P=A.r!=null?parseInt(A.r,10):P+1,b=-1,d.sheetRows&&d.sheetRows<P)continue;he={},Te=!1,A.ht&&(Te=!0,he.hpt=parseFloat(A.ht),he.hpx=eu(he.hpt)),A.hidden=="1"&&(Te=!0,he.hidden=!0),A.outlineLevel!=null&&(Te=!0,he.level=+A.outlineLevel),Te&&(X[P-1]=he)}break;case"<":V=g;break}if(V>=g)break;if(A=tt(y.slice(V,g),!0),P=A.r!=null?parseInt(A.r,10):P+1,b=-1,!(d.sheetRows&&d.sheetRows<P)){p.s.r>P-1&&(p.s.r=P-1),p.e.r<P-1&&(p.e.r=P-1),d&&d.cellStyles&&(he={},Te=!1,A.ht&&(Te=!0,he.hpt=parseFloat(A.ht),he.hpx=eu(he.hpt)),A.hidden=="1"&&(Te=!0,he.hidden=!0),A.outlineLevel!=null&&(Te=!0,he.level=+A.outlineLevel),Te&&(X[P-1]=he)),C=y.slice(g).split(e);for(var Z=0;Z!=C.length&&C[Z].trim().charAt(0)=="<";++Z);for(C=C.slice(Z),g=0;g!=C.length;++g)if(y=C[g].trim(),y.length!==0){if(E=y.match(r),S=g,x=0,T=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,E!=null&&E.length===2){for(S=0,F=E[1],x=0;x!=F.length&&!((T=F.charCodeAt(x)-64)<1||T>26);++x)S=26*S+T;--S,b=S}else++b;for(x=0;x!=y.length&&y.charCodeAt(x)!==62;++x);if(++x,A=tt(y.slice(0,x),!0),A.r||(A.r=st({r:P-1,c:b})),F=y.slice(x),N={t:""},(E=F.match(a))!=null&&E[1]!==""&&(N.v=Et(E[1])),d.cellFormula){if((E=F.match(s))!=null&&E[1]!==""){if(N.f=Et(Ht(E[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=x3(N.f)),E[0].indexOf('t="array"')>-1)N.F=(F.match(i)||[])[1],N.F.indexOf(":")>-1&&Ae.push([cr(N.F),N.F]);else if(E[0].indexOf('t="shared"')>-1){O=tt(E[0]);var fe=Et(Ht(E[1]));d.xlfn||(fe=x3(fe)),Ee[parseInt(O.si,10)]=[O,fe,A.r]}}else(E=F.match(/<f[^>]*\/>/))&&(O=tt(E[0]),Ee[O.si]&&(N.f=_N(Ee[O.si][1],Ee[O.si][2],A.r)));var ve=Tn(A.r);for(x=0;x<Ae.length;++x)ve.r>=Ae[x][0].s.r&&ve.r<=Ae[x][0].e.r&&ve.c>=Ae[x][0].s.c&&ve.c<=Ae[x][0].e.c&&(N.F=Ae[x][1])}if(A.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(L)N.t="z";else continue;else N.t=A.t||"n";switch(p.s.c>b&&(p.s.c=b),p.e.c<b&&(p.e.c=b),N.t){case"n":if(N.v==""||N.v==null){if(!L)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!L)continue;N.t="z"}else I=E0[parseInt(N.v,10)],N.v=I.t,N.r=I.r,d.cellHTML&&(N.h=I.h);break;case"str":N.t="s",N.v=N.v!=null?Ht(N.v):"",d.cellHTML&&(N.h=$2(N.v));break;case"inlineStr":E=F.match(n),N.t="s",E!=null&&(I=rx(E[1]))?(N.v=I.t,d.cellHTML&&(N.h=I.h)):N.v="";break;case"b":N.v=Qt(N.v);break;case"d":d.cellDates?N.v=Wr(N.v,1):(N.v=Nn(Wr(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=DS[N.v];break}if(j=q=0,te=null,ie&&A.s!==void 0&&(te=v.CellXf[A.s],te!=null&&(te.numFmtId!=null&&(j=te.numFmtId),d.cellStyles&&te.fillId!=null&&(q=te.fillId))),d8(N,j,q,d,m,v),d.cellDates&&ie&&N.t=="n"&&sc(ct[j])&&(N.t="d",N.v=vh(N.v)),A.cm&&d.xlmeta){var Be=(d.xlmeta.Cell||[])[+A.cm-1];Be&&Be.type=="XLDAPR"&&(N.D=!0)}if(re){var G=Tn(A.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=N}else f[A.r]=N}}}}X.length>0&&(f["!rows"]=X)}}();function uR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var fR=Lo;function dR(){}function hR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=O7(e),r}function pR(e){var t=Ti(e);return[t]}function gR(e){var t=Oo(e);return[t]}function mR(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"b"]}function xR(e){var t=Oo(e),r=e.read_shift(1);return[t,r,"b"]}function vR(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"e"]}function yR(e){var t=Oo(e),r=e.read_shift(1);return[t,r,"e"]}function _R(e){var t=Ti(e),r=e.read_shift(4);return[t,r,"s"]}function SR(e){var t=Oo(e),r=e.read_shift(4);return[t,r,"s"]}function wR(e){var t=Ti(e),r=hn(e);return[t,r,"n"]}function p8(e){var t=Oo(e),r=hn(e);return[t,r,"n"]}function kR(e){var t=Ti(e),r=Z2(e);return[t,r,"n"]}function CR(e){var t=Oo(e),r=Z2(e);return[t,r,"n"]}function ER(e){var t=Ti(e),r=q2(e);return[t,r,"is"]}function TR(e){var t=Ti(e),r=gn(e);return[t,r,"str"]}function AR(e){var t=Oo(e),r=gn(e);return[t,r,"str"]}function PR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Sh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function NR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Sh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function FR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=hn(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Sh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function RR(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var a=gn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Sh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}var bR=Lo;function IR(e,t){var r=e.l+t,n=Lo(e),i=J2(e),a=gn(e),s=gn(e),o=gn(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:o};return s&&(u.Tooltip=s),u}function DR(){}function OR(e,t,r){var n=e.l+t,i=RS(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=UF(e,n-e.l,r);s[1]=o}else e.l=n;return s}function LR(e,t,r){var n=e.l+t,i=Lo(e),a=[i];if(r.cellFormula){var s=VF(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}var MR=["left","right","top","bottom","header","footer"];function BR(e){var t={};return MR.forEach(function(r){t[r]=hn(e)}),t}function jR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UR(){}function zR(){}function VR(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,v,g,y,C,E,S,x,T,F,N=[];o.biff=12,o["!row"]=0;var A=0,P=!1,b=[],I={},O=o.supbooks||i.supbooks||[[]];if(O.sharedf=I,O.arrayf=b,O.SheetNames=i.SheetNames||i.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=O,i.Names))for(var j=0;j<i.Names.length;++j)O[0][j+1]=i.Names[j];var q=[],ie=[],te=!1;Hd[16]={n:"BrtShortReal",f:p8};var Ae;if(Ka(e,function(X,he,Te){if(!m)switch(Te){case 148:f=X;break;case 0:v=X,o.sheetRows&&o.sheetRows<=v.r&&(m=!0),T=Jr(C=v.r),o["!row"]=v.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=eu(X.hpt)),ie[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:X[2]},X[2]){case"n":g.v=X[1];break;case"s":x=E0[X[1]],g.v=x.t,g.r=x.r;break;case"b":g.v=!!X[1];break;case"e":g.v=X[1],o.cellText!==!1&&(g.w=Mo[g.v]);break;case"str":g.t="s",g.v=X[1];break;case"is":g.t="s",g.v=X[1].t;break}if((y=s.CellXf[X[0].iStyleRef])&&d8(g,y.numFmtId,null,o,a,s),E=X[0].c==-1?E+1:X[0].c,o.dense?(u[C]||(u[C]=[]),u[C][E]=g):u[Rr(E)+T]=g,o.cellFormula){for(P=!1,A=0;A<b.length;++A){var L=b[A];v.r>=L[0].s.r&&v.r<=L[0].e.r&&E>=L[0].s.c&&E<=L[0].e.c&&(g.F=kt(L[0]),P=!0)}!P&&X.length>3&&(g.f=X[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>E&&(d.s.c=E),d.e.r<v.r&&(d.e.r=v.r),d.e.c<E&&(d.e.c=E),o.cellDates&&y&&g.t=="n"&&sc(ct[y.numFmtId])){var Q=mo(g.v);Q&&(g.t="d",g.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;g={t:"z",v:void 0},E=X[0].c==-1?E+1:X[0].c,o.dense?(u[C]||(u[C]=[]),u[C][E]=g):u[Rr(E)+T]=g,d.s.r>v.r&&(d.s.r=v.r),d.s.c>E&&(d.s.c=E),d.e.r<v.r&&(d.e.r=v.r),d.e.c<E&&(d.e.c=E),Ae&&(Ae.type=="XLDAPR"&&(g.D=!0),Ae=void 0);break;case 176:N.push(X);break;case 49:Ae=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var Y=n["!id"][X.relId];for(Y?(X.Target=Y.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=Y):X.relId==""&&(X.Target="#"+X.loc),C=X.rfx.s.r;C<=X.rfx.e.r;++C)for(E=X.rfx.s.c;E<=X.rfx.e.c;++E)o.dense?(u[C]||(u[C]=[]),u[C][E]||(u[C][E]={t:"z",v:void 0}),u[C][E].l=X):(S=st({c:E,r:C}),u[S]||(u[S]={t:"z",v:void 0}),u[S].l=X);break;case 426:if(!o.cellFormula)break;b.push(X),F=o.dense?u[C][E]:u[Rr(E)+T],F.f=fn(X[1],d,{r:v.r,c:E},O,o),F.F=kt(X[0]);break;case 427:if(!o.cellFormula)break;I[st(X[0].s)]=X[1],F=o.dense?u[C][E]:u[Rr(E)+T],F.f=fn(X[1],d,{r:v.r,c:E},O,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)q[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},te||(te=!0,nx(X.w/256)),ql(q[X.e+1]);break;case 161:u["!autofilter"]={ref:kt(X)};break;case 476:u["!margins"]=X;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),X.name&&(i.Sheets[r].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!he.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=kt(f||d)),o.sheetRows&&u["!ref"]){var Ee=cr(u["!ref"]);o.sheetRows<=+Ee.e.r&&(Ee.e.r=o.sheetRows-1,Ee.e.r>d.e.r&&(Ee.e.r=d.e.r),Ee.e.r<Ee.s.r&&(Ee.s.r=Ee.e.r),Ee.e.c>d.e.c&&(Ee.e.c=d.e.c),Ee.e.c<Ee.s.c&&(Ee.s.c=Ee.e.c),u["!fullref"]=u["!ref"],u["!ref"]=kt(Ee))}return N.length>0&&(u["!merges"]=N),q.length>0&&(u["!cols"]=q),ie.length>0&&(u["!rows"]=ie),u}function GR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function HR(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=GR(p);d.s.r=d.s.c=0,d.e.c=o,f=Rr(o),m[0].forEach(function(v,g){s[f+Jr(g)]={t:"n",v,z:m[1]},u=g}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(s["!ref"]=kt(d)),s}function WR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(h8);return o&&ax(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function $R(e,t){e.l+=10;var r=gn(e);return{name:r}}function XR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Ka(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var g8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],KR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],YR=[],QR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Qt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function k3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Qt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function m8(e){k3(e.WBProps,g8),k3(e.CalcPr,QR),w3(e.WBView,KR),w3(e.Sheets,YR),Bl.date1904=Qt(e.WBProps.date1904)}var qR="][*?/\\".split("");function JR(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return qR.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var ZR=/<\w+:workbook/;function eb(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(vn,function(u,f){var d=tt(u);switch(xa(d[0])){case"<?xml":break;case"<workbook":u.match(ZR)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":g8.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Qt(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=Ht(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Et(Ht(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ht(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Qt(d.hidden||"0")&&(a.Hidden=!0),s=f+u.length;break;case"</definedName>":a.Ref=Et(Ht(e.slice(s,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),v7.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return m8(r),r}function tb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=wm(e),r.name=gn(e),r}function rb(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?gn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function nb(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function ib(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=L7(e),s=zF(e,0,r),o=J2(e);e.l=n;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function ab(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Hd[16]={n:"BrtFRTArchID$",f:nb},Ka(e,function(u,f,d){switch(d){case 156:s.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=fn(u.Ptg,null,null,s,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,u]):s[0]=[d,u],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(u),s.XTI=s.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),m8(r),r.Names=a,r.supbooks=s,r}function sb(e,t,r){return t.slice(-4)===".bin"?ab(e,r):eb(e,r)}function ob(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?VR(e,n,r,i,a,s,o):tR(e,n,r,i,a,s,o)}function lb(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?XR(e,n,r,i,a):WR(e,n,r,i,a)}function cb(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?xN():vN()}function ub(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?gN():mN()}function fb(e,t,r,n){return t.slice(-4)===".bin"?bP(e,r,n):TP(e,r,n)}function db(e,t,r){return r8(e,r)}function hb(e,t,r){return t.slice(-4)===".bin"?KA(e,r):$A(e,r)}function pb(e,t,r){return t.slice(-4)===".bin"?dN(e,r):oN(e,r)}function gb(e,t,r){return t.slice(-4)===".bin"?iN(e):rN(e)}function mb(e,t,r,n){return r.slice(-4)===".bin"?aN(e,t,r,n):void 0}function xb(e,t,r){return t.slice(-4)===".bin"?eN(e,t,r):tN(e,t,r)}var x8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,v8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Oi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(x8),a,s,o,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(v8),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function vb(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(x8),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(v8),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var A0;function yb(e,t){var r=A0[e]||Et(e);return r==="General"?Po(t):Ei(r,t)}function _b(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Qt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Wr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Et(t)]=i}function Sb(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Mo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v):e.w=Po(e.v):e.w=yb(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=A0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&sc(n)){var i=mo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function wb(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=_P[n.Pattern]||n.Pattern)}e[t.ID]=t}function kb(e,t,r,n,i,a,s,o,u,f){var d="General",p=n.StyleID,m={};f=f||{};var v=[],g=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);a[p]!==void 0&&(a[p].nf&&(d=a[p].nf),a[p].Interior&&v.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Qt(e);break;case"String":n.t="s",n.r=W4(Et(e)),n.v=e.indexOf("<")>-1?Et(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Wr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Et(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=DS[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=W4(t||e));break}if(Sb(n,d,f),f.cellFormula!==!1)if(n.Formula){var y=Et(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Ml(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ml("RC:RC",i):n.ArrayRange&&(n.F=Ml(n.ArrayRange,i),u.push([cr(n.F),n.F]))}else for(g=0;g<u.length;++g)i.r>=u[g][0].s.r&&i.r<=u[g][0].e.r&&i.c>=u[g][0].s.c&&i.c<=u[g][0].e.c&&(n.F=u[g][1]);f.cellStyles&&(v.forEach(function(C){!m.patternType&&C.patternType&&(m.patternType=C.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Cb(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sg(e,t){var r=t||{};aS();var n=i0(X2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ht(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=qr(r);return s.type="string",J0.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(St){i.indexOf("<"+St)>=0&&(a=!0)}),a)return Ib(n,r);A0={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},p=[],m=r.dense?[]:{},v="",g={},y={},C=Oi('<Data ss:Type="String">'),E=0,S=0,x=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},N={},A="",P=0,b=[],I={},O={},j=0,q=[],ie=[],te={},Ae=[],Ee,re=!1,X=[],he=[],Te={},L=0,Q=0,Y={Sheets:[],WBProps:{date1904:!1}},K={};q0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";o=q0.exec(n);)switch(o[3]=(ue=o[3]).toLowerCase()){case"data":if(ue=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?kb(n.slice(E,o.index),A,C,u[u.length-1][0]=="comment"?te:g,{c:S,r:x},F,Ae[S],y,X,r):(A="",C=Oi(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ie.length>0&&(g.c=ie),(!r.sheetRows||r.sheetRows>x)&&g.v!==void 0&&(r.dense?(m[x]||(m[x]=[]),m[x][S]=g):m[Rr(S)+Jr(x)]=g),g.HRef&&(g.l={Target:Et(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(L=S+(parseInt(g.MergeAcross,10)|0),Q=x+(parseInt(g.MergeDown,10)|0),b.push({s:{c:S,r:x},e:{c:L,r:Q}})),!r.sheetStubs)g.MergeAcross?S=L+1:++S;else if(g.MergeAcross||g.MergeDown){for(var V=S;V<=L;++V)for(var Z=x;Z<=Q;++Z)(V>S||Z>x)&&(r.dense?(m[Z]||(m[Z]=[]),m[Z][V]={t:"z"}):m[Rr(V)+Jr(Z)]={t:"z"});S=L+1}else++S;else g=vb(o[0]),g.Index&&(S=+g.Index-1),S<T.s.c&&(T.s.c=S),S>T.e.c&&(T.e.c=S),o[0].slice(-2)==="/>"&&++S,ie=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<T.s.r&&(T.s.r=x),x>T.e.r&&(T.e.r=x),o[0].slice(-2)==="/>"&&(y=Oi(o[0]),y.Index&&(x=+y.Index-1)),S=0,++x):(y=Oi(o[0]),y.Index&&(x=+y.Index-1),Te={},(y.AutoFitHeight=="0"||y.Height)&&(Te.hpx=parseInt(y.Height,10),Te.hpt=t8(Te.hpx),he[x]=Te),y.Hidden=="1"&&(Te.hidden=!0,he[x]=Te));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(v),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(m["!ref"]=kt(T),r.sheetRows&&r.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=r.sheetRows-1,m["!ref"]=kt(T))),b.length&&(m["!merges"]=b),Ae.length>0&&(m["!cols"]=Ae),he.length>0&&(m["!rows"]=he),d[v]=m}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=S=0,u.push([o[3],!1]),f=Oi(o[0]),v=Et(f.Name),m=r.dense?[]:{},b=[],X=[],he=[],K={name:v,Hidden:0},Y.Sheets.push(K);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),Ae=[],re=!1}break;case"style":o[1]==="/"?wb(F,N,r):N=Oi(o[0]);break;case"numberformat":N.nf=Et(Oi(o[0]).Format||"General"),A0[N.nf]&&(N.nf=A0[N.nf]);for(var fe=0;fe!=392&&ct[fe]!=N.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(ct[fe]==null){_o(N.nf,fe);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Ee=Oi(o[0]),Ee.Hidden&&(Ee.hidden=!0,delete Ee.Hidden),Ee.Width&&(Ee.wpx=parseInt(Ee.Width,10)),!re&&Ee.wpx>10){re=!0,En=ZS;for(var ve=0;ve<Ae.length;++ve)Ae[ve]&&ql(Ae[ve])}re&&ql(Ee),Ae[Ee.Index-1||Ae.length]=Ee;for(var Be=0;Be<+Ee.Span;++Be)Ae[Ae.length]=qr(Ee);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var G=tt(o[0]),qe={Name:G.Name,Ref:Ml(G.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(qe.Sheet=Y.Sheets.length-1),Y.Names.push(qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Oi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?oT(I,ue,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));Cb(te),ie.push(te)}else u.push([o[3],!1]),f=Oi(o[0]),te={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var et=Oi(o[0]);m["!autofilter"]={ref:Ml(et.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return N3(n,r);var Ye=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else j=o.index+o[0].length;break;case"header":m["!margins"]||T0(m["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(m["!margins"].header=+tt(o[0]).Margin);break;case"footer":m["!margins"]||T0(m["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(m["!margins"].footer=+tt(o[0]).Margin);break;case"pagemargins":var Qe=tt(o[0]);m["!margins"]||T0(m["!margins"]={},"xlml"),isNaN(+Qe.Top)||(m["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(m["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(m["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(m["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?_b(O,ue,q,n.slice(j,o.index)):(q=o,j=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var Fe={};return!r.bookSheets&&!r.bookProps&&(Fe.Sheets=d),Fe.SheetNames=p,Fe.Workbook=Y,Fe.SSF=qr(ct),Fe.Props=I,Fe.Custprops=O,Fe}function Tm(e,t){switch(lx(t=t||{}),t.type||"base64"){case"base64":return sg(ri(e),t);case"binary":case"buffer":case"file":return sg(e,t);case"array":return sg(Do(e),t)}}function Eb(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=j7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=U7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Tb=[60,1084,2066,2165,2175];function Ab(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var u=La(r,r.l),f=Am[u],d=0;f!=null&&Tb.indexOf(u)>-1;)a=La(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,f=Am[u=La(r,r.l)];var p=ys(s);Yr(p,0);var m=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(m),m+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function la(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ct[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Mo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v):e.w=Po(e.v):e.w=Ei(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&sc(ct[n]||String(n))){var i=mo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function zf(e,t,r){return{v:e,ixfe:t,t:r}}function Pb(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,u=[],f="",d={},p,m="",v,g,y,C,E={},S=[],x,T,F=[],N=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},b=function(xe){return xe<8?So[xe]:xe<64&&N[xe-8]||So[xe]},I=function(xe,be,Le){var Xe=be.XF.data;if(!(!Xe||!Xe.patternType||!Le||!Le.cellStyles)){be.s={},be.s.patternType=Xe.patternType;var gt;(gt=Z0(b(Xe.icvFore)))&&(be.s.fgColor={rgb:gt}),(gt=Z0(b(Xe.icvBack)))&&(be.s.bgColor={rgb:gt})}},O=function(xe,be,Le){if(!(Te>1)&&!(Le.sheetRows&&xe.r>=Le.sheetRows)){if(Le.cellStyles&&be.XF&&be.XF.data&&I(xe,be,Le),delete be.ixfe,delete be.XF,p=xe,m=st(xe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<s.s.r&&(s.s.r=xe.r),xe.c<s.s.c&&(s.s.c=xe.c),xe.r+1>s.e.r&&(s.e.r=xe.r+1),xe.c+1>s.e.c&&(s.e.c=xe.c+1),Le.cellFormula&&be.f){for(var Xe=0;Xe<S.length;++Xe)if(!(S[Xe][0].s.c>xe.c||S[Xe][0].s.r>xe.r)&&!(S[Xe][0].e.c<xe.c||S[Xe][0].e.r<xe.r)){be.F=kt(S[Xe][0]),(S[Xe][0].s.c!=xe.c||S[Xe][0].s.r!=xe.r)&&delete be.f,be.f&&(be.f=""+fn(S[Xe][1],s,xe,X,j));break}}Le.dense?(i[xe.r]||(i[xe.r]=[]),i[xe.r][xe.c]=be):i[m]=be}},j={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var q,ie=[],te=[],Ae=[],Ee=[],re=!1,X=[];X.SheetNames=j.snames,X.sharedf=j.sharedf,X.arrayf=j.arrayf,X.names=[],X.XTI=[];var he=0,Te=0,L=0,Q=[],Y=[],K;j.codepage=1200,Vi(1200);for(var ue=!1;e.l<e.length-1;){var V=e.l,Z=e.read_shift(2);if(Z===0&&he===10)break;var fe=e.l===e.length?0:e.read_shift(2),ve=Am[Z];if(ve&&ve.f){if(t.bookSheets&&he===133&&Z!==133)break;if(he=Z,ve.r===2||ve.r==12){var Be=e.read_shift(2);if(fe-=2,!j.enc&&Be!==Z&&((Be&255)<<8|Be>>8)!==Z)throw new Error("rt mismatch: "+Be+"!="+Z);ve.r==12&&(e.l+=10,fe-=10)}var G={};if(Z===10?G=ve.f(e,fe,j):G=Ab(Z,ve,e,fe,j),Te==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(Z){case 34:r.opts.Date1904=A.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=G;break;case 66:var qe=Number(G);switch(qe){case 21010:qe=1200;break;case 32768:qe=1e4;break;case 32769:qe=1252;break}Vi(j.codepage=qe),ue=!0;break;case 317:j.rrtabid=G;break;case 25:j.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:j.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:F.push(G);break;case 430:X.push([G]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:fn(G.rgce,s,null,X,j)},G.itab>0&&(K.Sheet=G.itab-1),X.names.push(K),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Y[G.itab-1]={ref:kt(G.rgce[0][0][1][2])});break;case 22:j.ExternCount=G;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(G),X.XTI=X.XTI.concat(G);break;case 2196:if(j.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&j.WTF&&console.error("Password verifier: "+G);break;case 133:a[G.pos]=G,j.snames.push(G.name);break;case 10:{if(--Te)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=kt(s),t.sheetRows&&t.sheetRows<=s.e.r){var et=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=kt(s),s.e.r=et}s.e.r++,s.e.c++}ie.length>0&&(i["!merges"]=ie),te.length>0&&(i["!objects"]=te),Ae.length>0&&(i["!cols"]=Ae),Ee.length>0&&(i["!rows"]=Ee),A.Sheets.push(P)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[Z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),j.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(j.biff=5,ue=!0,Vi(j.codepage=28591)),j.biff==8&&G.BIFFVer==0&&G.dt==16&&(j.biff=2),Te++)break;if(i=t.dense?[]:{},j.biff<8&&!ue&&(ue=!0,Vi(j.codepage=t.codepage||1252)),j.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:e.l-fe,name:f};a[Ye.pos]=Ye,j.snames.push(f)}else f=(a[V]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),ie=[],te=[],j.arrayf=S=[],Ae=[],Ee=[],re=!1,P={Hidden:(a[V]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[G.r]||[])[G.c]:i[st({c:G.c,r:G.r})])&&++G.c,x={ixfe:G.ixfe,XF:F[G.ixfe]||{},v:G.val,t:"n"},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 5:case 517:x={ixfe:G.ixfe,XF:F[G.ixfe],v:G.val,t:G.t},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 638:x={ixfe:G.ixfe,XF:F[G.ixfe],v:G.rknum,t:"n"},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 189:for(var Qe=G.c;Qe<=G.C;++Qe){var Fe=G.rkrec[Qe-G.c][0];x={ixfe:Fe,XF:F[Fe],v:G.rkrec[Qe-G.c][1],t:"n"},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:Qe,r:G.r},x,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(x=zf(G.val,G.cell.ixfe,G.tt),x.XF=F[x.ixfe],t.cellFormula){var St=G.formula;if(St&&St[0]&&St[0][0]&&St[0][0][0]=="PtgExp"){var Or=St[0][0][1][0],gr=St[0][0][1][1],_e=st({r:Or,c:gr});E[_e]?x.f=""+fn(G.formula,s,G.cell,X,j):x.F=((t.dense?(i[Or]||[])[gr]:i[_e])||{}).F}else x.f=""+fn(G.formula,s,G.cell,X,j)}L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O(G.cell,x,t),o=G}break;case 7:case 519:if(o)o.val=G,x=zf(G,o.cell.ixfe,"s"),x.XF=F[x.ixfe],t.cellFormula&&(x.f=""+fn(o.formula,s,o.cell,X,j)),L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(G);var me=st(G[0].s);if(v=t.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[me],t.cellFormula&&v){if(!o||!me||!v)break;v.f=""+fn(G[1],s,G[0],X,j),v.F=kt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;E[st(o.cell)]=G[0],v=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[st(o.cell)],(v||{}).f=""+fn(G[0],s,p,X,j)}}break;case 253:x=zf(u[G.isst].t,G.ixfe,"s"),u[G.isst].h&&(x.h=u[G.isst].h),x.XF=F[x.ixfe],L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:G.ixfe,XF:F[G.ixfe],t:"z"},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t));break;case 190:if(t.sheetStubs)for(var ke=G.c;ke<=G.C;++ke){var we=G.ixfe[ke-G.c];x={ixfe:we,XF:F[we],t:"z"},L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:ke,r:G.r},x,t)}break;case 214:case 516:case 4:x=zf(G.val,G.ixfe,"s"),x.XF=F[x.ixfe],L>0&&(x.z=Q[x.ixfe>>8&63]),la(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 0:case 512:Te===1&&(s=G);break;case 252:u=G;break;case 1054:if(j.biff==4){Q[L++]=G[1];for(var Ce=0;Ce<L+163&&ct[Ce]!=G[1];++Ce);Ce>=163&&_o(G[1],L+163)}else _o(G[1],G[0]);break;case 30:{Q[L++]=G;for(var Pe=0;Pe<L+163&&ct[Pe]!=G;++Pe);Pe>=163&&_o(G,L+163)}break;case 229:ie=ie.concat(G);break;case 93:te[G.cmo[0]]=j.lastobj=G;break;case 438:j.lastobj.TxO=G;break;case 127:j.lastobj.ImData=G;break;case 440:for(C=G[0].s.r;C<=G[0].e.r;++C)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[C]||[])[y]:i[st({c:y,r:C})],v&&(v.l=G[1]);break;case 2048:for(C=G[0].s.r;C<=G[0].e.r;++C)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[C]||[])[y]:i[st({c:y,r:C})],v&&v.l&&(v.l.Tooltip=G[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;v=t.dense?(i[G[0].r]||[])[G[0].c]:i[st(G[0])];var Me=te[G[2]];v||(t.dense?(i[G[0].r]||(i[G[0].r]=[]),v=i[G[0].r][G[0].c]={t:"z"}):v=i[st(G[0])]={t:"z"},s.e.r=Math.max(s.e.r,G[0].r),s.s.r=Math.min(s.s.r,G[0].r),s.e.c=Math.max(s.e.c,G[0].c),s.s.c=Math.min(s.s.c,G[0].c)),v.c||(v.c=[]),g={a:G[1],t:Me.TxO.t},v.c.push(g)}break;case 2173:QP(F[G.ixfe],G.ext);break;case 125:{if(!j.cellStyles)break;for(;G.e>=G.s;)Ae[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},re||(re=!0,nx(G.w/256)),ql(Ae[G.e+1])}break;case 520:{var pe={};G.level!=null&&(Ee[G.r]=pe,pe.level=G.level),G.hidden&&(Ee[G.r]=pe,pe.hidden=!0),G.hpt&&(Ee[G.r]=pe,pe.hpt=G.hpt,pe.hpx=eu(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||T0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Z]]=G;break;case 161:i["!margins"]||T0(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(A.Views[0].RTL=!0);break;case 146:N=G;break;case 2198:q=G;break;case 140:T=G;break;case 442:f?P.CodeName=G||P.name:A.WBProps.CodeName=G||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+Z.toString(16)),e.l+=fe}return r.SheetNames=ma(a).sort(function(ae,xe){return Number(ae)-Number(xe)}).map(function(ae){return a[ae].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Y.forEach(function(ae,xe){r.Sheets[r.SheetNames[xe]]["!autofilter"]=ae}),r.Strings=u,r.SSF=qr(ct),j.enc&&(r.Encryption=j.enc),q&&(r.Themes=q),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),X.names.length>0&&(A.Names=X.names),r.Workbook=A,r}var C3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Nb(e,t,r){var n=wt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=o3(n,$7,C3.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var s=wt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=o3(s,X7,C3.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(LS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function y8(e,t){t||(t={}),lx(t),X6(),t.codepage&&U2(t.codepage);var r,n;if(e.FullPaths){if(wt.find(e,"/encryption"))throw new Error("File is password-protected");r=wt.find(e,"!CompObj"),n=wt.find(e,"/Workbook")||wt.find(e,"/Book")}else{switch(t.type){case"base64":e=zi(ri(e));break;case"binary":e=zi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Yr(e,0),n={content:e}}var i,a;if(r&&Eb(r),t.bookProps&&!t.bookSheets)i={};else{var s=yt?"buffer":"array";if(n&&n.content)i=Pb(n.content,t);else if((a=wt.find(e,"PerfectOffice_MAIN"))&&a.content)i=C0.to_workbook(a.content,(t.type=s,t));else if((a=wt.find(e,"NativeContent_MAIN"))&&a.content)i=C0.to_workbook(a.content,(t.type=s,t));else throw(a=wt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&wt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=pN(e))}var o={};return e.FullPaths&&Nb(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var Hd={0:{f:uR},1:{f:pR},2:{f:kR},3:{f:vR},4:{f:mR},5:{f:wR},6:{f:TR},7:{f:_R},8:{f:RR},9:{f:FR},10:{f:PR},11:{f:NR},12:{f:gR},13:{f:CR},14:{f:yR},15:{f:xR},16:{f:p8},17:{f:AR},18:{f:SR},19:{f:q2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ib},40:{},42:{},43:{f:PP},44:{f:AP},45:{f:NP},46:{f:RP},47:{f:FP},48:{},49:{f:b7},50:{},51:{f:JP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:KS},62:{f:ER},63:{f:nN},64:{f:UR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:jR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hR},148:{f:fR,p:16},151:{f:DR},152:{},153:{f:rb},154:{},155:{},156:{f:tb},157:{},158:{},159:{T:1,f:XA},160:{T:-1},161:{T:1,f:Lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:qP},336:{T:-1},337:{f:ZP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:XS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OR},427:{f:LR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fN},633:{T:1},634:{T:-1},635:{T:1,f:uN},636:{T:-1},637:{f:D7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$R},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Am={6:{f:ig},10:{f:fs},12:{f:_r},13:{f:_r},14:{f:dr},15:{f:dr},16:{f:hn},17:{f:dr},18:{f:dr},19:{f:_r},20:{f:f3},21:{f:f3},23:{f:XS},24:{f:h3},25:{f:dr},26:{},27:{},28:{f:lA},29:{},34:{f:dr},35:{f:d3},38:{f:hn},39:{f:hn},40:{f:hn},41:{f:hn},42:{f:dr},43:{f:dr},47:{f:dP},49:{f:GT},51:{f:_r},60:{},61:{f:UT},64:{f:dr},65:{f:VT},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:bT},93:{f:uA},94:{},95:{f:dr},96:{},97:{},99:{f:dr},125:{f:KS},128:{f:ZT},129:{f:IT},130:{f:_r},131:{f:dr},132:{f:dr},133:{f:DT},134:{},140:{f:mA},141:{f:_r},144:{},146:{f:vA},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:kA},161:{f:_A},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YT},190:{f:QT},193:{f:fs},197:{},198:{},199:{},200:{},201:{},202:{f:dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:dr},222:{},224:{f:JT},225:{f:RT},226:{f:fs},227:{},229:{f:cA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:OT},253:{f:HT},255:{f:LT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dr},353:{f:fs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tA},431:{f:dr},432:{},433:{},434:{},437:{},438:{f:hA},439:{f:dr},440:{f:pA},441:{},442:{f:hu},443:{},444:{f:_r},445:{},446:{},448:{f:fs},449:{f:jT,r:2},450:{f:fs},512:{f:c3},513:{f:wA},515:{f:eA},516:{f:WT},517:{f:u3},519:{f:CA},520:{f:MT},523:{},545:{f:p3},549:{f:l3},566:{},574:{f:zT},638:{f:KT},659:{},1048:{},1054:{f:$T},1084:{},1212:{f:aA},2048:{f:gA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:fs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:yA,r:12},2173:{f:YP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:iA,r:12},2197:{},2198:{f:GP,r:12},2199:{},2200:{},2201:{},2202:{f:sA,r:12},2203:{f:fs},2204:{},2205:{},2206:{},2207:{},2211:{f:BT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:c3},1:{},2:{f:PA},3:{f:AA},4:{f:TA},5:{f:u3},7:{f:NA},8:{},9:{f:Bf},11:{},22:{f:_r},30:{f:XT},31:{},32:{},33:{f:p3},36:{},37:{f:l3},50:{f:FA},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:EA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RA},223:{},234:{},354:{},421:{},518:{f:ig},521:{f:Bf},536:{f:h3},547:{f:d3},561:{},579:{},1030:{f:ig},1033:{f:Bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Li(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&PS(r)&&e.push(r)}}function E3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,u=t7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,m=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<u.length;++s){var y=u[s].trim(),C=y.slice(0,3).toLowerCase();if(C=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(C!="<td"&&C!="<th")){var E=y.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var S=E[o].trim();if(S.match(/<t[dh]/i)){for(var x=S,T=0;x.charAt(0)=="<"&&(T=x.indexOf(">"))>-1;)x=x.slice(T+1);for(var F=0;F<g.length;++F){var N=g[F];N.s.c==d&&N.s.r<f&&f<=N.e.r&&(d=N.e.c+1,F=-1)}var A=tt(S.slice(0,S.indexOf(">")));m=A.colspan?+A.colspan:1,((p=+A.rowspan)>1||m>1)&&g.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+m-1}});var P=A.t||A["data-t"]||"";if(!x.length){d+=m;continue}if(x=gS(x),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!x.length){d+=m;continue}var b={t:"s",v:x};r.raw||!x.trim().length||P=="s"||(x==="TRUE"?b={t:"b",v:!0}:x==="FALSE"?b={t:"b",v:!1}:isNaN(Xi(x))?isNaN(Ql(x).getDate())||(b={t:"d",v:Wr(x)},r.cellDates||(b={t:"n",v:Nn(b.v)}),b.z=r.dateNF||ct[14]):b={t:"n",v:Xi(x)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=b):n[st({r:f,c:d})]=b,d+=m}}}}return n["!ref"]=kt(v),g.length&&(n["!merges"]=g),n}function Fb(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){o=-1;break}o=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var d=st({r,c:s}),p=n.dense?(e[r]||[])[s]:e[d],m=p&&p.v!=null&&(p.h||$2(p.w||($a(p),p.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(m7("td",m,v))}}var g="<tr>";return g+a.join("")+"</tr>"}var Rb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bb="</body></html>";function Ib(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vs(E3(r[0],t),t);var n=ux();return r.forEach(function(i,a){fx(n,E3(i,t),"Sheet"+(a+1))}),n}function Db(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ob(e,t){var r=t||{},n=r.header!=null?r.header:Rb,i=r.footer!=null?r.footer:bb,a=[n],s=oc(e["!ref"]);r.dense=Array.isArray(e),a.push(Db(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(Fb(e,s,o,r));return a.push("</table>"+i),a.join("")}function _8(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Tn(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=oc(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var p=[],m=0,v=e["!rows"]||(e["!rows"]=[]),g=0,y=0,C=0,E=0,S=0,x=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&y<u;++g){var T=o[g];if(T3(T)){if(n.display)continue;v[y]={hidden:!0}}var F=T.children;for(C=E=0;C<F.length;++C){var N=F[C];if(!(n.display&&T3(N))){var A=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):gS(N.innerHTML),P=N.getAttribute("data-z")||N.getAttribute("z");for(m=0;m<p.length;++m){var b=p[m];b.s.c==E+a&&b.s.r<y+i&&y+i<=b.e.r&&(E=b.e.c+1-a,m=-1)}x=+N.getAttribute("colspan")||1,((S=+N.getAttribute("rowspan")||1)>1||x>1)&&p.push({s:{r:y+i,c:E+a},e:{r:y+i+(S||1)-1,c:E+a+(x||1)-1}});var I={t:"s",v:A},O=N.getAttribute("data-t")||N.getAttribute("t")||"";A!=null&&(A.length==0?I.t=O||"z":n.raw||A.trim().length==0||O=="s"||(A==="TRUE"?I={t:"b",v:!0}:A==="FALSE"?I={t:"b",v:!1}:isNaN(Xi(A))?isNaN(Ql(A).getDate())||(I={t:"d",v:Wr(A)},n.cellDates||(I={t:"n",v:Nn(I.v)}),I.z=n.dateNF||ct[14]):I={t:"n",v:Xi(A)})),I.z===void 0&&P!=null&&(I.z=P);var j="",q=N.getElementsByTagName("A");if(q&&q.length)for(var ie=0;ie<q.length&&!(q[ie].hasAttribute("href")&&(j=q[ie].getAttribute("href"),j.charAt(0)!="#"));++ie);j&&j.charAt(0)!="#"&&(I.l={Target:j}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][E+a]=I):e[st({c:E+a,r:y+i})]=I,f.e.c<E+a&&(f.e.c=E+a),E+=x}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+i),e["!ref"]=kt(f),y>=u&&(e["!fullref"]=kt((f.e.r=o.length-g+y-1+i,f))),e}function S8(e,t){var r=t||{},n=r.dense?[]:{};return _8(n,e,t)}function Lb(e,t){return Vs(S8(e,t),t)}function T3(e){var t="",r=Mb(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Mb(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Bb(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Et(t.replace(/<[^>]*>/g,""));return[r]}var A3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function w8(e,t){var r=t||{},n=X2(e),i=[],a,s,o={name:""},u="",f=0,d,p,m={},v=[],g=r.dense?[]:{},y,C,E={value:""},S="",x=0,T=[],F=-1,N=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,b={},I=[],O={},j=0,q=0,ie=[],te=1,Ae=1,Ee=[],re={Names:[]},X={},he=["",""],Te=[],L={},Q="",Y=0,K=!1,ue=!1,V=0;for(q0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=q0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?g["!ref"]=kt(A):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(g["!fullref"]=g["!ref"],A.e.r=r.sheetRows-1,g["!ref"]=kt(A)),I.length&&(g["!merges"]=I),ie.length&&(g["!rows"]=ie),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),m[d.name]=g,ue=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=tt(y[0],!1),F=N=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,g=r.dense?[]:{},I=[],ie=[],ue=!0);break;case"table-row-group":y[1]==="/"?--P:++P;break;case"table-row":case"":if(y[1]==="/"){F+=te,te=1;break}if(p=tt(y[0],!1),p.?F=p.-1:F==-1&&(F=0),te=+p["number-rows-repeated"]||1,te<10)for(V=0;V<te;++V)P>0&&(ie[F+V]={level:P});N=-1;break;case"covered-table-cell":y[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(g[F]||(g[F]=[]),g[F][N]={t:"z"}):g[st({r:F,c:N})]={t:"z"}),S="",T=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++N,E=tt(y[0],!1),Ae=parseInt(E["number-columns-repeated"]||"1",10),C={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(C.f=S3(Et(E.formula))),(E.||E["value-type"])=="string"&&(C.t="s",C.v=Et(E["string-value"]||""),r.dense?(g[F]||(g[F]=[]),g[F][N]=C):g[st({r:F,c:N})]=C),N+=Ae-1;else if(y[1]!=="/"){++N,S="",x=0,T=[],Ae=1;var Z=te?F+te-1:F;if(N>A.e.c&&(A.e.c=N),N<A.s.c&&(A.s.c=N),F<A.s.r&&(A.s.r=F),Z>A.e.r&&(A.e.r=Z),E=tt(y[0],!1),Te=[],L={},C={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=Et(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(j=parseInt(E["number-matrix-rows-spanned"],10)||0,q=parseInt(E["number-matrix-columns-spanned"],10)||0,O={s:{r:F,c:N},e:{r:F+j-1,c:N+q-1}},C.F=kt(O),Ee.push([O,C.F])),E.formula)C.f=S3(E.formula);else for(V=0;V<Ee.length;++V)F>=Ee[V][0].s.r&&F<=Ee[V][0].e.r&&N>=Ee[V][0].s.c&&N<=Ee[V][0].e.c&&(C.F=Ee[V][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(j=parseInt(E["number-rows-spanned"],10)||0,q=parseInt(E["number-columns-spanned"],10)||0,O={s:{r:F,c:N},e:{r:F+j-1,c:N+q-1}},I.push(O)),E["number-columns-repeated"]&&(Ae=parseInt(E["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Qt(E["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(E.value);break;case"percentage":C.t="n",C.v=parseFloat(E.value);break;case"currency":C.t="n",C.v=parseFloat(E.value);break;case"date":C.t="d",C.v=Wr(E["date-value"]),r.cellDates||(C.t="n",C.v=Nn(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=JE(E["time-value"])/86400,r.cellDates&&(C.t="d",C.v=vh(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(E.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",E["string-value"]!=null&&(S=Et(E["string-value"]),T=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(K=!1,C.t==="s"&&(C.v=S||"",T.length&&(C.R=T),K=x==0),X.Target&&(C.l=X),Te.length>0&&(C.c=Te,Te=[]),S&&r.cellText!==!1&&(C.w=S),K&&(C.t="z",delete C.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var fe=0;fe<te;++fe){if(Ae=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(g[F+fe]||(g[F+fe]=[]),g[F+fe][N]=fe==0?C:qr(C);--Ae>0;)g[F+fe][N+Ae]=qr(C);else for(g[st({r:F+fe,c:N})]=C;--Ae>0;)g[st({r:F+fe,c:N+Ae})]=qr(C);A.e.c<=N&&(A.e.c=N)}Ae=parseInt(E["number-columns-repeated"]||"1",10),N+=Ae-1,Ae=0,C={},S="",T=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a;L.t=S,T.length&&(L.R=T),L.a=Q,Te.push(L)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);Q="",Y=0,S="",x=0,T=[];break;case"creator":y[1]==="/"?Q=n.slice(Y,y.index):Y=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);S="",x=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(b[o.name]=u,(a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(u="",o=tt(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(y[0],!1),u+=A3[y[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(y[0],!1),u+=A3[y[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":s=tt(y[0],!1),he=ag(s["cell-range-address"]);var ve={Name:s.name,Ref:he[0]+"!"+he[1]};ue&&(ve.Sheet=v.length),re.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!E||!E["string-value"])){var Be=Bb(n.slice(x,y.index));S=(S.length>0?S+`
`:"")+Be[0]}else tt(y[0],!1),x=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{he=ag(tt(y[0])["target-range-address"]),m[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=tt(y[0],!1),!X.href)break;X.Target=Et(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(he=ag(X.Target.slice(1)),X.Target="#"+he[0]+"!"+he[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:m,SheetNames:v,Workbook:re};return r.bookSheets&&delete G.Sheets,G}function P3(e,t){t=t||{},xi(e,"META-INF/manifest.xml")&&eT(yr(e,"META-INF/manifest.xml"),t);var r=qn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=w8(Ht(r),t);return xi(e,"meta.xml")&&(n.Props=OS(yr(e,"meta.xml"))),n}function N3(e,t){return w8(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function sx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ht(Do(e))}function Nm(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function F3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jb(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function tu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function br(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function pn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=tu(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=tu(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function ox(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ub(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=tu(e,n),a=pn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:br(a[1][0].data),messages:[]};a[2].forEach(function(o){var u=pn(o.data),f=br(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(s.merge=br(a[3][0].data)>>>0>0),r.push(s)}return r}function zb(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=tu(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Nm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Nm(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Vb(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(zb(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Nm(t)}function Gb(e,t,r,n){var i=sx(e),a=i.getUint32(4,!0),s=(n>1?12:8)+F3(a&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=F3(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(s,!0),s+=4),a&32&&(f=i.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Hb(e,t,r){var n=sx(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=jb(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function Wb(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Gb(e,t,r,e[0]);case 5:return Hb(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bs(e){var t=pn(e);return tu(t[1][0].data)}function R3(e,t){var r=pn(t.data),n=br(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=pn(s.data),u=br(o[1][0].data)>>>0;switch(n){case 1:a[u]=Pm(o[3][0].data);break;case 8:{var f=e[bs(o[9][0].data)][0],d=pn(f.data),p=e[bs(d[1][0].data)][0],m=br(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var v=pn(p.data);a[u]=v[3].map(function(g){return Pm(g.data)}).join("")}break}}),a}function $b(e,t){var r,n,i,a,s,o,u,f,d,p,m,v,g,y,C=pn(e),E=br(C[1][0].data)>>>0,S=br(C[2][0].data)>>>0,x=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&br(C[8][0].data)>0||!1,T,F;if((a=(i=C[7])==null?void 0:i[0])!=null&&a.data&&t!=0)T=(o=(s=C[7])==null?void 0:s[0])==null?void 0:o.data,F=(f=(u=C[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=C[4])==null?void 0:d[0])!=null&&p.data&&t!=1)T=(v=(m=C[4])==null?void 0:m[0])==null?void 0:v.data,F=(y=(g=C[3])==null?void 0:g[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=x?4:1,A=sx(T),P=[],b=0;b<T.length/2;++b){var I=A.getUint16(b*2,!0);I<65535&&P.push([b,I])}if(P.length!=S)throw"Expected ".concat(S," cells, found ").concat(P.length);var O=[];for(b=0;b<P.length-1;++b)O[P[b][0]]=F.subarray(P[b][1]*N,P[b+1][1]*N);return P.length>=1&&(O[P[P.length-1][0]]=F.subarray(P[P.length-1][1]*N)),{R:E,cells:O}}function Xb(e,t){var r,n=pn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?br(n[7][0].data)>>>0>0?1:0:-1,a=ox(n[5],function(s){return $b(s,i)});return{nrows:br(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(u,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=u}),s},[])}}function Kb(e,t,r){var n,i=pn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(br(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(br(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=kt(a);var s=pn(i[4][0].data),o=R3(e,e[bs(s[4][0].data)][0]),u=(n=s[17])!=null&&n[0]?R3(e,e[bs(s[17][0].data)][0]):[],f=pn(s[3][0].data),d=0;f[1].forEach(function(p){var m=pn(p.data),v=e[bs(m[2][0].data)][0],g=br(v.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var y=Xb(e,v);y.data.forEach(function(C,E){C.forEach(function(S,x){var T=st({r:d+E,c:x}),F=Wb(S,o,u);F&&(r[T]=F)})}),d+=y.nrows})}function Yb(e,t){var r=pn(t.data),n={"!ref":"A1"},i=e[bs(r[2][0].data)],a=br(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Kb(e,i[0],n),n}function Qb(e,t){var r,n=pn(t.data),i={name:(r=n[1])!=null&&r[0]?Pm(n[1][0].data):"",sheets:[]},a=ox(n[2],bs);return a.forEach(function(s){e[s].forEach(function(o){var u=br(o.meta[1][0].data);u==6e3&&i.sheets.push(Yb(e,o))})}),i}function qb(e,t){var r=ux(),n=pn(t.data),i=ox(n[1],bs);if(i.forEach(function(a){e[a].forEach(function(s){var o=br(s.meta[1][0].data);if(o==2){var u=Qb(e,s);u.sheets.forEach(function(f,d){fx(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function og(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=Vb(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=Ub(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){a[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&br(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(u){a[u].forEach(function(f){var d=br(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return qb(a,o)}function Jb(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function lx(e){Jb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Zb(e){return Nl.WS.indexOf(e)>-1?"sheet":e==Nl.CS?"chart":e==Nl.DS?"dialog":e==Nl.MS?"macro":e&&e.length?e:"sheet"}function eI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Zb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tI(e,t,r,n,i,a,s,o,u,f,d,p){try{a[n]=w0(qn(e,r,!0),t);var m=yr(e,t),v;switch(o){case"sheet":v=ob(m,t,i,u,a[n],f,d,p);break;case"chart":if(v=lb(m,t,i,u,a[n],f,d,p),!v||!v["!drawel"])break;var g=s0(v["!drawel"].Target,t),y=km(g),C=sN(qn(e,g,!0),w0(qn(e,y,!0),g)),E=s0(C,g),S=km(E);v=HR(qn(e,E,!0),E,u,w0(qn(e,S,!0),E),f,v);break;case"macro":v=cb(m,t,i,u,a[n],f,d,p);break;case"dialog":v=ub(m,t,i,u,a[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var x=[];a&&a[n]&&ma(a[n]).forEach(function(T){var F="";if(a[n][T].Type==Nl.CMNT){F=s0(a[n][T].Target,t);var N=pb(yr(e,F,!0),F,u);if(!N||!N.length)return;m3(v,N,!1)}a[n][T].Type==Nl.TCMNT&&(F=s0(a[n][T].Target,t),x=x.concat(lN(yr(e,F,!0),u)))}),x&&x.length&&m3(v,x,!0,u.people||[])}catch(T){if(u.WTF)throw T}}function pi(e){return e.charAt(0)=="/"?e.slice(1):e}function rI(e,t){if(aS(),t=t||{},lx(t),xi(e,"META-INF/manifest.xml")||xi(e,"objectdata.xml"))return P3(e,t);if(xi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof og<"u"){if(e.FileIndex)return og(e);var r=wt.utils.cfb_new();return G4(e).forEach(function(ie){n7(r,ie,fS(e,ie))}),og(r)}throw new Error("Unsupported NUMBERS file")}if(!xi(e,"[Content_Types].xml"))throw xi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=G4(e),i=J7(qn(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",yr(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!yr(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(E0=[],i.sst)try{E0=hb(yr(e,pi(i.sst)),i.sst,t)}catch(ie){if(t.WTF)throw ie}t.cellStyles&&i.themes.length&&(u=db(qn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=fb(yr(e,pi(i.style)),i.style,u,t))}i.links.map(function(ie){try{var te=w0(qn(e,km(pi(ie))),ie);return mb(yr(e,pi(ie)),te,ie,t)}catch{}});var d=sb(yr(e,pi(i.workbooks[0])),i.workbooks[0],t),p={},m="";i.coreprops.length&&(m=yr(e,pi(i.coreprops[0]),!0),m&&(p=OS(m)),i.extprops.length!==0&&(m=yr(e,pi(i.extprops[0]),!0),m&&nT(m,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(m=qn(e,pi(i.custprops[0]),!0),m&&(v=aT(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(te){return te.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(g.Props=p,g.Custprops=v),t.bookSheets&&typeof s<"u"&&(g.SheetNames=s),t.bookSheets?g.SheetNames:t.bookProps))return g;s={};var y={};t.bookDeps&&i.calcchain&&(y=gb(yr(e,pi(i.calcchain)),i.calcchain));var C=0,E={},S,x;{var T=d.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var F=0;F!=T.length;++F)p.SheetNames[F]=T[F].name}var N=a?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");xi(e,P)||(P="xl/_rels/workbook."+N+".rels");var b=w0(qn(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=xb(yr(e,pi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=cN(yr(e,pi(i.people[0])),t)),b&&(b=eI(b,d.Sheets));var I=yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=p.Worksheets;++C){var O="sheet";if(b&&b[C]?(S="xl/"+b[C][1].replace(/[\/]?xl\//,""),xi(e,S)||(S=b[C][1]),xi(e,S)||(S=P.replace(/_rels\/.*$/,"")+b[C][1]),O=b[C][2]):(S="xl/worksheets/sheet"+(C+1-I)+"."+N,S=S.replace(/sheet0\./,"sheet.")),x=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(p.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==C&&(j=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==p.SheetNames[C].toLowerCase()&&(j=1);if(!j)continue e}}tI(e,S,x,p.SheetNames[C],C,E,s,O,t,d,u,f)}return g={Directory:i,Workbook:d,Props:p,Custprops:v,Deps:y,Sheets:s,SheetNames:p.SheetNames,Strings:E0,Styles:f,Themes:u,SSF:qr(ct)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ie,te){ie=ie.replace(/^Root Entry[\/]/,""),g.keys.push(ie),g.files[ie]=e.FileIndex[te]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=yr(e,pi(i.vba[0]),!0):i.defaults&&i.defaults.bin===hN&&(g.vbaraw=yr(e,"xl/vbaProject.bin",!0))),g}function nI(e,t){var r=t||{},n="Workbook",i=wt.find(e,n);try{if(n="/!DataSpaces/Version",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(YA(i.content),n="/!DataSpaces/DataSpaceMap",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=qA(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=JA(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);eP(i.content)}catch{}if(n="/EncryptionInfo",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tP(i.content);if(n="/EncryptedPackage",i=wt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ri(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iI(e,t){return wt.find(e,"EncryptedPackage")?nI(e,t):y8(e,t)}function aI(e,t){var r,n=e,i=t||{};return i.type||(i.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),r=dS(n,i),rI(r,i)}function k8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Tm(e.slice(r),t);default:break e}return J0.to_workbook(e,t)}function sI(e,t){var r="",n=cx(e,t);switch(t.type){case"base64":r=ri(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=No(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ht(r)),t.type="binary",k8(r,t)}function oI(e,t){var r=e;return t.type=="base64"&&(r=ri(r)),r=vs.utils.decode(1200,r.slice(2),"str"),t.type="binary",k8(r,t)}function lI(e){return e.match(/[^\x00-\x7F]/)?o0(e):e}function lg(e,t,r,n){return n?(r.type="string",J0.to_workbook(e,r)):J0.to_workbook(t,r)}function Fm(e,t){X6();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fm(new Uint8Array(e),(r=qr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bl={},r.dateNF&&(Bl.dateNF=r.dateNF),r.type||(r.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=yt?"buffer":"binary",n=QE(e),typeof Uint8Array<"u"&&!yt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=lI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=qr(r),r.type="array",Fm(z2(n),r)}switch((i=cx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return iI(wt.read(n,r),r);break;case 9:if(i[1]<=8)return y8(n,r);break;case 60:return Tm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return LA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?aI(n,r):lg(e,n,r,a);case 239:return i[3]===60?Tm(n,r):lg(e,n,r,a);case 255:if(i[1]===254)return oI(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return C0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return C0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return g3.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return hP.to_workbook(n,r);break;case 10:case 13:case 32:return sI(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?g3.to_workbook(n,r):lg(e,n,r,a)}function cI(e,t,r,n,i,a,s,o){var u=Jr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var g=s?e[r][v]:e[n[v]+u];if(g===void 0||g.t===void 0){if(f===void 0)continue;a[v]!=null&&(m[a[v]]=f);continue}var y=g.v;switch(g.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[v]!=null){if(y==null)if(g.t=="e"&&y===null)m[a[v]]=null;else if(f!==void 0)m[a[v]]=f;else if(d&&y===null)m[a[v]]=null;else continue;else m[a[v]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?y:$a(g,y,o);y!=null&&(p=!1)}}return{row:m,isempty:p}}function Rm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=cr(d);break;case"number":u=cr(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var p=Jr(u.s.r),m=[],v=[],g=0,y=0,C=Array.isArray(e),E=u.s.r,S=0,x={};C&&!e[E]&&(e[E]=[]);var T=f.skipHidden&&e["!cols"]||[],F=f.skipHidden&&e["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(T[S]||{}).hidden)switch(m[S]=Rr(S),r=C?e[E][S]:e[m[S]+p],n){case 1:a[S]=S-u.s.c;break;case 2:a[S]=m[S];break;case 3:a[S]=f.header[S-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=$a(r,null,f),y=x[s]||0,!y)x[s]=1;else{do o=s+"_"+y++;while(x[o]);x[s]=y,x[o]=1}a[S]=o}for(E=u.s.r+i;E<=u.e.r;++E)if(!(F[E]||{}).hidden){var N=cI(e,u,E,m,n,a,C,f);(N.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[g++]=N.row)}return v.length=g,v}var b3=/"/g;function uI(e,t,r,n,i,a,s,o){for(var u=!0,f=[],d="",p=Jr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=o.dense?(e[r]||[])[m]:e[n[m]+p];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:$a(v,null,o));for(var g=0,y=0;g!==d.length;++g)if((y=d.charCodeAt(g))===i||y===a||y===34||o.forceQuotes){d='"'+d.replace(b3,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(b3,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(s)}function C8(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=cr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(p[g]=Rr(g));for(var y=0,C=i.s.r;C<=i.e.r;++C)(v[C]||{}).hidden||(d=uI(e,i,C,p,s,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((y++?o:"")+d)));return delete n.dense,r.join("")}function fI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=C8(e,t);return r}function dI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=cr(e["!ref"]),a="",s=[],o,u=[],f=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Rr(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=Jr(d),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function E8(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Tn(n.origin):n.origin;s=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var p=cr(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),s==-1&&(s=p.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var m=n.header||[],v=0;t.forEach(function(y,C){ma(y).forEach(function(E){(v=m.indexOf(E))==-1&&(m[v=m.length]=E);var S=y[E],x="z",T="",F=st({c:o+v,r:s+C+i});f=ru(a,F),S&&typeof S=="object"&&!(S instanceof Date)?a[F]=S:(typeof S=="number"?x="n":typeof S=="boolean"?x="b":typeof S=="string"?x="s":S instanceof Date?(x="d",n.cellDates||(x="n",S=Nn(S)),T=n.dateNF||ct[14]):S===null&&n.nullError&&(x="e",S=0),f?(f.t=x,f.v=S,delete f.w,delete f.R,T&&(f.z=T)):a[F]=f={t:x,v:S},T&&(f.z=T))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var g=Jr(s);if(i)for(v=0;v<m.length;++v)a[Rr(v+o)+g]={t:"s",v:m[v]};return a["!ref"]=kt(d),a}function hI(e,t){return E8(null,e,t)}function ru(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ru(e,st(t)):ru(e,st({r:t,c:r||0}))}function pI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ux(){return{SheetNames:[],Sheets:{}}}function fx(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(JR(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function gI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=pI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function mI(e,t){return e.z=t,e}function T8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function xI(e,t,r){return T8(e,"#"+t,r)}function vI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yI(e,t,r,n){for(var i=typeof t!="string"?t:cr(t),a=typeof t=="string"?t:kt(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var u=ru(e,s,o);u.t="n",u.F=a,delete u.v,s==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var cg={encode_col:Rr,encode_row:Jr,encode_cell:st,encode_range:kt,decode_col:Q2,decode_row:Y2,split_cell:R7,decode_cell:Tn,decode_range:oc,format_cell:$a,sheet_add_aoa:FS,sheet_add_json:E8,sheet_add_dom:_8,aoa_to_sheet:lc,json_to_sheet:hI,table_to_sheet:S8,table_to_book:Lb,sheet_to_csv:C8,sheet_to_txt:fI,sheet_to_json:Rm,sheet_to_html:Ob,sheet_to_formulae:dI,sheet_to_row_object_array:Rm,sheet_get_cell:ru,book_new:ux,book_append_sheet:fx,book_set_sheet_visibility:gI,cell_set_number_format:mI,cell_set_hyperlink:T8,cell_set_internal_link:xI,cell_add_comment:vI,sheet_set_array_formula:yI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const dx=class bm{static async parseCSVFile(t){var r;try{const n=(r=t.name.split(".").pop())==null?void 0:r.toLowerCase();let i;return n==="xlsx"||n==="xls"?i=await this.readXLSXFileContent(t):i=await this.readFileContent(t),this.parseCSVContent(i)}catch(n){return{success:!1,pins:[],warnings:[],errors:[n.message],format:this.getDefaultFormat()}}}static async parseCSVContent(t){console.log(" Starting ultra-fast CSV parsing...");const r=this.tryVersalPatternMatching(t);if(r!==null)return await r;console.log(" About to try Intel/Altera pattern matching...");const n=this.tryIntelAlteraPatternMatching(t);return n!==null?(console.log(" Intel/Altera pattern detected, processing..."),await n):(console.log(" Versal and Intel/Altera patterns not found, using generic approach..."),this.parseCSVContentGeneric(t))}static async parseCSVContentGeneric(t){console.log(" Fallback to generic CSV processing...");const r=t.split(`
`).map(v=>v.trim()).filter(Boolean);console.log(` Processing ${r.length} lines with generic approach`);let n=-1,i=-1;for(let v=0;v<Math.min(1e3,r.length);v++){const g=r[v];if(!g||!g.includes(","))continue;const y=g.toLowerCase();if(y.includes("copyright")||y.includes("license")||y.includes("xilinx")||g.startsWith("#"))continue;const C=this.parseCSVLine(g);if(C.length>=3&&C.some(S=>{const x=S.toLowerCase().trim();return x==="pin"||x==="ball"||x.includes("pin")})){n=v,i=v+1;break}}if(n===-1)return{success:!1,pins:[],warnings:[],errors:["Pin column not found or empty"],format:this.getDefaultFormat()};const a=r[n];console.log(` Found header at line ${n+1}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,m=0;for(let v=i;v<r.length;v++){const g=r[v];if(!g||g.replace(/,/g,"").trim()==="")continue;const y=this.parseCSVLine(g);try{const C=this.parsePin(y,o,v+1);C&&(u.push(C),m++)}catch(C){d.length<20&&d.push(`Line ${v+1}: ${C.message}`)}p++,p%1e3===0&&console.log(` Generic processing: ${p} lines, ${m} pins`)}return console.log(` Generic processing complete: ${m} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static tryVersalPatternMatching(t){console.log(" Trying ultra-fast Versal pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(7e3,r.length);a++){const s=r[a];if(a%1e3===0&&console.log(` Pattern matching line ${a+1}...`),s&&s.toLowerCase().startsWith("pin,pin name,")){n=a,i=a+1,console.log(` Found Versal header at line ${a+1}: ${s.substring(0,100)}`);break}if(s&&s.toLowerCase().startsWith("pin,")&&s.toLowerCase().includes("pin name")&&s.split(",").length>=3){n=a,i=a+1,console.log(` Found Versal header variant at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Versal pattern not found"),null):this.parseCSVWithKnownHeader(r,n,i)}static tryIntelAlteraPatternMatching(t){console.log(" Trying Intel/Altera pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(20,r.length);a++){const s=r[a];if(s&&s.toLowerCase().includes("pin name/function")){n=a,i=a+1,console.log(` Found Intel/Altera header at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Intel/Altera pattern not found"),null):this.parseIntelAlteraCSV(r,n,i)}static async parseIntelAlteraCSV(t,r,n){var f,d,p,m,v,g,y,C,E;console.log(" Processing Intel/Altera CSV format...");const i=[],a=[],s=[];let o=0,u=0;for(let S=n;S<t.length;S++){const x=t[S];if(!x||x.replace(/,/g,"").trim()==="")continue;const T=this.parseCSVLine(x);if(T.length>=6){const F=(f=T[0])==null?void 0:f.trim(),N=(d=T[1])==null?void 0:d.trim(),A=(p=T[6])==null?void 0:p.trim(),P=(m=T[7])==null?void 0:m.trim();if(!F||!A||!P)continue;try{const b={row:A,col:parseInt(P,10)||1},I=this.gridToPosition(b),O={id:crypto.randomUUID(),pinNumber:F,pinName:N||F,signalName:((v=T[2])==null?void 0:v.trim())||"",direction:this.parseDirection(T[3]),pinType:this.determinePinType(N||F),voltage:((g=T[4])==null?void 0:g.trim())||"3.3V",packagePin:((y=T[5])==null?void 0:y.trim())||F,position:I,gridPosition:b,isAssigned:!!((C=T[2])!=null&&C.trim()),bank:((E=T[8])==null?void 0:E.trim())||"NA"};i.push(O),o++}catch(b){s.length<20&&s.push(`Line ${S+1}: ${b.message}`)}}u++,u%1e3===0&&console.log(` Intel/Altera processing: ${u} lines, ${o} pins`)}return console.log(` Intel/Altera processing complete: ${o} pins found from ${u} lines`),{success:i.length>0,pins:i,warnings:a,errors:s,format:{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:["Pin","Pin Name","Signal","Direction","Voltage","Package_Pin","Row","Col","Bank","Type"]}}}static async parseCSVWithKnownHeader(t,r,n){console.log(" Fast processing with known header...");const i=t.slice(n).filter(g=>!g||g.trim()===""?!1:g.replace(/,/g,"").trim()!=="");console.log(` Found ${i.length} data lines after header`);const a=t[r];console.log(` Using header line ${r}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,m=0;const v=1e3;for(let g=0;g<i.length;g++){const y=i[g];if(!y||y.replace(/,/g,"").trim()==="")continue;const C=this.parseCSVLine(y);try{const E=this.parsePin(C,o,g+n+1);E&&(u.push(E),m++)}catch(E){d.length<20&&d.push(`Line ${g+n+1}: ${E.message}`)}p++,p%v===0&&console.log(` Processed ${p}/${i.length} lines, found ${m} pins`)}return console.log(` Ultra-fast processing complete: ${m} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static async readFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;return r((s=a.target)==null?void 0:s.result)},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static async readXLSXFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=Fm(o,{type:"binary"});console.log(" XLSX Workbook info:",{sheetNames:u.SheetNames,totalSheets:u.SheetNames.length});const f=u.SheetNames[0],d=u.Sheets[f],p=cg.decode_range(d["!ref"]||"A1");console.log(" Sheet range:",{sheetName:f,range:d["!ref"],rows:p.e.r-p.s.r+1,cols:p.e.c-p.s.c+1});const m=cg.sheet_to_json(d,{header:1,raw:!1});console.log(" Raw data sample (first 15 rows):",m.slice(0,15)),console.log(" Total data rows:",m.length);const v=m.filter(y=>y&&Array.isArray(y)&&y.some(C=>C&&C.toString().trim()));console.log(" Non-empty rows:",v.length);const g=bm.detectIntelAlteraFormat(m);if(console.log(" Format detection result:",g?"Intel/Altera":"Standard CSV"),g){console.log(" Intel/Altera format detected, using special processing");const y=bm.processIntelAlteraXLSX(m);r(y)}else{const y=cg.sheet_to_csv(d,{strip:!1}),C=y.split(`
`).filter(E=>E.trim());console.log(" CSV conversion result:",{originalRows:p.e.r-p.s.r+1,csvLines:C.length,firstTenLines:C.slice(0,10),linesWithCommas:C.filter(E=>E.includes(",")).length}),r(y)}}catch(o){console.error(" XLSX parsing error:",o),n(new Error(`Failed to parse XLSX file: ${o.message}`))}},i.onerror=()=>n(new Error("Failed to read XLSX file")),i.readAsBinaryString(t)})}static detectFormat(t){const r=this.parseCSVLine(t).map(a=>a.trim());return this.XILINX_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=4?{type:"xilinx",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.XILINX_HEADERS}:this.GENERIC_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=3?{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}:{type:"generic",hasHeader:!1,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static getColumnMapping(t,r){const n=this.parseCSVLine(r).map(s=>s.trim().toLowerCase());console.log(" Detected headers:",n);const i=s=>{for(const o of s){const u=n.findIndex(f=>f.includes(o.toLowerCase()));if(u!==-1)return console.log(` Found column "${o}" at index ${u}: "${n[u]}"`),u}return-1},a={pin:i(["pin","pin_number","pin number","package pin","package_pin","ball","ball_id"]),pinName:i(["pin name","pin_name","name","ball name","ball_name"]),signalName:i(["signal","signal_name","net","net name","signal name"]),direction:i(["direction","dir","type","i/o type","io_type"]),voltage:i(["voltage","volt","io_standard","io standard","vccio"]),bank:i(["bank","bank_number","bank number","io bank"]),memoryByteGroup:i(["memory byte group","byte_group","mbg","memory_byte_group"]),ioType:i(["i/o type","io_type","type","function","io_standard"])};return console.log(" Column mapping result:",a),a}static parsePin(t,r,n){var f,d,p,m,v,g,y;if(t.length===0||r.pin===-1||!t[r.pin])return null;const i=(f=t[r.pin])==null?void 0:f.trim();if(!i||i==="NA"||i===""||i.length>10||i.toLowerCase().includes("device")||!/^[A-Za-z0-9]+$/.test(i))return null;const a=((d=t[r.pinName])==null?void 0:d.trim())||i,s=this.parseGridPosition(i);if(!s)return null;const o=this.gridToPosition(s),u={id:crypto.randomUUID(),pinNumber:i,pinName:a,signalName:((p=t[r.signalName||-1])==null?void 0:p.trim())||"",direction:this.parseDirection(t[r.direction||-1]),pinType:this.determinePinType(a),voltage:((m=t[r.voltage||-1])==null?void 0:m.trim())||"3.3V",packagePin:i,position:o,gridPosition:s,isAssigned:!1,bank:(v=t[r.bank||-1])==null?void 0:v.trim(),memoryByteGroup:(g=t[r.memoryByteGroup||-1])==null?void 0:g.trim(),ioType:(y=t[r.ioType||-1])==null?void 0:y.trim()};return u.signalName&&(u.isAssigned=!0),u}static parseGridPosition(t){const r=t.match(/^([A-Z]+)(\d+)$/);return r?{row:r[1],col:parseInt(r[2],10)}:null}static gridToPosition(t){const r=Os(t.row),n=88;return{x:Math.round((t.col-1)*n),y:Math.round(r*n)}}static parseDirection(t){if(!t)return"InOut";const r=t.toLowerCase().trim();return r.includes("input")||r.includes("in")?"Input":r.includes("output")||r.includes("out")?"Output":r.includes("inout")||r.includes("bidirectional")?"InOut":r.includes("power")||r.includes("vcc")?"Power":r.includes("ground")||r.includes("gnd")?"Ground":r.includes("clock")||r.includes("clk")?"Clock":r.includes("reset")||r.includes("rst")?"Reset":"InOut"}static determinePinType(t){const r=t.toLowerCase();return r.includes("io_l")||r.includes("io_")||r.startsWith("io")?"IO":r.includes("config")||r.includes("tck")||r.includes("tdi")||r.includes("tdo")||r.includes("tms")||r.includes("done")?"CONFIG":r.includes("vcc")||r.includes("vdd")?"POWER":r.includes("gnd")||r.includes("vss")?"GROUND":r.includes("mgt")||r.includes("gt")?"MGT":r.includes("clk")||r.includes("clock")?"CLOCK":r.includes("adc")||r.includes("dac")?"ADC":r.includes("vref")||r.includes("special")?"SPECIAL":r.includes("nc")||r===""?"NC":r.includes("rsvd")||r.includes("reserved")?"RESERVED":"IO"}static parseCSVLine(t){const r=[];let n="",i=!1;for(let a=0;a<t.length;a++){const s=t[a];s==='"'?i=!i:s===","&&!i?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r}static getDefaultFormat(){return{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static createPackageFromPins(t,r="Unknown"){if(t.length===0)return{id:crypto.randomUUID(),name:r,device:"Unknown",packageType:"Unknown",dimensions:{rows:0,cols:0},pins:[],totalPins:0};const n=Math.max(...t.map(a=>Os(a.gridPosition.row)))+1,i=Math.max(...t.map(a=>a.gridPosition.col));return{id:crypto.randomUUID(),name:r,device:r.split("-")[0]||"Unknown",packageType:r.split("-")[1]||"Unknown",dimensions:{rows:n,cols:i},pins:t,totalPins:t.length}}static detectIntelAlteraFormat(t){console.log(" Detecting Intel/Altera format...");for(let r=0;r<Math.min(10,t.length);r++){const n=t[r];if(n&&Array.isArray(n)&&n.length>=4){const i=n.join(",").toLowerCase();if(console.log(`Row ${r}: "${i.substring(0,100)}..."`),i.includes("pin name/function")&&(i.includes("bank number")||i.includes("bank"))&&(i.includes("vref")||i.includes("configuration function")))return console.log(" Intel/Altera format detected!"),!0}}return console.log(" Intel/Altera format not detected"),!1}static processIntelAlteraXLSX(t){console.log(" Processing Intel/Altera XLSX format...");let r=-1,n=-1,i=-1,a=-1;for(let u=0;u<Math.min(10,t.length);u++){const f=t[u];if(f&&Array.isArray(f)&&f.length>=4){const d=f.map(p=>p?p.toString().toLowerCase().trim():"");if(d.some(p=>p.includes("pin name/function"))){r=u;for(let p=0;p<d.length;p++){const m=d[p];p===0&&(m.includes("v")||m.match(/^[a-z]\d+$/)||m.length<=3)?n=p:m.includes("pin name/function")?i=p:(m.includes("bank number")||m.includes("bank"))&&(a=p)}break}}}if(r===-1)return console.warn(" Intel/Altera header not found, fallback to standard processing"),"";console.log(" Intel/Altera format detected:",{headerRowIndex:r,pinNumberCol:n,pinNameCol:i,bankCol:a});const s=[];let o=0;s.push("Pin,Pin Name,Signal,Direction,Voltage,Package_Pin,Row,Col,Bank,Type");for(let u=r+1;u<t.length;u++){const f=t[u];if(!f||!Array.isArray(f)||f.length<4)continue;const d=f[n]?f[n].toString().trim():"",p=f[i]?f[i].toString().trim():"",m=f[a]?f[a].toString().trim():"";if(o<10&&console.log(` Processing pin ${o+1}: Number="${d}", Name="${p}", Bank="${m}"`),!d||d===""||p.toLowerCase().includes("nc")||p.toLowerCase().includes("no connect")){o<10&&console.log(` Skipping NC/empty pin: "${d}" / "${p}"`);continue}if(!d.match(/^[A-Z0-9_]+\d*$/i)){o<10&&console.log(` Skipping invalid pin format: "${d}"`);continue}let v="IO";(p.toLowerCase().includes("power")||p.toLowerCase().includes("vcc")||p.toLowerCase().includes("gnd"))&&(v="POWER");const g=d.match(/^([A-Z])(\d+)$/i),y=g?g[1].toUpperCase():"A",C=g?g[2]:"1",E=[d,p||d,"","","",d,y,C,m||"NA",v].join(",");s.push(E),o++}return console.log(` Intel/Altera processing complete: ${o} pins processed from ${t.length-r-1} data rows`),s.join(`
`)}};dx.XILINX_HEADERS=["Pin","Pin Name","Memory Byte Group","Bank","VCCAUX Group","Super Logic Region","I/O Type","No-Connect"];dx.GENERIC_HEADERS=["Pin","Signal","Direction","Voltage","Package_Pin","Row","Col"];let Gc=dx;class Ra{static exportToXDC(t,r){const n=t.filter(s=>s.isAssigned&&s.signalName.trim()!==""),i=["# Xilinx Design Constraints (XDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),a=n.map(s=>{const o=[];if(o.push(`set_property PACKAGE_PIN ${s.pinNumber} [get_ports ${s.signalName}]`),s.voltage){const u=s.voltage==="3.3V"?"LVCMOS33":s.voltage==="1.8V"?"LVCMOS18":s.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";o.push(`set_property IOSTANDARD ${u} [get_ports ${s.signalName}]`)}return(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property DRIVE 12 [get_ports ${s.signalName}]`),o.join(`
`)}).join(`

`);return i+a}static exportToSDC(t,r){const n=t.filter(o=>o.isAssigned&&o.signalName.trim()!==""),i=o=>o.replace(/[^\w_]/g,"_").replace(/^(\d)/,"sig_$1").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),a=["# Synopsys Design Constraints (SDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),s=n.map(o=>{const u=[],f=i(o.signalName);if(u.push(`set_location_assignment PIN_${o.pinNumber} -to ${f}`),o.voltage){const d=o.voltage==="3.3V"?"LVCMOS33":o.voltage==="1.8V"?"LVCMOS18":o.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";u.push(`set_instance_assignment -name IO_STANDARD "${d}" -to ${f}`)}return(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name CURRENT_STRENGTH_NEW "12mA" -to ${f}`),(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name SLEW_RATE 1 -to ${f}`),u.join(`
`)}).join(`

`);return a+s}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Direction","Pin Type","Voltage","Bank","I/O Type","Is Assigned"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.direction,i.pinType,i.voltage,i.bank||"",i.ioType||"",i.isAssigned?"Yes":"No"]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportReport(t,r){const n=t.filter(o=>o.isAssigned),i=t.filter(o=>!o.isAssigned),a=new Map;return t.forEach(o=>{const u=o.bank||"Unknown";a.has(u)||a.set(u,{assigned:0,total:0});const f=a.get(u);f.total++,o.isAssigned&&f.assigned++}),["# FPGA Pin Assignment Report",`# Generated: ${new Date().toLocaleString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"","## Summary",`- Total Pins: ${t.length}`,`- Assigned Pins: ${n.length}`,`- Unassigned Pins: ${i.length}`,`- Assignment Rate: ${(n.length/t.length*100).toFixed(1)}%`,"","## Bank Statistics",...Array.from(a.entries()).map(([o,u])=>`- Bank ${o}: ${u.assigned}/${u.total} (${(u.assigned/u.total*100).toFixed(1)}%)`),"","## Assigned Pins",...n.map(o=>`${o.pinNumber.padEnd(8)} | ${o.signalName.padEnd(20)} | Bank ${(o.bank||"N/A").padEnd(3)} | ${o.pinType}`),"","## Pin Type Distribution",...Object.entries(t.reduce((o,u)=>(o[u.pinType]=(o[u.pinType]||0)+1,o),{})).map(([o,u])=>`- ${o}: ${u}`)].join(`
`)}static downloadFile(t,r,n="text/plain"){const i=new Blob([t],{type:n}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}class Sr{static getDifferentialPairType(t){const r=t.toLowerCase();if(r.endsWith("_p"))return"positive";if(r.endsWith("_n"))return"negative";if(r.endsWith("+"))return"positive";if(r.endsWith("-"))return"negative";if(r.endsWith("p")&&!r.endsWith("_p")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"positive"}if(r.endsWith("n")&&!r.endsWith("_n")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"negative"}const n=r.match(/^(.+_l\d+)([pn])(_.*)?$/);if(n){const i=n[2];if(i==="p")return"positive";if(i==="n")return"negative"}return null}static getPairPinName(t){const r=t.toLowerCase(),n=t;if(r.endsWith("_p"))return n.slice(0,-2)+"_N";if(r.endsWith("_n"))return n.slice(0,-2)+"_P";if(r.endsWith("+"))return n.slice(0,-1)+"-";if(r.endsWith("-"))return n.slice(0,-1)+"+";if(r.endsWith("p")&&!r.endsWith("_p")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"N"}if(r.endsWith("n")&&!r.endsWith("_n")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"P"}const i=n.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const s=i[1],o=i[2].toUpperCase(),u=i[3]||"";if(o==="P")return s+"N"+u;if(o==="N")return s+"P"+u}const a=r.match(/^(.+?)(\d+)$/);if(a){const s=a[1],o=parseInt(a[2]),u=o%2===0?o+1:o-1;return n.substring(0,s.length)+u}return null}static findPairPin(t,r){const n=this.getPairPinName(t.pinName);if(n){const a=r.find(s=>s.pinName.toLowerCase()===n.toLowerCase()&&s.bank===t.bank);if(a)return a}const i=t.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const a=i[1],o=i[2].toUpperCase()==="P"?"N":"P",u=r.find(f=>{if(f.bank!==t.bank)return!1;const d=f.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(d){const p=d[1],m=d[2].toUpperCase();return p.toLowerCase()===a.toLowerCase()&&m===o}return!1});if(u)return u}if(t.signalName){const a=this.getPairPinName(t.signalName);if(a){const s=r.find(o=>o.signalName&&o.signalName.toLowerCase()===a.toLowerCase()&&o.bank===t.bank);if(s)return s}}return null}static isDifferentialPin(t){return!!(this.getDifferentialPairType(t.pinName)!==null||t.signalName&&this.getDifferentialPairType(t.signalName)!==null)}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);const n=r.match(/^(.+?)(\d+)$/);return n?t.substring(0,n[1].length):t}static getDifferentialPriority(t){const r=this.getDifferentialPairType(t.pinName),n=t.signalName?this.getDifferentialPairType(t.signalName):null,i=r||n;return i==="positive"?1:i==="negative"?2:3}}const _I=({pin:e,isSelected:t,onSelect:r,onAssignSignal:n,isPairPin:i=!1,isDifferentialPairPartner:a=!1})=>{const s=d=>{n(e.id,d.target.value)},o=d=>({IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999"})[d]||"#666666",u=Sr.getDifferentialPairType(e.pinName)||(e.signalName?Sr.getDifferentialPairType(e.signalName):null),f=Sr.isDifferentialPin(e);return w.jsxs("div",{className:`pin-item ${t?"selected":""}`,onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",padding:"8px 12px",margin:"2px 0",backgroundColor:t?"#444":a?"#3d4852":i?"#2d3748":"#2a2a2a",borderRadius:"4px",cursor:"pointer",border:`2px solid ${t?"#4A90E2":a?"#f59e0b":i?"#9333ea":"transparent"}`,position:"relative"},children:[f&&w.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",fontSize:"10px",color:u==="positive"?"#22c55e":"#ef4444",fontWeight:"bold"},title:`Differential ${u==="positive"?"Positive":"Negative"} Pin`,children:u==="positive"?"+":"-"}),a&&w.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"12px",color:"#f59e0b",fontWeight:"bold"},title:"Differential Pair Partner of Selected Pin",children:""}),i&&!a&&w.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"10px",color:"#9333ea",fontWeight:"bold"},title:"Differential Pair Pin",children:""}),w.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[w.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:o(e.pinType),marginRight:"8px",flexShrink:0}}),w.jsx("div",{style:{minWidth:"60px",fontFamily:"monospace",fontSize:"12px",color:"#ccc"},children:e.pinNumber}),w.jsx("div",{style:{minWidth:"120px",fontSize:"11px",color:"#999",marginRight:"8px",flex:1},children:e.pinName}),w.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:e.isAssigned?"#4AE24A":"#666",marginLeft:"8px",flexShrink:0}})]}),w.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:w.jsx("input",{type:"text",value:e.signalName,onChange:s,placeholder:"Signal name",onClick:d=>d.stopPropagation(),style:{flex:1,padding:"4px 8px",fontSize:"12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"}})}),e.bank&&w.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"11px",color:"#666"},children:[w.jsx("span",{style:{marginRight:"4px"},children:""}),w.jsxs("span",{children:["Bank ",e.bank]})]})]})},SI=({isOpen:e,onClose:t})=>{const[r,n]=Se.useState({display:{theme:"dark",pinSize:88,showPinNumbers:!0,showSignalNames:!0,showBankBoundaries:!0,gridOpacity:.4,autoZoomToFit:!1},interaction:{doubleClickToEdit:!0,dragThreshold:8,wheelZoomSensitivity:1.05,panSensitivity:1},export:{includeHeader:!0,defaultFormat:"xdc",ioStandard:"auto",driveStrength:12},advanced:{enableDebugMode:!1,showPerformanceMetrics:!1,cacheEnabled:!0,maxUndoSteps:50}});if(!e)return null;const i=(a,s,o)=>{n(u=>({...u,[a]:{...u[a],[s]:o}}))};return w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:w.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",width:"600px",maxHeight:"80vh",overflow:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},children:[w.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("h2",{style:{margin:0,color:"#fff",fontSize:"18px"},children:"Settings"}),w.jsx("button",{onClick:t,style:{padding:"4px 8px",backgroundColor:"transparent",border:"none",color:"#999",cursor:"pointer",fontSize:"18px"},children:""})]}),w.jsxs("div",{style:{padding:"20px"},children:[w.jsxs("div",{style:{marginBottom:"24px"},children:[w.jsx("h3",{style:{color:"#4A90E2",margin:"0 0 12px 0",fontSize:"16px"},children:"Display"}),w.jsxs("div",{style:{display:"grid",gap:"12px"},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Pin Size"}),w.jsx("input",{type:"range",min:"60",max:"120",value:r.display.pinSize,onChange:a=>i("display","pinSize",parseInt(a.target.value)),style:{width:"120px"}}),w.jsxs("span",{style:{color:"#999",minWidth:"40px"},children:[r.display.pinSize,"px"]})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Grid Opacity"}),w.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r.display.gridOpacity,onChange:a=>i("display","gridOpacity",parseFloat(a.target.value)),style:{width:"120px"}}),w.jsxs("span",{style:{color:"#999",minWidth:"40px"},children:[Math.round(r.display.gridOpacity*100),"%"]})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Show Pin Numbers"}),w.jsx("input",{type:"checkbox",checked:r.display.showPinNumbers,onChange:a=>i("display","showPinNumbers",a.target.checked)})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Show Signal Names"}),w.jsx("input",{type:"checkbox",checked:r.display.showSignalNames,onChange:a=>i("display","showSignalNames",a.target.checked)})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Show Bank Boundaries"}),w.jsx("input",{type:"checkbox",checked:r.display.showBankBoundaries,onChange:a=>i("display","showBankBoundaries",a.target.checked)})]})]})]}),w.jsxs("div",{style:{marginBottom:"24px"},children:[w.jsx("h3",{style:{color:"#4A90E2",margin:"0 0 12px 0",fontSize:"16px"},children:"Export"}),w.jsxs("div",{style:{display:"grid",gap:"12px"},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Default Format"}),w.jsxs("select",{value:r.export.defaultFormat,onChange:a=>i("export","defaultFormat",a.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"},children:[w.jsx("option",{value:"xdc",children:"XDC (Xilinx)"}),w.jsx("option",{value:"csv",children:"CSV"}),w.jsx("option",{value:"report",children:"Report"})]})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"I/O Standard"}),w.jsxs("select",{value:r.export.ioStandard,onChange:a=>i("export","ioStandard",a.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"},children:[w.jsx("option",{value:"auto",children:"Auto (voltage-based)"}),w.jsx("option",{value:"LVCMOS33",children:"LVCMOS33"}),w.jsx("option",{value:"LVCMOS18",children:"LVCMOS18"}),w.jsx("option",{value:"LVCMOS25",children:"LVCMOS25"})]})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Drive Strength"}),w.jsx("input",{type:"number",min:"2",max:"24",step:"2",value:r.export.driveStrength,onChange:a=>i("export","driveStrength",parseInt(a.target.value)),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",width:"60px"}})]})]})]}),w.jsxs("div",{children:[w.jsx("h3",{style:{color:"#4A90E2",margin:"0 0 12px 0",fontSize:"16px"},children:"Advanced"}),w.jsxs("div",{style:{display:"grid",gap:"12px"},children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Debug Mode"}),w.jsx("input",{type:"checkbox",checked:r.advanced.enableDebugMode,onChange:a=>i("advanced","enableDebugMode",a.target.checked)})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Performance Metrics"}),w.jsx("input",{type:"checkbox",checked:r.advanced.showPerformanceMetrics,onChange:a=>i("advanced","showPerformanceMetrics",a.target.checked)})]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[w.jsx("label",{style:{color:"#ccc"},children:"Max Undo Steps"}),w.jsx("input",{type:"number",min:"10",max:"100",value:r.advanced.maxUndoSteps,onChange:a=>i("advanced","maxUndoSteps",parseInt(a.target.value)),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",width:"60px"}})]})]})]})]}),w.jsxs("div",{style:{padding:"16px 20px",borderTop:"1px solid #444",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[w.jsx("button",{onClick:t,style:{padding:"8px 16px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer"},children:"Cancel"}),w.jsx("button",{onClick:()=>{localStorage.setItem("fpga-planner-settings",JSON.stringify(r)),t()},style:{padding:"8px 16px",backgroundColor:"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:"pointer"},children:"Save Settings"})]})]})})},wI=({isOpen:e,onClose:t,onExport:r,pins:n,currentPackage:i})=>{const[a,s]=Se.useState("xdc"),[o,u]=Se.useState(!1);if(!e)return null;const f=[{value:"xdc",label:"XDC (Xilinx)",description:"Xilinx Design Constraints format for Vivado and ISE",icon:"",example:"set_property PACKAGE_PIN A1 [get_ports clk]"},{value:"sdc",label:"SDC (Intel/Altera)",description:"Synopsys Design Constraints format for Quartus",icon:"",example:"set_location_assignment PIN_A1 -to clk"}],d=f.find(g=>g.value===a),p=n.filter(g=>g.isAssigned&&g.signalName.trim()!=="").length,m=()=>{r(a),t()},v=()=>{if(!o)return null;const g=n.filter(y=>y.isAssigned&&y.signalName.trim()!=="").slice(0,3);return a==="xdc"?Ra.exportToXDC(g,i):Ra.exportToSDC(g,i)};return w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:w.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",padding:"24px",width:"500px",maxHeight:"80vh",overflow:"auto",color:"white"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[w.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"Export Constraint File"}),w.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"20px",cursor:"pointer",padding:"4px"},children:""})]}),w.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#ccc"},children:[p," assigned pins will be exported"]}),w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:"Choose constraint file format:"}),f.map(g=>w.jsxs("div",{style:{border:`2px solid ${a===g.value?"#007acc":"#444"}`,borderRadius:"6px",padding:"12px",marginBottom:"8px",cursor:"pointer",backgroundColor:a===g.value?"#1a4c80":"#333",transition:"all 0.2s ease"},onClick:()=>s(g.value),children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[w.jsx("span",{style:{fontSize:"16px",marginRight:"8px"},children:g.icon}),w.jsx("span",{style:{fontWeight:"bold",fontSize:"16px"},children:g.label})]}),w.jsx("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"6px"},children:g.description}),w.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:"#bbb",backgroundColor:"#1a1a1a",padding:"4px 8px",borderRadius:"3px"},children:["Example: ",g.example]})]},g.value))]}),p>0&&w.jsxs("div",{style:{marginBottom:"20px"},children:[w.jsx("button",{onClick:()=>u(!o),style:{backgroundColor:"#444",border:"1px solid #666",borderRadius:"4px",color:"white",padding:"6px 12px",cursor:"pointer",fontSize:"12px"},children:o?"Hide Preview":"Show Preview"}),o&&w.jsx("div",{style:{marginTop:"8px",backgroundColor:"#1a1a1a",border:"1px solid #444",borderRadius:"4px",padding:"12px",maxHeight:"200px",overflow:"auto"},children:w.jsx("pre",{style:{margin:0,fontSize:"11px",color:"#ddd",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:v()})})]}),w.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[w.jsx("button",{onClick:t,style:{backgroundColor:"#666",border:"1px solid #888",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),w.jsxs("button",{onClick:m,disabled:p===0,style:{backgroundColor:p>0?"#007acc":"#555",border:"1px solid #007acc",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:p>0?"pointer":"not-allowed",fontSize:"14px",opacity:p>0?1:.6},children:["Export ",d==null?void 0:d.label]})]})]})})},Hc=[{id:"overview",title:"Overview",icon:"",description:"All pins with key information",showSearch:!0,showFilters:!0,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}]},{id:"signals",title:"Signals",icon:"",description:"Assigned signal information",showSearch:!0,showFilters:!0,columns:[{key:"signalName",title:"Signal Name",width:140,editable:!0,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"direction",title:"Direction",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>!!(e.signalName&&e.signalName.trim()!==""),sort:(e,t)=>(e.signalName||"").localeCompare(t.signalName||"")},{id:"bankGroups",title:"Bank Stats",icon:"",description:"Dynamic bank groups statistics and analysis",showSearch:!1,showFilters:!1,isCustomComponent:!0,columns:[],filter:()=>!0,sort:()=>0},{id:"banks",title:"Banks",icon:"",description:"Pin organization by I/O banks",showSearch:!0,showFilters:!0,columns:[{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioType",title:"I/O Type",width:80,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>!!(e.bank&&e.bank.trim()!==""),sort:(e,t)=>{const r=parseInt(e.bank||"999"),n=parseInt(t.bank||"999");return r-n}},{id:"differential",title:"Diff Pairs",icon:"",description:"Differential pair management",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"differentialPair",title:"Pair Name",width:100,sortable:!0,customRender:(e,t)=>t.differentialPair?`${t.differentialPair.pair} (${t.differentialPair.type})`:"-"},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>e.differentialPair!==void 0,sort:(e,t)=>{var i,a;const r=((i=e.differentialPair)==null?void 0:i.pair)||"",n=((a=t.differentialPair)==null?void 0:a.pair)||"";return r.localeCompare(n)}},{id:"comments",title:"Comments",icon:"",description:"All pins with user comments",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"signalName",title:"Signal",width:100,sortable:!0},{key:"comment",title:"Comment",width:300,editable:!0},{key:"commentTimestamp",title:"Modified",width:120,render:"datetime",sortable:!0},{key:"commentAuthor",title:"Author",width:80,sortable:!0}],filter:e=>!!(e.comment&&e.comment.trim()!==""),sort:(e,t)=>{var i,a;const r=((i=e.commentTimestamp)==null?void 0:i.getTime())||0;return(((a=t.commentTimestamp)==null?void 0:a.getTime())||0)-r}},{id:"power",title:"Power",icon:"",description:"Power and ground pins",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>e.pinType==="POWER"||e.pinType==="GROUND"||e.direction==="Power"||e.direction==="Ground",sort:(e,t)=>e.pinNumber.localeCompare(t.pinNumber)}],kI=({value:e,onSave:t,options:r,editable:n=!1,placeholder:i="",className:a="",allowCustomValue:s=!1,getDisplayValue:o})=>{const[u,f]=Se.useState(!1),[d,p]=Se.useState(e||""),m=Se.useRef(null),v=()=>{d!==e&&t(d),f(!1)},g=()=>{p(e||""),f(!1)},y=E=>{E.key==="Enter"?(E.preventDefault(),v()):E.key==="Escape"&&(E.preventDefault(),g())};if(Se.useEffect(()=>{u&&m.current&&m.current.focus()},[u]),Se.useEffect(()=>{p(e||"")},[e]),!n){const E=o?o(e):e;return w.jsx("span",{className:`table-cell-readonly ${a}`,children:E||"-"})}if(u)return w.jsxs("select",{ref:m,value:d,onChange:E=>p(E.target.value),onBlur:v,onKeyDown:y,className:`table-cell-select ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"},children:[i&&w.jsx("option",{value:"",disabled:!0,children:i}),r.map(E=>w.jsx("option",{value:E,children:o?o(E):E},E)),s&&d&&!r.includes(d)&&w.jsxs("option",{value:d,children:[d," (Custom)"]})]});const C=o?o(e):e;return w.jsxs("div",{className:`table-cell-selectable ${a}`,onClick:()=>f(!0),title:"Click to select",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"pointer",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:E=>{E.currentTarget.style.borderColor="#555",E.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:E=>{E.currentTarget.style.borderColor="transparent",E.currentTarget.style.backgroundColor="transparent"},children:[w.jsx("span",{children:C||w.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:i})}),w.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:"4px"},children:""})]})},ug=({value:e,onSave:t,editable:r=!1,placeholder:n="",maxLength:i=500,className:a="",type:s="text",options:o=[],allowCustomValue:u=!1,getDisplayValue:f})=>{const[d,p]=Se.useState(!1),[m,v]=Se.useState(e||""),g=Se.useRef(null),y=()=>{m!==e&&t(m),p(!1)},C=()=>{v(e||""),p(!1)},E=S=>{S.key==="Enter"?(S.preventDefault(),y()):S.key==="Escape"&&(S.preventDefault(),C())};return Se.useEffect(()=>{d&&g.current&&(g.current.focus(),g.current.select())},[d]),Se.useEffect(()=>{v(e||"")},[e]),s==="select"?w.jsx(kI,{value:e,onSave:t,options:o,editable:r,placeholder:n,className:a,allowCustomValue:u,getDisplayValue:f}):(Se.useEffect(()=>{v(e||"")},[e]),r?d?w.jsx("input",{ref:g,type:"text",value:m,onChange:S=>v(S.target.value),onBlur:y,onKeyDown:E,placeholder:n,maxLength:i,className:`table-cell-input ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"}}):w.jsx("div",{className:`table-cell-editable ${a}`,onClick:()=>p(!0),title:"Click to edit",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"text",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:S=>{S.currentTarget.style.borderColor="#555",S.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:S=>{S.currentTarget.style.borderColor="transparent",S.currentTarget.style.backgroundColor="transparent"},children:e||w.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:n})}):w.jsx("span",{className:`table-cell-readonly ${a}`,children:e||"-"}))};class Jl{static generateAutoComment(t){const r=[];if(t.pinType.includes("POWER")&&r.push(`Power pin: ${t.bank?`Bank ${t.bank}`:"System"}`),t.pinType.includes("CLOCK")&&r.push("Clock input"),t.pinType==="GROUND"&&r.push("Ground pin"),t.differentialPair){const n=t.differentialPair.type==="positive"?"Positive":"Negative";r.push(`Diff pair: ${t.differentialPair.pair} (${n})`)}if(t.signalName){const n=t.signalName.toUpperCase();n.includes("CLK")&&r.push("Clock signal"),(n.includes("RST")||n.includes("RESET"))&&r.push("Reset signal"),n.includes("LED")&&r.push("LED output"),(n.includes("BTN")||n.includes("BUTTON"))&&r.push("Button input"),(n.includes("SW")||n.includes("SWITCH"))&&r.push("Switch input"),(n.includes("UART")||n.includes("TX")||n.includes("RX"))&&r.push("UART communication"),(n.includes("SPI")||n.includes("SCK")||n.includes("MOSI")||n.includes("MISO"))&&r.push("SPI interface"),(n.includes("I2C")||n.includes("SCL")||n.includes("SDA"))&&r.push("I2C interface")}return t.bank&&t.bank!==""&&r.push(`Bank ${t.bank}`),t.voltage&&r.push(`${t.voltage} I/O`),r.join("; ")}static applyTemplate(t,r){const n=this.templates.find(a=>a.id===t);if(!n)return"";let i=n.template;return Object.entries(r).forEach(([a,s])=>{i=i.replace(`{${a}}`,s)}),i}static getTemplates(){return[...this.templates]}static getTemplatesByCategory(t){return this.templates.filter(r=>r.category===t)}static searchComments(t,r){const n=r.toLowerCase();return t.filter(i=>(i.comment||"").toLowerCase().includes(n)||(i.autoComment||"").toLowerCase().includes(n))}static validateComment(t){const r=[];return t.length>500&&r.push("Comment too long (max 500 characters)"),/[<>'"&]/g.test(t)&&r.push("Comment contains potentially unsafe characters"),{isValid:r.length===0,errors:r}}static formatComment(t,r=50){return t?t.length<=r?t:t.substring(0,r-3)+"...":""}static exportComments(t,r){const n=t.filter(i=>i.comment&&i.comment.trim()!=="");switch(r){case"csv":return this.exportToCSV(n);case"json":return this.exportToJSON(n);case"markdown":return this.exportToMarkdown(n);default:throw new Error(`Unsupported format: ${r}`)}}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Bank","Comment","Author","Modified"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.bank||"",i.comment||"",i.commentAuthor||"",i.commentTimestamp?i.commentTimestamp.toISOString():""]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportToJSON(t){const r=t.map(n=>{var i;return{pinNumber:n.pinNumber,pinName:n.pinName,signalName:n.signalName,bank:n.bank,comment:n.comment,commentAuthor:n.commentAuthor,commentTimestamp:(i=n.commentTimestamp)==null?void 0:i.toISOString()}});return JSON.stringify(r,null,2)}static exportToMarkdown(t){const r=`# Pin Comments

Generated on ${new Date().toISOString()}

`,n=`| Pin | Signal | Bank | Comment | Author | Modified |
|-----|--------|------|---------|--------|----------|
`,i=t.map(a=>{const s=(a.comment||"").replace(/\|/g,"\\|"),o=a.commentTimestamp?a.commentTimestamp.toLocaleDateString():"";return`| ${a.pinNumber} | ${a.signalName||""} | ${a.bank||""} | ${s} | ${a.commentAuthor||""} | ${o} |`}).join(`
`);return r+n+i}static mergeComments(t,r){const n=[],i=[...t];return r.forEach(a=>{const s=i.find(o=>o.pinNumber===a.pinNumber);s&&(s.comment&&s.comment.trim()!==""&&s.comment!==a.comment?n.push({pinNumber:s.pinNumber,current:s.comment,imported:a.comment}):(s.comment=a.comment,s.commentTimestamp=new Date,s.commentAuthor=a.author||"imported"))}),{updated:i,conflicts:n}}}Jl.templates=[{id:"power-supply",name:"Power Supply",template:"Power: {voltage}V {current}mA",category:"power",variables:["voltage","current"]},{id:"clock-domain",name:"Clock Domain",template:"Clock: {frequency}MHz, Domain: {domain}",category:"clock",variables:["frequency","domain"]},{id:"differential-pair",name:"Differential Pair",template:"Diff pair: {pairName}, Partner: {partnerPin}",category:"differential",variables:["pairName","partnerPin"]},{id:"io-standard",name:"I/O Standard",template:"I/O: {standard}, Drive: {drive}mA, Termination: {termination}",category:"io",variables:["standard","drive","termination"]},{id:"led-output",name:"LED Output",template:"LED output - {color} LED, {brightness} brightness",category:"io",variables:["color","brightness"]},{id:"test-point",name:"Test Point",template:"Test point for {signal} - {purpose}",category:"custom",variables:["signal","purpose"]}];const CI=({onSelect:e,pin:t,className:r=""})=>{const[n,i]=Se.useState(!1),[a,s]=Se.useState(null),[o,u]=Se.useState({}),f=Jl.getTemplates(),d=v=>{var y,C,E,S;s(v);const g={};t&&((y=v.variables)!=null&&y.includes("voltage")&&(g.voltage=t.voltage||""),(C=v.variables)!=null&&C.includes("pairName")&&t.differentialPair&&(g.pairName=t.differentialPair.pair),(E=v.variables)!=null&&E.includes("partnerPin")&&t.differentialPair&&(g.partnerPin=t.differentialPair.pair),(S=v.variables)!=null&&S.includes("signal")&&(g.signal=t.signalName||"")),u(g)},p=()=>{a&&(e(a.id,o),i(!1),s(null),u({}))},m=()=>{if(t){const v=Jl.generateAutoComment(t);e("auto",{autoComment:v}),i(!1)}};return n?w.jsxs("div",{className:"comment-template-selector",style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.5)",padding:"16px",minWidth:"400px",maxWidth:"500px",zIndex:1e3,color:"#ffffff"},children:[w.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[w.jsx("h3",{style:{margin:0,fontSize:"16px",color:"#ffffff"},children:"Comment Templates"}),w.jsx("button",{onClick:()=>i(!1),style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",color:"#cccccc"},children:""})]}),t&&w.jsx("div",{style:{marginBottom:"16px"},children:w.jsx("button",{onClick:m,style:{width:"100%",padding:"12px",border:"2px solid #28a745",borderRadius:"6px",backgroundColor:"#f8fff9",color:"#28a745",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:" Generate Auto Comment"})}),a?w.jsxs("div",{children:[w.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",color:"#666"},children:['Fill in variables for "',a.name,'":']}),w.jsx("div",{style:{marginBottom:"16px"},children:w.jsx("div",{style:{padding:"12px",backgroundColor:"#f8f9fa",borderRadius:"4px",fontSize:"14px",fontFamily:"monospace",border:"1px solid #e0e0e0"},children:a.template})}),a.variables&&a.variables.length>0?w.jsx("div",{style:{display:"grid",gap:"12px",marginBottom:"16px"},children:a.variables.map(v=>w.jsxs("div",{children:[w.jsxs("label",{style:{display:"block",marginBottom:"4px",fontSize:"12px",fontWeight:"500",color:"#333"},children:[v,":"]}),w.jsx("input",{type:"text",value:o[v]||"",onChange:g=>u(y=>({...y,[v]:g.target.value})),placeholder:`Enter ${v}...`,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"}})]},v))}):null,w.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[w.jsx("button",{onClick:()=>s(null),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"transparent",color:"#6c757d",cursor:"pointer",fontSize:"14px"},children:"Back"}),w.jsx("button",{onClick:p,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:"#007acc",color:"white",cursor:"pointer",fontSize:"14px"},children:"Apply Template"})]})]}):w.jsxs("div",{children:[w.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",color:"#cccccc"},children:"Choose a template:"}),w.jsx("div",{style:{display:"grid",gap:"8px"},children:f.map(v=>w.jsxs("button",{onClick:()=>d(v),style:{padding:"12px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",textAlign:"left",transition:"all 0.2s ease"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="#f8f9fa",g.currentTarget.style.borderColor="#007acc"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="white",g.currentTarget.style.borderColor="#ddd"},children:[w.jsx("div",{style:{fontWeight:"500",marginBottom:"4px"},children:v.name}),w.jsx("div",{style:{fontSize:"12px",color:"#666"},children:v.template})]},v.id))})]}),w.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:-1},onClick:()=>i(!1)})]}):w.jsx("button",{onClick:()=>i(!0),className:`comment-template-trigger ${r}`,title:"Insert comment template",style:{padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",cursor:"pointer",fontSize:"12px",color:"#cccccc"},children:" Template"})},EI=["#e0e0e0","#ccc","#cccccc","#FFF","#000","#374151","#666"],TI=[{min:224,max:255,channels:["r","g","b"]},{min:0,max:48,channels:["r","g","b"]},{min:192,max:208,channels:["r","g","b"]}];function AI(e,t,r){for(const n of TI)if(n.channels.every(a=>{const s=a==="r"?e:a==="g"?t:r;return s>=n.min&&s<=n.max}))return!0;for(const n of EI){const i=parseInt(n.slice(1,3),16),a=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);if(Math.sqrt(Math.pow(e-i,2)+Math.pow(t-a,2)+Math.pow(r-s,2))<80)return!0}return!1}function PI(e){const t=[],r=.618033988749895,n=.7,i=.5;for(let a=0;a<e;a++){let s=a*r%1,o=0,u=!1;for(;!u&&o<10;){const f=NI(s,n,i);AI(f.r,f.g,f.b)?(s=(s+.1)%1,o++):(t.push(`#${f.r.toString(16).padStart(2,"0")}${f.g.toString(16).padStart(2,"0")}${f.b.toString(16).padStart(2,"0")}`),u=!0)}u||t.push(`#${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}`)}return t}function NI(e,t,r){let n,i,a;if(t===0)n=i=a=r;else{const s=(f,d,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?f+(d-f)*6*p:p<.5?d:p<.6666666666666666?f+(d-f)*(.6666666666666666-p)*6:f),o=r<.5?r*(1+t):r+t-r*t,u=2*r-o;n=s(u,o,e+1/3),i=s(u,o,e),a=s(u,o,e-1/3)}return{r:Math.round(n*255),g:Math.round(i*255),b:Math.round(a*255)}}const Wc=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#F39C12","#E74C3C","#9B59B6","#3498DB","#1ABC9C","#2ECC71","#F1C40F","#E67E22","#E91E63","#673AB7"];function xo(e){if(!e||e==="NA")return"#708090";if(e==="POWER"||e==="VCC")return"#8B4513";if(e==="GROUND"||e==="GND")return"#2C2C2C";const t=parseInt(e);if(!isNaN(t)){if(t<Wc.length)return Wc[t];{const i=PI(t-Wc.length+1);return i[i.length-1]}}let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)&4294967295;const n=Math.abs(r)%Wc.length;return Wc[n]}const A8=(e,t,r)=>{if(t)return"#2d4f75";if(!e)return r?"#2a2a2a":"#1a1a1a";const n=xo(e),i=FI(n,.7);return r?RI(i,.2):i},FI=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.max(0,(r>>16)-n),a=Math.max(0,(r>>8&255)-n),s=Math.max(0,(r&255)-n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},RI=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.min(255,(r>>16)+n),a=Math.min(255,(r>>8&255)+n),s=Math.min(255,(r&255)+n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},$c=48,I3=5,bI=({pins:e,columns:t,selectedRows:r,hoveredRowId:n,onRowSelection:i,onPinSelect:a,onCellEdit:s,onTemplateSelect:o,onHover:u,renderCellContent:f})=>{const[d,p]=Se.useState(0),[m,v]=Se.useState(400),g=Se.useRef(null),y=Se.useRef(null),C=Se.useMemo(()=>{const F=Math.floor(d/$c),N=Math.ceil(m/$c),A=Math.min(F+N+I3*2,e.length),P=Math.max(0,F-I3);return{start:P,end:A,visibleCount:A-P}},[d,m,e.length]),E=Se.useMemo(()=>e.slice(C.start,C.end),[e,C.start,C.end]),S=Se.useCallback(F=>{const N=F.target;p(N.scrollTop)},[]);Se.useEffect(()=>{const F=()=>{if(g.current){const A=g.current.getBoundingClientRect();v(A.height)}};F();const N=new ResizeObserver(F);return g.current&&N.observe(g.current),()=>{N.disconnect()}},[]),Se.useEffect(()=>{console.log(` VirtualizedPinList: Rendering ${C.visibleCount} of ${e.length} pins (${Math.round(C.visibleCount/e.length*100)}%)`)},[C.visibleCount,e.length]);const x=e.length*$c,T=C.start*$c;return w.jsx("div",{ref:g,style:{height:"100%",overflow:"hidden"},children:w.jsx("div",{ref:y,onScroll:S,style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:w.jsxs("div",{style:{height:x,position:"relative"},children:[w.jsx("div",{style:{position:"sticky",top:0,zIndex:10,backgroundColor:"#2a2a2a",borderBottom:"2px solid #444"},children:w.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{style:{width:"40px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",backgroundColor:"#2a2a2a",color:"#ffffff"},children:w.jsx("input",{type:"checkbox",checked:e.length>0&&r.size===e.length,onChange:F=>{const N=F.target.checked?new Set(e.map(A=>A.id)):new Set;e.forEach(A=>{r.has(A.id)!==N.has(A.id)&&i(A.id,N.has(A.id))})}})}),t.map(F=>w.jsx("th",{style:{width:`${F.width}px`,padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a"},children:F.title},F.key)),w.jsx("th",{style:{width:"100px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a"},children:"Actions"})]})})})}),w.jsx("div",{style:{position:"absolute",top:T,left:0,right:0},children:w.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:w.jsx("tbody",{children:E.map(F=>{const N=n===F.id,A=A8(F.bank,r.has(F.id),N);return w.jsxs("tr",{style:{backgroundColor:A,cursor:"pointer",borderBottom:"1px solid #333",color:"#ffffff",height:`${$c}px`},onClick:()=>a==null?void 0:a(F.id),onMouseEnter:()=>u(F.id),onMouseLeave:()=>u(null),children:[w.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"40px"},children:w.jsx("input",{type:"checkbox",checked:r.has(F.id),onChange:P=>i(F.id,P.target.checked),onClick:P=>P.stopPropagation()})}),t.map(P=>w.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",fontSize:"14px",maxWidth:`${P.width}px`,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:b=>P.editable&&b.stopPropagation(),children:f(F,P)},P.key)),w.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"100px"},onClick:P=>P.stopPropagation(),children:w.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[w.jsx("button",{onClick:P=>{P.stopPropagation();const b=Jl.generateAutoComment(F);s(F.id,"comment",b)},title:"Generate automatic comment",style:{padding:"4px 6px",border:"1px solid #28a745",borderRadius:"3px",backgroundColor:"#f8fff9",cursor:"pointer",fontSize:"12px",color:"#28a745"},children:""}),w.jsx(CI,{onSelect:(P,b)=>o(F.id,P,b),pin:F})]})})]},F.id)})})})})]})})})};class fg{static calculateBankStatistics(t){const r=new Map;t.forEach(p=>{const m=p.bank||"UNASSIGNED";r.has(m)||r.set(m,[]),r.get(m).push(p)});const n=[];let i=0;Array.from(r.entries()).forEach(([p,m])=>{const v=m.filter(N=>{var A;return N.isAssigned||!!((A=N.signalName)!=null&&A.trim())}),g=m.filter(N=>{var A;return!N.isAssigned&&!((A=N.signalName)!=null&&A.trim())});i+=v.length;const y={};m.forEach(N=>{const A=N.pinType||"UNKNOWN";y[A]=(y[A]||0)+1});const C={};m.forEach(N=>{const A=N.voltage||"UNSPECIFIED";C[A]=(C[A]||0)+1});const E={};m.forEach(N=>{const A=N.direction||"UNSPECIFIED";E[A]=(E[A]||0)+1});const S=m.filter(N=>{var A,P;return N.differentialPair||((A=N.pinName)==null?void 0:A.includes("_P"))||((P=N.pinName)==null?void 0:P.includes("_N"))}).length/2,x=new Map;v.forEach(N=>{if(N.signalName){const A=this.inferSignalType(N.signalName);x.set(A,(x.get(A)||0)+1)}});const T=Array.from(x.entries()).filter(([N,A])=>A>=2).sort((N,A)=>A[1]-N[1]).slice(0,3).map(([N,A])=>N),F=m.length>0?v.length/m.length*100:0;n.push({bankId:p,totalPins:m.length,assignedPins:v.length,unassignedPins:g.length,utilizationRate:F,pinsByType:y,pinsByVoltage:C,pinsByDirection:E,differentialPairs:Math.floor(S),majorSignalTypes:T})}),n.sort((p,m)=>{if(p.bankId==="UNASSIGNED")return 1;if(m.bankId==="UNASSIGNED")return-1;const v=parseInt(p.bankId),g=parseInt(m.bankId);return!isNaN(v)&&!isNaN(g)?v-g:p.bankId.localeCompare(m.bankId)});const a=t.length,s=a>0?i/a*100:0,o=n.filter(p=>p.bankId!=="UNASSIGNED").map(p=>({id:p.bankId,rate:p.utilizationRate})),u=o.length>0?o.reduce((p,m)=>m.rate>p.rate?m:p):{id:"N/A",rate:0},f=o.length>0?o.reduce((p,m)=>m.rate<p.rate?m:p):{id:"N/A",rate:0},d=Array.from(new Set(t.map(p=>p.pinType).filter(Boolean))).sort();return{totalBanks:r.size,totalPins:a,overallUtilization:s,bankStats:n,mostUtilizedBank:u.id,leastUtilizedBank:f.id,bankTypes:d}}static inferSignalType(t){const r=t.toUpperCase();return r.includes("CLK")?"CLOCK":r.includes("RST")||r.includes("RESET")?"RESET":r.includes("PWR")||r.includes("VCC")||r.includes("POWER")?"POWER":r.includes("GND")||r.includes("GROUND")?"GROUND":r.includes("DATA")||r.includes("D[")?"DATA":r.includes("ADDR")||r.includes("A[")?"ADDRESS":r.includes("CS")||r.includes("CE")||r.includes("EN")?"CONTROL":r.includes("LED")?"LED":r.includes("BTN")||r.includes("SW")?"USER_INPUT":r.includes("UART")||r.includes("TX")||r.includes("RX")?"UART":r.includes("SPI")||r.includes("I2C")?"SERIAL":r.includes("USB")?"USB":r.includes("ETH")||r.includes("RMII")||r.includes("RGMII")?"ETHERNET":r.includes("DDR")||r.includes("SDRAM")?"MEMORY":r.includes("HDMI")||r.includes("LVDS")?"DISPLAY":r.includes("_P")||r.includes("_N")?"DIFFERENTIAL":"GENERAL_IO"}static exportBankStatisticsCSV(t){const r=["Bank ID","Total Pins","Assigned Pins","Unassigned Pins","Utilization (%)","Main Pin Types","Main Voltages","Differential Pairs","Major Signal Types"],n=t.bankStats.map(i=>[i.bankId,i.totalPins.toString(),i.assignedPins.toString(),i.unassignedPins.toString(),i.utilizationRate.toFixed(1),Object.entries(i.pinsByType).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),Object.entries(i.pinsByVoltage).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),i.differentialPairs.toString(),i.majorSignalTypes.join("; ")]);return[r.join(","),...n.map(i=>i.map(a=>`"${a}"`).join(","))].join(`
`)}static generateRecommendations(t){const r=[];t.overallUtilization>90?r.push(" Overall utilization is very high (>90%). Consider using a larger package or optimizing pin assignments."):t.overallUtilization<30&&r.push(" Overall utilization is low (<30%). A smaller package might be more cost-effective.");const n=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED").map(a=>a.utilizationRate);if(n.length>1){const a=Math.max(...n),s=Math.min(...n),o=a-s;o>50&&r.push(` Bank utilization is unbalanced (${o.toFixed(1)}% variance). Consider redistributing signals.`)}const i=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED"&&a.assignedPins===0);return i.length>0&&r.push(` ${i.length} banks are completely unused: ${i.map(a=>a.bankId).join(", ")}`),r}}const II=({pins:e})=>{const[t,r]=Se.useState(null),[n,i]=Se.useState("bankId"),[a,s]=Se.useState("asc"),{visibleBanks:o,toggleBankVisibility:u,showAllBanks:f}=$i(),d=Se.useMemo(()=>fg.calculateBankStatistics(e),[e]),p=Se.useMemo(()=>{const F=[...d.bankStats];return F.sort((N,A)=>{let P=0;switch(n){case"bankId":if(N.bankId==="UNASSIGNED")P=1;else if(A.bankId==="UNASSIGNED")P=-1;else{const b=parseInt(N.bankId),I=parseInt(A.bankId);!isNaN(b)&&!isNaN(I)?P=b-I:P=N.bankId.localeCompare(A.bankId)}break;case"utilization":P=N.utilizationRate-A.utilizationRate;break;case"totalPins":P=N.totalPins-A.totalPins;break}return a==="asc"?P:-P}),F},[d.bankStats,n,a]),m=F=>{n===F?s(a==="asc"?"desc":"asc"):(i(F),s("asc"))},v=()=>{const F=fg.exportBankStatisticsCSV(d),N=new Blob([F],{type:"text/csv"}),A=URL.createObjectURL(N),P=document.createElement("a");P.href=A,P.download=`bank-statistics-${new Date().toISOString().slice(0,10)}.csv`,P.click(),URL.revokeObjectURL(A)},g=Se.useMemo(()=>fg.generateRecommendations(d),[d]),y=F=>n!==F?"":a==="asc"?"":"",C=F=>o.size===0?!0:o.has(F),E=F=>{console.log(` Bank ${F} clicked! Current visibility:`,C(F)),alert(`Bank ${F} clicked!`),u(F)},S=()=>{console.log(" Show all banks clicked"),alert("Show all banks clicked!"),f()},x=F=>{if(F==="UNASSIGNED")return{backgroundColor:"#6b7280",color:"white"};const N=xo(F),A=C(F);return{backgroundColor:A?`${N}20`:`${N}05`,borderLeft:`4px solid ${N}`,color:A?"#1f2937":"#9ca3af",opacity:A?1:.5}},T=F=>`${F.toFixed(1)}%`;return w.jsxs("div",{className:"bank-groups-panel p-4 space-y-4",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Groups Statistics"}),w.jsx("button",{onClick:v,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:" Export CSV"})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[w.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[w.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Banks"}),w.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.totalBanks})]}),w.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[w.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Pins"}),w.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.totalPins})]}),w.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[w.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overall Utilization"}),w.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T(d.overallUtilization)})]}),w.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[w.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Most Utilized"}),w.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["Bank ",d.mostUtilizedBank]})]})]}),g.length>0&&w.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Recommendations"}),w.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:g.map((F,N)=>w.jsxs("li",{children:[" ",F]},N))})]}),w.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-red-800 mb-2",children:" Debug Test Buttons"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>alert("Simple button works!"),className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Test Simple Click"}),w.jsx("button",{onClick:S,className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Test Show All"}),w.jsx("button",{onClick:()=>E("TEST"),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Bank Click"})]})]}),w.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[w.jsxs("div",{className:"p-4 border-b",children:[w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Bank Details"}),w.jsx("div",{className:"flex gap-2",children:w.jsx("button",{onClick:S,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",title:"Show all banks",children:" Show All"})})]}),w.jsxs("div",{className:"flex justify-between items-center",children:[w.jsx("p",{className:"text-sm text-gray-600 mt-1",children:" Click on any bank row to toggle its visibility in the pin list"}),w.jsxs("div",{className:"text-xs text-gray-400",children:["Visible Banks: ",o.size===0?"All":Array.from(o).join(", ")]})]})]}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full",children:[w.jsx("thead",{className:"bg-gray-50",children:w.jsxs("tr",{children:[w.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("bankId"),children:["Bank ID ",y("bankId")]}),w.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("totalPins"),children:["Total Pins ",y("totalPins")]}),w.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),w.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>m("utilization"),children:["Utilization ",y("utilization")]}),w.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Main Types"}),w.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diff Pairs"}),w.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),w.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(F=>w.jsxs(wr.Fragment,{children:[w.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200",style:x(F.bankId),onClick:()=>E(F.bankId),title:`Click to ${C(F.bankId)?"hide":"show"} Bank ${F.bankId} pins`,children:[w.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:w.jsxs("div",{className:"flex items-center",children:[w.jsxs("div",{className:"flex items-center mr-2",children:[w.jsx("span",{className:"text-lg mr-1",children:C(F.bankId)?"":""}),w.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:F.bankId==="UNASSIGNED"?"#6b7280":xo(F.bankId)}})]}),w.jsx("span",{className:"text-sm font-medium",children:F.bankId==="UNASSIGNED"?"Unassigned":`Bank ${F.bankId}`})]})}),w.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:F.totalPins}),w.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[w.jsx("span",{className:"text-green-600 font-medium",children:F.assignedPins}),w.jsxs("span",{className:"text-gray-400",children:["/",F.unassignedPins]})]}),w.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:w.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,F.utilizationRate)}%`}})}),w.jsx("span",{className:"text-sm text-gray-700",children:T(F.utilizationRate)})]})}),w.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:Object.entries(F.pinsByType).sort((N,A)=>A[1]-N[1]).slice(0,2).map(([N,A])=>`${N}(${A})`).join(", ")}),w.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:F.differentialPairs>0?F.differentialPairs:"-"}),w.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:w.jsx("button",{onClick:N=>{N.stopPropagation(),r(t===F.bankId?null:F.bankId)},className:"text-blue-600 hover:text-blue-900 font-medium",children:t===F.bankId?"Hide":"Details"})})]}),t===F.bankId&&w.jsx("tr",{children:w.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Pin Types"}),w.jsx("div",{className:"space-y-1",children:Object.entries(F.pinsByType).map(([N,A])=>w.jsxs("div",{className:"flex justify-between text-sm",children:[w.jsx("span",{className:"text-gray-600",children:N}),w.jsx("span",{className:"font-medium",children:A})]},N))})]}),w.jsxs("div",{children:[w.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Voltages"}),w.jsx("div",{className:"space-y-1",children:Object.entries(F.pinsByVoltage).map(([N,A])=>w.jsxs("div",{className:"flex justify-between text-sm",children:[w.jsx("span",{className:"text-gray-600",children:N}),w.jsx("span",{className:"font-medium",children:A})]},N))})]}),w.jsxs("div",{children:[w.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Major Signal Types"}),w.jsx("div",{className:"space-y-1",children:F.majorSignalTypes.length>0?F.majorSignalTypes.map(N=>w.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:N},N)):w.jsx("span",{className:"text-gray-500 text-sm",children:"No major signal types"})})]})]})})})]},F.bankId))})]})})]})]})},hx=["1.0V","1.2V","1.5V","1.8V","2.5V","3.3V","5.0V"],px=["LVCMOS12","LVCMOS15","LVCMOS18","LVCMOS25","LVCMOS33","LVTTL","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","SSTL135","SSTL15","SSTL18_I","SSTL18_II","POD10","POD12","POD135","HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18","AUTO"],DI={"1.0V":"POD10","1.2V":"LVCMOS12","1.5V":"LVCMOS15","1.8V":"LVCMOS18","2.5V":"LVCMOS25","3.3V":"LVCMOS33","5.0V":"LVTTL"},P8={"1.0V":["POD10"],"1.2V":["LVCMOS12","POD12","SSTL135"],"1.5V":["LVCMOS15","SSTL15","HSTL_I","HSTL_II"],"1.8V":["LVCMOS18","SSTL18_I","SSTL18_II","HSTL_I_18","HSTL_II_18"],"2.5V":["LVCMOS25","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25"],"3.3V":["LVCMOS33","LVTTL"],"5.0V":["LVTTL"]};function D3(e){return P8[e]||["LVCMOS33"]}function Zl(e){return DI[e]||"LVCMOS33"}function OI(e,t){return t==="AUTO"?!0:(P8[e]||[]).includes(t)}const LI=({onPinSelect:e})=>{const{pins:t,listView:r,setActiveTab:n,setSearchQuery:i,setCommentFilter:a,updatePin:s,updateListViewState:o,bulkUpdateComments:u}=$i(),[f,d]=Se.useState(""),[p,m]=Se.useState(!1),[v,g]=Se.useState(null),y=Se.useMemo(()=>Hc.find(A=>A.id===r.activeTab)||Hc[0],[r.activeTab]),C=(A,P)=>{var b,I;switch(P){case"differentialPair":return A.differentialPair?`${A.differentialPair.pair}_${A.differentialPair.type}`:"";case"commentTimestamp":return((b=A.commentTimestamp)==null?void 0:b.getTime())||0;case"ioStandard":return((I=A.attributes)==null?void 0:I.IO_Standard)||A.ioType||"AUTO";default:return A[P]||""}},E=Se.useMemo(()=>{let A=t;if(y.filter&&(A=A.filter(y.filter)),r.searchQuery.trim()){const P=r.searchQuery.toLowerCase();A=A.filter(b=>b.pinNumber.toLowerCase().includes(P)||b.pinName.toLowerCase().includes(P)||(b.signalName||"").toLowerCase().includes(P)||(b.comment||"").toLowerCase().includes(P))}switch(r.commentFilter){case"with-comments":A=A.filter(P=>P.comment&&P.comment.trim()!=="");break;case"without-comments":A=A.filter(P=>!P.comment||P.comment.trim()==="");break}return r.sortColumn?A=[...A].sort((P,b)=>{const I=C(P,r.sortColumn),O=C(b,r.sortColumn);let j=0;return I<O?j=-1:I>O&&(j=1),r.sortDirection==="desc"?-j:j}):y.sort&&(A=[...A].sort(y.sort)),A},[t,y,r.searchQuery,r.commentFilter,r.sortColumn,r.sortDirection]),S=(A,P)=>{const b=C(A,P.key);if(P.customRender)return P.customRender(b,A);if(P.render==="datetime"&&A.commentTimestamp)return A.commentTimestamp.toLocaleDateString()+" "+A.commentTimestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(P.render==="boolean")return b?"":"";if(P.editable){if(P.key==="voltage")return w.jsx(ug,{value:String(b),onSave:I=>x(A.id,P.key,I),editable:!0,placeholder:"Select voltage...",type:"select",options:[...hx],allowCustomValue:!0});if(P.key==="ioStandard"||P.key==="ioType"){const I=A.voltage?D3(A.voltage):[...px];return w.jsx(ug,{value:String(b),onSave:O=>x(A.id,P.key,O),editable:!0,placeholder:"Select I/O standard...",type:"select",options:I,allowCustomValue:!0,getDisplayValue:O=>O==="AUTO"?`Auto (${Zl(A.voltage||"3.3V")})`:O})}return w.jsx(ug,{value:String(b),onSave:I=>x(A.id,P.key,I),editable:!0,placeholder:`Enter ${P.title.toLowerCase()}...`,maxLength:P.key==="comment"?500:100})}return String(b)||"-"},x=(A,P,b)=>{var j;const I=t.find(q=>q.id===A);if(!I)return;const O={};if(P==="comment")O.comment=b,O.commentTimestamp=new Date,O.commentAuthor="current_user";else if(P==="voltage"){O.voltage=b;const q=((j=I.attributes)==null?void 0:j.IO_Standard)||I.ioType||"AUTO";if(q==="AUTO"||!D3(b).includes(q)){const ie=Zl(b);O.attributes={...I.attributes,IO_Standard:ie},O.ioType=ie}}else P==="ioStandard"||P==="ioType"?(O.attributes={...I.attributes,IO_Standard:b},O.ioType=b):O[P]=b;s(A,O)},T=(A,P,b)=>{const I=t.find(j=>j.id===A);if(!I)return;let O;P==="auto"?O=Jl.generateAutoComment(I):O=Jl.applyTemplate(P,b),x(A,"comment",O)},F=(A,P)=>{const b=new Set(r.selectedRows);P?b.add(A):b.delete(A),o({selectedRows:b})},N=()=>{f.trim()&&r.selectedRows.size>0&&(u(Array.from(r.selectedRows),f),d(""),m(!1))};return w.jsxs("div",{className:"pin-list-tabs",children:[w.jsxs("div",{style:{padding:"8px",background:"#f0f0f0",fontSize:"12px",color:"#333"},children:[" Debug: Total tabs: ",Hc.length,", Available tabs: ",Hc.map(A=>A.id).join(", "),", Active: ",r.activeTab]}),w.jsx("div",{className:"tab-header",style:{display:"flex",borderBottom:"1px solid #444",backgroundColor:"#2a2a2a"},children:Hc.map(A=>w.jsxs("button",{className:`tab ${r.activeTab===A.id?"active":""}`,onClick:()=>n(A.id),title:A.description,style:{padding:"12px 16px",border:"none",background:r.activeTab===A.id?"#333":"transparent",borderBottom:r.activeTab===A.id?"2px solid #007acc":"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:r.activeTab===A.id?"600":"normal",color:r.activeTab===A.id?"#007acc":"#cccccc"},children:[w.jsx("span",{children:A.icon}),w.jsx("span",{children:A.title})]},A.id))}),!y.isCustomComponent&&w.jsxs("div",{className:"controls",style:{padding:"16px",display:"flex",gap:"16px",alignItems:"center",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444"},children:[y.showSearch&&w.jsx("div",{style:{flex:1,maxWidth:"300px"},children:w.jsx("input",{type:"text",placeholder:"Search pins, signals, or comments...",value:r.searchQuery,onChange:A=>i(A.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"}})}),w.jsx("div",{children:w.jsxs("select",{value:r.commentFilter,onChange:A=>a(A.target.value),style:{padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[w.jsx("option",{value:"all",children:"All Pins"}),w.jsx("option",{value:"with-comments",children:"With Comments"}),w.jsx("option",{value:"without-comments",children:"Without Comments"})]})}),w.jsxs("div",{style:{color:"#cccccc",fontSize:"14px"},children:[E.length," pins"]}),w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[w.jsx("span",{style:{color:"#cccccc",fontSize:"12px"},children:"BANKs:"}),Array.from(new Set(E.map(A=>A.bank).filter(Boolean))).sort((A,P)=>{const b=parseInt(A),I=parseInt(P);return isNaN(b)||isNaN(I)?A.localeCompare(P):b-I}).slice(0,8).map(A=>w.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"3px",backgroundColor:A8(A,!1,!1),border:"1px solid #555"},children:w.jsx("span",{style:{fontSize:"11px",color:"#ffffff"},children:A})},A))]}),r.selectedRows.size>0&&w.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[w.jsxs("span",{style:{fontSize:"14px",color:"#cccccc"},children:[r.selectedRows.size," selected"]}),w.jsx("button",{onClick:()=>m(!p),style:{padding:"6px 12px",border:"1px solid #007acc",borderRadius:"4px",backgroundColor:"#007acc",color:"white",fontSize:"12px",cursor:"pointer"},children:"Bulk Comment"}),w.jsx("button",{onClick:()=>u(Array.from(r.selectedRows),""),style:{padding:"6px 12px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Comments"})]})]}),!y.isCustomComponent&&p&&w.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",borderBottom:"1px solid #444",display:"flex",gap:"8px",alignItems:"center"},children:[w.jsx("input",{type:"text",placeholder:"Enter comment for selected pins...",value:f,onChange:A=>d(A.target.value),onKeyDown:A=>A.key==="Enter"&&N(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),w.jsx("button",{onClick:N,disabled:!f.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:f.trim()?"#28a745":"#ccc",color:"white",fontSize:"14px",cursor:f.trim()?"pointer":"not-allowed"},children:"Apply"}),w.jsx("button",{onClick:()=>m(!1),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#333",color:"#cccccc",fontSize:"14px",cursor:"pointer"},children:"Cancel"})]}),w.jsx("div",{style:{flex:1,minHeight:"400px"},children:y.isCustomComponent?y.id==="bankGroups"?w.jsx(II,{pins:t}):w.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:["Custom component not implemented for ",y.id]}):E.length>0?w.jsx(bI,{pins:E,columns:y.columns,selectedRows:r.selectedRows,hoveredRowId:v,onRowSelection:F,onPinSelect:e,onCellEdit:x,onTemplateSelect:T,onHover:g,renderCellContent:S}):w.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"No pins match the current filters"})})]})};var N8={exports:{}},wh={},Wd={},ft={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof hy<"u"?hy:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return e.Konva.angleDeg?i*t:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var i;return(i=e.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(i){e.glob.Konva=i}};const n=i=>{e.Konva[i.prototype.getClassName()]=i};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(ft);var ir={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=ft;class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const F=this.m;return{x:F[0]*T.x+F[2]*T.y+F[4],y:F[1]*T.x+F[3]*T.y+F[5]}}translate(T,F){return this.m[4]+=this.m[0]*T+this.m[2]*F,this.m[5]+=this.m[1]*T+this.m[3]*F,this}scale(T,F){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=F,this.m[3]*=F,this}rotate(T){const F=Math.cos(T),N=Math.sin(T),A=this.m[0]*F+this.m[2]*N,P=this.m[1]*F+this.m[3]*N,b=this.m[0]*-N+this.m[2]*F,I=this.m[1]*-N+this.m[3]*F;return this.m[0]=A,this.m[1]=P,this.m[2]=b,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,F){const N=this.m[0]+this.m[2]*F,A=this.m[1]+this.m[3]*F,P=this.m[2]+this.m[0]*T,b=this.m[3]+this.m[1]*T;return this.m[0]=N,this.m[1]=A,this.m[2]=P,this.m[3]=b,this}multiply(T){const F=this.m[0]*T.m[0]+this.m[2]*T.m[1],N=this.m[1]*T.m[0]+this.m[3]*T.m[1],A=this.m[0]*T.m[2]+this.m[2]*T.m[3],P=this.m[1]*T.m[2]+this.m[3]*T.m[3],b=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],I=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=F,this.m[1]=N,this.m[2]=A,this.m[3]=P,this.m[4]=b,this.m[5]=I,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),F=this.m[3]*T,N=-this.m[1]*T,A=-this.m[2]*T,P=this.m[0]*T,b=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=F,this.m[1]=N,this.m[2]=A,this.m[3]=P,this.m[4]=b,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const T=this.m[0],F=this.m[1],N=this.m[2],A=this.m[3],P=this.m[4],b=this.m[5],I=T*A-F*N,O={x:P,y:b,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||F!=0){const j=Math.sqrt(T*T+F*F);O.rotation=F>0?Math.acos(T/j):-Math.acos(T/j),O.scaleX=j,O.scaleY=I/j,O.skewX=(T*N+F*A)/I,O.skewY=0}else if(N!=0||A!=0){const j=Math.sqrt(N*N+A*A);O.rotation=Math.PI/2-(A>0?Math.acos(-N/j):-Math.acos(N/j)),O.scaleX=I/j,O.scaleY=j,O.skewX=0,O.skewY=(T*N+F*A)/I}return O.rotation=e.Util._getRotation(O.rotation),O}}e.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,u=180/Math.PI,f="#",d="",p="0",m="Konva warning: ",v="Konva error: ",g="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},C=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let E=[];const S=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(x){setTimeout(x,60)};e.Util={_isElement(x){return!!(x&&x.nodeType==1)},_isFunction(x){return!!(x&&x.constructor&&x.call&&x.apply)},_isPlainObject(x){return!!x&&x.constructor===Object},_isArray(x){return Object.prototype.toString.call(x)===n},_isNumber(x){return Object.prototype.toString.call(x)===i&&!isNaN(x)&&isFinite(x)},_isString(x){return Object.prototype.toString.call(x)===a},_isBoolean(x){return Object.prototype.toString.call(x)===s},isObject(x){return x instanceof Object},isValidSelector(x){if(typeof x!="string")return!1;const T=x[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(x){return x===0||x>0?1:-1},requestAnimFrame(x){E.push(x),E.length===1&&S(function(){const T=E;E=[],T.forEach(function(F){F()})})},createCanvasElement(){const x=document.createElement("canvas");try{x.style=x.style||{}}catch{}return x},createImageElement(){return document.createElement("img")},_isInDocument(x){for(;x=x.parentNode;)if(x==document)return!0;return!1},_urlToImage(x,T){const F=e.Util.createImageElement();F.onload=function(){T(F)},F.src=x},_rgbToHex(x,T,F){return((1<<24)+(x<<16)+(T<<8)+F).toString(16).slice(1)},_hexToRgb(x){x=x.replace(f,d);const T=parseInt(x,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let x=(Math.random()*16777215<<0).toString(16);for(;x.length<6;)x=p+x;return f+x},getRGB(x){let T;return x in y?(T=y[x],{r:T[0],g:T[1],b:T[2]}):x[0]===f?this._hexToRgb(x.substring(1)):x.substr(0,4)===g?(T=C.exec(x.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(x){return x=x||"black",e.Util._namedColorToRBA(x)||e.Util._hex3ColorToRGBA(x)||e.Util._hex4ColorToRGBA(x)||e.Util._hex6ColorToRGBA(x)||e.Util._hex8ColorToRGBA(x)||e.Util._rgbColorToRGBA(x)||e.Util._rgbaColorToRGBA(x)||e.Util._hslColorToRGBA(x)},_namedColorToRBA(x){const T=y[x.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(x){if(x.indexOf("rgb(")===0){x=x.match(/rgb\(([^)]+)\)/)[1];const T=x.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(x){if(x.indexOf("rgba(")===0){x=x.match(/rgba\(([^)]+)\)/)[1];const T=x.split(/ *, */).map((F,N)=>F.slice(-1)==="%"?N===3?parseInt(F)/100:parseInt(F)/100*255:Number(F));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(x){if(x[0]==="#"&&x.length===9)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:parseInt(x.slice(7,9),16)/255}},_hex6ColorToRGBA(x){if(x[0]==="#"&&x.length===7)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:1}},_hex4ColorToRGBA(x){if(x[0]==="#"&&x.length===5)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:parseInt(x[4]+x[4],16)/255}},_hex3ColorToRGBA(x){if(x[0]==="#"&&x.length===4)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:1}},_hslColorToRGBA(x){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(x)){const[T,...F]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(x),N=Number(F[0])/360,A=Number(F[1])/100,P=Number(F[2])/100;let b,I,O;if(A===0)return O=P*255,{r:Math.round(O),g:Math.round(O),b:Math.round(O),a:1};P<.5?b=P*(1+A):b=P+A-P*A;const j=2*P-b,q=[0,0,0];for(let ie=0;ie<3;ie++)I=N+1/3*-(ie-1),I<0&&I++,I>1&&I--,6*I<1?O=j+(b-j)*6*I:2*I<1?O=b:3*I<2?O=j+(b-j)*(2/3-I)*6:O=j,q[ie]=O*255;return{r:Math.round(q[0]),g:Math.round(q[1]),b:Math.round(q[2]),a:1}}},haveIntersection(x,T){return!(T.x>x.x+x.width||T.x+T.width<x.x||T.y>x.y+x.height||T.y+T.height<x.y)},cloneObject(x){const T={};for(const F in x)this._isPlainObject(x[F])?T[F]=this.cloneObject(x[F]):this._isArray(x[F])?T[F]=this.cloneArray(x[F]):T[F]=x[F];return T},cloneArray(x){return x.slice(0)},degToRad(x){return x*o},radToDeg(x){return x*u},_degToRad(x){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(x)},_radToDeg(x){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(x)},_getRotation(x){return t.Konva.angleDeg?e.Util.radToDeg(x):x},_capitalize(x){return x.charAt(0).toUpperCase()+x.slice(1)},throw(x){throw new Error(v+x)},error(x){console.error(v+x)},warn(x){t.Konva.showWarnings&&console.warn(m+x)},each(x,T){for(const F in x)T(F,x[F])},_inRange(x,T,F){return T<=x&&x<F},_getProjectionToSegment(x,T,F,N,A,P){let b,I,O;const j=(x-F)*(x-F)+(T-N)*(T-N);if(j==0)b=x,I=T,O=(A-F)*(A-F)+(P-N)*(P-N);else{const q=((A-x)*(F-x)+(P-T)*(N-T))/j;q<0?(b=x,I=T,O=(x-A)*(x-A)+(T-P)*(T-P)):q>1?(b=F,I=N,O=(F-A)*(F-A)+(N-P)*(N-P)):(b=x+q*(F-x),I=T+q*(N-T),O=(b-A)*(b-A)+(I-P)*(I-P))}return[b,I,O]},_getProjectionToLine(x,T,F){const N=e.Util.cloneObject(x);let A=Number.MAX_VALUE;return T.forEach(function(P,b){if(!F&&b===T.length-1)return;const I=T[(b+1)%T.length],O=e.Util._getProjectionToSegment(P.x,P.y,I.x,I.y,x.x,x.y),j=O[0],q=O[1],ie=O[2];ie<A&&(N.x=j,N.y=q,A=ie)}),N},_prepareArrayForTween(x,T,F){const N=[],A=[];if(x.length>T.length){const b=T;T=x,x=b}for(let b=0;b<x.length;b+=2)N.push({x:x[b],y:x[b+1]});for(let b=0;b<T.length;b+=2)A.push({x:T[b],y:T[b+1]});const P=[];return A.forEach(function(b){const I=e.Util._getProjectionToLine(b,N,F);P.push(I.x),P.push(I.y)}),P},_prepareToStringify(x){let T;x.visitedByCircularReferenceRemoval=!0;for(const F in x)if(x.hasOwnProperty(F)&&x[F]&&typeof x[F]=="object"){if(T=Object.getOwnPropertyDescriptor(x,F),x[F].visitedByCircularReferenceRemoval||e.Util._isElement(x[F]))if(T.configurable)delete x[F];else return null;else if(e.Util._prepareToStringify(x[F])===null)if(T.configurable)delete x[F];else return null}return delete x.visitedByCircularReferenceRemoval,x},_assign(x,T){for(const F in T)x[F]=T[F];return x},_getFirstPointerId(x){return x.touches?x.changedTouches[0].identifier:x.pointerId||999},releaseCanvas(...x){t.Konva.releaseCanvasOnDestroy&&x.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(x,T,F,N){let A=0,P=0,b=0,I=0;typeof N=="number"?A=P=b=I=Math.min(N,T/2,F/2):(A=Math.min(N[0]||0,T/2,F/2),P=Math.min(N[1]||0,T/2,F/2),I=Math.min(N[2]||0,T/2,F/2),b=Math.min(N[3]||0,T/2,F/2)),x.moveTo(A,0),x.lineTo(T-P,0),x.arc(T-P,P,P,Math.PI*3/2,0,!1),x.lineTo(T,F-I),x.arc(T-I,F-I,I,0,Math.PI/2,!1),x.lineTo(b,F),x.arc(b,F-b,b,Math.PI/2,Math.PI,!1),x.lineTo(0,A),x.arc(A,A,A,Math.PI,Math.PI*3/2,!1)}}})(ir);var Jt={},Ki={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.HitContext=Ua.SceneContext=Ua.Context=void 0;const F8=ir,MI=ft;function BI(e){const t=[],r=e.length,n=F8.Util;for(let i=0;i<r;i++){let a=e[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),t.push(a)}return t}const O3=",",jI="(",UI=")",zI="([",VI="])",GI=";",HI="()",WI="=",L3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],$I=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],XI=100;class kh{constructor(t){this.canvas=t,MI.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,r){let n=this.traceArr,i=n.length,a="",s,o,u,f;for(s=0;s<i;s++)o=n[s],u=o.method,u?(f=o.args,a+=u,t?a+=HI:F8.Util._isArray(f[0])?a+=zI+f.join(O3)+VI:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=jI+f.join(O3)+UI)):(a+=o.property,t||(a+=WI+o.val)),a+=GI;return a}clearTrace(){this.traceArr=[]}_trace(t){let r=this.traceArr,n;r.push(t),n=r.length,n>=XI&&r.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const r=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(t){const r=t.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(t){const r=t.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(t){const r=t.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(t,r){this._context[t]=r}arc(t,r,n,i,a,s){this._context.arc(t,r,n,i,a,s)}arcTo(t,r,n,i,a){this._context.arcTo(t,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,r,n,i,a,s){this._context.bezierCurveTo(t,r,n,i,a,s)}clearRect(t,r,n,i){this._context.clearRect(t,r,n,i)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,r){const n=arguments;if(n.length===2)return this._context.createImageData(t,r);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,r,n,i){return this._context.createLinearGradient(t,r,n,i)}createPattern(t,r){return this._context.createPattern(t,r)}createRadialGradient(t,r,n,i,a,s){return this._context.createRadialGradient(t,r,n,i,a,s)}drawImage(t,r,n,i,a,s,o,u,f){const d=arguments,p=this._context;d.length===3?p.drawImage(t,r,n):d.length===5?p.drawImage(t,r,n,i,a):d.length===9&&p.drawImage(t,r,n,i,a,s,o,u,f)}ellipse(t,r,n,i,a,s,o,u){this._context.ellipse(t,r,n,i,a,s,o,u)}isPointInPath(t,r,n,i){return n?this._context.isPointInPath(n,t,r,i):this._context.isPointInPath(t,r,i)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,r,n,i){this._context.fillRect(t,r,n,i)}strokeRect(t,r,n,i){this._context.strokeRect(t,r,n,i)}fillText(t,r,n,i){i?this._context.fillText(t,r,n,i):this._context.fillText(t,r,n)}measureText(t){return this._context.measureText(t)}getImageData(t,r,n,i){return this._context.getImageData(t,r,n,i)}lineTo(t,r){this._context.lineTo(t,r)}moveTo(t,r){this._context.moveTo(t,r)}rect(t,r,n,i){this._context.rect(t,r,n,i)}roundRect(t,r,n,i,a){this._context.roundRect(t,r,n,i,a)}putImageData(t,r,n){this._context.putImageData(t,r,n)}quadraticCurveTo(t,r,n,i){this._context.quadraticCurveTo(t,r,n,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,r){this._context.scale(t,r)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,r,n,i,a,s){this._context.setTransform(t,r,n,i,a,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,r,n,i){this._context.strokeText(t,r,n,i)}transform(t,r,n,i,a,s){this._context.transform(t,r,n,i,a,s)}translate(t,r){this._context.translate(t,r)}_enableTrace(){let t=this,r=L3.length,n=this.setAttr,i,a;const s=function(o){let u=t[o],f;t[o]=function(){return a=BI(Array.prototype.slice.call(arguments,0)),f=u.apply(t,arguments),t._trace({method:o,args:a}),f}};for(i=0;i<r;i++)s(L3[i]);t.setAttr=function(){n.apply(t,arguments);const o=arguments[0];let u=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:o,val:u})}}_applyGlobalCompositeOperation(t){const r=t.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ua.Context=kh;$I.forEach(function(e){Object.defineProperty(kh.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});class KI extends kh{constructor(t,{willReadFrequently:r=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(t){const r=t.fill();this.setAttr("fillStyle",r),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const r=t._getLinearGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fillRadialGradient(t){const r=t._getRadialGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fill(t){const r=t.fill(),n=t.getFillPriority();if(r&&n==="color"){this._fillColor(t);return}const i=t.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(t);return}const a=t.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(t);return}const s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}r?this._fillColor(t):i?this._fillPattern(t):a?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const r=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(t){const r=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),r&&t.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var r,n,i;const a=(r=t.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=t.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=u.x*f,p=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(p))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*p)}}Ua.SceneContext=KI;class YI extends kh{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),i=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}Ua.HitContext=YI;Object.defineProperty(Ki,"__esModule",{value:!0});Ki.HitCanvas=Ki.SceneCanvas=Ki.Canvas=void 0;const $d=ir,R8=Ua,b8=ft;let Vf;function QI(){if(Vf)return Vf;const e=$d.Util.createCanvasElement(),t=e.getContext("2d");return Vf=function(){const r=b8.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return r/n}(),$d.Util.releaseCanvas(e),Vf}class gx{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||b8.Konva.pixelRatio||QI();this.pixelRatio=n,this._canvas=$d.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const r=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,r){this.setWidth(t||0),this.setHeight(r||0)}toDataURL(t,r){try{return this._canvas.toDataURL(t,r)}catch{try{return this._canvas.toDataURL()}catch(i){return $d.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Ki.Canvas=gx;class qI extends gx{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new R8.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Ki.SceneCanvas=qI;class JI extends gx{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new R8.HitContext(this),this.setSize(t.width,t.height)}}Ki.HitCanvas=JI;var Ch={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=ft,r=ir;e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];e.DD._dragElements.forEach((a,s)=>{const{node:o}=a,u=o.getStage();u.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=u._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];e.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(Ch);var ht={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.RGBComponent=ZI;rt.alphaComponent=eD;rt.getNumberValidator=tD;rt.getNumberOrArrayOfNumbersValidator=rD;rt.getNumberOrAutoValidator=nD;rt.getStringValidator=iD;rt.getStringOrGradientValidator=aD;rt.getFunctionValidator=sD;rt.getNumberArrayValidator=oD;rt.getBooleanValidator=lD;rt.getComponentValidator=cD;const Ya=ft,lr=ir;function Qa(e){return lr.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||lr.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function ZI(e){return e>255?255:e<0?0:Math.round(e)}function eD(e){return e>1?1:e<1e-4?1e-4:e}function tD(){if(Ya.Konva.isUnminified)return function(e,t){return lr.Util._isNumber(e)||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function rD(e){if(Ya.Konva.isUnminified)return function(t,r){let n=lr.Util._isNumber(t),i=lr.Util._isArray(t)&&t.length==e;return!n&&!i&&lr.Util.warn(Qa(t)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function nD(){if(Ya.Konva.isUnminified)return function(e,t){return lr.Util._isNumber(e)||e==="auto"||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function iD(){if(Ya.Konva.isUnminified)return function(e,t){return lr.Util._isString(e)||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function aD(){if(Ya.Konva.isUnminified)return function(e,t){const r=lr.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return r||n||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function sD(){if(Ya.Konva.isUnminified)return function(e,t){return lr.Util._isFunction(e)||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function oD(){if(Ya.Konva.isUnminified)return function(e,t){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&e instanceof r||(lr.Util._isArray(e)?e.forEach(function(n){lr.Util._isNumber(n)||lr.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function lD(){if(Ya.Konva.isUnminified)return function(e,t){return e===!0||e===!1||lr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function cD(e){if(Ya.Konva.isUnminified)return function(t,r){return t==null||lr.Util.isObject(t)||lr.Util.warn(Qa(t)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+e),t}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=ir,r=rt,n="get",i="set";e.Factory={addGetterSetter(a,s,o,u,f){e.Factory.addGetter(a,s,o),e.Factory.addSetter(a,s,u,f),e.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const u=n+t.Util._capitalize(s);a.prototype[u]=a.prototype[u]||function(){const f=this.attrs[s];return f===void 0?o:f}},addSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]||e.Factory.overWriteSetter(a,s,o,u)},overWriteSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,s)),this._setAttr(s,d),u&&u.call(this),this}},addComponentsGetterSetter(a,s,o,u,f){const d=o.length,p=t.Util._capitalize,m=n+p(s),v=i+p(s);a.prototype[m]=function(){const y={};for(let C=0;C<d;C++){const E=o[C];y[E]=this.getAttr(s+p(E))}return y};const g=(0,r.getComponentValidator)(o);a.prototype[v]=function(y){const C=this.attrs[s];u&&(y=u.call(this,y,s)),g&&g.call(this,y,s);for(const E in y)y.hasOwnProperty(E)&&this._setAttr(s+p(E),y[E]);return y||o.forEach(E=>{this._setAttr(s+p(E),void 0)}),this._fireChangeEvent(s,C,y),f&&f.call(this),this},e.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=t.Util._capitalize(s),u=i+o,f=n+o;a.prototype[s]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,o,u){t.Util.error("Adding deprecated "+s);const f=n+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){t.Util.error(d);const p=this.attrs[s];return p===void 0?o:p},e.Factory.addSetter(a,s,u,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){t.Util.each(s,function(o,u){const f=a.prototype[u],d=n+t.Util._capitalize(o),p=i+t.Util._capitalize(o);function m(){f.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}a.prototype[o]=m,a.prototype[d]=m,a.prototype[p]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(ht);Object.defineProperty(Jt,"__esModule",{value:!0});Jt.Node=void 0;const fl=Ki,gi=Ch,xu=ht,ds=ft,xt=ir,pr=rt,ad="absoluteOpacity",Gf="allEventListeners",Na="absoluteTransform",M3="absoluteScale",oo="canvas",uD="Change",fD="children",dD="konva",Im="listening",hD="mouseenter",pD="mouseleave",gD="pointerenter",mD="pointerleave",xD="touchenter",vD="touchleave",B3="set",j3="Shape",sd=" ",U3="stage",hs="transform",yD="Stage",Dm="visible",_D=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(sd);let SD=1;class it{constructor(t){this._id=SD++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===hs||t===Na)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,r){let n=this._cache.get(t);return(n===void 0||(t===hs||t===Na)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(t,n)),n}_calculate(t,r,n){if(!this._attachedDepsListeners.get(t)){const i=r.map(a=>a+"Change.konva").join(sd);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(oo)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Na&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(oo)){const{scene:t,filter:r,hit:n,buffer:i}=this._cache.get(oo);xt.Util.releaseCanvas(t,r,n,i),this._cache.delete(oo)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const r=t||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,u=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,p=r.hitCanvasPixelRatio||1;if(!i||!a){xt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const m=Math.abs(Math.round(n.x)-o)>.5?1:0,v=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+m,a+=f*2+v,o-=f,u-=f;const g=new fl.SceneCanvas({pixelRatio:s,width:i,height:a}),y=new fl.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),C=new fl.HitCanvas({pixelRatio:p,width:i,height:a}),E=g.getContext(),S=C.getContext(),x=new fl.SceneCanvas({width:g.width/g.pixelRatio+Math.abs(o),height:g.height/g.pixelRatio+Math.abs(u),pixelRatio:g.pixelRatio}),T=x.getContext();return C.isCache=!0,g.isCache=!0,this._cache.delete(oo),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),E.save(),S.save(),T.save(),E.translate(-o,-u),S.translate(-o,-u),T.translate(-o,-u),x.x=o,x.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(ad),this._clearSelfAndDescendantCache(M3),this.drawScene(g,this,x),this.drawHit(C,this),this._isUnderCache=!1,E.restore(),S.restore(),d&&(E.save(),E.beginPath(),E.rect(0,0,i,a),E.closePath(),E.setAttr("strokeStyle","red"),E.setAttr("lineWidth",5),E.stroke(),E.restore()),this._cache.set(oo,{scene:g,filter:y,hit:C,buffer:x,x:o,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(oo)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,r){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const u=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=u.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();t.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()}_drawCachedHitCanvas(t){const r=this._getCanvasCache(),n=r.hit;t.save(),t.translate(r.x,r.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,u,f;if(t){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<s;u++){if(f=t[u],typeof f!="function"){xt.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,o),a.putImageData(o,0,0)}}catch(p){xt.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(t,r){if(this._cache&&this._cache.delete(Gf),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(sd);for(let i=0;i<n.length;i++){const s=n[i].split("."),o=s[0],u=s[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:u,handler:r})}return this}off(t,r){let n=(t||"").split(sd),i=n.length,a,s,o,u,f,d;if(this._cache&&this._cache.delete(Gf),!t)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],u=o.split("."),f=u[0],d=u[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(t){const r={target:this,type:t.type,evt:t};return this.fire(t.type,r),this}addEventListener(t,r){return this.on(t,function(n){r.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,r,n){const i=this;this.on(t,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=xt.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),gi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Na),this._clearSelfAndDescendantCache(ad),this._clearSelfAndDescendantCache(M3),this._clearSelfAndDescendantCache(U3),this._clearSelfAndDescendantCache(Dm),this._clearSelfAndDescendantCache(Im)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const r="get"+xt.Util._capitalize(t);return xt.Util._isFunction(this[r])?this[r]():this.attrs[t]}getAncestors(){let t=this.getParent(),r=[];for(;t;)r.push(t),t=t.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let r,n;if(!t)return this;for(r in t)r!==fD&&(n=B3+xt.Util._capitalize(r),xt.Util._isFunction(this[n])?this[n](t[r]):this._setAttr(r,t[r]))}),this}isListening(){return this._getCache(Im,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Dm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,r=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let i=!1;gi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!ds.Konva.hitOnDragEnabled&&(i||ds.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),r=this,n=0,i,a,s,o;function u(d){for(i=[],a=d.length,s=0;s<a;s++)o=d[s],n++,o.nodeType!==j3&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=t&&u(i)}const f=this.getStage();return r.nodeType!==yD&&f&&u(f.getChildren()),n}getDepth(){let t=0,r=this.parent;for(;r;)t++,r=r.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(hs),this._clearSelfAndDescendantCache(Na)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const r=t.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(t){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!t&&(t=!0);const i=this.getAbsoluteTransform(t).getMatrix(),a=new xt.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(t){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(hs);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:t.x,y:t.y}),this._clearCache(hs),this._clearSelfAndDescendantCache(Na),this}_setTransform(t){let r;for(r in t)this.attrs[r]=t[r]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let r=t.x,n=t.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(t,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return xt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return xt.Util.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return xt.Util.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return xt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return xt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&xt.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ad,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(t*=r.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in t)n=t[r],s=xt.Util.isObject(n)&&!xt.Util._isPlainObject(n)&&!xt.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete t[r],a=i?i.call(this):null,t[r]=n,a!==n&&(o.attrs[r]=n));return xt.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,r,n){const i=[];r&&this._isMatch(t)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent}return i}isAncestorOf(t){return!1}findAncestor(t,r,n){return this.findAncestors(t,r,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let r=t.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],xt.Util.isValidSelector(a)||(xt.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),xt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),xt.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(U3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,r={},n){return r.target=r.target||this,n?this._fireAndBubble(t,r):this._fire(t,r),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Na,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let r;if(t)return r=new xt.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),r;{r=this._cache.get(Na)||new xt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(t){let r=this;for(;r;)r._isUnderCache&&(t=r),r=r.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(hs,this._getTransform)}_getTransform(){var t,r;const n=this._cache.get(hs)||new xt.Transform;n.reset();const i=this.x(),a=this.y(),s=ds.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,p=this.attrs.offsetX||0,m=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(o!==1||u!==1)&&n.scale(o,u),(p!==0||m!==0)&&n.translate(-1*p,-1*m),n.dirty=!1,n}clone(t){let r=xt.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in t)r[n]=t[n];const u=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(dD)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(o));return u}_toKonvaCanvas(t){t=t||{};const r=this.getClientRect(),n=this.getStage(),i=t.x!==void 0?t.x:Math.floor(r.x),a=t.y!==void 0?t.y:Math.floor(r.y),s=t.pixelRatio||1,o=new fl.SceneCanvas({width:t.width||Math.ceil(r.width)||(n?n.width():0),height:t.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),u=o.getContext(),f=new fl.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||a)&&u.translate(-1*i,-1*a),this.drawScene(o,void 0,f),u.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const r=t.mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(r,n);return t.callback&&t.callback(i),i}toImage(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,xt.Util._urlToImage(this.toDataURL(t),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob(a=>{r(a),i==null||i(a)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(i){n(i)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ds.Konva.dragDistance}_off(t,r,n){let i=this.eventListeners[t],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,r,n){this._fire(t+uD,{oldVal:r,newVal:n})}addName(t){if(!this.hasName(t)){const r=this.name(),n=r?r+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const r=(this.name()||"").split(/\s/g),n=r.indexOf(t);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(t,r){const n=this[B3+xt.Util._capitalize(t)];return xt.Util._isFunction(n)?n.call(this,r):this._setAttr(t,r),this}_requestDraw(){if(ds.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,r){const n=this.attrs[t];n===r&&!xt.Util.isObject(r)||(r==null?delete this.attrs[t]:this.attrs[t]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,r),this._requestDraw())}_setComponentAttr(t,r,n){let i;n!==void 0&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][r]=n,this._fireChangeEvent(t,i,n))}_fireAndBubble(t,r,n){r&&this.nodeType===j3&&(r.target=this);const i=[hD,pD,gD,mD,xD,vD];if(!(i.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,r);const s=i.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,r,n):this._fireAndBubble.call(this.parent,t,r))}}_getProtoListeners(t){var r,n,i;const a=(r=this._cache.get(Gf))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[t];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const u=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[t])!==null&&i!==void 0?i:[];s.push(...u),o=Object.getPrototypeOf(o)}a[t]=s,this._cache.set(Gf,a)}return s}_fire(t,r){r=r||{},r.currentTarget=this,r.type=t;const n=this._getProtoListeners(t);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[t];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const r=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;gi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(t,r=!0){gi.DD._dragElements.has(this._id)||this._createDragElement(t);const n=gi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},r)}_setDragPosition(t,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,t);s?i=s:xt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(t){const r=gi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),gi.DD._endDragBefore(t),gi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=gi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||ds.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let i=!1;gi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=gi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&gi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-t.x,y:-t.y,width:r.width()+2*t.x,height:r.height()+2*t.y};return xt.Util.haveIntersection(n,this.getClientRect())}static create(t,r){return xt.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,r)}static _createNode(t,r){let n=it.prototype.getClassName.call(t),i=t.children,a,s,o;r&&(t.attrs.container=r),ds.Konva[n]||(xt.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=ds.Konva[n];if(a=new u(t.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(it._createNode(i[o]));return a}}Jt.Node=it;it.prototype.nodeType="Node";it.prototype._attrsAffectingSize=[];it.prototype.eventListeners={};it.prototype.on.call(it.prototype,_D,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(hs),this._clearSelfAndDescendantCache(Na)});it.prototype.on.call(it.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Dm)});it.prototype.on.call(it.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Im)});it.prototype.on.call(it.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ad)});const Vt=xu.Factory.addGetterSetter;Vt(it,"zIndex");Vt(it,"absolutePosition");Vt(it,"position");Vt(it,"x",0,(0,pr.getNumberValidator)());Vt(it,"y",0,(0,pr.getNumberValidator)());Vt(it,"globalCompositeOperation","source-over",(0,pr.getStringValidator)());Vt(it,"opacity",1,(0,pr.getNumberValidator)());Vt(it,"name","",(0,pr.getStringValidator)());Vt(it,"id","",(0,pr.getStringValidator)());Vt(it,"rotation",0,(0,pr.getNumberValidator)());xu.Factory.addComponentsGetterSetter(it,"scale",["x","y"]);Vt(it,"scaleX",1,(0,pr.getNumberValidator)());Vt(it,"scaleY",1,(0,pr.getNumberValidator)());xu.Factory.addComponentsGetterSetter(it,"skew",["x","y"]);Vt(it,"skewX",0,(0,pr.getNumberValidator)());Vt(it,"skewY",0,(0,pr.getNumberValidator)());xu.Factory.addComponentsGetterSetter(it,"offset",["x","y"]);Vt(it,"offsetX",0,(0,pr.getNumberValidator)());Vt(it,"offsetY",0,(0,pr.getNumberValidator)());Vt(it,"dragDistance",void 0,(0,pr.getNumberValidator)());Vt(it,"width",0,(0,pr.getNumberValidator)());Vt(it,"height",0,(0,pr.getNumberValidator)());Vt(it,"listening",!0,(0,pr.getBooleanValidator)());Vt(it,"preventDefault",!0,(0,pr.getBooleanValidator)());Vt(it,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Vt(it,"visible",!0,(0,pr.getBooleanValidator)());Vt(it,"transformsEnabled","all",(0,pr.getStringValidator)());Vt(it,"size");Vt(it,"dragBoundFunc");Vt(it,"draggable",!1,(0,pr.getBooleanValidator)());xu.Factory.backCompat(it,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var jo={};Object.defineProperty(jo,"__esModule",{value:!0});jo.Container=void 0;const cc=ht,dg=Jt,Eh=rt;class Uo extends dg.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){const r=this.children||[];return t?r.filter(t):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const r=this._generalFind(t,!0);return r.length>0?r[0]:void 0}_generalFind(t,r){const n=[];return this._descendants(i=>{const a=i._isMatch(t);return a&&n.push(i),!!(a&&r)}),n}_descendants(t){let r=!1;const n=this.getChildren();for(const i of n){if(r=t(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(t),r))return!0}return!1}toObject(){const t=dg.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(r=>{t.children.push(r.toObject())}),t}isAncestorOf(t){let r=t.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(t){const r=dg.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(t){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&r.push(n)}),r}_clearSelfAndDescendantCache(t){var r;super._clearSelfAndDescendantCache(t),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),u=o&&o.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(t,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const u=this.getAbsoluteTransform(r).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(t,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),d=typeof o=="number"&&typeof u=="number"||f,p=n===this;if(d){s.save();const v=this.getAbsoluteTransform(n);let g=v.getMatrix();s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),s.beginPath();let y;if(f)y=f.call(this,s,this);else{const C=this.clipX(),E=this.clipY();s.rect(C||0,E||0,o,u)}s.clip.apply(s,y),g=v.copy().invert().getMatrix(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5])}const m=!p&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";m&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(v){v[t](r,n,i)}),m&&s.restore(),d&&s.restore()}getClientRect(t={}){var r;const n=t.skipTransform,i=t.relativeTo;let a,s,o,u,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(v){if(!v.visible())return;const g=v.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});g.width===0&&g.height===0||(a===void 0?(a=g.x,s=g.y,o=g.x+g.width,u=g.y+g.height):(a=Math.min(a,g.x),s=Math.min(s,g.y),o=Math.max(o,g.x+g.width),u=Math.max(u,g.y+g.height)))});const p=this.find("Shape");let m=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){m=!0;break}return m&&a!==void 0?f={x:a,y:s,width:o-a,height:u-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}jo.Container=Uo;cc.Factory.addComponentsGetterSetter(Uo,"clip",["x","y","width","height"]);cc.Factory.addGetterSetter(Uo,"clipX",void 0,(0,Eh.getNumberValidator)());cc.Factory.addGetterSetter(Uo,"clipY",void 0,(0,Eh.getNumberValidator)());cc.Factory.addGetterSetter(Uo,"clipWidth",void 0,(0,Eh.getNumberValidator)());cc.Factory.addGetterSetter(Uo,"clipHeight",void 0,(0,Eh.getNumberValidator)());cc.Factory.addGetterSetter(Uo,"clipFunc");var I8={},Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.getCapturedShape=kD;Gs.createEvent=mx;Gs.hasPointerCapture=CD;Gs.setPointerCapture=ED;Gs.releaseCapture=O8;const wD=ft,nu=new Map,D8=wD.Konva._global.PointerEvent!==void 0;function kD(e){return nu.get(e)}function mx(e){return{evt:e,pointerId:e.pointerId}}function CD(e,t){return nu.get(e)===t}function ED(e,t){O8(e),t.getStage()&&(nu.set(e,t),D8&&t._fire("gotpointercapture",mx(new PointerEvent("gotpointercapture"))))}function O8(e,t){const r=nu.get(e);if(!r)return;const n=r.getStage();n&&n.content,nu.delete(e),D8&&r._fire("lostpointercapture",mx(new PointerEvent("lostpointercapture")))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=ir,r=ht,n=jo,i=ft,a=Ki,s=Ch,o=ft,u=Gs,f="Stage",d="string",p="px",m="mouseout",v="mouseleave",g="mouseover",y="mouseenter",C="mousemove",E="mousedown",S="mouseup",x="pointermove",T="pointerdown",F="pointerup",N="pointercancel",A="lostpointercapture",P="pointerout",b="pointerleave",I="pointerover",O="pointerenter",j="contextmenu",q="touchstart",ie="touchend",te="touchmove",Ae="touchcancel",Ee="wheel",re=5,X=[[y,"_pointerenter"],[E,"_pointerdown"],[C,"_pointermove"],[S,"_pointerup"],[v,"_pointerleave"],[q,"_pointerdown"],[te,"_pointermove"],[ie,"_pointerup"],[Ae,"_pointercancel"],[g,"_pointerover"],[Ee,"_wheel"],[j,"_contextmenu"],[T,"_pointerdown"],[x,"_pointermove"],[F,"_pointerup"],[N,"_pointercancel"],[b,"_pointerleave"],[A,"_lostpointercapture"]],he={mouse:{[P]:m,[b]:v,[I]:g,[O]:y,[x]:C,[T]:E,[F]:S,[N]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[P]:"touchout",[b]:"touchleave",[I]:"touchover",[O]:"touchenter",[x]:te,[T]:q,[F]:ie,[N]:Ae,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[P]:P,[b]:b,[I]:I,[O]:O,[x]:x,[T]:T,[F]:F,[N]:N,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Te=ue=>ue.indexOf("pointer")>=0?"pointer":ue.indexOf("touch")>=0?"touch":"mouse",L=ue=>{const V=Te(ue);if(V==="pointer")return i.Konva.pointerEventsEnabled&&he.pointer;if(V==="touch")return he.touch;if(V==="mouse")return he.mouse};function Q(ue={}){return(ue.clipFunc||ue.clipWidth||ue.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ue}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class K extends n.Container{constructor(V){super(Q(V)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Q(this.attrs)}),this._checkVisibility()}_validateAdd(V){const Z=V.getType()==="Layer",fe=V.getType()==="FastLayer";Z||fe||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const V=this.visible()?"":"none";this.content.style.display=V}setContainer(V){if(typeof V===d){let Z;if(V.charAt(0)==="."){const fe=V.slice(1);V=document.getElementsByClassName(fe)[0]}else V.charAt(0)!=="#"?Z=V:Z=V.slice(1),V=document.getElementById(Z);if(!V)throw"Can not find container in document with id "+Z}return this._setAttr("container",V),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),V.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const V=this.children,Z=V.length;for(let fe=0;fe<Z;fe++)V[fe].clear();return this}clone(V){return V||(V={}),V.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,V)}destroy(){super.destroy();const V=this.content;V&&t.Util._isInDocument(V)&&this.container().removeChild(V);const Z=e.stages.indexOf(this);return Z>-1&&e.stages.splice(Z,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const V=this._pointerPositions[0]||this._changedPointerPositions[0];return V?{x:V.x,y:V.y}:(t.Util.warn(Y),null)}_getPointerById(V){return this._pointerPositions.find(Z=>Z.id===V)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(V){V=V||{},V.x=V.x||0,V.y=V.y||0,V.width=V.width||this.width(),V.height=V.height||this.height();const Z=new a.SceneCanvas({width:V.width,height:V.height,pixelRatio:V.pixelRatio||1}),fe=Z.getContext()._context,ve=this.children;return(V.x||V.y)&&fe.translate(-1*V.x,-1*V.y),ve.forEach(function(Be){if(!Be.isVisible())return;const G=Be._toKonvaCanvas(V);fe.drawImage(G._canvas,V.x,V.y,G.getWidth()/G.getPixelRatio(),G.getHeight()/G.getPixelRatio())}),Z}getIntersection(V){if(!V)return null;const Z=this.children,fe=Z.length,ve=fe-1;for(let Be=ve;Be>=0;Be--){const G=Z[Be].getIntersection(V);if(G)return G}return null}_resizeDOM(){const V=this.width(),Z=this.height();this.content&&(this.content.style.width=V+p,this.content.style.height=Z+p),this.bufferCanvas.setSize(V,Z),this.bufferHitCanvas.setSize(V,Z),this.children.forEach(fe=>{fe.setSize({width:V,height:Z}),fe.draw()})}add(V,...Z){if(arguments.length>1){for(let ve=0;ve<arguments.length;ve++)this.add(arguments[ve]);return this}super.add(V);const fe=this.children.length;return fe>re&&t.Util.warn("The stage has "+fe+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),V.setSize({width:this.width(),height:this.height()}),V.draw(),i.Konva.isBrowser&&this.content.appendChild(V.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(V){return u.hasPointerCapture(V,this)}setPointerCapture(V){u.setPointerCapture(V,this)}releaseCapture(V){u.releaseCapture(V,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([V,Z])=>{this.content.addEventListener(V,fe=>{this[Z](fe)},{passive:!1})})}_pointerenter(V){this.setPointersPositions(V);const Z=L(V.type);Z&&this._fire(Z.pointerenter,{evt:V,target:this,currentTarget:this})}_pointerover(V){this.setPointersPositions(V);const Z=L(V.type);Z&&this._fire(Z.pointerover,{evt:V,target:this,currentTarget:this})}_getTargetShape(V){let Z=this[V+"targetShape"];return Z&&!Z.getStage()&&(Z=null),Z}_pointerleave(V){const Z=L(V.type),fe=Te(V.type);if(!Z)return;this.setPointersPositions(V);const ve=this._getTargetShape(fe),Be=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;ve&&Be?(ve._fireAndBubble(Z.pointerout,{evt:V}),ve._fireAndBubble(Z.pointerleave,{evt:V}),this._fire(Z.pointerleave,{evt:V,target:this,currentTarget:this}),this[fe+"targetShape"]=null):Be&&(this._fire(Z.pointerleave,{evt:V,target:this,currentTarget:this}),this._fire(Z.pointerout,{evt:V,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(V){const Z=L(V.type),fe=Te(V.type);if(!Z)return;this.setPointersPositions(V);let ve=!1;this._changedPointerPositions.forEach(Be=>{const G=this.getIntersection(Be);if(s.DD.justDragged=!1,i.Konva["_"+fe+"ListenClick"]=!0,!G||!G.isListening()){this[fe+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&G.setPointerCapture(Be.id),this[fe+"ClickStartShape"]=G,G._fireAndBubble(Z.pointerdown,{evt:V,pointerId:Be.id}),ve=!0;const qe=V.type.indexOf("touch")>=0;G.preventDefault()&&V.cancelable&&qe&&V.preventDefault()}),ve||this._fire(Z.pointerdown,{evt:V,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(V){const Z=L(V.type),fe=Te(V.type);if(!Z||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&V.cancelable&&V.preventDefault(),this.setPointersPositions(V),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Be={};let G=!1;const qe=this._getTargetShape(fe);this._changedPointerPositions.forEach(et=>{const Ye=u.getCapturedShape(et.id)||this.getIntersection(et),Qe=et.id,Fe={evt:V,pointerId:Qe},St=qe!==Ye;if(St&&qe&&(qe._fireAndBubble(Z.pointerout,{...Fe},Ye),qe._fireAndBubble(Z.pointerleave,{...Fe},Ye)),Ye){if(Be[Ye._id])return;Be[Ye._id]=!0}Ye&&Ye.isListening()?(G=!0,St&&(Ye._fireAndBubble(Z.pointerover,{...Fe},qe),Ye._fireAndBubble(Z.pointerenter,{...Fe},qe),this[fe+"targetShape"]=Ye),Ye._fireAndBubble(Z.pointermove,{...Fe})):qe&&(this._fire(Z.pointerover,{evt:V,target:this,currentTarget:this,pointerId:Qe}),this[fe+"targetShape"]=null)}),G||this._fire(Z.pointermove,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(V){const Z=L(V.type),fe=Te(V.type);if(!Z)return;this.setPointersPositions(V);const ve=this[fe+"ClickStartShape"],Be=this[fe+"ClickEndShape"],G={};let qe=!1;this._changedPointerPositions.forEach(et=>{const Ye=u.getCapturedShape(et.id)||this.getIntersection(et);if(Ye){if(Ye.releaseCapture(et.id),G[Ye._id])return;G[Ye._id]=!0}const Qe=et.id,Fe={evt:V,pointerId:Qe};let St=!1;i.Konva["_"+fe+"InDblClickWindow"]?(St=!0,clearTimeout(this[fe+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+fe+"InDblClickWindow"]=!0,clearTimeout(this[fe+"DblTimeout"])),this[fe+"DblTimeout"]=setTimeout(function(){i.Konva["_"+fe+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Ye&&Ye.isListening()?(qe=!0,this[fe+"ClickEndShape"]=Ye,Ye._fireAndBubble(Z.pointerup,{...Fe}),i.Konva["_"+fe+"ListenClick"]&&ve&&ve===Ye&&(Ye._fireAndBubble(Z.pointerclick,{...Fe}),St&&Be&&Be===Ye&&Ye._fireAndBubble(Z.pointerdblclick,{...Fe}))):(this[fe+"ClickEndShape"]=null,i.Konva["_"+fe+"ListenClick"]&&this._fire(Z.pointerclick,{evt:V,target:this,currentTarget:this,pointerId:Qe}),St&&this._fire(Z.pointerdblclick,{evt:V,target:this,currentTarget:this,pointerId:Qe}))}),qe||this._fire(Z.pointerup,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+fe+"ListenClick"]=!1,V.cancelable&&fe!=="touch"&&fe!=="pointer"&&V.preventDefault()}_contextmenu(V){this.setPointersPositions(V);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(j,{evt:V}):this._fire(j,{evt:V,target:this,currentTarget:this})}_wheel(V){this.setPointersPositions(V);const Z=this.getIntersection(this.getPointerPosition());Z&&Z.isListening()?Z._fireAndBubble(Ee,{evt:V}):this._fire(Ee,{evt:V,target:this,currentTarget:this})}_pointercancel(V){this.setPointersPositions(V);const Z=u.getCapturedShape(V.pointerId)||this.getIntersection(this.getPointerPosition());Z&&Z._fireAndBubble(F,u.createEvent(V)),u.releaseCapture(V.pointerId)}_lostpointercapture(V){u.releaseCapture(V.pointerId)}setPointersPositions(V){const Z=this._getContentPosition();let fe=null,ve=null;V=V||window.event,V.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(V.touches,Be=>{this._pointerPositions.push({id:Be.identifier,x:(Be.clientX-Z.left)/Z.scaleX,y:(Be.clientY-Z.top)/Z.scaleY})}),Array.prototype.forEach.call(V.changedTouches||V.touches,Be=>{this._changedPointerPositions.push({id:Be.identifier,x:(Be.clientX-Z.left)/Z.scaleX,y:(Be.clientY-Z.top)/Z.scaleY})})):(fe=(V.clientX-Z.left)/Z.scaleX,ve=(V.clientY-Z.top)/Z.scaleY,this.pointerPos={x:fe,y:ve},this._pointerPositions=[{x:fe,y:ve,id:t.Util._getFirstPointerId(V)}],this._changedPointerPositions=[{x:fe,y:ve,id:t.Util._getFirstPointerId(V)}])}_setPointerPosition(V){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(V)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const V=this.content.getBoundingClientRect();return{top:V.top,left:V.left,scaleX:V.width/this.content.clientWidth||1,scaleY:V.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const V=this.container();if(!V)throw"Stage has no container. A container is required.";V.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),V.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(V){V.batchDraw()}),this}}e.Stage=K,K.prototype.nodeType=f,(0,o._registerNode)(K),r.Factory.addGetterSetter(K,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(ue=>{ue.batchDraw()})})})(I8);var vu={},Ir={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=ft,r=ir,n=ht,i=Jt,a=rt,s=ft,o=Gs,u="hasShadow",f="shadowRGBA",d="patternImage",p="linearGradient",m="radialGradient";let v;function g(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}e.shapes={};function y(b){const I=this.attrs.fillRule;I?b.fill(I):b.fill()}function C(b){b.stroke()}function E(b){const I=this.attrs.fillRule;I?b.fill(I):b.fill()}function S(b){b.stroke()}function x(){this._clearCache(u)}function T(){this._clearCache(f)}function F(){this._clearCache(d)}function N(){this._clearCache(p)}function A(){this._clearCache(m)}class P extends i.Node{constructor(I){super(I);let O;for(;O=r.Util.getRandomColor(),!(O&&!(O in e.shapes)););this.colorKey=O,e.shapes[O]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const O=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(O&&O.setTransform){const j=new r.Transform;j.translate(this.fillPatternX(),this.fillPatternY()),j.rotate(t.Konva.getAngle(this.fillPatternRotation())),j.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),j.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const q=j.getMatrix(),ie=typeof DOMMatrix>"u"?{a:q[0],b:q[1],c:q[2],d:q[3],e:q[4],f:q[5]}:new DOMMatrix(q);O.setTransform(ie)}return O}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const O=g(),j=this.fillLinearGradientStartPoint(),q=this.fillLinearGradientEndPoint(),ie=O.createLinearGradient(j.x,j.y,q.x,q.y);for(let te=0;te<I.length;te+=2)ie.addColorStop(I[te],I[te+1]);return ie}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const O=g(),j=this.fillRadialGradientStartPoint(),q=this.fillRadialGradientEndPoint(),ie=O.createRadialGradient(j.x,j.y,this.fillRadialGradientStartRadius(),q.x,q.y,this.fillRadialGradientEndRadius());for(let te=0;te<I.length;te+=2)ie.addColorStop(I[te],I[te+1]);return ie}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const O=this.getStage();if(!O)return!1;const j=O.bufferHitCanvas;return j.getContext().clear(),this.drawHit(j,void 0,!0),j.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var O;if(!((O=this.attrs.perfectDrawEnabled)!==null&&O!==void 0?O:!0))return!1;const q=I||this.hasFill(),ie=this.hasStroke(),te=this.getAbsoluteOpacity()!==1;if(q&&ie&&te)return!0;const Ae=this.hasShadow(),Ee=this.shadowForStrokeEnabled();return!!(q&&ie&&Ae&&Ee)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let O=!1,j=this.getParent();for(;j;){if(j.isCached()){O=!0;break}j=j.getParent()}const q=I.skipTransform,ie=I.relativeTo||O&&this.getStage()||void 0,te=this.getSelfRect(),Ee=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,re=te.width+Ee,X=te.height+Ee,he=!I.skipShadow&&this.hasShadow(),Te=he?this.shadowOffsetX():0,L=he?this.shadowOffsetY():0,Q=re+Math.abs(Te),Y=X+Math.abs(L),K=he&&this.shadowBlur()||0,ue=Q+K*2,V=Y+K*2,Z={width:ue,height:V,x:-(Ee/2+K)+Math.min(Te,0)+te.x,y:-(Ee/2+K)+Math.min(L,0)+te.y};return q?Z:this._transformedRect(Z,ie)}drawScene(I,O,j){const q=this.getLayer(),ie=I||q.getCanvas(),te=ie.getContext(),Ae=this._getCanvasCache(),Ee=this.getSceneFunc(),re=this.hasShadow();let X;const he=!1,Te=O===this;if(!this.isVisible()&&!Te)return this;if(Ae){te.save();const L=this.getAbsoluteTransform(O).getMatrix();return te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),this._drawCachedSceneCanvas(te),te.restore(),this}if(!Ee)return this;if(te.save(),this._useBufferCanvas()&&!he){X=this.getStage();const L=j||X.bufferCanvas,Q=L.getContext();Q.clear(),Q.save(),Q._applyLineJoin(this);const Y=this.getAbsoluteTransform(O).getMatrix();Q.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),Ee.call(this,Q,this),Q.restore();const K=L.pixelRatio;re&&te._applyShadow(this),te._applyOpacity(this),te._applyGlobalCompositeOperation(this),te.drawImage(L._canvas,L.x||0,L.y||0,L.width/K,L.height/K)}else{if(te._applyLineJoin(this),!Te){const L=this.getAbsoluteTransform(O).getMatrix();te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),te._applyOpacity(this),te._applyGlobalCompositeOperation(this)}re&&te._applyShadow(this),Ee.call(this,te,this)}return te.restore(),this}drawHit(I,O,j=!1){if(!this.shouldDrawHit(O,j))return this;const q=this.getLayer(),ie=I||q.hitCanvas,te=ie&&ie.getContext(),Ae=this.hitFunc()||this.sceneFunc(),Ee=this._getCanvasCache(),re=Ee&&Ee.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),re){te.save();const he=this.getAbsoluteTransform(O).getMatrix();return te.transform(he[0],he[1],he[2],he[3],he[4],he[5]),this._drawCachedHitCanvas(te),te.restore(),this}if(!Ae)return this;if(te.save(),te._applyLineJoin(this),!(this===O)){const he=this.getAbsoluteTransform(O).getMatrix();te.transform(he[0],he[1],he[2],he[3],he[4],he[5])}return Ae.call(this,te,this),te.restore(),this}drawHitFromCache(I=0){const O=this._getCanvasCache(),j=this._getCachedSceneCanvas(),q=O.hit,ie=q.getContext(),te=q.getWidth(),Ae=q.getHeight();ie.clear(),ie.drawImage(j._canvas,0,0,te,Ae);try{const Ee=ie.getImageData(0,0,te,Ae),re=Ee.data,X=re.length,he=r.Util._hexToRgb(this.colorKey);for(let Te=0;Te<X;Te+=4)re[Te+3]>I?(re[Te]=he.r,re[Te+1]=he.g,re[Te+2]=he.b,re[Te+3]=255):re[Te+3]=0;ie.putImageData(Ee,0,0)}catch(Ee){r.Util.error("Unable to draw hit graph from cached scene canvas. "+Ee.message)}return this}hasPointerCapture(I){return o.hasPointerCapture(I,this)}setPointerCapture(I){o.setPointerCapture(I,this)}releaseCapture(I){o.releaseCapture(I,this)}}e.Shape=P,P.prototype._fillFunc=y,P.prototype._strokeFunc=C,P.prototype._fillFuncHit=E,P.prototype._strokeFuncHit=S,P.prototype._centroid=!1,P.prototype.nodeType="Shape",(0,s._registerNode)(P),P.prototype.eventListeners={},P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",F),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",N),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",A),n.Factory.addGetterSetter(P,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(P,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(P,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"lineJoin"),n.Factory.addGetterSetter(P,"lineCap"),n.Factory.addGetterSetter(P,"sceneFunc"),n.Factory.addGetterSetter(P,"hitFunc"),n.Factory.addGetterSetter(P,"dash"),n.Factory.addGetterSetter(P,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(P,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(P,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternImage"),n.Factory.addGetterSetter(P,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(P,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(P,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(P,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(P,"fillEnabled",!0),n.Factory.addGetterSetter(P,"strokeEnabled",!0),n.Factory.addGetterSetter(P,"shadowEnabled",!0),n.Factory.addGetterSetter(P,"dashEnabled",!0),n.Factory.addGetterSetter(P,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(P,"fillPriority","color"),n.Factory.addComponentsGetterSetter(P,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(P,"fillPatternRotation",0),n.Factory.addGetterSetter(P,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(P,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Ir);Object.defineProperty(vu,"__esModule",{value:!0});vu.Layer=void 0;const Pa=ir,hg=jo,dl=Jt,xx=ht,z3=Ki,TD=rt,AD=Ir,PD=ft,ND="#",FD="beforeDraw",RD="draw",L8=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],bD=L8.length;let uc=class extends hg.Container{constructor(t){super(t),this.canvas=new z3.SceneCanvas,this.hitCanvas=new z3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),t<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[t+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){dl.Node.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!dl.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(dl.Node.prototype.moveDown.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(dl.Node.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return dl.Node.prototype.remove.call(this),t&&t.parentNode&&Pa.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:r}){return this.canvas.setSize(t,r),this.hitCanvas.setSize(t,r),this._setSmoothEnabled(),this}_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&Pa.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),dl.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Pa.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Pa.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Pa.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<bD;i++){const a=L8[i],s=this._getIntersection({x:t.x+a.x*r,y:t.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(t){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*r),Math.round(t.y*r),1,1).data,i=n[3];if(i===255){const a=Pa.Util._rgbToHex(n[0],n[1],n[2]),s=AD.shapes[ND+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(FD,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),hg.Container.prototype.drawScene.call(this,a,r,n),this._fire(RD,{node:this}),this}drawHit(t,r){const n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),hg.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Pa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Pa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Pa.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};vu.Layer=uc;uc.prototype.nodeType="Layer";(0,PD._registerNode)(uc);xx.Factory.addGetterSetter(uc,"imageSmoothingEnabled",!0);xx.Factory.addGetterSetter(uc,"clearBeforeDraw",!0);xx.Factory.addGetterSetter(uc,"hitGraphEnabled",!0,(0,TD.getBooleanValidator)());var Th={};Object.defineProperty(Th,"__esModule",{value:!0});Th.FastLayer=void 0;const ID=ir,DD=vu,OD=ft;class vx extends DD.Layer{constructor(t){super(t),this.listening(!1),ID.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Th.FastLayer=vx;vx.prototype.nodeType="FastLayer";(0,OD._registerNode)(vx);var fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.Group=void 0;const LD=ir,MD=jo,BD=ft;let yx=class extends MD.Container{_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&LD.Util.throw("You may only add groups and shapes to groups.")}};fc.Group=yx;yx.prototype.nodeType="Group";(0,BD._registerNode)(yx);var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Animation=void 0;const pg=ft,V3=ir,gg=function(){return pg.glob.performance&&pg.glob.performance.now?function(){return pg.glob.performance.now()}:function(){return new Date().getTime()}}();class ha{constructor(t,r){this.id=ha.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:gg(),frameRate:0},this.func=t,this.setLayers(r)}setLayers(t){let r=[];return t&&(r=Array.isArray(t)?t:[t]),this.layers=r,this}getLayers(){return this.layers}addLayer(t){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const r=ha.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=gg(),ha._addAnimation(this),this}stop(){return ha._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const r=t.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const t={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(gg());const o=a.length;let u;if(s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<o;f++){const d=a[f];d._id!==void 0&&(t[d._id]=d)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=ha;t.animations.length?(t._runFrames(),V3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,V3.Util.requestAnimFrame(this._animationLoop))}}dc.Animation=ha;ha.animations=[];ha.animIdCounter=0;ha.animRunning=!1;var M8={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=ir,r=dc,n=Jt,i=ft,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,u=3,f=["fill","stroke","shadowColor"];let d=0;class p{constructor(g,y,C,E,S,x,T){this.prop=g,this.propFunc=y,this.begin=E,this._pos=E,this.duration=x,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=C,this._change=S-this.begin,this.pause()}fire(g){const y=this[g];y&&y()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const g=this.getTimer()-this._startTime;this.state===o?this.setTime(g):this.state===u&&this.setTime(this.duration-g)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(g){const y=this,C=g.node,E=C._id,S=g.easing||e.Easings.Linear,x=!!g.yoyo;let T,F;typeof g.duration>"u"?T=.3:g.duration===0?T=.001:T=g.duration,this.node=C,this._id=d++;const N=C.getLayer()||(C instanceof i.Konva.Stage?C.getLayers():null);N||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){y.tween.onEnterFrame()},N),this.tween=new p(F,function(A){y._tweenFunc(A)},S,0,1,T*1e3,x),this._addListeners(),m.attrs[E]||(m.attrs[E]={}),m.attrs[E][this._id]||(m.attrs[E][this._id]={}),m.tweens[E]||(m.tweens[E]={});for(F in g)a[F]===void 0&&this._addAttr(F,g[F]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,y){const C=this.node,E=C._id;let S,x,T,F,N;const A=m.tweens[E][g];A&&delete m.attrs[E][A][g];let P=C.getAttr(g);if(t.Util._isArray(y))if(S=[],x=Math.max(y.length,P.length),g==="points"&&y.length!==P.length&&(y.length>P.length?(F=P,P=t.Util._prepareArrayForTween(P,y,C.closed())):(T=y,y=t.Util._prepareArrayForTween(y,P,C.closed()))),g.indexOf("fill")===0)for(let b=0;b<x;b++)if(b%2===0)S.push(y[b]-P[b]);else{const I=t.Util.colorToRGBA(P[b]);N=t.Util.colorToRGBA(y[b]),P[b]=I,S.push({r:N.r-I.r,g:N.g-I.g,b:N.b-I.b,a:N.a-I.a})}else for(let b=0;b<x;b++)S.push(y[b]-P[b]);else f.indexOf(g)!==-1?(P=t.Util.colorToRGBA(P),N=t.Util.colorToRGBA(y),S={r:N.r-P.r,g:N.g-P.g,b:N.b-P.b,a:N.a-P.a}):S=y-P;m.attrs[E][this._id][g]={start:P,diff:S,end:y,trueEnd:T,trueStart:F},m.tweens[E][g]=this._id}_tweenFunc(g){const y=this.node,C=m.attrs[y._id][this._id];let E,S,x,T,F,N,A,P;for(E in C){if(S=C[E],x=S.start,T=S.diff,P=S.end,t.Util._isArray(x))if(F=[],A=Math.max(x.length,P.length),E.indexOf("fill")===0)for(N=0;N<A;N++)N%2===0?F.push((x[N]||0)+T[N]*g):F.push("rgba("+Math.round(x[N].r+T[N].r*g)+","+Math.round(x[N].g+T[N].g*g)+","+Math.round(x[N].b+T[N].b*g)+","+(x[N].a+T[N].a*g)+")");else for(N=0;N<A;N++)F.push((x[N]||0)+T[N]*g);else f.indexOf(E)!==-1?F="rgba("+Math.round(x.r+T.r*g)+","+Math.round(x.g+T.g*g)+","+Math.round(x.b+T.b*g)+","+(x.a+T.a*g)+")":F=x+T*g;y.setAttr(E,F)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const g=this.node,y=m.attrs[g._id][this._id];y.points&&y.points.trueEnd&&g.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const g=this.node,y=m.attrs[g._id][this._id];y.points&&y.points.trueStart&&g.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const g=this.node._id,y=this._id,C=m.tweens[g];this.pause(),this.anim&&this.anim.stop();for(const E in C)delete m.tweens[g][E];delete m.attrs[g][y],m.tweens[g]&&(Object.keys(m.tweens[g]).length===0&&delete m.tweens[g],Object.keys(m.attrs[g]).length===0&&delete m.attrs[g])}}e.Tween=m,m.attrs={},m.tweens={},n.Node.prototype.to=function(v){const g=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),g&&g()},new m(v).play()},e.Easings={BackEaseIn(v,g,y,C){return y*(v/=C)*v*((1.70158+1)*v-1.70158)+g},BackEaseOut(v,g,y,C){return y*((v=v/C-1)*v*((1.70158+1)*v+1.70158)+1)+g},BackEaseInOut(v,g,y,C){let E=1.70158;return(v/=C/2)<1?y/2*(v*v*(((E*=1.525)+1)*v-E))+g:y/2*((v-=2)*v*(((E*=1.525)+1)*v+E)+2)+g},ElasticEaseIn(v,g,y,C,E,S){let x=0;return v===0?g:(v/=C)===1?g+y:(S||(S=C*.3),!E||E<Math.abs(y)?(E=y,x=S/4):x=S/(2*Math.PI)*Math.asin(y/E),-(E*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/S))+g)},ElasticEaseOut(v,g,y,C,E,S){let x=0;return v===0?g:(v/=C)===1?g+y:(S||(S=C*.3),!E||E<Math.abs(y)?(E=y,x=S/4):x=S/(2*Math.PI)*Math.asin(y/E),E*Math.pow(2,-10*v)*Math.sin((v*C-x)*(2*Math.PI)/S)+y+g)},ElasticEaseInOut(v,g,y,C,E,S){let x=0;return v===0?g:(v/=C/2)===2?g+y:(S||(S=C*(.3*1.5)),!E||E<Math.abs(y)?(E=y,x=S/4):x=S/(2*Math.PI)*Math.asin(y/E),v<1?-.5*(E*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/S))+g:E*Math.pow(2,-10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/S)*.5+y+g)},BounceEaseOut(v,g,y,C){return(v/=C)<1/2.75?y*(7.5625*v*v)+g:v<2/2.75?y*(7.5625*(v-=1.5/2.75)*v+.75)+g:v<2.5/2.75?y*(7.5625*(v-=2.25/2.75)*v+.9375)+g:y*(7.5625*(v-=2.625/2.75)*v+.984375)+g},BounceEaseIn(v,g,y,C){return y-e.Easings.BounceEaseOut(C-v,0,y,C)+g},BounceEaseInOut(v,g,y,C){return v<C/2?e.Easings.BounceEaseIn(v*2,0,y,C)*.5+g:e.Easings.BounceEaseOut(v*2-C,0,y,C)*.5+y*.5+g},EaseIn(v,g,y,C){return y*(v/=C)*v+g},EaseOut(v,g,y,C){return-y*(v/=C)*(v-2)+g},EaseInOut(v,g,y,C){return(v/=C/2)<1?y/2*v*v+g:-y/2*(--v*(v-2)-1)+g},StrongEaseIn(v,g,y,C){return y*(v/=C)*v*v*v*v+g},StrongEaseOut(v,g,y,C){return y*((v=v/C-1)*v*v*v*v+1)+g},StrongEaseInOut(v,g,y,C){return(v/=C/2)<1?y/2*v*v*v*v*v+g:y/2*((v-=2)*v*v*v*v+2)+g},Linear(v,g,y,C){return y*v/C+g}}})(M8);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=ft,r=ir,n=Jt,i=jo,a=I8,s=vu,o=Th,u=fc,f=Ch,d=Ir,p=dc,m=M8,v=Ua,g=Ki;e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:u.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:m.Tween,Easings:m.Easings,Context:v.Context,Canvas:g.Canvas}),e.default=e.Konva})(Wd);var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Arc=void 0;const Ph=ht,jD=Ir,G3=ft,Nh=rt,UD=ft;class qa extends jD.Shape{_sceneFunc(t){const r=G3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,r,n),t.arc(0,0,this.innerRadius(),r,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=G3.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?t:r),d=s*r,p=o*(o>0?t:r),m=u*(u>0?r:t);return{x:f,y:n?-1*m:p,width:d-f,height:m-p}}}Ah.Arc=qa;qa.prototype._centroid=!0;qa.prototype.className="Arc";qa.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,UD._registerNode)(qa);Ph.Factory.addGetterSetter(qa,"innerRadius",0,(0,Nh.getNumberValidator)());Ph.Factory.addGetterSetter(qa,"outerRadius",0,(0,Nh.getNumberValidator)());Ph.Factory.addGetterSetter(qa,"angle",0,(0,Nh.getNumberValidator)());Ph.Factory.addGetterSetter(qa,"clockwise",!1,(0,Nh.getBooleanValidator)());var Fh={},yu={};Object.defineProperty(yu,"__esModule",{value:!0});yu.Line=void 0;const Rh=ht,zD=ft,VD=Ir,B8=rt;function Om(e,t,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*o/(o+u),d=s*u/(o+u),p=r-f*(i-e),m=n-f*(a-t),v=r+d*(i-e),g=n+d*(a-t);return[p,m,v,g]}function H3(e,t){const r=e.length,n=[];for(let i=2;i<r-2;i+=2){const a=Om(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(e[i]),n.push(e[i+1]),n.push(a[2]),n.push(a[3]))}return n}let Hs=class extends VD.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let o=0;if(t.beginPath(),t.moveTo(r[0],r[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(o=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);o<f-2;)t.bezierCurveTo(u[o++],u[o++],u[o++],u[o++],u[o++],u[o++]);a||t.quadraticCurveTo(u[f-2],u[f-1],r[n-2],r[n-1])}else if(s)for(o=2;o<n;)t.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)t.lineTo(r[o],r[o+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():H3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),r=t.length,n=this.tension(),i=Om(t[r-2],t[r-1],t[0],t[1],t[2],t[3],n),a=Om(t[r-4],t[r-3],t[r-2],t[r-1],t[0],t[1],n),s=H3(t,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],t[r-2],t[r-1],a[2],a[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};yu.Line=Hs;Hs.prototype.className="Line";Hs.prototype._attrsAffectingSize=["points","bezier","tension"];(0,zD._registerNode)(Hs);Rh.Factory.addGetterSetter(Hs,"closed",!1);Rh.Factory.addGetterSetter(Hs,"bezier",!1);Rh.Factory.addGetterSetter(Hs,"tension",0,(0,B8.getNumberValidator)());Rh.Factory.addGetterSetter(Hs,"points",[],(0,B8.getNumberArrayValidator)());var hc={},j8={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,o,u)=>{let f,d;const m=u/2;f=0;for(let v=0;v<20;v++)d=m*e.tValues[20][v]+m,f+=e.cValues[20][v]*n(s,o,d);return m*f};e.getCubicArcLength=t;const r=(s,o,u)=>{u===void 0&&(u=1);const f=s[0]-2*s[1]+s[2],d=o[0]-2*o[1]+o[2],p=2*s[1]-2*s[0],m=2*o[1]-2*o[0],v=4*(f*f+d*d),g=4*(f*p+d*m),y=p*p+m*m;if(v===0)return u*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const C=g/(2*v),E=y/v,S=u+C,x=E-C*C,T=S*S+x>0?Math.sqrt(S*S+x):0,F=C*C+x>0?Math.sqrt(C*C+x):0,N=C+Math.sqrt(C*C+x)!==0?x*Math.log(Math.abs((S+T)/(C+F))):0;return Math.sqrt(v)/2*(S*T-C*F+N)};e.getQuadraticArcLength=r;function n(s,o,u){const f=i(1,u,s),d=i(1,u,o),p=f*f+d*d;return Math.sqrt(p)}const i=(s,o,u)=>{const f=u.length-1;let d,p;if(f===0)return 0;if(s===0){p=0;for(let m=0;m<=f;m++)p+=e.binomialCoefficients[f][m]*Math.pow(1-o,f-m)*Math.pow(o,m)*u[m];return p}else{d=new Array(f);for(let m=0;m<f;m++)d[m]=f*(u[m+1]-u[m]);return i(s-1,o,d)}},a=(s,o,u)=>{let f=1,d=s/o,p=(s-u(d))/o,m=0;for(;f>.001;){const v=u(d+p),g=Math.abs(s-v)/o;if(g<f)f=g,d+=p;else{const y=u(d-p),C=Math.abs(s-y)/o;C<f?(f=C,d-=p):p/=2}if(m++,m>500)break}return d};e.t2length=a})(j8);Object.defineProperty(hc,"__esModule",{value:!0});hc.Path=void 0;const GD=ht,HD=ft,WD=Ir,hl=j8;class Ar extends WD.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ar.parsePathData(this.data()),this.pathLength=Ar.getPathLength(this.dataArray)}_sceneFunc(t){const r=this.dataArray;t.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const o=s[0],u=s[1],f=s[2],d=s[3],p=s[4],m=s[5],v=s[6],g=s[7],y=f>d?f:d,C=f>d?1:f/d,E=f>d?d/f:1;t.translate(o,u),t.rotate(v),t.scale(C,E),t.arc(0,0,y,p,p+m,1-g),t.scale(1/C,1/E),t.rotate(-v),t.translate(-o,-u);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],d=u.points[5],p=u.points[4]+d;let m=Math.PI/180;if(Math.abs(f-p)<m&&(m=Math.abs(f-p)),d<0)for(let v=f-m;v>p;v-=m){const g=Ar.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(g.x,g.y)}else for(let v=f+m;v<p;v+=m){const g=Ar.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(g.x,g.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const d=Ar.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(d.x,d.y)}else t=t.concat(u.points)});let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return Ar.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}static getPathLength(t){let r=0;for(let n=0;n<t.length;++n)r+=t[n].pathLength;return r}static getPointAtLengthOfDataArray(t,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&t>r[i].pathLength;)t-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],o=s.points;switch(s.command){case"L":return Ar.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Ar.getPointOnCubicBezier((0,hl.t2length)(t,Ar.getPathLength(r),y=>(0,hl.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Ar.getPointOnQuadraticBezier((0,hl.t2length)(t,Ar.getPathLength(r),y=>(0,hl.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":const u=o[0],f=o[1],d=o[2],p=o[3],m=o[5],v=o[6];let g=o[4];return g+=m*t/s.pathLength,Ar.getPointOnEllipticalArc(u,f,d,p,g,v)}return null}static getPointOnLine(t,r,n,i,a,s,o){s=s??r,o=o??n;const u=this.getLineLength(r,n,i,a);if(u<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?t:-t)};const f=(a-n)/(i-r),d=Math.sqrt(t*t/(1+f*f))*(i<r?-1:1),p=f*d;if(Math.abs(o-n-f*(s-r))<1e-10)return{x:s+d,y:o+p};const m=((s-r)*(i-r)+(o-n)*(a-n))/(u*u),v=r+m*(i-r),g=n+m*(a-n),y=this.getLineLength(s,o,v,g),C=Math.sqrt(t*t-y*y),E=Math.sqrt(C*C/(1+f*f))*(i<r?-1:1),S=f*E;return{x:v+E,y:g+S}}static getPointOnCubicBezier(t,r,n,i,a,s,o,u,f){function d(C){return C*C*C}function p(C){return 3*C*C*(1-C)}function m(C){return 3*C*(1-C)*(1-C)}function v(C){return(1-C)*(1-C)*(1-C)}const g=u*d(t)+s*p(t)+i*m(t)+r*v(t),y=f*d(t)+o*p(t)+a*m(t)+n*v(t);return{x:g,y}}static getPointOnQuadraticBezier(t,r,n,i,a,s,o){function u(v){return v*v}function f(v){return 2*v*(1-v)}function d(v){return(1-v)*(1-v)}const p=s*u(t)+i*f(t)+r*d(t),m=o*u(t)+a*f(t)+n*d(t);return{x:p,y:m}}static getPointOnEllipticalArc(t,r,n,i,a,s){const o=Math.cos(s),u=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(f.x*o-f.y*u),y:r+(f.x*u+f.y*o)}}static parsePathData(t){if(!t)return[];let r=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let p=0;p<n.length;p++)r=r.replace(new RegExp(n[p],"g"),"|"+n[p]);const i=r.split("|"),a=[],s=[];let o=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let p=1;p<i.length;p++){let m=i[p],v=m.charAt(0);for(m=m.slice(1),s.length=0;d=f.exec(m);)s.push(d[0]);const g=[];for(let y=0,C=s.length;y<C;y++){if(s[y]==="00"){g.push(0,0);continue}const E=parseFloat(s[y]);isNaN(E)?g.push(0):g.push(E)}for(;g.length>0&&!isNaN(g[0]);){let y="",C=[];const E=o,S=u;let x,T,F,N,A,P,b,I,O,j;switch(v){case"l":o+=g.shift(),u+=g.shift(),y="L",C.push(o,u);break;case"L":o=g.shift(),u=g.shift(),C.push(o,u);break;case"m":const q=g.shift(),ie=g.shift();if(o+=q,u+=ie,y="M",a.length>2&&a[a.length-1].command==="z"){for(let te=a.length-2;te>=0;te--)if(a[te].command==="M"){o=a[te].points[0]+q,u=a[te].points[1]+ie;break}}C.push(o,u),v="l";break;case"M":o=g.shift(),u=g.shift(),y="M",C.push(o,u),v="L";break;case"h":o+=g.shift(),y="L",C.push(o,u);break;case"H":o=g.shift(),y="L",C.push(o,u);break;case"v":u+=g.shift(),y="L",C.push(o,u);break;case"V":u=g.shift(),y="L",C.push(o,u);break;case"C":C.push(g.shift(),g.shift(),g.shift(),g.shift()),o=g.shift(),u=g.shift(),C.push(o,u);break;case"c":C.push(o+g.shift(),u+g.shift(),o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),y="C",C.push(o,u);break;case"S":T=o,F=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),F=u+(u-x.points[3])),C.push(T,F,g.shift(),g.shift()),o=g.shift(),u=g.shift(),y="C",C.push(o,u);break;case"s":T=o,F=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),F=u+(u-x.points[3])),C.push(T,F,o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),y="C",C.push(o,u);break;case"Q":C.push(g.shift(),g.shift()),o=g.shift(),u=g.shift(),C.push(o,u);break;case"q":C.push(o+g.shift(),u+g.shift()),o+=g.shift(),u+=g.shift(),y="Q",C.push(o,u);break;case"T":T=o,F=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),F=u+(u-x.points[1])),o=g.shift(),u=g.shift(),y="Q",C.push(T,F,o,u);break;case"t":T=o,F=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),F=u+(u-x.points[1])),o+=g.shift(),u+=g.shift(),y="Q",C.push(T,F,o,u);break;case"A":N=g.shift(),A=g.shift(),P=g.shift(),b=g.shift(),I=g.shift(),O=o,j=u,o=g.shift(),u=g.shift(),y="A",C=this.convertEndpointToCenterParameterization(O,j,o,u,b,I,N,A,P);break;case"a":N=g.shift(),A=g.shift(),P=g.shift(),b=g.shift(),I=g.shift(),O=o,j=u,o+=g.shift(),u+=g.shift(),y="A",C=this.convertEndpointToCenterParameterization(O,j,o,u,b,I,N,A,P);break}a.push({command:y||v,points:C,start:{x:E,y:S},pathLength:this.calcLength(E,S,y||v,C)})}(v==="z"||v==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,r,n,i){let a,s,o,u;const f=Ar;switch(n){case"L":return f.getLineLength(t,r,i[0],i[1]);case"C":return(0,hl.getCubicArcLength)([t,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,hl.getQuadraticArcLength)([t,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],p=i[5],m=i[4]+p;let v=Math.PI/180;if(Math.abs(d-m)<v&&(v=Math.abs(d-m)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),p<0)for(u=d-v;u>m;u-=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=d+v;u<m;u+=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],m,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(t,r,n,i,a,s,o,u,f){const d=f*(Math.PI/180),p=Math.cos(d)*(t-n)/2+Math.sin(d)*(r-i)/2,m=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(r-i)/2,v=p*p/(o*o)+m*m/(u*u);v>1&&(o*=Math.sqrt(v),u*=Math.sqrt(v));let g=Math.sqrt((o*o*(u*u)-o*o*(m*m)-u*u*(p*p))/(o*o*(m*m)+u*u*(p*p)));a===s&&(g*=-1),isNaN(g)&&(g=0);const y=g*o*m/u,C=g*-u*p/o,E=(t+n)/2+Math.cos(d)*y-Math.sin(d)*C,S=(r+i)/2+Math.sin(d)*y+Math.cos(d)*C,x=function(I){return Math.sqrt(I[0]*I[0]+I[1]*I[1])},T=function(I,O){return(I[0]*O[0]+I[1]*O[1])/(x(I)*x(O))},F=function(I,O){return(I[0]*O[1]<I[1]*O[0]?-1:1)*Math.acos(T(I,O))},N=F([1,0],[(p-y)/o,(m-C)/u]),A=[(p-y)/o,(m-C)/u],P=[(-1*p-y)/o,(-1*m-C)/u];let b=F(A,P);return T(A,P)<=-1&&(b=Math.PI),T(A,P)>=1&&(b=0),s===0&&b>0&&(b=b-2*Math.PI),s===1&&b<0&&(b=b+2*Math.PI),[E,S,o,u,N,b,d,s]}}hc.Path=Ar;Ar.prototype.className="Path";Ar.prototype._attrsAffectingSize=["data"];(0,HD._registerNode)(Ar);GD.Factory.addGetterSetter(Ar,"data");Object.defineProperty(Fh,"__esModule",{value:!0});Fh.Arrow=void 0;const bh=ht,$D=yu,U8=rt,XD=ft,W3=hc;class zo extends $D.Line{_sceneFunc(t){super._sceneFunc(t);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let u,f;if(a){const m=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],v=W3.Path.calcLength(i[i.length-4],i[i.length-3],"C",m),g=W3.Path.getPointOnQuadraticBezier(Math.min(1,1-s/v),m[0],m[1],m[2],m[3],m[4],m[5]);u=n[o-2]-g.x,f=n[o-1]-g.y}else u=n[o-2]-n[o-4],f=n[o-1]-n[o-3];const d=(Math.atan2(f,u)+r)%r,p=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[o-2],n[o-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),a?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-u)+r)%r),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),r=this.pointerWidth()/2;return{x:t.x,y:t.y-r,width:t.width,height:t.height+r*2}}}Fh.Arrow=zo;zo.prototype.className="Arrow";(0,XD._registerNode)(zo);bh.Factory.addGetterSetter(zo,"pointerLength",10,(0,U8.getNumberValidator)());bh.Factory.addGetterSetter(zo,"pointerWidth",10,(0,U8.getNumberValidator)());bh.Factory.addGetterSetter(zo,"pointerAtBeginning",!1);bh.Factory.addGetterSetter(zo,"pointerAtEnding",!0);var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Circle=void 0;const KD=ht,YD=Ir,QD=rt,qD=ft;let pc=class extends YD.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Ih.Circle=pc;pc.prototype._centroid=!0;pc.prototype.className="Circle";pc.prototype._attrsAffectingSize=["radius"];(0,qD._registerNode)(pc);KD.Factory.addGetterSetter(pc,"radius",0,(0,QD.getNumberValidator)());var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Ellipse=void 0;const _x=ht,JD=Ir,z8=rt,ZD=ft;class Ws extends JD.Shape{_sceneFunc(t){const r=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),r!==n&&t.scale(1,n/r),t.arc(0,0,r,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Dh.Ellipse=Ws;Ws.prototype.className="Ellipse";Ws.prototype._centroid=!0;Ws.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,ZD._registerNode)(Ws);_x.Factory.addComponentsGetterSetter(Ws,"radius",["x","y"]);_x.Factory.addGetterSetter(Ws,"radiusX",0,(0,z8.getNumberValidator)());_x.Factory.addGetterSetter(Ws,"radiusY",0,(0,z8.getNumberValidator)());var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.Image=void 0;const mg=ir,Vo=ht,eO=Ir,tO=ft,_u=rt;class Ai extends eO.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),r=this.hasShadow();return t&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,u=this.attrs.cropHeight;o&&u?s=[a,this.cropX(),this.cropY(),o,u,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?mg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){const r=this.width(),n=this.height(),i=this.cornerRadius();t.beginPath(),i?mg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,r;return(t=this.attrs.width)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var t,r;return(t=this.attrs.height)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(t,r,n=null){const i=mg.Util.createImageElement();i.onload=function(){const a=new Ai({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=t}}Oh.Image=Ai;Ai.prototype.className="Image";(0,tO._registerNode)(Ai);Vo.Factory.addGetterSetter(Ai,"cornerRadius",0,(0,_u.getNumberOrArrayOfNumbersValidator)(4));Vo.Factory.addGetterSetter(Ai,"image");Vo.Factory.addComponentsGetterSetter(Ai,"crop",["x","y","width","height"]);Vo.Factory.addGetterSetter(Ai,"cropX",0,(0,_u.getNumberValidator)());Vo.Factory.addGetterSetter(Ai,"cropY",0,(0,_u.getNumberValidator)());Vo.Factory.addGetterSetter(Ai,"cropWidth",0,(0,_u.getNumberValidator)());Vo.Factory.addGetterSetter(Ai,"cropHeight",0,(0,_u.getNumberValidator)());var ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.Tag=ec.Label=void 0;const Lh=ht,rO=Ir,nO=fc,Sx=rt,V8=ft,G8=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],iO="Change.konva",aO="none",Lm="up",Mm="right",Bm="down",jm="left",sO=G8.length;class wx extends nO.Group{constructor(t){super(t),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let r=this,n;const i=function(){r._sync()};for(n=0;n<sO;n++)t.on(G8[n]+iO,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),r=this.getTag(),n,i,a,s,o,u,f;if(t&&r){switch(n=t.width(),i=t.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),o=0,u=0,a){case Lm:o=n/2,u=-1*f;break;case Mm:o=n+s,u=i/2;break;case Bm:o=n/2,u=i+f;break;case jm:o=-1*s,u=i/2;break}r.setAttrs({x:-1*o,y:-1*u,width:n,height:i}),t.setAttrs({x:-1*o,y:-1*u})}}}ec.Label=wx;wx.prototype.className="Label";(0,V8._registerNode)(wx);class Go extends rO.Shape{_sceneFunc(t){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let u=0,f=0,d=0,p=0;typeof o=="number"?u=f=d=p=Math.min(o,r/2,n/2):(u=Math.min(o[0]||0,r/2,n/2),f=Math.min(o[1]||0,r/2,n/2),p=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),t.beginPath(),t.moveTo(u,0),i===Lm&&(t.lineTo((r-a)/2,0),t.lineTo(r/2,-1*s),t.lineTo((r+a)/2,0)),t.lineTo(r-f,0),t.arc(r-f,f,f,Math.PI*3/2,0,!1),i===Mm&&(t.lineTo(r,(n-s)/2),t.lineTo(r+a,n/2),t.lineTo(r,(n+s)/2)),t.lineTo(r,n-p),t.arc(r-p,n-p,p,0,Math.PI/2,!1),i===Bm&&(t.lineTo((r+a)/2,n),t.lineTo(r/2,n+s),t.lineTo((r-a)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===jm&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===Lm?(r-=i,o+=i):a===Bm?o+=i:a===jm?(t-=n*1.5,s+=n):a===Mm&&(s+=n*1.5),{x:t,y:r,width:s,height:o}}}ec.Tag=Go;Go.prototype.className="Tag";(0,V8._registerNode)(Go);Lh.Factory.addGetterSetter(Go,"pointerDirection",aO);Lh.Factory.addGetterSetter(Go,"pointerWidth",0,(0,Sx.getNumberValidator)());Lh.Factory.addGetterSetter(Go,"pointerHeight",0,(0,Sx.getNumberValidator)());Lh.Factory.addGetterSetter(Go,"cornerRadius",0,(0,Sx.getNumberOrArrayOfNumbersValidator)(4));var Su={};Object.defineProperty(Su,"__esModule",{value:!0});Su.Rect=void 0;const oO=ht,lO=Ir,cO=ft,uO=ir,fO=rt;let Mh=class extends lO.Shape{_sceneFunc(t){const r=this.cornerRadius(),n=this.width(),i=this.height();t.beginPath(),r?uO.Util.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}};Su.Rect=Mh;Mh.prototype.className="Rect";(0,cO._registerNode)(Mh);oO.Factory.addGetterSetter(Mh,"cornerRadius",0,(0,fO.getNumberOrArrayOfNumbersValidator)(4));var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.RegularPolygon=void 0;const H8=ht,dO=Ir,W8=rt,hO=ft;class Ho extends dO.Shape{_sceneFunc(t){const r=this._getPoints();t.beginPath(),t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<t;i++)n.push({x:r*Math.sin(i*2*Math.PI/t),y:-1*r*Math.cos(i*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let r=t[0].x,n=t[0].y,i=t[0].x,a=t[0].y;return t.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Bh.RegularPolygon=Ho;Ho.prototype.className="RegularPolygon";Ho.prototype._centroid=!0;Ho.prototype._attrsAffectingSize=["radius"];(0,hO._registerNode)(Ho);H8.Factory.addGetterSetter(Ho,"radius",0,(0,W8.getNumberValidator)());H8.Factory.addGetterSetter(Ho,"sides",0,(0,W8.getNumberValidator)());var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.Ring=void 0;const $8=ht,pO=Ir,X8=rt,gO=ft,$3=Math.PI*2;class Wo extends pO.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,$3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),$3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}jh.Ring=Wo;Wo.prototype.className="Ring";Wo.prototype._centroid=!0;Wo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,gO._registerNode)(Wo);$8.Factory.addGetterSetter(Wo,"innerRadius",0,(0,X8.getNumberValidator)());$8.Factory.addGetterSetter(Wo,"outerRadius",0,(0,X8.getNumberValidator)());var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.Sprite=void 0;const $o=ht,mO=Ir,xO=dc,K8=rt,vO=ft;class ya extends mO.Shape{constructor(t){super(t),this._updated=!0,this.anim=new xO.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],u=a[i+1],f=a[i+2],d=a[i+3],p=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,d),t.closePath(),t.fillStrokeShape(this)),p)if(s){const m=s[r],v=n*2;t.drawImage(p,o,u,f,d,m[v+0],m[v+1],f,d)}else t.drawImage(p,o,u,f,d,0,0,f,d)}_hitFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],u=a[i+3];if(t.beginPath(),s){const f=s[r],d=n*2;t.rect(f[d+0],f[d+1],o,u)}else t.rect(0,0,o,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}}Uh.Sprite=ya;ya.prototype.className="Sprite";(0,vO._registerNode)(ya);$o.Factory.addGetterSetter(ya,"animation");$o.Factory.addGetterSetter(ya,"animations");$o.Factory.addGetterSetter(ya,"frameOffsets");$o.Factory.addGetterSetter(ya,"image");$o.Factory.addGetterSetter(ya,"frameIndex",0,(0,K8.getNumberValidator)());$o.Factory.addGetterSetter(ya,"frameRate",17,(0,K8.getNumberValidator)());$o.Factory.backCompat(ya,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});zh.Star=void 0;const kx=ht,yO=Ir,Cx=rt,_O=ft;class $s extends yO.Shape{_sceneFunc(t){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),u=-1*s*Math.cos(a*Math.PI/i);t.lineTo(o,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}zh.Star=$s;$s.prototype.className="Star";$s.prototype._centroid=!0;$s.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,_O._registerNode)($s);kx.Factory.addGetterSetter($s,"numPoints",5,(0,Cx.getNumberValidator)());kx.Factory.addGetterSetter($s,"innerRadius",0,(0,Cx.getNumberValidator)());kx.Factory.addGetterSetter($s,"outerRadius",0,(0,Cx.getNumberValidator)());var gc={};Object.defineProperty(gc,"__esModule",{value:!0});gc.Text=void 0;gc.stringToArray=uo;const Um=ir,yn=ht,SO=Ir,xg=ft,Xs=rt,wO=ft;function uo(e){return[...e].reduce((t,r,n,i)=>{if(/\p{Emoji}/u.test(r)){const a=i[n+1];a&&/\p{Emoji_Modifier}|\u200D/u.test(a)?(t.push(r+a),i[n+1]=""):t.push(r)}else/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?t.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?t[t.length-1]+=r:r&&t.push(r);return t},[])}const pl="auto",kO="center",Y8="inherit",Xc="justify",CO="Change.konva",EO="2d",X3="-",Q8="left",TO="text",AO="Text",PO="top",NO="bottom",K3="middle",q8="normal",FO="px ",Hf=" ",RO="right",Y3="rtl",bO="word",IO="char",Q3="none",vg="",J8=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],DO=J8.length;function OO(e){return e.split(",").map(t=>{t=t.trim();const r=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return r&&!n&&(t=`"${t}"`),t}).join(", ")}let Wf;function yg(){return Wf||(Wf=Um.Util.createCanvasElement().getContext(EO),Wf)}function LO(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function MO(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function BO(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}let ur=class extends SO.Shape{constructor(t){super(BO(t)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<DO;r++)this.on(J8[r]+CO,this._setTextData);this._setTextData()}_sceneFunc(t){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),u=this.direction(),f=0,d=this.align(),p=this.getWidth(),m=this.letterSpacing(),v=this.fill(),g=this.textDecoration(),y=g.indexOf("underline")!==-1,C=g.indexOf("line-through")!==-1,E;u=u===Y8?t.direction:u;let S=s/2,x=K3;if(xg.Konva._fixTextRendering){const T=this.measureSize("M");x="alphabetic",S=(T.fontBoundingBoxAscent-T.fontBoundingBoxDescent)/2+s/2}for(u===Y3&&t.setAttr("direction",u),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",Q8),o===K3?f=(this.getHeight()-n*s-i*2)/2:o===NO&&(f=this.getHeight()-n*s-i*2),t.translate(i,f+i),E=0;E<n;E++){let T=0,F=0;const N=r[E],A=N.text,P=N.width,b=N.lastInParagraph;if(t.save(),d===RO?T+=p-P-i*2:d===kO&&(T+=(p-P-i*2)/2),y){t.save(),t.beginPath();const I=xg.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),O=T,j=S+F+I;t.moveTo(O,j);const q=d===Xc&&!b?p-i*2:P;t.lineTo(O+Math.round(q),j),t.lineWidth=a/15;const ie=this._getLinearGradient();t.strokeStyle=ie||v,t.stroke(),t.restore()}if(C){t.save(),t.beginPath();const I=xg.Konva._fixTextRendering?-Math.round(a/4):0;t.moveTo(T,S+F+I);const O=d===Xc&&!b?p-i*2:P;t.lineTo(T+Math.round(O),S+F+I),t.lineWidth=a/15;const j=this._getLinearGradient();t.strokeStyle=j||v,t.stroke(),t.restore()}if(u!==Y3&&(m!==0||d===Xc)){const I=A.split(" ").length-1,O=uo(A);for(let j=0;j<O.length;j++){const q=O[j];q===" "&&!b&&d===Xc&&(T+=(p-i*2-P)/I),this._partialTextX=T,this._partialTextY=S+F,this._partialText=q,t.fillStrokeShape(this),T+=this.measureSize(q).width+m}}else m!==0&&t.setAttr("letterSpacing",`${m}px`),this._partialTextX=T,this._partialTextY=S+F,this._partialText=A,t.fillStrokeShape(this);t.restore(),n>1&&(S+=s)}}_hitFunc(t){const r=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const r=Um.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(TO,r),this}getWidth(){return this.attrs.width===pl||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===pl||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Um.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var r,n,i,a,s,o,u,f,d,p,m;let v=yg(),g=this.fontSize(),y;v.save(),v.font=this._getContextFont(),y=v.measureText(t),v.restore();const C=g/100;return{actualBoundingBoxAscent:(r=y.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*C,actualBoundingBoxDescent:(n=y.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=y.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*C,actualBoundingBoxRight:(a=y.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*C,alphabeticBaseline:(s=y.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=y.emHeightAscent)!==null&&o!==void 0?o:100*C,emHeightDescent:(u=y.emHeightDescent)!==null&&u!==void 0?u:-20*C,fontBoundingBoxAscent:(f=y.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*C,fontBoundingBoxDescent:(d=y.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*C,hangingBaseline:(p=y.hangingBaseline)!==null&&p!==void 0?p:72.80000305175781*C,ideographicBaseline:(m=y.ideographicBaseline)!==null&&m!==void 0?m:-21*C,width:y.width,height:g}}_getContextFont(){return this.fontStyle()+Hf+this.fontVariant()+Hf+(this.fontSize()+FO)+OO(this.fontFamily())}_addTextLine(t){this.align()===Xc&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const r=this.letterSpacing(),n=t.length;return yg().measureText(t).width+r*n}_setTextData(){let t=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==pl&&a!==void 0,u=s!==pl&&s!==void 0,f=this.padding(),d=a-f*2,p=s-f*2,m=0,v=this.wrap(),g=v!==Q3,y=v!==IO&&g,C=this.ellipsis();this.textArr=[],yg().font=this._getContextFont();const E=C?this._getTextWidth(vg):0;for(let S=0,x=t.length;S<x;++S){let T=t[S],F=this._getTextWidth(T);if(o&&F>d)for(;T.length>0;){let N=0,A=uo(T).length,P="",b=0;for(;N<A;){const I=N+A>>>1,O=uo(T),j=O.slice(0,I+1).join(""),q=this._getTextWidth(j);(C&&u&&m+i>p?q+E:q)<=d?(N=I+1,P=j,b=q):A=I}if(P){if(y){const j=uo(T),q=uo(P),ie=j[q.length],te=ie===Hf||ie===X3;let Ae;if(te&&b<=d)Ae=q.length;else{const Ee=q.lastIndexOf(Hf),re=q.lastIndexOf(X3);Ae=Math.max(Ee,re)+1}Ae>0&&(N=Ae,P=j.slice(0,N).join(""),b=this._getTextWidth(P))}if(P=P.trimRight(),this._addTextLine(P),n=Math.max(n,b),m+=i,this._shouldHandleEllipsis(m)){this._tryToAddEllipsisToLastLine();break}if(T=uo(T).slice(N).join("").trimLeft(),T.length>0&&(F=this._getTextWidth(T),F<=d)){this._addTextLine(T),m+=i,n=Math.max(n,F);break}}else break}else this._addTextLine(T),m+=i,n=Math.max(n,F),this._shouldHandleEllipsis(m)&&S<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&m+i>p)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(t){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==pl&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==Q3)||a&&t+n>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,r=t!==pl&&t!==void 0,n=this.padding(),i=t-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+vg)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+vg))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return t&&r?!0:super._useBufferCanvas()}};gc.Text=ur;ur.prototype._fillFunc=LO;ur.prototype._strokeFunc=MO;ur.prototype.className=AO;ur.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,wO._registerNode)(ur);yn.Factory.overWriteSetter(ur,"width",(0,Xs.getNumberOrAutoValidator)());yn.Factory.overWriteSetter(ur,"height",(0,Xs.getNumberOrAutoValidator)());yn.Factory.addGetterSetter(ur,"direction",Y8);yn.Factory.addGetterSetter(ur,"fontFamily","Arial");yn.Factory.addGetterSetter(ur,"fontSize",12,(0,Xs.getNumberValidator)());yn.Factory.addGetterSetter(ur,"fontStyle",q8);yn.Factory.addGetterSetter(ur,"fontVariant",q8);yn.Factory.addGetterSetter(ur,"padding",0,(0,Xs.getNumberValidator)());yn.Factory.addGetterSetter(ur,"align",Q8);yn.Factory.addGetterSetter(ur,"verticalAlign",PO);yn.Factory.addGetterSetter(ur,"lineHeight",1,(0,Xs.getNumberValidator)());yn.Factory.addGetterSetter(ur,"wrap",bO);yn.Factory.addGetterSetter(ur,"ellipsis",!1,(0,Xs.getBooleanValidator)());yn.Factory.addGetterSetter(ur,"letterSpacing",0,(0,Xs.getNumberValidator)());yn.Factory.addGetterSetter(ur,"text","",(0,Xs.getStringValidator)());yn.Factory.addGetterSetter(ur,"textDecoration","");var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.TextPath=void 0;const _g=ir,Qi=ht,jO=Ir,Kc=hc,Sg=gc,Z8=rt,UO=ft,zO="",ew="normal";function tw(e){e.fillText(this.partialText,0,0)}function rw(e){e.strokeText(this.partialText,0,0)}class Dr extends jO.Shape{constructor(t){super(t),this.dummyCanvas=_g.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Kc.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const r=this.pathLength;return t-1>r?null:Kc.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Kc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&t.beginPath();for(let s=0;s<a.length;s++){t.save();const o=a[s].p0;t.translate(o.x,o.y),t.rotate(a[s].rotation),this.partialText=a[s].text,t.fillStrokeShape(this),r==="underline"&&(s===0&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}r==="underline"&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return _g.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Sg.Text.prototype.setText.call(this,t)}_getContextFont(){return Sg.Text.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const u=(0,Sg.stringToArray)(this.text());let f=o;for(let d=0;d<u.length;d++){const p=this._getPointAtLength(f);if(!p)return;let m=this._getTextSize(u[d]).width+n;if(u[d]===" "&&i==="justify"){const S=this.text().split(" ").length-1;m+=(this.pathLength-s)/S}const v=this._getPointAtLength(f+m);if(!v)return;const g=Kc.Path.getLineLength(p.x,p.y,v.x,v.y);let y=0;if(a)try{y=a(u[d-1],u[d])*this.fontSize()}catch{y=0}p.x+=y,v.x+=y,this.textWidth+=y;const C=Kc.Path.getPointOnLine(y+g/2,p.x,p.y,v.x,v.y),E=Math.atan2(v.y-p.y,v.x-p.x);this.glyphInfo.push({transposeX:C.x,transposeY:C.y,text:u[d],rotation:E,p0:p,p1:v}),f+=m}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(f){t.push(f.p0.x),t.push(f.p0.y),t.push(f.p1.x),t.push(f.p1.y)});let r=t[0]||0,n=t[0]||0,i=t[1]||0,a=t[1]||0,s,o;for(let f=0;f<t.length/2;f++)s=t[f*2],o=t[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const u=this.fontSize();return{x:r-u/2,y:i-u/2,width:n-r+u,height:a-i+u}}destroy(){return _g.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Vh.TextPath=Dr;Dr.prototype._fillFunc=tw;Dr.prototype._strokeFunc=rw;Dr.prototype._fillFuncHit=tw;Dr.prototype._strokeFuncHit=rw;Dr.prototype.className="TextPath";Dr.prototype._attrsAffectingSize=["text","fontSize","data"];(0,UO._registerNode)(Dr);Qi.Factory.addGetterSetter(Dr,"data");Qi.Factory.addGetterSetter(Dr,"fontFamily","Arial");Qi.Factory.addGetterSetter(Dr,"fontSize",12,(0,Z8.getNumberValidator)());Qi.Factory.addGetterSetter(Dr,"fontStyle",ew);Qi.Factory.addGetterSetter(Dr,"align","left");Qi.Factory.addGetterSetter(Dr,"letterSpacing",0,(0,Z8.getNumberValidator)());Qi.Factory.addGetterSetter(Dr,"textBaseline","middle");Qi.Factory.addGetterSetter(Dr,"fontVariant",ew);Qi.Factory.addGetterSetter(Dr,"text",zO);Qi.Factory.addGetterSetter(Dr,"textDecoration","");Qi.Factory.addGetterSetter(Dr,"kerningFunc",void 0);var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.Transformer=void 0;const Mt=ir,Nt=ht,q3=Jt,VO=Ir,GO=Su,J3=fc,Mi=ft,Ks=rt,HO=ft,nw="tr-konva",WO=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${nw}`).join(" "),Z3="nodesRect",$O=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],XO={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},KO="ontouchstart"in Mi.Konva._global;function YO(e,t,r){if(e==="rotater")return r;t+=Mt.Util.degToRad(XO[e]||0);const n=(Mt.Util.radToDeg(t)%360+360)%360;return Mt.Util._inRange(n,315+22.5,360)||Mt.Util._inRange(n,0,22.5)?"ns-resize":Mt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Mt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Mt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Mt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Mt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Mt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Mt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Mt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Xd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],e5=1e8;function QO(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function iw(e,t,r){const n=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),i=r.y+(e.x-r.x)*Math.sin(t)+(e.y-r.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:n,y:i}}function qO(e,t){const r=QO(e);return iw(e,t,r)}function JO(e,t,r){let n=t;for(let i=0;i<e.length;i++){const a=Mi.Konva.getAngle(e[i]),s=Math.abs(a-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let zm=0;class _t extends J3.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(WO,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Mt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return nw+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const r=t.filter(i=>i.isAncestorOf(this)?(Mt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=r,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on($O.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let r;t.on(`dragstart.${this._getEventNamespace()}`,n=>{r=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=t.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const u=o.getAbsolutePosition();o.setAbsolutePosition({x:u.x+a,y:u.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Z3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Z3,this.__getNodeRect)}__getNodeShape(t,r=this.rotation(),n){const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),o=i.x*a.x-t.offsetX()*a.x,u=i.y*a.y-t.offsetY()*a.y,f=(Mi.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+o*Math.cos(f)+u*Math.sin(-f),y:s.y+u*Math.cos(f)+o*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return iw(d,-Mi.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-e5,y:-e5,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),p=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],m=f.getAbsoluteTransform();p.forEach(function(v){const g=m.point(v);r.push(g)})});const n=new Mt.Transform;n.rotate(-Mi.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),n.invert();const u=n.point({x:i,y:a});return{x:u.x,y:u.y,width:s-i,height:o-a,rotation:Mi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Xd.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const r=new GO.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:KO?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=Mi.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=YO(t,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const t=new VO.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*Mt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",r=>{r.cancelBubble=!0}),t.on("dragmove",r=>{r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},zm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:t.evt,target:u})})}_handleMouseMove(t){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let u={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,t)),a.setAbsolutePosition(u);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const S=this._getNodeRect();r=a.x()-S.width/2,n=-a.y()+S.height/2;let x=Math.atan2(-n,r)+Math.PI/2;S.height<0&&(x-=Math.PI);const F=Mi.Konva.getAngle(this.rotation())+x,N=Mi.Konva.getAngle(this.rotationSnapTolerance()),P=JO(this.rotationSnaps(),F,N)-S.rotation,b=qO(S,P);this._fitNodesInto(b,t);return}const p=this.shiftBehavior();let m;p==="inverted"?m=this.keepRatio()&&!t.shiftKey:p==="none"?m=this.keepRatio():m=this.keepRatio()||t.shiftKey;let v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(S.x-a.x(),2)+Math.pow(S.y-a.y(),2));const x=this.findOne(".top-left").x()>S.x?-1:1,T=this.findOne(".top-left").y()>S.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-left").x(S.x-r),this.findOne(".top-left").y(S.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-S.x,2)+Math.pow(S.y-a.y(),2));const x=this.findOne(".top-right").x()<S.x?-1:1,T=this.findOne(".top-right").y()>S.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-right").x(S.x+r),this.findOne(".top-right").y(S.y-n)}var g=a.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(S.x-a.x(),2)+Math.pow(a.y()-S.y,2));const x=S.x<a.x()?-1:1,T=a.y()<S.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,a.x(S.x-r),a.y(S.y+n)}g=a.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(m){const S=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-S.x,2)+Math.pow(a.y()-S.y,2));const x=this.findOne(".bottom-right").x()<S.x?-1:1,T=this.findOne(".bottom-right").y()<S.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".bottom-right").x(S.x+r),this.findOne(".bottom-right").y(S.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(v=this.centeredScaling()||t.altKey,v){const S=this.findOne(".top-left"),x=this.findOne(".bottom-right"),T=S.x(),F=S.y(),N=this.getWidth()-x.x(),A=this.getHeight()-x.y();x.move({x:-T,y:-F}),S.move({x:N,y:A})}const y=this.findOne(".top-left").getAbsolutePosition();r=y.x,n=y.y;const C=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),E=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:C,height:E,rotation:Mi.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();zm--,this._fire("transformend",{evt:t,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:t,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,r){const n=this._getNodeRect(),i=1;if(Mt.Util._inRange(t.width,-this.padding()*2-i,i)){this.update();return}if(Mt.Util._inRange(t.height,-this.padding()*2-i,i)){this.update();return}const a=new Mt.Transform;if(a.rotate(Mi.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const m=a.point({x:-this.padding()*2,y:0});t.x+=m.x,t.y+=m.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const m=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const m=a.point({x:0,y:-this.padding()*2});t.x+=m.x,t.y+=m.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const m=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=m.x,this._anchorDragOffset.y-=m.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const m=this.boundBoxFunc()(n,t);m?t=m:Mt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new Mt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const u=new Mt.Transform,f=t.width/s,d=t.height/s;this.flipEnabled()===!1?(u.translate(t.x,t.y),u.rotate(t.rotation),u.translate(t.width<0?t.width:0,t.height<0?t.height:0),u.scale(Math.abs(f),Math.abs(d))):(u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(f,d));const p=u.multiply(o.invert());this._nodes.forEach(m=>{var v;const g=m.getParent().getAbsoluteTransform(),y=m.getTransform().copy();y.translate(m.offsetX(),m.offsetY());const C=new Mt.Transform;C.multiply(g.copy().invert()).multiply(p).multiply(g).multiply(y);const E=C.decompose();m.setAttrs(E),(v=m.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(Mt.Util._getRotation(t.rotation)),this._nodes.forEach(m=>{this._fire("transform",{evt:r,target:m}),m._fire("transform",{evt:r,target:m})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,r){this.findOne(t).setAttrs(r)}update(){var t;const r=this._getNodeRect();this.rotation(Mt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(p=>{p.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+o,offsetY:u/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-o,offsetY:u/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Mt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(p=>{d(p)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),J3.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return q3.Node.prototype.toObject.call(this)}clone(t){return q3.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Gh.Transformer=_t;_t.isTransforming=()=>zm>0;function ZO(e){return e instanceof Array||Mt.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Xd.indexOf(t)===-1&&Mt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Xd.join(", "))}),e||[]}_t.prototype.className="Transformer";(0,HO._registerNode)(_t);Nt.Factory.addGetterSetter(_t,"enabledAnchors",Xd,ZO);Nt.Factory.addGetterSetter(_t,"flipEnabled",!0,(0,Ks.getBooleanValidator)());Nt.Factory.addGetterSetter(_t,"resizeEnabled",!0);Nt.Factory.addGetterSetter(_t,"anchorSize",10,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"rotateEnabled",!0);Nt.Factory.addGetterSetter(_t,"rotateLineVisible",!0);Nt.Factory.addGetterSetter(_t,"rotationSnaps",[]);Nt.Factory.addGetterSetter(_t,"rotateAnchorOffset",50,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"rotateAnchorCursor","crosshair");Nt.Factory.addGetterSetter(_t,"rotationSnapTolerance",5,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"borderEnabled",!0);Nt.Factory.addGetterSetter(_t,"anchorStroke","rgb(0, 161, 255)");Nt.Factory.addGetterSetter(_t,"anchorStrokeWidth",1,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"anchorFill","white");Nt.Factory.addGetterSetter(_t,"anchorCornerRadius",0,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"borderStroke","rgb(0, 161, 255)");Nt.Factory.addGetterSetter(_t,"borderStrokeWidth",1,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"borderDash");Nt.Factory.addGetterSetter(_t,"keepRatio",!0);Nt.Factory.addGetterSetter(_t,"shiftBehavior","default");Nt.Factory.addGetterSetter(_t,"centeredScaling",!1);Nt.Factory.addGetterSetter(_t,"ignoreStroke",!1);Nt.Factory.addGetterSetter(_t,"padding",0,(0,Ks.getNumberValidator)());Nt.Factory.addGetterSetter(_t,"nodes");Nt.Factory.addGetterSetter(_t,"node");Nt.Factory.addGetterSetter(_t,"boundBoxFunc");Nt.Factory.addGetterSetter(_t,"anchorDragBoundFunc");Nt.Factory.addGetterSetter(_t,"anchorStyleFunc");Nt.Factory.addGetterSetter(_t,"shouldOverdrawWholeArea",!1);Nt.Factory.addGetterSetter(_t,"useSingleNodeRotation",!0);Nt.Factory.backCompat(_t,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Wedge=void 0;const Wh=ht,eL=Ir,tL=ft,aw=rt,rL=ft;class Ja extends eL.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,tL.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Hh.Wedge=Ja;Ja.prototype.className="Wedge";Ja.prototype._centroid=!0;Ja.prototype._attrsAffectingSize=["radius"];(0,rL._registerNode)(Ja);Wh.Factory.addGetterSetter(Ja,"radius",0,(0,aw.getNumberValidator)());Wh.Factory.addGetterSetter(Ja,"angle",0,(0,aw.getNumberValidator)());Wh.Factory.addGetterSetter(Ja,"clockwise",!1);Wh.Factory.backCompat(Ja,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.Blur=void 0;const t5=ht,nL=Jt,iL=rt;function r5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const aL=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],sL=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function oL(e,t){const r=e.data,n=e.width,i=e.height;let a,s,o,u,f,d,p,m,v,g,y,C,E,S,x,T,F,N,A,P;const b=t+t+1,I=n-1,O=i-1,j=t+1,q=j*(j+1)/2,ie=new r5,te=aL[t],Ae=sL[t];let Ee=null,re=ie,X=null,he=null;for(let Te=1;Te<b;Te++)re=re.next=new r5,Te===j&&(Ee=re);re.next=ie,o=s=0;for(let Te=0;Te<i;Te++){C=E=S=x=u=f=d=p=0,m=j*(T=r[s]),v=j*(F=r[s+1]),g=j*(N=r[s+2]),y=j*(A=r[s+3]),u+=q*T,f+=q*F,d+=q*N,p+=q*A,re=ie;for(let L=0;L<j;L++)re.r=T,re.g=F,re.b=N,re.a=A,re=re.next;for(let L=1;L<j;L++)a=s+((I<L?I:L)<<2),u+=(re.r=T=r[a])*(P=j-L),f+=(re.g=F=r[a+1])*P,d+=(re.b=N=r[a+2])*P,p+=(re.a=A=r[a+3])*P,C+=T,E+=F,S+=N,x+=A,re=re.next;X=ie,he=Ee;for(let L=0;L<n;L++)r[s+3]=A=p*te>>Ae,A!==0?(A=255/A,r[s]=(u*te>>Ae)*A,r[s+1]=(f*te>>Ae)*A,r[s+2]=(d*te>>Ae)*A):r[s]=r[s+1]=r[s+2]=0,u-=m,f-=v,d-=g,p-=y,m-=X.r,v-=X.g,g-=X.b,y-=X.a,a=o+((a=L+t+1)<I?a:I)<<2,C+=X.r=r[a],E+=X.g=r[a+1],S+=X.b=r[a+2],x+=X.a=r[a+3],u+=C,f+=E,d+=S,p+=x,X=X.next,m+=T=he.r,v+=F=he.g,g+=N=he.b,y+=A=he.a,C-=T,E-=F,S-=N,x-=A,he=he.next,s+=4;o+=n}for(let Te=0;Te<n;Te++){E=S=x=C=f=d=p=u=0,s=Te<<2,m=j*(T=r[s]),v=j*(F=r[s+1]),g=j*(N=r[s+2]),y=j*(A=r[s+3]),u+=q*T,f+=q*F,d+=q*N,p+=q*A,re=ie;for(let Q=0;Q<j;Q++)re.r=T,re.g=F,re.b=N,re.a=A,re=re.next;let L=n;for(let Q=1;Q<=t;Q++)s=L+Te<<2,u+=(re.r=T=r[s])*(P=j-Q),f+=(re.g=F=r[s+1])*P,d+=(re.b=N=r[s+2])*P,p+=(re.a=A=r[s+3])*P,C+=T,E+=F,S+=N,x+=A,re=re.next,Q<O&&(L+=n);s=Te,X=ie,he=Ee;for(let Q=0;Q<i;Q++)a=s<<2,r[a+3]=A=p*te>>Ae,A>0?(A=255/A,r[a]=(u*te>>Ae)*A,r[a+1]=(f*te>>Ae)*A,r[a+2]=(d*te>>Ae)*A):r[a]=r[a+1]=r[a+2]=0,u-=m,f-=v,d-=g,p-=y,m-=X.r,v-=X.g,g-=X.b,y-=X.a,a=Te+((a=Q+j)<O?a:O)*n<<2,u+=C+=X.r=r[a],f+=E+=X.g=r[a+1],d+=S+=X.b=r[a+2],p+=x+=X.a=r[a+3],X=X.next,m+=T=he.r,v+=F=he.g,g+=N=he.b,y+=A=he.a,C-=T,E-=F,S-=N,x-=A,he=he.next,s+=n}}const lL=function(t){const r=Math.round(this.blurRadius());r>0&&oL(t,r)};$h.Blur=lL;t5.Factory.addGetterSetter(nL.Node,"blurRadius",0,(0,iL.getNumberValidator)(),t5.Factory.afterSetFilter);var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.Brighten=void 0;const n5=ht,cL=Jt,uL=rt,fL=function(e){const t=this.brightness()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=t,r[i+1]+=t,r[i+2]+=t};Xh.Brighten=fL;n5.Factory.addGetterSetter(cL.Node,"brightness",0,(0,uL.getNumberValidator)(),n5.Factory.afterSetFilter);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Contrast=void 0;const i5=ht,dL=Jt,hL=rt,pL=function(e){const t=Math.pow((this.contrast()+100)/100,2),r=e.data,n=r.length;let i=150,a=150,s=150;for(let o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};Kh.Contrast=pL;i5.Factory.addGetterSetter(dL.Node,"contrast",0,(0,hL.getNumberValidator)(),i5.Factory.afterSetFilter);var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Emboss=void 0;const Bs=ht,Qh=Jt,gL=ir,sw=rt,mL=function(e){const t=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=e.data,s=e.width,o=e.height,u=s*4;let f=0,d=0,p=o;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:gL.Util.error("Unknown emboss direction: "+n)}do{const m=(p-1)*u;let v=f;p+v<1&&(v=0),p+v>o&&(v=0);const g=(p-1+v)*s*4;let y=s;do{const C=m+(y-1)*4;let E=d;y+E<1&&(E=0),y+E>s&&(E=0);const S=g+(y-1+E)*4,x=a[C]-a[S],T=a[C+1]-a[S+1],F=a[C+2]-a[S+2];let N=x;const A=N>0?N:-N,P=T>0?T:-T,b=F>0?F:-F;if(P>A&&(N=T),b>A&&(N=F),N*=t,i){const I=a[C]+N,O=a[C+1]+N,j=a[C+2]+N;a[C]=I>255?255:I<0?0:I,a[C+1]=O>255?255:O<0?0:O,a[C+2]=j>255?255:j<0?0:j}else{let I=r-N;I<0?I=0:I>255&&(I=255),a[C]=a[C+1]=a[C+2]=I}}while(--y)}while(--p)};Yh.Emboss=mL;Bs.Factory.addGetterSetter(Qh.Node,"embossStrength",.5,(0,sw.getNumberValidator)(),Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(Qh.Node,"embossWhiteLevel",.5,(0,sw.getNumberValidator)(),Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(Qh.Node,"embossDirection","top-left",void 0,Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(Qh.Node,"embossBlend",!1,void 0,Bs.Factory.afterSetFilter);var qh={};Object.defineProperty(qh,"__esModule",{value:!0});qh.Enhance=void 0;const a5=ht,xL=Jt,vL=rt;function wg(e,t,r,n,i){const a=r-t,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let o=(e-t)/a;return o=s*o+n,o}const yL=function(e){const t=e.data,r=t.length;let n=t[0],i=n,a,s=t[1],o=s,u,f=t[2],d=f,p;const m=this.enhance();if(m===0)return;for(let x=0;x<r;x+=4)a=t[x+0],a<n?n=a:a>i&&(i=a),u=t[x+1],u<s?s=u:u>o&&(o=u),p=t[x+2],p<f?f=p:p>d&&(d=p);i===n&&(i=255,n=0),o===s&&(o=255,s=0),d===f&&(d=255,f=0);let v,g,y,C,E,S;if(m>0)v=i+m*(255-i),g=n-m*(n-0),y=o+m*(255-o),C=s-m*(s-0),E=d+m*(255-d),S=f-m*(f-0);else{const x=(i+n)*.5;v=i+m*(i-x),g=n+m*(n-x);const T=(o+s)*.5;y=o+m*(o-T),C=s+m*(s-T);const F=(d+f)*.5;E=d+m*(d-F),S=f+m*(f-F)}for(let x=0;x<r;x+=4)t[x+0]=wg(t[x+0],n,i,g,v),t[x+1]=wg(t[x+1],s,o,C,y),t[x+2]=wg(t[x+2],f,d,S,E)};qh.Enhance=yL;a5.Factory.addGetterSetter(xL.Node,"enhance",0,(0,vL.getNumberValidator)(),a5.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Grayscale=void 0;const _L=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=i,t[n+1]=i,t[n+2]=i}};Jh.Grayscale=_L;var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.HSL=void 0;const tc=ht,Ex=Jt,Tx=rt;tc.Factory.addGetterSetter(Ex.Node,"hue",0,(0,Tx.getNumberValidator)(),tc.Factory.afterSetFilter);tc.Factory.addGetterSetter(Ex.Node,"saturation",0,(0,Tx.getNumberValidator)(),tc.Factory.afterSetFilter);tc.Factory.addGetterSetter(Ex.Node,"luminance",0,(0,Tx.getNumberValidator)(),tc.Factory.afterSetFilter);const SL=function(e){const t=e.data,r=t.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*o+.167*u,d=.587*n-.587*o+.33*u,p=.114*n-.114*o-.497*u,m=.299*n-.299*o-.328*u,v=.587*n+.413*o+.035*u,g=.114*n-.114*o+.293*u,y=.299*n-.3*o+1.25*u,C=.587*n-.586*o-1.05*u,E=.114*n+.886*o-.2*u;let S,x,T,F;for(let N=0;N<r;N+=4)S=t[N+0],x=t[N+1],T=t[N+2],F=t[N+3],t[N+0]=f*S+d*x+p*T+s,t[N+1]=m*S+v*x+g*T+s,t[N+2]=y*S+C*x+E*T+s,t[N+3]=F};Zh.HSL=SL;var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.HSV=void 0;const rc=ht,Ax=Jt,Px=rt,wL=function(e){const t=e.data,r=t.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*s+.167*o,f=.587*n-.587*s+.33*o,d=.114*n-.114*s-.497*o,p=.299*n-.299*s-.328*o,m=.587*n+.413*s+.035*o,v=.114*n-.114*s+.293*o,g=.299*n-.3*s+1.25*o,y=.587*n-.586*s-1.05*o,C=.114*n+.886*s-.2*o;for(let E=0;E<r;E+=4){const S=t[E+0],x=t[E+1],T=t[E+2],F=t[E+3];t[E+0]=u*S+f*x+d*T,t[E+1]=p*S+m*x+v*T,t[E+2]=g*S+y*x+C*T,t[E+3]=F}};e1.HSV=wL;rc.Factory.addGetterSetter(Ax.Node,"hue",0,(0,Px.getNumberValidator)(),rc.Factory.afterSetFilter);rc.Factory.addGetterSetter(Ax.Node,"saturation",0,(0,Px.getNumberValidator)(),rc.Factory.afterSetFilter);rc.Factory.addGetterSetter(Ax.Node,"value",0,(0,Px.getNumberValidator)(),rc.Factory.afterSetFilter);var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.Invert=void 0;const kL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};t1.Invert=kL;var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Kaleidoscope=void 0;const Kd=ht,ow=Jt,s5=ir,lw=rt,CL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const m=Math.sqrt(d*d+p*p);f=m>f?m:f;const v=s,g=a,y=360/g*Math.PI/180;for(let C=0;C<g;C+=1){const E=Math.sin(C*y),S=Math.cos(C*y);for(let x=0;x<v;x+=1){d=Math.floor(o+f*x/v*S),p=Math.floor(u+f*x/v*E);let T=(p*a+d)*4;const F=n[T+0],N=n[T+1],A=n[T+2],P=n[T+3];T=(C+x*a)*4,i[T+0]=F,i[T+1]=N,i[T+2]=A,i[T+3]=P}}},EL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const m=Math.sqrt(d*d+p*p);f=m>f?m:f;const v=s,g=a,y=r.polarRotation||0;let C,E;for(d=0;d<a;d+=1)for(p=0;p<s;p+=1){const S=d-o,x=p-u,T=Math.sqrt(S*S+x*x)*v/f;let F=(Math.atan2(x,S)*180/Math.PI+360+y)%360;F=F*g/360,C=Math.floor(F),E=Math.floor(T);let N=(E*a+C)*4;const A=n[N+0],P=n[N+1],b=n[N+2],I=n[N+3];N=(p*a+d)*4,i[N+0]=A,i[N+1]=P,i[N+2]=b,i[N+3]=I}},TL=function(e){const t=e.width,r=e.height;let n,i,a,s,o,u,f,d,p,m,v=Math.round(this.kaleidoscopePower());const g=Math.round(this.kaleidoscopeAngle()),y=Math.floor(t*(g%360)/360);if(v<1)return;const C=s5.Util.createCanvasElement();C.width=t,C.height=r;const E=C.getContext("2d").getImageData(0,0,t,r);s5.Util.releaseCanvas(C),CL(e,E,{polarCenterX:t/2,polarCenterY:r/2});let S=t/Math.pow(2,v);for(;S<=8;)S=S*2,v-=1;S=Math.ceil(S);let x=S,T=0,F=x,N=1;for(y+S>t&&(T=x,F=0,N=-1),i=0;i<r;i+=1)for(n=T;n!==F;n+=N)a=Math.round(n+y)%t,p=(t*i+a)*4,o=E.data[p+0],u=E.data[p+1],f=E.data[p+2],d=E.data[p+3],m=(t*i+n)*4,E.data[m+0]=o,E.data[m+1]=u,E.data[m+2]=f,E.data[m+3]=d;for(i=0;i<r;i+=1)for(x=Math.floor(S),s=0;s<v;s+=1){for(n=0;n<x+1;n+=1)p=(t*i+n)*4,o=E.data[p+0],u=E.data[p+1],f=E.data[p+2],d=E.data[p+3],m=(t*i+x*2-n-1)*4,E.data[m+0]=o,E.data[m+1]=u,E.data[m+2]=f,E.data[m+3]=d;x*=2}EL(E,e,{polarRotation:0})};r1.Kaleidoscope=TL;Kd.Factory.addGetterSetter(ow.Node,"kaleidoscopePower",2,(0,lw.getNumberValidator)(),Kd.Factory.afterSetFilter);Kd.Factory.addGetterSetter(ow.Node,"kaleidoscopeAngle",0,(0,lw.getNumberValidator)(),Kd.Factory.afterSetFilter);var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Mask=void 0;const o5=ht,AL=Jt,PL=rt;function $f(e,t,r){let n=(r*e.width+t)*4;const i=[];return i.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),i}function Yc(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function NL(e){const t=[0,0,0];for(let r=0;r<e.length;r++)t[0]+=e[r][0],t[1]+=e[r][1],t[2]+=e[r][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function FL(e,t){const r=$f(e,0,0),n=$f(e,e.width-1,0),i=$f(e,0,e.height-1),a=$f(e,e.width-1,e.height-1),s=t||10;if(Yc(r,n)<s&&Yc(n,a)<s&&Yc(a,i)<s&&Yc(i,r)<s){const o=NL([n,r,a,i]),u=[];for(let f=0;f<e.width*e.height;f++){const d=Yc(o,[e.data[f*4],e.data[f*4+1],e.data[f*4+2]]);u[f]=d<s?0:255}return u}}function RL(e,t){for(let r=0;r<e.width*e.height;r++)e.data[4*r+3]=t[r]}function bL(e,t,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const y=v*t+g,C=n[p*i+m];d+=e[y]*C}}s[f]=d===255*8?255:0}return s}function IL(e,t,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const y=v*t+g,C=n[p*i+m];d+=e[y]*C}}s[f]=d>=255*4?255:0}return s}function DL(e,t,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let m=0;m<i;m++){const v=o+p-a,g=u+m-a;if(v>=0&&v<r&&g>=0&&g<t){const y=v*t+g,C=n[p*i+m];d+=e[y]*C}}s[f]=d}return s}const OL=function(e){const t=this.threshold();let r=FL(e,t);return r&&(r=bL(r,e.width,e.height),r=IL(r,e.width,e.height),r=DL(r,e.width,e.height),RL(e,r)),e};n1.Mask=OL;o5.Factory.addGetterSetter(AL.Node,"threshold",0,(0,PL.getNumberValidator)(),o5.Factory.afterSetFilter);var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.Noise=void 0;const l5=ht,LL=Jt,ML=rt,BL=function(e){const t=this.noise()*255,r=e.data,n=r.length,i=t/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};i1.Noise=BL;l5.Factory.addGetterSetter(LL.Node,"noise",.2,(0,ML.getNumberValidator)(),l5.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.Pixelate=void 0;const c5=ht,jL=ir,UL=Jt,zL=rt,VL=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,n=e.height,i=Math.ceil(r/t),a=Math.ceil(n/t),s=e.data;if(t<=0){jL.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let u=0;u<a;u+=1){let f=0,d=0,p=0,m=0;const v=o*t,g=v+t,y=u*t,C=y+t;let E=0;for(let S=v;S<g;S+=1)if(!(S>=r))for(let x=y;x<C;x+=1){if(x>=n)continue;const T=(r*x+S)*4;f+=s[T+0],d+=s[T+1],p+=s[T+2],m+=s[T+3],E+=1}f=f/E,d=d/E,p=p/E,m=m/E;for(let S=v;S<g;S+=1)if(!(S>=r))for(let x=y;x<C;x+=1){if(x>=n)continue;const T=(r*x+S)*4;s[T+0]=f,s[T+1]=d,s[T+2]=p,s[T+3]=m}}};a1.Pixelate=VL;c5.Factory.addGetterSetter(UL.Node,"pixelSize",8,(0,zL.getNumberValidator)(),c5.Factory.afterSetFilter);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.Posterize=void 0;const u5=ht,GL=Jt,HL=rt,WL=function(e){const t=Math.round(this.levels()*254)+1,r=e.data,n=r.length,i=255/t;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};s1.Posterize=WL;u5.Factory.addGetterSetter(GL.Node,"levels",.5,(0,HL.getNumberValidator)(),u5.Factory.afterSetFilter);var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.RGB=void 0;const Yd=ht,Nx=Jt,$L=rt,XL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const o=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=o*n,t[s+1]=o*i,t[s+2]=o*a,t[s+3]=t[s+3]}};o1.RGB=XL;Yd.Factory.addGetterSetter(Nx.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Yd.Factory.addGetterSetter(Nx.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Yd.Factory.addGetterSetter(Nx.Node,"blue",0,$L.RGBComponent,Yd.Factory.afterSetFilter);var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.RGBA=void 0;const iu=ht,c1=Jt,KL=rt,YL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const u=1-s;t[o]=n*s+t[o]*u,t[o+1]=i*s+t[o+1]*u,t[o+2]=a*s+t[o+2]*u}};l1.RGBA=YL;iu.Factory.addGetterSetter(c1.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});iu.Factory.addGetterSetter(c1.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});iu.Factory.addGetterSetter(c1.Node,"blue",0,KL.RGBComponent,iu.Factory.afterSetFilter);iu.Factory.addGetterSetter(c1.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var u1={};Object.defineProperty(u1,"__esModule",{value:!0});u1.Sepia=void 0;const QL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=t[n+0],a=t[n+1],s=t[n+2];t[n+0]=Math.min(255,i*.393+a*.769+s*.189),t[n+1]=Math.min(255,i*.349+a*.686+s*.168),t[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};u1.Sepia=QL;var f1={};Object.defineProperty(f1,"__esModule",{value:!0});f1.Solarize=void 0;const qL=function(e){const t=e.data,r=e.width,n=e.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const u=s+(o-1)*4;let f=t[u],d=t[u+1],p=t[u+2];f>127&&(f=255-f),d>127&&(d=255-d),p>127&&(p=255-p),t[u]=f,t[u+1]=d,t[u+2]=p}while(--o)}while(--a)};f1.Solarize=qL;var d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.Threshold=void 0;const f5=ht,JL=Jt,ZL=rt,eM=function(e){const t=this.threshold()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<t?0:255};d1.Threshold=eM;f5.Factory.addGetterSetter(JL.Node,"threshold",.5,(0,ZL.getNumberValidator)(),f5.Factory.afterSetFilter);Object.defineProperty(wh,"__esModule",{value:!0});wh.Konva=void 0;const d5=Wd,tM=Ah,rM=Fh,nM=Ih,iM=Dh,aM=Oh,h5=ec,sM=yu,oM=hc,lM=Su,cM=Bh,uM=jh,fM=Uh,dM=zh,hM=gc,pM=Vh,gM=Gh,mM=Hh,xM=$h,vM=Xh,yM=Kh,_M=Yh,SM=qh,wM=Jh,kM=Zh,CM=e1,EM=t1,TM=r1,AM=n1,PM=i1,NM=a1,FM=s1,RM=o1,bM=l1,IM=u1,DM=f1,OM=d1;wh.Konva=d5.Konva.Util._assign(d5.Konva,{Arc:tM.Arc,Arrow:rM.Arrow,Circle:nM.Circle,Ellipse:iM.Ellipse,Image:aM.Image,Label:h5.Label,Tag:h5.Tag,Line:sM.Line,Path:oM.Path,Rect:lM.Rect,RegularPolygon:cM.RegularPolygon,Ring:uM.Ring,Sprite:fM.Sprite,Star:dM.Star,Text:hM.Text,TextPath:pM.TextPath,Transformer:gM.Transformer,Wedge:mM.Wedge,Filters:{Blur:xM.Blur,Brighten:vM.Brighten,Contrast:yM.Contrast,Emboss:_M.Emboss,Enhance:SM.Enhance,Grayscale:wM.Grayscale,HSL:kM.HSL,HSV:CM.HSV,Invert:EM.Invert,Kaleidoscope:TM.Kaleidoscope,Mask:AM.Mask,Noise:PM.Noise,Pixelate:NM.Pixelate,Posterize:FM.Posterize,RGB:RM.RGB,RGBA:bM.RGBA,Sepia:IM.Sepia,Solarize:DM.Solarize,Threshold:OM.Threshold}});var LM=N8.exports;Object.defineProperty(LM,"__esModule",{value:!0});const MM=wh;N8.exports=MM.Konva;var Vm={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=Wd;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Wd;e.exports=n.Konva})(Vm,Vm.exports);var BM=Vm.exports;const au=Qd(BM);var cw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jM=function(t){var r={},n=Se,i=c0,a=Object.assign;function s(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),F=Symbol.iterator;function N(l){return l===null||typeof l!="object"?null:(l=F&&l[F]||l["@@iterator"],typeof l=="function"?l:null)}function A(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case m:return"Profiler";case p:return"StrictMode";case C:return"Suspense";case E:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case g:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case y:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case S:return c=l.displayName||null,c!==null?c:A(l.type)||"Memo";case x:c=l._payload,l=l._init;try{return A(l(c))}catch{}}return null}function P(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(c);case 8:return c===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function b(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function I(l){if(b(l)!==l)throw Error(s(188))}function O(l){var c=l.alternate;if(!c){if(c=b(l),c===null)throw Error(s(188));return c!==l?null:l}for(var h=l,_=c;;){var k=h.return;if(k===null)break;var R=k.alternate;if(R===null){if(_=k.return,_!==null){h=_;continue}break}if(k.child===R.child){for(R=k.child;R;){if(R===h)return I(k),l;if(R===_)return I(k),c;R=R.sibling}throw Error(s(188))}if(h.return!==_.return)h=k,_=R;else{for(var B=!1,J=k.child;J;){if(J===h){B=!0,h=k,_=R;break}if(J===_){B=!0,_=k,h=R;break}J=J.sibling}if(!B){for(J=R.child;J;){if(J===h){B=!0,h=R,_=k;break}if(J===_){B=!0,_=R,h=k;break}J=J.sibling}if(!B)throw Error(s(189))}}if(h.alternate!==_)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?l:c}function j(l){return l=O(l),l!==null?q(l):null}function q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=q(l);if(c!==null)return c;l=l.sibling}return null}function ie(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=ie(l);if(c!==null)return c}l=l.sibling}return null}var te=Array.isArray,Ae=t.getPublicInstance,Ee=t.getRootHostContext,re=t.getChildHostContext,X=t.prepareForCommit,he=t.resetAfterCommit,Te=t.createInstance,L=t.appendInitialChild,Q=t.finalizeInitialChildren,Y=t.prepareUpdate,K=t.shouldSetTextContent,ue=t.createTextInstance,V=t.scheduleTimeout,Z=t.cancelTimeout,fe=t.noTimeout,ve=t.isPrimaryRenderer,Be=t.supportsMutation,G=t.supportsPersistence,qe=t.supportsHydration,et=t.getInstanceFromNode,Ye=t.preparePortalMount,Qe=t.getCurrentEventPriority,Fe=t.detachDeletedInstance,St=t.supportsMicrotasks,Or=t.scheduleMicrotask,gr=t.supportsTestSelectors,_e=t.findFiberRoot,me=t.getBoundingRect,ke=t.getTextContent,we=t.isHiddenSubtree,Ce=t.matchAccessibilityRole,Pe=t.setFocusIfFocusable,Me=t.setupIntersectionObserver,pe=t.appendChild,ae=t.appendChildToContainer,xe=t.commitTextUpdate,be=t.commitMount,Le=t.commitUpdate,Xe=t.insertBefore,gt=t.insertInContainerBefore,Bt=t.removeChild,jt=t.removeChildFromContainer,ar=t.resetTextContent,Za=t.hideInstance,Oe=t.hideTextInstance,Ue=t.unhideInstance,Ze=t.unhideTextInstance,at=t.clearContainer,vt=t.cloneInstance,Ft=t.createContainerChildSet,Rt=t.appendChildToContainerChildSet,qi=t.finalizeContainerChildren,en=t.replaceContainerChildren,Ji=t.cloneHiddenInstance,bn=t.cloneHiddenTextInstance,_n=t.canHydrateInstance,Ko=t.canHydrateTextInstance,es=t.canHydrateSuspenseInstance,wu=t.isSuspenseInstancePending,mc=t.isSuspenseInstanceFallback,p1=t.getSuspenseInstanceFallbackErrorDetails,D=t.registerSuspenseInstanceRetry,z=t.getNextHydratableSibling,M=t.getFirstHydratableChild,U=t.getFirstHydratableChildWithinContainer,H=t.getFirstHydratableChildWithinSuspenseInstance,W=t.hydrateInstance,se=t.hydrateTextInstance,ye=t.hydrateSuspenseInstance,ne=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,le=t.commitHydratedSuspenseInstance,Ne=t.clearSuspenseBoundary,je=t.clearSuspenseBoundaryFromContainer,He=t.shouldDeleteUnhydratedTailInstances,Ie=t.didNotMatchHydratedContainerTextInstance,ze=t.didNotMatchHydratedTextInstance,nt;function It(l){if(nt===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);nt=c&&c[1]||""}return`
`+nt+l}var Ut=!1;function mr(l,c){if(!l||Ut)return"";Ut=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(De){var _=De}Reflect.construct(l,[],c)}else{try{c.call()}catch(De){_=De}l.call(c.prototype)}else{try{throw Error()}catch(De){_=De}l()}}catch(De){if(De&&_&&typeof De.stack=="string"){for(var k=De.stack.split(`
`),R=_.stack.split(`
`),B=k.length-1,J=R.length-1;1<=B&&0<=J&&k[B]!==R[J];)J--;for(;1<=B&&0<=J;B--,J--)if(k[B]!==R[J]){if(B!==1||J!==1)do if(B--,J--,0>J||k[B]!==R[J]){var de=`
`+k[B].replace(" at new "," at ");return l.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",l.displayName)),de}while(1<=B&&0<=J);break}}}finally{Ut=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?It(l):""}var Qs=Object.prototype.hasOwnProperty,_a=[],ai=-1;function tn(l){return{current:l}}function Dt(l){0>ai||(l.current=_a[ai],_a[ai]=null,ai--)}function mt(l,c){ai++,_a[ai]=l.current,l.current=c}var ts={},rn=tn(ts),In=tn(!1),qs=ts;function Yo(l,c){var h=l.type.contextTypes;if(!h)return ts;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var k={},R;for(R in h)k[R]=c[R];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=k),k}function Dn(l){return l=l.childContextTypes,l!=null}function ku(){Dt(In),Dt(rn)}function bx(l,c,h){if(rn.current!==ts)throw Error(s(168));mt(rn,c),mt(In,h)}function Ix(l,c,h){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return h;_=_.getChildContext();for(var k in _)if(!(k in c))throw Error(s(108,P(l)||"Unknown",k));return a({},h,_)}function Cu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||ts,qs=rn.current,mt(rn,l),mt(In,In.current),!0}function Dx(l,c,h){var _=l.stateNode;if(!_)throw Error(s(169));h?(l=Ix(l,c,qs),_.__reactInternalMemoizedMergedChildContext=l,Dt(In),Dt(rn),mt(rn,l)):Dt(In),mt(In,h)}var Pi=Math.clz32?Math.clz32:yw,xw=Math.log,vw=Math.LN2;function yw(l){return l>>>=0,l===0?32:31-(xw(l)/vw|0)|0}var Eu=64,Tu=4194304;function xc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Au(l,c){var h=l.pendingLanes;if(h===0)return 0;var _=0,k=l.suspendedLanes,R=l.pingedLanes,B=h&268435455;if(B!==0){var J=B&~k;J!==0?_=xc(J):(R&=B,R!==0&&(_=xc(R)))}else B=h&~k,B!==0?_=xc(B):R!==0&&(_=xc(R));if(_===0)return 0;if(c!==0&&c!==_&&!(c&k)&&(k=_&-_,R=c&-c,k>=R||k===16&&(R&4194240)!==0))return c;if(_&4&&(_|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)h=31-Pi(c),k=1<<h,_|=l[h],c&=~k;return _}function _w(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sw(l,c){for(var h=l.suspendedLanes,_=l.pingedLanes,k=l.expirationTimes,R=l.pendingLanes;0<R;){var B=31-Pi(R),J=1<<B,de=k[B];de===-1?(!(J&h)||J&_)&&(k[B]=_w(J,c)):de<=c&&(l.expiredLanes|=J),R&=~J}}function g1(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Ox(){var l=Eu;return Eu<<=1,!(Eu&4194240)&&(Eu=64),l}function m1(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function vc(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Pi(c),l[c]=h}function ww(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<h;){var k=31-Pi(h),R=1<<k;c[k]=0,_[k]=-1,l[k]=-1,h&=~R}}function x1(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var _=31-Pi(h),k=1<<_;k&c|l[_]&c&&(l[_]|=c),h&=~k}}var Tt=0;function Lx(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var v1=i.unstable_scheduleCallback,Mx=i.unstable_cancelCallback,kw=i.unstable_shouldYield,Cw=i.unstable_requestPaint,Lr=i.unstable_now,y1=i.unstable_ImmediatePriority,Ew=i.unstable_UserBlockingPriority,_1=i.unstable_NormalPriority,Tw=i.unstable_IdlePriority,Pu=null,Zi=null;function Aw(l){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot(Pu,l,void 0,(l.current.flags&128)===128)}catch{}}function Pw(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Ni=typeof Object.is=="function"?Object.is:Pw,Sa=null,Nu=!1,S1=!1;function Bx(l){Sa===null?Sa=[l]:Sa.push(l)}function Nw(l){Nu=!0,Bx(l)}function ea(){if(!S1&&Sa!==null){S1=!0;var l=0,c=Tt;try{var h=Sa;for(Tt=1;l<h.length;l++){var _=h[l];do _=_(!0);while(_!==null)}Sa=null,Nu=!1}catch(k){throw Sa!==null&&(Sa=Sa.slice(l+1)),v1(y1,ea),k}finally{Tt=c,S1=!1}}return null}var Qo=[],qo=0,Fu=null,Ru=0,si=[],oi=0,Js=null,wa=1,ka="";function Zs(l,c){Qo[qo++]=Ru,Qo[qo++]=Fu,Fu=l,Ru=c}function jx(l,c,h){si[oi++]=wa,si[oi++]=ka,si[oi++]=Js,Js=l;var _=wa;l=ka;var k=32-Pi(_)-1;_&=~(1<<k),h+=1;var R=32-Pi(c)+k;if(30<R){var B=k-k%5;R=(_&(1<<B)-1).toString(32),_>>=B,k-=B,wa=1<<32-Pi(c)+k|h<<k|_,ka=R+l}else wa=1<<R|h<<k|_,ka=l}function w1(l){l.return!==null&&(Zs(l,1),jx(l,1,0))}function k1(l){for(;l===Fu;)Fu=Qo[--qo],Qo[qo]=null,Ru=Qo[--qo],Qo[qo]=null;for(;l===Js;)Js=si[--oi],si[oi]=null,ka=si[--oi],si[oi]=null,wa=si[--oi],si[oi]=null}var Wn=null,li=null,Kt=!1,yc=!1,Fi=null;function Ux(l,c){var h=hi(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function zx(l,c){switch(l.tag){case 5:return c=_n(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,li=M(c),!0):!1;case 6:return c=Ko(c,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,li=null,!0):!1;case 13:if(c=es(c),c!==null){var h=Js!==null?{id:wa,overflow:ka}:null;return l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=hi(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Wn=l,li=null,!0}return!1;default:return!1}}function C1(l){return(l.mode&1)!==0&&(l.flags&128)===0}function E1(l){if(Kt){var c=li;if(c){var h=c;if(!zx(l,c)){if(C1(l))throw Error(s(418));c=z(h);var _=Wn;c&&zx(l,c)?Ux(_,h):(l.flags=l.flags&-4097|2,Kt=!1,Wn=l)}}else{if(C1(l))throw Error(s(418));l.flags=l.flags&-4097|2,Kt=!1,Wn=l}}}function Vx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Wn=l}function bu(l){if(!qe||l!==Wn)return!1;if(!Kt)return Vx(l),Kt=!0,!1;if(l.tag!==3&&(l.tag!==5||He(l.type)&&!K(l.type,l.memoizedProps))){var c=li;if(c){if(C1(l))throw Gx(),Error(s(418));for(;c;)Ux(l,c),c=z(c)}}if(Vx(l),l.tag===13){if(!qe)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));li=ne(l)}else li=Wn?z(l.stateNode):null;return!0}function Gx(){for(var l=li;l;)l=z(l)}function Jo(){qe&&(li=Wn=null,yc=Kt=!1)}function T1(l){Fi===null?Fi=[l]:Fi.push(l)}var Fw=o.ReactCurrentBatchConfig;function Iu(l,c){if(Ni(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),_=Object.keys(c);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var k=h[_];if(!Qs.call(c,k)||!Ni(l[k],c[k]))return!1}return!0}function Rw(l){switch(l.tag){case 5:return It(l.type);case 16:return It("Lazy");case 13:return It("Suspense");case 19:return It("SuspenseList");case 0:case 2:case 15:return l=mr(l.type,!1),l;case 11:return l=mr(l.type.render,!1),l;case 1:return l=mr(l.type,!0),l;default:return""}}function _c(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var _=h.stateNode}if(!_)throw Error(s(147,l));var k=_,R=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===R?c.ref:(c=function(B){var J=k.refs;B===null?delete J[R]:J[R]=B},c._stringRef=R,c)}if(typeof l!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,l))}return l}function Du(l,c){throw l=Object.prototype.toString.call(c),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Hx(l){var c=l._init;return c(l._payload)}function Wx(l){function c(ce,ee){if(l){var ge=ce.deletions;ge===null?(ce.deletions=[ee],ce.flags|=16):ge.push(ee)}}function h(ce,ee){if(!l)return null;for(;ee!==null;)c(ce,ee),ee=ee.sibling;return null}function _(ce,ee){for(ce=new Map;ee!==null;)ee.key!==null?ce.set(ee.key,ee):ce.set(ee.index,ee),ee=ee.sibling;return ce}function k(ce,ee){return ce=ls(ce,ee),ce.index=0,ce.sibling=null,ce}function R(ce,ee,ge){return ce.index=ge,l?(ge=ce.alternate,ge!==null?(ge=ge.index,ge<ee?(ce.flags|=2,ee):ge):(ce.flags|=2,ee)):(ce.flags|=1048576,ee)}function B(ce){return l&&ce.alternate===null&&(ce.flags|=2),ce}function J(ce,ee,ge,Ge){return ee===null||ee.tag!==6?(ee=Sp(ge,ce.mode,Ge),ee.return=ce,ee):(ee=k(ee,ge),ee.return=ce,ee)}function de(ce,ee,ge,Ge){var Je=ge.type;return Je===d?Ke(ce,ee,ge.props.children,Ge,ge.key):ee!==null&&(ee.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===x&&Hx(Je)===ee.type)?(Ge=k(ee,ge.props),Ge.ref=_c(ce,ee,ge),Ge.return=ce,Ge):(Ge=df(ge.type,ge.key,ge.props,null,ce.mode,Ge),Ge.ref=_c(ce,ee,ge),Ge.return=ce,Ge)}function De(ce,ee,ge,Ge){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ge.containerInfo||ee.stateNode.implementation!==ge.implementation?(ee=wp(ge,ce.mode,Ge),ee.return=ce,ee):(ee=k(ee,ge.children||[]),ee.return=ce,ee)}function Ke(ce,ee,ge,Ge,Je){return ee===null||ee.tag!==7?(ee=so(ge,ce.mode,Ge,Je),ee.return=ce,ee):(ee=k(ee,ge),ee.return=ce,ee)}function ot(ce,ee,ge){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Sp(""+ee,ce.mode,ge),ee.return=ce,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case u:return ge=df(ee.type,ee.key,ee.props,null,ce.mode,ge),ge.ref=_c(ce,null,ee),ge.return=ce,ge;case f:return ee=wp(ee,ce.mode,ge),ee.return=ce,ee;case x:var Ge=ee._init;return ot(ce,Ge(ee._payload),ge)}if(te(ee)||N(ee))return ee=so(ee,ce.mode,ge,null),ee.return=ce,ee;Du(ce,ee)}return null}function Ve(ce,ee,ge,Ge){var Je=ee!==null?ee.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Je!==null?null:J(ce,ee,""+ge,Ge);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:return ge.key===Je?de(ce,ee,ge,Ge):null;case f:return ge.key===Je?De(ce,ee,ge,Ge):null;case x:return Je=ge._init,Ve(ce,ee,Je(ge._payload),Ge)}if(te(ge)||N(ge))return Je!==null?null:Ke(ce,ee,ge,Ge,null);Du(ce,ge)}return null}function Wt(ce,ee,ge,Ge,Je){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return ce=ce.get(ge)||null,J(ee,ce,""+Ge,Je);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case u:return ce=ce.get(Ge.key===null?ge:Ge.key)||null,de(ee,ce,Ge,Je);case f:return ce=ce.get(Ge.key===null?ge:Ge.key)||null,De(ee,ce,Ge,Je);case x:var ut=Ge._init;return Wt(ce,ee,ge,ut(Ge._payload),Je)}if(te(Ge)||N(Ge))return ce=ce.get(ge)||null,Ke(ee,ce,Ge,Je,null);Du(ee,Ge)}return null}function zt(ce,ee,ge,Ge){for(var Je=null,ut=null,lt=ee,At=ee=0,jr=null;lt!==null&&At<ge.length;At++){lt.index>At?(jr=lt,lt=null):jr=lt.sibling;var Pt=Ve(ce,lt,ge[At],Ge);if(Pt===null){lt===null&&(lt=jr);break}l&&lt&&Pt.alternate===null&&c(ce,lt),ee=R(Pt,ee,At),ut===null?Je=Pt:ut.sibling=Pt,ut=Pt,lt=jr}if(At===ge.length)return h(ce,lt),Kt&&Zs(ce,At),Je;if(lt===null){for(;At<ge.length;At++)lt=ot(ce,ge[At],Ge),lt!==null&&(ee=R(lt,ee,At),ut===null?Je=lt:ut.sibling=lt,ut=lt);return Kt&&Zs(ce,At),Je}for(lt=_(ce,lt);At<ge.length;At++)jr=Wt(lt,ce,At,ge[At],Ge),jr!==null&&(l&&jr.alternate!==null&&lt.delete(jr.key===null?At:jr.key),ee=R(jr,ee,At),ut===null?Je=jr:ut.sibling=jr,ut=jr);return l&&lt.forEach(function(cs){return c(ce,cs)}),Kt&&Zs(ce,At),Je}function Bn(ce,ee,ge,Ge){var Je=N(ge);if(typeof Je!="function")throw Error(s(150));if(ge=Je.call(ge),ge==null)throw Error(s(151));for(var ut=Je=null,lt=ee,At=ee=0,jr=null,Pt=ge.next();lt!==null&&!Pt.done;At++,Pt=ge.next()){lt.index>At?(jr=lt,lt=null):jr=lt.sibling;var cs=Ve(ce,lt,Pt.value,Ge);if(cs===null){lt===null&&(lt=jr);break}l&&lt&&cs.alternate===null&&c(ce,lt),ee=R(cs,ee,At),ut===null?Je=cs:ut.sibling=cs,ut=cs,lt=jr}if(Pt.done)return h(ce,lt),Kt&&Zs(ce,At),Je;if(lt===null){for(;!Pt.done;At++,Pt=ge.next())Pt=ot(ce,Pt.value,Ge),Pt!==null&&(ee=R(Pt,ee,At),ut===null?Je=Pt:ut.sibling=Pt,ut=Pt);return Kt&&Zs(ce,At),Je}for(lt=_(ce,lt);!Pt.done;At++,Pt=ge.next())Pt=Wt(lt,ce,At,Pt.value,Ge),Pt!==null&&(l&&Pt.alternate!==null&&lt.delete(Pt.key===null?At:Pt.key),ee=R(Pt,ee,At),ut===null?Je=Pt:ut.sibling=Pt,ut=Pt);return l&&lt.forEach(function(ok){return c(ce,ok)}),Kt&&Zs(ce,At),Je}function Aa(ce,ee,ge,Ge){if(typeof ge=="object"&&ge!==null&&ge.type===d&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:e:{for(var Je=ge.key,ut=ee;ut!==null;){if(ut.key===Je){if(Je=ge.type,Je===d){if(ut.tag===7){h(ce,ut.sibling),ee=k(ut,ge.props.children),ee.return=ce,ce=ee;break e}}else if(ut.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===x&&Hx(Je)===ut.type){h(ce,ut.sibling),ee=k(ut,ge.props),ee.ref=_c(ce,ut,ge),ee.return=ce,ce=ee;break e}h(ce,ut);break}else c(ce,ut);ut=ut.sibling}ge.type===d?(ee=so(ge.props.children,ce.mode,Ge,ge.key),ee.return=ce,ce=ee):(Ge=df(ge.type,ge.key,ge.props,null,ce.mode,Ge),Ge.ref=_c(ce,ee,ge),Ge.return=ce,ce=Ge)}return B(ce);case f:e:{for(ut=ge.key;ee!==null;){if(ee.key===ut)if(ee.tag===4&&ee.stateNode.containerInfo===ge.containerInfo&&ee.stateNode.implementation===ge.implementation){h(ce,ee.sibling),ee=k(ee,ge.children||[]),ee.return=ce,ce=ee;break e}else{h(ce,ee);break}else c(ce,ee);ee=ee.sibling}ee=wp(ge,ce.mode,Ge),ee.return=ce,ce=ee}return B(ce);case x:return ut=ge._init,Aa(ce,ee,ut(ge._payload),Ge)}if(te(ge))return zt(ce,ee,ge,Ge);if(N(ge))return Bn(ce,ee,ge,Ge);Du(ce,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ee!==null&&ee.tag===6?(h(ce,ee.sibling),ee=k(ee,ge),ee.return=ce,ce=ee):(h(ce,ee),ee=Sp(ge,ce.mode,Ge),ee.return=ce,ce=ee),B(ce)):h(ce,ee)}return Aa}var Zo=Wx(!0),$x=Wx(!1),Ou=tn(null),Lu=null,el=null,A1=null;function P1(){A1=el=Lu=null}function Xx(l,c,h){ve?(mt(Ou,c._currentValue),c._currentValue=h):(mt(Ou,c._currentValue2),c._currentValue2=h)}function N1(l){var c=Ou.current;Dt(Ou),ve?l._currentValue=c:l._currentValue2=c}function F1(l,c,h){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===h)break;l=l.return}}function tl(l,c){Lu=l,A1=el=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(On=!0),l.firstContext=null)}function ci(l){var c=ve?l._currentValue:l._currentValue2;if(A1!==l)if(l={context:l,memoizedValue:c,next:null},el===null){if(Lu===null)throw Error(s(308));el=l,Lu.dependencies={lanes:0,firstContext:l}}else el=el.next=l;return c}var eo=null;function R1(l){eo===null?eo=[l]:eo.push(l)}function Kx(l,c,h,_){var k=c.interleaved;return k===null?(h.next=h,R1(c)):(h.next=k.next,k.next=h),c.interleaved=h,ta(l,_)}function ta(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var rs=!1;function b1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ca(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function ns(l,c,h){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,dt&2){var k=_.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),_.pending=c,ta(l,h)}return k=_.interleaved,k===null?(c.next=c,R1(_)):(c.next=k.next,k.next=c),_.interleaved=c,ta(l,h)}function Mu(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,x1(l,h)}}function Qx(l,c){var h=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var k=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var B={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};R===null?k=R=B:R=R.next=B,h=h.next}while(h!==null);R===null?k=R=c:R=R.next=c}else k=R=c;h={baseState:_.baseState,firstBaseUpdate:k,lastBaseUpdate:R,shared:_.shared,effects:_.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function Bu(l,c,h,_){var k=l.updateQueue;rs=!1;var R=k.firstBaseUpdate,B=k.lastBaseUpdate,J=k.shared.pending;if(J!==null){k.shared.pending=null;var de=J,De=de.next;de.next=null,B===null?R=De:B.next=De,B=de;var Ke=l.alternate;Ke!==null&&(Ke=Ke.updateQueue,J=Ke.lastBaseUpdate,J!==B&&(J===null?Ke.firstBaseUpdate=De:J.next=De,Ke.lastBaseUpdate=de))}if(R!==null){var ot=k.baseState;B=0,Ke=De=de=null,J=R;do{var Ve=J.lane,Wt=J.eventTime;if((_&Ve)===Ve){Ke!==null&&(Ke=Ke.next={eventTime:Wt,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var zt=l,Bn=J;switch(Ve=c,Wt=h,Bn.tag){case 1:if(zt=Bn.payload,typeof zt=="function"){ot=zt.call(Wt,ot,Ve);break e}ot=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Bn.payload,Ve=typeof zt=="function"?zt.call(Wt,ot,Ve):zt,Ve==null)break e;ot=a({},ot,Ve);break e;case 2:rs=!0}}J.callback!==null&&J.lane!==0&&(l.flags|=64,Ve=k.effects,Ve===null?k.effects=[J]:Ve.push(J))}else Wt={eventTime:Wt,lane:Ve,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Ke===null?(De=Ke=Wt,de=ot):Ke=Ke.next=Wt,B|=Ve;if(J=J.next,J===null){if(J=k.shared.pending,J===null)break;Ve=J,J=Ve.next,Ve.next=null,k.lastBaseUpdate=Ve,k.shared.pending=null}}while(1);if(Ke===null&&(de=ot),k.baseState=de,k.firstBaseUpdate=De,k.lastBaseUpdate=Ke,c=k.shared.interleaved,c!==null){k=c;do B|=k.lane,k=k.next;while(k!==c)}else R===null&&(k.shared.lanes=0);ro|=B,l.lanes=B,l.memoizedState=ot}}function qx(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],k=_.callback;if(k!==null){if(_.callback=null,_=h,typeof k!="function")throw Error(s(191,k));k.call(_)}}}var Sc={},ui=tn(Sc),wc=tn(Sc),rl=tn(Sc);function ra(l){if(l===Sc)throw Error(s(174));return l}function I1(l,c){mt(rl,c),mt(wc,l),mt(ui,Sc),l=Ee(c),Dt(ui),mt(ui,l)}function nl(){Dt(ui),Dt(wc),Dt(rl)}function Jx(l){var c=ra(rl.current),h=ra(ui.current);c=re(h,l.type,c),h!==c&&(mt(wc,l),mt(ui,c))}function D1(l){wc.current===l&&(Dt(ui),Dt(wc))}var Zt=tn(0);function ju(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||wu(h)||mc(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var O1=[];function L1(){for(var l=0;l<O1.length;l++){var c=O1[l];ve?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}O1.length=0}var Uu=o.ReactCurrentDispatcher,M1=o.ReactCurrentBatchConfig,to=0,er=null,Cr=null,Mr=null,zu=!1,kc=!1,Cc=0,bw=0;function nn(){throw Error(s(321))}function B1(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!Ni(l[h],c[h]))return!1;return!0}function j1(l,c,h,_,k,R){if(to=R,er=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Uu.current=l===null||l.memoizedState===null?Lw:Mw,l=h(_,k),kc){R=0;do{if(kc=!1,Cc=0,25<=R)throw Error(s(301));R+=1,Mr=Cr=null,c.updateQueue=null,Uu.current=Bw,l=h(_,k)}while(kc)}if(Uu.current=Hu,c=Cr!==null&&Cr.next!==null,to=0,Mr=Cr=er=null,zu=!1,c)throw Error(s(300));return l}function U1(){var l=Cc!==0;return Cc=0,l}function na(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?er.memoizedState=Mr=l:Mr=Mr.next=l,Mr}function fi(){if(Cr===null){var l=er.alternate;l=l!==null?l.memoizedState:null}else l=Cr.next;var c=Mr===null?er.memoizedState:Mr.next;if(c!==null)Mr=c,Cr=l;else{if(l===null)throw Error(s(310));Cr=l,l={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Mr===null?er.memoizedState=Mr=l:Mr=Mr.next=l}return Mr}function Ec(l,c){return typeof c=="function"?c(l):c}function z1(l){var c=fi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=Cr,k=_.baseQueue,R=h.pending;if(R!==null){if(k!==null){var B=k.next;k.next=R.next,R.next=B}_.baseQueue=k=R,h.pending=null}if(k!==null){R=k.next,_=_.baseState;var J=B=null,de=null,De=R;do{var Ke=De.lane;if((to&Ke)===Ke)de!==null&&(de=de.next={lane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),_=De.hasEagerState?De.eagerState:l(_,De.action);else{var ot={lane:Ke,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null};de===null?(J=de=ot,B=_):de=de.next=ot,er.lanes|=Ke,ro|=Ke}De=De.next}while(De!==null&&De!==R);de===null?B=_:de.next=J,Ni(_,c.memoizedState)||(On=!0),c.memoizedState=_,c.baseState=B,c.baseQueue=de,h.lastRenderedState=_}if(l=h.interleaved,l!==null){k=l;do R=k.lane,er.lanes|=R,ro|=R,k=k.next;while(k!==l)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function V1(l){var c=fi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=h.dispatch,k=h.pending,R=c.memoizedState;if(k!==null){h.pending=null;var B=k=k.next;do R=l(R,B.action),B=B.next;while(B!==k);Ni(R,c.memoizedState)||(On=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),h.lastRenderedState=R}return[R,_]}function Zx(){}function ev(l,c){var h=er,_=fi(),k=c(),R=!Ni(_.memoizedState,k);if(R&&(_.memoizedState=k,On=!0),_=_.queue,G1(nv.bind(null,h,_,l),[l]),_.getSnapshot!==c||R||Mr!==null&&Mr.memoizedState.tag&1){if(h.flags|=2048,Tc(9,rv.bind(null,h,_,k,c),void 0,null),Br===null)throw Error(s(349));to&30||tv(h,c,k)}return k}function tv(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=er.updateQueue,c===null?(c={lastEffect:null,stores:null},er.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function rv(l,c,h,_){c.value=h,c.getSnapshot=_,iv(c)&&av(l)}function nv(l,c,h){return h(function(){iv(c)&&av(l)})}function iv(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!Ni(l,h)}catch{return!0}}function av(l){var c=ta(l,1);c!==null&&di(c,l,1,-1)}function sv(l){var c=na();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ec,lastRenderedState:l},c.queue=l,l=l.dispatch=Ow.bind(null,er,l),[c.memoizedState,l]}function Tc(l,c,h,_){return l={tag:l,create:c,destroy:h,deps:_,next:null},c=er.updateQueue,c===null?(c={lastEffect:null,stores:null},er.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(_=h.next,h.next=l,l.next=_,c.lastEffect=l)),l}function ov(){return fi().memoizedState}function Vu(l,c,h,_){var k=na();er.flags|=l,k.memoizedState=Tc(1|c,h,void 0,_===void 0?null:_)}function Gu(l,c,h,_){var k=fi();_=_===void 0?null:_;var R=void 0;if(Cr!==null){var B=Cr.memoizedState;if(R=B.destroy,_!==null&&B1(_,B.deps)){k.memoizedState=Tc(c,h,R,_);return}}er.flags|=l,k.memoizedState=Tc(1|c,h,R,_)}function lv(l,c){return Vu(8390656,8,l,c)}function G1(l,c){return Gu(2048,8,l,c)}function cv(l,c){return Gu(4,2,l,c)}function uv(l,c){return Gu(4,4,l,c)}function fv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function dv(l,c,h){return h=h!=null?h.concat([l]):null,Gu(4,4,fv.bind(null,c,l),h)}function H1(){}function hv(l,c){var h=fi();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&B1(c,_[1])?_[0]:(h.memoizedState=[l,c],l)}function pv(l,c){var h=fi();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&B1(c,_[1])?_[0]:(l=l(),h.memoizedState=[l,c],l)}function gv(l,c,h){return to&21?(Ni(h,c)||(h=Ox(),er.lanes|=h,ro|=h,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,On=!0),l.memoizedState=h)}function Iw(l,c){var h=Tt;Tt=h!==0&&4>h?h:4,l(!0);var _=M1.transition;M1.transition={};try{l(!1),c()}finally{Tt=h,M1.transition=_}}function mv(){return fi().memoizedState}function Dw(l,c,h){var _=ss(l);if(h={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null},xv(l))vv(c,h);else if(h=Kx(l,c,h,_),h!==null){var k=on();di(h,l,_,k),yv(h,c,_)}}function Ow(l,c,h){var _=ss(l),k={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null};if(xv(l))vv(c,k);else{var R=l.alternate;if(l.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var B=c.lastRenderedState,J=R(B,h);if(k.hasEagerState=!0,k.eagerState=J,Ni(J,B)){var de=c.interleaved;de===null?(k.next=k,R1(c)):(k.next=de.next,de.next=k),c.interleaved=k;return}}catch{}finally{}h=Kx(l,c,k,_),h!==null&&(k=on(),di(h,l,_,k),yv(h,c,_))}}function xv(l){var c=l.alternate;return l===er||c!==null&&c===er}function vv(l,c){kc=zu=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function yv(l,c,h){if(h&4194240){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,x1(l,h)}}var Hu={readContext:ci,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},Lw={readContext:ci,useCallback:function(l,c){return na().memoizedState=[l,c===void 0?null:c],l},useContext:ci,useEffect:lv,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,Vu(4194308,4,fv.bind(null,c,l),h)},useLayoutEffect:function(l,c){return Vu(4194308,4,l,c)},useInsertionEffect:function(l,c){return Vu(4,2,l,c)},useMemo:function(l,c){var h=na();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var _=na();return c=h!==void 0?h(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=Dw.bind(null,er,l),[_.memoizedState,l]},useRef:function(l){var c=na();return l={current:l},c.memoizedState=l},useState:sv,useDebugValue:H1,useDeferredValue:function(l){return na().memoizedState=l},useTransition:function(){var l=sv(!1),c=l[0];return l=Iw.bind(null,l[1]),na().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var _=er,k=na();if(Kt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=c(),Br===null)throw Error(s(349));to&30||tv(_,c,h)}k.memoizedState=h;var R={value:h,getSnapshot:c};return k.queue=R,lv(nv.bind(null,_,R,l),[l]),_.flags|=2048,Tc(9,rv.bind(null,_,R,h,c),void 0,null),h},useId:function(){var l=na(),c=Br.identifierPrefix;if(Kt){var h=ka,_=wa;h=(_&~(1<<32-Pi(_)-1)).toString(32)+h,c=":"+c+"R"+h,h=Cc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=bw++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},Mw={readContext:ci,useCallback:hv,useContext:ci,useEffect:G1,useImperativeHandle:dv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:pv,useReducer:z1,useRef:ov,useState:function(){return z1(Ec)},useDebugValue:H1,useDeferredValue:function(l){var c=fi();return gv(c,Cr.memoizedState,l)},useTransition:function(){var l=z1(Ec)[0],c=fi().memoizedState;return[l,c]},useMutableSource:Zx,useSyncExternalStore:ev,useId:mv,unstable_isNewReconciler:!1},Bw={readContext:ci,useCallback:hv,useContext:ci,useEffect:G1,useImperativeHandle:dv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:pv,useReducer:V1,useRef:ov,useState:function(){return V1(Ec)},useDebugValue:H1,useDeferredValue:function(l){var c=fi();return Cr===null?c.memoizedState=l:gv(c,Cr.memoizedState,l)},useTransition:function(){var l=V1(Ec)[0],c=fi().memoizedState;return[l,c]},useMutableSource:Zx,useSyncExternalStore:ev,useId:mv,unstable_isNewReconciler:!1};function Ri(l,c){if(l&&l.defaultProps){c=a({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function W1(l,c,h,_){c=l.memoizedState,h=h(_,c),h=h==null?c:a({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var Wu={isMounted:function(l){return(l=l._reactInternals)?b(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var _=on(),k=ss(l),R=Ca(_,k);R.payload=c,h!=null&&(R.callback=h),c=ns(l,R,k),c!==null&&(di(c,l,k,_),Mu(c,l,k))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var _=on(),k=ss(l),R=Ca(_,k);R.tag=1,R.payload=c,h!=null&&(R.callback=h),c=ns(l,R,k),c!==null&&(di(c,l,k,_),Mu(c,l,k))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=on(),_=ss(l),k=Ca(h,_);k.tag=2,c!=null&&(k.callback=c),c=ns(l,k,_),c!==null&&(di(c,l,_,h),Mu(c,l,_))}};function _v(l,c,h,_,k,R,B){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,R,B):c.prototype&&c.prototype.isPureReactComponent?!Iu(h,_)||!Iu(k,R):!0}function Sv(l,c,h){var _=!1,k=ts,R=c.contextType;return typeof R=="object"&&R!==null?R=ci(R):(k=Dn(c)?qs:rn.current,_=c.contextTypes,R=(_=_!=null)?Yo(l,k):ts),c=new c(h,R),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Wu,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=k,l.__reactInternalMemoizedMaskedChildContext=R),c}function wv(l,c,h,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,_),c.state!==l&&Wu.enqueueReplaceState(c,c.state,null)}function $1(l,c,h,_){var k=l.stateNode;k.props=h,k.state=l.memoizedState,k.refs={},b1(l);var R=c.contextType;typeof R=="object"&&R!==null?k.context=ci(R):(R=Dn(c)?qs:rn.current,k.context=Yo(l,R)),k.state=l.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(W1(l,c,R,h),k.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&Wu.enqueueReplaceState(k,k.state,null),Bu(l,h,k,_),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308)}function il(l,c){try{var h="",_=c;do h+=Rw(_),_=_.return;while(_);var k=h}catch(R){k=`
Error generating stack: `+R.message+`
`+R.stack}return{value:l,source:c,stack:k,digest:null}}function X1(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function K1(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var jw=typeof WeakMap=="function"?WeakMap:Map;function kv(l,c,h){h=Ca(-1,h),h.tag=3,h.payload={element:null};var _=c.value;return h.callback=function(){sf||(sf=!0,pp=_),K1(l,c)},h}function Cv(l,c,h){h=Ca(-1,h),h.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var k=c.value;h.payload=function(){return _(k)},h.callback=function(){K1(l,c)}}var R=l.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(h.callback=function(){K1(l,c),typeof _!="function"&&(is===null?is=new Set([this]):is.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})}),h}function Ev(l,c,h){var _=l.pingCache;if(_===null){_=l.pingCache=new jw;var k=new Set;_.set(c,k)}else k=_.get(c),k===void 0&&(k=new Set,_.set(c,k));k.has(h)||(k.add(h),l=Zw.bind(null,l,c,h),c.then(l,l))}function Tv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Av(l,c,h,_,k){return l.mode&1?(l.flags|=65536,l.lanes=k,l):(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Ca(-1,1),c.tag=2,ns(h,c,1))),h.lanes|=1),l)}var Uw=o.ReactCurrentOwner,On=!1;function Sn(l,c,h,_){c.child=l===null?$x(c,null,h,_):Zo(c,l.child,h,_)}function Pv(l,c,h,_,k){h=h.render;var R=c.ref;return tl(c,k),_=j1(l,c,h,_,R,k),h=U1(),l!==null&&!On?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Ea(l,c,k)):(Kt&&h&&w1(c),c.flags|=1,Sn(l,c,_,k),c.child)}function Nv(l,c,h,_,k){if(l===null){var R=h.type;return typeof R=="function"&&!_p(R)&&R.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=R,Fv(l,c,R,_,k)):(l=df(h.type,null,_,c,c.mode,k),l.ref=c.ref,l.return=c,c.child=l)}if(R=l.child,!(l.lanes&k)){var B=R.memoizedProps;if(h=h.compare,h=h!==null?h:Iu,h(B,_)&&l.ref===c.ref)return Ea(l,c,k)}return c.flags|=1,l=ls(R,_),l.ref=c.ref,l.return=c,c.child=l}function Fv(l,c,h,_,k){if(l!==null){var R=l.memoizedProps;if(Iu(R,_)&&l.ref===c.ref)if(On=!1,c.pendingProps=_=R,(l.lanes&k)!==0)l.flags&131072&&(On=!0);else return c.lanes=l.lanes,Ea(l,c,k)}return Y1(l,c,h,_,k)}function Rv(l,c,h){var _=c.pendingProps,k=_.children,R=l!==null?l.memoizedState:null;if(_.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(sl,$n),$n|=h;else{if(!(h&1073741824))return l=R!==null?R.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,mt(sl,$n),$n|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=R!==null?R.baseLanes:h,mt(sl,$n),$n|=_}else R!==null?(_=R.baseLanes|h,c.memoizedState=null):_=h,mt(sl,$n),$n|=_;return Sn(l,c,k,h),c.child}function bv(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function Y1(l,c,h,_,k){var R=Dn(h)?qs:rn.current;return R=Yo(c,R),tl(c,k),h=j1(l,c,h,_,R,k),_=U1(),l!==null&&!On?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Ea(l,c,k)):(Kt&&_&&w1(c),c.flags|=1,Sn(l,c,h,k),c.child)}function Iv(l,c,h,_,k){if(Dn(h)){var R=!0;Cu(c)}else R=!1;if(tl(c,k),c.stateNode===null)Xu(l,c),Sv(c,h,_),$1(c,h,_,k),_=!0;else if(l===null){var B=c.stateNode,J=c.memoizedProps;B.props=J;var de=B.context,De=h.contextType;typeof De=="object"&&De!==null?De=ci(De):(De=Dn(h)?qs:rn.current,De=Yo(c,De));var Ke=h.getDerivedStateFromProps,ot=typeof Ke=="function"||typeof B.getSnapshotBeforeUpdate=="function";ot||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(J!==_||de!==De)&&wv(c,B,_,De),rs=!1;var Ve=c.memoizedState;B.state=Ve,Bu(c,_,B,k),de=c.memoizedState,J!==_||Ve!==de||In.current||rs?(typeof Ke=="function"&&(W1(c,h,Ke,_),de=c.memoizedState),(J=rs||_v(c,h,J,_,Ve,de,De))?(ot||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(c.flags|=4194308)):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=de),B.props=_,B.state=de,B.context=De,_=J):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{B=c.stateNode,Yx(l,c),J=c.memoizedProps,De=c.type===c.elementType?J:Ri(c.type,J),B.props=De,ot=c.pendingProps,Ve=B.context,de=h.contextType,typeof de=="object"&&de!==null?de=ci(de):(de=Dn(h)?qs:rn.current,de=Yo(c,de));var Wt=h.getDerivedStateFromProps;(Ke=typeof Wt=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(J!==ot||Ve!==de)&&wv(c,B,_,de),rs=!1,Ve=c.memoizedState,B.state=Ve,Bu(c,_,B,k);var zt=c.memoizedState;J!==ot||Ve!==zt||In.current||rs?(typeof Wt=="function"&&(W1(c,h,Wt,_),zt=c.memoizedState),(De=rs||_v(c,h,De,_,Ve,zt,de)||!1)?(Ke||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(_,zt,de),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(_,zt,de)),typeof B.componentDidUpdate=="function"&&(c.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof B.componentDidUpdate!="function"||J===l.memoizedProps&&Ve===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&Ve===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=zt),B.props=_,B.state=zt,B.context=de,_=De):(typeof B.componentDidUpdate!="function"||J===l.memoizedProps&&Ve===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&Ve===l.memoizedState||(c.flags|=1024),_=!1)}return Q1(l,c,h,_,R,k)}function Q1(l,c,h,_,k,R){bv(l,c);var B=(c.flags&128)!==0;if(!_&&!B)return k&&Dx(c,h,!1),Ea(l,c,R);_=c.stateNode,Uw.current=c;var J=B&&typeof h.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&B?(c.child=Zo(c,l.child,null,R),c.child=Zo(c,null,J,R)):Sn(l,c,J,R),c.memoizedState=_.state,k&&Dx(c,h,!0),c.child}function Dv(l){var c=l.stateNode;c.pendingContext?bx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&bx(l,c.context,!1),I1(l,c.containerInfo)}function Ov(l,c,h,_,k){return Jo(),T1(k),c.flags|=256,Sn(l,c,h,_),c.child}var q1={dehydrated:null,treeContext:null,retryLane:0};function J1(l){return{baseLanes:l,cachePool:null,transitions:null}}function Lv(l,c,h){var _=c.pendingProps,k=Zt.current,R=!1,B=(c.flags&128)!==0,J;if((J=B)||(J=l!==null&&l.memoizedState===null?!1:(k&2)!==0),J?(R=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(k|=1),mt(Zt,k&1),l===null)return E1(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?mc(l)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(B=_.children,l=_.fallback,R?(_=c.mode,R=c.child,B={mode:"hidden",children:B},!(_&1)&&R!==null?(R.childLanes=0,R.pendingProps=B):R=hf(B,_,0,null),l=so(l,_,h,null),R.return=c,l.return=c,R.sibling=l,c.child=R,c.child.memoizedState=J1(h),c.memoizedState=q1,l):Z1(c,B));if(k=l.memoizedState,k!==null&&(J=k.dehydrated,J!==null))return zw(l,c,B,_,J,k,h);if(R){R=_.fallback,B=c.mode,k=l.child,J=k.sibling;var de={mode:"hidden",children:_.children};return!(B&1)&&c.child!==k?(_=c.child,_.childLanes=0,_.pendingProps=de,c.deletions=null):(_=ls(k,de),_.subtreeFlags=k.subtreeFlags&14680064),J!==null?R=ls(J,R):(R=so(R,B,h,null),R.flags|=2),R.return=c,_.return=c,_.sibling=R,c.child=_,_=R,R=c.child,B=l.child.memoizedState,B=B===null?J1(h):{baseLanes:B.baseLanes|h,cachePool:null,transitions:B.transitions},R.memoizedState=B,R.childLanes=l.childLanes&~h,c.memoizedState=q1,_}return R=l.child,l=R.sibling,_=ls(R,{mode:"visible",children:_.children}),!(c.mode&1)&&(_.lanes=h),_.return=c,_.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=_,c.memoizedState=null,_}function Z1(l,c){return c=hf({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function $u(l,c,h,_){return _!==null&&T1(_),Zo(c,l.child,null,h),l=Z1(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function zw(l,c,h,_,k,R,B){if(h)return c.flags&256?(c.flags&=-257,_=X1(Error(s(422))),$u(l,c,B,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(R=_.fallback,k=c.mode,_=hf({mode:"visible",children:_.children},k,0,null),R=so(R,k,B,null),R.flags|=2,_.return=c,R.return=c,_.sibling=R,c.child=_,c.mode&1&&Zo(c,l.child,null,B),c.child.memoizedState=J1(B),c.memoizedState=q1,R);if(!(c.mode&1))return $u(l,c,B,null);if(mc(k))return _=p1(k).digest,R=Error(s(419)),_=X1(R,_,void 0),$u(l,c,B,_);if(h=(B&l.childLanes)!==0,On||h){if(_=Br,_!==null){switch(B&-B){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=k&(_.suspendedLanes|B)?0:k,k!==0&&k!==R.retryLane&&(R.retryLane=k,ta(l,k),di(_,l,k,-1))}return yp(),_=X1(Error(s(421))),$u(l,c,B,_)}return wu(k)?(c.flags|=128,c.child=l.child,c=ek.bind(null,l),D(k,c),null):(l=R.treeContext,qe&&(li=H(k),Wn=c,Kt=!0,Fi=null,yc=!1,l!==null&&(si[oi++]=wa,si[oi++]=ka,si[oi++]=Js,wa=l.id,ka=l.overflow,Js=c)),c=Z1(c,_.children),c.flags|=4096,c)}function Mv(l,c,h){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),F1(l.return,c,h)}function ep(l,c,h,_,k){var R=l.memoizedState;R===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:k}:(R.isBackwards=c,R.rendering=null,R.renderingStartTime=0,R.last=_,R.tail=h,R.tailMode=k)}function Bv(l,c,h){var _=c.pendingProps,k=_.revealOrder,R=_.tail;if(Sn(l,c,_.children,h),_=Zt.current,_&2)_=_&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Mv(l,h,c);else if(l.tag===19)Mv(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(mt(Zt,_),!(c.mode&1))c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)l=h.alternate,l!==null&&ju(l)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),ep(c,!1,k,h,R);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(l=k.alternate,l!==null&&ju(l)===null){c.child=k;break}l=k.sibling,k.sibling=h,h=k,k=l}ep(c,!0,h,null,R);break;case"together":ep(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Xu(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Ea(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),ro|=c.lanes,!(h&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(s(153));if(c.child!==null){for(l=c.child,h=ls(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=ls(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function Vw(l,c,h){switch(c.tag){case 3:Dv(c),Jo();break;case 5:Jx(c);break;case 1:Dn(c.type)&&Cu(c);break;case 4:I1(c,c.stateNode.containerInfo);break;case 10:Xx(c,c.type._context,c.memoizedProps.value);break;case 13:var _=c.memoizedState;if(_!==null)return _.dehydrated!==null?(mt(Zt,Zt.current&1),c.flags|=128,null):h&c.child.childLanes?Lv(l,c,h):(mt(Zt,Zt.current&1),l=Ea(l,c,h),l!==null?l.sibling:null);mt(Zt,Zt.current&1);break;case 19:if(_=(h&c.childLanes)!==0,l.flags&128){if(_)return Bv(l,c,h);c.flags|=128}var k=c.memoizedState;if(k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),mt(Zt,Zt.current),_)break;return null;case 22:case 23:return c.lanes=0,Rv(l,c,h)}return Ea(l,c,h)}function ia(l){l.flags|=4}function jv(l,c){if(l!==null&&l.child===c.child)return!0;if(c.flags&16)return!1;for(l=c.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Ac,Pc,Ku,Yu;if(Be)Ac=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)L(l,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Pc=function(){},Ku=function(l,c,h,_,k){if(l=l.memoizedProps,l!==_){var R=c.stateNode,B=ra(ui.current);h=Y(R,h,l,_,k,B),(c.updateQueue=h)&&ia(c)}},Yu=function(l,c,h,_){h!==_&&ia(c)};else if(G){Ac=function(l,c,h,_){for(var k=c.child;k!==null;){if(k.tag===5){var R=k.stateNode;h&&_&&(R=Ji(R,k.type,k.memoizedProps,k)),L(l,R)}else if(k.tag===6)R=k.stateNode,h&&_&&(R=bn(R,k.memoizedProps,k)),L(l,R);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)R=k.child,R!==null&&(R.return=k),Ac(l,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===c)break;for(;k.sibling===null;){if(k.return===null||k.return===c)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};var Uv=function(l,c,h,_){for(var k=c.child;k!==null;){if(k.tag===5){var R=k.stateNode;h&&_&&(R=Ji(R,k.type,k.memoizedProps,k)),Rt(l,R)}else if(k.tag===6)R=k.stateNode,h&&_&&(R=bn(R,k.memoizedProps,k)),Rt(l,R);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)R=k.child,R!==null&&(R.return=k),Uv(l,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===c)break;for(;k.sibling===null;){if(k.return===null||k.return===c)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};Pc=function(l,c){var h=c.stateNode;if(!jv(l,c)){l=h.containerInfo;var _=Ft(l);Uv(_,c,!1,!1),h.pendingChildren=_,ia(c),qi(l,_)}},Ku=function(l,c,h,_,k){var R=l.stateNode,B=l.memoizedProps;if((l=jv(l,c))&&B===_)c.stateNode=R;else{var J=c.stateNode,de=ra(ui.current),De=null;B!==_&&(De=Y(J,h,B,_,k,de)),l&&De===null?c.stateNode=R:(R=vt(R,De,h,B,_,c,l,J),Q(R,h,_,k,de)&&ia(c),c.stateNode=R,l?ia(c):Ac(R,c,!1,!1))}},Yu=function(l,c,h,_){h!==_?(l=ra(rl.current),h=ra(ui.current),c.stateNode=ue(_,l,h,c),ia(c)):c.stateNode=l.stateNode}}else Pc=function(){},Ku=function(){},Yu=function(){};function Nc(l,c){if(!Kt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function an(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,_=0;if(c)for(var k=l.child;k!==null;)h|=k.lanes|k.childLanes,_|=k.subtreeFlags&14680064,_|=k.flags&14680064,k.return=l,k=k.sibling;else for(k=l.child;k!==null;)h|=k.lanes|k.childLanes,_|=k.subtreeFlags,_|=k.flags,k.return=l,k=k.sibling;return l.subtreeFlags|=_,l.childLanes=h,c}function Gw(l,c,h){var _=c.pendingProps;switch(k1(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(c),null;case 1:return Dn(c.type)&&ku(),an(c),null;case 3:return h=c.stateNode,nl(),Dt(In),Dt(rn),L1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(l===null||l.child===null)&&(bu(c)?ia(c):l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Fi!==null&&(xp(Fi),Fi=null))),Pc(l,c),an(c),null;case 5:D1(c),h=ra(rl.current);var k=c.type;if(l!==null&&c.stateNode!=null)Ku(l,c,k,_,h),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(s(166));return an(c),null}if(l=ra(ui.current),bu(c)){if(!qe)throw Error(s(175));l=W(c.stateNode,c.type,c.memoizedProps,h,l,c,!yc),c.updateQueue=l,l!==null&&ia(c)}else{var R=Te(k,_,h,l,c);Ac(R,c,!1,!1),c.stateNode=R,Q(R,k,_,h,l)&&ia(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return an(c),null;case 6:if(l&&c.stateNode!=null)Yu(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(s(166));if(l=ra(rl.current),h=ra(ui.current),bu(c)){if(!qe)throw Error(s(176));if(l=c.stateNode,h=c.memoizedProps,(_=se(l,h,c,!yc))&&(k=Wn,k!==null))switch(k.tag){case 3:Ie(k.stateNode.containerInfo,l,h,(k.mode&1)!==0);break;case 5:ze(k.type,k.memoizedProps,k.stateNode,l,h,(k.mode&1)!==0)}_&&ia(c)}else c.stateNode=ue(_,l,h,c)}return an(c),null;case 13:if(Dt(Zt),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Kt&&li!==null&&c.mode&1&&!(c.flags&128))Gx(),Jo(),c.flags|=98560,k=!1;else if(k=bu(c),_!==null&&_.dehydrated!==null){if(l===null){if(!k)throw Error(s(318));if(!qe)throw Error(s(344));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(s(317));ye(k,c)}else Jo(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;an(c),k=!1}else Fi!==null&&(xp(Fi),Fi=null),k=!0;if(!k)return c.flags&65536?c:null}return c.flags&128?(c.lanes=h,c):(h=_!==null,h!==(l!==null&&l.memoizedState!==null)&&h&&(c.child.flags|=8192,c.mode&1&&(l===null||Zt.current&1?Er===0&&(Er=3):yp())),c.updateQueue!==null&&(c.flags|=4),an(c),null);case 4:return nl(),Pc(l,c),l===null&&Ye(c.stateNode.containerInfo),an(c),null;case 10:return N1(c.type._context),an(c),null;case 17:return Dn(c.type)&&ku(),an(c),null;case 19:if(Dt(Zt),k=c.memoizedState,k===null)return an(c),null;if(_=(c.flags&128)!==0,R=k.rendering,R===null)if(_)Nc(k,!1);else{if(Er!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(R=ju(l),R!==null){for(c.flags|=128,Nc(k,!1),l=R.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=h,h=c.child;h!==null;)_=h,k=l,_.flags&=14680066,R=_.alternate,R===null?(_.childLanes=0,_.lanes=k,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=R.childLanes,_.lanes=R.lanes,_.child=R.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=R.memoizedProps,_.memoizedState=R.memoizedState,_.updateQueue=R.updateQueue,_.type=R.type,k=R.dependencies,_.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext}),h=h.sibling;return mt(Zt,Zt.current&1|2),c.child}l=l.sibling}k.tail!==null&&Lr()>hp&&(c.flags|=128,_=!0,Nc(k,!1),c.lanes=4194304)}else{if(!_)if(l=ju(R),l!==null){if(c.flags|=128,_=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Nc(k,!0),k.tail===null&&k.tailMode==="hidden"&&!R.alternate&&!Kt)return an(c),null}else 2*Lr()-k.renderingStartTime>hp&&h!==1073741824&&(c.flags|=128,_=!0,Nc(k,!1),c.lanes=4194304);k.isBackwards?(R.sibling=c.child,c.child=R):(l=k.last,l!==null?l.sibling=R:c.child=R,k.last=R)}return k.tail!==null?(c=k.tail,k.rendering=c,k.tail=c.sibling,k.renderingStartTime=Lr(),c.sibling=null,l=Zt.current,mt(Zt,_?l&1|2:l&1),c):(an(c),null);case 22:case 23:return vp(),h=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==h&&(c.flags|=8192),h&&c.mode&1?$n&1073741824&&(an(c),Be&&c.subtreeFlags&6&&(c.flags|=8192)):an(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function Hw(l,c){switch(k1(c),c.tag){case 1:return Dn(c.type)&&ku(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return nl(),Dt(In),Dt(rn),L1(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return D1(c),null;case 13:if(Dt(Zt),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Jo()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Dt(Zt),null;case 4:return nl(),null;case 10:return N1(c.type._context),null;case 22:case 23:return vp(),null;case 24:return null;default:return null}}var Qu=!1,sn=!1,Ww=typeof WeakSet=="function"?WeakSet:Set,We=null;function al(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(_){Yt(l,c,_)}else h.current=null}function tp(l,c,h){try{h()}catch(_){Yt(l,c,_)}}var zv=!1;function $w(l,c){for(X(l.containerInfo),We=c;We!==null;)if(l=We,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,We=c;else for(;We!==null;){l=We;try{var h=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var _=h.memoizedProps,k=h.memoizedState,R=l.stateNode,B=R.getSnapshotBeforeUpdate(l.elementType===l.type?_:Ri(l.type,_),k);R.__reactInternalSnapshotBeforeUpdate=B}break;case 3:Be&&at(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(J){Yt(l,l.return,J)}if(c=l.sibling,c!==null){c.return=l.return,We=c;break}We=l.return}return h=zv,zv=!1,h}function Fc(l,c,h){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var k=_=_.next;do{if((k.tag&l)===l){var R=k.destroy;k.destroy=void 0,R!==void 0&&tp(c,h,R)}k=k.next}while(k!==_)}}function qu(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var _=h.create;h.destroy=_()}h=h.next}while(h!==c)}}function rp(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=Ae(h);break;default:l=h}typeof c=="function"?c(l):c.current=l}}function Vv(l){var c=l.alternate;c!==null&&(l.alternate=null,Vv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Fe(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Gv(l){return l.tag===5||l.tag===3||l.tag===4}function Hv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Gv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function np(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?gt(h,l,c):ae(h,l);else if(_!==4&&(l=l.child,l!==null))for(np(l,c,h),l=l.sibling;l!==null;)np(l,c,h),l=l.sibling}function ip(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?Xe(h,l,c):pe(h,l);else if(_!==4&&(l=l.child,l!==null))for(ip(l,c,h),l=l.sibling;l!==null;)ip(l,c,h),l=l.sibling}var $r=null,bi=!1;function aa(l,c,h){for(h=h.child;h!==null;)ap(l,c,h),h=h.sibling}function ap(l,c,h){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount(Pu,h)}catch{}switch(h.tag){case 5:sn||al(h,c);case 6:if(Be){var _=$r,k=bi;$r=null,aa(l,c,h),$r=_,bi=k,$r!==null&&(bi?jt($r,h.stateNode):Bt($r,h.stateNode))}else aa(l,c,h);break;case 18:Be&&$r!==null&&(bi?je($r,h.stateNode):Ne($r,h.stateNode));break;case 4:Be?(_=$r,k=bi,$r=h.stateNode.containerInfo,bi=!0,aa(l,c,h),$r=_,bi=k):(G&&(_=h.stateNode.containerInfo,k=Ft(_),en(_,k)),aa(l,c,h));break;case 0:case 11:case 14:case 15:if(!sn&&(_=h.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){k=_=_.next;do{var R=k,B=R.destroy;R=R.tag,B!==void 0&&(R&2||R&4)&&tp(h,c,B),k=k.next}while(k!==_)}aa(l,c,h);break;case 1:if(!sn&&(al(h,c),_=h.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=h.memoizedProps,_.state=h.memoizedState,_.componentWillUnmount()}catch(J){Yt(h,c,J)}aa(l,c,h);break;case 21:aa(l,c,h);break;case 22:h.mode&1?(sn=(_=sn)||h.memoizedState!==null,aa(l,c,h),sn=_):aa(l,c,h);break;default:aa(l,c,h)}}function Wv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new Ww),c.forEach(function(_){var k=tk.bind(null,l,_);h.has(_)||(h.add(_),_.then(k,k))})}}function Ii(l,c){var h=c.deletions;if(h!==null)for(var _=0;_<h.length;_++){var k=h[_];try{var R=l,B=c;if(Be){var J=B;e:for(;J!==null;){switch(J.tag){case 5:$r=J.stateNode,bi=!1;break e;case 3:$r=J.stateNode.containerInfo,bi=!0;break e;case 4:$r=J.stateNode.containerInfo,bi=!0;break e}J=J.return}if($r===null)throw Error(s(160));ap(R,B,k),$r=null,bi=!1}else ap(R,B,k);var de=k.alternate;de!==null&&(de.return=null),k.return=null}catch(De){Yt(k,c,De)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)$v(c,l),c=c.sibling}function $v(l,c){var h=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ii(c,l),sa(l),_&4){try{Fc(3,l,l.return),qu(3,l)}catch(Ve){Yt(l,l.return,Ve)}try{Fc(5,l,l.return)}catch(Ve){Yt(l,l.return,Ve)}}break;case 1:Ii(c,l),sa(l),_&512&&h!==null&&al(h,h.return);break;case 5:if(Ii(c,l),sa(l),_&512&&h!==null&&al(h,h.return),Be){if(l.flags&32){var k=l.stateNode;try{ar(k)}catch(Ve){Yt(l,l.return,Ve)}}if(_&4&&(k=l.stateNode,k!=null)){var R=l.memoizedProps;if(h=h!==null?h.memoizedProps:R,_=l.type,c=l.updateQueue,l.updateQueue=null,c!==null)try{Le(k,c,_,h,R,l)}catch(Ve){Yt(l,l.return,Ve)}}}break;case 6:if(Ii(c,l),sa(l),_&4&&Be){if(l.stateNode===null)throw Error(s(162));k=l.stateNode,R=l.memoizedProps,h=h!==null?h.memoizedProps:R;try{xe(k,h,R)}catch(Ve){Yt(l,l.return,Ve)}}break;case 3:if(Ii(c,l),sa(l),_&4){if(Be&&qe&&h!==null&&h.memoizedState.isDehydrated)try{oe(c.containerInfo)}catch(Ve){Yt(l,l.return,Ve)}if(G){k=c.containerInfo,R=c.pendingChildren;try{en(k,R)}catch(Ve){Yt(l,l.return,Ve)}}}break;case 4:if(Ii(c,l),sa(l),_&4&&G){R=l.stateNode,k=R.containerInfo,R=R.pendingChildren;try{en(k,R)}catch(Ve){Yt(l,l.return,Ve)}}break;case 13:Ii(c,l),sa(l),k=l.child,k.flags&8192&&(R=k.memoizedState!==null,k.stateNode.isHidden=R,!R||k.alternate!==null&&k.alternate.memoizedState!==null||(dp=Lr())),_&4&&Wv(l);break;case 22:var B=h!==null&&h.memoizedState!==null;if(l.mode&1?(sn=(h=sn)||B,Ii(c,l),sn=h):Ii(c,l),sa(l),_&8192){if(h=l.memoizedState!==null,(l.stateNode.isHidden=h)&&!B&&l.mode&1)for(We=l,_=l.child;_!==null;){for(c=We=_;We!==null;){B=We;var J=B.child;switch(B.tag){case 0:case 11:case 14:case 15:Fc(4,B,B.return);break;case 1:al(B,B.return);var de=B.stateNode;if(typeof de.componentWillUnmount=="function"){var De=B,Ke=B.return;try{var ot=De;de.props=ot.memoizedProps,de.state=ot.memoizedState,de.componentWillUnmount()}catch(Ve){Yt(De,Ke,Ve)}}break;case 5:al(B,B.return);break;case 22:if(B.memoizedState!==null){Yv(c);continue}}J!==null?(J.return=B,We=J):Yv(c)}_=_.sibling}if(Be){e:if(_=null,Be)for(c=l;;){if(c.tag===5){if(_===null){_=c;try{k=c.stateNode,h?Za(k):Ue(c.stateNode,c.memoizedProps)}catch(Ve){Yt(l,l.return,Ve)}}}else if(c.tag===6){if(_===null)try{R=c.stateNode,h?Oe(R):Ze(R,c.memoizedProps)}catch(Ve){Yt(l,l.return,Ve)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;_===c&&(_=null),c=c.return}_===c&&(_=null),c.sibling.return=c.return,c=c.sibling}}}break;case 19:Ii(c,l),sa(l),_&4&&Wv(l);break;case 21:break;default:Ii(c,l),sa(l)}}function sa(l){var c=l.flags;if(c&2){try{if(Be){e:{for(var h=l.return;h!==null;){if(Gv(h)){var _=h;break e}h=h.return}throw Error(s(160))}switch(_.tag){case 5:var k=_.stateNode;_.flags&32&&(ar(k),_.flags&=-33);var R=Hv(l);ip(l,R,k);break;case 3:case 4:var B=_.stateNode.containerInfo,J=Hv(l);np(l,J,B);break;default:throw Error(s(161))}}}catch(de){Yt(l,l.return,de)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function Xw(l,c,h){We=l,Xv(l)}function Xv(l,c,h){for(var _=(l.mode&1)!==0;We!==null;){var k=We,R=k.child;if(k.tag===22&&_){var B=k.memoizedState!==null||Qu;if(!B){var J=k.alternate,de=J!==null&&J.memoizedState!==null||sn;J=Qu;var De=sn;if(Qu=B,(sn=de)&&!De)for(We=k;We!==null;)B=We,de=B.child,B.tag===22&&B.memoizedState!==null?Qv(k):de!==null?(de.return=B,We=de):Qv(k);for(;R!==null;)We=R,Xv(R),R=R.sibling;We=k,Qu=J,sn=De}Kv(l)}else k.subtreeFlags&8772&&R!==null?(R.return=k,We=R):Kv(l)}}function Kv(l){for(;We!==null;){var c=We;if(c.flags&8772){var h=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:sn||qu(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!sn)if(h===null)_.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:Ri(c.type,h.memoizedProps);_.componentDidUpdate(k,h.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var R=c.updateQueue;R!==null&&qx(c,R,_);break;case 3:var B=c.updateQueue;if(B!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=Ae(c.child.stateNode);break;case 1:h=c.child.stateNode}qx(c,B,h)}break;case 5:var J=c.stateNode;h===null&&c.flags&4&&be(J,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(qe&&c.memoizedState===null){var de=c.alternate;if(de!==null){var De=de.memoizedState;if(De!==null){var Ke=De.dehydrated;Ke!==null&&le(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}sn||c.flags&512&&rp(c)}catch(ot){Yt(c,c.return,ot)}}if(c===l){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function Yv(l){for(;We!==null;){var c=We;if(c===l){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function Qv(l){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{qu(4,c)}catch(de){Yt(c,h,de)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var k=c.return;try{_.componentDidMount()}catch(de){Yt(c,k,de)}}var R=c.return;try{rp(c)}catch(de){Yt(c,R,de)}break;case 5:var B=c.return;try{rp(c)}catch(de){Yt(c,B,de)}}}catch(de){Yt(c,c.return,de)}if(c===l){We=null;break}var J=c.sibling;if(J!==null){J.return=c.return,We=J;break}We=c.return}}var Ju=0,Zu=1,ef=2,tf=3,rf=4;if(typeof Symbol=="function"&&Symbol.for){var Rc=Symbol.for;Ju=Rc("selector.component"),Zu=Rc("selector.has_pseudo_class"),ef=Rc("selector.role"),tf=Rc("selector.test_id"),rf=Rc("selector.text")}function sp(l){var c=et(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(s(364));return c}if(l=_e(l),l===null)throw Error(s(362));return l.stateNode.current}function op(l,c){switch(c.$$typeof){case Ju:if(l.type===c.value)return!0;break;case Zu:e:{c=c.value,l=[l,0];for(var h=0;h<l.length;){var _=l[h++],k=l[h++],R=c[k];if(_.tag!==5||!we(_)){for(;R!=null&&op(_,R);)k++,R=c[k];if(k===c.length){c=!0;break e}else for(_=_.child;_!==null;)l.push(_,k),_=_.sibling}}c=!1}return c;case ef:if(l.tag===5&&Ce(l.stateNode,c.value))return!0;break;case rf:if((l.tag===5||l.tag===6)&&(l=ke(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case tf:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function lp(l){switch(l.$$typeof){case Ju:return"<"+(A(l.value)||"Unknown")+">";case Zu:return":has("+(lp(l)||"")+")";case ef:return'[role="'+l.value+'"]';case rf:return'"'+l.value+'"';case tf:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function qv(l,c){var h=[];l=[l,0];for(var _=0;_<l.length;){var k=l[_++],R=l[_++],B=c[R];if(k.tag!==5||!we(k)){for(;B!=null&&op(k,B);)R++,B=c[R];if(R===c.length)h.push(k);else for(k=k.child;k!==null;)l.push(k,R),k=k.sibling}}return h}function cp(l,c){if(!gr)throw Error(s(363));l=sp(l),l=qv(l,c),c=[],l=Array.from(l);for(var h=0;h<l.length;){var _=l[h++];if(_.tag===5)we(_)||c.push(_.stateNode);else for(_=_.child;_!==null;)l.push(_),_=_.sibling}return c}var Kw=Math.ceil,nf=o.ReactCurrentDispatcher,up=o.ReactCurrentOwner,fr=o.ReactCurrentBatchConfig,dt=0,Br=null,xr=null,Xr=0,$n=0,sl=tn(0),Er=0,bc=null,ro=0,af=0,fp=0,Ic=null,Ln=null,dp=0,hp=1/0,Ta=null;function ol(){hp=Lr()+500}var sf=!1,pp=null,is=null,of=!1,as=null,lf=0,Dc=0,gp=null,cf=-1,uf=0;function on(){return dt&6?Lr():cf!==-1?cf:cf=Lr()}function ss(l){return l.mode&1?dt&2&&Xr!==0?Xr&-Xr:Fw.transition!==null?(uf===0&&(uf=Ox()),uf):(l=Tt,l!==0?l:Qe()):1}function di(l,c,h,_){if(50<Dc)throw Dc=0,gp=null,Error(s(185));vc(l,h,_),(!(dt&2)||l!==Br)&&(l===Br&&(!(dt&2)&&(af|=h),Er===4&&os(l,Xr)),Mn(l,_),h===1&&dt===0&&!(c.mode&1)&&(ol(),Nu&&ea()))}function Mn(l,c){var h=l.callbackNode;Sw(l,c);var _=Au(l,l===Br?Xr:0);if(_===0)h!==null&&Mx(h),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(h!=null&&Mx(h),c===1)l.tag===0?Nw(Zv.bind(null,l)):Bx(Zv.bind(null,l)),St?Or(function(){!(dt&6)&&ea()}):v1(y1,ea),h=null;else{switch(Lx(_)){case 1:h=y1;break;case 4:h=Ew;break;case 16:h=_1;break;case 536870912:h=Tw;break;default:h=_1}h=ly(h,Jv.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function Jv(l,c){if(cf=-1,uf=0,dt&6)throw Error(s(327));var h=l.callbackNode;if(ao()&&l.callbackNode!==h)return null;var _=Au(l,l===Br?Xr:0);if(_===0)return null;if(_&30||_&l.expiredLanes||c)c=ff(l,_);else{c=_;var k=dt;dt|=2;var R=ry();(Br!==l||Xr!==c)&&(Ta=null,ol(),no(l,c));do try{qw();break}catch(J){ty(l,J)}while(1);P1(),nf.current=R,dt=k,xr!==null?c=0:(Br=null,Xr=0,c=Er)}if(c!==0){if(c===2&&(k=g1(l),k!==0&&(_=k,c=mp(l,k))),c===1)throw h=bc,no(l,0),os(l,_),Mn(l,Lr()),h;if(c===6)os(l,_);else{if(k=l.current.alternate,!(_&30)&&!Yw(k)&&(c=ff(l,_),c===2&&(R=g1(l),R!==0&&(_=R,c=mp(l,R))),c===1))throw h=bc,no(l,0),os(l,_),Mn(l,Lr()),h;switch(l.finishedWork=k,l.finishedLanes=_,c){case 0:case 1:throw Error(s(345));case 2:io(l,Ln,Ta);break;case 3:if(os(l,_),(_&130023424)===_&&(c=dp+500-Lr(),10<c)){if(Au(l,0)!==0)break;if(k=l.suspendedLanes,(k&_)!==_){on(),l.pingedLanes|=l.suspendedLanes&k;break}l.timeoutHandle=V(io.bind(null,l,Ln,Ta),c);break}io(l,Ln,Ta);break;case 4:if(os(l,_),(_&4194240)===_)break;for(c=l.eventTimes,k=-1;0<_;){var B=31-Pi(_);R=1<<B,B=c[B],B>k&&(k=B),_&=~R}if(_=k,_=Lr()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*Kw(_/1960))-_,10<_){l.timeoutHandle=V(io.bind(null,l,Ln,Ta),_);break}io(l,Ln,Ta);break;case 5:io(l,Ln,Ta);break;default:throw Error(s(329))}}}return Mn(l,Lr()),l.callbackNode===h?Jv.bind(null,l):null}function mp(l,c){var h=Ic;return l.current.memoizedState.isDehydrated&&(no(l,c).flags|=256),l=ff(l,c),l!==2&&(c=Ln,Ln=h,c!==null&&xp(c)),l}function xp(l){Ln===null?Ln=l:Ln.push.apply(Ln,l)}function Yw(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var _=0;_<h.length;_++){var k=h[_],R=k.getSnapshot;k=k.value;try{if(!Ni(R(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function os(l,c){for(c&=~fp,c&=~af,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-Pi(c),_=1<<h;l[h]=-1,c&=~_}}function Zv(l){if(dt&6)throw Error(s(327));ao();var c=Au(l,0);if(!(c&1))return Mn(l,Lr()),null;var h=ff(l,c);if(l.tag!==0&&h===2){var _=g1(l);_!==0&&(c=_,h=mp(l,_))}if(h===1)throw h=bc,no(l,0),os(l,c),Mn(l,Lr()),h;if(h===6)throw Error(s(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,io(l,Ln,Ta),Mn(l,Lr()),null}function ey(l){as!==null&&as.tag===0&&!(dt&6)&&ao();var c=dt;dt|=1;var h=fr.transition,_=Tt;try{if(fr.transition=null,Tt=1,l)return l()}finally{Tt=_,fr.transition=h,dt=c,!(dt&6)&&ea()}}function vp(){$n=sl.current,Dt(sl)}function no(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==fe&&(l.timeoutHandle=fe,Z(h)),xr!==null)for(h=xr.return;h!==null;){var _=h;switch(k1(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&ku();break;case 3:nl(),Dt(In),Dt(rn),L1();break;case 5:D1(_);break;case 4:nl();break;case 13:Dt(Zt);break;case 19:Dt(Zt);break;case 10:N1(_.type._context);break;case 22:case 23:vp()}h=h.return}if(Br=l,xr=l=ls(l.current,null),Xr=$n=c,Er=0,bc=null,fp=af=ro=0,Ln=Ic=null,eo!==null){for(c=0;c<eo.length;c++)if(h=eo[c],_=h.interleaved,_!==null){h.interleaved=null;var k=_.next,R=h.pending;if(R!==null){var B=R.next;R.next=k,_.next=B}h.pending=_}eo=null}return l}function ty(l,c){do{var h=xr;try{if(P1(),Uu.current=Hu,zu){for(var _=er.memoizedState;_!==null;){var k=_.queue;k!==null&&(k.pending=null),_=_.next}zu=!1}if(to=0,Mr=Cr=er=null,kc=!1,Cc=0,up.current=null,h===null||h.return===null){Er=1,bc=c,xr=null;break}e:{var R=l,B=h.return,J=h,de=c;if(c=Xr,J.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var De=de,Ke=J,ot=Ke.tag;if(!(Ke.mode&1)&&(ot===0||ot===11||ot===15)){var Ve=Ke.alternate;Ve?(Ke.updateQueue=Ve.updateQueue,Ke.memoizedState=Ve.memoizedState,Ke.lanes=Ve.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var Wt=Tv(B);if(Wt!==null){Wt.flags&=-257,Av(Wt,B,J,R,c),Wt.mode&1&&Ev(R,De,c),c=Wt,de=De;var zt=c.updateQueue;if(zt===null){var Bn=new Set;Bn.add(de),c.updateQueue=Bn}else zt.add(de);break e}else{if(!(c&1)){Ev(R,De,c),yp();break e}de=Error(s(426))}}else if(Kt&&J.mode&1){var Aa=Tv(B);if(Aa!==null){!(Aa.flags&65536)&&(Aa.flags|=256),Av(Aa,B,J,R,c),T1(il(de,J));break e}}R=de=il(de,J),Er!==4&&(Er=2),Ic===null?Ic=[R]:Ic.push(R),R=B;do{switch(R.tag){case 3:R.flags|=65536,c&=-c,R.lanes|=c;var ce=kv(R,de,c);Qx(R,ce);break e;case 1:J=de;var ee=R.type,ge=R.stateNode;if(!(R.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(is===null||!is.has(ge)))){R.flags|=65536,c&=-c,R.lanes|=c;var Ge=Cv(R,J,c);Qx(R,Ge);break e}}R=R.return}while(R!==null)}iy(h)}catch(Je){c=Je,xr===h&&h!==null&&(xr=h=h.return);continue}break}while(1)}function ry(){var l=nf.current;return nf.current=Hu,l===null?Hu:l}function yp(){(Er===0||Er===3||Er===2)&&(Er=4),Br===null||!(ro&268435455)&&!(af&268435455)||os(Br,Xr)}function ff(l,c){var h=dt;dt|=2;var _=ry();(Br!==l||Xr!==c)&&(Ta=null,no(l,c));do try{Qw();break}catch(k){ty(l,k)}while(1);if(P1(),dt=h,nf.current=_,xr!==null)throw Error(s(261));return Br=null,Xr=0,Er}function Qw(){for(;xr!==null;)ny(xr)}function qw(){for(;xr!==null&&!kw();)ny(xr)}function ny(l){var c=oy(l.alternate,l,$n);l.memoizedProps=l.pendingProps,c===null?iy(l):xr=c,up.current=null}function iy(l){var c=l;do{var h=c.alternate;if(l=c.return,c.flags&32768){if(h=Hw(h,c),h!==null){h.flags&=32767,xr=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Er=6,xr=null;return}}else if(h=Gw(h,c,$n),h!==null){xr=h;return}if(c=c.sibling,c!==null){xr=c;return}xr=c=l}while(c!==null);Er===0&&(Er=5)}function io(l,c,h){var _=Tt,k=fr.transition;try{fr.transition=null,Tt=1,Jw(l,c,h,_)}finally{fr.transition=k,Tt=_}return null}function Jw(l,c,h,_){do ao();while(as!==null);if(dt&6)throw Error(s(327));h=l.finishedWork;var k=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(s(177));l.callbackNode=null,l.callbackPriority=0;var R=h.lanes|h.childLanes;if(ww(l,R),l===Br&&(xr=Br=null,Xr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||of||(of=!0,ly(_1,function(){return ao(),null})),R=(h.flags&15990)!==0,h.subtreeFlags&15990||R){R=fr.transition,fr.transition=null;var B=Tt;Tt=1;var J=dt;dt|=4,up.current=null,$w(l,h),$v(h,l),he(l.containerInfo),l.current=h,Xw(h),Cw(),dt=J,Tt=B,fr.transition=R}else l.current=h;if(of&&(of=!1,as=l,lf=k),R=l.pendingLanes,R===0&&(is=null),Aw(h.stateNode),Mn(l,Lr()),c!==null)for(_=l.onRecoverableError,h=0;h<c.length;h++)k=c[h],_(k.value,{componentStack:k.stack,digest:k.digest});if(sf)throw sf=!1,l=pp,pp=null,l;return lf&1&&l.tag!==0&&ao(),R=l.pendingLanes,R&1?l===gp?Dc++:(Dc=0,gp=l):Dc=0,ea(),null}function ao(){if(as!==null){var l=Lx(lf),c=fr.transition,h=Tt;try{if(fr.transition=null,Tt=16>l?16:l,as===null)var _=!1;else{if(l=as,as=null,lf=0,dt&6)throw Error(s(331));var k=dt;for(dt|=4,We=l.current;We!==null;){var R=We,B=R.child;if(We.flags&16){var J=R.deletions;if(J!==null){for(var de=0;de<J.length;de++){var De=J[de];for(We=De;We!==null;){var Ke=We;switch(Ke.tag){case 0:case 11:case 15:Fc(8,Ke,R)}var ot=Ke.child;if(ot!==null)ot.return=Ke,We=ot;else for(;We!==null;){Ke=We;var Ve=Ke.sibling,Wt=Ke.return;if(Vv(Ke),Ke===De){We=null;break}if(Ve!==null){Ve.return=Wt,We=Ve;break}We=Wt}}}var zt=R.alternate;if(zt!==null){var Bn=zt.child;if(Bn!==null){zt.child=null;do{var Aa=Bn.sibling;Bn.sibling=null,Bn=Aa}while(Bn!==null)}}We=R}}if(R.subtreeFlags&2064&&B!==null)B.return=R,We=B;else e:for(;We!==null;){if(R=We,R.flags&2048)switch(R.tag){case 0:case 11:case 15:Fc(9,R,R.return)}var ce=R.sibling;if(ce!==null){ce.return=R.return,We=ce;break e}We=R.return}}var ee=l.current;for(We=ee;We!==null;){B=We;var ge=B.child;if(B.subtreeFlags&2064&&ge!==null)ge.return=B,We=ge;else e:for(B=ee;We!==null;){if(J=We,J.flags&2048)try{switch(J.tag){case 0:case 11:case 15:qu(9,J)}}catch(Je){Yt(J,J.return,Je)}if(J===B){We=null;break e}var Ge=J.sibling;if(Ge!==null){Ge.return=J.return,We=Ge;break e}We=J.return}}if(dt=k,ea(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot(Pu,l)}catch{}_=!0}return _}finally{Tt=h,fr.transition=c}}return!1}function ay(l,c,h){c=il(h,c),c=kv(l,c,1),l=ns(l,c,1),c=on(),l!==null&&(vc(l,1,c),Mn(l,c))}function Yt(l,c,h){if(l.tag===3)ay(l,l,h);else for(;c!==null;){if(c.tag===3){ay(c,l,h);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(is===null||!is.has(_))){l=il(h,l),l=Cv(c,l,1),c=ns(c,l,1),l=on(),c!==null&&(vc(c,1,l),Mn(c,l));break}}c=c.return}}function Zw(l,c,h){var _=l.pingCache;_!==null&&_.delete(c),c=on(),l.pingedLanes|=l.suspendedLanes&h,Br===l&&(Xr&h)===h&&(Er===4||Er===3&&(Xr&130023424)===Xr&&500>Lr()-dp?no(l,0):fp|=h),Mn(l,c)}function sy(l,c){c===0&&(l.mode&1?(c=Tu,Tu<<=1,!(Tu&130023424)&&(Tu=4194304)):c=1);var h=on();l=ta(l,c),l!==null&&(vc(l,c,h),Mn(l,h))}function ek(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),sy(l,h)}function tk(l,c){var h=0;switch(l.tag){case 13:var _=l.stateNode,k=l.memoizedState;k!==null&&(h=k.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(s(314))}_!==null&&_.delete(c),sy(l,h)}var oy;oy=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||In.current)On=!0;else{if(!(l.lanes&h)&&!(c.flags&128))return On=!1,Vw(l,c,h);On=!!(l.flags&131072)}else On=!1,Kt&&c.flags&1048576&&jx(c,Ru,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Xu(l,c),l=c.pendingProps;var k=Yo(c,rn.current);tl(c,h),k=j1(null,c,_,l,k,h);var R=U1();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Dn(_)?(R=!0,Cu(c)):R=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,b1(c),k.updater=Wu,c.stateNode=k,k._reactInternals=c,$1(c,_,l,h),c=Q1(null,c,_,!0,R,h)):(c.tag=0,Kt&&R&&w1(c),Sn(null,c,k,h),c=c.child),c;case 16:_=c.elementType;e:{switch(Xu(l,c),l=c.pendingProps,k=_._init,_=k(_._payload),c.type=_,k=c.tag=nk(_),l=Ri(_,l),k){case 0:c=Y1(null,c,_,l,h);break e;case 1:c=Iv(null,c,_,l,h);break e;case 11:c=Pv(null,c,_,l,h);break e;case 14:c=Nv(null,c,_,Ri(_.type,l),h);break e}throw Error(s(306,_,""))}return c;case 0:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Ri(_,k),Y1(l,c,_,k,h);case 1:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Ri(_,k),Iv(l,c,_,k,h);case 3:e:{if(Dv(c),l===null)throw Error(s(387));_=c.pendingProps,R=c.memoizedState,k=R.element,Yx(l,c),Bu(c,_,null,h);var B=c.memoizedState;if(_=B.element,qe&&R.isDehydrated)if(R={element:_,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){k=il(Error(s(423)),c),c=Ov(l,c,_,h,k);break e}else if(_!==k){k=il(Error(s(424)),c),c=Ov(l,c,_,h,k);break e}else for(qe&&(li=U(c.stateNode.containerInfo),Wn=c,Kt=!0,Fi=null,yc=!1),h=$x(c,null,_,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Jo(),_===k){c=Ea(l,c,h);break e}Sn(l,c,_,h)}c=c.child}return c;case 5:return Jx(c),l===null&&E1(c),_=c.type,k=c.pendingProps,R=l!==null?l.memoizedProps:null,B=k.children,K(_,k)?B=null:R!==null&&K(_,R)&&(c.flags|=32),bv(l,c),Sn(l,c,B,h),c.child;case 6:return l===null&&E1(c),null;case 13:return Lv(l,c,h);case 4:return I1(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=Zo(c,null,_,h):Sn(l,c,_,h),c.child;case 11:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Ri(_,k),Pv(l,c,_,k,h);case 7:return Sn(l,c,c.pendingProps,h),c.child;case 8:return Sn(l,c,c.pendingProps.children,h),c.child;case 12:return Sn(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(_=c.type._context,k=c.pendingProps,R=c.memoizedProps,B=k.value,Xx(c,_,B),R!==null)if(Ni(R.value,B)){if(R.children===k.children&&!In.current){c=Ea(l,c,h);break e}}else for(R=c.child,R!==null&&(R.return=c);R!==null;){var J=R.dependencies;if(J!==null){B=R.child;for(var de=J.firstContext;de!==null;){if(de.context===_){if(R.tag===1){de=Ca(-1,h&-h),de.tag=2;var De=R.updateQueue;if(De!==null){De=De.shared;var Ke=De.pending;Ke===null?de.next=de:(de.next=Ke.next,Ke.next=de),De.pending=de}}R.lanes|=h,de=R.alternate,de!==null&&(de.lanes|=h),F1(R.return,h,c),J.lanes|=h;break}de=de.next}}else if(R.tag===10)B=R.type===c.type?null:R.child;else if(R.tag===18){if(B=R.return,B===null)throw Error(s(341));B.lanes|=h,J=B.alternate,J!==null&&(J.lanes|=h),F1(B,h,c),B=R.sibling}else B=R.child;if(B!==null)B.return=R;else for(B=R;B!==null;){if(B===c){B=null;break}if(R=B.sibling,R!==null){R.return=B.return,B=R;break}B=B.return}R=B}Sn(l,c,k.children,h),c=c.child}return c;case 9:return k=c.type,_=c.pendingProps.children,tl(c,h),k=ci(k),_=_(k),c.flags|=1,Sn(l,c,_,h),c.child;case 14:return _=c.type,k=Ri(_,c.pendingProps),k=Ri(_.type,k),Nv(l,c,_,k,h);case 15:return Fv(l,c,c.type,c.pendingProps,h);case 17:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Ri(_,k),Xu(l,c),c.tag=1,Dn(_)?(l=!0,Cu(c)):l=!1,tl(c,h),Sv(c,_,k),$1(c,_,k,h),Q1(null,c,_,!0,l,h);case 19:return Bv(l,c,h);case 22:return Rv(l,c,h)}throw Error(s(156,c.tag))};function ly(l,c){return v1(l,c)}function rk(l,c,h,_){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(l,c,h,_){return new rk(l,c,h,_)}function _p(l){return l=l.prototype,!(!l||!l.isReactComponent)}function nk(l){if(typeof l=="function")return _p(l)?1:0;if(l!=null){if(l=l.$$typeof,l===y)return 11;if(l===S)return 14}return 2}function ls(l,c){var h=l.alternate;return h===null?(h=hi(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function df(l,c,h,_,k,R){var B=2;if(_=l,typeof l=="function")_p(l)&&(B=1);else if(typeof l=="string")B=5;else e:switch(l){case d:return so(h.children,k,R,c);case p:B=8,k|=8;break;case m:return l=hi(12,h,c,k|2),l.elementType=m,l.lanes=R,l;case C:return l=hi(13,h,c,k),l.elementType=C,l.lanes=R,l;case E:return l=hi(19,h,c,k),l.elementType=E,l.lanes=R,l;case T:return hf(h,k,R,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:B=10;break e;case g:B=9;break e;case y:B=11;break e;case S:B=14;break e;case x:B=16,_=null;break e}throw Error(s(130,l==null?l:typeof l,""))}return c=hi(B,h,c,k),c.elementType=l,c.type=_,c.lanes=R,c}function so(l,c,h,_){return l=hi(7,l,_,c),l.lanes=h,l}function hf(l,c,h,_){return l=hi(22,l,_,c),l.elementType=T,l.lanes=h,l.stateNode={isHidden:!1},l}function Sp(l,c,h){return l=hi(6,l,null,c),l.lanes=h,l}function wp(l,c,h){return c=hi(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function ik(l,c,h,_,k){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=fe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=m1(0),this.expirationTimes=m1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=m1(0),this.identifierPrefix=_,this.onRecoverableError=k,qe&&(this.mutableSourceEagerHydrationData=null)}function cy(l,c,h,_,k,R,B,J,de){return l=new ik(l,c,h,J,de),c===1?(c=1,R===!0&&(c|=8)):c=0,R=hi(3,null,null,c),l.current=R,R.stateNode=l,R.memoizedState={element:_,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},b1(R),l}function uy(l){if(!l)return ts;l=l._reactInternals;e:{if(b(l)!==l||l.tag!==1)throw Error(s(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Dn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(s(171))}if(l.tag===1){var h=l.type;if(Dn(h))return Ix(l,h,c)}return c}function fy(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=j(c),l===null?null:l.stateNode}function dy(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function pf(l,c){dy(l,c),(l=l.alternate)&&dy(l,c)}function ak(l){return l=j(l),l===null?null:l.stateNode}function sk(){return null}return r.attemptContinuousHydration=function(l){if(l.tag===13){var c=ta(l,134217728);if(c!==null){var h=on();di(c,l,134217728,h)}pf(l,134217728)}},r.attemptDiscreteHydration=function(l){if(l.tag===13){var c=ta(l,1);if(c!==null){var h=on();di(c,l,1,h)}pf(l,1)}},r.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=ss(l),h=ta(l,c);if(h!==null){var _=on();di(h,l,c,_)}pf(l,c)}},r.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=xc(c.pendingLanes);h!==0&&(x1(c,h|1),Mn(c,Lr()),!(dt&6)&&(ol(),ea()))}break;case 13:ey(function(){var _=ta(l,1);if(_!==null){var k=on();di(_,l,1,k)}}),pf(l,1)}},r.batchedUpdates=function(l,c){var h=dt;dt|=1;try{return l(c)}finally{dt=h,dt===0&&(ol(),Nu&&ea())}},r.createComponentSelector=function(l){return{$$typeof:Ju,value:l}},r.createContainer=function(l,c,h,_,k,R,B){return cy(l,c,!1,null,h,_,k,R,B)},r.createHasPseudoClassSelector=function(l){return{$$typeof:Zu,value:l}},r.createHydrationContainer=function(l,c,h,_,k,R,B,J,de){return l=cy(h,_,!0,l,k,R,B,J,de),l.context=uy(null),h=l.current,_=on(),k=ss(h),R=Ca(_,k),R.callback=c??null,ns(h,R,k),l.current.lanes=k,vc(l,k,_),Mn(l,_),l},r.createPortal=function(l,c,h){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:_==null?null:""+_,children:l,containerInfo:c,implementation:h}},r.createRoleSelector=function(l){return{$$typeof:ef,value:l}},r.createTestNameSelector=function(l){return{$$typeof:tf,value:l}},r.createTextSelector=function(l){return{$$typeof:rf,value:l}},r.deferredUpdates=function(l){var c=Tt,h=fr.transition;try{return fr.transition=null,Tt=16,l()}finally{Tt=c,fr.transition=h}},r.discreteUpdates=function(l,c,h,_,k){var R=Tt,B=fr.transition;try{return fr.transition=null,Tt=1,l(c,h,_,k)}finally{Tt=R,fr.transition=B,dt===0&&ol()}},r.findAllNodes=cp,r.findBoundingRects=function(l,c){if(!gr)throw Error(s(363));c=cp(l,c),l=[];for(var h=0;h<c.length;h++)l.push(me(c[h]));for(c=l.length-1;0<c;c--){h=l[c];for(var _=h.x,k=_+h.width,R=h.y,B=R+h.height,J=c-1;0<=J;J--)if(c!==J){var de=l[J],De=de.x,Ke=De+de.width,ot=de.y,Ve=ot+de.height;if(_>=De&&R>=ot&&k<=Ke&&B<=Ve){l.splice(c,1);break}else if(_!==De||h.width!==de.width||Ve<R||ot>B){if(!(R!==ot||h.height!==de.height||Ke<_||De>k)){De>_&&(de.width+=De-_,de.x=_),Ke<k&&(de.width=k-De),l.splice(c,1);break}}else{ot>R&&(de.height+=ot-R,de.y=R),Ve<B&&(de.height=B-ot),l.splice(c,1);break}}}return l},r.findHostInstance=fy,r.findHostInstanceWithNoPortals=function(l){return l=O(l),l=l!==null?ie(l):null,l===null?null:l.stateNode},r.findHostInstanceWithWarning=function(l){return fy(l)},r.flushControlled=function(l){var c=dt;dt|=1;var h=fr.transition,_=Tt;try{fr.transition=null,Tt=1,l()}finally{Tt=_,fr.transition=h,dt=c,dt===0&&(ol(),ea())}},r.flushPassiveEffects=ao,r.flushSync=ey,r.focusWithin=function(l,c){if(!gr)throw Error(s(363));for(l=sp(l),c=qv(l,c),c=Array.from(c),l=0;l<c.length;){var h=c[l++];if(!we(h)){if(h.tag===5&&Pe(h.stateNode))return!0;for(h=h.child;h!==null;)c.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Tt},r.getFindAllNodesFailureDescription=function(l,c){if(!gr)throw Error(s(363));var h=0,_=[];l=[sp(l),0];for(var k=0;k<l.length;){var R=l[k++],B=l[k++],J=c[B];if((R.tag!==5||!we(R))&&(op(R,J)&&(_.push(lp(J)),B++,B>h&&(h=B)),B<c.length))for(R=R.child;R!==null;)l.push(R,B),R=R.sibling}if(h<c.length){for(l=[];h<c.length;h++)l.push(lp(c[h]));return`findAllNodes was able to match part of the selector:
  `+(_.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},r.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return Ae(l.child.stateNode);default:return l.child.stateNode}},r.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ak,findFiberByHostInstance:l.findFiberByHostInstance||sk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Pu=c.inject(l),Zi=c}catch{}l=!!c.checkDCE}}return l},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(l,c,h,_){if(!gr)throw Error(s(363));l=cp(l,c);var k=Me(l,h,_).disconnect;return{disconnect:function(){k()}}},r.registerMutableSourceForHydration=function(l,c){var h=c._getVersion;h=h(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,h]:l.mutableSourceEagerHydrationData.push(c,h)},r.runWithPriority=function(l,c){var h=Tt;try{return Tt=l,c()}finally{Tt=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(l,c,h,_){var k=c.current,R=on(),B=ss(k);return h=uy(h),c.context===null?c.context=h:c.pendingContext=h,c=Ca(R,B),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=ns(k,c,B),l!==null&&(di(l,k,B,R),Mu(l,k,B)),B},r};cw.exports=jM;var UM=cw.exports;const zM=Qd(UM);var uw={exports:{}},Xo={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Xo.ConcurrentRoot=1;Xo.ContinuousEventPriority=4;Xo.DefaultEventPriority=16;Xo.DiscreteEventPriority=1;Xo.IdleEventPriority=536870912;Xo.LegacyRoot=0;uw.exports=Xo;var fw=uw.exports;const p5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let g5=!1,m5=!1;const Fx=".react-konva-event",VM=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,GM=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,HM={};function h1(e,t,r=HM){if(!g5&&"zIndex"in t&&(console.warn(GM),g5=!0),!m5&&t.draggable){var n=t.x!==void 0||t.y!==void 0,i=t.onDragEnd||t.onDragMove;n&&!i&&(console.warn(VM),m5=!0)}for(var a in r)if(!p5[a]){var s=a.slice(0,2)==="on",o=r[a]!==t[a];if(s&&o){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e.off(u,r[a])}var f=!t.hasOwnProperty(a);f&&e.setAttr(a,void 0)}var d=t._useStrictMode,p={},m=!1;const v={};for(var a in t)if(!p5[a]){var s=a.slice(0,2)==="on",g=r[a]!==t[a];if(s&&g){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t[a]&&(v[u]=t[a])}!s&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(m=!0,p[a]=t[a])}m&&(e.setAttrs(p),Ys(e));for(var u in v)e.on(u+Fx,v[u])}function Ys(e){if(!ft.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const dw={},WM={};au.Node.prototype._applyProps=h1;function $M(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Ys(e)}function XM(e,t,r){let n=au[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=au.Group);const i={},a={};for(var s in t){var o=s.slice(0,2)==="on";o?a[s]=t[s]:i[s]=t[s]}const u=new n(i);return h1(u,a),u}function KM(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function YM(e,t,r){return!1}function QM(e){return e}function qM(){return null}function JM(){return null}function ZM(e,t,r,n){return WM}function eB(){}function tB(e){}function rB(e,t){return!1}function nB(){return dw}function iB(){return dw}const aB=setTimeout,sB=clearTimeout,oB=-1;function lB(e,t){return!1}const cB=!1,uB=!0,fB=!0;function dB(e,t){t.parent===e?t.moveToTop():e.add(t),Ys(e)}function hB(e,t){t.parent===e?t.moveToTop():e.add(t),Ys(e)}function hw(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Ys(e)}function pB(e,t,r){hw(e,t,r)}function gB(e,t){t.destroy(),t.off(Fx),Ys(e)}function mB(e,t){t.destroy(),t.off(Fx),Ys(e)}function xB(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function vB(e,t,r){}function yB(e,t,r,n,i){h1(e,i,n)}function _B(e){e.hide(),Ys(e)}function SB(e){}function wB(e,t){(t.visible==null||t.visible)&&e.show()}function kB(e,t){}function CB(e){}function EB(){}const TB=()=>fw.DefaultEventPriority,AB=Object.freeze(Object.defineProperty({__proto__:null,appendChild:dB,appendChildToContainer:hB,appendInitialChild:$M,cancelTimeout:sB,clearContainer:CB,commitMount:vB,commitTextUpdate:xB,commitUpdate:yB,createInstance:XM,createTextInstance:KM,detachDeletedInstance:EB,finalizeInitialChildren:YM,getChildHostContext:iB,getCurrentEventPriority:TB,getPublicInstance:QM,getRootHostContext:nB,hideInstance:_B,hideTextInstance:SB,idlePriority:c0.unstable_IdlePriority,insertBefore:hw,insertInContainerBefore:pB,isPrimaryRenderer:cB,noTimeout:oB,now:c0.unstable_now,prepareForCommit:qM,preparePortalMount:JM,prepareUpdate:ZM,removeChild:gB,removeChildFromContainer:mB,resetAfterCommit:eB,resetTextContent:tB,run:c0.unstable_runWithPriority,scheduleTimeout:aB,shouldDeprioritizeSubtree:rB,shouldSetTextContent:lB,supportsMutation:fB,unhideInstance:wB,unhideTextInstance:kB,warnsIfNotActing:uB},Symbol.toStringTag,{value:"Module"}));var PB=Object.defineProperty,NB=Object.defineProperties,FB=Object.getOwnPropertyDescriptors,x5=Object.getOwnPropertySymbols,RB=Object.prototype.hasOwnProperty,bB=Object.prototype.propertyIsEnumerable,v5=(e,t,r)=>t in e?PB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y5=(e,t)=>{for(var r in t||(t={}))RB.call(t,r)&&v5(e,r,t[r]);if(x5)for(var r of x5(t))bB.call(t,r)&&v5(e,r,t[r]);return e},IB=(e,t)=>NB(e,FB(t)),_5,S5;typeof window<"u"&&((_5=window.document)!=null&&_5.createElement||((S5=window.navigator)==null?void 0:S5.product)==="ReactNative")?Se.useLayoutEffect:Se.useEffect;function pw(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const i=pw(n,t,r);if(i)return i;n=t?null:n.sibling}}function gw(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const w5=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=w5;return}return w5.apply(this,arguments)};const Rx=gw(Se.createContext(null));class mw extends Se.Component{render(){return Se.createElement(Rx.Provider,{value:this._reactInternals},this.props.children)}}function DB(){const e=Se.useContext(Rx);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=Se.useId();return Se.useMemo(()=>{for(const n of[e,e==null?void 0:e.alternate]){if(!n)continue;const i=pw(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===t)return!0;s=s.next}});if(i)return i}},[e,t])}function OB(){const e=DB(),[t]=Se.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==Rx&&!t.has(i)&&t.set(i,Se.useContext(gw(i)))}r=r.return}return t}function LB(){const e=OB();return Se.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>Se.createElement(t,null,Se.createElement(r.Provider,IB(y5({},n),{value:e.get(r)}))),t=>Se.createElement(mw,y5({},t))),[e])}function MB(e){const t=wr.useRef({});return wr.useLayoutEffect(()=>{t.current=e}),wr.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const BB=e=>{const t=wr.useRef(),r=wr.useRef(),n=wr.useRef(),i=MB(e),a=LB(),s=o=>{const{forwardedRef:u}=e;u&&(typeof u=="function"?u(o):u.current=o)};return wr.useLayoutEffect(()=>(r.current=new au.Stage({width:e.width,height:e.height,container:t.current}),s(r.current),n.current=l0.createContainer(r.current,fw.LegacyRoot,!1,null),l0.updateContainer(wr.createElement(a,{},e.children),n.current),()=>{au.isBrowser&&(s(null),l0.updateContainer(null,n.current,null),r.current.destroy())}),[]),wr.useLayoutEffect(()=>{s(r.current),h1(r.current,e,i),l0.updateContainer(wr.createElement(a,{},e.children),n.current,null)}),wr.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},jB="Layer",Qc="Group",Xn="Rect",qc="Circle",k5="Line",ca="Text",l0=zM(AB);l0.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:wr.version,rendererPackageName:"react-konva"});const UB=wr.forwardRef((e,t)=>wr.createElement(mw,{},wr.createElement(BB,{...e,forwardedRef:t}))),Jc=[{level:0,threshold:.1,description:"Ultra Low - Package outline only"},{level:1,threshold:.3,description:"Low - Package + major banks"},{level:2,threshold:.7,description:"Medium - + pin circles"},{level:3,threshold:1.5,description:"High - + pin/signal names"},{level:4,threshold:1/0,description:"Ultra High - All details"}];function zB(e){for(let t=0;t<Jc.length;t++)if(e<Jc[t].threshold)return Jc[t].level;return Jc[Jc.length-1].level}function VB(e,t){return e>=t}function GB(e){switch(e){case 0:return 1;case 1:return .8;case 2:return .6;case 3:return .4;case 4:return .2;default:return .5}}function HB(e){switch(e){case 0:return 50;case 1:return 200;case 2:return 500;case 3:return 1e3;case 4:return 5e3;default:return 1e3}}function WB(e,t="pin"){return e>={pin:.7,signal:.7,bank:.3}[t]}function $B(e,t=12){if(e<.5)return 0;const r=t*Math.min(e,2);return Math.max(8,Math.min(r,24))}function XB(e){return e>=.3}function KB(e){return e>=.7}class Cn{}Cn.getLODLevel=zB;Cn.shouldRenderAtLOD=VB;Cn.getPerformanceMultiplier=GB;Cn.getMaxElements=HB;Cn.shouldRenderText=WB;Cn.getAdaptiveTextSize=$B;Cn.shouldRenderDifferentialPairs=XB;Cn.shouldRenderPinDetails=KB;class Ur{static createVirtualizedPinList(t,r,n){const i=Math.ceil(r/n)+5;return{getVisibleRange:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length);return{startIndex:s,endIndex:o}},getVisiblePins:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length),{startIndex:u,endIndex:f}={startIndex:s,endIndex:o};return t.slice(u,f).map((d,p)=>({pin:d,index:u+p,top:(u+p)*n}))},getTotalHeight:()=>t.length*n}}static createDebouncedSearch(t,r=300){let n,i=[];return{search:a=>new Promise(s=>{if(clearTimeout(n),!a.trim()){s([]);return}n=setTimeout(()=>{i=t(a),s(i)},r)}),getLastResults:()=>i,cancel:()=>{clearTimeout(n)}}}static optimizeCanvasRendering(){return{getLODLevel:t=>t<.3?"ultra-low":t<.6?"low":t<1.2?"medium":t<2.5?"high":"ultra-high",cullPins:(t,r)=>{const i={left:r.x-100,right:r.x+r.width+100,top:r.y-100,bottom:r.y+r.height+100};return t.filter(a=>{const s=a.position.x*r.scale,o=a.position.y*r.scale;return s>=i.left&&s<=i.right&&o>=i.top&&o<=i.bottom})},batchDOMUpdates:t=>{requestAnimationFrame(()=>{t.forEach(r=>r())})}}}static createPinIndexes(t){const r=new Map,n=new Map,i=new Map,a=new Map,s=new Map;return t.forEach(o=>{r.set(o.id,o),n.set(o.pinNumber,o),o.signalName&&(i.has(o.signalName)||i.set(o.signalName,[]),i.get(o.signalName).push(o)),o.bank&&(a.has(o.bank)||a.set(o.bank,[]),a.get(o.bank).push(o)),s.has(o.pinType)||s.set(o.pinType,[]),s.get(o.pinType).push(o)}),{byId:r,byPinNumber:n,bySignalName:i,byBank:a,byPinType:s,findById:o=>r.get(o),findByPinNumber:o=>n.get(o),findBySignalName:o=>i.get(o)||[],findByBank:o=>a.get(o)||[],findByPinType:o=>s.get(o)||[]}}static startRenderMeasurement(t){this.renderMetrics.set(t,performance.now())}static endRenderMeasurement(t){const r=this.renderMetrics.get(t);if(!r)return 0;const n=performance.now()-r;return this.renderMetrics.delete(t),n}static trackFrameRate(){this.frameCount++;const t=performance.now();if(t-this.lastFrameTime>=1e3){const r=this.frameCount/((t-this.lastFrameTime)/1e3);return this.frameCount=0,this.lastFrameTime=t,r}return null}static createSmartFilter(t){return{filter:(r,n)=>{const i=[];for(const a of t){if(n&&i.length>=n)break;let s=!0;for(const o of r)if(!o(a)){s=!1;break}s&&i.push(a)}return i}}}static createPinSearchRanker(){return{rankPins:(t,r)=>{const n=r.toLowerCase(),i=[];return t.forEach(a=>{let s=0;a.pinNumber.toLowerCase()===n?s+=100:a.pinNumber.toLowerCase().startsWith(n)?s+=80:a.pinNumber.toLowerCase().includes(n)&&(s+=40),a.signalName&&a.signalName.toLowerCase().includes(n)&&(s+=60),a.pinName.toLowerCase().includes(n)&&(s+=30),a.bank&&a.bank.toLowerCase().includes(n)&&(s+=20),s>0&&i.push({pin:a,score:s})}),i.sort((a,s)=>s.score-a.score)}}}}Ur.renderMetrics=new Map;Ur.frameCount=0;Ur.lastFrameTime=performance.now();const YB=({fileName:e,viewInfo:t})=>w.jsxs("div",{style:{width:"100%",height:"32px",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0 16px",position:"relative",zIndex:2,color:"#e0e0e0",fontSize:"12px",fontWeight:500,boxSizing:"border-box",borderBottom:"1px solid #333"},children:[w.jsx("span",{style:{transform:"translateY(-2px)"},children:t}),w.jsx("span",{style:{transform:"translateY(-2px)",marginLeft:"360px"},children:e})]}),QB=({package:e,pins:t,selectedPins:r,onPinSelect:n,onPinDoubleClick:i,zoom:a,rotation:s,isTopView:o,onZoomChange:u,resetTrigger:f=0})=>{const{togglePinSelection:d,selectPins:p,visibleBanks:m,toggleBankVisibility:v,showAllBanks:g,pins:y}=$i(),C=Se.useRef(null),E=Se.useRef(null),[S,x]=Se.useState({width:800,height:600}),[T,F]=Se.useState(null),[N,A]=Se.useState({x:0,y:0,scale:1}),[P,b]=Se.useState(!1),[I,O]=Se.useState({x:0,y:0}),[j,q]=Se.useState(0),[ie,te]=Se.useState({x:0,y:0});console.log(` PackageCanvas: Received ${t.length} pins (filtered)`);const Ae=Cn.getLODLevel(N.scale),Ee=Se.useMemo(()=>{Ur.startRenderMeasurement("pin-indexing");const _e=Ur.createPinIndexes(t);return Ur.endRenderMeasurement("pin-indexing"),_e},[t]),re=Se.useMemo(()=>{Ur.startRenderMeasurement("viewport-culling");const _e=S.width,me=S.height,ke={x:-N.x/N.scale-_e/(2*N.scale),y:-N.y/N.scale-me/(2*N.scale),width:_e/N.scale,height:me/N.scale,scale:N.scale},we=(Ce,Pe)=>{let{x:Me,y:pe}=Ce.position;if(s!==0){const ae=s*Math.PI/180,xe=Math.cos(ae),be=Math.sin(ae),Le=Me*xe-pe*be,Xe=Me*be+pe*xe;Me=Le,pe=Xe}return o||(Me=-Me),Me>=Pe.x&&Me<=Pe.x+Pe.width&&pe>=Pe.y&&pe<=Pe.y+Pe.height};if(N.scale>.6){const Ce=200/N.scale,Pe={...ke,x:ke.x-Ce,y:ke.y-Ce*1.5,width:ke.width+Ce*2,height:ke.height+Ce*2.5},Me=Array.from(r).map(be=>Ee.findById(be)).filter(Boolean),pe=t.filter(be=>we(be,Pe)),ae=new Map;pe.forEach(be=>ae.set(be.id,be)),Me.forEach(be=>ae.set(be.id,be));const xe=Array.from(ae.values());return Ur.endRenderMeasurement("viewport-culling"),xe}else{if(N.scale<=.2)return Ur.endRenderMeasurement("viewport-culling"),t;if(N.scale<=.4){const Pe=new Map;t.forEach(ae=>{const xe=ae.bank||"NA";Pe.has(xe)||Pe.set(xe,[]),Pe.get(xe).push(ae)});const Me=[],pe=Array.from(r).map(ae=>Ee.findById(ae)).filter(Boolean);return Me.push(...pe),Pe.forEach(ae=>{const xe=Math.max(1,Math.floor(ae.length*.85)),be=Math.max(1,Math.floor(ae.length/xe));for(let Le=0;Le<ae.length;Le+=be){const Xe=ae[Le];r.has(Xe.id)||Me.push(Xe)}}),Ur.endRenderMeasurement("viewport-culling"),Me}else if(N.scale<=.6){const Ce=300/N.scale,Pe={x:ke.x-Ce,y:ke.y-Ce*1.5,width:ke.width+Ce*2,height:ke.height+Ce*2.5},Me=Array.from(r).map(gt=>Ee.findById(gt)).filter(Boolean),pe=t.filter(gt=>we(gt,Pe)),ae=t.filter(gt=>!pe.some(Bt=>Bt.id===gt.id)&&!r.has(gt.id)),xe=Math.max(1,Math.floor(ae.length/200)),be=ae.filter((gt,Bt)=>Bt%xe===0),Le=new Map;Me.forEach(gt=>Le.set(gt.id,gt)),pe.forEach(gt=>Le.set(gt.id,gt)),be.forEach(gt=>Le.set(gt.id,gt));const Xe=Array.from(Le.values());return Ur.endRenderMeasurement("viewport-culling"),Xe}else{const Ce=new Map;t.forEach(pe=>{const ae=pe.bank||"NA";Ce.has(ae)||Ce.set(ae,[]),Ce.get(ae).push(pe)});const Pe=Math.max(10,Math.floor(800/Ce.size)),Me=[];return Ce.forEach(pe=>{const ae=pe.filter(be=>r.has(be.id));Me.push(...ae);const xe=Pe-ae.length;if(xe>0){const be=pe.filter(Xe=>!r.has(Xe.id)),Le=Math.max(1,Math.floor(be.length/xe));for(let Xe=0;Xe<be.length&&Me.length-ae.length<xe;Xe+=Le)Me.push(be[Xe])}}),Ur.endRenderMeasurement("viewport-culling"),Me}}},[t,N,r,S,Ee]),X=200,he=8,Te=(_e,me)=>{if(me.ctrlKey||me.metaKey)d(_e),F(_e);else if(me.shiftKey&&T){const ke=t.findIndex(Ce=>Ce.id===_e),we=t.findIndex(Ce=>Ce.id===T);if(ke!==-1&&we!==-1){const Ce=Math.min(ke,we),Pe=Math.max(ke,we),Me=t.slice(Ce,Pe+1).map(ae=>ae.id),pe=new Set(r);Me.forEach(ae=>pe.add(ae)),p(Array.from(pe))}}else n(_e),F(_e)};Se.useEffect(()=>{var we,Ce;const _e=()=>{var Me;const Pe=(Me=C.current)==null?void 0:Me.container();if(Pe){const pe=Pe.getBoundingClientRect(),ae={width:Math.max(400,pe.width),height:Math.max(300,pe.height)};x(xe=>xe.width!==ae.width||xe.height!==ae.height?(console.log(" Canvas size updated for dynamic maximization:",ae),ae):xe)}},me=setTimeout(()=>{_e()},200),ke=(Ce=(we=C.current)==null?void 0:we.container())==null?void 0:Ce.parentElement;if(ke){const Pe=new ResizeObserver(()=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{_e()},16)});return Pe.observe(ke),()=>{clearTimeout(me),E.current&&clearTimeout(E.current),Pe.disconnect()}}return()=>{clearTimeout(me)}},[]),Se.useEffect(()=>{if(e&&t.length>0&&S.width>0&&S.height>0){const _e=ue();if(_e){const{width:me,height:ke,centerX:we,centerY:Ce}=_e,Pe=0,Me=S.width-Pe*2,pe=S.height-Pe*2,ae=Me/me,xe=pe/ke,be=Math.max(.8,Math.min(ae,xe,2)),Le={x:S.width/2,y:S.height/2+30},Xe={x:Le.x-we*be,y:Le.y-Ce*be,scale:be};console.log(" Auto-fit viewport:",Xe,"for package:",me,"x",ke,"scale:",be),A(Xe)}}},[e,t.length,S]);const L=_e=>{var me;return _e.pinType==="GROUND"||_e.pinName==="GND"?xo("GROUND"):_e.pinType==="POWER"||(me=_e.pinName)!=null&&me.includes("VCC")?xo("POWER"):xo(_e.bank)},Q=_e=>({IO:"#FFF",CONFIG:"#FFD700",POWER:"#FF4500",GROUND:"#000",MGT:"#9B4AE2",CLOCK:"#FF69B4",ADC:"#00FFFF",SPECIAL:"#FF1493",MIO:"#32CD32",DDR:"#8A2BE2",NC:"#696969",RESERVED:"#999999"})[_e.pinType]||"#FFF",Y=(_e,me,ke)=>{if(!Sr.isDifferentialPin(_e))return null;const we=Sr.findPairPin(_e,me);if(!we)return null;const Ce=ke.has(_e.id),Pe=ke.has(we.id);return Ce||Pe?(Sr.getDifferentialPairType(_e.pinName)||(_e.signalName?Sr.getDifferentialPairType(_e.signalName):null))==="positive"?"#FF3333":"#FF9933":null},K=(_e,me)=>Sr.isDifferentialPin(_e)?Sr.findPairPin(_e,me)!==null:!1,ue=()=>{if(!e||t.length===0)return{width:600,height:600,centerX:300,centerY:300,minX:0,minY:0,maxX:600,maxY:600};const _e=t.map(jt=>{var ar;return(ar=jt.gridPosition)==null?void 0:ar.row}).filter(Boolean),me=t.map(jt=>{var ar;return(ar=jt.gridPosition)==null?void 0:ar.col}).filter(Boolean);console.log(` Found rows: ${_e.join(", ")}`);const ke=Math.min(..._e.map(jt=>Os(jt))),we=Math.max(..._e.map(jt=>Os(jt))),Ce=Math.min(...me),Pe=Math.max(...me);console.log(` Row indices - min: ${ke} (${cl(ke)}), max: ${we} (${cl(we)})`),console.log(` Col indices - min: ${Ce}, max: ${Pe}`);const pe=88,ae=(Pe-Ce+1)*pe,xe=(we-ke+1)*pe,be=0,Le=ae+be*2,Xe=xe+be*2,gt=(Ce+Pe-1)*pe/2,Bt=(ke+we)*pe/2;return{width:Le,height:Xe,centerX:gt,centerY:Bt,minX:(Ce-1)*pe,minY:ke*pe,maxX:Pe*pe,maxY:(we+1)*pe,gridSpacing:pe,minRow:ke,maxRow:we,minCol:Ce,maxCol:Pe}},V=ue();Se.useEffect(()=>{t.length>0&&console.log(" PackageCanvas: Package loaded with",t.length,"pins")},[t.length]);const Z=_e=>{let{x:me,y:ke}=_e.position;if(s!==0){const pe=s*Math.PI/180,ae=Math.cos(pe),xe=Math.sin(pe),be=me*ae-ke*xe,Le=me*xe+ke*ae;me=be,ke=Le}o||(me=-me);const we=S.width,Ce=S.height,Pe=me*N.scale+N.x+we/2,Me=ke*N.scale+N.y+Ce/2;return{x:Pe,y:Me}},fe=(_e,me)=>{const ke=ue(),we=ke.width*me,Ce=ke.height*me,Pe=S.width,Me=S.height,pe=Pe*.5,ae=Me*.8,xe=-(we/2+pe),be=we/2+pe,Le=-(Ce/2+ae*1.5),Xe=Ce/2+ae;return{x:Math.max(xe,Math.min(be,_e.x)),y:Math.max(Le,Math.min(Xe,_e.y))}},ve=_e=>{_e.evt.preventDefault();const me=C.current;if(!me)return;const ke=me.getPointerPosition(),we=1.05;if(_e.evt.ctrlKey){const Ce=N.scale,Pe=_e.evt.deltaY>0?Ce/we:Ce*we,Me=Math.max(.1,Math.min(5,Pe)),pe={x:(ke.x-N.x)/Ce,y:(ke.y-N.y)/Ce},ae={x:ke.x-pe.x*Me,y:ke.y-pe.y*Me},xe=fe(ae,Me);A({scale:Me,x:xe.x,y:xe.y}),u==null||u(Me)}else{const Ce=N.y-_e.evt.deltaY*.5,Pe=fe({x:N.x,y:Ce},N.scale);A(Me=>({...Me,x:Pe.x,y:Pe.y}))}},Be=()=>{const _e=C.current;if(!_e)return;const me=_e.getPointerPosition(),ke=Date.now();q(ke),te(me),O(me),b(!1)},G=()=>{const _e=C.current;if(!_e)return;const me=_e.getPointerPosition(),ke=Date.now();if(!P&&j>0){const we=ke-j,Ce=Math.sqrt(Math.pow(me.x-ie.x,2)+Math.pow(me.y-ie.y,2));(we>X||Ce>he)&&b(!0)}if(P){const we=me.x-I.x,Ce=me.y-I.y,Pe={x:N.x+we,y:N.y+Ce},Me=fe(Pe,N.scale);A(pe=>({...pe,x:Me.x,y:Me.y}))}O(me)},qe=()=>{b(!1),q(0)},et=()=>{b(!1),q(0)},Ye=()=>{A({x:0,y:0,scale:1}),u==null||u(1)};Se.useEffect(()=>{Math.abs(a-1)<.001?A({x:0,y:0,scale:1}):A(_e=>({..._e,scale:a}))},[a,f]),Se.useEffect(()=>{const _e=me=>{(me.key==="r"||me.key==="R")&&Ye()};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[]);const Qe=(_e,me)=>{const ke=Date.now();if(j>0){const we=ke-j,Ce=C.current;if(Ce&&we<X){const Pe=Ce.getPointerPosition();Math.sqrt(Math.pow(Pe.x-ie.x,2)+Math.pow(Pe.y-ie.y,2))<he&&!P&&(_e.cancelBubble=!0,Te(me.id,_e.evt))}}},Fe=(_e,me)=>{_e.cancelBubble=!0,i(me.id)},St=_e=>{const me=Date.now();if(!P&&j>0){const ke=me-j,we=C.current;if(we&&ke<X){const Ce=we.getPointerPosition();Math.sqrt(Math.pow(Ce.x-ie.x,2)+Math.pow(Ce.y-ie.y,2))<he&&_e.target===_e.target.getStage()&&n("")}}};if(!e)return w.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"No package loaded. Please import a CSV file."});if(S.width<=0||S.height<=0)return w.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"Loading canvas..."});const Or=`View: ${o?"TOP":"BOTTOM"} | Rotation: ${s} | Zoom: ${Math.round(a*100)}%`,gr=e?`${e.device}pkg.csv (${e.packageType})`:"No package loaded";return w.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column"},children:[w.jsx(YB,{fileName:gr,viewInfo:Or}),w.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[w.jsx("div",{style:{position:"absolute",top:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:N.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:ke,minRow:we,maxRow:Ce}=V;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=me;pe<=ke;pe++){const ae=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!ae)continue;const be={left:Z(ae).x-10,top:-5};be.left>=-50&&be.left<=S.width+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...be,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`top-col-${pe}`))}else for(let pe=we;pe<=Ce;pe++){const ae=cl(pe),xe=t.find(Xe=>Xe.gridPosition&&Xe.gridPosition.row===ae);if(!xe)continue;const Le={left:Z(xe).x-10,top:-5};Le.left>=-50&&Le.left<=S.width+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ae},`top-row-${pe}`))}return Pe})()}),w.jsx("div",{style:{position:"absolute",top:16,right:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:N.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:ke,minRow:we,maxRow:Ce}=V;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=we;pe<=Ce;pe++){const ae=cl(pe),xe=t.find(Xe=>Xe.gridPosition&&Xe.gridPosition.row===ae);if(!xe)continue;const Le={left:-5,top:Z(xe).y-8};Le.top>=-50&&Le.top<=S.height+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ae},`right-row-${pe}`))}else for(let pe=me;pe<=ke;pe++){const ae=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!ae)continue;const be={left:-5,top:Z(ae).y-8};be.top>=-50&&be.top<=S.height+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...be,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`right-col-${pe}`))}return Pe})()}),w.jsx("div",{style:{position:"absolute",bottom:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:N.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:ke,minRow:we,maxRow:Ce}=V;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=me;pe<=ke;pe++){const ae=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!ae)continue;const be={left:Z(ae).x-10,top:-5};be.left>=-50&&be.left<=S.width+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...be,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`bottom-col-${pe}`))}else for(let pe=we;pe<=Ce;pe++){const ae=cl(pe),xe=t.find(Xe=>Xe.gridPosition&&Xe.gridPosition.row===ae);if(!xe)continue;const Le={left:Z(xe).x-10,top:-5};Le.left>=-50&&Le.left<=S.width+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ae},`bottom-row-${pe}`))}return Pe})()}),w.jsx("div",{style:{position:"absolute",top:16,left:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:N.scale>.1&&(()=>{const{gridSpacing:_e,minCol:me,maxCol:ke,minRow:we,maxRow:Ce}=V;if(!_e)return null;const Pe=[];if(s===0||s===180)for(let pe=we;pe<=Ce;pe++){const ae=cl(pe),xe=t.find(Xe=>Xe.gridPosition&&Xe.gridPosition.row===ae);if(!xe)continue;const Le={left:-5,top:Z(xe).y-8};Le.top>=-50&&Le.top<=S.height+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...Le,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ae},`left-row-${pe}`))}else for(let pe=me;pe<=ke;pe++){const ae=t.find(Le=>Le.gridPosition&&Le.gridPosition.col===pe);if(!ae)continue;const be={left:-5,top:Z(ae).y-8};be.top>=-50&&be.top<=S.height+50&&Pe.push(w.jsx("div",{style:{position:"absolute",...be,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:pe},`left-col-${pe}`))}return Pe})()}),w.jsx("div",{style:{position:"absolute",top:16,left:16,right:16,bottom:16,overflow:"hidden"},children:w.jsx(UB,{ref:_e=>{C.current=_e,_e&&setTimeout(()=>{const me=_e.container();if(me){const ke=me.getBoundingClientRect(),we={width:Math.max(400,ke.width),height:Math.max(300,ke.height)};x(Ce=>Ce.width!==we.width||Ce.height!==we.height?(console.log(" Stage mounted - Canvas size updated:",we),we):Ce)}},50)},width:Math.max(100,S.width),height:Math.max(100,S.height),x:0,y:0,onClick:St,onWheel:ve,onMouseDown:Be,onMouseMove:G,onMouseUp:qe,onMouseLeave:et,style:{cursor:P?"grabbing":"grab"},children:w.jsxs(jB,{children:[(()=>{const{gridSpacing:_e,minRow:me,maxRow:ke,minCol:we,maxCol:Ce}=V;if(!_e)return null;const Pe=(Le,Xe)=>Z({position:{x:Le,y:Xe}}),Me=0,pe=Pe((we-1.5)*_e-Me,(me-.5)*_e-Me),ae=Pe((Ce+.5)*_e+Me,(me-.5)*_e-Me),xe=Pe((we-1.5)*_e-Me,(ke+.5)*_e+Me),be=Pe((Ce+.5)*_e+Me,(ke+.5)*_e+Me);return w.jsx(w.Fragment,{children:w.jsx(k5,{points:[pe.x,pe.y,ae.x,ae.y,be.x,be.y,xe.x,xe.y,pe.x,pe.y],stroke:"#555",strokeWidth:2,dash:[5,5],closed:!0,fill:"rgba(40, 40, 40, 0.3)"})})})(),!1,(()=>{Ur.startRenderMeasurement("pin-rendering");const me=Math.max(20,88*N.scale),ke=Cn.shouldRenderPinDetails(N.scale),we=Cn.shouldRenderText(N.scale,"pin"),Ce=Cn.shouldRenderText(N.scale,"signal"),Pe=Cn.getAdaptiveTextSize(N.scale,12)/12,Me=re,pe=Ur.endRenderMeasurement("pin-rendering");return console.log(` Smart culling: Rendering ${Me.length}/${t.length} pins (${pe.toFixed(2)}ms)`),Me.map(ae=>{const xe=Z(ae),be=r.has(ae.id),Le=L(ae),Xe=Q(ae),gt=N.scale*10*Pe,Bt=Math.max(8,Math.min(20,gt)),jt=Math.max(6,Math.min(16,N.scale*8*Pe)),ar=Y(ae,re,r),Za=K(ae,t),Oe=ke||be;return w.jsxs(Qc,{children:[w.jsx(Xn,{x:xe.x-me/2,y:xe.y-me/2,width:me,height:me,fill:Le,stroke:"#000",strokeWidth:1,cornerRadius:4,onClick:Ue=>Qe(Ue,ae),onDblClick:Ue=>Fe(Ue,ae),style:{cursor:"pointer"}}),ar&&w.jsx(Xn,{x:xe.x-me/2-2,y:xe.y-me/2-2,width:me+4,height:me+4,fill:"transparent",stroke:ar,strokeWidth:2,cornerRadius:6,listening:!1}),w.jsx(qc,{x:xe.x,y:xe.y,radius:Math.max(8,me*.3),fill:Xe,stroke:"#000",strokeWidth:1,listening:!1}),Za&&!ar&&me>40&&w.jsx(qc,{x:xe.x+me*.3,y:xe.y-me*.3,radius:3,fill:"#FF6600",stroke:"#FFF",strokeWidth:1,listening:!1}),ar&&w.jsx(qc,{x:xe.x,y:xe.y,radius:Math.max(10,me*.4),fill:"transparent",stroke:ar,strokeWidth:3,listening:!1,dash:[5,5]}),w.jsx(Xn,{x:xe.x-ae.pinNumber.length*Bt/4-2,y:xe.y-Bt/2-2,width:ae.pinNumber.length*Bt/2+4,height:Bt+4,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,listening:!1}),w.jsx(ca,{x:xe.x,y:xe.y-Bt/2,text:ae.pinNumber,fontSize:Bt,fill:"#FFF",align:"center",onClick:Ue=>Qe(Ue,ae),onDblClick:Ue=>Fe(Ue,ae),style:{cursor:"pointer"},fontStyle:"bold",offsetX:ae.pinNumber.length*Bt/4,listening:!1}),ae.pinName&&Oe&&we&&me>50&&w.jsxs(w.Fragment,{children:[w.jsx(Xn,{x:xe.x-(ae.pinName.length>14?17:ae.pinName.length)*jt/4-2,y:xe.y+Bt/2+1,width:(ae.pinName.length>14?17:ae.pinName.length)*jt/2+4,height:jt+4,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),w.jsx(ca,{x:xe.x,y:xe.y+Bt/2+3,text:ae.pinName.length>14?ae.pinName.substring(0,14)+"...":ae.pinName,fontSize:jt,fill:"#E0E0E0",align:"center",onClick:Ue=>Qe(Ue,ae),onDblClick:Ue=>Fe(Ue,ae),style:{cursor:"pointer"},offsetX:(ae.pinName.length>14?17:ae.pinName.length)*jt/4,listening:!1})]}),ae.signalName&&ae.signalName.trim()!==""&&Ce&&w.jsxs(w.Fragment,{children:[w.jsx(Xn,{x:xe.x-(ae.signalName.length>12?15:ae.signalName.length)*jt*.35-6,y:xe.y+Bt/2+3+jt-1,width:(ae.signalName.length>12?15:ae.signalName.length)*jt*.7+12,height:jt+6,fill:"rgba(255, 215, 0, 0.9)",cornerRadius:3,listening:!1}),w.jsx(ca,{x:xe.x,y:xe.y+Bt/2+3+jt+2,text:ae.signalName.length>12?ae.signalName.substring(0,12)+"...":ae.signalName,fontSize:jt,fill:"#000",align:"center",onClick:Ue=>Qe(Ue,ae),onDblClick:Ue=>Fe(Ue,ae),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(ae.signalName.length>12?15:ae.signalName.length)*jt/4,listening:!1})]})]},ae.id)})})(),Cn.shouldRenderDifferentialPairs(N.scale)&&(()=>{Ur.startRenderMeasurement("diff-pair-lines");const _e=[],me=new Set;re.forEach(we=>{if(!me.has(we.id)&&Sr.isDifferentialPin(we)){const Ce=Sr.findPairPin(we,t),Pe=Ce&&re.includes(Ce),Me=r.has(we.id)||Ce&&r.has(Ce.id);if(Ce&&!me.has(Ce.id)&&(Pe||Me)){me.add(we.id),me.add(Ce.id);const pe=Z(we),ae=Z(Ce),xe=Y(we,re,r),be=Y(Ce,re,r),Le=xe||be||"#FF6600",Xe=Math.sqrt(Math.pow(ae.x-pe.x,2)+Math.pow(ae.y-pe.y,2));if(Xe>50&&_e.push(w.jsx(k5,{points:[pe.x,pe.y,ae.x,ae.y],stroke:Le,strokeWidth:2,opacity:.6,dash:[8,4],listening:!1},`diff-pair-${we.id}-${Ce.id}`)),Xe>100&&N.scale>.4){const gt=(pe.x+ae.x)/2,Bt=(pe.y+ae.y)/2,ar=Sr.getDifferentialPairType(we.pinName)==="positive"?"+/-":"-/+";_e.push(w.jsxs(Qc,{children:[w.jsx(Xn,{x:gt-10,y:Bt-8,width:20,height:16,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),w.jsx(ca,{x:gt,y:Bt-6,text:ar,fontSize:10,fill:Le,align:"center",offsetX:10,listening:!1})]},`diff-label-${we.id}-${Ce.id}`))}}}});const ke=Ur.endRenderMeasurement("diff-pair-lines");return console.log(` Differential pairs: ${_e.length} lines (${ke.toFixed(2)}ms)`),_e})(),Cn.shouldRenderAtLOD(Ae,2)&&(()=>{Ur.startRenderMeasurement("bank-boundaries");const _e=new Map;re.forEach(pe=>{const ae=pe.bank||"NA";_e.has(ae)||_e.set(ae,[]),_e.get(ae).push(pe)});const ke=Math.max(20,88*N.scale),we=6,Ce=new Map;Array.from(_e.entries()).forEach(([pe,ae])=>{if(pe==="NA"||ae.length<2)return;const xe=ae.map(Le=>Z(Le)),be={minX:Math.min(...xe.map(Le=>Le.x))-ke/2-we,maxX:Math.max(...xe.map(Le=>Le.x))+ke/2+we,minY:Math.min(...xe.map(Le=>Le.y))-ke/2-we,maxY:Math.max(...xe.map(Le=>Le.y))+ke/2+we,bankKey:pe,pins:ae};Ce.set(pe,be)});const Pe=Array.from(Ce.entries()).map(([pe,ae])=>{const xe=L(ae.pins[0]);return w.jsx(Xn,{x:ae.minX,y:ae.minY,width:ae.maxX-ae.minX,height:ae.maxY-ae.minY,fill:`${xe}10`,stroke:"transparent",cornerRadius:6,opacity:.3,listening:!1},`bank-boundary-${pe}`)}),Me=Ur.endRenderMeasurement("bank-boundaries");return console.log(` Bank boundaries: ${Ce.size} boundaries (${Me.toFixed(2)}ms)`),Pe})(),(()=>{const me=Math.max(20,88*N.scale);return t.filter(ke=>r.has(ke.id)).map(ke=>{const we=Z(ke);return w.jsx(Xn,{x:we.x-me/2-2,y:we.y-me/2-2,width:me+4,height:me+4,fill:"transparent",stroke:"#FFD700",strokeWidth:3,cornerRadius:4,onClick:Ce=>Qe(Ce,ke),onDblClick:Ce=>Fe(Ce,ke),style:{cursor:"pointer"}},`highlight-${ke.id}`)})})(),w.jsxs(Qc,{x:10,y:S.height-200,children:[(()=>{const _e="Bank Groups";return w.jsxs(w.Fragment,{children:[w.jsx(Xn,{x:24,y:-2,width:_e.length*6+8,height:16,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,onClick:()=>{console.log(" Bank Groups header clicked - showing all banks!"),g()},onMouseEnter:me=>{var we;const ke=me.target;ke.fill("rgba(0, 0, 0, 0.9)"),(we=ke.getLayer())==null||we.batchDraw()},onMouseLeave:me=>{var we;const ke=me.target;ke.fill("rgba(0, 0, 0, 0.7)"),(we=ke.getLayer())==null||we.batchDraw()},style:{cursor:"pointer"}}),w.jsx(ca,{x:27,y:0,text:_e,fontSize:12,fill:"#4AE24A",onClick:()=>{console.log(" Bank Groups text clicked - showing all banks!"),g()},onMouseEnter:me=>{var we;const ke=me.target;ke.fill("#fff"),(we=ke.getLayer())==null||we.batchDraw()},onMouseLeave:me=>{var we;const ke=me.target;ke.fill("#4AE24A"),(we=ke.getLayer())==null||we.batchDraw()},style:{cursor:"pointer"}})]})})(),(()=>[...new Set(y.map(me=>me.bank).filter(Boolean))].sort((me,ke)=>{const we=parseInt(me),Ce=parseInt(ke);return we-Ce}).slice(0,6).map((me,ke)=>{const we=m.size===0||m.has(me);return w.jsxs(Qc,{y:20+ke*18,x:27,children:[w.jsx(Xn,{x:8,y:-8,width:`Bank ${me}`.length*6+20,height:16,fill:"rgba(0, 0, 0, 0)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:1,cornerRadius:2,onClick:()=>{console.log(` BANK ${me} CLICKED!`),console.log("Before: visibleBanks =",Array.from(m)),console.log(`Before: Bank ${me} is visible =`,m.has(me)),console.log("Before: Total pins received =",t.length),v(me)},onMouseEnter:Ce=>{var Me;const Pe=Ce.target;Pe.stroke("rgba(255, 255, 255, 0.3)"),(Me=Pe.getLayer())==null||Me.batchDraw()},onMouseLeave:Ce=>{var Me;const Pe=Ce.target;Pe.stroke("rgba(255, 255, 255, 0.1)"),(Me=Pe.getLayer())==null||Me.batchDraw()},style:{cursor:"pointer"}}),w.jsx(qc,{x:12,y:2,radius:4,fill:we?xo(me):"#444",stroke:we?"#000":"#666",strokeWidth:1,listening:!1}),w.jsx(Xn,{x:23,y:-8,width:`Bank ${me}`.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),w.jsx(ca,{x:25,y:-6,text:`Bank ${me}`,fontSize:10,fill:we?"#ccc":"#666",listening:!1}),w.jsx(ca,{x:10,y:-6,text:we?"":"",fontSize:8,listening:!1})]},me)}))(),w.jsx(Xn,{x:117,y:-2,width:130,height:16,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2}),w.jsx(ca,{x:120,y:0,text:"Pin Types (Circle):",fontSize:12,fill:"#ccc"}),(()=>{const _e=[...new Set(t.map(ke=>ke.pinType).filter(Boolean))].sort(),me={IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999",MIO:"#32CD32",DDR:"#8A2BE2"};return _e.map((ke,we)=>w.jsxs(Qc,{y:20+we*18,x:120,children:[w.jsx(qc,{x:12,y:2,radius:4,fill:me[ke]||"#666666",stroke:"#000",strokeWidth:1}),w.jsx(ca,{x:25,y:-6,text:ke,fontSize:10,fill:"#999"}),w.jsx(Xn,{x:23,y:-8,width:ke.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2}),w.jsx(ca,{x:25,y:-6,text:ke,fontSize:10,fill:"#ccc"})]},ke))})()]})]})})})]})]})};class Kn{static createSaveData(t){var n,i,a,s,o,u;const r=new Date().toISOString();return{metadata:{version:this.SAVE_VERSION,created:r,modified:r,appVersion:"1.0.0",description:`FPGA Pin Planning Project - ${((n=t.package)==null?void 0:n.device)||"Unknown Device"}`,author:"FPGA Pin Planner User"},package:{device:((i=t.package)==null?void 0:i.device)||"",packageType:((a=t.package)==null?void 0:a.packageType)||""},pins:t.pins.map(f=>({id:f.id,pinNumber:f.pinNumber,pinName:f.pinName,assignedSignalName:f.signalName,comment:f.comment,bank:f.bank,pinType:f.pinType,gridPosition:f.gridPosition,differentialPair:f.differentialPair})),viewSettings:{zoom:t.viewConfig.zoom,rotation:t.viewConfig.rotation,isTopView:t.viewConfig.isTopView,viewport:t.viewConfig.viewport||{x:0,y:0,scale:1},selectedPins:Array.from(t.selectedPins),filters:t.filters},projectSettings:{listViewActiveTab:((s=t.listView)==null?void 0:s.activeTab)||"overview",sidebarWidth:((o=t.ui)==null?void 0:o.sidebarWidth)||300,showDifferentialPairs:((u=t.ui)==null?void 0:u.showDifferentialPairs)||!1,customSettings:t.projectSettings||{}},history:t.history||{currentIndex:0,actions:[]}}}static async saveToFile(t,r){const n=t.package.device.replace(/[^a-zA-Z0-9]/g,"_"),i=new Date().toISOString().split("T")[0],a=`${n}_project_${i}${this.FILE_EXTENSION}`,s=r||a,o=JSON.stringify(t,null,2),u=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=s,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}static async loadFromFile(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=JSON.parse(o);if(!this.isCompatibleVersion(u.metadata.version))throw new Error(`Incompatible save file version: ${u.metadata.version}`);if(!u.package||!u.pins||!Array.isArray(u.pins))throw new Error("Invalid save file format: missing required fields");r(u)}catch(o){n(new Error(`Failed to parse save file: ${o}`))}},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static restoreProject(t){const r={id:`package-${Date.now()}`,name:t.package.device,device:t.package.device,packageType:t.package.packageType,dimensions:{rows:Math.max(...t.pins.map(i=>{var a;return Os(((a=i.gridPosition)==null?void 0:a.row)||"A")+1})),cols:Math.max(...t.pins.map(i=>{var a;return((a=i.gridPosition)==null?void 0:a.col)||1}))},totalPins:t.pins.length,pins:t.pins.map(i=>({id:i.id,pinNumber:i.pinNumber,pinName:i.pinName,signalName:i.assignedSignalName||i.originalSignalName||"",direction:"InOut",pinType:i.pinType,voltage:"3.3V",packagePin:i.pinNumber,position:this.gridToPosition(i.gridPosition||{row:"A",col:1}),gridPosition:i.gridPosition||{row:"A",col:1},isAssigned:!!i.assignedSignalName,bank:i.bank||"NA",comment:i.comment||"",differentialPair:i.differentialPair}))};return{id:`project-${Date.now()}`,name:t.metadata.description||`Restored Project ${new Date().toLocaleDateString()}`,description:t.metadata.description||"",created:new Date(t.metadata.created),modified:new Date(t.metadata.modified),projectInfo:{device:t.package.device,package:t.package.packageType,speedGrade:t.package.speedGrade||"-1",temperature:"C"},packageData:r,pinAssignments:r.pins,viewConfig:{rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,zoom:t.viewSettings.zoom,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},filters:{pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"pinNumber",sortOrder:"asc"}}}static restoreAppState(t,r){return{pins:r.pins.map(i=>{const a=t.pins.find(s=>s.id===i.id||s.pinNumber===i.pinNumber);return a?{...i,signalName:a.assignedSignalName||i.signalName,comment:a.comment||i.comment,differentialPair:a.differentialPair||i.differentialPair}:i}),selectedPins:new Set(t.viewSettings.selectedPins),viewConfig:{zoom:t.viewSettings.zoom,rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,viewport:t.viewSettings.viewport},filters:t.viewSettings.filters,listView:{activeTab:t.projectSettings.listViewActiveTab||"overview"},ui:{sidebarWidth:t.projectSettings.sidebarWidth,showDifferentialPairs:t.projectSettings.showDifferentialPairs},history:t.history,projectSettings:t.projectSettings.customSettings}}static isCompatibleVersion(t){const[r]=t.split(".").map(Number),[n]=this.SAVE_VERSION.split(".").map(Number);return r<=n}static quickSave(t){try{const r=this.createSaveData(t),n=this.compressData(r);localStorage.setItem(this.QUICKSAVE_KEY,n),localStorage.setItem(this.QUICKSAVE_TIMESTAMP_KEY,new Date().toISOString()),console.log(" Quick save completed")}catch(r){throw console.error("Failed to quick save:",r),new Error(`Quick save failed: ${r}`)}}static quickLoad(){try{const t=localStorage.getItem(this.QUICKSAVE_KEY);return t?this.decompressData(t):null}catch(t){return console.error("Failed to load quicksave:",t),null}}static getQuickSaveInfo(){const t=localStorage.getItem(this.QUICKSAVE_TIMESTAMP_KEY);return{exists:localStorage.getItem(this.QUICKSAVE_KEY)!==null,timestamp:t||void 0}}static clearQuickSave(){localStorage.removeItem(this.QUICKSAVE_KEY),localStorage.removeItem(this.QUICKSAVE_TIMESTAMP_KEY)}static compressData(t){const r={metadata:{version:t.metadata.version,created:t.metadata.created},package:t.package,pins:t.pins.map(n=>({id:n.id,pinNumber:n.pinNumber,assignedSignalName:n.assignedSignalName,comment:n.comment,...n.differentialPair&&{differentialPair:n.differentialPair},...n.custom&&Object.keys(n.custom).length>0&&{custom:n.custom}})),viewSettings:t.viewSettings,projectSettings:t.projectSettings};return JSON.stringify(r)}static decompressData(t){const r=JSON.parse(t);return{metadata:{version:r.metadata.version,created:r.metadata.created,modified:new Date().toISOString(),appVersion:"1.0.0",description:"Quick Save Data"},package:r.package,pins:r.pins,viewSettings:r.viewSettings,projectSettings:r.projectSettings||{},constraints:{},history:{currentIndex:0,actions:[]}}}static gridToPosition(t){const r=Os(t.row),i=88,a=(t.col-1)*i,s=r*i;return{x:Math.round(a),y:Math.round(s)}}}Kn.SAVE_VERSION="1.0.0";Kn.FILE_EXTENSION=".fpgaproj";Kn.QUICKSAVE_KEY="fpga-planner-quicksave";Kn.QUICKSAVE_TIMESTAMP_KEY="fpga-planner-quicksave-timestamp";const qB=()=>{const e=Se.useRef(null),[t,r]=Se.useState(!1),[n,i]=Se.useState(""),{package:a,pins:s,selectedPins:o,viewConfig:u,loadProject:f}=$i(),d=()=>({package:a,pins:s,selectedPins:o,viewConfig:u,listView:{activeTab:"overview"},ui:{sidebarWidth:300,showDifferentialPairs:!1},filters:{},history:{currentIndex:0,actions:[]},projectSettings:{}}),p=(S,x=3e3)=>{i(S),setTimeout(()=>i(""),x)},m=()=>typeof window.vscode<"u",v=async()=>{console.log(" handleSave called");try{if(r(!0),!a||s.length===0)throw new Error("No project data to save");const S=d(),x=Kn.createSaveData(S);if(console.log(" Save data created:",x),m()){console.log(" VS Code environment detected");try{const T=window.vscode,F=x.package.device.replace(/[^a-zA-Z0-9]/g,"_"),N=new Date().toISOString().split("T")[0],A=`${F}_project_${N}.fpgaproj`;console.log(" Default filename:",A);const P=await new Promise(b=>{const I=O=>{console.log(" Received save dialog message:",O.data),O.data.command==="saveDialogResult"&&(window.removeEventListener("message",I),b(O.data.result))};window.addEventListener("message",I),console.log(" Sending showSaveDialog message"),T.postMessage({command:"showSaveDialog",options:{saveLabel:"Save FPGA Project",filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}})});if(P){console.log(" Save location selected:",P);let b;if(typeof P=="string")b=P;else if(P&&typeof P=="object"){const j=P;b=j.fsPath||j.path,!b&&typeof P.toString=="function"&&(b=P.toString())}if(console.log(" Extracted file path:",b),!b)throw new Error("Failed to extract file path from URI");const I=JSON.stringify(x,null,2);console.log(" Sending file save request");const O=await new Promise(j=>{const q=ie=>{console.log(" Received save result:",ie.data),ie.data.command==="saveFileResult"&&(window.removeEventListener("message",q),j(ie.data.success))};window.addEventListener("message",q),T.postMessage({command:"saveFile",filePath:b,content:I,filename:A})});if(console.log(" Save result:",O),O)p(" Project saved successfully!");else throw new Error("File save operation failed")}else console.log(" No save location selected")}catch(T){console.error("VS Code save failed:",T),await Kn.saveToFile(x),p(" Project saved successfully!")}}else await Kn.saveToFile(x),p(" Project saved successfully!")}catch(S){console.error("Save failed:",S),p(` Save failed: ${S}`,5e3)}finally{r(!1)}},g=async S=>{var T,F;const x=(T=S.target.files)==null?void 0:T[0];if(x)try{r(!0);const N=await Kn.loadFromFile(x),A=Kn.restoreProject(N);console.log("Loading project:",A.name),console.log("Package device:",(F=A.packageData)==null?void 0:F.device),console.log("Pin assignments count:",A.pinAssignments.length),f(A),console.log(" Project loaded successfully"),p(` Project loaded: ${N.metadata.description}`),S.target.value=""}catch(N){console.error("Load failed:",N),p(` Load failed: ${N}`,5e3)}finally{r(!1)}},y=()=>{try{if(!a||s.length===0)throw new Error("No project data to save");const S=d();Kn.quickSave(S),p(" Quick save completed")}catch(S){console.error("Quick save failed:",S),p(` Quick save failed: ${S}`,5e3)}},C=async()=>{try{const S=Kn.quickLoad();if(!S){p(" No quick save found");return}const x=Kn.restoreProject(S);f(x),p(" Quick save loaded")}catch(S){console.error("Quick load failed:",S),p(` Quick load failed: ${S}`,5e3)}},E=Kn.getQuickSaveInfo();return wr.useEffect(()=>{const S=x=>{var T;if(x.ctrlKey||x.metaKey)switch(x.key.toLowerCase()){case"s":x.preventDefault(),a&&s.length>0&&y();break;case"l":x.preventDefault(),E.exists?C():(T=e.current)==null||T.click();break}};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[a,s.length,E.exists]),w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",position:"relative"},children:[w.jsx("button",{onClick:v,disabled:t||!a||s.length===0,title:"Save Project ()",style:{padding:"6px 8px",backgroundColor:"#00a8ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t||!a||s.length===0?.5:1},children:""}),w.jsx("button",{onClick:()=>{var S;return(S=e.current)==null?void 0:S.click()},disabled:t,title:"Load Project ()",style:{padding:"6px 8px",backgroundColor:"#ffa500",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t?.5:1},children:""}),w.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:g,style:{display:"none"}}),w.jsx("button",{onClick:y,disabled:t||!a||s.length===0,title:"Quick Save (Ctrl+S)",style:{padding:"6px 8px",backgroundColor:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",opacity:t||!a||s.length===0?.5:1},children:""}),n&&w.jsx("div",{style:{position:"absolute",top:"40px",right:"0",padding:"8px 12px",backgroundColor:n.includes("")?"#dc3545":"#28a745",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:n})]})},JB=({className:e=""})=>{const{canUndo:t,canRedo:r,currentActionDescription:n,nextRedoActionDescription:i,undo:a,redo:s}=$i(),o=u=>({padding:"6px",backgroundColor:u?"#333":"#222",border:"1px solid #555",borderRadius:"4px",color:u?"#ccc":"#666",cursor:u?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",transition:"background-color 0.2s"});return w.jsxs("div",{className:`flex flex-row items-center ${e}`,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[w.jsx("button",{onClick:a,disabled:!t,title:`Undo${n?`: ${n}`:""} (Ctrl+Z)`,style:{...o(t),borderRadius:"4px 0 0 4px",borderRight:"none"},onMouseEnter:u=>{t&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{t&&(u.currentTarget.style.backgroundColor="#333")},children:w.jsx(ZB,{className:"w-3 h-3"})}),w.jsx("button",{onClick:s,disabled:!r,title:`Redo${i?`: ${i}`:""} (Ctrl+Y)`,style:{...o(r),borderRadius:"0 4px 4px 0"},onMouseEnter:u=>{r&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{r&&(u.currentTarget.style.backgroundColor="#333")},children:w.jsx(ej,{className:"w-3 h-3"})})]})},ZB=({className:e})=>w.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[w.jsx("path",{d:"M3 7v6h6"}),w.jsx("path",{d:"m21 17a9 9 0 00-9-9 9 9 0 00-6 2.3l-3 3"})]}),ej=({className:e})=>w.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[w.jsx("path",{d:"M21 7v6h-6"}),w.jsx("path",{d:"m3 17a9 9 0 019-9 9 9 0 016 2.3l3 3"})]}),tj=({isOpen:e,onClose:t})=>{if(!e)return null;const r=[{key:"Ctrl+Z",description:"Undo"},{key:"Ctrl+Y",description:"Redo"},{key:"Ctrl+O",description:"Open CSV file"},{key:"Ctrl+S",description:"Save project"},{key:"Ctrl+E",description:"Export XDC file"},{key:"Ctrl+F",description:"Focus search field"},{key:"Click",description:"Select pin"},{key:"Ctrl+Click",description:"Toggle pin selection"},{key:"Shift+Click",description:"Range select pins"},{key:"Ctrl+A",description:"Select all pins"},{key:"Ctrl+D",description:"Deselect all"},{key:"Space",description:"Rotate view 90 degrees"},{key:"F",description:"Toggle top/bottom view"},{key:"R",description:"Reset zoom and pan"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"Escape",description:"Deselect all"},{key:"Delete",description:"Unassign selected pins"}];return w.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:w.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-hidden flex flex-col",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Keyboard Shortcuts"}),w.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-xl",children:""})]}),w.jsx("div",{className:"flex-1 overflow-y-auto",children:w.jsx("div",{className:"space-y-1",children:r.map((n,i)=>w.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-50",children:[w.jsx("span",{className:"text-sm text-gray-600",children:n.description}),w.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-gray-100 rounded border",children:n.key})]},i))})}),w.jsx("div",{className:"mt-4 pt-4 border-t",children:w.jsx("button",{onClick:t,className:"w-full py-2 px-4 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Close"})})]})})},rj=({validationResult:e,onIssueClick:t,onPinHighlight:r,className:n=""})=>{const[i,a]=Se.useState(!0),[s,o]=Se.useState("all"),[u,f]=Se.useState("all"),d=g=>{switch(g){case"pin_conflict":return"Pin Conflict";case"differential_pair":return"Differential Pair";case"bank_constraint":return"Bank Constraint";case"clock_constraint":return"Clock Constraint";default:return g}},p=(e==null?void 0:e.issues.filter(g=>{const y=s==="all"||g.severity===s,C=u==="all"||g.type===u;return y&&C}))||[],m=g=>{t==null||t(g),r==null||r(g.affectedPins)},v=g=>{switch(g){case"error":return"";case"warning":return"";case"info":return""}};return e?w.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[w.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),w.jsx("button",{onClick:()=>a(!i),className:"text-gray-500 hover:text-gray-700",children:i?"":""})]})}),w.jsx("div",{className:"flex-1 overflow-y-auto right-sidebar-scroll",children:i&&w.jsxs("div",{className:"p-4",children:[w.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.summary.errorCount}),w.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.summary.warningCount}),w.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.summary.infoCount}),w.jsx("div",{className:"text-xs text-gray-500",children:"Info"})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Severity"}),w.jsxs("select",{value:s,onChange:g=>o(g.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsxs("option",{value:"all",children:["All Issues (",e.issues.length,")"]}),w.jsxs("option",{value:"error",children:["Errors (",e.summary.errorCount,")"]}),w.jsxs("option",{value:"warning",children:["Warnings (",e.summary.warningCount,")"]}),w.jsxs("option",{value:"info",children:["Info (",e.summary.infoCount,")"]})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Type"}),w.jsxs("select",{value:u,onChange:g=>f(g.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"all",children:"All Types"}),Array.from(new Set(e.issues.map(g=>g.type))).map(g=>w.jsx("option",{value:g,children:d(g)},g))]})]})]}),w.jsx("div",{className:"mt-4 space-y-2 max-h-64 overflow-y-auto right-sidebar-scroll",children:p.map((g,y)=>w.jsxs("div",{onClick:()=>m(g),className:`p-3 rounded-lg cursor-pointer transition-colors ${g.severity==="error"?"bg-red-50 border border-red-200 hover:bg-red-100":g.severity==="warning"?"bg-yellow-50 border border-yellow-200 hover:bg-yellow-100":"bg-blue-50 border border-blue-200 hover:bg-blue-100"}`,children:[w.jsxs("div",{className:"flex items-start justify-between mb-1",children:[w.jsx("span",{className:"text-sm",children:v(g.severity)}),w.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded",children:d(g.type)})]}),w.jsx("p",{className:"text-xs mb-2 line-clamp-2",children:g.description}),g.affectedPins.length>0&&w.jsxs("div",{className:"text-xs mb-2",children:[w.jsx("span",{className:"font-medium",children:"Affected pins: "}),w.jsxs("span",{className:"font-mono",children:[g.affectedPins.slice(0,3).join(", "),g.affectedPins.length>3&&` +${g.affectedPins.length-3} more`]})]}),g.suggestion&&w.jsxs("div",{className:"text-xs mt-2 p-2 bg-white bg-opacity-50 rounded",children:[w.jsx("span",{className:"font-medium",children:" Suggestion: "}),g.suggestion]})]},y))})]})}),w.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-3 bg-white",children:w.jsx("div",{className:"text-xs text-gray-500 text-center",children:(e==null?void 0:e.lastChecked)&&w.jsxs(w.Fragment,{children:["Last checked: ",new Date(e.lastChecked).toLocaleTimeString()]})})})]}):w.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[w.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),w.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No validation data available"})]}),w.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-4xl mb-2",children:""}),w.jsx("div",{className:"text-sm",children:"Run validation to see results"})]})})]})},nj=({validationResult:e,className:t=""})=>{if(!e)return w.jsx("div",{className:`inline-flex items-center text-gray-400 ${t}`,children:w.jsx("span",{className:"text-sm",children:""})});const{summary:r}=e;return r.errorCount>0?w.jsxs("div",{className:`inline-flex items-center text-red-600 ${t}`,children:[w.jsx("span",{className:"text-sm",children:""}),w.jsx("span",{className:"ml-1 text-xs font-bold",children:r.errorCount})]}):r.warningCount>0?w.jsxs("div",{className:`inline-flex items-center text-yellow-600 ${t}`,children:[w.jsx("span",{className:"text-sm",children:""}),w.jsx("span",{className:"ml-1 text-xs font-bold",children:r.warningCount})]}):w.jsx("div",{className:`inline-flex items-center text-green-600 ${t}`,children:w.jsx("span",{className:"text-sm",children:""})})};class Zc{static assignArrayPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(r.startIndex>r.endIndex)throw new Error("Start index must be less than or equal to end index");const i=[];for(let s=r.startIndex;s<=r.endIndex;s+=r.step){const o=r.padding>0?s.toString().padStart(r.padding,"0"):s.toString(),u=r.indexFormat.replace("{i}",o).replace("{index}",o);i.push(r.baseName+u)}const a=Math.min(t.length,i.length);for(let s=0;s<a;s++){const o=t[s],u=i[s];if(o.pinType&&["POWER","GROUND","NC"].includes(o.pinType)){n.skippedPins++,n.errors.push(`Skipped ${o.pinNumber}: Cannot assign to ${o.pinType} pin`);continue}n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:u}),n.processedPins++}}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static assignDifferentialPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(!r.positiveFormat||!r.negativeFormat)throw new Error("Both positive and negative formats are required");t.length%2!==0&&n.errors.push(`Warning: Odd number of pins (${t.length}). Last pin will be skipped.`);const i=Math.floor(t.length/2);for(let a=0;a<i;a++){const s=t[a*2],o=t[a*2+1],u=s.pinType&&["POWER","GROUND","NC"].includes(s.pinType),f=o.pinType&&["POWER","GROUND","NC"].includes(o.pinType);if(u||f){n.skippedPins+=2,n.errors.push(`Skipped pair ${s.pinNumber}/${o.pinNumber}: Cannot assign to ${s.pinType}/${o.pinType} pins`);continue}let d=r.baseName;if(r.indexFormat&&r.startIndex!==void 0){const v=(r.startIndex||0)+a,g=r.padding&&r.padding>0?v.toString().padStart(r.padding,"0"):v.toString();d=r.indexFormat.replace("{i}",g).replace("{index}",g),d=r.baseName+d}const p=d+r.positiveFormat,m=d+r.negativeFormat;n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:s.signalName,newSignal:p}),n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:m}),n.processedPins+=2}t.length%2!==0&&n.skippedPins++}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static filterPinsByCriteria(t,r){return t.filter(n=>{if(r.pinTypes&&r.pinTypes.length>0&&(!n.pinType||!r.pinTypes.includes(n.pinType))||r.banks&&r.banks.length>0&&(!n.bank||!r.banks.includes(n.bank))||r.voltages&&r.voltages.length>0&&(!n.voltage||!r.voltages.includes(n.voltage)))return!1;if(r.assignmentStatus){const i=n.signalName&&n.signalName.trim()!=="";if(r.assignmentStatus==="assigned"&&!i||r.assignmentStatus==="unassigned"&&i)return!1}if(r.pinNumberPattern)try{if(!new RegExp(r.pinNumberPattern).test(n.pinNumber))return!1}catch{}if(r.gridRange&&n.gridPosition){const{rowStart:i,rowEnd:a,colStart:s,colEnd:o}=r.gridRange;if(i&&n.gridPosition.row<i||a&&n.gridPosition.row>a||s&&n.gridPosition.col<s||o&&n.gridPosition.col>o)return!1}return!0})}static clearSignals(t){const r={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{for(const n of t)n.signalName&&n.signalName.trim()!==""?(r.assignments.push({pinId:n.id,pinNumber:n.pinNumber,oldSignal:n.signalName,newSignal:""}),r.processedPins++):r.skippedPins++}catch(n){r.success=!1,r.errors.push(n instanceof Error?n.message:"Unknown error occurred")}return r}static validateBatchOperation(t,r){const n=[];if(t.length===0)return n.push("No pins selected for batch operation"),n;t.length>1e3&&n.push(`Warning: Large dataset (${t.length} pins). Operation may take some time.`);const i=new Set(t.map(a=>a.pinType).filter(Boolean));return i.size>1&&(i.has("POWER")||i.has("GROUND"))&&n.push("Warning: Selection includes power/ground pins which cannot be assigned signals"),r==="differential"&&(t.length<2&&n.push("At least 2 pins required for differential pair assignment"),new Set(t.map(s=>s.bank).filter(Boolean)).size>1&&n.push("Warning: Differential pairs should typically be in the same bank")),n}static previewBatchOperation(t,r,n){try{let i;return n==="array"?i=this.assignArrayPattern(t,r):i=this.assignDifferentialPattern(t,r),i.assignments.map(a=>({pinNumber:a.pinNumber,currentSignal:a.oldSignal||"",newSignal:a.newSignal}))}catch{return[]}}static setVoltageAndIO(t,r){var i,a;const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.voltage&&!r.ioStandard)throw new Error("At least voltage or I/O standard must be specified");r.voltage&&!hx.includes(r.voltage)&&n.errors.push(`Invalid voltage: ${r.voltage}`),r.ioStandard&&!px.includes(r.ioStandard)&&r.ioStandard!=="AUTO"&&n.errors.push(`Invalid I/O standard: ${r.ioStandard}`);for(const s of t){if(!["IO","CLOCK"].includes(s.pinType)&&r.voltage){n.skippedPins++;continue}let o=s.voltage,u=((i=s.attributes)==null?void 0:i.IO_Standard)||s.ioType||"AUTO";if(r.voltage&&(o=r.voltage),r.ioStandard)if(r.ioStandard==="AUTO"||r.autoDetectIO)u=Zl(o||"3.3V");else{if(o&&!OI(o,r.ioStandard)){n.errors.push(`I/O standard ${r.ioStandard} is not compatible with voltage ${o} for pin ${s.pinNumber}`),n.skippedPins++;continue}u=r.ioStandard}else r.autoDetectIO&&o&&(u=Zl(o));n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:`${s.voltage||"Unknown"}V / ${((a=s.attributes)==null?void 0:a.IO_Standard)||s.ioType||"Unknown"}`,newSignal:`${o}V / ${u}`}),n.processedPins++}n.processedPins===0&&n.skippedPins>0&&(n.errors.push("No pins were processed. All pins were skipped."),n.success=!1)}catch(s){n.success=!1,n.errors.push(s instanceof Error?s.message:"Unknown error occurred")}return n}static setPinDirections(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!["Input","Output","InOut","Clock","Reset"].includes(r))throw new Error(`Invalid direction: ${r}`);for(const a of t){if(!["IO","CLOCK"].includes(a.pinType)){n.skippedPins++;continue}const s=a.direction||"Unknown";n.assignments.push({pinId:a.id,pinNumber:a.pinNumber,oldSignal:`Direction: ${s}`,newSignal:`Direction: ${r}`}),n.processedPins++}n.processedPins===0&&(n.errors.push("No I/O pins found to update"),n.success=!1)}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}}const ij=({isVisible:e})=>{const{pins:t,selectedPins:r,assignSignal:n}=$i(),[i,a]=Se.useState("array"),[s,o]=Se.useState("manual"),[u,f]=Se.useState(!1),[d,p]=Se.useState({baseName:"DATA",startIndex:0,endIndex:31,indexFormat:"[{i}]",padding:0,step:1}),[m,v]=Se.useState({voltage:"3.3V",ioStandard:"AUTO",autoDetectIO:!0,driveStrength:12,slewRate:"FAST"}),[g,y]=Se.useState("Input"),[C,E]=Se.useState({pinTypes:["IO"],assignmentStatus:"unassigned"}),[S,x]=Se.useState(null),T=Se.useMemo(()=>s==="manual"?t.filter(P=>r.has(P.id)):Zc.filterPinsByCriteria(t,C),[t,r,s,C]),F=Se.useMemo(()=>i==="clear"?[]:i==="voltage-io"||i==="direction"?T.length===0?["No pins selected"]:[]:T.length===0?["No pins selected"]:[],[T,i]),N=()=>{let P;switch(i){case"array":P=Zc.assignArrayPattern(T,d);break;case"voltage-io":P=Zc.setVoltageAndIO(T,m);break;case"direction":P=Zc.setPinDirections(T,g);break;case"clear":P=Zc.clearSignals(T);break;default:return}const b={...P,errors:P.errors.filter(I=>!I.includes("Need")&&!I.includes("pins, got")&&!I.includes("Not enough pins")&&!I.includes("pins selected"))};x(b),f(!0)},A=()=>{if(!S)return;const P=`Batch ${i} operation on ${S.processedPins} pins`,b=S.assignments.map(I=>({pinId:I.pinId,oldSignal:I.oldSignal||"",newSignal:I.newSignal}));Tr.recordAction("batch_operation",b,P),S.assignments.forEach(I=>{if(i==="voltage-io"){const{updatePin:O}=$i.getState();O(I.pinId,{voltage:m.voltage,attributes:{IO_Standard:m.ioStandard==="AUTO"?Zl(m.voltage||"3.3V"):m.ioStandard||"LVCMOS33"},ioType:m.ioStandard==="AUTO"?Zl(m.voltage||"3.3V"):m.ioStandard||"LVCMOS33"})}else if(i==="direction"){const{updatePin:O}=$i.getState();O(I.pinId,{direction:g})}else n(I.pinId,I.newSignal)}),f(!1),x(null)};return e?w.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[w.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Batch Operations"}),w.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Assign patterns to multiple pins efficiently"})]}),w.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"operationType",value:"array",checked:i==="array",onChange:P=>a(P.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:"Array Pattern (DATA[0], DATA[1], ...)"})]}),w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"operationType",value:"voltage-io",checked:i==="voltage-io",onChange:P=>a(P.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:"Voltage & I/O Standards"})]}),w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"operationType",value:"direction",checked:i==="direction",onChange:P=>a(P.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:"Pin Directions"})]}),w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"operationType",value:"clear",checked:i==="clear",onChange:P=>a(P.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:"Clear Signals"})]})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Selection"}),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"selectionMode",value:"manual",checked:s==="manual",onChange:P=>o(P.target.value),className:"mr-2"}),w.jsxs("span",{className:"text-sm",children:["Use Selected Pins (",r.size,")"]})]}),w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"selectionMode",value:"criteria",checked:s==="criteria",onChange:P=>o(P.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:"Auto-select by Criteria"})]})]})]}),s==="criteria"&&w.jsxs("div",{className:"space-y-4 p-3 bg-blue-50 rounded-lg",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Types"}),w.jsx("div",{className:"space-x-4",children:["IO","POWER","GROUND","CLOCK"].map(P=>{var b;return w.jsxs("label",{className:"inline-flex items-center",children:[w.jsx("input",{type:"checkbox",checked:(b=C.pinTypes)==null?void 0:b.includes(P),onChange:I=>{I.target.checked?E(O=>({...O,pinTypes:[...O.pinTypes||[],P]})):E(O=>{var j;return{...O,pinTypes:((j=O.pinTypes)==null?void 0:j.filter(q=>q!==P))||[]}})},className:"mr-1"}),w.jsx("span",{className:"text-xs",children:P})]},P)})})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Status"}),w.jsxs("select",{value:C.assignmentStatus,onChange:P=>E(b=>({...b,assignmentStatus:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"any",children:"Any"}),w.jsx("option",{value:"assigned",children:"Assigned"}),w.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),w.jsxs("div",{className:"text-xs text-gray-600",children:["Matches ",T.length," pins"]})]}),i==="array"&&w.jsxs("div",{className:"space-y-3 p-3 bg-green-50 rounded-lg",children:[w.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Array Pattern Configuration"}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Base Name"}),w.jsx("input",{type:"text",value:d.baseName,onChange:P=>p(b=>({...b,baseName:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"DATA"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Index Format"}),w.jsx("input",{type:"text",value:d.indexFormat,onChange:P=>p(b=>({...b,indexFormat:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"[{i}]"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Index"}),w.jsx("input",{type:"number",value:d.startIndex,onChange:P=>p(b=>({...b,startIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Index"}),w.jsx("input",{type:"number",value:d.endIndex,onChange:P=>p(b=>({...b,endIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Step"}),w.jsx("input",{type:"number",value:d.step,onChange:P=>p(b=>({...b,step:parseInt(P.target.value)||1})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"1"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Padding"}),w.jsx("input",{type:"number",value:d.padding,onChange:P=>p(b=>({...b,padding:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0"})]})]}),w.jsxs("div",{className:"text-xs text-gray-600",children:["Preview: ",d.baseName,d.indexFormat.replace("{i}",d.startIndex.toString().padStart(d.padding,"0"))]})]}),i==="voltage-io"&&w.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded-lg",children:[w.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Voltage & I/O Standard Configuration"}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voltage Level"}),w.jsxs("select",{value:m.voltage||"",onChange:P=>v(b=>({...b,voltage:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"",children:"Keep current"}),hx.map(P=>w.jsx("option",{value:P,children:P},P))]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"I/O Standard"}),w.jsxs("select",{value:m.ioStandard||"",onChange:P=>v(b=>({...b,ioStandard:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"",children:"Keep current"}),w.jsx("option",{value:"AUTO",children:"AUTO (based on voltage)"}),px.map(P=>w.jsx("option",{value:P,children:P},P))]})]})]}),w.jsx("div",{className:"flex items-center space-x-4",children:w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"checkbox",checked:m.autoDetectIO||!1,onChange:P=>v(b=>({...b,autoDetectIO:P.target.checked})),className:"mr-2"}),w.jsx("span",{className:"text-xs",children:"Auto-detect I/O standard"})]})}),w.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Drive Strength (mA)"}),w.jsxs("select",{value:m.driveStrength||"",onChange:P=>v(b=>({...b,driveStrength:parseInt(P.target.value)})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"",children:"Keep current"}),w.jsx("option",{value:"2",children:"2 mA"}),w.jsx("option",{value:"4",children:"4 mA"}),w.jsx("option",{value:"6",children:"6 mA"}),w.jsx("option",{value:"8",children:"8 mA"}),w.jsx("option",{value:"12",children:"12 mA"}),w.jsx("option",{value:"16",children:"16 mA"}),w.jsx("option",{value:"20",children:"20 mA"}),w.jsx("option",{value:"24",children:"24 mA"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Slew Rate"}),w.jsxs("select",{value:m.slewRate||"",onChange:P=>v(b=>({...b,slewRate:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[w.jsx("option",{value:"",children:"Keep current"}),w.jsx("option",{value:"SLOW",children:"SLOW"}),w.jsx("option",{value:"FAST",children:"FAST"})]})]})]})]}),i==="direction"&&w.jsxs("div",{className:"space-y-3 p-3 bg-orange-50 rounded-lg",children:[w.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Pin Direction Configuration"}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Direction"}),w.jsx("div",{className:"space-y-2",children:["Input","Output","InOut","Clock","Reset"].map(P=>w.jsxs("label",{className:"flex items-center",children:[w.jsx("input",{type:"radio",name:"direction",value:P,checked:g===P,onChange:b=>y(b.target.value),className:"mr-2"}),w.jsx("span",{className:"text-sm",children:P})]},P))})]})]}),w.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg",children:[w.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Target Summary"}),w.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[w.jsxs("div",{children:["Selected pins: ",T.length]}),w.jsxs("div",{children:["Operation: ",i]}),F.length>0&&w.jsxs("div",{className:"text-red-600",children:[w.jsx("div",{className:"font-medium",children:"Validation Issues:"}),w.jsx("ul",{className:"text-xs mt-1 space-y-1",children:F.map((P,b)=>w.jsxs("li",{children:[" ",P]},b))})]})]})]}),w.jsx("div",{children:w.jsx("button",{onClick:N,disabled:T.length===0||F.length>0,className:"w-full py-3 px-4 bg-blue-500 text-black rounded-lg hover:bg-blue-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-blue-600",children:"Generate Preview"})}),u&&S&&w.jsxs("div",{className:"border rounded-lg bg-white",children:[w.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[w.jsx("h4",{className:"font-medium text-gray-800",children:"Preview Results"}),w.jsx("p",{className:"text-sm text-gray-600 mt-1",children:S.success?`${S.processedPins} pins will be assigned`:"Operation preview failed"})]}),S.errors.length>0&&w.jsxs("div",{className:"p-3 bg-red-50 border-b",children:[w.jsx("h5",{className:"text-sm font-medium text-red-800 mb-1",children:"Errors:"}),w.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:S.errors.map((P,b)=>w.jsxs("li",{children:[" ",P]},b))})]}),S.assignments.length>0&&w.jsxs("div",{className:"p-4",children:[w.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Assignments"}),w.jsx("div",{className:"max-h-48 overflow-y-auto border rounded custom-scrollbar",children:w.jsxs("table",{className:"w-full text-sm",children:[w.jsx("thead",{className:"bg-gray-50 sticky top-0",children:w.jsxs("tr",{children:[w.jsx("th",{className:"px-3 py-2 text-left",children:"Pin"}),w.jsx("th",{className:"px-3 py-2 text-left",children:"Current"}),w.jsx("th",{className:"px-3 py-2 text-left",children:"New"})]})}),w.jsxs("tbody",{children:[S.assignments.slice(0,50).map((P,b)=>w.jsxs("tr",{className:"border-t",children:[w.jsx("td",{className:"px-3 py-2 font-mono",children:P.pinNumber}),w.jsx("td",{className:"px-3 py-2 text-gray-600",children:P.oldSignal||"-"}),w.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:P.newSignal})]},b)),S.assignments.length>50&&w.jsx("tr",{children:w.jsxs("td",{colSpan:3,className:"px-3 py-2 text-center text-gray-500 italic",children:["... and ",S.assignments.length-50," more"]})})]})]})})]})]})]}),u&&S&&w.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:w.jsxs("div",{className:"flex gap-3",children:[w.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),w.jsx("button",{onClick:A,disabled:!S.success||S.processedPins===0,className:"flex-1 py-2 px-4 bg-green-500 text-black rounded-lg hover:bg-green-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-green-600",children:"Execute Operation"})]})})]}):null},jl=class{static initialize(){this.isInitialized||(document.addEventListener("keydown",this.handleKeyDown),this.isInitialized=!0)}static cleanup(){document.removeEventListener("keydown",this.handleKeyDown),this.shortcuts.clear(),this.isInitialized=!1}static registerShortcut(t,r){this.shortcuts.set(t.toLowerCase(),r)}static unregisterShortcut(t){this.shortcuts.delete(t.toLowerCase())}static getKeyString(t){const r=[];return t.ctrlKey&&r.push("ctrl"),t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),t.metaKey&&r.push("meta"),r.push(t.key.toLowerCase()),r.join("+")}static getAvailableShortcuts(){return[{key:"ctrl+o",description:"Open CSV file"},{key:"ctrl+s",description:"Save project"},{key:"ctrl+e",description:"Export XDC"},{key:"ctrl+f",description:"Focus search"},{key:"ctrl+a",description:"Select all pins"},{key:"ctrl+d",description:"Deselect all"},{key:"r",description:"Reset zoom and pan"},{key:"space",description:"Rotate view 90"},{key:"f",description:"Flip top/bottom view"},{key:"ctrl+z",description:"Undo"},{key:"ctrl+y",description:"Redo"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"escape",description:"Clear selection"},{key:"delete",description:"Clear selected pin assignments"},{key:"ctrl+shift+?",description:"Show keyboard shortcuts"}]}};jl.shortcuts=new Map;jl.isInitialized=!1;jl.handleKeyDown=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return;const t=jl.getKeyString(e),r=jl.shortcuts.get(t);r&&(e.preventDefault(),r())};let Lt=jl;const aj=()=>{const{undo:e,redo:t,updateUndoRedoState:r}=$i();Se.useEffect(()=>{Tr.initialize();const n=()=>{r()};return Tr.addListener(n),Lt.initialize(),Lt.registerShortcut("ctrl+z",()=>{e()}),Lt.registerShortcut("ctrl+y",()=>{t()}),Lt.registerShortcut("ctrl+shift+z",()=>{t()}),r(),()=>{Tr.removeListener(n),Lt.unregisterShortcut("ctrl+z"),Lt.unregisterShortcut("ctrl+y"),Lt.unregisterShortcut("ctrl+shift+z")}},[e,t,r])},sj=()=>{const{clearSelection:e,resetZoom:t,rotatePins:r,flipView:n,setZoom:i,viewConfig:a,pins:s,selectPins:o}=$i();Se.useEffect(()=>(Lt.registerShortcut("escape",()=>{e()}),Lt.registerShortcut("ctrl+a",()=>{o(s.map(u=>u.id))}),Lt.registerShortcut("ctrl+d",()=>{e()}),Lt.registerShortcut("r",()=>{t()}),Lt.registerShortcut("space",()=>{r(90)}),Lt.registerShortcut("f",()=>{n()}),Lt.registerShortcut("+",()=>{const u=Math.min(a.zoom*1.2,5);i(u)}),Lt.registerShortcut("-",()=>{const u=Math.max(a.zoom/1.2,.1);i(u)}),Lt.registerShortcut("0",()=>{i(1)}),Lt.registerShortcut("ctrl+shift+?",()=>{document.dispatchEvent(new CustomEvent("showKeyboardHelp"))}),()=>{Lt.unregisterShortcut("escape"),Lt.unregisterShortcut("ctrl+a"),Lt.unregisterShortcut("ctrl+d"),Lt.unregisterShortcut("r"),Lt.unregisterShortcut("space"),Lt.unregisterShortcut("f"),Lt.unregisterShortcut("+"),Lt.unregisterShortcut("-"),Lt.unregisterShortcut("0"),Lt.unregisterShortcut("ctrl+shift+?")}),[e,t,r,n,i,a.zoom,s,o])},oj=()=>{aj(),sj(),Se.useEffect(()=>()=>{Lt.cleanup()},[])};class ml{static async validateProjectAsync(t,r){return new Promise(n=>{const i=this.validateProject(t,r);n(i)})}static validateProject(t,r){const n=[];n.push(...this.checkPinConflicts(r)),n.push(...this.checkDifferentialPairs(r)),n.push(...this.checkBankConstraints(r));const i=this.calculateSummary(n);return{issues:n,summary:i,lastChecked:Date.now()}}static checkPinConflicts(t){const r=[],n=new Map;return t.forEach(i=>{if(i.signalName&&i.signalName.trim()!==""){const a=i.signalName.trim();n.has(a)||n.set(a,[]),n.get(a).push(i)}}),n.forEach((i,a)=>{i.length>1&&r.push({id:`conflict_${a}_${Date.now()}`,type:"pin_conflict",severity:"error",title:`Duplicate assignment for signal "${a}"`,description:`Signal "${a}" is assigned to ${i.length} pins.`,affectedPins:i.map(s=>s.id),suggestion:"Each signal should be assigned to only one pin.",autoFixable:!1,timestamp:Date.now()})}),r}static checkDifferentialPairs(t){const r=[],n=new Set;return t.forEach(i=>{if(!Sr.isDifferentialPin(i))return;const a=Sr.getDifferentialPairType(i.pinName)||(i.signalName?Sr.getDifferentialPairType(i.signalName):null);if(!a)return;const s=Sr.findPairPin(i,t),o=Sr.getDifferentialBaseName(i.pinName),u=`${i.id}_${(s==null?void 0:s.id)||"missing"}`;if(!n.has(u))if(n.add(u),!s)r.push({id:`diff_pair_incomplete_${i.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Incomplete differential pair: ${o}`,description:`Pin ${i.pinNumber} (${i.pinName}) has no differential pair partner.`,affectedPins:[i.id],suggestion:`Find and assign the ${a==="positive"?"negative":"positive"} side pin in the same bank.`,autoFixable:!1,timestamp:Date.now()});else{i.bank!==s.bank&&r.push({id:`diff_pair_bank_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"error",title:`Differential pair bank mismatch: ${o}`,description:`Differential pair pins are in different banks. Pin ${i.pinNumber} (Bank ${i.bank}) and Pin ${s.pinNumber} (Bank ${s.bank})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be placed in the same bank.",autoFixable:!1,timestamp:Date.now()}),i.voltage!==s.voltage&&r.push({id:`diff_pair_voltage_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Differential pair voltage mismatch: ${o}`,description:`Differential pair pins have different voltages. Pin ${i.pinNumber} (${i.voltage}) and Pin ${s.pinNumber} (${s.voltage})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be set to the same voltage level.",autoFixable:!1,timestamp:Date.now()});const f=i.signalName&&i.signalName.trim()!=="",d=s.signalName&&s.signalName.trim()!=="";if(f&&d){const p=Sr.getPairPinName(i.signalName);p&&p.toLowerCase()!==s.signalName.toLowerCase()&&r.push({id:`diff_pair_signal_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`: ${o}`,description:`"${i.signalName}"  "${s.signalName}"`,affectedPins:[i.id,s.id],suggestion:`: "${i.signalName}"  "${p}"`,autoFixable:!1,timestamp:Date.now()})}else f&&!d&&r.push({id:`diff_pair_incomplete_signal_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"info",title:`: ${o}`,description:` ${i.pinNumber}  "${i.signalName}"  ${s.pinNumber} `,affectedPins:[i.id,s.id],suggestion:"",autoFixable:!1,timestamp:Date.now()})}}),r}static checkBankConstraints(t){const r=[],n=new Map;return t.forEach(i=>{i.bank&&i.signalName&&i.signalName.trim()!==""&&(n.has(i.bank)||n.set(i.bank,[]),n.get(i.bank).push(i))}),n.forEach((i,a)=>{r.push(...this.checkVCCOConsistency(a,i)),r.push(...this.checkIOStandardCompatibility(a,i)),r.push(...this.checkDifferentialPairBankConstraints(a,i)),r.push(...this.checkSpecialPinConstraints(a,i)),r.push(...this.checkHighSpeedSignalConstraints(a,i))}),r}static getIOStandard(t){var r,n,i;return((r=t.attributes)==null?void 0:r.IO_Standard)||((n=t.attributes)==null?void 0:n.io_standard)||((i=t.attributes)==null?void 0:i.iostandard)}static checkVCCOConsistency(t,r){const n=[],i=new Set(r.map(a=>a.voltage).filter(a=>a&&a!==""&&a!=="0V"));return i.size>1&&n.push({id:`bank-vcco-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`VCCO voltage mismatch in Bank ${t}`,description:`Bank ${t} contains pins with different VCCO voltages: ${Array.from(i).join(", ")}. All pins in a bank must share the same VCCO.`,affectedPins:r.map(a=>a.id),suggestion:"Configure all pins in the same bank to use the same VCCO voltage level.",autoFixable:!1,timestamp:Date.now()}),n}static checkIOStandardCompatibility(t,r){const n=[],i=r.map(o=>this.getIOStandard(o)).filter(o=>o&&o!=="");if(i.length===0)return n;const a=[...new Set(i)];if(a.length<=1)return n;const s=[{group1:["LVCMOS33","LVCMOS25","LVCMOS18","LVCMOS15","LVCMOS12"],group2:["LVDS","LVDS_25","BLVDS_25","MLVDS_25"],reason:"Single-ended and differential standards cannot share the same bank"},{group1:["SSTL135","SSTL125","SSTL15"],group2:["POD12","POD10"],reason:"SSTL and POD standards require different reference voltages"},{group1:["HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18"],group2:["LVCMOS33","LVCMOS25"],reason:"HSTL requires center-tap termination, incompatible with LVCMOS"},{group1:["MIPI_DPHY_DCI"],group2:["LVCMOS18","LVCMOS12"],reason:"MIPI DPHY requires dedicated differential signaling"}];for(const o of s){const u=o.group1.some(d=>a.includes(d)),f=o.group2.some(d=>a.includes(d));if(u&&f){const d=r.filter(p=>o.group1.includes(this.getIOStandard(p)||"")||o.group2.includes(this.getIOStandard(p)||""));n.push({id:`bank-iostd-conflict-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`Incompatible I/O standards in Bank ${t}`,description:`${o.reason}. Found: ${a.join(", ")}`,affectedPins:d.map(p=>p.id),suggestion:"Separate incompatible I/O standards into different banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkDifferentialPairBankConstraints(t,r){const n=[],i=new Map;return r.forEach(a=>{if(!a.signalName)return;const s=this.getDifferentialBaseName(a.signalName);s&&(i.has(s)||i.set(s,[]),i.get(s).push(a))}),i.forEach((a,s)=>{if(a.length===2){const[o,u]=a;o.bank!==u.bank&&n.push({id:`diff-pair-bank-cross-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair crosses bank boundary",description:`Differential pair "${s}" has pins in different banks: ${o.pinNumber} (Bank ${o.bank}) and ${u.pinNumber} (Bank ${u.bank})`,affectedPins:[o.id,u.id],suggestion:"Place both pins of a differential pair in the same bank.",autoFixable:!1,timestamp:Date.now()});const f=this.getIOStandard(o),d=this.getIOStandard(u);f&&d&&f!==d&&n.push({id:`diff-pair-iostd-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair I/O standard mismatch",description:`Differential pair "${s}" has mismatched I/O standards: ${f} vs ${d}`,affectedPins:[o.id,u.id],suggestion:"Use the same I/O standard for both pins in a differential pair.",autoFixable:!1,timestamp:Date.now()})}}),n}static checkSpecialPinConstraints(t,r){const n=[],i=r.filter(s=>{var o,u,f,d,p;return((o=s.pinType)==null?void 0:o.includes("CLOCK"))||((u=s.pinType)==null?void 0:u.includes("GLOBAL"))||((f=s.pinType)==null?void 0:f.includes("CONFIG"))||((d=s.pinName)==null?void 0:d.startsWith("IO_L"))&&((p=s.pinName)==null?void 0:p.includes("CC"))}),a=r.filter(s=>!i.includes(s));if(i.length>0&&a.length>0){const s=i.filter(o=>{var u,f;return((u=o.signalName)==null?void 0:u.toLowerCase().includes("clk"))||((f=o.signalName)==null?void 0:f.toLowerCase().includes("clock"))});if(s.length>0){const o=s.filter(u=>{var f,d,p,m;return((f=u.signalName)==null?void 0:f.includes("100"))||((d=u.signalName)==null?void 0:d.includes("200"))||((p=u.signalName)==null?void 0:p.includes("GHz"))||((m=this.getIOStandard(u))==null?void 0:m.includes("LVDS"))});o.length>0&&a.length>0&&n.push({id:`bank-clock-isolation-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`High-speed clocks mixed with regular I/O in Bank ${t}`,description:"High-speed clock signals may cause noise coupling with regular I/O signals",affectedPins:[...o.map(u=>u.id),...a.slice(0,3).map(u=>u.id)],suggestion:"Consider isolating high-speed clock signals in dedicated banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkHighSpeedSignalConstraints(t,r){const n=[],i=r.filter(s=>{var u,f,d,p;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return o.includes("ddr")||o.includes("pcie")||o.includes("serdes")||o.includes("mgt")||o.includes("lvds")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVDS"))||((d=this.getIOStandard(s))==null?void 0:d.includes("SSTL"))||((p=this.getIOStandard(s))==null?void 0:p.includes("POD"))}),a=r.filter(s=>{var u,f;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return(o.includes("gpio")||o.includes("led")||o.includes("button")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVCMOS")))&&!i.includes(s)});return i.length>0&&a.length>0&&n.push({id:`bank-speed-mix-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`Mixed signal speeds in Bank ${t}`,description:`Bank ${t} contains both high-speed (${i.length}) and low-speed (${a.length}) signals`,affectedPins:[...i.slice(0,2).map(s=>s.id),...a.slice(0,2).map(s=>s.id)],suggestion:"Consider grouping signals by speed to minimize noise coupling.",autoFixable:!1,timestamp:Date.now()}),n}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);if(r.endsWith("p")&&!r.endsWith("_p")||r.endsWith("n")&&!r.endsWith("_n")){const n=r.charAt(r.length-2);if(/[\d_-]/.test(n))return t.slice(0,-1)}return null}static calculateSummary(t){const r={totalIssues:t.length,errorCount:0,warningCount:0,infoCount:0};return t.forEach(n=>{switch(n.severity){case"error":r.errorCount++;break;case"warning":r.warningCount++;break;case"info":r.infoCount++;break}}),r}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static getIssuesForPin(t,r){return r.filter(n=>n.affectedPins.includes(t))}static getIssuesByType(t,r){return r.filter(n=>n.type===t)}static getIssuesBySeverity(t,r){return r.filter(n=>n.severity===t)}}ml.listeners=new Set;const lj=(e,t,r={})=>{const{enabled:n=!0,debounceMs:i=1e3,backgroundCheck:a=!0}=r,[s,o]=Se.useState(null),[u,f]=Se.useState(!1),d=Se.useRef(null),p=Se.useRef(""),m=Se.useCallback(async()=>{if(!n||!e||t.length===0)return;const S=JSON.stringify({packageId:e.id,pinsData:t.map(x=>({id:x.id,signalName:x.signalName,bank:x.bank,voltage:x.voltage,pinName:x.pinName}))});if(S!==p.current)if(p.current=S,a){f(!0);try{const x=await ml.validateProjectAsync(e,t);o(x)}catch(x){console.error("Validation error:",x)}finally{f(!1)}}else{const x=ml.validateProject(e,t);o(x)}},[e,t,n,a]),v=Se.useCallback(()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{m()},i)},[m,i]);Se.useEffect(()=>(n&&v(),()=>{d.current&&clearTimeout(d.current)}),[t,e,n,v]);const g=Se.useCallback(()=>{p.current="",m()},[m]),y=Se.useCallback(S=>s?ml.getIssuesForPin(S,s.issues):[],[s]),C=Se.useCallback(S=>s?ml.getIssuesByType(S,s.issues):[],[s]),E=Se.useCallback(S=>s?ml.getIssuesBySeverity(S,s.issues):[],[s]);return{validationResult:s,isValidating:u,manualValidate:g,getIssuesForPin:y,getIssuesByType:C,getIssuesBySeverity:E,hasErrors:s?s.summary.errorCount>0:!1,hasWarnings:s?s.summary.warningCount>0:!1,hasIssues:s?s.summary.totalIssues>0:!1,errorCount:(s==null?void 0:s.summary.errorCount)||0,warningCount:(s==null?void 0:s.summary.warningCount)||0,totalIssues:(s==null?void 0:s.summary.totalIssues)||0}},cj=`# Xilinx XC7A12T Package Data
# Copyright (C) 2024 Sample Data
Pin,Pin Name,Memory Byte Group,Bank,VCCAUX Group,Super Logic Region,I/O Type,No-Connect
A1,IO_L1P_T0_D00_MOSI_14,0,14,NA,X0Y0,HR,FALSE
A2,IO_L1N_T0_D01_DIN_14,0,14,NA,X0Y0,HR,FALSE
B1,VCCINT,NA,NA,NA,NA,POWER,FALSE
B2,GND,NA,NA,NA,NA,GROUND,FALSE
C1,IO_L2P_T0_D02_14,0,14,NA,X0Y0,HR,FALSE
C2,IO_L2N_T0_D03_14,0,14,NA,X0Y0,HR,FALSE
D1,CONFIG_DONE,NA,NA,NA,NA,CONFIG,FALSE
D2,MGTPRXP1_216,NA,216,NA,NA,GTP,FALSE`,uj=()=>{const e=new Blob([cj],{type:"text/csv"});return new File([e],"sample-fpga-pins.csv",{type:"text/csv"})},fj=()=>{const e=Se.useRef(null),[t,r]=Se.useState(!1),[n,i]=Se.useState(null),[a,s]=Se.useState(!1),[o,u]=Se.useState(!1),[f,d]=Se.useState(!1),[p,m]=Se.useState("validation"),[v,g]=Se.useState(!1),[y,C]=Se.useState(!1),[E,S]=Se.useState(!1),[x,T]=Se.useState(!1),[F,N]=Se.useState(320),[A,P]=Se.useState(280),[b,I]=Se.useState(null);oj(),Se.useEffect(()=>{const Oe=Ue=>{Ue.key==="F11"&&(Ue.preventDefault(),Be())};return document.addEventListener("keydown",Oe),()=>{document.removeEventListener("keydown",Oe)}},[y,E,x]),Se.useEffect(()=>{const Oe=()=>{d(!0)};return document.addEventListener("showKeyboardHelp",Oe),()=>{document.removeEventListener("showKeyboardHelp",Oe)}},[]),Se.useEffect(()=>{const Oe=Ue=>{v&&(Ue.target.closest("[data-export-menu]")||g(!1))};return document.addEventListener("click",Oe),()=>{document.removeEventListener("click",Oe)}},[v]);const{pins:O,filteredPins:j,selectedPins:q,package:ie,filters:te,viewConfig:Ae,listView:Ee,loadPackage:re,selectPin:X,assignSignal:he,updateFilters:Te,setError:L,setLoading:Q,setRotation:Y,toggleView:K,setZoom:ue,resetZoom:V,setSortField:Z,setSortOrder:fe,setViewMode:ve}=$i(),Be=()=>{C(!y),y?(S(!1),T(!1)):(S(!0),T(!0),setTimeout(()=>{V()},100))},G=Oe=>Ue=>{Ue.preventDefault(),I(Oe)},qe=Oe=>{if(!b)return;const Ue=window.innerWidth;if(b==="left"){const Ze=Math.max(200,Math.min(500,Oe.clientX));N(Ze)}else if(b==="right"){const Ze=Math.max(200,Math.min(500,Ue-Oe.clientX));P(Ze)}},et=()=>{I(null)};Se.useEffect(()=>(document.addEventListener("mousemove",qe),document.addEventListener("mouseup",et),()=>{document.removeEventListener("mousemove",qe),document.removeEventListener("mouseup",et)}),[b]),Se.useEffect(()=>{const Oe=Ue=>{console.log(" Received message from VS Code:",Ue.data);const Ze=Ue.data;switch(Ze.command){case"loadProject":try{if(Ze.projectData){console.log("Loading project from VS Code:",Ze.projectData);const at=Ze.projectData;if(at.package&&at.pins){const vt=at.pins.map(Rt=>({...Rt,isAssigned:!!Rt.assignedSignalName,signalName:Rt.assignedSignalName||""})),Ft=Gc.createPackageFromPins(vt,at.package.name||"Loaded Project");re(Ft),console.log(" Project loaded successfully from VS Code")}}}catch(at){console.error("Failed to load project from VS Code:",at),L(`Failed to load project: ${at}`)}break;case"loadSampleData":(async()=>{try{console.log("Loading sample data from VS Code command");const at=uj();r(!0),Q(!0),L(null);const vt=await Gc.parseCSVFile(at);if(console.log(" Sample data parse result:",vt),vt.success){console.log(" Sample data parsed successfully:",vt.pins.length,"pins found");const Ft=Gc.createPackageFromPins(vt.pins,at.name);re(Ft),console.log(" Sample data loaded successfully from VS Code command"),vt.warnings.length>0&&console.warn(" Sample data import warnings:",vt.warnings)}else console.error(" Sample data parse failed:",vt.errors),L(`Failed to load sample data: ${vt.errors.join(", ")}`)}catch(at){console.error("Failed to load sample data from VS Code:",at),L(`Failed to load sample data: ${at}`)}finally{r(!1),Q(!1)}})();break}};return console.log(" Checking VS Code environment:",{hasVscode:typeof window.vscode<"u",windowKeys:Object.keys(window),userAgent:navigator.userAgent}),typeof window.vscode<"u"?(console.log(" VS Code environment detected, setting up message listener"),window.addEventListener("message",Oe),setTimeout(()=>{console.log(" Notifying VS Code extension that webview is ready"),window.vscode.postMessage({command:"webviewReady"})},500),()=>{console.log(" Cleaning up VS Code message listener"),window.removeEventListener("message",Oe)}):(console.log(" Not in VS Code environment"),()=>{})},[re,L]);const{validationResult:Ye,isValidating:Qe,hasErrors:Fe,hasWarnings:St,errorCount:Or,warningCount:gr}=lj(ie,O,{enabled:!0,debounceMs:1e3,backgroundCheck:!0}),_e=()=>{var Oe;(Oe=e.current)==null||Oe.click()},me=async Oe=>{var Ze;const Ue=(Ze=Oe.target.files)==null?void 0:Ze[0];if(Ue){console.log(" :",Ue.name,Ue.size,"bytes"),r(!0),Q(!0),L(null);try{console.log(" CSV...");const at=await Gc.parseCSVFile(Ue);if(console.log(" CSV:",at),at.success){console.log(" CSV:",at.pins.length,"pins found");const vt=Gc.createPackageFromPins(at.pins,Ue.name);console.log(" :",vt),re(vt),console.log(" "),at.warnings.length>0&&console.warn(" Import warnings:",at.warnings)}else console.error(" CSV:",at.errors),L(`Failed to import CSV: ${at.errors.join(", ")}`)}catch(at){console.error(" :",at),L(`Error reading file: ${at.message}`)}finally{r(!1),Q(!1),e.current&&(e.current.value="")}}},ke=Oe=>{Te({searchText:Oe.target.value})},we=Oe=>{const Ue=te.pinTypes,Ze=Ue.includes(Oe)?Ue.filter(at=>at!==Oe):[...Ue,Oe];Te({pinTypes:Ze})},Ce=()=>{const Oe=O.length,Ue=O.filter(at=>at.isAssigned).length,Ze=Oe-Ue;return{total:Oe,assigned:Ue,unassigned:Ze}},Pe=()=>{Y(Ae.rotation+90)},Me=()=>{ue(Math.min(3,Ae.zoom+.1))},pe=()=>{ue(Math.max(.2,Ae.zoom-.1))},ae=Oe=>{const Ue=O.find(Ze=>Ze.id===Oe);if(Ue){const Ze=prompt("Enter signal name:",Ue.signalName);Ze!==null&&he(Oe,Ze)}},xe=Oe=>{X(Oe),i(Oe||null)},be=Oe=>{X(Oe)},Le=()=>typeof window.vscode<"u",Xe=async(Oe,Ue,Ze,at)=>{if(!Le())return!1;try{const vt=window.vscode,Ft=await new Promise(Rt=>{const qi=en=>{en.data.command==="saveDialogResult"&&(window.removeEventListener("message",qi),Rt(en.data.result))};window.addEventListener("message",qi),vt.postMessage({command:"showSaveDialog",options:{saveLabel:at,filters:Ze}})});if(Ft){let Rt;if(typeof Ft=="string")Rt=Ft;else if(Ft&&typeof Ft=="object"){const en=Ft;Rt=en.fsPath||en.path,!Rt&&typeof Ft.toString=="function"&&(Rt=Ft.toString())}return!Rt||Rt==="undefined"||Rt==="[object Object]"?(console.error("Failed to extract valid file path from URI"),!1):await new Promise(en=>{const Ji=bn=>{bn.data.command==="saveFileResult"&&(window.removeEventListener("message",Ji),en(bn.data.success))};window.addEventListener("message",Ji),vt.postMessage({command:"saveFile",filePath:Rt,content:Oe,filename:Ue})})}}catch(vt){console.error("VS Code save failed:",vt)}return!1},gt=Oe=>{if(O.length===0)return;let Ue,Ze,at,vt,Ft;Oe==="xdc"?(Ue=Ra.exportToXDC(O,ie),Ze=`${(ie==null?void 0:ie.device)||"fpga"}_pins.xdc`,at="text/plain",vt={"XDC Files":["xdc"],"All Files":["*"]},Ft="Export XDC Constraints"):(Ue=Ra.exportToSDC(O,ie),Ze=`${(ie==null?void 0:ie.device)||"fpga"}_pins.sdc`,at="text/plain",vt={"SDC Files":["sdc"],"All Files":["*"]},Ft="Export SDC Constraints"),Xe(Ue,Ze,vt,Ft).then(Rt=>{Rt||Ra.downloadFile(Ue,Ze,at)})},Bt=async()=>{if(O.length===0)return;const Oe=Ra.exportToCSV(O),Ue=`${(ie==null?void 0:ie.device)||"fpga"}_pins.csv`;await Xe(Oe,Ue,{"CSV Files":["csv"],"All Files":["*"]},"Export Pin Data to CSV")||Ra.downloadFile(Oe,Ue,"text/csv")},jt=async()=>{if(O.length===0)return;const Oe=Ra.exportReport(O,ie),Ue=`${(ie==null?void 0:ie.device)||"fpga"}_report.txt`;await Xe(Oe,Ue,{"Text Files":["txt"],"All Files":["*"]},"Export Pin Assignment Report")||Ra.downloadFile(Oe,Ue,"text/plain")},ar=Ce(),{sortedPinsForList:Za}=wr.useMemo(()=>{const Oe=[...j];return Oe.sort((Ue,Ze)=>{var en,Ji;const at=n&&Ue.id===n,vt=n&&Ze.id===n;if(at&&!vt)return-1;if(!at&&vt)return 1;if(n&&!at&&!vt){const bn=j.find(_n=>_n.id===n);if(bn){const _n=Sr.findPairPin(bn,j),Ko=(_n==null?void 0:_n.id)===Ue.id,es=(_n==null?void 0:_n.id)===Ze.id;if(Ko&&!es)return-1;if(!Ko&&es)return 1}}let Ft,Rt;switch(te.sortField){case"pinNumber":Ft=Ue.pinNumber,Rt=Ze.pinNumber;break;case"pinName":Ft=Ue.pinName,Rt=Ze.pinName;break;case"signalName":Ft=Ue.signalName||"",Rt=Ze.signalName||"";break;case"pinType":Ft=Ue.pinType,Rt=Ze.pinType;break;case"bank":Ft=Ue.bank||"",Rt=Ze.bank||"";break;case"grid":if(Ue.gridPosition&&Ze.gridPosition){const bn=W6(Ue.gridPosition.row,Ze.gridPosition.row);if(bn!==0)return te.sortOrder==="asc"?bn:-bn;const _n=Ue.gridPosition.col-Ze.gridPosition.col;return te.sortOrder==="asc"?_n:-_n}Ft=((en=Ue.gridPosition)==null?void 0:en.row)||"",Rt=((Ji=Ze.gridPosition)==null?void 0:Ji.row)||"";break;default:Ft=Ue.pinNumber,Rt=Ze.pinNumber}const qi=Ft.localeCompare(Rt,void 0,{numeric:!0,sensitivity:"base"});return te.sortOrder==="asc"?qi:-qi}),{sortedPinsForList:Oe}},[j,te.sortField,te.sortOrder,n,O]);return w.jsxs("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',display:"flex",flexDirection:"column"},children:[w.jsxs("header",{style:{height:"36px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",flexShrink:0,minHeight:"36px"},children:[w.jsx("h1",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#4A90E2"},children:"FPGA Pin Planner"}),w.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"12px",alignItems:"center"},children:[w.jsx("button",{onClick:Be,style:{padding:"6px 12px",backgroundColor:y?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px",color:y?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},title:y?"Restore Normal View (F11)":"Maximize Viewer (F11)",children:y?" Restore":" Maximize"}),w.jsx("input",{ref:e,type:"file",accept:".csv,.txt",onChange:me,style:{display:"none"}}),w.jsx("button",{onClick:_e,disabled:t,style:{padding:"8px 16px",backgroundColor:t?"#666":"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:t?"not-allowed":"pointer",fontSize:"14px"},children:t?" Loading...":" Open CSV"}),w.jsxs("div",{style:{position:"relative"},"data-export-menu":!0,children:[w.jsxs("button",{onClick:()=>g(!v),disabled:O.length===0,style:{padding:"8px 16px",backgroundColor:O.length>0?"#4A90E2":"#666",border:"none",borderRadius:"4px",color:"white",cursor:O.length>0?"pointer":"not-allowed",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},title:"Export Pin Data",children:[" Export ",v?"":""]}),v&&O.length>0&&w.jsxs("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",zIndex:1e3,minWidth:"160px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[w.jsx("button",{onClick:()=>{u(!0),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Oe=>Oe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Oe=>Oe.currentTarget.style.backgroundColor="transparent",children:" Constraints (XDC/SDC)"}),w.jsx("button",{onClick:()=>{Bt(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Oe=>Oe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Oe=>Oe.currentTarget.style.backgroundColor="transparent",children:" CSV Data"}),w.jsx("button",{onClick:()=>{jt(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px"},onMouseEnter:Oe=>Oe.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Oe=>Oe.currentTarget.style.backgroundColor="transparent",children:" Report"})]})]}),w.jsx("button",{onClick:()=>s(!0),style:{padding:"8px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"14px"},title:"Settings",children:""})]})]}),w.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0,height:"100%"},children:[!E&&w.jsxs("aside",{style:{width:`${F}px`,backgroundColor:"#252525",borderRight:"1px solid #444",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%",minWidth:"200px",maxWidth:"500px"},children:[w.jsx("div",{onMouseDown:G("left"),style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:b==="left"?"#007acc":"transparent"},title:"Drag to resize panel"}),w.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #444"},children:[w.jsx("input",{type:"text",placeholder:"Search pins...",value:te.searchText,onChange:ke,style:{width:"100%",padding:"8px 12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),w.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",alignItems:"center"},children:[w.jsx("span",{style:{fontSize:"12px",color:"#999"},children:"Sort:"}),w.jsxs("select",{value:te.sortField,onChange:Oe=>Z(Oe.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",fontSize:"12px",cursor:"pointer"},children:[w.jsx("option",{value:"pinNumber",children:"Pin Number"}),w.jsx("option",{value:"pinName",children:"Pin Name"}),w.jsx("option",{value:"signalName",children:"Signal Name"}),w.jsx("option",{value:"pinType",children:"Pin Type"}),w.jsx("option",{value:"bank",children:"Bank"}),w.jsx("option",{value:"grid",children:"Grid Position"})]}),w.jsx("button",{onClick:()=>fe(te.sortOrder==="asc"?"desc":"asc"),style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px"},title:`Sort ${te.sortOrder==="asc"?"Descending":"Ascending"}`,children:te.sortOrder==="asc"?"":""})]}),w.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",flexWrap:"wrap"},children:[w.jsxs("button",{onClick:()=>Te({pinTypes:[]}),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:te.pinTypes.length===0?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["All (",O.length,")"]}),w.jsxs("button",{onClick:()=>we("IO"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:te.pinTypes.includes("IO")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["I/O (",O.filter(Oe=>Oe.pinType==="IO").length,")"]}),w.jsxs("button",{onClick:()=>we("POWER"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:te.pinTypes.includes("POWER")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["Power (",O.filter(Oe=>Oe.pinType==="POWER").length,")"]})]})]}),w.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:O.length===0?w.jsxs(w.Fragment,{children:[w.jsx("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px"},children:"No package loaded"}),w.jsxs("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:["Debug: pins=",O.length,", package=",(ie==null?void 0:ie.name)||"null"]}),w.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"14px"},children:[w.jsx("div",{style:{marginBottom:"12px"},children:""}),w.jsx("div",{children:"Load a CSV file to start"})]})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px",display:"flex",justifyContent:"space-between"},children:[w.jsx("span",{children:(ie==null?void 0:ie.name)||"Package"}),w.jsxs("span",{children:["Showing ",j.length," of ",O.length]})]}),w.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:Za.map(Oe=>{const Ue=n?O.find(vt=>vt.id===n):null,Ze=Ue?Sr.findPairPin(Ue,O):null,at=(Ze==null?void 0:Ze.id)===Oe.id;return w.jsx(_I,{pin:Oe,isSelected:q.has(Oe.id),onSelect:be,onAssignSignal:he,isPairPin:!1,isDifferentialPairPartner:at},Oe.id)})})]})})]}),w.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0,minHeight:0},children:[w.jsxs("div",{className:"toolbar-scrollbar",style:{height:"32px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 12px",gap:"8px",overflowX:"auto",overflowY:"hidden",flexShrink:0,minHeight:"32px"},children:[w.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[w.jsx("button",{onClick:()=>ve("grid"),style:{padding:"4px 8px",backgroundColor:Ee.viewMode==="grid"?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px 0 0 4px",color:Ee.viewMode==="grid"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"Grid View",children:" Grid"}),w.jsx("button",{onClick:()=>ve("list"),style:{padding:"4px 8px",backgroundColor:Ee.viewMode==="list"?"#007acc":"#333",border:"1px solid #555",borderRadius:"0 4px 4px 0",color:Ee.viewMode==="list"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"List View",children:" List"})]}),w.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),w.jsx("button",{onClick:Pe,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Rotate 90"}),w.jsx("button",{onClick:K,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Flip View"}),w.jsx("div",{style:{flexShrink:0},children:w.jsx(qB,{})}),w.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),w.jsx("div",{style:{flexShrink:0},children:w.jsx(JB,{})}),w.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),w.jsxs("button",{onClick:()=>m(p==="validation"?null:"validation"),style:{padding:"6px 12px",backgroundColor:p==="validation"?"#4a5568":Fe?"#dc2626":St?"#d97706":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:`Validation: ${Or} errors, ${gr} warnings (click for details)`,children:[w.jsx(nj,{validationResult:Ye}),w.jsx("span",{children:"Validation"}),Qe&&w.jsx("span",{className:"animate-spin",children:""})]}),w.jsxs("button",{onClick:()=>m(p==="batch"?null:"batch"),style:{padding:"6px 12px",backgroundColor:p==="batch"?"#4a5568":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:"Batch Operations - Assign patterns to multiple pins",children:[w.jsx("span",{children:""}),w.jsx("span",{children:"Batch Ops"})]}),w.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),w.jsx("button",{onClick:()=>d(!0),style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},title:"Keyboard Shortcuts (Ctrl+Shift+?)",children:" Shortcuts"}),w.jsx("div",{style:{flex:1,minWidth:"20px"}}),w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0,backgroundColor:"#2a2a2a",padding:"0 8px",borderRadius:"4px"},children:[w.jsx("span",{style:{fontSize:"12px",color:"#999",whiteSpace:"nowrap"},children:"Zoom:"}),w.jsx("button",{onClick:pe,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"-"}),w.jsxs("button",{onClick:V,style:{padding:"4px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",minWidth:"50px",whiteSpace:"nowrap"},title:"Reset zoom to 100%",children:[Math.round(Ae.zoom*100),"%"]}),w.jsx("button",{onClick:Me,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"+"})]})]}),w.jsxs("div",{style:{flex:1,minWidth:"0",backgroundColor:"#1a1a1a",overflow:"hidden",display:"flex",flexShrink:1,width:"100%",minHeight:0,height:"100%"},children:[w.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minWidth:0,width:"100%",minHeight:0,height:"100%"},children:Ee.viewMode==="grid"?w.jsx(QB,{package:ie,pins:j,selectedPins:q,onPinSelect:xe,onPinDoubleClick:ae,zoom:Ae.zoom,rotation:Ae.rotation,isTopView:Ae.isTopView,onZoomChange:ue}):w.jsx("div",{style:{height:"100%",backgroundColor:"#1a1a1a",overflow:"hidden",width:"100%",minHeight:0},className:"custom-scrollbar",children:w.jsx(LI,{onPinSelect:be})})}),!E&&p&&w.jsxs("div",{style:{width:`${A}px`,minWidth:"200px",maxWidth:"500px",borderLeft:"1px solid #555",backgroundColor:"#1e1e1e",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minHeight:0,position:"relative"},children:[w.jsx("div",{onMouseDown:G("right"),style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:b==="right"?"#007acc":"transparent"},title:"Drag to resize panel"}),p==="validation"&&w.jsx("div",{style:{height:"100%",overflow:"hidden"},className:"custom-scrollbar",children:w.jsx(rj,{validationResult:Ye,onIssueClick:Oe=>{Oe.affectedPins&&Oe.affectedPins.length>0&&console.log("Pins to highlight:",Oe.affectedPins)}})}),p==="batch"&&w.jsx("div",{style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:w.jsx(ij,{isVisible:!0})})]})]})]})]}),!x&&w.jsxs("footer",{style:{height:"16px",backgroundColor:"#2a2a2a",borderTop:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",fontSize:"10px",color:"#999",flexShrink:0},children:[w.jsx("span",{children:"Ready"}),w.jsx("div",{style:{marginLeft:"auto"},children:w.jsxs("span",{children:["Pins: ",ar.total," | Assigned: ",ar.assigned," | Unassigned: ",ar.unassigned]})})]}),w.jsx(SI,{isOpen:a,onClose:()=>s(!1)}),w.jsx(wI,{isOpen:o,onClose:()=>u(!1),onExport:gt,pins:O,currentPackage:ie}),w.jsx(tj,{isOpen:f,onClose:()=>d(!1)})]})};kg.createRoot(document.getElementById("root")).render(w.jsx(wr.StrictMode,{children:w.jsx(fj,{})}));
