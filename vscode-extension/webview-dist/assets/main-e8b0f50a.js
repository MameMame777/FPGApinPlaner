(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var x4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function th(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var A5={exports:{}},rh={},P5={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ou=Symbol.for("react.element"),fk=Symbol.for("react.portal"),dk=Symbol.for("react.fragment"),hk=Symbol.for("react.strict_mode"),pk=Symbol.for("react.profiler"),gk=Symbol.for("react.provider"),mk=Symbol.for("react.context"),xk=Symbol.for("react.forward_ref"),vk=Symbol.for("react.suspense"),yk=Symbol.for("react.memo"),_k=Symbol.for("react.lazy"),v4=Symbol.iterator;function Sk(e){return e===null||typeof e!="object"?null:(e=v4&&e[v4]||e["@@iterator"],typeof e=="function"?e:null)}var F5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N5=Object.assign,R5={};function ic(e,t,r){this.props=e,this.context=t,this.refs=R5,this.updater=r||F5}ic.prototype.isReactComponent={};ic.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ic.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function I5(){}I5.prototype=ic.prototype;function Ym(e,t,r){this.props=e,this.context=t,this.refs=R5,this.updater=r||F5}var Qm=Ym.prototype=new I5;Qm.constructor=Ym;N5(Qm,ic.prototype);Qm.isPureReactComponent=!0;var y4=Array.isArray,b5=Object.prototype.hasOwnProperty,qm={current:null},O5={key:!0,ref:!0,__self:!0,__source:!0};function D5(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)b5.call(t,n)&&!O5.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),f=0;f<o;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ou,type:e,key:a,ref:s,props:i,_owner:qm.current}}function wk(e,t){return{$$typeof:ou,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Jm(e){return typeof e=="object"&&e!==null&&e.$$typeof===ou}function kk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _4=/\/+/g;function Pp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?kk(""+e.key):t.toString(36)}function Qf(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case ou:case fk:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+Pp(s,0):n,y4(i)?(r="",e!=null&&(r=e.replace(_4,"$&/")+"/"),Qf(i,t,r,"",function(f){return f})):i!=null&&(Jm(i)&&(i=wk(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(_4,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",y4(e))for(var o=0;o<e.length;o++){a=e[o];var u=n+Pp(a,o);s+=Qf(a,t,r,u,i)}else if(u=Sk(e),typeof u=="function")for(e=u.call(e),o=0;!(a=e.next()).done;)a=a.value,u=n+Pp(a,o++),s+=Qf(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function mf(e,t,r){if(e==null)return e;var n=[],i=0;return Qf(e,n,"","",function(a){return t.call(r,a,i++)}),n}function Ek(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bn={current:null},qf={transition:null},Ck={ReactCurrentDispatcher:bn,ReactCurrentBatchConfig:qf,ReactCurrentOwner:qm};function L5(){throw Error("act(...) is not supported in production builds of React.")}_t.Children={map:mf,forEach:function(e,t,r){mf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return mf(e,function(){t++}),t},toArray:function(e){return mf(e,function(t){return t})||[]},only:function(e){if(!Jm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_t.Component=ic;_t.Fragment=dk;_t.Profiler=pk;_t.PureComponent=Ym;_t.StrictMode=hk;_t.Suspense=vk;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ck;_t.act=L5;_t.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=N5({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=qm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)b5.call(t,u)&&!O5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var f=0;f<u;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:ou,type:e.type,key:i,ref:a,props:n,_owner:s}};_t.createContext=function(e){return e={$$typeof:mk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:gk,_context:e},e.Consumer=e};_t.createElement=D5;_t.createFactory=function(e){var t=D5.bind(null,e);return t.type=e,t};_t.createRef=function(){return{current:null}};_t.forwardRef=function(e){return{$$typeof:xk,render:e}};_t.isValidElement=Jm;_t.lazy=function(e){return{$$typeof:_k,_payload:{_status:-1,_result:e},_init:Ek}};_t.memo=function(e,t){return{$$typeof:yk,type:e,compare:t===void 0?null:t}};_t.startTransition=function(e){var t=qf.transition;qf.transition={};try{e()}finally{qf.transition=t}};_t.unstable_act=L5;_t.useCallback=function(e,t){return bn.current.useCallback(e,t)};_t.useContext=function(e){return bn.current.useContext(e)};_t.useDebugValue=function(){};_t.useDeferredValue=function(e){return bn.current.useDeferredValue(e)};_t.useEffect=function(e,t){return bn.current.useEffect(e,t)};_t.useId=function(){return bn.current.useId()};_t.useImperativeHandle=function(e,t,r){return bn.current.useImperativeHandle(e,t,r)};_t.useInsertionEffect=function(e,t){return bn.current.useInsertionEffect(e,t)};_t.useLayoutEffect=function(e,t){return bn.current.useLayoutEffect(e,t)};_t.useMemo=function(e,t){return bn.current.useMemo(e,t)};_t.useReducer=function(e,t,r){return bn.current.useReducer(e,t,r)};_t.useRef=function(e){return bn.current.useRef(e)};_t.useState=function(e){return bn.current.useState(e)};_t.useSyncExternalStore=function(e,t,r){return bn.current.useSyncExternalStore(e,t,r)};_t.useTransition=function(){return bn.current.useTransition()};_t.version="18.3.1";P5.exports=_t;var ke=P5.exports;const kr=th(ke);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tk=ke,Ak=Symbol.for("react.element"),Pk=Symbol.for("react.fragment"),Fk=Object.prototype.hasOwnProperty,Nk=Tk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rk={key:!0,ref:!0,__self:!0,__source:!0};function M5(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Fk.call(t,n)&&!Rk.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Ak,type:e,key:a,ref:s,props:i,_owner:Nk.current}}rh.Fragment=Pk;rh.jsx=M5;rh.jsxs=M5;A5.exports=rh;var k=A5.exports,Fg={},B5={exports:{}},ii={},j5={exports:{}},U5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ne,K){var ce=ne.length;ne.push(K);e:for(;0<ce;){var me=ce-1>>>1,L=ne[me];if(0<i(L,K))ne[me]=K,ne[ce]=L,ce=me;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var K=ne[0],ce=ne.pop();if(ce!==K){ne[0]=ce;e:for(var me=0,L=ne.length,ee=L>>>1;me<ee;){var q=2*(me+1)-1,Y=ne[q],de=q+1,V=ne[de];if(0>i(Y,ce))de<L&&0>i(V,Y)?(ne[me]=V,ne[de]=ce,me=de):(ne[me]=Y,ne[q]=ce,me=q);else if(de<L&&0>i(V,ce))ne[me]=V,ne[de]=ce,me=de;else break e}}return K}function i(ne,K){var ce=ne.sortIndex-K.sortIndex;return ce!==0?ce:ne.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],f=[],d=1,p=null,g=3,v=!1,m=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ne){for(var K=r(f);K!==null;){if(K.callback===null)n(f);else if(K.startTime<=ne)n(f),K.sortIndex=K.expirationTime,t(u,K);else break;K=r(f)}}function T(ne){if(_=!1,x(ne),!m)if(r(u)!==null)m=!0,Z(A);else{var K=r(f);K!==null&&ae(T,K.startTime-ne)}}function A(ne,K){m=!1,_&&(_=!1,S(P),P=-1),v=!0;var ce=g;try{for(x(K),p=r(u);p!==null&&(!(p.expirationTime>K)||ne&&!M());){var me=p.callback;if(typeof me=="function"){p.callback=null,g=p.priorityLevel;var L=me(p.expirationTime<=K);K=e.unstable_now(),typeof L=="function"?p.callback=L:p===r(u)&&n(u),x(K)}else n(u);p=r(u)}if(p!==null)var ee=!0;else{var q=r(f);q!==null&&ae(T,q.startTime-K),ee=!1}return ee}finally{p=null,g=ce,v=!1}}var N=!1,R=null,P=-1,I=5,b=-1;function M(){return!(e.unstable_now()-b<I)}function D(){if(R!==null){var ne=e.unstable_now();b=ne;var K=!0;try{K=R(!0,ne)}finally{K?Q():(N=!1,R=null)}}else N=!1}var Q;if(typeof w=="function")Q=function(){w(D)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,z=he.port2;he.port1.onmessage=D,Q=function(){z.postMessage(null)}}else Q=function(){C(D,0)};function Z(ne){R=ne,N||(N=!0,Q())}function ae(ne,K){P=C(function(){ne(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){m||v||(m=!0,Z(A))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ne){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var ce=g;g=K;try{return ne()}finally{g=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,K){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var ce=g;g=ne;try{return K()}finally{g=ce}},e.unstable_scheduleCallback=function(ne,K,ce){var me=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?me+ce:me):ce=me,ne){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=ce+L,ne={id:d++,callback:K,priorityLevel:ne,startTime:ce,expirationTime:L,sortIndex:-1},ce>me?(ne.sortIndex=ce,t(f,ne),r(u)===null&&ne===r(f)&&(_?(S(P),P=-1):_=!0,ae(T,ce-me))):(ne.sortIndex=L,t(u,ne),m||v||(m=!0,Z(A))),ne},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(ne){var K=g;return function(){var ce=g;g=K;try{return ne.apply(this,arguments)}finally{g=ce}}}})(U5);j5.exports=U5;var c0=j5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=ke,ti=c0;function Re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z5=new Set,P0={};function Io(e,t){Gl(e,t),Gl(e+"Capture",t)}function Gl(e,t){for(P0[e]=t,e=0;e<t.length;e++)z5.add(t[e])}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ng=Object.prototype.hasOwnProperty,bk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S4={},w4={};function Ok(e){return Ng.call(w4,e)?!0:Ng.call(S4,e)?!1:bk.test(e)?w4[e]=!0:(S4[e]=!0,!1)}function Dk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Lk(e,t,r,n){if(t===null||typeof t>"u"||Dk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function On(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var en={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){en[e]=new On(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];en[t]=new On(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){en[e]=new On(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){en[e]=new On(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){en[e]=new On(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){en[e]=new On(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){en[e]=new On(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){en[e]=new On(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){en[e]=new On(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zm=/[\-:]([a-z])/g;function e2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zm,e2);en[t]=new On(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zm,e2);en[t]=new On(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zm,e2);en[t]=new On(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){en[e]=new On(e,1,!1,e.toLowerCase(),null,!1,!1)});en.xlinkHref=new On("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){en[e]=new On(e,1,!1,e.toLowerCase(),null,!0,!0)});function t2(e,t,r,n){var i=en.hasOwnProperty(t)?en[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Lk(t,r,i,n)&&(r=null),n||i===null?Ok(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ka=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xf=Symbol.for("react.element"),yl=Symbol.for("react.portal"),_l=Symbol.for("react.fragment"),r2=Symbol.for("react.strict_mode"),Rg=Symbol.for("react.profiler"),V5=Symbol.for("react.provider"),G5=Symbol.for("react.context"),n2=Symbol.for("react.forward_ref"),Ig=Symbol.for("react.suspense"),bg=Symbol.for("react.suspense_list"),i2=Symbol.for("react.memo"),hs=Symbol.for("react.lazy"),H5=Symbol.for("react.offscreen"),k4=Symbol.iterator;function Mc(e){return e===null||typeof e!="object"?null:(e=k4&&e[k4]||e["@@iterator"],typeof e=="function"?e:null)}var sr=Object.assign,Fp;function e0(e){if(Fp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Fp=t&&t[1]||""}return`
`+Fp+e}var Np=!1;function Rp(e,t){if(!e||Np)return"";Np=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=o);break}}}finally{Np=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?e0(e):""}function Mk(e){switch(e.tag){case 5:return e0(e.type);case 16:return e0("Lazy");case 13:return e0("Suspense");case 19:return e0("SuspenseList");case 0:case 2:case 15:return e=Rp(e.type,!1),e;case 11:return e=Rp(e.type.render,!1),e;case 1:return e=Rp(e.type,!0),e;default:return""}}function Og(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _l:return"Fragment";case yl:return"Portal";case Rg:return"Profiler";case r2:return"StrictMode";case Ig:return"Suspense";case bg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case G5:return(e.displayName||"Context")+".Consumer";case V5:return(e._context.displayName||"Context")+".Provider";case n2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case i2:return t=e.displayName||null,t!==null?t:Og(e.type)||"Memo";case hs:t=e._payload,e=e._init;try{return Og(e(t))}catch{}}return null}function Bk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Og(t);case 8:return t===r2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Is(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function W5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jk(e){var t=W5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vf(e){e._valueTracker||(e._valueTracker=jk(e))}function $5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=W5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ud(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dg(e,t){var r=t.checked;return sr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function E4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Is(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function X5(e,t){t=t.checked,t!=null&&t2(e,"checked",t,!1)}function Lg(e,t){X5(e,t);var r=Is(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Mg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Mg(e,t.type,Is(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function C4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Mg(e,t,r){(t!=="number"||ud(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var t0=Array.isArray;function Il(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Is(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Bg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Re(91));return sr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function T4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Re(92));if(t0(r)){if(1<r.length)throw Error(Re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Is(r)}}function K5(e,t){var r=Is(t.value),n=Is(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function A4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Y5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Y5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var yf,Q5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(yf=yf||document.createElement("div"),yf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=yf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function F0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var u0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uk=["Webkit","ms","Moz","O"];Object.keys(u0).forEach(function(e){Uk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),u0[t]=u0[e]})});function q5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||u0.hasOwnProperty(e)&&u0[e]?(""+t).trim():t+"px"}function J5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=q5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var zk=sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ug(e,t){if(t){if(zk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Re(62))}}function zg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vg=null;function a2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gg=null,bl=null,Ol=null;function P4(e){if(e=uu(e)){if(typeof Gg!="function")throw Error(Re(280));var t=e.stateNode;t&&(t=oh(t),Gg(e.stateNode,e.type,t))}}function Z5(e){bl?Ol?Ol.push(e):Ol=[e]:bl=e}function e_(){if(bl){var e=bl,t=Ol;if(Ol=bl=null,P4(e),t)for(e=0;e<t.length;e++)P4(t[e])}}function t_(e,t){return e(t)}function r_(){}var Ip=!1;function n_(e,t,r){if(Ip)return e(t,r);Ip=!0;try{return t_(e,t,r)}finally{Ip=!1,(bl!==null||Ol!==null)&&(r_(),e_())}}function N0(e,t){var r=e.stateNode;if(r===null)return null;var n=oh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Re(231,t,typeof r));return r}var Hg=!1;if(Va)try{var Bc={};Object.defineProperty(Bc,"passive",{get:function(){Hg=!0}}),window.addEventListener("test",Bc,Bc),window.removeEventListener("test",Bc,Bc)}catch{Hg=!1}function Vk(e,t,r,n,i,a,s,o,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var f0=!1,fd=null,dd=!1,Wg=null,Gk={onError:function(e){f0=!0,fd=e}};function Hk(e,t,r,n,i,a,s,o,u){f0=!1,fd=null,Vk.apply(Gk,arguments)}function Wk(e,t,r,n,i,a,s,o,u){if(Hk.apply(this,arguments),f0){if(f0){var f=fd;f0=!1,fd=null}else throw Error(Re(198));dd||(dd=!0,Wg=f)}}function bo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function i_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function F4(e){if(bo(e)!==e)throw Error(Re(188))}function $k(e){var t=e.alternate;if(!t){if(t=bo(e),t===null)throw Error(Re(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return F4(i),e;if(a===n)return F4(i),t;a=a.sibling}throw Error(Re(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Re(189))}}if(r.alternate!==n)throw Error(Re(190))}if(r.tag!==3)throw Error(Re(188));return r.stateNode.current===r?e:t}function a_(e){return e=$k(e),e!==null?s_(e):null}function s_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=s_(e);if(t!==null)return t;e=e.sibling}return null}var o_=ti.unstable_scheduleCallback,N4=ti.unstable_cancelCallback,Xk=ti.unstable_shouldYield,Kk=ti.unstable_requestPaint,mr=ti.unstable_now,Yk=ti.unstable_getCurrentPriorityLevel,s2=ti.unstable_ImmediatePriority,l_=ti.unstable_UserBlockingPriority,hd=ti.unstable_NormalPriority,Qk=ti.unstable_LowPriority,c_=ti.unstable_IdlePriority,nh=null,ga=null;function qk(e){if(ga&&typeof ga.onCommitFiberRoot=="function")try{ga.onCommitFiberRoot(nh,e,void 0,(e.current.flags&128)===128)}catch{}}var Xi=Math.clz32?Math.clz32:e9,Jk=Math.log,Zk=Math.LN2;function e9(e){return e>>>=0,e===0?32:31-(Jk(e)/Zk|0)|0}var _f=64,Sf=4194304;function r0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=r0(o):(a&=s,a!==0&&(n=r0(a)))}else s=r&~i,s!==0?n=r0(s):a!==0&&(n=r0(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Xi(t),i=1<<r,n|=e[r],t&=~i;return n}function t9(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r9(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Xi(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=t9(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}function $g(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function u_(){var e=_f;return _f<<=1,!(_f&4194240)&&(_f=64),e}function bp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function lu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xi(t),e[t]=r}function n9(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Xi(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function o2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Xi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var jt=0;function f_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var d_,l2,h_,p_,g_,Xg=!1,wf=[],ks=null,Es=null,Cs=null,R0=new Map,I0=new Map,gs=[],i9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function R4(e,t){switch(e){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":R0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":I0.delete(t.pointerId)}}function jc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=uu(t),t!==null&&l2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function a9(e,t,r,n,i){switch(t){case"focusin":return ks=jc(ks,e,t,r,n,i),!0;case"dragenter":return Es=jc(Es,e,t,r,n,i),!0;case"mouseover":return Cs=jc(Cs,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return R0.set(a,jc(R0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,I0.set(a,jc(I0.get(a)||null,e,t,r,n,i)),!0}return!1}function m_(e){var t=po(e.target);if(t!==null){var r=bo(t);if(r!==null){if(t=r.tag,t===13){if(t=i_(r),t!==null){e.blockedOn=t,g_(e.priority,function(){h_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Kg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Vg=n,r.target.dispatchEvent(n),Vg=null}else return t=uu(r),t!==null&&l2(t),e.blockedOn=r,!1;t.shift()}return!0}function I4(e,t,r){Jf(e)&&r.delete(t)}function s9(){Xg=!1,ks!==null&&Jf(ks)&&(ks=null),Es!==null&&Jf(Es)&&(Es=null),Cs!==null&&Jf(Cs)&&(Cs=null),R0.forEach(I4),I0.forEach(I4)}function Uc(e,t){e.blockedOn===t&&(e.blockedOn=null,Xg||(Xg=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,s9)))}function b0(e){function t(i){return Uc(i,e)}if(0<wf.length){Uc(wf[0],e);for(var r=1;r<wf.length;r++){var n=wf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ks!==null&&Uc(ks,e),Es!==null&&Uc(Es,e),Cs!==null&&Uc(Cs,e),R0.forEach(t),I0.forEach(t),r=0;r<gs.length;r++)n=gs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<gs.length&&(r=gs[0],r.blockedOn===null);)m_(r),r.blockedOn===null&&gs.shift()}var Dl=Ka.ReactCurrentBatchConfig,gd=!0;function o9(e,t,r,n){var i=jt,a=Dl.transition;Dl.transition=null;try{jt=1,c2(e,t,r,n)}finally{jt=i,Dl.transition=a}}function l9(e,t,r,n){var i=jt,a=Dl.transition;Dl.transition=null;try{jt=4,c2(e,t,r,n)}finally{jt=i,Dl.transition=a}}function c2(e,t,r,n){if(gd){var i=Kg(e,t,r,n);if(i===null)Gp(e,t,n,md,r),R4(e,n);else if(a9(i,e,t,r,n))n.stopPropagation();else if(R4(e,n),t&4&&-1<i9.indexOf(e)){for(;i!==null;){var a=uu(i);if(a!==null&&d_(a),a=Kg(e,t,r,n),a===null&&Gp(e,t,n,md,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Gp(e,t,n,null,r)}}var md=null;function Kg(e,t,r,n){if(md=null,e=a2(n),e=po(e),e!==null)if(t=bo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=i_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return md=e,null}function x_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yk()){case s2:return 1;case l_:return 4;case hd:case Qk:return 16;case c_:return 536870912;default:return 16}default:return 16}}var ys=null,u2=null,Zf=null;function v_(){if(Zf)return Zf;var e,t=u2,r=t.length,n,i="value"in ys?ys.value:ys.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return Zf=i.slice(e,1<n?1-n:void 0)}function ed(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function kf(){return!0}function b4(){return!1}function ai(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?kf:b4,this.isPropagationStopped=b4,this}return sr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=kf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=kf)},persist:function(){},isPersistent:kf}),t}var ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f2=ai(ac),cu=sr({},ac,{view:0,detail:0}),c9=ai(cu),Op,Dp,zc,ih=sr({},cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:d2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zc&&(zc&&e.type==="mousemove"?(Op=e.screenX-zc.screenX,Dp=e.screenY-zc.screenY):Dp=Op=0,zc=e),Op)},movementY:function(e){return"movementY"in e?e.movementY:Dp}}),O4=ai(ih),u9=sr({},ih,{dataTransfer:0}),f9=ai(u9),d9=sr({},cu,{relatedTarget:0}),Lp=ai(d9),h9=sr({},ac,{animationName:0,elapsedTime:0,pseudoElement:0}),p9=ai(h9),g9=sr({},ac,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),m9=ai(g9),x9=sr({},ac,{data:0}),D4=ai(x9),v9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},y9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S9(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_9[e])?!!t[e]:!1}function d2(){return S9}var w9=sr({},cu,{key:function(e){if(e.key){var t=v9[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ed(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?y9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:d2,charCode:function(e){return e.type==="keypress"?ed(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ed(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),k9=ai(w9),E9=sr({},ih,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),L4=ai(E9),C9=sr({},cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:d2}),T9=ai(C9),A9=sr({},ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),P9=ai(A9),F9=sr({},ih,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),N9=ai(F9),R9=[9,13,27,32],h2=Va&&"CompositionEvent"in window,d0=null;Va&&"documentMode"in document&&(d0=document.documentMode);var I9=Va&&"TextEvent"in window&&!d0,y_=Va&&(!h2||d0&&8<d0&&11>=d0),M4=String.fromCharCode(32),B4=!1;function __(e,t){switch(e){case"keyup":return R9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sl=!1;function b9(e,t){switch(e){case"compositionend":return S_(t);case"keypress":return t.which!==32?null:(B4=!0,M4);case"textInput":return e=t.data,e===M4&&B4?null:e;default:return null}}function O9(e,t){if(Sl)return e==="compositionend"||!h2&&__(e,t)?(e=v_(),Zf=u2=ys=null,Sl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return y_&&t.locale!=="ko"?null:t.data;default:return null}}var D9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!D9[e.type]:t==="textarea"}function w_(e,t,r,n){Z5(n),t=xd(t,"onChange"),0<t.length&&(r=new f2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var h0=null,O0=null;function L9(e){b_(e,0)}function ah(e){var t=El(e);if($5(t))return e}function M9(e,t){if(e==="change")return t}var k_=!1;if(Va){var Mp;if(Va){var Bp="oninput"in document;if(!Bp){var U4=document.createElement("div");U4.setAttribute("oninput","return;"),Bp=typeof U4.oninput=="function"}Mp=Bp}else Mp=!1;k_=Mp&&(!document.documentMode||9<document.documentMode)}function z4(){h0&&(h0.detachEvent("onpropertychange",E_),O0=h0=null)}function E_(e){if(e.propertyName==="value"&&ah(O0)){var t=[];w_(t,O0,e,a2(e)),n_(L9,t)}}function B9(e,t,r){e==="focusin"?(z4(),h0=t,O0=r,h0.attachEvent("onpropertychange",E_)):e==="focusout"&&z4()}function j9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ah(O0)}function U9(e,t){if(e==="click")return ah(t)}function z9(e,t){if(e==="input"||e==="change")return ah(t)}function V9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ji=typeof Object.is=="function"?Object.is:V9;function D0(e,t){if(Ji(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Ng.call(t,i)||!Ji(e[i],t[i]))return!1}return!0}function V4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function G4(e,t){var r=V4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=V4(r)}}function C_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?C_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function T_(){for(var e=window,t=ud();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ud(e.document)}return t}function p2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function G9(e){var t=T_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&C_(r.ownerDocument.documentElement,r)){if(n!==null&&p2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=G4(r,a);var s=G4(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var H9=Va&&"documentMode"in document&&11>=document.documentMode,wl=null,Yg=null,p0=null,Qg=!1;function H4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qg||wl==null||wl!==ud(n)||(n=wl,"selectionStart"in n&&p2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),p0&&D0(p0,n)||(p0=n,n=xd(Yg,"onSelect"),0<n.length&&(t=new f2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=wl)))}function Ef(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var kl={animationend:Ef("Animation","AnimationEnd"),animationiteration:Ef("Animation","AnimationIteration"),animationstart:Ef("Animation","AnimationStart"),transitionend:Ef("Transition","TransitionEnd")},jp={},A_={};Va&&(A_=document.createElement("div").style,"AnimationEvent"in window||(delete kl.animationend.animation,delete kl.animationiteration.animation,delete kl.animationstart.animation),"TransitionEvent"in window||delete kl.transitionend.transition);function sh(e){if(jp[e])return jp[e];if(!kl[e])return e;var t=kl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in A_)return jp[e]=t[r];return e}var P_=sh("animationend"),F_=sh("animationiteration"),N_=sh("animationstart"),R_=sh("transitionend"),I_=new Map,W4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function js(e,t){I_.set(e,t),Io(t,[e])}for(var Up=0;Up<W4.length;Up++){var zp=W4[Up],W9=zp.toLowerCase(),$9=zp[0].toUpperCase()+zp.slice(1);js(W9,"on"+$9)}js(P_,"onAnimationEnd");js(F_,"onAnimationIteration");js(N_,"onAnimationStart");js("dblclick","onDoubleClick");js("focusin","onFocus");js("focusout","onBlur");js(R_,"onTransitionEnd");Gl("onMouseEnter",["mouseout","mouseover"]);Gl("onMouseLeave",["mouseout","mouseover"]);Gl("onPointerEnter",["pointerout","pointerover"]);Gl("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var n0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X9=new Set("cancel close invalid load scroll toggle".split(" ").concat(n0));function $4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Wk(n,t,void 0,e),e.currentTarget=null}function b_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,f=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;$4(i,o,f),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,f=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;$4(i,o,f),a=u}}}if(dd)throw e=Wg,dd=!1,Wg=null,e}function Yt(e,t){var r=t[tm];r===void 0&&(r=t[tm]=new Set);var n=e+"__bubble";r.has(n)||(O_(t,e,2,!1),r.add(n))}function Vp(e,t,r){var n=0;t&&(n|=4),O_(r,e,n,t)}var Cf="_reactListening"+Math.random().toString(36).slice(2);function L0(e){if(!e[Cf]){e[Cf]=!0,z5.forEach(function(r){r!=="selectionchange"&&(X9.has(r)||Vp(r,!1,e),Vp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cf]||(t[Cf]=!0,Vp("selectionchange",!1,t))}}function O_(e,t,r,n){switch(x_(t)){case 1:var i=o9;break;case 4:i=l9;break;default:i=c2}r=i.bind(null,t,r,e),i=void 0,!Hg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Gp(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=po(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}n_(function(){var f=a,d=a2(r),p=[];e:{var g=I_.get(e);if(g!==void 0){var v=f2,m=e;switch(e){case"keypress":if(ed(r)===0)break e;case"keydown":case"keyup":v=k9;break;case"focusin":m="focus",v=Lp;break;case"focusout":m="blur",v=Lp;break;case"beforeblur":case"afterblur":v=Lp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=O4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=f9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=T9;break;case P_:case F_:case N_:v=p9;break;case R_:v=P9;break;case"scroll":v=c9;break;case"wheel":v=N9;break;case"copy":case"cut":case"paste":v=m9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=L4}var _=(t&4)!==0,C=!_&&e==="scroll",S=_?g!==null?g+"Capture":null:g;_=[];for(var w=f,x;w!==null;){x=w;var T=x.stateNode;if(x.tag===5&&T!==null&&(x=T,S!==null&&(T=N0(w,S),T!=null&&_.push(M0(w,T,x)))),C)break;w=w.return}0<_.length&&(g=new v(g,m,null,r,d),p.push({event:g,listeners:_}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&r!==Vg&&(m=r.relatedTarget||r.fromElement)&&(po(m)||m[Ga]))break e;if((v||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,v?(m=r.relatedTarget||r.toElement,v=f,m=m?po(m):null,m!==null&&(C=bo(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(v=null,m=f),v!==m)){if(_=O4,T="onMouseLeave",S="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(_=L4,T="onPointerLeave",S="onPointerEnter",w="pointer"),C=v==null?g:El(v),x=m==null?g:El(m),g=new _(T,w+"leave",v,r,d),g.target=C,g.relatedTarget=x,T=null,po(d)===f&&(_=new _(S,w+"enter",m,r,d),_.target=x,_.relatedTarget=C,T=_),C=T,v&&m)t:{for(_=v,S=m,w=0,x=_;x;x=ul(x))w++;for(x=0,T=S;T;T=ul(T))x++;for(;0<w-x;)_=ul(_),w--;for(;0<x-w;)S=ul(S),x--;for(;w--;){if(_===S||S!==null&&_===S.alternate)break t;_=ul(_),S=ul(S)}_=null}else _=null;v!==null&&X4(p,g,v,_,!1),m!==null&&C!==null&&X4(p,C,m,_,!0)}}e:{if(g=f?El(f):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var A=M9;else if(j4(g))if(k_)A=z9;else{A=j9;var N=B9}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(A=U9);if(A&&(A=A(e,f))){w_(p,A,r,d);break e}N&&N(e,g,f),e==="focusout"&&(N=g._wrapperState)&&N.controlled&&g.type==="number"&&Mg(g,"number",g.value)}switch(N=f?El(f):window,e){case"focusin":(j4(N)||N.contentEditable==="true")&&(wl=N,Yg=f,p0=null);break;case"focusout":p0=Yg=wl=null;break;case"mousedown":Qg=!0;break;case"contextmenu":case"mouseup":case"dragend":Qg=!1,H4(p,r,d);break;case"selectionchange":if(H9)break;case"keydown":case"keyup":H4(p,r,d)}var R;if(h2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Sl?__(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(y_&&r.locale!=="ko"&&(Sl||P!=="onCompositionStart"?P==="onCompositionEnd"&&Sl&&(R=v_()):(ys=d,u2="value"in ys?ys.value:ys.textContent,Sl=!0)),N=xd(f,P),0<N.length&&(P=new D4(P,e,null,r,d),p.push({event:P,listeners:N}),R?P.data=R:(R=S_(r),R!==null&&(P.data=R)))),(R=I9?b9(e,r):O9(e,r))&&(f=xd(f,"onBeforeInput"),0<f.length&&(d=new D4("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:f}),d.data=R))}b_(p,t)})}function M0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function xd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=N0(e,r),a!=null&&n.unshift(M0(e,a,i)),a=N0(e,t),a!=null&&n.push(M0(e,a,i))),e=e.return}return n}function ul(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function X4(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,f=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&f!==null&&(o=f,i?(u=N0(r,a),u!=null&&s.unshift(M0(r,u,o))):i||(u=N0(r,a),u!=null&&s.push(M0(r,u,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var K9=/\r\n?/g,Y9=/\u0000|\uFFFD/g;function K4(e){return(typeof e=="string"?e:""+e).replace(K9,`
`).replace(Y9,"")}function Tf(e,t,r){if(t=K4(t),K4(e)!==t&&r)throw Error(Re(425))}function vd(){}var qg=null,Jg=null;function Zg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var em=typeof setTimeout=="function"?setTimeout:void 0,Q9=typeof clearTimeout=="function"?clearTimeout:void 0,Y4=typeof Promise=="function"?Promise:void 0,q9=typeof queueMicrotask=="function"?queueMicrotask:typeof Y4<"u"?function(e){return Y4.resolve(null).then(e).catch(J9)}:em;function J9(e){setTimeout(function(){throw e})}function Hp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),b0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);b0(t)}function Ts(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Q4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var sc=Math.random().toString(36).slice(2),da="__reactFiber$"+sc,B0="__reactProps$"+sc,Ga="__reactContainer$"+sc,tm="__reactEvents$"+sc,Z9="__reactListeners$"+sc,eE="__reactHandles$"+sc;function po(e){var t=e[da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ga]||r[da]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Q4(e);e!==null;){if(r=e[da])return r;e=Q4(e)}return t}e=r,r=e.parentNode}return null}function uu(e){return e=e[da]||e[Ga],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function El(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Re(33))}function oh(e){return e[B0]||null}var rm=[],Cl=-1;function Us(e){return{current:e}}function Qt(e){0>Cl||(e.current=rm[Cl],rm[Cl]=null,Cl--)}function $t(e,t){Cl++,rm[Cl]=e.current,e.current=t}var bs={},yn=Us(bs),Wn=Us(!1),ko=bs;function Hl(e,t){var r=e.type.contextTypes;if(!r)return bs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function $n(e){return e=e.childContextTypes,e!=null}function yd(){Qt(Wn),Qt(yn)}function q4(e,t,r){if(yn.current!==bs)throw Error(Re(168));$t(yn,t),$t(Wn,r)}function D_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Re(108,Bk(e)||"Unknown",i));return sr({},r,n)}function _d(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,ko=yn.current,$t(yn,e),$t(Wn,Wn.current),!0}function J4(e,t,r){var n=e.stateNode;if(!n)throw Error(Re(169));r?(e=D_(e,t,ko),n.__reactInternalMemoizedMergedChildContext=e,Qt(Wn),Qt(yn),$t(yn,e)):Qt(Wn),$t(Wn,r)}var ba=null,lh=!1,Wp=!1;function L_(e){ba===null?ba=[e]:ba.push(e)}function tE(e){lh=!0,L_(e)}function zs(){if(!Wp&&ba!==null){Wp=!0;var e=0,t=jt;try{var r=ba;for(jt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ba=null,lh=!1}catch(i){throw ba!==null&&(ba=ba.slice(e+1)),o_(s2,zs),i}finally{jt=t,Wp=!1}}return null}var Tl=[],Al=0,Sd=null,wd=0,Si=[],wi=0,Eo=null,Da=1,La="";function lo(e,t){Tl[Al++]=wd,Tl[Al++]=Sd,Sd=e,wd=t}function M_(e,t,r){Si[wi++]=Da,Si[wi++]=La,Si[wi++]=Eo,Eo=e;var n=Da;e=La;var i=32-Xi(n)-1;n&=~(1<<i),r+=1;var a=32-Xi(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Da=1<<32-Xi(t)+i|r<<i|n,La=a+e}else Da=1<<a|r<<i|n,La=e}function g2(e){e.return!==null&&(lo(e,1),M_(e,1,0))}function m2(e){for(;e===Sd;)Sd=Tl[--Al],Tl[Al]=null,wd=Tl[--Al],Tl[Al]=null;for(;e===Eo;)Eo=Si[--wi],Si[wi]=null,La=Si[--wi],Si[wi]=null,Da=Si[--wi],Si[wi]=null}var ei=null,Zn=null,er=!1,Gi=null;function B_(e,t){var r=Ei(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Z4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ei=e,Zn=Ts(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ei=e,Zn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Eo!==null?{id:Da,overflow:La}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ei(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ei=e,Zn=null,!0):!1;default:return!1}}function nm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function im(e){if(er){var t=Zn;if(t){var r=t;if(!Z4(e,t)){if(nm(e))throw Error(Re(418));t=Ts(r.nextSibling);var n=ei;t&&Z4(e,t)?B_(n,r):(e.flags=e.flags&-4097|2,er=!1,ei=e)}}else{if(nm(e))throw Error(Re(418));e.flags=e.flags&-4097|2,er=!1,ei=e}}}function ey(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ei=e}function Af(e){if(e!==ei)return!1;if(!er)return ey(e),er=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Zg(e.type,e.memoizedProps)),t&&(t=Zn)){if(nm(e))throw j_(),Error(Re(418));for(;t;)B_(e,t),t=Ts(t.nextSibling)}if(ey(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zn=Ts(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zn=null}}else Zn=ei?Ts(e.stateNode.nextSibling):null;return!0}function j_(){for(var e=Zn;e;)e=Ts(e.nextSibling)}function Wl(){Zn=ei=null,er=!1}function x2(e){Gi===null?Gi=[e]:Gi.push(e)}var rE=Ka.ReactCurrentBatchConfig;function Vc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Re(309));var n=r.stateNode}if(!n)throw Error(Re(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(Re(284));if(!r._owner)throw Error(Re(290,e))}return e}function Pf(e,t){throw e=Object.prototype.toString.call(t),Error(Re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ty(e){var t=e._init;return t(e._payload)}function U_(e){function t(S,w){if(e){var x=S.deletions;x===null?(S.deletions=[w],S.flags|=16):x.push(w)}}function r(S,w){if(!e)return null;for(;w!==null;)t(S,w),w=w.sibling;return null}function n(S,w){for(S=new Map;w!==null;)w.key!==null?S.set(w.key,w):S.set(w.index,w),w=w.sibling;return S}function i(S,w){return S=Ns(S,w),S.index=0,S.sibling=null,S}function a(S,w,x){return S.index=x,e?(x=S.alternate,x!==null?(x=x.index,x<w?(S.flags|=2,w):x):(S.flags|=2,w)):(S.flags|=1048576,w)}function s(S){return e&&S.alternate===null&&(S.flags|=2),S}function o(S,w,x,T){return w===null||w.tag!==6?(w=Jp(x,S.mode,T),w.return=S,w):(w=i(w,x),w.return=S,w)}function u(S,w,x,T){var A=x.type;return A===_l?d(S,w,x.props.children,T,x.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===hs&&ty(A)===w.type)?(T=i(w,x.props),T.ref=Vc(S,w,x),T.return=S,T):(T=od(x.type,x.key,x.props,null,S.mode,T),T.ref=Vc(S,w,x),T.return=S,T)}function f(S,w,x,T){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=Zp(x,S.mode,T),w.return=S,w):(w=i(w,x.children||[]),w.return=S,w)}function d(S,w,x,T,A){return w===null||w.tag!==7?(w=_o(x,S.mode,T,A),w.return=S,w):(w=i(w,x),w.return=S,w)}function p(S,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Jp(""+w,S.mode,x),w.return=S,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xf:return x=od(w.type,w.key,w.props,null,S.mode,x),x.ref=Vc(S,null,w),x.return=S,x;case yl:return w=Zp(w,S.mode,x),w.return=S,w;case hs:var T=w._init;return p(S,T(w._payload),x)}if(t0(w)||Mc(w))return w=_o(w,S.mode,x,null),w.return=S,w;Pf(S,w)}return null}function g(S,w,x,T){var A=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return A!==null?null:o(S,w,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case xf:return x.key===A?u(S,w,x,T):null;case yl:return x.key===A?f(S,w,x,T):null;case hs:return A=x._init,g(S,w,A(x._payload),T)}if(t0(x)||Mc(x))return A!==null?null:d(S,w,x,T,null);Pf(S,x)}return null}function v(S,w,x,T,A){if(typeof T=="string"&&T!==""||typeof T=="number")return S=S.get(x)||null,o(w,S,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case xf:return S=S.get(T.key===null?x:T.key)||null,u(w,S,T,A);case yl:return S=S.get(T.key===null?x:T.key)||null,f(w,S,T,A);case hs:var N=T._init;return v(S,w,x,N(T._payload),A)}if(t0(T)||Mc(T))return S=S.get(x)||null,d(w,S,T,A,null);Pf(w,T)}return null}function m(S,w,x,T){for(var A=null,N=null,R=w,P=w=0,I=null;R!==null&&P<x.length;P++){R.index>P?(I=R,R=null):I=R.sibling;var b=g(S,R,x[P],T);if(b===null){R===null&&(R=I);break}e&&R&&b.alternate===null&&t(S,R),w=a(b,w,P),N===null?A=b:N.sibling=b,N=b,R=I}if(P===x.length)return r(S,R),er&&lo(S,P),A;if(R===null){for(;P<x.length;P++)R=p(S,x[P],T),R!==null&&(w=a(R,w,P),N===null?A=R:N.sibling=R,N=R);return er&&lo(S,P),A}for(R=n(S,R);P<x.length;P++)I=v(R,S,P,x[P],T),I!==null&&(e&&I.alternate!==null&&R.delete(I.key===null?P:I.key),w=a(I,w,P),N===null?A=I:N.sibling=I,N=I);return e&&R.forEach(function(M){return t(S,M)}),er&&lo(S,P),A}function _(S,w,x,T){var A=Mc(x);if(typeof A!="function")throw Error(Re(150));if(x=A.call(x),x==null)throw Error(Re(151));for(var N=A=null,R=w,P=w=0,I=null,b=x.next();R!==null&&!b.done;P++,b=x.next()){R.index>P?(I=R,R=null):I=R.sibling;var M=g(S,R,b.value,T);if(M===null){R===null&&(R=I);break}e&&R&&M.alternate===null&&t(S,R),w=a(M,w,P),N===null?A=M:N.sibling=M,N=M,R=I}if(b.done)return r(S,R),er&&lo(S,P),A;if(R===null){for(;!b.done;P++,b=x.next())b=p(S,b.value,T),b!==null&&(w=a(b,w,P),N===null?A=b:N.sibling=b,N=b);return er&&lo(S,P),A}for(R=n(S,R);!b.done;P++,b=x.next())b=v(R,S,P,b.value,T),b!==null&&(e&&b.alternate!==null&&R.delete(b.key===null?P:b.key),w=a(b,w,P),N===null?A=b:N.sibling=b,N=b);return e&&R.forEach(function(D){return t(S,D)}),er&&lo(S,P),A}function C(S,w,x,T){if(typeof x=="object"&&x!==null&&x.type===_l&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case xf:e:{for(var A=x.key,N=w;N!==null;){if(N.key===A){if(A=x.type,A===_l){if(N.tag===7){r(S,N.sibling),w=i(N,x.props.children),w.return=S,S=w;break e}}else if(N.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===hs&&ty(A)===N.type){r(S,N.sibling),w=i(N,x.props),w.ref=Vc(S,N,x),w.return=S,S=w;break e}r(S,N);break}else t(S,N);N=N.sibling}x.type===_l?(w=_o(x.props.children,S.mode,T,x.key),w.return=S,S=w):(T=od(x.type,x.key,x.props,null,S.mode,T),T.ref=Vc(S,w,x),T.return=S,S=T)}return s(S);case yl:e:{for(N=x.key;w!==null;){if(w.key===N)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(S,w.sibling),w=i(w,x.children||[]),w.return=S,S=w;break e}else{r(S,w);break}else t(S,w);w=w.sibling}w=Zp(x,S.mode,T),w.return=S,S=w}return s(S);case hs:return N=x._init,C(S,w,N(x._payload),T)}if(t0(x))return m(S,w,x,T);if(Mc(x))return _(S,w,x,T);Pf(S,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(S,w.sibling),w=i(w,x),w.return=S,S=w):(r(S,w),w=Jp(x,S.mode,T),w.return=S,S=w),s(S)):r(S,w)}return C}var $l=U_(!0),z_=U_(!1),kd=Us(null),Ed=null,Pl=null,v2=null;function y2(){v2=Pl=Ed=null}function _2(e){var t=kd.current;Qt(kd),e._currentValue=t}function am(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ll(e,t){Ed=e,v2=Pl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Hn=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(v2!==e)if(e={context:e,memoizedValue:t,next:null},Pl===null){if(Ed===null)throw Error(Re(308));Pl=e,Ed.dependencies={lanes:0,firstContext:e}}else Pl=Pl.next=e;return t}var go=null;function S2(e){go===null?go=[e]:go.push(e)}function V_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,S2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ha(e,n)}function Ha(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ps=!1;function w2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function As(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ft&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ha(e,r)}return i=n.interleaved,i===null?(t.next=t,S2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ha(e,r)}function td(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o2(e,r)}}function ry(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Cd(e,t,r,n){var i=e.updateQueue;ps=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,f=u.next;u.next=null,s===null?a=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=f:o.next=f,d.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;s=0,d=f=u=null,o=a;do{var g=o.lane,v=o.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,_=o;switch(g=t,v=r,_.tag){case 1:if(m=_.payload,typeof m=="function"){p=m.call(v,p,g);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=_.payload,g=typeof m=="function"?m.call(v,p,g):m,g==null)break e;p=sr({},p,g);break e;case 2:ps=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else v={eventTime:v,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(f=d=v,u=p):d=d.next=v,s|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);To|=s,e.lanes=s,e.memoizedState=p}}function ny(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Re(191,i));i.call(n)}}}var fu={},ma=Us(fu),j0=Us(fu),U0=Us(fu);function mo(e){if(e===fu)throw Error(Re(174));return e}function k2(e,t){switch($t(U0,t),$t(j0,e),$t(ma,fu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jg(t,e)}Qt(ma),$t(ma,t)}function Xl(){Qt(ma),Qt(j0),Qt(U0)}function H_(e){mo(U0.current);var t=mo(ma.current),r=jg(t,e.type);t!==r&&($t(j0,e),$t(ma,r))}function E2(e){j0.current===e&&(Qt(ma),Qt(j0))}var ir=Us(0);function Td(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $p=[];function C2(){for(var e=0;e<$p.length;e++)$p[e]._workInProgressVersionPrimary=null;$p.length=0}var rd=Ka.ReactCurrentDispatcher,Xp=Ka.ReactCurrentBatchConfig,Co=0,ar=null,Nr=null,Hr=null,Ad=!1,g0=!1,z0=0,nE=0;function un(){throw Error(Re(321))}function T2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ji(e[r],t[r]))return!1;return!0}function A2(e,t,r,n,i,a){if(Co=a,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rd.current=e===null||e.memoizedState===null?oE:lE,e=r(n,i),g0){a=0;do{if(g0=!1,z0=0,25<=a)throw Error(Re(301));a+=1,Hr=Nr=null,t.updateQueue=null,rd.current=cE,e=r(n,i)}while(g0)}if(rd.current=Pd,t=Nr!==null&&Nr.next!==null,Co=0,Hr=Nr=ar=null,Ad=!1,t)throw Error(Re(300));return e}function P2(){var e=z0!==0;return z0=0,e}function fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?ar.memoizedState=Hr=e:Hr=Hr.next=e,Hr}function Ai(){if(Nr===null){var e=ar.alternate;e=e!==null?e.memoizedState:null}else e=Nr.next;var t=Hr===null?ar.memoizedState:Hr.next;if(t!==null)Hr=t,Nr=e;else{if(e===null)throw Error(Re(310));Nr=e,e={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Hr===null?ar.memoizedState=Hr=e:Hr=Hr.next=e}return Hr}function V0(e,t){return typeof t=="function"?t(e):t}function Kp(e){var t=Ai(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=Nr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,f=a;do{var d=f.lane;if((Co&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(o=u=p,s=n):u=u.next=p,ar.lanes|=d,To|=d}f=f.next}while(f!==null&&f!==a);u===null?s=n:u.next=o,Ji(n,t.memoizedState)||(Hn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,ar.lanes|=a,To|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Yp(e){var t=Ai(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Ji(a,t.memoizedState)||(Hn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function W_(){}function $_(e,t){var r=ar,n=Ai(),i=t(),a=!Ji(n.memoizedState,i);if(a&&(n.memoizedState=i,Hn=!0),n=n.queue,F2(Y_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Hr!==null&&Hr.memoizedState.tag&1){if(r.flags|=2048,G0(9,K_.bind(null,r,n,i,t),void 0,null),Wr===null)throw Error(Re(349));Co&30||X_(r,t,i)}return i}function X_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function K_(e,t,r,n){t.value=r,t.getSnapshot=n,Q_(t)&&q_(e)}function Y_(e,t,r){return r(function(){Q_(t)&&q_(e)})}function Q_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ji(e,r)}catch{return!0}}function q_(e){var t=Ha(e,1);t!==null&&Ki(t,e,1,-1)}function iy(e){var t=fa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:V0,lastRenderedState:e},t.queue=e,e=e.dispatch=sE.bind(null,ar,e),[t.memoizedState,e]}function G0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function J_(){return Ai().memoizedState}function nd(e,t,r,n){var i=fa();ar.flags|=e,i.memoizedState=G0(1|t,r,void 0,n===void 0?null:n)}function ch(e,t,r,n){var i=Ai();n=n===void 0?null:n;var a=void 0;if(Nr!==null){var s=Nr.memoizedState;if(a=s.destroy,n!==null&&T2(n,s.deps)){i.memoizedState=G0(t,r,a,n);return}}ar.flags|=e,i.memoizedState=G0(1|t,r,a,n)}function ay(e,t){return nd(8390656,8,e,t)}function F2(e,t){return ch(2048,8,e,t)}function Z_(e,t){return ch(4,2,e,t)}function e6(e,t){return ch(4,4,e,t)}function t6(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function r6(e,t,r){return r=r!=null?r.concat([e]):null,ch(4,4,t6.bind(null,t,e),r)}function N2(){}function n6(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function i6(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function a6(e,t,r){return Co&21?(Ji(r,t)||(r=u_(),ar.lanes|=r,To|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Hn=!0),e.memoizedState=r)}function iE(e,t){var r=jt;jt=r!==0&&4>r?r:4,e(!0);var n=Xp.transition;Xp.transition={};try{e(!1),t()}finally{jt=r,Xp.transition=n}}function s6(){return Ai().memoizedState}function aE(e,t,r){var n=Fs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},o6(e))l6(t,r);else if(r=V_(e,t,r,n),r!==null){var i=Nn();Ki(r,e,n,i),c6(r,t,n)}}function sE(e,t,r){var n=Fs(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(o6(e))l6(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Ji(o,s)){var u=t.interleaved;u===null?(i.next=i,S2(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=V_(e,t,i,n),r!==null&&(i=Nn(),Ki(r,e,n,i),c6(r,t,n))}}function o6(e){var t=e.alternate;return e===ar||t!==null&&t===ar}function l6(e,t){g0=Ad=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function c6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o2(e,r)}}var Pd={readContext:Ti,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},oE={readContext:Ti,useCallback:function(e,t){return fa().memoizedState=[e,t===void 0?null:t],e},useContext:Ti,useEffect:ay,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,nd(4194308,4,t6.bind(null,t,e),r)},useLayoutEffect:function(e,t){return nd(4194308,4,e,t)},useInsertionEffect:function(e,t){return nd(4,2,e,t)},useMemo:function(e,t){var r=fa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=aE.bind(null,ar,e),[n.memoizedState,e]},useRef:function(e){var t=fa();return e={current:e},t.memoizedState=e},useState:iy,useDebugValue:N2,useDeferredValue:function(e){return fa().memoizedState=e},useTransition:function(){var e=iy(!1),t=e[0];return e=iE.bind(null,e[1]),fa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ar,i=fa();if(er){if(r===void 0)throw Error(Re(407));r=r()}else{if(r=t(),Wr===null)throw Error(Re(349));Co&30||X_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,ay(Y_.bind(null,n,a,e),[e]),n.flags|=2048,G0(9,K_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=fa(),t=Wr.identifierPrefix;if(er){var r=La,n=Da;r=(n&~(1<<32-Xi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=z0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=nE++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},lE={readContext:Ti,useCallback:n6,useContext:Ti,useEffect:F2,useImperativeHandle:r6,useInsertionEffect:Z_,useLayoutEffect:e6,useMemo:i6,useReducer:Kp,useRef:J_,useState:function(){return Kp(V0)},useDebugValue:N2,useDeferredValue:function(e){var t=Ai();return a6(t,Nr.memoizedState,e)},useTransition:function(){var e=Kp(V0)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:W_,useSyncExternalStore:$_,useId:s6,unstable_isNewReconciler:!1},cE={readContext:Ti,useCallback:n6,useContext:Ti,useEffect:F2,useImperativeHandle:r6,useInsertionEffect:Z_,useLayoutEffect:e6,useMemo:i6,useReducer:Yp,useRef:J_,useState:function(){return Yp(V0)},useDebugValue:N2,useDeferredValue:function(e){var t=Ai();return Nr===null?t.memoizedState=e:a6(t,Nr.memoizedState,e)},useTransition:function(){var e=Yp(V0)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:W_,useSyncExternalStore:$_,useId:s6,unstable_isNewReconciler:!1};function zi(e,t){if(e&&e.defaultProps){t=sr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function sm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:sr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var uh={isMounted:function(e){return(e=e._reactInternals)?bo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nn(),i=Fs(e),a=Ba(n,i);a.payload=t,r!=null&&(a.callback=r),t=As(e,a,i),t!==null&&(Ki(t,e,i,n),td(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nn(),i=Fs(e),a=Ba(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=As(e,a,i),t!==null&&(Ki(t,e,i,n),td(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nn(),n=Fs(e),i=Ba(r,n);i.tag=2,t!=null&&(i.callback=t),t=As(e,i,n),t!==null&&(Ki(t,e,n,r),td(t,e,n))}};function sy(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!D0(r,n)||!D0(i,a):!0}function u6(e,t,r){var n=!1,i=bs,a=t.contextType;return typeof a=="object"&&a!==null?a=Ti(a):(i=$n(t)?ko:yn.current,n=t.contextTypes,a=(n=n!=null)?Hl(e,i):bs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=uh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function oy(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&uh.enqueueReplaceState(t,t.state,null)}function om(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},w2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Ti(a):(a=$n(t)?ko:yn.current,i.context=Hl(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(sm(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&uh.enqueueReplaceState(i,i.state,null),Cd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Kl(e,t){try{var r="",n=t;do r+=Mk(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Qp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function lm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var uE=typeof WeakMap=="function"?WeakMap:Map;function f6(e,t,r){r=Ba(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Nd||(Nd=!0,vm=n),lm(e,t)},r}function d6(e,t,r){r=Ba(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){lm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){lm(e,t),typeof n!="function"&&(Ps===null?Ps=new Set([this]):Ps.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function ly(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new uE;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=EE.bind(null,e,t,r),t.then(e,e))}function cy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function uy(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ba(-1,1),t.tag=2,As(r,t,1))),r.lanes|=1),e)}var fE=Ka.ReactCurrentOwner,Hn=!1;function Tn(e,t,r,n){t.child=e===null?z_(t,null,r,n):$l(t,e.child,r,n)}function fy(e,t,r,n,i){r=r.render;var a=t.ref;return Ll(t,i),n=A2(e,t,r,n,a,i),r=P2(),e!==null&&!Hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i)):(er&&r&&g2(t),t.flags|=1,Tn(e,t,n,i),t.child)}function dy(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!B2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,h6(e,t,a,n,i)):(e=od(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:D0,r(s,n)&&e.ref===t.ref)return Wa(e,t,i)}return t.flags|=1,e=Ns(a,n),e.ref=t.ref,e.return=t,t.child=e}function h6(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(D0(a,n)&&e.ref===t.ref)if(Hn=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Hn=!0);else return t.lanes=e.lanes,Wa(e,t,i)}return cm(e,t,r,n,i)}function p6(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(Nl,Qn),Qn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$t(Nl,Qn),Qn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,$t(Nl,Qn),Qn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,$t(Nl,Qn),Qn|=n;return Tn(e,t,i,r),t.child}function g6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function cm(e,t,r,n,i){var a=$n(r)?ko:yn.current;return a=Hl(t,a),Ll(t,i),r=A2(e,t,r,n,a,i),n=P2(),e!==null&&!Hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i)):(er&&n&&g2(t),t.flags|=1,Tn(e,t,r,i),t.child)}function hy(e,t,r,n,i){if($n(r)){var a=!0;_d(t)}else a=!1;if(Ll(t,i),t.stateNode===null)id(e,t),u6(t,r,n),om(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=Ti(f):(f=$n(r)?ko:yn.current,f=Hl(t,f));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==f)&&oy(t,s,n,f),ps=!1;var g=t.memoizedState;s.state=g,Cd(t,n,s,i),u=t.memoizedState,o!==n||g!==u||Wn.current||ps?(typeof d=="function"&&(sm(t,r,d,n),u=t.memoizedState),(o=ps||sy(t,r,o,n,g,u,f))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=f,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,G_(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:zi(t.type,o),s.props=f,p=t.pendingProps,g=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=Ti(u):(u=$n(r)?ko:yn.current,u=Hl(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==p||g!==u)&&oy(t,s,n,u),ps=!1,g=t.memoizedState,s.state=g,Cd(t,n,s,i);var m=t.memoizedState;o!==p||g!==m||Wn.current||ps?(typeof v=="function"&&(sm(t,r,v,n),m=t.memoizedState),(f=ps||sy(t,r,f,n,g,m,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=u,n=f):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return um(e,t,r,n,a,i)}function um(e,t,r,n,i,a){g6(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&J4(t,r,!1),Wa(e,t,a);n=t.stateNode,fE.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=$l(t,e.child,null,a),t.child=$l(t,null,o,a)):Tn(e,t,o,a),t.memoizedState=n.state,i&&J4(t,r,!0),t.child}function m6(e){var t=e.stateNode;t.pendingContext?q4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&q4(e,t.context,!1),k2(e,t.containerInfo)}function py(e,t,r,n,i){return Wl(),x2(i),t.flags|=256,Tn(e,t,r,n),t.child}var fm={dehydrated:null,treeContext:null,retryLane:0};function dm(e){return{baseLanes:e,cachePool:null,transitions:null}}function x6(e,t,r){var n=t.pendingProps,i=ir.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),$t(ir,i&1),e===null)return im(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=hh(s,n,0,null),e=_o(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=dm(r),t.memoizedState=fm,e):R2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return dE(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ns(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Ns(o,a):(a=_o(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?dm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=fm,n}return a=e.child,e=a.sibling,n=Ns(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function R2(e,t){return t=hh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ff(e,t,r,n){return n!==null&&x2(n),$l(t,e.child,null,r),e=R2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function dE(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=Qp(Error(Re(422))),Ff(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=hh({mode:"visible",children:n.children},i,0,null),a=_o(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&$l(t,e.child,null,s),t.child.memoizedState=dm(s),t.memoizedState=fm,a);if(!(t.mode&1))return Ff(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Re(419)),n=Qp(a,n,void 0),Ff(e,t,s,n)}if(o=(s&e.childLanes)!==0,Hn||o){if(n=Wr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ha(e,i),Ki(n,e,i,-1))}return M2(),n=Qp(Error(Re(421))),Ff(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=CE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Zn=Ts(i.nextSibling),ei=t,er=!0,Gi=null,e!==null&&(Si[wi++]=Da,Si[wi++]=La,Si[wi++]=Eo,Da=e.id,La=e.overflow,Eo=t),t=R2(t,n.children),t.flags|=4096,t)}function gy(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),am(e.return,t,r)}function qp(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function v6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Tn(e,t,n.children,r),n=ir.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gy(e,r,t);else if(e.tag===19)gy(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if($t(ir,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Td(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),qp(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Td(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}qp(t,!0,r,null,a);break;case"together":qp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function id(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),To|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Re(153));if(t.child!==null){for(e=t.child,r=Ns(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ns(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function hE(e,t,r){switch(t.tag){case 3:m6(t),Wl();break;case 5:H_(t);break;case 1:$n(t.type)&&_d(t);break;case 4:k2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;$t(kd,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?($t(ir,ir.current&1),t.flags|=128,null):r&t.child.childLanes?x6(e,t,r):($t(ir,ir.current&1),e=Wa(e,t,r),e!==null?e.sibling:null);$t(ir,ir.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return v6(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$t(ir,ir.current),n)break;return null;case 22:case 23:return t.lanes=0,p6(e,t,r)}return Wa(e,t,r)}var y6,hm,_6,S6;y6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hm=function(){};_6=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,mo(ma.current);var a=null;switch(r){case"input":i=Dg(e,i),n=Dg(e,n),a=[];break;case"select":i=sr({},i,{value:void 0}),n=sr({},n,{value:void 0}),a=[];break;case"textarea":i=Bg(e,i),n=Bg(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=vd)}Ug(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var o=i[f];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(P0.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(o=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==o&&(u!=null||o!=null))if(f==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(P0.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Yt("scroll",e),a||o===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};S6=function(e,t,r,n){r!==n&&(t.flags|=4)};function Gc(e,t){if(!er)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function pE(e,t,r){var n=t.pendingProps;switch(m2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(t),null;case 1:return $n(t.type)&&yd(),fn(t),null;case 3:return n=t.stateNode,Xl(),Qt(Wn),Qt(yn),C2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Af(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gi!==null&&(Sm(Gi),Gi=null))),hm(e,t),fn(t),null;case 5:E2(t);var i=mo(U0.current);if(r=t.type,e!==null&&t.stateNode!=null)_6(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Re(166));return fn(t),null}if(e=mo(ma.current),Af(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[da]=t,n[B0]=a,e=(t.mode&1)!==0,r){case"dialog":Yt("cancel",n),Yt("close",n);break;case"iframe":case"object":case"embed":Yt("load",n);break;case"video":case"audio":for(i=0;i<n0.length;i++)Yt(n0[i],n);break;case"source":Yt("error",n);break;case"img":case"image":case"link":Yt("error",n),Yt("load",n);break;case"details":Yt("toggle",n);break;case"input":E4(n,a),Yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Yt("invalid",n);break;case"textarea":T4(n,a),Yt("invalid",n)}Ug(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Tf(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Tf(n.textContent,o,e),i=["children",""+o]):P0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Yt("scroll",n)}switch(r){case"input":vf(n),C4(n,a,!0);break;case"textarea":vf(n),A4(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=vd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Y5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[da]=t,e[B0]=n,y6(e,t,!1,!1),t.stateNode=e;e:{switch(s=zg(r,n),r){case"dialog":Yt("cancel",e),Yt("close",e),i=n;break;case"iframe":case"object":case"embed":Yt("load",e),i=n;break;case"video":case"audio":for(i=0;i<n0.length;i++)Yt(n0[i],e);i=n;break;case"source":Yt("error",e),i=n;break;case"img":case"image":case"link":Yt("error",e),Yt("load",e),i=n;break;case"details":Yt("toggle",e),i=n;break;case"input":E4(e,n),i=Dg(e,n),Yt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=sr({},n,{value:void 0}),Yt("invalid",e);break;case"textarea":T4(e,n),i=Bg(e,n),Yt("invalid",e);break;default:i=n}Ug(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?J5(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Q5(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&F0(e,u):typeof u=="number"&&F0(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(P0.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Yt("scroll",e):u!=null&&t2(e,a,u,s))}switch(r){case"input":vf(e),C4(e,n,!1);break;case"textarea":vf(e),A4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Is(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Il(e,!!n.multiple,a,!1):n.defaultValue!=null&&Il(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=vd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fn(t),null;case 6:if(e&&t.stateNode!=null)S6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Re(166));if(r=mo(U0.current),mo(ma.current),Af(t)){if(n=t.stateNode,r=t.memoizedProps,n[da]=t,(a=n.nodeValue!==r)&&(e=ei,e!==null))switch(e.tag){case 3:Tf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[da]=t,t.stateNode=n}return fn(t),null;case 13:if(Qt(ir),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(er&&Zn!==null&&t.mode&1&&!(t.flags&128))j_(),Wl(),t.flags|=98560,a=!1;else if(a=Af(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Re(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Re(317));a[da]=t}else Wl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fn(t),a=!1}else Gi!==null&&(Sm(Gi),Gi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ir.current&1?Rr===0&&(Rr=3):M2())),t.updateQueue!==null&&(t.flags|=4),fn(t),null);case 4:return Xl(),hm(e,t),e===null&&L0(t.stateNode.containerInfo),fn(t),null;case 10:return _2(t.type._context),fn(t),null;case 17:return $n(t.type)&&yd(),fn(t),null;case 19:if(Qt(ir),a=t.memoizedState,a===null)return fn(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)Gc(a,!1);else{if(Rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Td(e),s!==null){for(t.flags|=128,Gc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $t(ir,ir.current&1|2),t.child}e=e.sibling}a.tail!==null&&mr()>Yl&&(t.flags|=128,n=!0,Gc(a,!1),t.lanes=4194304)}else{if(!n)if(e=Td(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Gc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!er)return fn(t),null}else 2*mr()-a.renderingStartTime>Yl&&r!==1073741824&&(t.flags|=128,n=!0,Gc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=mr(),t.sibling=null,r=ir.current,$t(ir,n?r&1|2:r&1),t):(fn(t),null);case 22:case 23:return L2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qn&1073741824&&(fn(t),t.subtreeFlags&6&&(t.flags|=8192)):fn(t),null;case 24:return null;case 25:return null}throw Error(Re(156,t.tag))}function gE(e,t){switch(m2(t),t.tag){case 1:return $n(t.type)&&yd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xl(),Qt(Wn),Qt(yn),C2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return E2(t),null;case 13:if(Qt(ir),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Re(340));Wl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qt(ir),null;case 4:return Xl(),null;case 10:return _2(t.type._context),null;case 22:case 23:return L2(),null;case 24:return null;default:return null}}var Nf=!1,gn=!1,mE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Fl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){cr(e,t,n)}else r.current=null}function pm(e,t,r){try{r()}catch(n){cr(e,t,n)}}var my=!1;function xE(e,t){if(qg=gd,e=T_(),p2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,f=0,d=0,p=e,g=null;t:for(;;){for(var v;p!==r||i!==0&&p.nodeType!==3||(o=s+i),p!==a||n!==0&&p.nodeType!==3||(u=s+n),p.nodeType===3&&(s+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===e)break t;if(g===r&&++f===i&&(o=s),g===a&&++d===n&&(u=s),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Jg={focusedElem:e,selectionRange:r},gd=!1,$e=t;$e!==null;)if(t=$e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$e=e;else for(;$e!==null;){t=$e;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var _=m.memoizedProps,C=m.memoizedState,S=t.stateNode,w=S.getSnapshotBeforeUpdate(t.elementType===t.type?_:zi(t.type,_),C);S.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(T){cr(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,$e=e;break}$e=t.return}return m=my,my=!1,m}function m0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&pm(t,r,a)}i=i.next}while(i!==n)}}function fh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function gm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function w6(e){var t=e.alternate;t!==null&&(e.alternate=null,w6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[da],delete t[B0],delete t[tm],delete t[Z9],delete t[eE])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function k6(e){return e.tag===5||e.tag===3||e.tag===4}function xy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||k6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=vd));else if(n!==4&&(e=e.child,e!==null))for(mm(e,t,r),e=e.sibling;e!==null;)mm(e,t,r),e=e.sibling}function xm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(xm(e,t,r),e=e.sibling;e!==null;)xm(e,t,r),e=e.sibling}var Yr=null,Vi=!1;function cs(e,t,r){for(r=r.child;r!==null;)E6(e,t,r),r=r.sibling}function E6(e,t,r){if(ga&&typeof ga.onCommitFiberUnmount=="function")try{ga.onCommitFiberUnmount(nh,r)}catch{}switch(r.tag){case 5:gn||Fl(r,t);case 6:var n=Yr,i=Vi;Yr=null,cs(e,t,r),Yr=n,Vi=i,Yr!==null&&(Vi?(e=Yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yr.removeChild(r.stateNode));break;case 18:Yr!==null&&(Vi?(e=Yr,r=r.stateNode,e.nodeType===8?Hp(e.parentNode,r):e.nodeType===1&&Hp(e,r),b0(e)):Hp(Yr,r.stateNode));break;case 4:n=Yr,i=Vi,Yr=r.stateNode.containerInfo,Vi=!0,cs(e,t,r),Yr=n,Vi=i;break;case 0:case 11:case 14:case 15:if(!gn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&pm(r,t,s),i=i.next}while(i!==n)}cs(e,t,r);break;case 1:if(!gn&&(Fl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){cr(r,t,o)}cs(e,t,r);break;case 21:cs(e,t,r);break;case 22:r.mode&1?(gn=(n=gn)||r.memoizedState!==null,cs(e,t,r),gn=n):cs(e,t,r);break;default:cs(e,t,r)}}function vy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new mE),t.forEach(function(n){var i=TE.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Mi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yr=o.stateNode,Vi=!1;break e;case 3:Yr=o.stateNode.containerInfo,Vi=!0;break e;case 4:Yr=o.stateNode.containerInfo,Vi=!0;break e}o=o.return}if(Yr===null)throw Error(Re(160));E6(a,s,i),Yr=null,Vi=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){cr(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)C6(t,e),t=t.sibling}function C6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mi(t,e),la(e),n&4){try{m0(3,e,e.return),fh(3,e)}catch(_){cr(e,e.return,_)}try{m0(5,e,e.return)}catch(_){cr(e,e.return,_)}}break;case 1:Mi(t,e),la(e),n&512&&r!==null&&Fl(r,r.return);break;case 5:if(Mi(t,e),la(e),n&512&&r!==null&&Fl(r,r.return),e.flags&32){var i=e.stateNode;try{F0(i,"")}catch(_){cr(e,e.return,_)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&X5(i,a),zg(o,s);var f=zg(o,a);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];d==="style"?J5(i,p):d==="dangerouslySetInnerHTML"?Q5(i,p):d==="children"?F0(i,p):t2(i,d,p,f)}switch(o){case"input":Lg(i,a);break;case"textarea":K5(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Il(i,!!a.multiple,v,!1):g!==!!a.multiple&&(a.defaultValue!=null?Il(i,!!a.multiple,a.defaultValue,!0):Il(i,!!a.multiple,a.multiple?[]:"",!1))}i[B0]=a}catch(_){cr(e,e.return,_)}}break;case 6:if(Mi(t,e),la(e),n&4){if(e.stateNode===null)throw Error(Re(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(_){cr(e,e.return,_)}}break;case 3:if(Mi(t,e),la(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{b0(t.containerInfo)}catch(_){cr(e,e.return,_)}break;case 4:Mi(t,e),la(e);break;case 13:Mi(t,e),la(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(O2=mr())),n&4&&vy(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(gn=(f=gn)||d,Mi(t,e),gn=f):Mi(t,e),la(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for($e=e,d=e.child;d!==null;){for(p=$e=d;$e!==null;){switch(g=$e,v=g.child,g.tag){case 0:case 11:case 14:case 15:m0(4,g,g.return);break;case 1:Fl(g,g.return);var m=g.stateNode;if(typeof m.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(_){cr(n,r,_)}}break;case 5:Fl(g,g.return);break;case 22:if(g.memoizedState!==null){_y(p);continue}}v!==null?(v.return=g,$e=v):_y(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,u=p.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=q5("display",s))}catch(_){cr(e,e.return,_)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(_){cr(e,e.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Mi(t,e),la(e),n&4&&vy(e);break;case 21:break;default:Mi(t,e),la(e)}}function la(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(k6(r)){var n=r;break e}r=r.return}throw Error(Re(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(F0(i,""),n.flags&=-33);var a=xy(e);xm(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=xy(e);mm(e,o,s);break;default:throw Error(Re(161))}}catch(u){cr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function vE(e,t,r){$e=e,T6(e)}function T6(e,t,r){for(var n=(e.mode&1)!==0;$e!==null;){var i=$e,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Nf;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||gn;o=Nf;var f=gn;if(Nf=s,(gn=u)&&!f)for($e=i;$e!==null;)s=$e,u=s.child,s.tag===22&&s.memoizedState!==null?Sy(i):u!==null?(u.return=s,$e=u):Sy(i);for(;a!==null;)$e=a,T6(a),a=a.sibling;$e=i,Nf=o,gn=f}yy(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,$e=a):yy(e)}}function yy(e){for(;$e!==null;){var t=$e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gn||fh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!gn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:zi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&ny(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ny(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&b0(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}gn||t.flags&512&&gm(t)}catch(g){cr(t,t.return,g)}}if(t===e){$e=null;break}if(r=t.sibling,r!==null){r.return=t.return,$e=r;break}$e=t.return}}function _y(e){for(;$e!==null;){var t=$e;if(t===e){$e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,$e=r;break}$e=t.return}}function Sy(e){for(;$e!==null;){var t=$e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{fh(4,t)}catch(u){cr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){cr(t,i,u)}}var a=t.return;try{gm(t)}catch(u){cr(t,a,u)}break;case 5:var s=t.return;try{gm(t)}catch(u){cr(t,s,u)}}}catch(u){cr(t,t.return,u)}if(t===e){$e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,$e=o;break}$e=t.return}}var yE=Math.ceil,Fd=Ka.ReactCurrentDispatcher,I2=Ka.ReactCurrentOwner,Ci=Ka.ReactCurrentBatchConfig,Ft=0,Wr=null,Er=null,qr=0,Qn=0,Nl=Us(0),Rr=0,H0=null,To=0,dh=0,b2=0,x0=null,Vn=null,O2=0,Yl=1/0,Ra=null,Nd=!1,vm=null,Ps=null,Rf=!1,_s=null,Rd=0,v0=0,ym=null,ad=-1,sd=0;function Nn(){return Ft&6?mr():ad!==-1?ad:ad=mr()}function Fs(e){return e.mode&1?Ft&2&&qr!==0?qr&-qr:rE.transition!==null?(sd===0&&(sd=u_()),sd):(e=jt,e!==0||(e=window.event,e=e===void 0?16:x_(e.type)),e):1}function Ki(e,t,r,n){if(50<v0)throw v0=0,ym=null,Error(Re(185));lu(e,r,n),(!(Ft&2)||e!==Wr)&&(e===Wr&&(!(Ft&2)&&(dh|=r),Rr===4&&ms(e,qr)),Xn(e,n),r===1&&Ft===0&&!(t.mode&1)&&(Yl=mr()+500,lh&&zs()))}function Xn(e,t){var r=e.callbackNode;r9(e,t);var n=pd(e,e===Wr?qr:0);if(n===0)r!==null&&N4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&N4(r),t===1)e.tag===0?tE(wy.bind(null,e)):L_(wy.bind(null,e)),q9(function(){!(Ft&6)&&zs()}),r=null;else{switch(f_(n)){case 1:r=s2;break;case 4:r=l_;break;case 16:r=hd;break;case 536870912:r=c_;break;default:r=hd}r=O6(r,A6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function A6(e,t){if(ad=-1,sd=0,Ft&6)throw Error(Re(327));var r=e.callbackNode;if(Ml()&&e.callbackNode!==r)return null;var n=pd(e,e===Wr?qr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Id(e,n);else{t=n;var i=Ft;Ft|=2;var a=F6();(Wr!==e||qr!==t)&&(Ra=null,Yl=mr()+500,yo(e,t));do try{wE();break}catch(o){P6(e,o)}while(1);y2(),Fd.current=a,Ft=i,Er!==null?t=0:(Wr=null,qr=0,t=Rr)}if(t!==0){if(t===2&&(i=$g(e),i!==0&&(n=i,t=_m(e,i))),t===1)throw r=H0,yo(e,0),ms(e,n),Xn(e,mr()),r;if(t===6)ms(e,n);else{if(i=e.current.alternate,!(n&30)&&!_E(i)&&(t=Id(e,n),t===2&&(a=$g(e),a!==0&&(n=a,t=_m(e,a))),t===1))throw r=H0,yo(e,0),ms(e,n),Xn(e,mr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Re(345));case 2:co(e,Vn,Ra);break;case 3:if(ms(e,n),(n&130023424)===n&&(t=O2+500-mr(),10<t)){if(pd(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Nn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=em(co.bind(null,e,Vn,Ra),t);break}co(e,Vn,Ra);break;case 4:if(ms(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Xi(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=mr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yE(n/1960))-n,10<n){e.timeoutHandle=em(co.bind(null,e,Vn,Ra),n);break}co(e,Vn,Ra);break;case 5:co(e,Vn,Ra);break;default:throw Error(Re(329))}}}return Xn(e,mr()),e.callbackNode===r?A6.bind(null,e):null}function _m(e,t){var r=x0;return e.current.memoizedState.isDehydrated&&(yo(e,t).flags|=256),e=Id(e,t),e!==2&&(t=Vn,Vn=r,t!==null&&Sm(t)),e}function Sm(e){Vn===null?Vn=e:Vn.push.apply(Vn,e)}function _E(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ji(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ms(e,t){for(t&=~b2,t&=~dh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xi(t),n=1<<r;e[r]=-1,t&=~n}}function wy(e){if(Ft&6)throw Error(Re(327));Ml();var t=pd(e,0);if(!(t&1))return Xn(e,mr()),null;var r=Id(e,t);if(e.tag!==0&&r===2){var n=$g(e);n!==0&&(t=n,r=_m(e,n))}if(r===1)throw r=H0,yo(e,0),ms(e,t),Xn(e,mr()),r;if(r===6)throw Error(Re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,co(e,Vn,Ra),Xn(e,mr()),null}function D2(e,t){var r=Ft;Ft|=1;try{return e(t)}finally{Ft=r,Ft===0&&(Yl=mr()+500,lh&&zs())}}function Ao(e){_s!==null&&_s.tag===0&&!(Ft&6)&&Ml();var t=Ft;Ft|=1;var r=Ci.transition,n=jt;try{if(Ci.transition=null,jt=1,e)return e()}finally{jt=n,Ci.transition=r,Ft=t,!(Ft&6)&&zs()}}function L2(){Qn=Nl.current,Qt(Nl)}function yo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Q9(r)),Er!==null)for(r=Er.return;r!==null;){var n=r;switch(m2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&yd();break;case 3:Xl(),Qt(Wn),Qt(yn),C2();break;case 5:E2(n);break;case 4:Xl();break;case 13:Qt(ir);break;case 19:Qt(ir);break;case 10:_2(n.type._context);break;case 22:case 23:L2()}r=r.return}if(Wr=e,Er=e=Ns(e.current,null),qr=Qn=t,Rr=0,H0=null,b2=dh=To=0,Vn=x0=null,go!==null){for(t=0;t<go.length;t++)if(r=go[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}go=null}return e}function P6(e,t){do{var r=Er;try{if(y2(),rd.current=Pd,Ad){for(var n=ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ad=!1}if(Co=0,Hr=Nr=ar=null,g0=!1,z0=0,I2.current=null,r===null||r.return===null){Rr=1,H0=t,Er=null;break}e:{var a=e,s=r.return,o=r,u=t;if(t=qr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=o,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=cy(s);if(v!==null){v.flags&=-257,uy(v,s,o,a,t),v.mode&1&&ly(a,f,t),t=v,u=f;var m=t.updateQueue;if(m===null){var _=new Set;_.add(u),t.updateQueue=_}else m.add(u);break e}else{if(!(t&1)){ly(a,f,t),M2();break e}u=Error(Re(426))}}else if(er&&o.mode&1){var C=cy(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),uy(C,s,o,a,t),x2(Kl(u,o));break e}}a=u=Kl(u,o),Rr!==4&&(Rr=2),x0===null?x0=[a]:x0.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var S=f6(a,u,t);ry(a,S);break e;case 1:o=u;var w=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ps===null||!Ps.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var T=d6(a,o,t);ry(a,T);break e}}a=a.return}while(a!==null)}R6(r)}catch(A){t=A,Er===r&&r!==null&&(Er=r=r.return);continue}break}while(1)}function F6(){var e=Fd.current;return Fd.current=Pd,e===null?Pd:e}function M2(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Wr===null||!(To&268435455)&&!(dh&268435455)||ms(Wr,qr)}function Id(e,t){var r=Ft;Ft|=2;var n=F6();(Wr!==e||qr!==t)&&(Ra=null,yo(e,t));do try{SE();break}catch(i){P6(e,i)}while(1);if(y2(),Ft=r,Fd.current=n,Er!==null)throw Error(Re(261));return Wr=null,qr=0,Rr}function SE(){for(;Er!==null;)N6(Er)}function wE(){for(;Er!==null&&!Xk();)N6(Er)}function N6(e){var t=b6(e.alternate,e,Qn);e.memoizedProps=e.pendingProps,t===null?R6(e):Er=t,I2.current=null}function R6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=gE(r,t),r!==null){r.flags&=32767,Er=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rr=6,Er=null;return}}else if(r=pE(r,t,Qn),r!==null){Er=r;return}if(t=t.sibling,t!==null){Er=t;return}Er=t=e}while(t!==null);Rr===0&&(Rr=5)}function co(e,t,r){var n=jt,i=Ci.transition;try{Ci.transition=null,jt=1,kE(e,t,r,n)}finally{Ci.transition=i,jt=n}return null}function kE(e,t,r,n){do Ml();while(_s!==null);if(Ft&6)throw Error(Re(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Re(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(n9(e,a),e===Wr&&(Er=Wr=null,qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Rf||(Rf=!0,O6(hd,function(){return Ml(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ci.transition,Ci.transition=null;var s=jt;jt=1;var o=Ft;Ft|=4,I2.current=null,xE(e,r),C6(r,e),G9(Jg),gd=!!qg,Jg=qg=null,e.current=r,vE(r),Kk(),Ft=o,jt=s,Ci.transition=a}else e.current=r;if(Rf&&(Rf=!1,_s=e,Rd=i),a=e.pendingLanes,a===0&&(Ps=null),qk(r.stateNode),Xn(e,mr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Nd)throw Nd=!1,e=vm,vm=null,e;return Rd&1&&e.tag!==0&&Ml(),a=e.pendingLanes,a&1?e===ym?v0++:(v0=0,ym=e):v0=0,zs(),null}function Ml(){if(_s!==null){var e=f_(Rd),t=Ci.transition,r=jt;try{if(Ci.transition=null,jt=16>e?16:e,_s===null)var n=!1;else{if(e=_s,_s=null,Rd=0,Ft&6)throw Error(Re(331));var i=Ft;for(Ft|=4,$e=e.current;$e!==null;){var a=$e,s=a.child;if($e.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var f=o[u];for($e=f;$e!==null;){var d=$e;switch(d.tag){case 0:case 11:case 15:m0(8,d,a)}var p=d.child;if(p!==null)p.return=d,$e=p;else for(;$e!==null;){d=$e;var g=d.sibling,v=d.return;if(w6(d),d===f){$e=null;break}if(g!==null){g.return=v,$e=g;break}$e=v}}}var m=a.alternate;if(m!==null){var _=m.child;if(_!==null){m.child=null;do{var C=_.sibling;_.sibling=null,_=C}while(_!==null)}}$e=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,$e=s;else e:for(;$e!==null;){if(a=$e,a.flags&2048)switch(a.tag){case 0:case 11:case 15:m0(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,$e=S;break e}$e=a.return}}var w=e.current;for($e=w;$e!==null;){s=$e;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,$e=x;else e:for(s=w;$e!==null;){if(o=$e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:fh(9,o)}}catch(A){cr(o,o.return,A)}if(o===s){$e=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,$e=T;break e}$e=o.return}}if(Ft=i,zs(),ga&&typeof ga.onPostCommitFiberRoot=="function")try{ga.onPostCommitFiberRoot(nh,e)}catch{}n=!0}return n}finally{jt=r,Ci.transition=t}}return!1}function ky(e,t,r){t=Kl(r,t),t=f6(e,t,1),e=As(e,t,1),t=Nn(),e!==null&&(lu(e,1,t),Xn(e,t))}function cr(e,t,r){if(e.tag===3)ky(e,e,r);else for(;t!==null;){if(t.tag===3){ky(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ps===null||!Ps.has(n))){e=Kl(r,e),e=d6(t,e,1),t=As(t,e,1),e=Nn(),t!==null&&(lu(t,1,e),Xn(t,e));break}}t=t.return}}function EE(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nn(),e.pingedLanes|=e.suspendedLanes&r,Wr===e&&(qr&r)===r&&(Rr===4||Rr===3&&(qr&130023424)===qr&&500>mr()-O2?yo(e,0):b2|=r),Xn(e,t)}function I6(e,t){t===0&&(e.mode&1?(t=Sf,Sf<<=1,!(Sf&130023424)&&(Sf=4194304)):t=1);var r=Nn();e=Ha(e,t),e!==null&&(lu(e,t,r),Xn(e,r))}function CE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),I6(e,r)}function TE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Re(314))}n!==null&&n.delete(t),I6(e,r)}var b6;b6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wn.current)Hn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Hn=!1,hE(e,t,r);Hn=!!(e.flags&131072)}else Hn=!1,er&&t.flags&1048576&&M_(t,wd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;id(e,t),e=t.pendingProps;var i=Hl(t,yn.current);Ll(t,r),i=A2(null,t,n,e,i,r);var a=P2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$n(n)?(a=!0,_d(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,w2(t),i.updater=uh,t.stateNode=i,i._reactInternals=t,om(t,n,e,r),t=um(null,t,n,!0,a,r)):(t.tag=0,er&&a&&g2(t),Tn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(id(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=PE(n),e=zi(n,e),i){case 0:t=cm(null,t,n,e,r);break e;case 1:t=hy(null,t,n,e,r);break e;case 11:t=fy(null,t,n,e,r);break e;case 14:t=dy(null,t,n,zi(n.type,e),r);break e}throw Error(Re(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),cm(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),hy(e,t,n,i,r);case 3:e:{if(m6(t),e===null)throw Error(Re(387));n=t.pendingProps,a=t.memoizedState,i=a.element,G_(e,t),Cd(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Kl(Error(Re(423)),t),t=py(e,t,n,r,i);break e}else if(n!==i){i=Kl(Error(Re(424)),t),t=py(e,t,n,r,i);break e}else for(Zn=Ts(t.stateNode.containerInfo.firstChild),ei=t,er=!0,Gi=null,r=z_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Wl(),n===i){t=Wa(e,t,r);break e}Tn(e,t,n,r)}t=t.child}return t;case 5:return H_(t),e===null&&im(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,Zg(n,i)?s=null:a!==null&&Zg(n,a)&&(t.flags|=32),g6(e,t),Tn(e,t,s,r),t.child;case 6:return e===null&&im(t),null;case 13:return x6(e,t,r);case 4:return k2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=$l(t,null,n,r):Tn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),fy(e,t,n,i,r);case 7:return Tn(e,t,t.pendingProps,r),t.child;case 8:return Tn(e,t,t.pendingProps.children,r),t.child;case 12:return Tn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,$t(kd,n._currentValue),n._currentValue=s,a!==null)if(Ji(a.value,s)){if(a.children===i.children&&!Wn.current){t=Wa(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=Ba(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),am(a.return,r,t),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Re(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),am(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Tn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ll(t,r),i=Ti(i),n=n(i),t.flags|=1,Tn(e,t,n,r),t.child;case 14:return n=t.type,i=zi(n,t.pendingProps),i=zi(n.type,i),dy(e,t,n,i,r);case 15:return h6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),id(e,t),t.tag=1,$n(n)?(e=!0,_d(t)):e=!1,Ll(t,r),u6(t,n,i),om(t,n,i,r),um(null,t,n,!0,e,r);case 19:return v6(e,t,r);case 22:return p6(e,t,r)}throw Error(Re(156,t.tag))};function O6(e,t){return o_(e,t)}function AE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(e,t,r,n){return new AE(e,t,r,n)}function B2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function PE(e){if(typeof e=="function")return B2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===n2)return 11;if(e===i2)return 14}return 2}function Ns(e,t){var r=e.alternate;return r===null?(r=Ei(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function od(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")B2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case _l:return _o(r.children,i,a,t);case r2:s=8,i|=8;break;case Rg:return e=Ei(12,r,t,i|2),e.elementType=Rg,e.lanes=a,e;case Ig:return e=Ei(13,r,t,i),e.elementType=Ig,e.lanes=a,e;case bg:return e=Ei(19,r,t,i),e.elementType=bg,e.lanes=a,e;case H5:return hh(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case V5:s=10;break e;case G5:s=9;break e;case n2:s=11;break e;case i2:s=14;break e;case hs:s=16,n=null;break e}throw Error(Re(130,e==null?e:typeof e,""))}return t=Ei(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function _o(e,t,r,n){return e=Ei(7,e,n,t),e.lanes=r,e}function hh(e,t,r,n){return e=Ei(22,e,n,t),e.elementType=H5,e.lanes=r,e.stateNode={isHidden:!1},e}function Jp(e,t,r){return e=Ei(6,e,null,t),e.lanes=r,e}function Zp(e,t,r){return t=Ei(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function FE(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bp(0),this.expirationTimes=bp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function j2(e,t,r,n,i,a,s,o,u){return e=new FE(e,t,r,o,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ei(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},w2(a),e}function NE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function D6(e){if(!e)return bs;e=e._reactInternals;e:{if(bo(e)!==e||e.tag!==1)throw Error(Re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($n(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Re(171))}if(e.tag===1){var r=e.type;if($n(r))return D_(e,r,t)}return t}function L6(e,t,r,n,i,a,s,o,u){return e=j2(r,n,!0,e,i,a,s,o,u),e.context=D6(null),r=e.current,n=Nn(),i=Fs(r),a=Ba(n,i),a.callback=t??null,As(r,a,i),e.current.lanes=i,lu(e,i,n),Xn(e,n),e}function ph(e,t,r,n){var i=t.current,a=Nn(),s=Fs(i);return r=D6(r),t.context===null?t.context=r:t.pendingContext=r,t=Ba(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=As(i,t,s),e!==null&&(Ki(e,i,s,a),td(e,i,s)),s}function bd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ey(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function U2(e,t){Ey(e,t),(e=e.alternate)&&Ey(e,t)}function RE(){return null}var M6=typeof reportError=="function"?reportError:function(e){console.error(e)};function z2(e){this._internalRoot=e}gh.prototype.render=z2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Re(409));ph(e,t,null,null)};gh.prototype.unmount=z2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ao(function(){ph(null,e,null,null)}),t[Ga]=null}};function gh(e){this._internalRoot=e}gh.prototype.unstable_scheduleHydration=function(e){if(e){var t=p_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<gs.length&&t!==0&&t<gs[r].priority;r++);gs.splice(r,0,e),r===0&&m_(e)}};function V2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function mh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Cy(){}function IE(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=bd(s);a.call(f)}}var s=L6(t,n,e,0,null,!1,!1,"",Cy);return e._reactRootContainer=s,e[Ga]=s.current,L0(e.nodeType===8?e.parentNode:e),Ao(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var f=bd(u);o.call(f)}}var u=j2(e,0,!1,null,null,!1,!1,"",Cy);return e._reactRootContainer=u,e[Ga]=u.current,L0(e.nodeType===8?e.parentNode:e),Ao(function(){ph(t,u,r,n)}),u}function xh(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=bd(s);o.call(u)}}ph(t,s,e,i)}else s=IE(r,t,e,i,n);return bd(s)}d_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=r0(t.pendingLanes);r!==0&&(o2(t,r|1),Xn(t,mr()),!(Ft&6)&&(Yl=mr()+500,zs()))}break;case 13:Ao(function(){var n=Ha(e,1);if(n!==null){var i=Nn();Ki(n,e,1,i)}}),U2(e,1)}};l2=function(e){if(e.tag===13){var t=Ha(e,134217728);if(t!==null){var r=Nn();Ki(t,e,134217728,r)}U2(e,134217728)}};h_=function(e){if(e.tag===13){var t=Fs(e),r=Ha(e,t);if(r!==null){var n=Nn();Ki(r,e,t,n)}U2(e,t)}};p_=function(){return jt};g_=function(e,t){var r=jt;try{return jt=e,t()}finally{jt=r}};Gg=function(e,t,r){switch(t){case"input":if(Lg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=oh(n);if(!i)throw Error(Re(90));$5(n),Lg(n,i)}}}break;case"textarea":K5(e,r);break;case"select":t=r.value,t!=null&&Il(e,!!r.multiple,t,!1)}};t_=D2;r_=Ao;var bE={usingClientEntryPoint:!1,Events:[uu,El,oh,Z5,e_,D2]},Hc={findFiberByHostInstance:po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OE={bundleType:Hc.bundleType,version:Hc.version,rendererPackageName:Hc.rendererPackageName,rendererConfig:Hc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ka.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=a_(e),e===null?null:e.stateNode},findFiberByHostInstance:Hc.findFiberByHostInstance||RE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var If=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!If.isDisabled&&If.supportsFiber)try{nh=If.inject(OE),ga=If}catch{}}ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bE;ii.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V2(t))throw Error(Re(200));return NE(e,t,null,r)};ii.createRoot=function(e,t){if(!V2(e))throw Error(Re(299));var r=!1,n="",i=M6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=j2(e,1,!1,null,null,r,!1,n,i),e[Ga]=t.current,L0(e.nodeType===8?e.parentNode:e),new z2(t)};ii.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Re(188)):(e=Object.keys(e).join(","),Error(Re(268,e)));return e=a_(t),e=e===null?null:e.stateNode,e};ii.flushSync=function(e){return Ao(e)};ii.hydrate=function(e,t,r){if(!mh(t))throw Error(Re(200));return xh(null,e,t,!0,r)};ii.hydrateRoot=function(e,t,r){if(!V2(e))throw Error(Re(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=M6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=L6(t,null,e,1,r??null,i,!1,a,s),e[Ga]=t.current,L0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new gh(t)};ii.render=function(e,t,r){if(!mh(t))throw Error(Re(200));return xh(null,e,t,!1,r)};ii.unmountComponentAtNode=function(e){if(!mh(e))throw Error(Re(40));return e._reactRootContainer?(Ao(function(){xh(null,null,e,!1,function(){e._reactRootContainer=null,e[Ga]=null})}),!0):!1};ii.unstable_batchedUpdates=D2;ii.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!mh(r))throw Error(Re(200));if(e==null||e._reactInternals===void 0)throw Error(Re(38));return xh(e,t,r,!1,n)};ii.version="18.3.1-next-f1338f8080-20240426";function B6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B6)}catch(e){console.error(e)}}B6(),B5.exports=ii;var DE=B5.exports,Ty=DE;Fg.createRoot=Ty.createRoot,Fg.hydrateRoot=Ty.hydrateRoot;const Ay=e=>{let t;const r=new Set,n=(d,p)=>{const g=typeof d=="function"?d(t):d;if(!Object.is(g,t)){const v=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(m=>m(t,v))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>f,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},f=t=e(n,i,u);return u},LE=e=>e?Ay(e):Ay;var j6={exports:{}},U6={},z6={exports:{}},V6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ql=ke;function ME(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var BE=typeof Object.is=="function"?Object.is:ME,jE=Ql.useState,UE=Ql.useEffect,zE=Ql.useLayoutEffect,VE=Ql.useDebugValue;function GE(e,t){var r=t(),n=jE({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return zE(function(){i.value=r,i.getSnapshot=t,eg(i)&&a({inst:i})},[e,r,t]),UE(function(){return eg(i)&&a({inst:i}),e(function(){eg(i)&&a({inst:i})})},[e]),VE(r),r}function eg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!BE(e,r)}catch{return!0}}function HE(e,t){return t()}var WE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?HE:GE;V6.useSyncExternalStore=Ql.useSyncExternalStore!==void 0?Ql.useSyncExternalStore:WE;z6.exports=V6;var $E=z6.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh=ke,XE=$E;function KE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var YE=typeof Object.is=="function"?Object.is:KE,QE=XE.useSyncExternalStore,qE=vh.useRef,JE=vh.useEffect,ZE=vh.useMemo,eC=vh.useDebugValue;U6.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=qE(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=ZE(function(){function u(v){if(!f){if(f=!0,d=v,v=n(v),i!==void 0&&s.hasValue){var m=s.value;if(i(m,v))return p=m}return p=v}if(m=p,YE(d,v))return m;var _=n(v);return i!==void 0&&i(m,_)?(d=v,m):(d=v,p=_)}var f=!1,d,p,g=r===void 0?null:r;return[function(){return u(t())},g===null?void 0:function(){return u(g())}]},[t,r,n,i]);var o=QE(e,a[0],a[1]);return JE(function(){s.hasValue=!0,s.value=o},[o]),eC(o),o};j6.exports=U6;var tC=j6.exports;const rC=th(tC),{useDebugValue:nC}=kr,{useSyncExternalStoreWithSelector:iC}=rC;const aC=e=>e;function sC(e,t=aC,r){const n=iC(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return nC(n),n}const Py=e=>{const t=typeof e=="function"?LE(e):e,r=(n,i)=>sC(t,n,i);return Object.assign(r,t),r},oC=e=>e?Py(e):Py;var G6=Symbol.for("immer-nothing"),Fy=Symbol.for("immer-draftable"),Lt=Symbol.for("immer-state");function ki(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ql=Object.getPrototypeOf;function Jl(e){return!!e&&!!e[Lt]}function $a(e){var t;return e?H6(e)||Array.isArray(e)||!!e[Fy]||!!((t=e.constructor)!=null&&t[Fy])||_h(e)||Sh(e):!1}var lC=Object.prototype.constructor.toString();function H6(e){if(!e||typeof e!="object")return!1;const t=ql(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===lC}function W0(e,t){yh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function yh(e){const t=e[Lt];return t?t.type_:Array.isArray(e)?1:_h(e)?2:Sh(e)?3:0}function wm(e,t){return yh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function W6(e,t,r){const n=yh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function cC(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function _h(e){return e instanceof Map}function Sh(e){return e instanceof Set}function Vr(e){return e.copy_||e.base_}function km(e,t){if(_h(e))return new Map(e);if(Sh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=H6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Lt];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(ql(e),n)}else{const n=ql(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function G2(e,t=!1){return wh(e)||Jl(e)||!$a(e)||(yh(e)>1&&(e.set=e.add=e.clear=e.delete=uC),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>G2(n,!0))),e}function uC(){ki(2)}function wh(e){return Object.isFrozen(e)}var Em={};function Po(e){const t=Em[e];return t||ki(0,e),t}function fC(e,t){Em[e]||(Em[e]=t)}var $0;function Od(){return $0}function dC(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ny(e,t){t&&(Po("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Cm(e){Tm(e),e.drafts_.forEach(hC),e.drafts_=null}function Tm(e){e===$0&&($0=e.parent_)}function Ry(e){return $0=dC($0,e)}function hC(e){const t=e[Lt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Iy(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Lt].modified_&&(Cm(t),ki(4)),$a(e)&&(e=Dd(t,e),t.parent_||Ld(t,e)),t.patches_&&Po("Patches").generateReplacementPatches_(r[Lt].base_,e,t.patches_,t.inversePatches_)):e=Dd(t,r,[]),Cm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==G6?e:void 0}function Dd(e,t,r){if(wh(t))return t;const n=t[Lt];if(!n)return W0(t,(i,a)=>by(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ld(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),W0(a,(o,u)=>by(e,n,i,o,u,r,s)),Ld(e,i,!1),r&&e.patches_&&Po("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function by(e,t,r,n,i,a,s){if(Jl(i)){const o=a&&t&&t.type_!==3&&!wm(t.assigned_,n)?a.concat(n):void 0,u=Dd(e,i,o);if(W6(r,n,u),Jl(u))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if($a(i)&&!wh(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Dd(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ld(e,i)}}function Ld(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&G2(t,r)}function pC(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Od(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=H2;r&&(i=[n],a=X0);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var H2={get(e,t){if(t===Lt)return e;const r=Vr(e);if(!wm(r,t))return gC(e,r,t);const n=r[t];return e.finalized_||!$a(n)?n:n===tg(e.base_,t)?(rg(e),e.copy_[t]=K0(n,e)):n},has(e,t){return t in Vr(e)},ownKeys(e){return Reflect.ownKeys(Vr(e))},set(e,t,r){const n=$6(Vr(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=tg(Vr(e),t),a=i==null?void 0:i[Lt];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(cC(r,i)&&(r!==void 0||wm(e.base_,t)))return!0;rg(e),Oa(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return tg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,rg(e),Oa(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Vr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ki(11)},getPrototypeOf(e){return ql(e.base_)},setPrototypeOf(){ki(12)}},X0={};W0(H2,(e,t)=>{X0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});X0.deleteProperty=function(e,t){return X0.set.call(this,e,t,void 0)};X0.set=function(e,t,r){return H2.set.call(this,e[0],t,r,e[0])};function tg(e,t){const r=e[Lt];return(r?Vr(r):e)[t]}function gC(e,t,r){var i;const n=$6(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function $6(e,t){if(!(t in e))return;let r=ql(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=ql(r)}}function Oa(e){e.modified_||(e.modified_=!0,e.parent_&&Oa(e.parent_))}function rg(e){e.copy_||(e.copy_=km(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var mC=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(u=a,...f){return s.produce(u,d=>r.call(this,d,...f))}}typeof r!="function"&&ki(6),n!==void 0&&typeof n!="function"&&ki(7);let i;if($a(t)){const a=Ry(this),s=K0(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Cm(a):Tm(a)}return Ny(a,n),Iy(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===G6&&(i=void 0),this.autoFreeze_&&G2(i,!0),n){const a=[],s=[];Po("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else ki(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,u=>t(u,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){$a(e)||ki(8),Jl(e)&&(e=xC(e));const t=Ry(this),r=K0(e,void 0);return r[Lt].isManual_=!0,Tm(t),r}finishDraft(e,t){const r=e&&e[Lt];(!r||!r.isManual_)&&ki(9);const{scope_:n}=r;return Ny(n,t),Iy(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Po("Patches").applyPatches_;return Jl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function K0(e,t){const r=_h(e)?Po("MapSet").proxyMap_(e,t):Sh(e)?Po("MapSet").proxySet_(e,t):pC(e,t);return(t?t.scope_:Od()).drafts_.push(r),r}function xC(e){return Jl(e)||ki(10,e),X6(e)}function X6(e){if(!$a(e)||wh(e))return e;const t=e[Lt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=km(e,t.scope_.immer_.useStrictShallowCopy_)}else r=km(e,!0);return W0(r,(n,i)=>{W6(r,n,X6(i))}),t&&(t.finalized_=!1),r}function vC(){class e extends Map{constructor(u,f){super(),this[Lt]={type_:2,parent_:f,scope_:f?f.scope_:Od(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:u,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Vr(this[Lt]).size}has(u){return Vr(this[Lt]).has(u)}set(u,f){const d=this[Lt];return s(d),(!Vr(d).has(u)||Vr(d).get(u)!==f)&&(r(d),Oa(d),d.assigned_.set(u,!0),d.copy_.set(u,f),d.assigned_.set(u,!0)),this}delete(u){if(!this.has(u))return!1;const f=this[Lt];return s(f),r(f),Oa(f),f.base_.has(u)?f.assigned_.set(u,!1):f.assigned_.delete(u),f.copy_.delete(u),!0}clear(){const u=this[Lt];s(u),Vr(u).size&&(r(u),Oa(u),u.assigned_=new Map,W0(u.base_,f=>{u.assigned_.set(f,!1)}),u.copy_.clear())}forEach(u,f){const d=this[Lt];Vr(d).forEach((p,g,v)=>{u.call(f,this.get(g),g,this)})}get(u){const f=this[Lt];s(f);const d=Vr(f).get(u);if(f.finalized_||!$a(d)||d!==f.base_.get(u))return d;const p=K0(d,f);return r(f),f.copy_.set(u,p),p}keys(){return Vr(this[Lt]).keys()}values(){const u=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const f=u.next();return f.done?f:{done:!1,value:this.get(f.value)}}}}entries(){const u=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const f=u.next();if(f.done)return f;const d=this.get(f.value);return{done:!1,value:[f.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,u){return new e(o,u)}function r(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class n extends Set{constructor(u,f){super(),this[Lt]={type_:3,parent_:f,scope_:f?f.scope_:Od(),modified_:!1,finalized_:!1,copy_:void 0,base_:u,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Vr(this[Lt]).size}has(u){const f=this[Lt];return s(f),f.copy_?!!(f.copy_.has(u)||f.drafts_.has(u)&&f.copy_.has(f.drafts_.get(u))):f.base_.has(u)}add(u){const f=this[Lt];return s(f),this.has(u)||(a(f),Oa(f),f.copy_.add(u)),this}delete(u){if(!this.has(u))return!1;const f=this[Lt];return s(f),a(f),Oa(f),f.copy_.delete(u)||(f.drafts_.has(u)?f.copy_.delete(f.drafts_.get(u)):!1)}clear(){const u=this[Lt];s(u),Vr(u).size&&(a(u),Oa(u),u.copy_.clear())}values(){const u=this[Lt];return s(u),a(u),u.copy_.values()}entries(){const u=this[Lt];return s(u),a(u),u.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(u,f){const d=this.values();let p=d.next();for(;!p.done;)u.call(f,p.value,p.value,this),p=d.next()}}function i(o,u){return new n(o,u)}function a(o){o.copy_||(o.copy_=new Set,o.base_.forEach(u=>{if($a(u)){const f=K0(u,o);o.drafts_.set(u,f),o.copy_.add(f)}else o.copy_.add(u)}))}function s(o){o.revoked_&&ki(3,JSON.stringify(Vr(o)))}fC("MapSet",{proxyMap_:t,proxySet_:i})}var ri=new mC,yC=ri.produce;ri.produceWithPatches.bind(ri);ri.setAutoFreeze.bind(ri);ri.setUseStrictShallowCopy.bind(ri);ri.applyPatches.bind(ri);ri.createDraft.bind(ri);ri.finishDraft.bind(ri);const _C=e=>(t,r,n)=>(n.setState=(i,a,...s)=>{const o=typeof i=="function"?yC(i):i;return t(o,a,...s)},e(n.setState,r,n)),SC=_C;class Ar{static initialize(t=50){this.state.maxHistorySize=t}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static notifyListeners(){this.listeners.forEach(t=>t())}static recordAction(t,r,n){const i={id:crypto.randomUUID(),type:t,timestamp:new Date,data:JSON.parse(JSON.stringify(r)),description:n};return this.state.history=this.state.history.slice(0,this.state.currentIndex+1),this.state.history.push(i),this.state.currentIndex++,this.state.history.length>this.state.maxHistorySize&&(this.state.history.shift(),this.state.currentIndex--),this.notifyListeners(),i.id}static canUndo(){return this.state.currentIndex>=0}static canRedo(){return this.state.currentIndex<this.state.history.length-1}static undo(){if(!this.canUndo())return null;const t=this.state.history[this.state.currentIndex];return this.state.currentIndex--,this.notifyListeners(),t}static redo(){if(!this.canRedo())return null;this.state.currentIndex++;const t=this.state.history[this.state.currentIndex];return this.notifyListeners(),t}static getHistory(){return[...this.state.history]}static getCurrentIndex(){return this.state.currentIndex}static clear(){this.state.history=[],this.state.currentIndex=-1,this.notifyListeners()}static createPinAssignmentAction(t,r,n){return{type:"PIN_ASSIGNMENT",data:{pinId:t,oldSignal:r,newSignal:n}}}static createBulkAssignmentAction(t){return{type:"BULK_ASSIGNMENT",data:{assignments:t}}}static createSelectionAction(t,r){return{type:"SELECTION_CHANGE",data:{oldSelection:Array.from(t),newSelection:Array.from(r)}}}static createViewChangeAction(t,r){return{type:"VIEW_CHANGE",data:{oldView:t,newView:r}}}static getActionDescription(t){switch(t.type){case"PIN_ASSIGNMENT":{const{pinId:r,newSignal:n}=t.data;return n?`Assigned "${n}" to pin ${r}`:`Cleared assignment from pin ${r}`}case"BULK_ASSIGNMENT":return`Bulk assignment to ${t.data.assignments.length} pins`;case"SELECTION_CHANGE":return`Selected ${t.data.newSelection.length} pin(s)`;case"VIEW_CHANGE":return"Changed view settings";default:return t.description||`Unknown action: ${t.type}`}}}Ar.state={history:[],currentIndex:-1,maxHistorySize:50};Ar.listeners=new Set;function Os(e){if(e.length===1)return e.charCodeAt(0)-65;if(e.length===2){const t=e.charCodeAt(0)-65,r=e.charCodeAt(1)-65;return 26+t*26+r}return 0}function fl(e){if(e<0)return console.warn(`⚠️ Invalid index ${e}, defaulting to 'A'`),"A";if(e<26)return String.fromCharCode(65+e);{const t=e-26,r=Math.floor(t/26),n=t%26;return String.fromCharCode(65+r)+String.fromCharCode(65+n)}}function K6(e,t){const r=Os(e),n=Os(t);return r-n}const uo=typeof window<"u"&&window.location.hostname==="localhost";var pa=(e=>(e.SELECTION="🎯",e.CHECKBOX="☑️",e.RANGE="📋",e.BULK_EDIT="🔧",e.PIN_RENDER="📌",e.STORE="🏪",e.EXPORT="📤",e.IMPORT="📥",e.PERFORMANCE="⚡",e.ERROR="❌",e.WARNING="⚠️",e.SUCCESS="✅",e))(pa||{});const Bl={log:(e,t,r)=>{uo&&(r!==void 0?console.log(`${e} ${t}`,r):console.log(`${e} ${t}`))},warn:(e,t,r)=>{uo&&(r!==void 0?console.warn(`${e} ${t}`,r):console.warn(`${e} ${t}`))},error:(e,t,r)=>{uo&&(r!==void 0?console.error(`${e} ${t}`,r):console.error(`${e} ${t}`))},group:(e,t,r)=>{uo&&(console.group(`${e} ${t}`),r(),console.groupEnd())},time:e=>{uo&&console.time(e)},timeEnd:e=>{uo&&console.timeEnd(e)}},wC={SELECTION:!0,CHECKBOX:!0,RANGE:!0,BULK_EDIT:!0,PIN_RENDER:!1,STORE:!0,EXPORT:!0,IMPORT:!0,PERFORMANCE:!0},bf=(e,t,r,n)=>{!uo||!wC[e]||Bl.log(t,r,n)};vC();const ng={rotation:0,isTopView:!0,zoom:1,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},Of={pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"grid",sortOrder:"asc"},kC={activeTab:"overview",viewMode:"grid",searchQuery:"",selectedRows:new Set,sortColumn:void 0,sortDirection:"asc",commentFilter:"all"},Yi=oC()(SC((e,t)=>({currentProject:null,package:null,pins:[],filteredPins:[],selectedPins:new Set,visibleBanks:new Set,viewConfig:ng,listView:kC,pinColorMode:"bank",filters:Of,isLoading:!1,error:null,recentFiles:[],canUndo:!1,canRedo:!1,currentActionDescription:null,nextRedoActionDescription:null,loadProject:r=>{e(n=>{n.currentProject=r,n.package=r.packageData,n.pins=r.pinAssignments,n.viewConfig=r.viewConfig,n.filters=r.filters}),t().applyFilters()},createNewProject:(r,n)=>e(i=>{const a={id:crypto.randomUUID(),name:r,description:"",created:new Date,modified:new Date,projectInfo:{device:n.device,package:n.packageType,speedGrade:"-1",temperature:"C"},packageData:n,pinAssignments:n.pins,viewConfig:ng,filters:Of};i.currentProject=a,i.package=n,i.pins=n.pins,i.filteredPins=n.pins,i.viewConfig=ng,i.filters=Of;const s=new Set;n.pins.forEach(o=>{const u=o.bank||"NA";s.add(u)}),i.visibleBanks=s,Bl.log(pa.STORE,"newProject - initialized visibleBanks:",Array.from(s)),t().applyFilters()}),saveProject:()=>e(r=>{r.currentProject&&(r.currentProject.modified=new Date,r.currentProject.pinAssignments=r.pins,r.currentProject.viewConfig=r.viewConfig,r.currentProject.filters=r.filters)}),loadPackage:r=>e(n=>{var a;Bl.log(pa.STORE,"loadPackage started",r),n.package=r,n.pins=r.pins,n.filteredPins=r.pins,n.selectedPins.clear();const i=new Set;r.pins.forEach(s=>{const o=s.bank||"NA";i.add(o)}),n.visibleBanks=i,Bl.log(pa.STORE,"initialized visibleBanks:",Array.from(i)),console.log("🏪 ストア更新完了:",{packageName:(a=n.package)==null?void 0:a.name,pinsCount:n.pins.length,filteredPinsCount:n.filteredPins.length})}),updatePin:(r,n)=>{e(i=>{const a=i.pins.find(s=>s.id===r);a&&(Object.assign(a,n),n.signalName!==void 0&&(a.isAssigned=n.signalName!==""))}),t().applyFilters()},updatePins:r=>e(n=>{r.forEach((i,a)=>{const s=n.pins.find(o=>o.id===a);s&&(Object.assign(s,i),i.signalName!==void 0&&(s.isAssigned=i.signalName!==""))})}),assignSignal:(r,n)=>{const a=t().pins.find(u=>u.id===r);if(!a)return;const s=a.signalName,o=Ar.createPinAssignmentAction(r,s,n);Ar.recordAction(o.type,o.data,n?`信号 "${n}" をピン ${r} に割り当て`:`ピン ${r} の信号割り当てを解除`),e(u=>{const f=u.pins.find(d=>d.id===r);f&&(f.signalName=n,f.isAssigned=n!=="")}),t().applyFilters(),t().updateUndoRedoState()},clearSignal:r=>{const i=t().pins.find(o=>o.id===r);if(!i||!i.signalName)return;const a=i.signalName,s=Ar.createPinAssignmentAction(r,a,"");Ar.recordAction(s.type,s.data,`ピン ${r} の信号割り当てを解除`),e(o=>{const u=o.pins.find(f=>f.id===r);u&&(u.signalName="",u.isAssigned=!1)}),t().applyFilters(),t().updateUndoRedoState()},selectPin:r=>e(n=>{n.selectedPins.clear(),n.selectedPins.add(r)}),selectPins:r=>e(n=>{n.selectedPins.clear(),r.forEach(i=>n.selectedPins.add(i))}),clearSelection:()=>e(r=>{r.selectedPins.clear()}),togglePinSelection:r=>e(n=>{n.selectedPins.has(r)?n.selectedPins.delete(r):n.selectedPins.add(r)}),selectPinRange:(r,n,i)=>e(a=>{const s=i.findIndex(u=>u.id===r),o=i.findIndex(u=>u.id===n);if(s!==-1&&o!==-1){const u=Math.min(s,o),f=Math.max(s,o);for(let d=u;d<=f;d++)a.selectedPins.add(i[d].id)}}),setRotation:r=>e(n=>{n.viewConfig.rotation=r%360}),toggleView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setZoom:r=>e(n=>{n.viewConfig.zoom=Math.max(.1,Math.min(5,r))}),resetZoom:()=>e(r=>{r.viewConfig.zoom=1}),updateViewConfig:r=>e(n=>{Object.assign(n.viewConfig,r)}),updateFilters:r=>e(n=>{Object.assign(n.filters,r);let i=[...n.pins];if(n.filters.pinTypes.length>0&&(i=i.filter(a=>n.filters.pinTypes.includes(a.pinType))),n.filters.banks.length>0&&(i=i.filter(a=>a.bank&&n.filters.banks.includes(a.bank))),n.filters.searchText){const a=n.filters.searchText.toLowerCase();i=i.filter(s=>s.pinNumber.toLowerCase().includes(a)||s.pinName.toLowerCase().includes(a)||s.signalName.toLowerCase().includes(a))}n.filters.voltageFilter.length>0&&(i=i.filter(a=>n.filters.voltageFilter.includes(a.voltage))),n.filters.assignmentStatus!=="all"&&(i=i.filter(a=>n.filters.assignmentStatus==="assigned"?a.isAssigned:!a.isAssigned)),n.filters.showOnlyDifferentialPairs&&(i=i.filter(a=>a.differentialPair)),i.sort((a,s)=>{var d,p;let o,u;switch(n.filters.sortField){case"pinNumber":o=a.pinNumber,u=s.pinNumber;break;case"pinName":o=a.pinName,u=s.pinName;break;case"signalName":o=a.signalName,u=s.signalName;break;case"pinType":o=a.pinType,u=s.pinType;break;case"bank":o=a.bank||"",u=s.bank||"";break;case"grid":if(a.gridPosition&&s.gridPosition){const g=K6(a.gridPosition.row,s.gridPosition.row);if(g!==0)return n.filters.sortOrder==="asc"?g:-g;const v=a.gridPosition.col-s.gridPosition.col;return n.filters.sortOrder==="asc"?v:-v}o=((d=a.gridPosition)==null?void 0:d.row)||"",u=((p=s.gridPosition)==null?void 0:p.row)||"";break;default:o=a.pinNumber,u=s.pinNumber}const f=o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"});return n.filters.sortOrder==="asc"?f:-f}),n.filteredPins=i}),clearFilters:()=>e(r=>{r.filters={...Of},r.filteredPins=r.pins}),applyFilters:()=>e(r=>{let n=[...r.pins];if(console.log("🏪 applyFilters: visibleBanks =",Array.from(r.visibleBanks)),console.log("🏪 applyFilters: pins before bank filter =",n.length),r.visibleBanks.size>0){const i=n.length;n=n.filter(a=>{const s=a.bank||"UNASSIGNED";return r.visibleBanks.has(s)}),console.log(`🏪 applyFilters: filtered from ${i} to ${n.length} pins`)}else console.log("🏪 applyFilters: visibleBanks is empty, showing all pins");if(r.filters.pinTypes.length>0&&(n=n.filter(i=>r.filters.pinTypes.includes(i.pinType))),r.filters.banks.length>0&&(n=n.filter(i=>i.bank&&r.filters.banks.includes(i.bank))),r.filters.searchText){const i=r.filters.searchText.toLowerCase();n=n.filter(a=>a.pinNumber.toLowerCase().includes(i)||a.pinName.toLowerCase().includes(i)||a.signalName.toLowerCase().includes(i))}r.filters.voltageFilter.length>0&&(n=n.filter(i=>r.filters.voltageFilter.includes(i.voltage))),r.filters.assignmentStatus!=="all"&&(n=n.filter(i=>r.filters.assignmentStatus==="assigned"?i.isAssigned:!i.isAssigned)),r.filters.showOnlyDifferentialPairs&&(n=n.filter(i=>i.differentialPair)),n.sort((i,a)=>{let s,o;switch(r.filters.sortField){case"pinNumber":s=i.pinNumber,o=a.pinNumber;break;case"pinName":s=i.pinName,o=a.pinName;break;case"signalName":s=i.signalName||"",o=a.signalName||"";break;case"pinType":s=i.pinType,o=a.pinType;break;case"bank":s=i.bank||"",o=a.bank||"";break;default:s=i.pinNumber,o=a.pinNumber}const u=s.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"});return r.filters.sortOrder==="asc"?u:-u}),r.filteredPins=n}),setSortField:r=>e(n=>{n.filters.sortField=r,t().applyFilters()}),setSortOrder:r=>e(n=>{n.filters.sortOrder=r,t().applyFilters()}),toggleBankVisibility:r=>{e(n=>{console.log(`🏪 toggleBankVisibility called for Bank ${r}`),console.log("🏪 Before: visibleBanks =",Array.from(n.visibleBanks)),n.visibleBanks.has(r)?(n.visibleBanks.delete(r),console.log(`🏪 Removed Bank ${r} from visibleBanks`)):(n.visibleBanks.add(r),console.log(`🏪 Added Bank ${r} to visibleBanks`)),console.log("🏪 After: visibleBanks =",Array.from(n.visibleBanks))}),console.log("🏪 Calling applyFilters after state update..."),t().applyFilters()},setBankVisibility:(r,n)=>{e(i=>{n?i.visibleBanks.add(r):i.visibleBanks.delete(r)}),t().applyFilters()},showAllBanks:()=>{e(r=>{console.log("🏪 showAllBanks: clearing visibleBanks"),r.visibleBanks.clear()}),t().applyFilters()},assignDifferentialPair:(r,n,i)=>e(a=>{const s=a.pins.find(u=>u.id===r),o=a.pins.find(u=>u.id===n);s&&o&&(s.signalName=`${i}_P`,s.isAssigned=!0,s.differentialPair={pair:n,type:"positive"},o.signalName=`${i}_N`,o.isAssigned=!0,o.differentialPair={pair:r,type:"negative"})}),clearDifferentialPair:r=>e(n=>{const i=n.pins.find(a=>a.id===r);if(i&&i.differentialPair){const a=n.pins.find(s=>s.id===i.differentialPair.pair);i.differentialPair=void 0,i.signalName="",i.isAssigned=!1,a&&(a.differentialPair=void 0,a.signalName="",a.isAssigned=!1)}}),rotatePins:r=>e(n=>{n.viewConfig.rotation=(n.viewConfig.rotation+r)%360}),flipView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setLoading:r=>e(n=>{n.isLoading=r}),setError:r=>e(n=>{n.error=r}),setViewMode:r=>e(n=>{n.listView.viewMode=r}),setActiveTab:r=>e(n=>{n.listView.activeTab=r}),setSearchQuery:r=>e(n=>{n.listView.searchQuery=r}),setCommentFilter:r=>e(n=>{n.listView.commentFilter=r}),updateListViewState:r=>e(n=>{Object.assign(n.listView,r)}),bulkUpdateComments:(r,n)=>{e(i=>{const a=new Date;r.forEach(s=>{const o=i.pins.find(u=>u.id===s);o&&(o.comment=n,o.commentTimestamp=a,o.commentAuthor="current_user")}),i.listView.selectedRows.clear()}),t().applyFilters()},setPinColorMode:r=>e(n=>{n.pinColorMode=r}),addRecentFile:r=>e(n=>{const i=n.recentFiles.filter(a=>a!==r);n.recentFiles=[r,...i].slice(0,10)}),undo:()=>{const r=Ar.undo();r&&(t().handleUndoRedoAction(r,"undo"),t().updateUndoRedoState())},redo:()=>{const r=Ar.redo();r&&(t().handleUndoRedoAction(r,"redo"),t().updateUndoRedoState())},updateUndoRedoState:()=>e(r=>{r.canUndo=Ar.canUndo(),r.canRedo=Ar.canRedo();const n=Ar.getHistory(),i=Ar.getCurrentIndex();i>=0&&i<n.length?r.currentActionDescription=Ar.getActionDescription(n[i]):r.currentActionDescription=null,i+1<n.length?r.nextRedoActionDescription=Ar.getActionDescription(n[i+1]):r.nextRedoActionDescription=null}),clearHistory:()=>{Ar.clear(),t().updateUndoRedoState()},handleUndoRedoAction:(r,n)=>{const{type:i,data:a}=r;switch(i){case"PIN_ASSIGNMENT":{const{pinId:s,oldSignal:o,newSignal:u}=a,f=n==="undo"?o:u;e(d=>{const p=d.pins.find(g=>g.id===s);p&&(p.signalName=f||"",p.isAssigned=!!f)}),t().applyFilters();break}case"BULK_ASSIGNMENT":{const{assignments:s}=a;e(o=>{s.forEach(({pinId:u,oldSignal:f,newSignal:d})=>{const p=o.pins.find(g=>g.id===u);if(p){const g=n==="undo"?f:d;p.signalName=g||"",p.isAssigned=!!g}})}),t().applyFilters();break}case"SELECTION_CHANGE":{const{oldSelection:s,newSelection:o}=a,u=n==="undo"?s:o;e(f=>{f.selectedPins=new Set(u)});break}case"VIEW_CHANGE":{const{oldView:s,newView:o}=a,u=n==="undo"?s:o;e(f=>{Object.assign(f.viewConfig,u)});break}default:console.warn(`Unhandled undo/redo action type: ${i}`);break}}})));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Y6=1252,EC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],W2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$2=function(e){EC.indexOf(e)!=-1&&(Y6=W2[0]=e)};function CC(){$2(1252)}var Wi=function(e){$2(e)};function Q6(){Wi(1200),CC()}function Oy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function TC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function q6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var i0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?TC(e.slice(2)):t==254&&r==255?q6(e.slice(2)):t==65279?e.slice(1):e},Df=function(t){return String.fromCharCode(t)},Dy=function(t){return String.fromCharCode(t)},xs,Ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ly(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,i=e.charCodeAt(f++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),t+=Ss.charAt(a)+Ss.charAt(s)+Ss.charAt(o)+Ss.charAt(u);return t}function ni(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=Ss.indexOf(e.charAt(f++)),s=Ss.indexOf(e.charAt(f++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=Ss.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=Ss.indexOf(e.charAt(f++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Oo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ds(e){return kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function My(e){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hi=function(t){return kt?Oo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function X2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return X2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var vs=kt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Oo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function AC(e){for(var t=[],r=0,n=e.length+250,i=Ds(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ds(65535),n=65530)}return t.push(i.slice(0,r)),vs(t)}var Rn=/\u0000/g,a0=/[\u0001-\u0006]/g;function jl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $i(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function K2(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Md(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function PC(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function FC(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var By=Math.pow(2,32);function dl(e,t){if(e>By||e<-By)return PC(e,t);var r=Math.round(e);return FC(r,t)}function Bd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var jy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ig=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function NC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Uy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},RC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jd(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),o=p*s+a,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),a=s,s=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=a):(d=f,o=s)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function xo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=MC(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var J6=new Date(1899,11,31,0,0,0),IC=J6.getTime(),bC=new Date(1900,2,1,0,0,0);function Z6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=bC&&(r+=24*60*60*1e3),(r-(IC+(e.getTimezoneOffset()-J6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Y2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function OC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function DC(e){var t=e<0?12:11,r=Y2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function LC(e){var t=Y2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Y0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=DC(e):t===10?r=e.toFixed(10).substr(0,12):r=LC(e),Y2(OC(r.toUpperCase()))}function Fo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Y0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Pi(14,Z6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function MC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function BC(e,t,r,n){var i="",a=0,s=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return ig[r.m-1][1];case 5:return ig[r.m-1][0];default:return ig[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return jy[r.q][0];default:return jy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$i(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=$i(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?$i(u,f):"";return d}function ws(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var eS=/%/g;function jC(e,t,r){var n=t.replace(eS,""),i=t.length-n.length;return ja(e,n,r*Math.pow(10,2*i))+ur("%",i)}function UC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ja(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tS(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rS=/# (\?+)( ?)\/( ?)(\d+)/;function zC(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?ur(" ",e[1].length+1+e[4].length):K2(s,e[1].length)+e[2]+"/"+e[3]+$i(o,e[4].length))}function VC(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var nS=/^#*0*\.([0#]+)/,iS=/\).*[0#]/,aS=/\(###\) ###\\?-####/;function An(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Vy(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function GC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function HC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function yi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yi("n",n,r):"("+yi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UC(e,t,r);if(t.indexOf("%")!==-1)return jC(e,t,r);if(t.indexOf("E")!==-1)return tS(t,r);if(t.charCodeAt(0)===36)return"$"+yi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+dl(u,t.length);if(t.match(/^[#?]+$/))return i=dl(r,0),i==="0"&&(i=""),i.length>t.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(rS))return zC(a,u,f);if(t.match(/^#+0+$/))return f+dl(u,t.length-t.indexOf("0"));if(a=t.match(nS))return i=zy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+An(a[1])).replace(/\.$/,"."+An(a[1])).replace(/\.(\d*)$/,function(m,_){return"."+_+ur("0",An(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+zy(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ws(dl(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yi(e,t,-r):ws(""+(Math.floor(r)+GC(r,a[1].length)))+"."+$i(Vy(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return yi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=jl(yi(e,t.replace(/[\\-]/g,""),r)),s=0,jl(jl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(aS))return i=yi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=jd(u,Math.pow(10,s)-1,!1),i=""+f,d=ja("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Md(o[2],s),d.length<a[4].length&&(d=An(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=jd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?K2(o[1],s)+a[2]+"/"+a[3]+Md(o[2],s):ur(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=dl(r,0),t.length<=i.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return An(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=Vy(r,a[1].length),r<0?"-"+yi(e,t,-r):ws(HC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?$i(0,3-m.length):"")+m})+"."+$i(s,a[1].length);switch(t){case"###,##0.00":return yi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=ws(dl(u,0));return v!=="0"?f+v:"";case"###,###.00":return yi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return yi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function WC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ja(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $C(e,t,r){var n=t.replace(eS,""),i=t.length-n.length;return ja(e,n,r*Math.pow(10,2*i))+ur("%",i)}function sS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sS(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ua(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ua("n",n,r):"("+ua("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return WC(e,t,r);if(t.indexOf("%")!==-1)return $C(e,t,r);if(t.indexOf("E")!==-1)return sS(t,r);if(t.charCodeAt(0)===36)return"$"+ua(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+$i(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(rS))return VC(a,u,f);if(t.match(/^#+0+$/))return f+$i(u,t.length-t.indexOf("0"));if(a=t.match(nS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+An(a[1])).replace(/\.$/,"."+An(a[1])),i=i.replace(/\.(\d*)$/,function(m,_){return"."+_+ur("0",An(a[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ws(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):ws(""+r)+"."+ur("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ua(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=jl(ua(e,t.replace(/[\\-]/g,""),r)),s=0,jl(jl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(aS))return i=ua(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=jd(u,Math.pow(10,s)-1,!1),i=""+f,d=ja("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Md(o[2],s),d.length<a[4].length&&(d=An(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=jd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?K2(o[1],s)+a[2]+"/"+a[3]+Md(o[2],s):ur(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return An(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):ws(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?$i(0,3-m.length):"")+m})+"."+$i(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=ws(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return ua(e,t.slice(0,t.lastIndexOf(".")),r)+An(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ja(e,t,r){return(r|0)===r?ua(e,t,r):yi(e,t,r)}function XC(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var oS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Bd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(oS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function KC(e,t,r,n){for(var i=[],a="",s=0,o="",u="t",f,d,p,g="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Bd(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(p=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++s;break;case"\\":var v=e.charAt(++s),m=v==="("||v===")"?v:"t";i[i.length]={t:m,v},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=xo(t,r,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=xo(t,r),f==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:a},u=o;break;case"A":case"a":case"上":var _={t:o,v:o};if(f==null&&(f=xo(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",g="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",s+=5,g="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(f!=null&&(_.v=f.H>=12?"下午":"上午"),_.t="T",s+=5,g="h"):(_.t="t",++s),f==null&&_.t==="T")return"";i[i.length]=_,u=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(oS)){if(f==null&&(f=xo(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",oc(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var C=0,S=0,w;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=g,u="h",C<1&&(C=1);break;case"s":(w=i[s].v.match(/\.0+$/))&&(S=Math.max(S,w[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&i[s].v.match(/[Hh]/)&&(C=1),C<2&&i[s].v.match(/[Mm]/)&&(C=2),C<3&&i[s].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",T;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=BC(i[s].t.charCodeAt(0),i[s].v,f,S),i[s].t="t";break;case"n":case"?":for(T=s+1;i[T]!=null&&((o=i[T].t)==="?"||o==="D"||(o===" "||o==="t")&&i[T+1]!=null&&(i[T+1].t==="?"||i[T+1].t==="t"&&i[T+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[T].v==="/"||i[T].v===" "&&i[T+1]!=null&&i[T+1].t=="?"));)i[s].v+=i[T].v,i[T]={v:"",t:";"},++T;x+=i[s].v,s=T-1;break;case"G":i[s].t="t",i[s].v=Fo(t,r);break}var A="",N,R;if(x.length>0){x.charCodeAt(0)==40?(N=t<0&&x.charCodeAt(0)===45?-t:t,R=ja("n",x,N)):(N=t<0&&n>1?-t:t,R=ja("n",x,N),N<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),T=R.length-1;var P=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){P=s;break}var I=i.length;if(P===i.length&&R.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(T>=i[s].v.length-1?(T-=i[s].v.length,i[s].v=R.substr(T+1,i[s].v.length)):T<0?i[s].v="":(i[s].v=R.substr(0,T+1),T=-1),i[s].t="t",I=s);T>=0&&I<i.length&&(i[I].v=R.substr(0,T+1)+i[I].v)}else if(P!==i.length&&R.indexOf("E")===-1){for(T=R.indexOf(".")-1,s=P;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")-1:i[s].v.length-1,A=i[s].v.substr(d+1);d>=0;--d)T>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(A=R.charAt(T--)+A);i[s].v=A,i[s].t="t",I=s}for(T>=0&&I<i.length&&(i[I].v=R.substr(0,T+1)+i[I].v),T=R.indexOf(".")+1,s=P;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==P)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")+1:0,A=i[s].v.substr(0,d);d<i[s].v.length;++d)T<R.length&&(A+=R.charAt(T++));i[s].v=A,i[s].t="t",I=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(N=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=ja(i[s].t,i[s].v,N),i[s].t="t");var b="";for(s=0;s!==i.length;++s)i[s]!=null&&(b+=i[s].v);return b}var Gy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function YC(e,t){var r=XC(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Gy),o=r[1].match(Gy);return Hy(t,s)?[n,r[0]]:Hy(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Pi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[e],n==null&&(n=r.table&&r.table[Uy[e]]||ht[Uy[e]]),n==null&&(n=RC[e]||"General");break}if(Bd(n,0))return Fo(t,r);t instanceof Date&&(t=Z6(t,r.date1904));var i=YC(n,t);if(Bd(i[1]))return Fo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return KC(i[1],t,r,i[0])}function So(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ht[r]==null){t<0&&(t=r);continue}if(ht[r]==e){t=r;break}}t<0&&(t=391)}return ht[t]=e,t}function lS(){ht=NC()}var QC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},cS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qC(e){var t=typeof e=="number"?ht[e]:e;return t=t.replace(cS,"(\\d+)"),new RegExp("^"+t+"$")}function JC(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,u=-1;(t.match(cS)||[]).forEach(function(p,g){var v=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":s=v;break;case"s":u=v;break;case"m":s>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var ZC=function(){var e={};e.version="1.2.0";function t(){for(var R=0,P=new Array(256),I=0;I!=256;++I)R=I,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,P[I]=R;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(R){var P=0,I=0,b=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)M[b]=R[b];for(b=0;b!=256;++b)for(I=R[b],P=256+b;P<4096;P+=256)I=M[P]=I>>>8^R[I&255];var D=[];for(b=1;b!=16;++b)D[b-1]=typeof Int32Array<"u"?M.subarray(b*256,b*256+256):M.slice(b*256,b*256+256);return D}var i=n(r),a=i[0],s=i[1],o=i[2],u=i[3],f=i[4],d=i[5],p=i[6],g=i[7],v=i[8],m=i[9],_=i[10],C=i[11],S=i[12],w=i[13],x=i[14];function T(R,P){for(var I=P^-1,b=0,M=R.length;b<M;)I=I>>>8^r[(I^R.charCodeAt(b++))&255];return~I}function A(R,P){for(var I=P^-1,b=R.length-15,M=0;M<b;)I=x[R[M++]^I&255]^w[R[M++]^I>>8&255]^S[R[M++]^I>>16&255]^C[R[M++]^I>>>24]^_[R[M++]]^m[R[M++]]^v[R[M++]]^g[R[M++]]^p[R[M++]]^d[R[M++]]^f[R[M++]]^u[R[M++]]^o[R[M++]]^s[R[M++]]^a[R[M++]]^r[R[M++]];for(b+=15;M<b;)I=I>>>8^r[(I^R[M++])&255];return~I}function N(R,P){for(var I=P^-1,b=0,M=R.length,D=0,Q=0;b<M;)D=R.charCodeAt(b++),D<128?I=I>>>8^r[(I^D)&255]:D<2048?(I=I>>>8^r[(I^(192|D>>6&31))&255],I=I>>>8^r[(I^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,Q=R.charCodeAt(b++)&1023,I=I>>>8^r[(I^(240|D>>8&7))&255],I=I>>>8^r[(I^(128|D>>2&63))&255],I=I>>>8^r[(I^(128|Q>>6&15|(D&3)<<4))&255],I=I>>>8^r[(I^(128|Q&63))&255]):(I=I>>>8^r[(I^(224|D>>12&15))&255],I=I>>>8^r[(I^(128|D>>6&63))&255],I=I>>>8^r[(I^(128|D&63))&255]);return~I}return e.table=r,e.bstr=T,e.buf=A,e.str=N,e}(),Tt=function(){var t={};t.version="1.2.1";function r(O,G){for(var B=O.split("/"),U=G.split("/"),W=0,X=0,oe=Math.min(B.length,U.length);W<oe;++W){if(X=B[W].length-U[W].length)return X;if(B[W]!=U[W])return B[W]<U[W]?-1:1}return B.length-U.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(0,G+1)}function i(O){if(O.charAt(O.length-1)=="/")return i(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(G+1)}function a(O,G){typeof G=="string"&&(G=new Date(G));var B=G.getHours();B=B<<6|G.getMinutes(),B=B<<5|G.getSeconds()>>>1,O.write_shift(2,B);var U=G.getFullYear()-1980;U=U<<4|G.getMonth()+1,U=U<<5|G.getDate(),O.write_shift(2,U)}function s(O){var G=O.read_shift(2)&65535,B=O.read_shift(2)&65535,U=new Date,W=B&31;B>>>=5;var X=B&15;B>>>=4,U.setMilliseconds(0),U.setFullYear(B+1980),U.setMonth(X-1),U.setDate(W);var oe=G&31;G>>>=5;var we=G&63;return G>>>=6,U.setHours(G),U.setMinutes(we),U.setSeconds(oe<<1),U}function o(O){Qr(O,0);for(var G={},B=0;O.l<=O.length-4;){var U=O.read_shift(2),W=O.read_shift(2),X=O.l+W,oe={};switch(U){case 21589:B=O.read_shift(1),B&1&&(oe.mtime=O.read_shift(4)),W>5&&(B&2&&(oe.atime=O.read_shift(4)),B&4&&(oe.ctime=O.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}O.l=X,G[U]=oe}return G}var u;function f(){return u||(u={})}function d(O,G){if(O[0]==80&&O[1]==75)return Ge(O,G);if((O[0]|32)==109&&(O[1]|32)==105)return lr(O,G);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var B=3,U=512,W=0,X=0,oe=0,we=0,se=0,le=[],ue=O.slice(0,512);Qr(ue,0);var Ne=p(ue);switch(B=Ne[0],B){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ne[1]==0)return Ge(O,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}U!==512&&(ue=O.slice(0,U),Qr(ue,28));var Be=O.slice(0,U);g(ue,B);var He=ue.read_shift(4,"i");if(B===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);ue.l+=4,oe=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),we=ue.read_shift(4,"i"),W=ue.read_shift(4,"i"),se=ue.read_shift(4,"i"),X=ue.read_shift(4,"i");for(var De=-1,je=0;je<109&&(De=ue.read_shift(4,"i"),!(De<0));++je)le[je]=De;var st=v(O,U);C(se,X,st,U,le);var Mt=w(st,oe,le,U);Mt[oe].name="!Directory",W>0&&we!==Q&&(Mt[we].name="!MiniFAT"),Mt[le[0]].name="!FAT",Mt.fat_addrs=le,Mt.ssz=U;var Vt={},vr=[],Qs=[],Sa=[];x(oe,Mt,st,vr,W,Vt,Qs,we),m(Qs,Sa,vr),vr.shift();var oi={FileIndex:Qs,FullPaths:Sa};return G&&G.raw&&(oi.raw={header:Be,sectors:st}),oi}function p(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(he,"Header Signature: "),O.l+=16;var G=O.read_shift(2,"u");return[O.read_shift(2,"u"),G]}function g(O,G){var B=9;switch(O.l+=2,B=O.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function v(O,G){for(var B=Math.ceil(O.length/G)-1,U=[],W=1;W<B;++W)U[W-1]=O.slice(W*G,(W+1)*G);return U[B-1]=O.slice(B*G),U}function m(O,G,B){for(var U=0,W=0,X=0,oe=0,we=0,se=B.length,le=[],ue=[];U<se;++U)le[U]=ue[U]=U,G[U]=B[U];for(;we<ue.length;++we)U=ue[we],W=O[U].L,X=O[U].R,oe=O[U].C,le[U]===U&&(W!==-1&&le[W]!==W&&(le[U]=le[W]),X!==-1&&le[X]!==X&&(le[U]=le[X])),oe!==-1&&(le[oe]=U),W!==-1&&U!=le[U]&&(le[W]=le[U],ue.lastIndexOf(W)<we&&ue.push(W)),X!==-1&&U!=le[U]&&(le[X]=le[U],ue.lastIndexOf(X)<we&&ue.push(X));for(U=1;U<se;++U)le[U]===U&&(X!==-1&&le[X]!==X?le[U]=le[X]:W!==-1&&le[W]!==W&&(le[U]=le[W]));for(U=1;U<se;++U)if(O[U].type!==0){if(we=U,we!=le[we])do we=le[we],G[U]=G[we]+"/"+G[U];while(we!==0&&le[we]!==-1&&we!=le[we]);le[U]=-1}for(G[0]+="/",U=1;U<se;++U)O[U].type!==2&&(G[U]+="/")}function _(O,G,B){for(var U=O.start,W=O.size,X=[],oe=U;B&&W>0&&oe>=0;)X.push(G.slice(oe*D,oe*D+D)),W-=D,oe=ho(B,oe*4);return X.length===0?Fr(0):vs(X).slice(0,O.size)}function C(O,G,B,U,W){var X=Q;if(O===Q){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var oe=B[O],we=(U>>>2)-1;if(!oe)return;for(var se=0;se<we&&(X=ho(oe,se*4))!==Q;++se)W.push(X);C(ho(oe,U-4),G-1,B,U,W)}}function S(O,G,B,U,W){var X=[],oe=[];W||(W=[]);var we=U-1,se=0,le=0;for(se=G;se>=0;){W[se]=!0,X[X.length]=se,oe.push(O[se]);var ue=B[Math.floor(se*4/U)];if(le=se*4&we,U<4+le)throw new Error("FAT boundary crossed: "+se+" 4 "+U);if(!O[ue])break;se=ho(O[ue],le)}return{nodes:X,data:e3([oe])}}function w(O,G,B,U){var W=O.length,X=[],oe=[],we=[],se=[],le=U-1,ue=0,Ne=0,Be=0,He=0;for(ue=0;ue<W;++ue)if(we=[],Be=ue+G,Be>=W&&(Be-=W),!oe[Be]){se=[];var De=[];for(Ne=Be;Ne>=0;){De[Ne]=!0,oe[Ne]=!0,we[we.length]=Ne,se.push(O[Ne]);var je=B[Math.floor(Ne*4/U)];if(He=Ne*4&le,U<4+He)throw new Error("FAT boundary crossed: "+Ne+" 4 "+U);if(!O[je]||(Ne=ho(O[je],He),De[Ne]))break}X[Be]={nodes:we,data:e3([se])}}return X}function x(O,G,B,U,W,X,oe,we){for(var se=0,le=U.length?2:0,ue=G[O].data,Ne=0,Be=0,He;Ne<ue.length;Ne+=128){var De=ue.slice(Ne,Ne+128);Qr(De,64),Be=De.read_shift(2),He=ex(De,0,Be-le),U.push(He);var je={name:He,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},st=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);st!==0&&(je.ct=T(De,De.l-8));var Mt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Mt!==0&&(je.mt=T(De,De.l-8)),je.start=De.read_shift(4,"i"),je.size=De.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=Q,je.name=""),je.type===5?(se=je.start,W>0&&se!==Q&&(G[se].name="!StreamData")):je.size>=4096?(je.storage="fat",G[je.start]===void 0&&(G[je.start]=S(B,je.start,G.fat_addrs,G.ssz)),G[je.start].name=je.name,je.content=G[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:se!==Q&&je.start!==Q&&G[se]&&(je.content=_(je,G[se].data,(G[we]||{}).data))),je.content&&Qr(je.content,0),X[He]=je,oe.push(je)}}function T(O,G){return new Date((qn(O,G+4)/1e7*Math.pow(2,32)+qn(O,G)/1e7-11644473600)*1e3)}function A(O,G){return f(),d(u.readFileSync(O),G)}function N(O,G){var B=G&&G.type;switch(B||kt&&Buffer.isBuffer(O)&&(B="buffer"),B||"base64"){case"file":return A(O,G);case"base64":return d(Hi(ni(O)),G);case"binary":return d(Hi(O),G)}return d(O,G)}function R(O,G){var B=G||{},U=B.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=U+"/",O.FileIndex[0]={name:U,type:5}),B.CLSID&&(O.FileIndex[0].clsid=B.CLSID),P(O)}function P(O){var G="Sh33tJ5";if(!Tt.find(O,"/"+G)){var B=Fr(4);B[0]=55,B[1]=B[3]=50,B[2]=54,O.FileIndex.push({name:G,type:2,content:B,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+G),I(O)}}function I(O,G){R(O);for(var B=!1,U=!1,W=O.FullPaths.length-1;W>=0;--W){var X=O.FileIndex[W];switch(X.type){case 0:U?B=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(X.R*X.L*X.C)&&(B=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!G)){var oe=new Date(1987,1,19),we=0,se=Object.create?Object.create(null):{},le=[];for(W=0;W<O.FullPaths.length;++W)se[O.FullPaths[W]]=!0,O.FileIndex[W].type!==0&&le.push([O.FullPaths[W],O.FileIndex[W]]);for(W=0;W<le.length;++W){var ue=n(le[W][0]);U=se[ue],U||(le.push([ue,{name:i(ue).replace("/",""),type:1,clsid:Z,ct:oe,mt:oe,content:null}]),se[ue]=!0)}for(le.sort(function(He,De){return r(He[0],De[0])}),O.FullPaths=[],O.FileIndex=[],W=0;W<le.length;++W)O.FullPaths[W]=le[W][0],O.FileIndex[W]=le[W][1];for(W=0;W<le.length;++W){var Ne=O.FileIndex[W],Be=O.FullPaths[W];if(Ne.name=i(Be).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Z,W===0)Ne.C=le.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Be.slice(-1)=="/"){for(we=W+1;we<le.length&&n(O.FullPaths[we])!=Be;++we);for(Ne.C=we>=le.length?-1:we,we=W+1;we<le.length&&n(O.FullPaths[we])!=n(Be);++we);Ne.R=we>=le.length?-1:we,Ne.type=1}else n(O.FullPaths[W+1]||"")==n(Be)&&(Ne.R=W+1),Ne.type=2}}}function b(O,G){var B=G||{};if(B.fileType=="mad")return Yo(O,B);switch(I(O),B.fileType){case"zip":return ut(O,B)}var U=function(He){for(var De=0,je=0,st=0;st<He.FileIndex.length;++st){var Mt=He.FileIndex[st];if(Mt.content){var Vt=Mt.content.length;Vt>0&&(Vt<4096?De+=Vt+63>>6:je+=Vt+511>>9)}}for(var vr=He.FullPaths.length+3>>2,Qs=De+7>>3,Sa=De+127>>7,oi=Qs+je+vr+Sa,nn=oi+127>>7,Bt=nn<=109?0:Math.ceil((nn-109)/127);oi+nn+Bt+127>>7>nn;)Bt=++nn<=109?0:Math.ceil((nn-109)/127);var St=[1,Bt,nn,Sa,vr,je,De,0];return He.FileIndex[0].size=De<<6,St[7]=(He.FileIndex[0].start=St[0]+St[1]+St[2]+St[3]+St[4]+St[5])+(St[6]+7>>3),St}(O),W=Fr(U[7]<<9),X=0,oe=0;{for(X=0;X<8;++X)W.write_shift(1,z[X]);for(X=0;X<8;++X)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),X=0;X<3;++X)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,U[2]),W.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:Q),W.write_shift(4,U[3]),W.write_shift(-4,U[1]?U[0]-1:Q),W.write_shift(4,U[1]),X=0;X<109;++X)W.write_shift(-4,X<U[2]?U[1]+X:-1)}if(U[1])for(oe=0;oe<U[1];++oe){for(;X<236+oe*127;++X)W.write_shift(-4,X<U[2]?U[1]+X:-1);W.write_shift(-4,oe===U[1]-1?Q:oe+1)}var we=function(He){for(oe+=He;X<oe-1;++X)W.write_shift(-4,X+1);He&&(++X,W.write_shift(-4,Q))};for(oe=X=0,oe+=U[1];X<oe;++X)W.write_shift(-4,ae.DIFSECT);for(oe+=U[2];X<oe;++X)W.write_shift(-4,ae.FATSECT);we(U[3]),we(U[4]);for(var se=0,le=0,ue=O.FileIndex[0];se<O.FileIndex.length;++se)ue=O.FileIndex[se],ue.content&&(le=ue.content.length,!(le<4096)&&(ue.start=oe,we(le+511>>9)));for(we(U[6]+7>>3);W.l&511;)W.write_shift(-4,ae.ENDOFCHAIN);for(oe=X=0,se=0;se<O.FileIndex.length;++se)ue=O.FileIndex[se],ue.content&&(le=ue.content.length,!(!le||le>=4096)&&(ue.start=oe,we(le+63>>6)));for(;W.l&511;)W.write_shift(-4,ae.ENDOFCHAIN);for(X=0;X<U[4]<<2;++X){var Ne=O.FullPaths[X];if(!Ne||Ne.length===0){for(se=0;se<17;++se)W.write_shift(4,0);for(se=0;se<3;++se)W.write_shift(4,-1);for(se=0;se<12;++se)W.write_shift(4,0);continue}ue=O.FileIndex[X],X===0&&(ue.start=ue.size?ue.start-1:Q);var Be=X===0&&B.root||ue.name;if(le=2*(Be.length+1),W.write_shift(64,Be,"utf16le"),W.write_shift(2,le),W.write_shift(1,ue.type),W.write_shift(1,ue.color),W.write_shift(-4,ue.L),W.write_shift(-4,ue.R),W.write_shift(-4,ue.C),ue.clsid)W.write_shift(16,ue.clsid,"hex");else for(se=0;se<4;++se)W.write_shift(4,0);W.write_shift(4,ue.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ue.start),W.write_shift(4,ue.size),W.write_shift(4,0)}for(X=1;X<O.FileIndex.length;++X)if(ue=O.FileIndex[X],ue.size>=4096)if(W.l=ue.start+1<<9,kt&&Buffer.isBuffer(ue.content))ue.content.copy(W,W.l,0,ue.size),W.l+=ue.size+511&-512;else{for(se=0;se<ue.size;++se)W.write_shift(1,ue.content[se]);for(;se&511;++se)W.write_shift(1,0)}for(X=1;X<O.FileIndex.length;++X)if(ue=O.FileIndex[X],ue.size>0&&ue.size<4096)if(kt&&Buffer.isBuffer(ue.content))ue.content.copy(W,W.l,0,ue.size),W.l+=ue.size+63&-64;else{for(se=0;se<ue.size;++se)W.write_shift(1,ue.content[se]);for(;se&63;++se)W.write_shift(1,0)}if(kt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function M(O,G){var B=O.FullPaths.map(function(se){return se.toUpperCase()}),U=B.map(function(se){var le=se.split("/");return le[le.length-(se.slice(-1)=="/"?2:1)]}),W=!1;G.charCodeAt(0)===47?(W=!0,G=B[0].slice(0,-1)+G):W=G.indexOf("/")!==-1;var X=G.toUpperCase(),oe=W===!0?B.indexOf(X):U.indexOf(X);if(oe!==-1)return O.FileIndex[oe];var we=!X.match(a0);for(X=X.replace(Rn,""),we&&(X=X.replace(a0,"!")),oe=0;oe<B.length;++oe)if((we?B[oe].replace(a0,"!"):B[oe]).replace(Rn,"")==X||(we?U[oe].replace(a0,"!"):U[oe]).replace(Rn,"")==X)return O.FileIndex[oe];return null}var D=64,Q=-2,he="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(O,G,B){f();var U=b(O,B);u.writeFileSync(G,U)}function K(O){for(var G=new Array(O.length),B=0;B<O.length;++B)G[B]=String.fromCharCode(O[B]);return G.join("")}function ce(O,G){var B=b(O,G);switch(G&&G.type||"buffer"){case"file":return f(),u.writeFileSync(G.filename,B),B;case"binary":return typeof B=="string"?B:K(B);case"base64":return Ly(typeof B=="string"?B:K(B));case"buffer":if(kt)return Buffer.isBuffer(B)?B:Oo(B);case"array":return typeof B=="string"?Hi(B):B}return B}var me;function L(O){try{var G=O.InflateRaw,B=new G;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)me=O;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function ee(O,G){if(!me)return Ie(O,G);var B=me.InflateRaw,U=new B,W=U._processChunk(O.slice(O.l),U._finishFlushFlag);return O.l+=U.bytesRead,W}function q(O){return me?me.deflateRawSync(O):Fe(O)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(O){var G=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(G>>16|G>>8|G)&255}for(var ge=typeof Uint8Array<"u",_e=ge?new Uint8Array(256):[],Me=0;Me<256;++Me)_e[Me]=ie(Me);function H(O,G){var B=_e[O&255];return G<=8?B>>>8-G:(B=B<<8|_e[O>>8&255],G<=16?B>>>16-G:(B=B<<8|_e[O>>16&255],B>>>24-G))}function tt(O,G){var B=G&7,U=G>>>3;return(O[U]|(B<=6?0:O[U+1]<<8))>>>B&3}function nt(O,G){var B=G&7,U=G>>>3;return(O[U]|(B<=5?0:O[U+1]<<8))>>>B&7}function Xe(O,G){var B=G&7,U=G>>>3;return(O[U]|(B<=4?0:O[U+1]<<8))>>>B&15}function Ze(O,G){var B=G&7,U=G>>>3;return(O[U]|(B<=3?0:O[U+1]<<8))>>>B&31}function be(O,G){var B=G&7,U=G>>>3;return(O[U]|(B<=1?0:O[U+1]<<8))>>>B&127}function Ct(O,G,B){var U=G&7,W=G>>>3,X=(1<<B)-1,oe=O[W]>>>U;return B<8-U||(oe|=O[W+1]<<8-U,B<16-U)||(oe|=O[W+2]<<16-U,B<24-U)||(oe|=O[W+3]<<24-U),oe&X}function Lr(O,G,B){var U=G&7,W=G>>>3;return U<=5?O[W]|=(B&7)<<U:(O[W]|=B<<U&255,O[W+1]=(B&7)>>8-U),G+3}function ye(O,G,B){var U=G&7,W=G>>>3;return B=(B&1)<<U,O[W]|=B,G+1}function xe(O,G,B){var U=G&7,W=G>>>3;return B<<=U,O[W]|=B&255,B>>>=8,O[W+1]=B,G+8}function Te(O,G,B){var U=G&7,W=G>>>3;return B<<=U,O[W]|=B&255,B>>>=8,O[W+1]=B&255,O[W+2]=B>>>8,G+16}function Ae(O,G){var B=O.length,U=2*B>G?2*B:G+5,W=0;if(B>=G)return O;if(kt){var X=My(U);if(O.copy)O.copy(X);else for(;W<O.length;++W)X[W]=O[W];return X}else if(ge){var oe=new Uint8Array(U);if(oe.set)oe.set(O);else for(;W<B;++W)oe[W]=O[W];return oe}return O.length=U,O}function Pe(O){for(var G=new Array(O),B=0;B<O;++B)G[B]=0;return G}function Oe(O,G,B){var U=1,W=0,X=0,oe=0,we=0,se=O.length,le=ge?new Uint16Array(32):Pe(32);for(X=0;X<32;++X)le[X]=0;for(X=se;X<B;++X)O[X]=0;se=O.length;var ue=ge?new Uint16Array(se):Pe(se);for(X=0;X<se;++X)le[W=O[X]]++,U<W&&(U=W),ue[X]=0;for(le[0]=0,X=1;X<=U;++X)le[X+16]=we=we+le[X-1]<<1;for(X=0;X<se;++X)we=O[X],we!=0&&(ue[X]=le[we+16]++);var Ne=0;for(X=0;X<se;++X)if(Ne=O[X],Ne!=0)for(we=H(ue[X],U)>>U-Ne,oe=(1<<U+4-Ne)-1;oe>=0;--oe)G[we|oe<<Ne]=Ne&15|X<<4;return U}var Ve=ge?new Uint16Array(512):Pe(512),Se=ge?new Uint16Array(32):Pe(32);if(!ge){for(var J=0;J<512;++J)Ve[J]=0;for(J=0;J<32;++J)Se[J]=0}(function(){for(var O=[],G=0;G<32;G++)O.push(5);Oe(O,Se,32);var B=[];for(G=0;G<=143;G++)B.push(8);for(;G<=255;G++)B.push(9);for(;G<=279;G++)B.push(7);for(;G<=287;G++)B.push(8);Oe(B,Ve,288)})();var Ee=function(){for(var G=ge?new Uint8Array(32768):[],B=0,U=0;B<V.length-1;++B)for(;U<V[B+1];++U)G[U]=B;for(;U<32768;++U)G[U]=29;var W=ge?new Uint8Array(259):[];for(B=0,U=0;B<de.length-1;++B)for(;U<de[B+1];++U)W[U]=B;function X(we,se){for(var le=0;le<we.length;){var ue=Math.min(65535,we.length-le),Ne=le+ue==we.length;for(se.write_shift(1,+Ne),se.write_shift(2,ue),se.write_shift(2,~ue&65535);ue-- >0;)se[se.l++]=we[le++]}return se.l}function oe(we,se){for(var le=0,ue=0,Ne=ge?new Uint16Array(32768):[];ue<we.length;){var Be=Math.min(65535,we.length-ue);if(Be<10){for(le=Lr(se,le,+(ue+Be==we.length)),le&7&&(le+=8-(le&7)),se.l=le/8|0,se.write_shift(2,Be),se.write_shift(2,~Be&65535);Be-- >0;)se[se.l++]=we[ue++];le=se.l*8;continue}le=Lr(se,le,+(ue+Be==we.length)+2);for(var He=0;Be-- >0;){var De=we[ue];He=(He<<5^De)&32767;var je=-1,st=0;if((je=Ne[He])&&(je|=ue&-32768,je>ue&&(je-=32768),je<ue))for(;we[je+st]==we[ue+st]&&st<250;)++st;if(st>2){De=W[st],De<=22?le=xe(se,le,_e[De+1]>>1)-1:(xe(se,le,3),le+=5,xe(se,le,_e[De-23]>>5),le+=3);var Mt=De<8?0:De-4>>2;Mt>0&&(Te(se,le,st-de[De]),le+=Mt),De=G[ue-je],le=xe(se,le,_e[De]>>3),le-=3;var Vt=De<4?0:De-2>>1;Vt>0&&(Te(se,le,ue-je-V[De]),le+=Vt);for(var vr=0;vr<st;++vr)Ne[He]=ue&32767,He=(He<<5^we[ue])&32767,++ue;Be-=st-1}else De<=143?De=De+48:le=ye(se,le,1),le=xe(se,le,_e[De]),Ne[He]=ue&32767,++ue}le=xe(se,le,0)-1}return se.l=(le+7)/8|0,se.l}return function(se,le){return se.length<8?X(se,le):oe(se,le)}}();function Fe(O){var G=Fr(50+Math.floor(O.length*1.1)),B=Ee(O,G);return G.slice(0,B)}var Ce=ge?new Uint16Array(32768):Pe(32768),Qe=ge?new Uint16Array(32768):Pe(32768),et=ge?new Uint16Array(128):Pe(128),lt=1,Ye=1;function xt(O,G){var B=Ze(O,G)+257;G+=5;var U=Ze(O,G)+1;G+=5;var W=Xe(O,G)+4;G+=4;for(var X=0,oe=ge?new Uint8Array(19):Pe(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,le=ge?new Uint8Array(8):Pe(8),ue=ge?new Uint8Array(8):Pe(8),Ne=oe.length,Be=0;Be<W;++Be)oe[Y[Be]]=X=nt(O,G),se<X&&(se=X),le[X]++,G+=3;var He=0;for(le[0]=0,Be=1;Be<=se;++Be)ue[Be]=He=He+le[Be-1]<<1;for(Be=0;Be<Ne;++Be)(He=oe[Be])!=0&&(we[Be]=ue[He]++);var De=0;for(Be=0;Be<Ne;++Be)if(De=oe[Be],De!=0){He=_e[we[Be]]>>8-De;for(var je=(1<<7-De)-1;je>=0;--je)et[He|je<<De]=De&7|Be<<3}var st=[];for(se=1;st.length<B+U;)switch(He=et[be(O,G)],G+=He&7,He>>>=3){case 16:for(X=3+tt(O,G),G+=2,He=st[st.length-1];X-- >0;)st.push(He);break;case 17:for(X=3+nt(O,G),G+=3;X-- >0;)st.push(0);break;case 18:for(X=11+be(O,G),G+=7;X-- >0;)st.push(0);break;default:st.push(He),se<He&&(se=He);break}var Mt=st.slice(0,B),Vt=st.slice(B);for(Be=B;Be<286;++Be)Mt[Be]=0;for(Be=U;Be<30;++Be)Vt[Be]=0;return lt=Oe(Mt,Ce,286),Ye=Oe(Vt,Qe,30),G}function si(O,G){if(O[0]==3&&!(O[1]&3))return[Ds(G),2];for(var B=0,U=0,W=My(G||1<<18),X=0,oe=W.length>>>0,we=0,se=0;!(U&1);){if(U=nt(O,B),B+=3,U>>>1)U>>1==1?(we=9,se=5):(B=xt(O,B),we=lt,se=Ye);else{B&7&&(B+=8-(B&7));var le=O[B>>>3]|O[(B>>>3)+1]<<8;if(B+=32,le>0)for(!G&&oe<X+le&&(W=Ae(W,X+le),oe=W.length);le-- >0;)W[X++]=O[B>>>3],B+=8;continue}for(;;){!G&&oe<X+32767&&(W=Ae(W,X+32767),oe=W.length);var ue=Ct(O,B,we),Ne=U>>>1==1?Ve[ue]:Ce[ue];if(B+=Ne&15,Ne>>>=4,!(Ne>>>8&255))W[X++]=Ne;else{if(Ne==256)break;Ne-=257;var Be=Ne<8?0:Ne-4>>2;Be>5&&(Be=0);var He=X+de[Ne];Be>0&&(He+=Ct(O,B,Be),B+=Be),ue=Ct(O,B,se),Ne=U>>>1==1?Se[ue]:Qe[ue],B+=Ne&15,Ne>>>=4;var De=Ne<4?0:Ne-2>>1,je=V[Ne];for(De>0&&(je+=Ct(O,B,De),B+=De),!G&&oe<He&&(W=Ae(W,He+100),oe=W.length);X<He;)W[X]=W[X-je],++X}}}return G?[W,B+7>>>3]:[W.slice(0,X),B+7>>>3]}function Ie(O,G){var B=O.slice(O.l||0),U=si(B,G);return O.l+=U[1],U[0]}function qe(O,G){if(O)typeof console<"u"&&console.error(G);else throw new Error(G)}function Ge(O,G){var B=O;Qr(B,0);var U=[],W=[],X={FileIndex:U,FullPaths:W};R(X,{root:G.root});for(var oe=B.length-4;(B[oe]!=80||B[oe+1]!=75||B[oe+2]!=5||B[oe+3]!=6)&&oe>=0;)--oe;B.l=oe+4,B.l+=4;var we=B.read_shift(2);B.l+=6;var se=B.read_shift(4);for(B.l=se,oe=0;oe<we;++oe){B.l+=20;var le=B.read_shift(4),ue=B.read_shift(4),Ne=B.read_shift(2),Be=B.read_shift(2),He=B.read_shift(2);B.l+=8;var De=B.read_shift(4),je=o(B.slice(B.l+Ne,B.l+Ne+Be));B.l+=Ne+Be+He;var st=B.l;B.l=De+4,Je(B,le,ue,X,je),B.l=st}return X}function Je(O,G,B,U,W){O.l+=2;var X=O.read_shift(2),oe=O.read_shift(2),we=s(O);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var se=O.read_shift(4),le=O.read_shift(4),ue=O.read_shift(4),Ne=O.read_shift(2),Be=O.read_shift(2),He="",De=0;De<Ne;++De)He+=String.fromCharCode(O[O.l++]);if(Be){var je=o(O.slice(O.l,O.l+Be));(je[21589]||{}).mt&&(we=je[21589].mt),((W||{})[21589]||{}).mt&&(we=W[21589].mt)}O.l+=Be;var st=O.slice(O.l,O.l+le);switch(oe){case 8:st=ee(O,ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Mt=!1;X&8&&(se=O.read_shift(4),se==134695760&&(se=O.read_shift(4),Mt=!0),le=O.read_shift(4),ue=O.read_shift(4)),le!=G&&qe(Mt,"Bad compressed size: "+G+" != "+le),ue!=B&&qe(Mt,"Bad uncompressed size: "+B+" != "+ue),xc(U,He,st,{unsafe:!0,mt:we})}function ut(O,G){var B=G||{},U=[],W=[],X=Fr(1),oe=B.compression?8:0,we=0,se=0,le=0,ue=0,Ne=0,Be=O.FullPaths[0],He=Be,De=O.FileIndex[0],je=[],st=0;for(se=1;se<O.FullPaths.length;++se)if(He=O.FullPaths[se].slice(Be.length),De=O.FileIndex[se],!(!De.size||!De.content||He=="Sh33tJ5")){var Mt=ue,Vt=Fr(He.length);for(le=0;le<He.length;++le)Vt.write_shift(1,He.charCodeAt(le)&127);Vt=Vt.slice(0,Vt.l),je[Ne]=ZC.buf(De.content,0);var vr=De.content;oe==8&&(vr=q(vr)),X=Fr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,we),X.write_shift(2,oe),De.mt?a(X,De.mt):X.write_shift(4,0),X.write_shift(-4,je[Ne]),X.write_shift(4,vr.length),X.write_shift(4,De.content.length),X.write_shift(2,Vt.length),X.write_shift(2,0),ue+=X.length,U.push(X),ue+=Vt.length,U.push(Vt),ue+=vr.length,U.push(vr),X=Fr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,we),X.write_shift(2,oe),X.write_shift(4,0),X.write_shift(-4,je[Ne]),X.write_shift(4,vr.length),X.write_shift(4,De.content.length),X.write_shift(2,Vt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Mt),st+=X.l,W.push(X),st+=Vt.length,W.push(Vt),++Ne}return X=Fr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Ne),X.write_shift(2,Ne),X.write_shift(4,st),X.write_shift(4,ue),X.write_shift(2,0),vs([vs(U),vs(W),X])}var Pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ot(O,G){if(O.ctype)return O.ctype;var B=O.name||"",U=B.match(/\.([^\.]+)$/);return U&&Pt[U[1]]||G&&(U=(B=G).match(/[\.\\]([^\.\\])+$/),U&&Pt[U[1]])?Pt[U[1]]:"application/octet-stream"}function kn(O){for(var G=Ly(O),B=[],U=0;U<G.length;U+=76)B.push(G.slice(U,U+76));return B.join(`\r
`)+`\r
`}function tn(O){var G=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ue=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],U=G.split(`\r
`),W=0;W<U.length;++W){var X=U[W];if(X.length==0){B.push("");continue}for(var oe=0;oe<X.length;){var we=76,se=X.slice(oe,oe+we);se.charAt(we-1)=="="?we--:se.charAt(we-2)=="="?we-=2:se.charAt(we-3)=="="&&(we-=3),se=X.slice(oe,oe+we),oe+=we,oe<X.length&&(se+="="),B.push(se)}}return B.join(`\r
`)}function mt(O){for(var G=[],B=0;B<O.length;++B){for(var U=O[B];B<=O.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+O[++B];G.push(U)}for(var W=0;W<G.length;++W)G[W]=G[W].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Hi(G.join(`\r
`))}function rn(O,G,B){for(var U="",W="",X="",oe,we=0;we<10;++we){var se=G[we];if(!se||se.match(/^\s*$/))break;var le=se.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":U=le[2].trim();break;case"content-type":X=le[2].trim();break;case"content-transfer-encoding":W=le[2].trim();break}}switch(++we,W.toLowerCase()){case"base64":oe=Hi(ni(G.slice(we).join("")));break;case"quoted-printable":oe=mt(G.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ue=xc(O,U.slice(B.length),oe,{unsafe:!0});X&&(ue.ctype=X)}function lr(O,G){if(K(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=G&&G.root||"",U=(kt&&Buffer.isBuffer(O)?O.toString("binary"):K(O)).split(`\r
`),W=0,X="";for(W=0;W<U.length;++W)if(X=U[W],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),B||(B=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),X.slice(0,B.length)!=B););var oe=(U[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var we="--"+(oe[1]||""),se=[],le=[],ue={FileIndex:se,FullPaths:le};R(ue);var Ne,Be=0;for(W=0;W<U.length;++W){var He=U[W];He!==we&&He!==we+"--"||(Be++&&rn(ue,U.slice(Ne,W),B),Ne=W)}return ue}function Yo(O,G){var B=G||{},U=B.boundary||"SheetJS";U="------="+U;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],X=O.FullPaths[0],oe=X,we=O.FileIndex[0],se=1;se<O.FullPaths.length;++se)if(oe=O.FullPaths[se].slice(X.length),we=O.FileIndex[se],!(!we.size||!we.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var le=we.content,ue=kt&&Buffer.isBuffer(le)?le.toString("binary"):K(le),Ne=0,Be=Math.min(1024,ue.length),He=0,De=0;De<=Be;++De)(He=ue.charCodeAt(De))>=32&&He<128&&++Ne;var je=Ne>=Be*4/5;W.push(U),W.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+oe),W.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),W.push("Content-Type: "+Ot(we,oe)),W.push(""),W.push(je?tn(ue):kn(ue))}return W.push(U+`--\r
`),W.join(`\r
`)}function Qo(O){var G={};return R(G,O),G}function xc(O,G,B,U){var W=U&&U.unsafe;W||R(O);var X=!W&&Tt.find(O,G);if(!X){var oe=O.FullPaths[0];G.slice(0,oe.length)==oe?oe=G:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+G).replace("//","/")),X={name:i(G),type:2},O.FileIndex.push(X),O.FullPaths.push(oe),W||Tt.utils.cfb_gc(O)}return X.content=B,X.size=B?B.length:0,U&&(U.CLSID&&(X.clsid=U.CLSID),U.mt&&(X.mt=U.mt),U.ct&&(X.ct=U.ct)),X}function ku(O,G){R(O);var B=Tt.find(O,G);if(B){for(var U=0;U<O.FileIndex.length;++U)if(O.FileIndex[U]==B)return O.FileIndex.splice(U,1),O.FullPaths.splice(U,1),!0}return!1}function vc(O,G,B){R(O);var U=Tt.find(O,G);if(U){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==U)return O.FileIndex[W].name=i(B),O.FullPaths[W]=B,!0}return!1}function y1(O){I(O,!0)}return t.find=M,t.read=N,t.parse=d,t.write=ce,t.writeFile=ne,t.utils={cfb_new:Qo,cfb_add:xc,cfb_del:ku,cfb_mov:vc,cfb_gc:y1,ReadShift:y0,CheckField:IS,prep_blob:Qr,bconcat:vs,use_zlib:L,_deflateRaw:Fe,_inflateRaw:Ie,consts:ae},t}();function e7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function xa(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Q2(e){for(var t=[],r=xa(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Ud=new Date(1899,11,30,0,0,0);function In(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Ud.getTime()+(e.getTimezoneOffset()-Ud.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uS=new Date,t7=Ud.getTime()+(uS.getTimezoneOffset()-Ud.getTimezoneOffset())*6e4,Wy=uS.getTimezoneOffset();function kh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+t7),t.getTimezoneOffset()!==Wy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Wy)*6e4),t}function r7(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var $y=new Date("2017-02-19T19:06:09.000Z"),fS=isNaN($y.getFullYear())?new Date("2/19/17"):$y,n7=fS.getFullYear()==2017;function $r(e,t){var r=new Date(e);if(n7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(fS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function No(e,t){if(kt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return o0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return o0(q6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return o0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return o0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Jr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Jr(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function Qi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var i7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&i7.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var a7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function dS(e){return e?e.content&&e.type?No(e.content,!0):e.data?i0(e.data):e.asNodeBuffer&&kt?i0(e.asNodeBuffer().toString("binary")):e.asBinary?i0(e.asBinary()):e._data&&e._data.getContent?i0(No(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function hS(e){if(!e)return null;if(e.data)return Oy(e.data);if(e.asNodeBuffer&&kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Oy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function s7(e){return e&&e.name.slice(-4)===".bin"?hS(e):dS(e)}function _i(e,t){for(var r=e.FullPaths||xa(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function q2(e,t){var r=_i(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Sr(e,t,r){if(!r)return s7(q2(e,t));if(!t)return null;try{return Sr(e,t)}catch{return null}}function Jn(e,t,r){if(!r)return dS(q2(e,t));if(!t)return null;try{return Jn(e,t)}catch{return null}}function pS(e,t,r){if(!r)return hS(q2(e,t));if(!t)return null;try{return pS(e,t)}catch{return null}}function Xy(e){for(var t=e.FullPaths||xa(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function o7(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return kt?n=Oo(r):n=AC(r),Tt.utils.cfb_add(e,t,n)}Tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function gS(e,t){switch(t.type){case"base64":return Tt.read(e,{type:"base64"});case"binary":return Tt.read(e,{type:"binary"});case"buffer":case"array":return Tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function s0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var mS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,l7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ky=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,c7=/<[^>]*>/g,Sn=mS.match(Ky)?Ky:c7,u7=/<\w*:/,f7=/<(\/?)\w+:/;function it(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(l7),o=0,u="",f=0,d="",p="",g=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(d=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(i=p.charCodeAt(a+1))==34||i==39?1:0,u=p.slice(a+1+g,p.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,r||(n[d.toLowerCase()]=u);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=u,r||(n[v.toLowerCase()]=u)}}return n}function va(e){return e.replace(f7,"<$1")}var xS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},d7=Q2(xS),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,u){return xS[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),h7=/[&<>'"]/g,p7=/[\u0000-\u001f]/g;function J2(e){var t=e+"";return t.replace(h7,function(r){return d7[r]}).replace(/\n/g,"<br/>").replace(p7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Yy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ag(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Qy(e){var t=Ds(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function qy(e){return Oo(e,"binary").toString("utf8")}var Lf="foo bar bazâð£",Xt=kt&&(qy(Lf)==ag(Lf)&&qy||Qy(Lf)==ag(Lf)&&Qy)||ag,o0=kt?function(e){return Oo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Q0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),vS=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),g7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),m7=/<\/?(?:vt:)?variant>/g,x7=/<(?:vt:)([^>]*)>([\s\S]*)</;function Jy(e,t){var r=it(e),n=e.match(g7(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(m7,"").match(x7);s&&i.push({v:Xt(s[2]),t:s[1]})}),i}var v7=/(^\s|\s$|\n)/;function y7(e){return xa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _7(e,t,r){return"<"+e+(r!=null?y7(r):"")+(t!=null?(t.match(v7)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Z2(e){if(kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(Do(X2(e)));throw new Error("Bad input format: expected Buffer or string")}var q0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,S7={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},w7=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function k7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function E7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Zy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},e3=kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Oo(t)})):Zy(e)}:Zy,t3=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ma(e,i)));return n.join("").replace(Rn,"")},ex=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Rn,""):t3(e,t,r)}:t3,r3=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},yS=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):r3(e,t,r)}:r3,n3=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(xl(e,i)));return n.join("")},du=kt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):n3(t,r,n)}:n3,_S=function(e,t){var r=qn(e,t);return r>0?du(e,t+4,t+4+r-1):""},SS=_S,wS=function(e,t){var r=qn(e,t);return r>0?du(e,t+4,t+4+r-1):""},kS=wS,ES=function(e,t){var r=2*qn(e,t);return r>0?du(e,t+4,t+4+r-1):""},CS=ES,TS=function(t,r){var n=qn(t,r);return n>0?ex(t,r+4,r+4+n):""},AS=TS,PS=function(e,t){var r=qn(e,t);return r>0?du(e,t+4,t+4+r):""},FS=PS,NS=function(e,t){return k7(e,t)},zd=NS,RS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};kt&&(SS=function(t,r){if(!Buffer.isBuffer(t))return _S(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},kS=function(t,r){if(!Buffer.isBuffer(t))return wS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},CS=function(t,r){if(!Buffer.isBuffer(t))return ES(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},AS=function(t,r){if(!Buffer.isBuffer(t))return TS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},FS=function(t,r){if(!Buffer.isBuffer(t))return PS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},zd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):NS(t,r)},RS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var xl=function(e,t){return e[t]},Ma=function(e,t){return e[t+1]*256+e[t]},C7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ho=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},T7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function y0(e,t){var r="",n,i,a=[],s,o,u,f;switch(t){case"dbcs":if(f=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Ma(this,f)),f+=2;e*=2;break;case"utf8":r=du(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ex(this,this.l,this.l+e);break;case"wstr":return y0.call(this,e,"dbcs");case"lpstr-ansi":r=SS(this,this.l),e=4+qn(this,this.l);break;case"lpstr-cp":r=kS(this,this.l),e=4+qn(this,this.l);break;case"lpwstr":r=CS(this,this.l),e=4+2*qn(this,this.l);break;case"lpp4":e=4+qn(this,this.l),r=AS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qn(this,this.l),r=FS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=xl(this,this.l+e++))!==0;)a.push(Df(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=Ma(this,this.l+e))!==0;)a.push(Df(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=xl(this,f),this.l=f+1,o=y0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Df(Ma(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=xl(this,f),this.l=f+1,o=y0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Df(xl(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=xl(this,this.l),this.l++,n;case 2:return n=(t==="i"?C7:Ma)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ho:T7)(this,this.l),this.l+=4,n):(i=qn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=zd(this,this.l):i=zd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=yS(this,this.l,e);break}}return this.l+=e,r}var A7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},P7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},F7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function N7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)F7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,A7(this,t,this.l);break;case 8:if(n=8,r==="f"){E7(this,t,this.l);break}case 16:break;case-4:n=4,P7(this,t,this.l);break}return this.l+=n,this}function IS(e,t){var r=yS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Qr(e,t){e.l=t,e.read_shift=y0,e.chk=IS,e.write_shift=N7}function _n(e,t){e.l+=t}function Fr(e){var t=Ds(e);return Qr(t,0),t}function Ya(e,t,r){if(e){var n,i,a;Qr(e,e.l||0);for(var s=e.length,o=0,u=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=Xd[o]||Xd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,o))return}}}function Am(){var e=[],t=kt?256:2048,r=function(f){var d=Fr(f);return Qr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},s=function(){return i(),vs(e)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function _0(e,t,r){var n=Jr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function i3(e,t,r){var n=Jr(e);return n.s=_0(n.s,t.s,r),n.e=_0(n.e,t.s,r),n}function S0(e,t){if(e.cRel&&e.c<0)for(e=Jr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ct(e);return!e.cRel&&e.cRel!=null&&(r=b7(r)),!e.rRel&&e.rRel!=null&&(r=R7(r)),r}function sg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ir(e.s.c)+":"+(e.e.cRel?"":"$")+Ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zr(e.s.r)+":"+(e.e.rRel?"":"$")+Zr(e.e.r):S0(e.s,t.biff)+":"+S0(e.e,t.biff)}function tx(e){return parseInt(I7(e),10)-1}function Zr(e){return""+(e+1)}function R7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function I7(e){return e.replace(/\$(\d+)$/,"$1")}function rx(e){for(var t=O7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function b7(e){return e.replace(/^([A-Z])/,"$$$1")}function O7(e){return e.replace(/^\$([A-Z])/,"$1")}function D7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function lc(e){var t=e.indexOf(":");return t==-1?{s:Fn(e),e:Fn(e)}:{s:Fn(e.slice(0,t)),e:Fn(e.slice(t+1))}}function At(e,t){return typeof t>"u"||typeof t=="number"?At(e.s,e.e):(typeof e!="string"&&(e=ct(e)),typeof t!="string"&&(t=ct(t)),e==t?e:e+":"+t)}function dr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function a3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Pi(e.z,r?In(t):t)}catch{}try{return e.w=Pi((e.XF||{}).numFmtId||(r?14:0),r?In(t):t)}catch{return""+t}}function Xa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Bo[e.v]||e.v:t==null?a3(e,e.v):a3(e,t))}function Vs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function bS(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Fn(n.origin):n.origin;s=u.r,o=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=dr(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var v={v:t[p][g]},m=s+p,_=o+g;if(f.s.r>m&&(f.s.r=m),f.s.c>_&&(f.s.c=_),f.e.r<m&&(f.e.r=m),f.e.c<_&&(f.e.c=_),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))v=t[p][g];else if(Array.isArray(v.v)&&(v.f=t[p][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ht[14],n.cellDates?(v.t="d",v.w=Pi(v.z,In(v.v))):(v.t="n",v.v=In(v.v),v.w=Pi(v.z,v.v))):v.t="s";if(i)a[m]||(a[m]=[]),a[m][_]&&a[m][_].z&&(v.z=a[m][_].z),a[m][_]=v;else{var C=ct({c:_,r:m});a[C]&&a[C].z&&(v.z=a[C].z),a[C]=v}}}return f.s.c<1e7&&(a["!ref"]=At(f)),a}function cc(e,t){return bS(null,e,t)}function L7(e){return e.read_shift(4,"i")}function vn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function M7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nx(e,t){var r=e.l,n=e.read_shift(1),i=vn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),u=0;u!=o;++u)a.push(M7(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var B7=nx;function Fi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Lo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var j7=vn;function ix(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var U7=vn,Pm=ix;function ax(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?zd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ho(t,0)>>2;return r?i/100:i}function OS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Mo=OS;function mn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function z7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=wo[i];f&&(t.rgb=Z0(f));break;case 2:t.rgb=Z0([s,o,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function V7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function G7(e){return DS(e,1)}function H7(e){return DS(e,2)}var sx=2,zn=3,Mf=11,s3=12,Vd=19,Bf=64,W7=65,$7=71,X7=4108,K7=4126,Gr=80,LS=81,Y7=[Gr,LS],Q7={1:{n:"CodePage",t:sx},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:zn},5:{n:"LineCount",t:zn},6:{n:"ParagraphCount",t:zn},7:{n:"SlideCount",t:zn},8:{n:"NoteCount",t:zn},9:{n:"HiddenCount",t:zn},10:{n:"MultimediaClipCount",t:zn},11:{n:"ScaleCrop",t:Mf},12:{n:"HeadingPairs",t:X7},13:{n:"TitlesOfParts",t:K7},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:Mf},17:{n:"CharacterCount",t:zn},19:{n:"SharedDoc",t:Mf},22:{n:"HyperlinksChanged",t:Mf},23:{n:"AppVersion",t:zn,p:"version"},24:{n:"DigSig",t:W7},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},q7={1:{n:"CodePage",t:sx},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:Bf},11:{n:"LastPrinted",t:Bf},12:{n:"CreatedDate",t:Bf},13:{n:"ModifiedDate",t:Bf},14:{n:"PageCount",t:zn},15:{n:"WordCount",t:zn},16:{n:"CharCount",t:zn},17:{n:"Thumbnail",t:$7},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:zn},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},o3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},J7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Z7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var eT=Z7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wo=Jr(eT),Bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},MS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},l3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function tT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function rT(e){var t=tT();if(!e||!e.match)return t;var r={};if((e.match(Sn)||[]).forEach(function(n){var i=it(n);switch(i[0].replace(u7,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[l3[i.ContentType]]!==void 0&&t[l3[i.ContentType]].push(i.PartName);break}}),t.xmlns!==S7.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Rl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function w0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Sn)||[]).forEach(function(i){var a=it(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:s0(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var nT="application/vnd.oasis.opendocument.spreadsheet";function iT(e,t){for(var r=Z2(e),n,i;n=q0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=it(n[0],!1),i.path=="/"&&i.type!==nT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var k0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],aT=function(){for(var e=new Array(k0.length),t=0;t<k0.length;++t){var r=k0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function BS(e){var t={};e=Xt(e);for(var r=0;r<k0.length;++r){var n=k0[r],i=e.match(aT[r]);i!=null&&i.length>0&&(t[n[1]]=Nt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$r(t[n[1]]))}return t}var sT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function jS(e,t,r,n){var i=[];if(typeof e=="string")i=Jy(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var s=typeof t=="string"?Jy(t,n).map(function(d){return d.v}):t,o=0,u=0;if(s.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=s.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=u,r.DefinedNames=s.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=s.slice(o,o+u);break}o+=u}}function oT(e,t,r){var n={};return t||(t={}),e=Xt(e),sT.forEach(function(i){var a=(e.match(Q0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Nt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&jS(n.HeadingPairs,n.TitlesOfParts,t,r),t}var lT=/<[^>]+>[^<]*/g;function cT(e,t){var r={},n="",i=e.match(lT);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=it(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var u=s.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(d);break;case"bool":r[n]=Zt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=$r(d);break;case"cy":case"error":r[n]=Nt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,u)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var uT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},og;function fT(e,t,r){og||(og=Q2(uT)),t=og[t]||t,e[t]=r}function ox(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function US(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function zS(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function VS(e,t,r){return t===31?zS(e):US(e,t,r)}function Nm(e,t,r){return VS(e,t,r===!1?0:4)}function dT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return VS(e,t,0)}function hT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Rn,""),e.l-i&2&&(e.l+=2)}return r}function pT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Rn,"");return r}function gT(e){var t=e.l,r=Gd(e,LS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Gd(e,zn);return[r,n]}function mT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(gT(e));return r}function c3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Rn,"").replace(a0,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function GS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Gd(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==s3&&n!==t&&Y7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===s3?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return US(e,n,4).replace(Rn,"");case 31:return zS(e);case 64:return ox(e);case 65:return GS(e);case 71:return xT(e);case 80:return Nm(e,n,!a.raw).replace(Rn,"");case 81:return dT(e,n).replace(Rn,"");case 4108:return mT(e);case 4126:case 4127:return n==4127?hT(e):pT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function u3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,u=-1,f={};for(s=0;s!=i;++s){var d=e.read_shift(4),p=e.read_shift(4);a[s]=[d,p+r]}a.sort(function(w,x){return w[1]-x[1]});var g={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var v=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(v=!1,e.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[a[s][0]];if(g[m.n]=Gd(e,m.t,{raw:!0}),m.p==="version"&&(g[m.n]=String(g[m.n]>>16)+"."+("0000"+String(g[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(g[m.n]){case 0:g[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Wi(o=g[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[m.n])}}else if(a[s][0]===1){if(o=g.CodePage=Gd(e,sx),Wi(o),u!==-1){var _=e.l;e.l=a[u][1],f=c3(e,o),e.l=_}}else if(a[s][0]===0){if(o===0){u=s,e.l=a[s+1][1];continue}f=c3(e,o)}else{var C=f[a[s][0]],S;switch(e[e.l]){case 65:e.l+=4,S=GS(e);break;case 30:e.l+=4,S=Nm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Nm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=gr(e,4);break;case 64:e.l+=4,S=$r(ox(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[C]=S}}return e.l=r+n,g}function f3(e,t,r){var n=e.content;if(!n)return{};Qr(n,0);var i,a,s,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==Tt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),u=n.read_shift(4));var p=u3(n,t),g={SystemIdentifier:f};for(var v in p)g[v]=p[v];if(g.FMTID=a,i===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var m;try{m=u3(n,null)}catch{}for(v in m)g[v]=m[v];return g.FMTID=[a,s],g}function us(e,t){return e.read_shift(t),null}function vT(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function gr(e,t){return e.read_shift(t)===1}function wr(e){return e.read_shift(2,"u")}function HS(e,t){return vT(e,t,wr)}function yT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function hu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function _T(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,u={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*s),n&&(e.l+=o),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Ro(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function pu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ro(e,n,r)}function jo(e,t,r){if(r.biff>5)return pu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ST(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function wT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Rn,"");return n&&(e.l+=24),i}function kT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Rn,"");return r+s}function ET(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return wT(e);case"0303000000000000c000000000000046":return kT(e);default:throw new Error("Unsupported Moniker "+r)}}function jf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Rn,""):"";return r}function CT(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,u,f="",d,p;i&16&&(a=jf(e,r-e.l)),i&128&&(s=jf(e,r-e.l)),(i&257)===257&&(o=jf(e,r-e.l)),(i&257)===1&&(u=ET(e,r-e.l)),i&8&&(f=jf(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(p=ox(e)),e.l=r;var g=s||o||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return d&&(v.guid=d),p&&(v.time=p),a&&(v.Tooltip=a),v}function WS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function $S(e,t){var r=WS(e);return r[3]=0,r}function ya(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function TT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function AT(e,t,r){return t===0?"":jo(e,t,r)}function PT(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function XS(e){var t=e.read_shift(2),r=ax(e);return[t,r]}function FT(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=hu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function Eh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function KS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var NT=KS;function YS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function RT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function IT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function dn(e){e.l+=2,e.l+=e.read_shift(2)}var bT={0:dn,4:dn,5:dn,6:dn,7:IT,8:dn,9:dn,10:dn,11:dn,12:dn,13:RT,14:dn,15:dn,16:dn,17:dn,18:dn,19:dn,20:dn,21:YS};function OT(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(bT[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Uf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function DT(e,t){return t===0||e.read_shift(2),1200}function LT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=jo(e,0,r);return e.read_shift(t+n-e.l),i}function MT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function BT(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=hu(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function jT(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(_T(e));return a.Count=n,a.Unique=i,a}function UT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function zT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function VT(e){var t=TT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function GT(e){return e.read_shift(2),e.read_shift(4)}function d3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function HT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:u,TabRatio:f}}function WT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $T(){}function XT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=hu(e,0,r),n}function KT(e){var t=ya(e);return t.isst=e.read_shift(4),t}function YT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ya(e);r.biff==2&&e.l++;var a=pu(e,n-e.l,r);return i.val=a,i}function QT(e,t,r){var n=e.read_shift(2),i=jo(e,0,r);return[n,i]}var qT=jo;function h3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:u}}}function JT(e){var t=e.read_shift(2),r=e.read_shift(2),n=XS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ZT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(XS(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function eA(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function tA(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return i.patternType=J7[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function rA(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=tA(e,t,n.fStyle,r),n}function nA(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function p3(e,t,r){var n=ya(e);(r.biff==2||t==9)&&++e.l;var i=yT(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function iA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ya(e),i=mn(e);return n.val=i,n}var g3=AT;function aA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Ro(e,a),o=[];n>e.l;)o.push(pu(e));return[a,i,s,o]}function m3(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=FT(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var sA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function x3(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Ro(e,s,r);i&32&&(f=sA[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||o===0||!(d>0)?[]:zN(e,d,r,o);return{chKey:a,Name:f,itab:u,rgce:p}}function QS(e,t,r){if(r.biff<8)return oA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(PT(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function oA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=hu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function lA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Ro(e,n,r),s=Ro(e,i,r);return[a,s]}function cA(e,t,r){var n=KS(e);e.l++;var i=e.read_shift(1);return t-=8,[VN(e,t,r),i,n]}function v3(e,t,r){var n=NT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,jN(e,t,r)]}function uA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function fA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=jo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function dA(e,t,r){return fA(e,t,r)}function hA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Eh(e));return r}function pA(e,t,r){if(r&&r.biff<8)return mA(e,t,r);var n=YS(e),i=OT(e,t-22,n[1]);return{cmo:n,ft:i}}var gA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function mA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((gA[n]||_n)(e,t,r)),{cmo:[i,n,a],ft:s}}function xA(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=ST(e,6,r);var o=e.read_shift(2);e.read_shift(2),wr(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=Ro(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function vA(e,t){var r=Eh(e);e.l+=16;var n=CT(e,t-24);return[r,n]}function yA(e,t){e.read_shift(2);var r=Eh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Rn,""),[r,n]}function _A(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=o3[r]||r,r=e.read_shift(2),t[1]=o3[r]||r,t}function SA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($S(e));return r}function wA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($S(e));return r}function kA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function qS(e,t,r){if(!r.cellStyles)return _n(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:s,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function EA(e,t){var r={};return t<32||(e.l+=16,r.header=mn(e),r.footer=mn(e),e.l+=2),r}function CA(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var TA=ya,AA=HS,PA=pu;function FA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function NA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ya(e);++e.l;var i=jo(e,t-7,r);return n.t="str",n.val=i,n}function RA(e){var t=ya(e);++e.l;var r=mn(e);return t.t="n",t.val=r,t}function IA(e){var t=ya(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function bA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function OA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function DA(e,t,r){var n=e.l+t,i=ya(e),a=e.read_shift(2),s=Ro(e,a,r);return e.l=n,i.t="str",i.val=s,i}var LA=[2,3,48,49,131,139,140,245],y3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Q2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ds(1);switch(u.type){case"base64":d=Hi(ni(o));break;case"binary":d=Hi(o);break;case"buffer":case"array":d=o;break}Qr(d,0);var p=d.read_shift(1),g=!!(p&136),v=!1,m=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,C=521;p==2&&(_=d.read_shift(2)),d.l+=3,p!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(C=d.read_shift(2));var S=d.read_shift(2),w=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var x=[],T={},A=Math.min(d.length,p==2?521:C-10-(v?264:0)),N=m?32:11;d.l<A&&d[d.l]!=13;)switch(T={},T.name=xs.utils.decode(w,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,T.type=String.fromCharCode(d.read_shift(1)),p!=2&&!m&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),p==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&x.push(T),p!=2&&(d.l+=m?13:14),T.type){case"B":(!v||T.len!=8)&&u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=C-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=C;var R=0,P=0;for(f[0]=[],P=0;P!=x.length;++P)f[0][P]=x[P].name;for(;_-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,f[++R]=[],P=0,P=0;P!=x.length;++P){var I=d.slice(d.l,d.l+x[P].len);d.l+=x[P].len,Qr(I,0);var b=xs.utils.decode(w,I);switch(x[P].type){case"C":b.trim().length&&(f[R][P]=b.replace(/\s+$/,""));break;case"D":b.length===8?f[R][P]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):f[R][P]=b;break;case"F":f[R][P]=parseFloat(b.trim());break;case"+":case"I":f[R][P]=m?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":f[R][P]=!0;break;case"N":case"F":f[R][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[R][P]="##MEMO##"+(m?parseInt(b.trim(),10):I.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(f[R][P]=+b||0);break;case"@":f[R][P]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[R][P]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[R][P]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[R][P]=-I.read_shift(-8,"f");break;case"B":if(v&&x[P].len==8){f[R][P]=I.read_shift(8,"f");break}case"G":case"P":I.l+=x[P].len;break;case"0":if(x[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[P].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=x,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=cc(r(o,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(o,u){try{return Vs(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var f=u||{};if(+f.codepage>=0&&Wi(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=Am(),p=Mm(o,{header:1,raw:!0,cellDates:!0}),g=p[0],v=p.slice(1),m=o["!cols"]||[],_=0,C=0,S=0,w=1;for(_=0;_<g.length;++_){if(((m[_]||{}).DBF||{}).name){g[_]=m[_].DBF.name,++S;continue}if(g[_]!=null){if(++S,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(C=0;C<1024;++C)if(g.indexOf(g[_]+"_"+C)==-1){g[_]+="_"+C;break}}}}var x=dr(o["!ref"]),T=[],A=[],N=[];for(_=0;_<=x.e.c-x.s.c;++_){var R="",P="",I=0,b=[];for(C=0;C<v.length;++C)v[C][_]!=null&&b.push(v[C][_]);if(b.length==0||g[_]==null){T[_]="?";continue}for(C=0;C<b.length;++C){switch(typeof b[C]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=b[C]instanceof Date?"D":"C";break;default:P="C"}I=Math.max(I,String(b[C]).length),R=R&&R!=P?"C":P}I>250&&(I=250),P=((m[_]||{}).DBF||{}).type,P=="C"&&m[_].DBF.len>I&&(I=m[_].DBF.len),R=="B"&&P=="N"&&(R="N",N[_]=m[_].DBF.dec,I=m[_].DBF.len),A[_]=R=="C"||P=="N"?I:a[R]||0,w+=A[_],T[_]=R}var M=d.next(32);for(M.write_shift(4,318902576),M.write_shift(4,v.length),M.write_shift(2,296+32*S),M.write_shift(2,w),_=0;_<4;++_)M.write_shift(4,0);for(M.write_shift(4,0|(+t[Y6]||3)<<8),_=0,C=0;_<g.length;++_)if(g[_]!=null){var D=d.next(32),Q=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,Q,"sbcs"),D.write_shift(1,T[_]=="?"?"C":T[_],"sbcs"),D.write_shift(4,C),D.write_shift(1,A[_]||a[T[_]]||0),D.write_shift(1,N[_]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),C+=A[_]||a[T[_]]||0}var he=d.next(264);for(he.write_shift(4,13),_=0;_<65;++_)he.write_shift(4,0);for(_=0;_<v.length;++_){var z=d.next(w);for(z.write_shift(1,0),C=0;C<g.length;++C)if(g[C]!=null)switch(T[C]){case"L":z.write_shift(1,v[_][C]==null?63:v[_][C]?84:70);break;case"B":z.write_shift(8,v[_][C]||0,"f");break;case"N":var Z="0";for(typeof v[_][C]=="number"&&(Z=v[_][C].toFixed(N[C]||0)),S=0;S<A[C]-Z.length;++S)z.write_shift(1,32);z.write_shift(1,Z,"sbcs");break;case"D":v[_][C]?(z.write_shift(4,("0000"+v[_][C].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(v[_][C].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+v[_][C].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(v[_][C]!=null?v[_][C]:"").slice(0,A[C]);for(z.write_shift(1,ae,"sbcs"),S=0;S<A[C]-ae.length;++S)z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),MA=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,v){var m=e[v];return typeof m=="number"?Dy(m):m},n=function(g,v,m){var _=v.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return _==59?g:Dy(_)};e["|"]=254;function i(g,v){switch(v.type){case"base64":return a(ni(g),v);case"binary":return a(g,v);case"buffer":return a(kt&&Buffer.isBuffer(g)?g.toString("binary"):Do(g),v);case"array":return a(No(g),v)}throw new Error("Unrecognized type "+v.type)}function a(g,v){var m=g.split(/[\n\r]+/),_=-1,C=-1,S=0,w=0,x=[],T=[],A=null,N={},R=[],P=[],I=[],b=0,M;for(+v.codepage>=0&&Wi(+v.codepage);S!==m.length;++S){b=0;var D=m[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=D.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),he=Q[0],z;if(D.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&T.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ae=!1,ne=!1,K=!1,ce=-1,me=-1;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"A":break;case"X":C=parseInt(Q[w].slice(1))-1,ae=!0;break;case"Y":for(_=parseInt(Q[w].slice(1))-1,ae||(C=0),M=x.length;M<=_;++M)x[M]=[];break;case"K":z=Q[w].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(Qi(z))?isNaN(Zl(z).getDate())||(z=$r(z)):(z=Qi(z),A!==null&&oc(A)&&(z=kh(z))),Z=!0;break;case"E":K=!0;var L=Ul(Q[w].slice(1),{r:_,c:C});x[_][C]=[x[_][C],L];break;case"S":ne=!0,x[_][C]=[x[_][C],"S5S"];break;case"G":break;case"R":ce=parseInt(Q[w].slice(1))-1;break;case"C":me=parseInt(Q[w].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}if(Z&&(x[_][C]&&x[_][C].length==2?x[_][C][0]=z:x[_][C]=z,A=null),ne){if(K)throw new Error("SYLK shared formula cannot have own formula");var ee=ce>-1&&x[ce][me];if(!ee||!ee[1])throw new Error("SYLK shared formula cannot find base");x[_][C][1]=ow(ee[1],{r:_-ce,c:C-me})}break;case"F":var q=0;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"X":C=parseInt(Q[w].slice(1))-1,++q;break;case"Y":for(_=parseInt(Q[w].slice(1))-1,M=x.length;M<=_;++M)x[M]=[];break;case"M":b=parseInt(Q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=T[parseInt(Q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=Q[w].slice(1).split(" "),M=parseInt(I[0],10);M<=parseInt(I[1],10);++M)b=parseInt(I[2],10),P[M-1]=b===0?{hidden:!0}:{wch:b},ec(P[M-1]);break;case"C":C=parseInt(Q[w].slice(1))-1,P[C]||(P[C]={});break;case"R":_=parseInt(Q[w].slice(1))-1,R[_]||(R[_]={}),b>0?(R[_].hpt=b,R[_].hpx=eu(b)):b===0&&(R[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}q<1&&(A=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}}return R.length>0&&(N["!rows"]=R),P.length>0&&(N["!cols"]=P),v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),[x,N]}function s(g,v){var m=i(g,v),_=m[0],C=m[1],S=cc(_,v);return xa(C).forEach(function(w){S[w]=C[w]}),S}function o(g,v){return Vs(s(g,v),v)}function u(g,v,m,_){var C="C;Y"+(m+1)+";X"+(_+1)+";K";switch(g.t){case"n":C+=g.v||0,g.f&&!g.F&&(C+=";E"+kF(g.f,{r:m,c:_}));break;case"b":C+=g.v?"TRUE":"FALSE";break;case"e":C+=g.w||g.v;break;case"d":C+='"'+(g.w||g.v)+'"';break;case"s":C+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function f(g,v){v.forEach(function(m,_){var C="F;W"+(_+1)+" "+(_+1)+" ";m.hidden?C+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Wd(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=$d(m.wpx)),typeof m.wch=="number"&&(C+=Math.round(m.wch))),C.charAt(C.length-1)!=" "&&g.push(C)})}function d(g,v){v.forEach(function(m,_){var C="F;";m.hidden?C+="M0;":m.hpt?C+="M"+20*m.hpt+";":m.hpx&&(C+="M"+20*iw(m.hpx)+";"),C.length>2&&g.push(C+"R"+(_+1))})}function p(g,v){var m=["ID;PWXL;N;E"],_=[],C=dr(g["!ref"]),S,w=Array.isArray(g),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),g["!cols"]&&f(m,g["!cols"]),g["!rows"]&&d(m,g["!rows"]),m.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var T=C.s.r;T<=C.e.r;++T)for(var A=C.s.c;A<=C.e.c;++A){var N=ct({r:T,c:A});S=w?(g[T]||[])[A]:g[N],!(!S||S.v==null&&(!S.f||S.F))&&_.push(u(S,g,T,A))}return m.join(x)+x+_.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),BA=function(){function e(a,s){switch(s.type){case"base64":return t(ni(a),s);case"binary":return t(a,s);case"buffer":return t(kt&&Buffer.isBuffer(a)?a.toString("binary"):Do(a),s);case"array":return t(No(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),u=-1,f=-1,d=0,p=[];d!==o.length;++d){if(o[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var g=o[d].trim().split(","),v=g[0],m=g[1];++d;for(var _=o[d]||"";(_.match(/["]/g)||[]).length&1&&d<o.length-1;)_+=`
`+o[++d];switch(_=_.trim(),+v){case-1:if(_==="BOT"){p[++u]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?p[u][f]=!0:_==="FALSE"?p[u][f]=!1:isNaN(Qi(m))?isNaN(Zl(m).getDate())?p[u][f]=m:p[u][f]=$r(m):p[u][f]=Qi(m),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),p[u][f++]=_!==""?_:null;break}if(_==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(a,s){return cc(e(a,s),s)}function n(a,s){return Vs(r(a,s),s)}var i=function(){var a=function(u,f,d,p,g){u.push(f),u.push(d+","+p),u.push('"'+g.replace(/"/g,'""')+'"')},s=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=dr(u["!ref"]),p,g=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(f,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var _=ct({r:v,c:m});if(p=g?(u[v]||[])[m]:u[_],!p){s(f,1,0,"");continue}switch(p.t){case"n":var C=p.w;!C&&p.v!=null&&(C=p.v),C==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,C,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Pi(p.z||ht[14],In($r(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var S=`\r
`,w=f.join(S);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),jA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var v=p.split(`
`),m=-1,_=-1,C=0,S=[];C!==v.length;++C){var w=v[C].trim().split(":");if(w[0]==="cell"){var x=Fn(w[1]);if(S.length<=x.r)for(m=S.length;m<=x.r;++m)S[m]||(S[m]=[]);switch(m=x.r,_=x.c,w[2]){case"t":S[m][_]=e(w[3]);break;case"v":S[m][_]=+w[3];break;case"vtf":var T=w[w.length-1];case"vtc":switch(w[3]){case"nl":S[m][_]=!!+w[4];break;default:S[m][_]=+w[4];break}w[2]=="vtf"&&(S[m][_]=[S[m][_],T])}}}return g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),S}function n(p,g){return cc(r(p,g),g)}function i(p,g){return Vs(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],m,_="",C=lc(p["!ref"]),S=Array.isArray(p),w=C.s.r;w<=C.e.r;++w)for(var x=C.s.c;x<=C.e.c;++x)if(_=ct({r:w,c:x}),m=S?(p[w]||[])[x]:p[_],!(!m||m.v==null||m.t==="z")){switch(v=["cell",_,"t"],m.t){case"s":case"str":v.push(t(m.v));break;case"n":m.f?(v[2]="vtf",v[3]="n",v[4]=m.v,v[5]=t(m.f)):(v[2]="v",v[3]=m.v);break;case"b":v[2]="vt"+(m.f?"f":"c"),v[3]="nl",v[4]=m.v?"1":"0",v[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=In($r(m.v));v[2]="vtc",v[3]="nd",v[4]=""+T,v[5]=m.w||Pi(m.z||ht[14],T);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(p){return[a,s,o,s,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),J0=function(){function e(d,p,g,v,m){m.raw?p[g][v]=d:d===""||(d==="TRUE"?p[g][v]=!0:d==="FALSE"?p[g][v]=!1:isNaN(Qi(d))?isNaN(Zl(d).getDate())?p[g][v]=d:p[g][v]=$r(d):p[g][v]=Qi(d))}function t(d,p){var g=p||{},v=[];if(!d||d.length===0)return v;for(var m=d.split(/[\r\n]/),_=m.length-1;_>=0&&m[_].length===0;)--_;for(var C=10,S=0,w=0;w<=_;++w)S=m[w].indexOf(" "),S==-1?S=m[w].length:S++,C=Math.max(C,S);for(w=0;w<=_;++w){v[w]=[];var x=0;for(e(m[w].slice(0,C).trim(),v,w,x,g),x=1;x<=(m[w].length-C)/10+1;++x)e(m[w].slice(C+(x-1)*10,C+x*10).trim(),v,w,x,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var p={},g=!1,v=0,m=0;v<d.length;++v)(m=d.charCodeAt(v))==34?g=!g:!g&&m in r&&(p[m]=(p[m]||0)+1);m=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v]);if(!m.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v])}return m.sort(function(_,C){return _[0]-C[0]||n[_[1]]-n[C[1]]}),r[m.pop()[1]]||44}function a(d,p){var g=p||{},v="",m=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):g&&g.FS?v=g.FS:v=i(d.slice(0,1024));var C=0,S=0,w=0,x=0,T=0,A=v.charCodeAt(0),N=!1,R=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=g.dateNF!=null?qC(g.dateNF):null;function b(){var M=d.slice(x,T),D={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)D.t="z";else if(g.raw)D.t="s",D.v=M;else if(M.trim().length===0)D.t="s",D.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(D.t="s",D.v=M.slice(2,-1).replace(/""/g,'"')):CF(M)?(D.t="n",D.f=M.slice(1)):(D.t="s",D.v=M);else if(M=="TRUE")D.t="b",D.v=!0;else if(M=="FALSE")D.t="b",D.v=!1;else if(!isNaN(w=Qi(M)))D.t="n",g.cellText!==!1&&(D.w=M),D.v=w;else if(!isNaN(Zl(M).getDate())||I&&M.match(I)){D.z=g.dateNF||ht[14];var Q=0;I&&M.match(I)&&(M=JC(M,g.dateNF,M.match(I)||[]),Q=1),g.cellDates?(D.t="d",D.v=$r(M,Q)):(D.t="n",D.v=In($r(M,Q))),g.cellText!==!1&&(D.w=Pi(D.z,D.v instanceof Date?In(D.v):D.v)),g.cellNF||delete D.z}else D.t="s",D.v=M;if(D.t=="z"||(g.dense?(m[C]||(m[C]=[]),m[C][S]=D):m[ct({c:S,r:C})]=D),x=T+1,P=d.charCodeAt(x),_.e.c<S&&(_.e.c=S),_.e.r<C&&(_.e.r=C),R==A)++S;else if(S=0,++C,g.sheetRows&&g.sheetRows<=C)return!0}e:for(;T<d.length;++T)switch(R=d.charCodeAt(T)){case 34:P===34&&(N=!N);break;case A:case 10:case 13:if(!N&&b())break e;break}return T-x>0&&b(),m["!ref"]=At(_),m}function s(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,p):cc(t(d,p),p)}function o(d,p){var g="",v=p.type=="string"?[0,0,0,0]:gx(d,p);switch(p.type){case"base64":g=ni(d);break;case"binary":g=d;break;case"buffer":p.codepage==65001?g=d.toString("utf8"):p.codepage&&typeof xs<"u"?g=xs.utils.decode(p.codepage,d):g=kt&&Buffer.isBuffer(d)?d.toString("binary"):Do(d);break;case"array":g=No(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Xt(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=Xt(g):p.type=="binary"&&typeof xs<"u"&&p.codepage&&(g=xs.utils.decode(p.codepage,xs.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?jA.to_sheet(p.type=="string"?g:Xt(g),p):s(g,p)}function u(d,p){return Vs(o(d,p),p)}function f(d){for(var p=[],g=dr(d["!ref"]),v,m=Array.isArray(d),_=g.s.r;_<=g.e.r;++_){for(var C=[],S=g.s.c;S<=g.e.c;++S){var w=ct({r:_,c:S});if(v=m?(d[_]||[])[S]:d[w],!v||v.v==null){C.push("          ");continue}for(var x=(v.w||(Xa(v),v.w)||"").slice(0,10);x.length<10;)x+=" ";C.push(x+(S===0?" ":""))}p.push(C.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}}();function UA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=MA.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return J0.to_workbook(e,t)}}var E0=function(){function e(L,ee,q){if(L){Qr(L,L.l||0);for(var Y=q.Enum||ce;L.l<L.length;){var de=L.read_shift(2),V=Y[de]||Y[65535],ie=L.read_shift(2),ge=L.l+ie,_e=V.f&&V.f(L,ie,q);if(L.l=ge,ee(_e,V,de))return}}}function t(L,ee){switch(ee.type){case"base64":return r(Hi(ni(L)),ee);case"binary":return r(Hi(L),ee);case"buffer":case"array":return r(L,ee)}throw"Unsupported type "+ee.type}function r(L,ee){if(!L)return L;var q=ee||{},Y=q.dense?[]:{},de="Sheet1",V="",ie=0,ge={},_e=[],Me=[],H={s:{r:0,c:0},e:{r:0,c:0}},tt=q.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)q.Enum=ce,e(L,function(be,Ct,Lr){switch(Lr){case 0:q.vers=be,be>=4096&&(q.qpro=!0);break;case 6:H=be;break;case 204:be&&(V=be);break;case 222:V=be;break;case 15:case 51:q.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Lr==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=q.dateNF||ht[14],q.cellDates&&(be[1].t="d",be[1].v=kh(be[1].v))),q.qpro&&be[3]>ie&&(Y["!ref"]=At(H),ge[de]=Y,_e.push(de),Y=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ie=be[3],de=V||"Sheet"+(ie+1),V="");var ye=q.dense?(Y[be[0].r]||[])[be[0].c]:Y[ct(be[0])];if(ye){ye.t=be[1].t,ye.v=be[1].v,be[1].z!=null&&(ye.z=be[1].z),be[1].f!=null&&(ye.f=be[1].f);break}q.dense?(Y[be[0].r]||(Y[be[0].r]=[]),Y[be[0].r][be[0].c]=be[1]):Y[ct(be[0])]=be[1];break}},q);else if(L[2]==26||L[2]==14)q.Enum=me,L[2]==14&&(q.qpro=!0,L.l=0),e(L,function(be,Ct,Lr){switch(Lr){case 204:de=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ie&&(Y["!ref"]=At(H),ge[de]=Y,_e.push(de),Y=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ie=be[3],de="Sheet"+(ie+1)),tt>0&&be[0].r>=tt)break;q.dense?(Y[be[0].r]||(Y[be[0].r]=[]),Y[be[0].r][be[0].c]=be[1]):Y[ct(be[0])]=be[1],H.e.c<be[0].c&&(H.e.c=be[0].c),H.e.r<be[0].r&&(H.e.r=be[0].r);break;case 27:be[14e3]&&(Me[be[14e3][0]]=be[14e3][1]);break;case 1537:Me[be[0]]=be[1],be[0]==ie&&(de=be[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(Y["!ref"]=At(H),ge[V||de]=Y,_e.push(V||de),!Me.length)return{SheetNames:_e,Sheets:ge};for(var nt={},Xe=[],Ze=0;Ze<Me.length;++Ze)ge[_e[Ze]]?(Xe.push(Me[Ze]||_e[Ze]),nt[Me[Ze]]=ge[Me[Ze]]||ge[_e[Ze]]):(Xe.push(Me[Ze]),nt[Me[Ze]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:nt}}function n(L,ee){var q=ee||{};if(+q.codepage>=0&&Wi(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Am(),de=dr(L["!ref"]),V=Array.isArray(L),ie=[];ji(Y,0,a(1030)),ji(Y,6,u(de));for(var ge=Math.min(de.e.r,8191),_e=de.s.r;_e<=ge;++_e)for(var Me=Zr(_e),H=de.s.c;H<=de.e.c;++H){_e===de.s.r&&(ie[H]=Ir(H));var tt=ie[H]+Me,nt=V?(L[_e]||[])[H]:L[tt];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?ji(Y,13,v(_e,H,nt.v)):ji(Y,14,_(_e,H,nt.v));else{var Xe=Xa(nt);ji(Y,15,p(_e,H,Xe.slice(0,239)))}}return ji(Y,1),Y.end()}function i(L,ee){var q=ee||{};if(+q.codepage>=0&&Wi(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Am();ji(Y,0,s(L));for(var de=0,V=0;de<L.SheetNames.length;++de)(L.Sheets[L.SheetNames[de]]||{})["!ref"]&&ji(Y,27,K(L.SheetNames[de],V++));var ie=0;for(de=0;de<L.SheetNames.length;++de){var ge=L.Sheets[L.SheetNames[de]];if(!(!ge||!ge["!ref"])){for(var _e=dr(ge["!ref"]),Me=Array.isArray(ge),H=[],tt=Math.min(_e.e.r,8191),nt=_e.s.r;nt<=tt;++nt)for(var Xe=Zr(nt),Ze=_e.s.c;Ze<=_e.e.c;++Ze){nt===_e.s.r&&(H[Ze]=Ir(Ze));var be=H[Ze]+Xe,Ct=Me?(ge[nt]||[])[Ze]:ge[be];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")ji(Y,23,b(nt,Ze,ie,Ct.v));else{var Lr=Xa(Ct);ji(Y,22,R(nt,Ze,ie,Lr.slice(0,239)))}}++ie}}return ji(Y,1),Y.end()}function a(L){var ee=Fr(2);return ee.write_shift(2,L),ee}function s(L){var ee=Fr(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var q=0,Y=0,de=0,V=0;V<L.SheetNames.length;++V){var ie=L.SheetNames[V],ge=L.Sheets[ie];if(!(!ge||!ge["!ref"])){++de;var _e=lc(ge["!ref"]);q<_e.e.r&&(q=_e.e.r),Y<_e.e.c&&(Y=_e.e.c)}}return q>8191&&(q=8191),ee.write_shift(2,q),ee.write_shift(1,de),ee.write_shift(1,Y),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee}function o(L,ee,q){var Y={s:{c:0,r:0},e:{c:0,r:0}};return ee==8&&q.qpro?(Y.s.c=L.read_shift(1),L.l++,Y.s.r=L.read_shift(2),Y.e.c=L.read_shift(1),L.l++,Y.e.r=L.read_shift(2),Y):(Y.s.c=L.read_shift(2),Y.s.r=L.read_shift(2),ee==12&&q.qpro&&(L.l+=2),Y.e.c=L.read_shift(2),Y.e.r=L.read_shift(2),ee==12&&q.qpro&&(L.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function u(L){var ee=Fr(8);return ee.write_shift(2,L.s.c),ee.write_shift(2,L.s.r),ee.write_shift(2,L.e.c),ee.write_shift(2,L.e.r),ee}function f(L,ee,q){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Y[0].c=L.read_shift(1),Y[3]=L.read_shift(1),Y[0].r=L.read_shift(2),L.l+=2):(Y[2]=L.read_shift(1),Y[0].c=L.read_shift(2),Y[0].r=L.read_shift(2)),Y}function d(L,ee,q){var Y=L.l+ee,de=f(L,ee,q);if(de[1].t="s",q.vers==20768){L.l++;var V=L.read_shift(1);return de[1].v=L.read_shift(V,"utf8"),de}return q.qpro&&L.l++,de[1].v=L.read_shift(Y-L.l,"cstr"),de}function p(L,ee,q){var Y=Fr(7+q.length);Y.write_shift(1,255),Y.write_shift(2,ee),Y.write_shift(2,L),Y.write_shift(1,39);for(var de=0;de<Y.length;++de){var V=q.charCodeAt(de);Y.write_shift(1,V>=128?95:V)}return Y.write_shift(1,0),Y}function g(L,ee,q){var Y=f(L,ee,q);return Y[1].v=L.read_shift(2,"i"),Y}function v(L,ee,q){var Y=Fr(7);return Y.write_shift(1,255),Y.write_shift(2,ee),Y.write_shift(2,L),Y.write_shift(2,q,"i"),Y}function m(L,ee,q){var Y=f(L,ee,q);return Y[1].v=L.read_shift(8,"f"),Y}function _(L,ee,q){var Y=Fr(13);return Y.write_shift(1,255),Y.write_shift(2,ee),Y.write_shift(2,L),Y.write_shift(8,q,"f"),Y}function C(L,ee,q){var Y=L.l+ee,de=f(L,ee,q);if(de[1].v=L.read_shift(8,"f"),q.qpro)L.l=Y;else{var V=L.read_shift(2);T(L.slice(L.l,L.l+V),de),L.l+=V}return de}function S(L,ee,q){var Y=ee&32768;return ee&=-32769,ee=(Y?L:0)+(ee>=8192?ee-16384:ee),(Y?"":"$")+(q?Ir(ee):Zr(ee))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(L,ee){Qr(L,0);for(var q=[],Y=0,de="",V="",ie="",ge="";L.l<L.length;){var _e=L[L.l++];switch(_e){case 0:q.push(L.read_shift(8,"f"));break;case 1:V=S(ee[0].c,L.read_shift(2),!0),de=S(ee[0].r,L.read_shift(2),!1),q.push(V+de);break;case 2:{var Me=S(ee[0].c,L.read_shift(2),!0),H=S(ee[0].r,L.read_shift(2),!1);V=S(ee[0].c,L.read_shift(2),!0),de=S(ee[0].r,L.read_shift(2),!1),q.push(Me+H+":"+V+de)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(L.read_shift(2));break;case 6:{for(var tt="";_e=L[L.l++];)tt+=String.fromCharCode(_e);q.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:ge=q.pop(),ie=q.pop(),q.push(["AND","OR"][_e-20]+"("+ie+","+ge+")");break;default:if(_e<32&&x[_e])ge=q.pop(),ie=q.pop(),q.push(ie+x[_e]+ge);else if(w[_e]){if(Y=w[_e][1],Y==69&&(Y=L[L.l++]),Y>q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+q.join("|")+"|");return}var nt=q.slice(-Y);q.length-=Y,q.push(w[_e][0]+"("+nt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}q.length==1?ee[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function A(L){var ee=[{c:0,r:0},{t:"n",v:0},0];return ee[0].r=L.read_shift(2),ee[3]=L[L.l++],ee[0].c=L[L.l++],ee}function N(L,ee){var q=A(L);return q[1].t="s",q[1].v=L.read_shift(ee-4,"cstr"),q}function R(L,ee,q,Y){var de=Fr(6+Y.length);de.write_shift(2,L),de.write_shift(1,q),de.write_shift(1,ee),de.write_shift(1,39);for(var V=0;V<Y.length;++V){var ie=Y.charCodeAt(V);de.write_shift(1,ie>=128?95:ie)}return de.write_shift(1,0),de}function P(L,ee){var q=A(L);q[1].v=L.read_shift(2);var Y=q[1].v>>1;if(q[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return q[1].v=Y,q}function I(L,ee){var q=A(L),Y=L.read_shift(4),de=L.read_shift(4),V=L.read_shift(2);if(V==65535)return Y===0&&de===3221225472?(q[1].t="e",q[1].v=15):Y===0&&de===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ie=V&32768;return V=(V&32767)-16446,q[1].v=(1-ie*2)*(de*Math.pow(2,V+32)+Y*Math.pow(2,V)),q}function b(L,ee,q,Y){var de=Fr(14);if(de.write_shift(2,L),de.write_shift(1,q),de.write_shift(1,ee),Y==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var V=0,ie=0,ge=0,_e=0;return Y<0&&(V=1,Y=-Y),ie=Math.log2(Y)|0,Y/=Math.pow(2,ie-31),_e=Y>>>0,_e&2147483648||(Y/=2,++ie,_e=Y>>>0),Y-=_e,_e|=2147483648,_e>>>=0,Y*=Math.pow(2,32),ge=Y>>>0,de.write_shift(4,ge),de.write_shift(4,_e),ie+=16383+(V?32768:0),de.write_shift(2,ie),de}function M(L,ee){var q=I(L);return L.l+=ee-14,q}function D(L,ee){var q=A(L),Y=L.read_shift(4);return q[1].v=Y>>6,q}function Q(L,ee){var q=A(L),Y=L.read_shift(8,"f");return q[1].v=Y,q}function he(L,ee){var q=Q(L);return L.l+=ee-10,q}function z(L,ee){return L[L.l+ee-1]==0?L.read_shift(ee,"cstr"):""}function Z(L,ee){var q=L[L.l++];q>ee-1&&(q=ee-1);for(var Y="";Y.length<q;)Y+=String.fromCharCode(L[L.l++]);return Y}function ae(L,ee,q){if(!(!q.qpro||ee<21)){var Y=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var de=L.read_shift(ee-21,"cstr");return[Y,de]}}function ne(L,ee){for(var q={},Y=L.l+ee;L.l<Y;){var de=L.read_shift(2);if(de==14e3){for(q[de]=[0,""],q[de][0]=L.read_shift(2);L[L.l];)q[de][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return q}function K(L,ee){var q=Fr(5+L.length);q.write_shift(2,14e3),q.write_shift(2,ee);for(var Y=0;Y<L.length;++Y){var de=L.charCodeAt(Y);q[q.l++]=de>127?95:de}return q[q.l++]=0,q}var ce={0:{n:"BOF",f:wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function zA(e){var t={},r=e.match(Sn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=it(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=W2[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var VA=function(){var e=Q0("t"),t=Q0("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Nt(s[1])},u=a.match(t);return u&&(o.s=zA(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),GA=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),s.push("</"+u+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),HA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,WA=/<(?:\w+:)?r>/,$A=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(e),r&&(n.h=J2(n.t))):e.match(WA)&&(n.r=Xt(e),n.t=Nt(Xt((e.replace($A,"").match(HA)||[]).join("").replace(Sn,""))),r&&(n.h=GA(VA(n.r)))),n):{t:""}}var XA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KA=/<(?:\w+:)?(?:si|sstItem)>/g,YA=/<\/(?:\w+:)?(?:si|sstItem)>/;function QA(e,t){var r=[],n="";if(!e)return r;var i=e.match(XA);if(i){n=i[2].replace(KA,"").split(YA);for(var a=0;a!=n.length;++a){var s=lx(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=it(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function qA(e){return[e.read_shift(4),e.read_shift(4)]}function JA(e,t){var r=[],n=!1;return Ya(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function JS(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ua(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ZA(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ua(e,4),t.U=Ua(e,4),t.W=Ua(e,4),t}function eP(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function tP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(eP(e));return t}function rP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function nP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ua(e,4),t.U=Ua(e,4),t.W=Ua(e,4),t}function iP(e){var t=nP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ZS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ew(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function aP(e){var t=Ua(e);switch(t.Minor){case 2:return[t.Minor,sP(e)];case 3:return[t.Minor,oP()];case 4:return[t.Minor,lP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function sP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=ZS(e,r),i=ew(e,e.length-e.l);return{t:"Std",h:n,v:i}}function oP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function lP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Sn,function(a){var s=it(a);switch(va(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function cP(e,t){var r={},n=r.EncryptionVersionInfo=Ua(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=ZS(e,i),t-=i,r.EncryptionVerifier=ew(e,t),r}function uP(e){var t={},r=t.EncryptionVersionInfo=Ua(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function fP(e){var t=0,r,n=JS(e),i=n.length+1,a,s,o,u,f;for(r=Ds(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,u=t<<1&32767,f=o|u,t=f^s;return t^52811}var tw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],u=104,f=s.length-1;f>=0;--f)for(var d=s[f],p=0;p!=7;++p)d&64&&(o^=r[u]),d*=2,--u;return o};return function(s){for(var o=JS(s),u=a(o),f=o.length,d=Ds(16),p=0;p!=16;++p)d[p]=0;var g,v,m;for((f&1)===1&&(g=u>>8,d[f]=i(e[0],g),--f,g=u&255,v=o[o.length-1],d[f]=i(v,g));f>0;)--f,g=u>>8,d[f]=i(o[f],g),--f,g=u&255,d[f]=i(o[f],g);for(f=15,m=15-o.length;m>0;)g=u>>8,d[f]=i(e[m],g),--f,--m,g=u&255,d[f]=i(o[f],g),--f,--m;return d}}(),dP=function(e,t,r,n,i){i||(i=t),n||(n=tw(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},hP=function(e){var t=0,r=tw(e);return function(n){var i=dP("",n,t,r);return t=i[1],i[0]}};function pP(e,t,r,n){var i={key:wr(e),verificationBytes:wr(e)};return r.password&&(i.verifier=fP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=hP(r.password)),i}function gP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=uP(e):n.Data=cP(e,t),n}function mP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?gP(e,t-2,n):pP(e,r.biff>=8?t:t-2,r,n),n}var xP=function(){function e(i,a){switch(a.type){case"base64":return t(ni(i),a);case"binary":return t(i,a);case"buffer":return t(kt&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),a);case"array":return t(No(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,v=0,m,_=-1;m=g.exec(d);){switch(m[0]){case"\\cell":var C=d.slice(v,g.lastIndex-m[0].length);if(C[0]==" "&&(C=C.slice(1)),++_,C.length){var S={v:C,t:"s"};Array.isArray(o)?o[p][_]=S:o[ct({r:p,c:_})]=S}break}v=g.lastIndex}_>f.e.c&&(f.e.c=_)}),o["!ref"]=At(f),o}function r(i,a){return Vs(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=dr(i["!ref"]),o,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var p=ct({r:f,c:d});o=u?(i[f]||[])[d]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Xa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function vP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Z0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,u=0,f=i+a;switch(u=s/(f>1?2-f:f),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,u,f/2]}function _P(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,s[0]+=i,s[1]+=u;break;case 1:u=i*(2-o),s[0]+=u,s[1]+=i;break;case 2:u=i*(o-2),s[1]+=i,s[2]+=u;break;case 3:u=i*(4-o),s[1]+=u,s[2]+=i;break;case 4:u=i*(o-4),s[2]+=i,s[0]+=u;break;case 5:u=i*(6-o),s[2]+=u,s[0]+=i;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Hd(e,t){if(t===0)return e;var r=yP(vP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Z0(_P(r))}var rw=6,SP=15,wP=1,Pn=rw;function Wd(e){return Math.floor((e+Math.round(128/Pn)/256)*Pn)}function $d(e){return Math.floor((e-5)/Pn*100+.5)/100}function Rm(e){return Math.round((e*Pn+5)/Pn*256)/256}function lg(e){return Rm($d(Wd(e)))}function cx(e){var t=Math.abs(e-lg(e)),r=Pn;if(t>.005)for(Pn=wP;Pn<SP;++Pn)Math.abs(e-lg(e))<=t&&(t=Math.abs(e-lg(e)),r=Pn);Pn=r}function ec(e){e.width?(e.wpx=Wd(e.width),e.wch=$d(e.wpx),e.MDW=Pn):e.wpx?(e.wch=$d(e.wpx),e.width=Rm(e.wch),e.MDW=Pn):typeof e.wch=="number"&&(e.width=Rm(e.wch),e.wpx=Wd(e.width),e.MDW=Pn),e.customWidth&&delete e.customWidth}var kP=96,nw=kP;function iw(e){return e*96/nw}function eu(e){return e*nw/96}var EP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function CP(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function TP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function AP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Xt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Zt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Zt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Zt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Zt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Zt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Zt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=W2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Zt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=wo[i.color.index];i.color.index==81&&(u=wo[1]),u||(u=wo[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Hd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function PP(e,t,r){t.NumberFmt=[];for(var n=xa(ht),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ht[n[i]];var a=e[0].match(Sn);if(a)for(i=0;i<a.length;++i){var s=it(a[i]);switch(va(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Nt(Xt(s.formatCode)),u=parseInt(s.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}So(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var zf=["numFmtId","fillId","fontId","borderId","xfId"],Vf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function FP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Sn)||[]).forEach(function(a){var s=it(a),o=0;switch(va(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<zf.length;++o)n[zf[o]]&&(n[zf[o]]=parseInt(n[zf[o]],10));for(o=0;o<Vf.length;++o)n[Vf[o]]&&(n[Vf[o]]=Zt(n[Vf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};s.vertical&&(u.vertical=s.vertical),s.horizontal&&(u.horizontal=s.horizontal),s.textRotation!=null&&(u.textRotation=s.textRotation),s.indent&&(u.indent=s.indent),s.wrapText&&(u.wrapText=Zt(s.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var NP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&PP(p,d,f),(p=o.match(i))&&AP(p,d,u,f),(p=o.match(n))&&TP(p,d,u,f),(p=o.match(a))&&CP(p,d,u,f),(p=o.match(r))&&FP(p,d,f),d}}();function RP(e,t){var r=e.read_shift(2),n=vn(e);return[r,n]}function IP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=V7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=z7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vn(e),n}var bP=_n;function OP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var DP=_n;function LP(e,t,r){var n={};n.NumberFmt=[];for(var i in ht)n.NumberFmt[i]=ht[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return Ya(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],So(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Hd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var MP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function BP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Sn)||[]).forEach(function(i){var a=it(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[MP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function jP(){}function UP(){}var zP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,VP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,GP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function HP(e,t,r){t.themeElements={};var n;[["clrScheme",zP,BP],["fontScheme",VP,jP],["fmtScheme",GP,UP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var WP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function aw(e,t){(!e||e.length===0)&&(e=$P());var r,n={};if(!(r=e.match(WP)))throw new Error("themeElements not found in theme");return HP(r[0],n,t),n.raw=e,n}function $P(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[mS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function XP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=gS(a,{type:"array"})}catch{return}var o=Jn(s,"theme/theme/theme1.xml",!0);if(o)return aw(o,r)}}function KP(e){return e.read_shift(4)}function YP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=QP(e,4);break;case 2:t.xclrValue=WS(e);break;case 3:t.xclrValue=KP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function QP(e,t){return _n(e,t)}function qP(e,t){return _n(e,t)}function JP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=YP(e);break;case 6:n[1]=qP(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function ZP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(JP(e,r-e.l));return{ixfe:n,ext:a}}function eF(e,t){t.forEach(function(r){switch(r[0]){}})}function tF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:vn(e)}}function rF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function nF(e){return e.l+=4,e.read_shift(4)!=0}function iF(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return Ya(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!f.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function aF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(Sn,function(o){var u=it(o);switch(va(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function sF(e){var t=[];if(!e)return t;var r=1;return(e.match(Sn)||[]).forEach(function(n){var i=it(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function oF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ct(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function lF(e,t,r){var n=[];return Ya(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function cF(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Ya(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function uF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function _3(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=Fn(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var u=dr(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=At(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}a.c.push(d)})}function fF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=it(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Fn(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&lx(p[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function dF(e,t){var r=[],n=!1,i={},a=0;return e.replace(Sn,function(o,u){var f=it(o);switch(va(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+o.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function hF(e,t){var r=[],n=!1;return e.replace(Sn,function(a){var s=it(a);switch(va(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function pF(e){var t={};t.iauthor=e.read_shift(4);var r=Mo(e);return t.rfx=r.s,t.ref=ct(r.s),e.l+=16,t}var gF=vn;function mF(e,t){var r=[],n=[],i={},a=!1;return Ya(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var xF="application/vnd.ms-office.vbaProject";function vF(e){var t=Tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Tt.write(t)}function yF(){return{"!type":"dialog"}}function _F(){return{"!type":"dialog"}}function SF(){return{"!type":"macro"}}function wF(){return{"!type":"macro"}}var Ul=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,i+(o?"":"$")+Ir(d)+(u?"":"$")+Zr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),sw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kF=function(){return function(t,r){return t.replace(sw,function(n,i,a,s,o,u){var f=rx(s)-(a?0:r.c),d=tx(u)-(o?0:r.r),p=d==0?"":o?d+1:"["+d+"]",g=f==0?"":a?f+1:"["+f+"]";return i+"R"+p+"C"+g})}}();function ow(e,t){return e.replace(sw,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Ir(rx(a)+t.c))+(s=="$"?s+o:Zr(tx(o)+t.r))})}function EF(e,t,r){var n=lc(t),i=n.s,a=Fn(r),s={r:a.r-i.r,c:a.c-i.c};return ow(e,s)}function CF(e){return e.length!=1}function S3(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function Ls(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function lw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return cw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=Ls(e,2),o=Ls(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function cw(e){var t=Ls(e,2),r=Ls(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function TF(e,t,r){if(r.biff<8)return cw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Ls(e,2),s=Ls(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function uw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return AF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Ls(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function AF(e){var t=Ls(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function PF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function FF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return NF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function NF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function RF(e,t,r){var n=(e[e.l++]&96)>>5,i=lw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function IF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=lw(e,a,r);return[n,i,s]}function bF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function OF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function DF(e,t,r){var n=(e[e.l++]&96)>>5,i=TF(e,t-1,r);return[n,i]}function LF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function w3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function MF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function BF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function jF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function UF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function zF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function fw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function VF(e){return e.read_shift(2),fw(e)}function GF(e){return e.read_shift(2),fw(e)}function HF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=uw(e,0,r);return[n,i]}function WF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=FF(e,0,r);return[n,i]}function $F(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=uw(e,0,r);return[n,i,a]}function XF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[KN[i],pw[i],n]}function KF(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:YF(e);return[i,(a[0]===0?pw:XN)[a[1]]]}function YF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function QF(e,t,r){e.l+=r&&r.biff==2?3:4}function qF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function JF(e){return e.l++,Bo[e.read_shift(1)]}function ZF(e){return e.l++,e.read_shift(2)}function eN(e){return e.l++,e.read_shift(1)!==0}function tN(e){return e.l++,mn(e)}function rN(e,t,r){return e.l++,hu(e,t-1,r)}function nN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Bo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=mn(e);break;case 2:r[1]=jo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function iN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Mo:Eh)(e));return i}function aN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=nN(e,r.biff);return s}function sN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function oN(e,t,r){if(r.biff==5)return lN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function lN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function cN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function uN(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function fN(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function dN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var hN=_n,pN=_n,gN=_n;function gu(e,t,r){return e.l+=2,[PF(e)]}function ux(e){return e.l+=6,[]}var mN=gu,xN=ux,vN=ux,yN=gu;function dw(e){return e.l+=2,[wr(e),e.read_shift(2)&1]}var _N=gu,SN=dw,wN=ux,kN=gu,EN=gu,CN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function TN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=CN[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function AN(e){return e.l+=2,[e.read_shift(4)]}function PN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function FN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function NN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function RN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IN(e){return e.l+=4,[0,0]}var k3={1:{n:"PtgExp",f:qF},2:{n:"PtgTbl",f:gN},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:rN},26:{n:"PtgSheet",f:PN},27:{n:"PtgEndSheet",f:FN},28:{n:"PtgErr",f:JF},29:{n:"PtgBool",f:eN},30:{n:"PtgInt",f:ZF},31:{n:"PtgNum",f:tN},32:{n:"PtgArray",f:LF},33:{n:"PtgFunc",f:XF},34:{n:"PtgFuncVar",f:KF},35:{n:"PtgName",f:sN},36:{n:"PtgRef",f:HF},37:{n:"PtgArea",f:RF},38:{n:"PtgMemArea",f:cN},39:{n:"PtgMemErr",f:hN},40:{n:"PtgMemNoMem",f:pN},41:{n:"PtgMemFunc",f:uN},42:{n:"PtgRefErr",f:fN},43:{n:"PtgAreaErr",f:bF},44:{n:"PtgRefN",f:WF},45:{n:"PtgAreaN",f:DF},46:{n:"PtgMemAreaN",f:NN},47:{n:"PtgMemNoMemN",f:RN},57:{n:"PtgNameX",f:oN},58:{n:"PtgRef3d",f:$F},59:{n:"PtgArea3d",f:IF},60:{n:"PtgRefErr3d",f:dN},61:{n:"PtgAreaErr3d",f:OF},255:{}},bN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ON={1:{n:"PtgElfLel",f:dw},2:{n:"PtgElfRw",f:kN},3:{n:"PtgElfCol",f:mN},6:{n:"PtgElfRwV",f:EN},7:{n:"PtgElfColV",f:yN},10:{n:"PtgElfRadical",f:_N},11:{n:"PtgElfRadicalS",f:wN},13:{n:"PtgElfColS",f:xN},15:{n:"PtgElfColSV",f:vN},16:{n:"PtgElfRadicalLel",f:SN},25:{n:"PtgList",f:TN},29:{n:"PtgSxName",f:AN},255:{}},DN={0:{n:"PtgAttrNoop",f:IN},1:{n:"PtgAttrSemi",f:zF},2:{n:"PtgAttrIf",f:jF},4:{n:"PtgAttrChoose",f:MF},8:{n:"PtgAttrGoto",f:BF},16:{n:"PtgAttrSum",f:QF},32:{n:"PtgAttrBaxcel",f:w3},33:{n:"PtgAttrBaxcel",f:w3},64:{n:"PtgAttrSpace",f:VF},65:{n:"PtgAttrSpaceSemi",f:GF},128:{n:"PtgAttrIfError",f:UF},255:{}};function mu(e,t,r,n){if(n.biff<8)return _n(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=aN(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=iN(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(_n(e,t)),a}function xu(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=k3[a]||k3[bN[a]],(a===24||a===25)&&(i=(a===24?ON:DN)[e[e.l+1]]),!i||!i.f?_n(e,t):s.push([i.n,i.f(e,t,r)]);return s}function LN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var MN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function hw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function E3(e,t,r){var n=hw(e,t,r);return n=="#REF"?n:BN(n,r)}function pn(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],u,f,d,p=0,g=0,v,m="";if(!e[0]||!e[0][0])return"";for(var _=-1,C="",S=0,w=e[0].length;S<w;++S){var x=e[0][S];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),_>=0){switch(e[0][_][1][0]){case 0:C=ur(" ",e[0][_][1][1]);break;case 1:C=ur("\r",e[0][_][1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}f=f+C,_=-1}o.push(f+MN[x[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_0(x[1][1],s,i),o.push(S0(d,a));break;case"PtgRefN":d=r?_0(x[1][1],r,i):x[1][1],o.push(S0(d,a));break;case"PtgRef3d":p=x[1][1],d=_0(x[1][2],s,i),m=E3(n,p,i),o.push(m+"!"+S0(d,a));break;case"PtgFunc":case"PtgFuncVar":var T=x[1][0],A=x[1][1];T||(T=0),T&=127;var N=T==0?[]:o.slice(-T);o.length-=T,A==="User"&&(A=N.shift()),o.push(A+"("+N.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":v=i3(x[1][1],r?{s:r}:s,i),o.push(sg(v,i));break;case"PtgArea":v=i3(x[1][1],s,i),o.push(sg(v,i));break;case"PtgArea3d":p=x[1][1],v=x[1][2],m=E3(n,p,i),o.push(m+"!"+sg(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=x[1][2];var R=(n.names||[])[g-1]||(n[0]||[])[g],P=R?R.Name:"SH33TJSNAME"+String(g);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var I=x[1][1];g=x[1][2];var b;if(i.biff<=5)I<0&&(I=-I),n[I]&&(b=n[I][g]);else{var M="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][g]&&n[I][g].itab>0&&(M=n.SheetNames[n[I][g].itab-1]+"!"):M=n.SheetNames[g-1]+"!"),n[I]&&n[I][g])M+=n[I][g].Name;else if(n[0]&&n[0][g])M+=n[0][g].Name;else{var D=(hw(n,I,i)||"").split(";;");D[g-1]?M=D[g-1]:M+="SH33TJSERRX"}o.push(M);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var Q="(",he=")";if(_>=0){switch(C="",e[0][_][1][0]){case 2:Q=ur(" ",e[0][_][1][1])+Q;break;case 3:Q=ur("\r",e[0][_][1][1])+Q;break;case 4:he=ur(" ",e[0][_][1][1])+he;break;case 5:he=ur("\r",e[0][_][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}o.push(Q+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var z={c:r.c,r:r.r};if(n.sharedf[ct(d)]){var Z=n.sharedf[ct(d)];o.push(pn(Z,s,z,n,i))}else{var ae=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(pn(f[1],s,z,n,i)),ae=!0;break}ae||o.push(x[1])}break;case"PtgArray":o.push("{"+LN(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ne.indexOf(e[0][S][0])==-1){x=e[0][_];var K=!0;switch(x[1][0]){case 4:K=!1;case 0:C=ur(" ",x[1][1]);break;case 5:K=!1;case 1:C=ur("\r",x[1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((K?C:"")+o.pop()+(K?"":C)),_=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function jN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],_n(e,t-2)];var o=xu(e,s,r);return t!==s+i&&(a=mu(e,t-s-i,o,r)),e.l=n,[o,a]}function UN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],_n(e,t-2)];var o=xu(e,s,r);return t!==s+i&&(a=mu(e,t-s-i,o,r)),e.l=n,[o,a]}function zN(e,t,r,n){var i=e.l+t,a=xu(e,n,r),s;return i!==e.l&&(s=mu(e,i-e.l,a,r)),[a,s]}function VN(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=xu(e,a,r);return a==65535?[[],_n(e,t-2)]:(t!==a+2&&(i=mu(e,n-a-2,s,r)),[s,i])}function GN(e){var t;if(Ma(e,e.l+6)!==65535)return[mn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function cg(e,t,r){var n=e.l+t,i=ya(e);r.biff==2&&++e.l;var a=GN(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=UN(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function Ch(e,t,r){var n=e.read_shift(4),i=xu(e,n,r),a=e.read_shift(4),s=a>0?mu(e,a,i,r):null;return[i,s]}var HN=Ch,Th=Ch,WN=Ch,$N=Ch,XN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},pw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},KN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function C3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ug(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var C0={},zl={};function T0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function gw(e,t,r,n,i,a){try{n.cellNF&&(e.z=ht[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ht[t]==null&&So(QC[t]||"General",t),e.t==="e")e.w=e.w||Bo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v);else if(e.t==="d"){var s=In(e.v);(s|0)===s?e.w=s.toString(10):e.w=Y0(s)}else{if(e.v===void 0)return"";e.w=Fo(e.v,zl)}else e.t==="d"?e.w=Pi(t,In(e.v),zl):e.w=Pi(t,e.v,zl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Hd(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Hd(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function YN(e,t){var r=dr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=At(r))}var QN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qN=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,JN=/<(?:\w:)?hyperlink [^>]*>/mg,ZN=/"(\w*:\w*)"/,eR=/<(?:\w:)?col\b[^>]*[\/]?>/g,tR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,rR=/<(?:\w:)?pageMargins[^>]*\/>/g,mw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nR=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,iR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aR(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match(qN);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var g=f.match(mw);g?fx(g[0],o,i,r):(g=f.match(nR))&&sR(g[0],g[1]||"",o,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var m=f.slice(v,v+50).match(ZN);m&&YN(o,m[1])}var _=f.match(iR);_&&_[1]&&dR(_[1],i);var C=[];if(t.cellStyles){var S=f.match(eR);S&&cR(C,S)}p&&hR(p[1],o,t,u,a,s);var w=d.match(tR);w&&(o["!autofilter"]=uR(w[0]));var x=[],T=d.match(QN);if(T)for(v=0;v!=T.length;++v)x[v]=dr(T[v].slice(T[v].indexOf('"')+1));var A=d.match(JN);A&&oR(o,A,n);var N=d.match(rR);if(N&&(o["!margins"]=lR(it(N[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=At(u)),t.sheetRows>0&&o["!ref"]){var R=dr(o["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>u.e.r&&(R.e.r=u.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>u.e.c&&(R.e.c=u.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),o["!fullref"]=o["!ref"],o["!ref"]=At(R))}return C.length>0&&(o["!cols"]=C),x.length>0&&(o["!merges"]=x),o}function fx(e,t,r,n){var i=it(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Xt(i.codeName)))}function sR(e,t,r,n,i){fx(e.slice(0,e.indexOf(">")),r,n,i)}function oR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=it(Xt(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Nt(a.location))):(a.Target="#"+Nt(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=dr(a.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=ct({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function lR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function cR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=it(t[n],!0);i.hidden&&(i.hidden=Zt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,cx(i.width)),ec(i);a<=s;)e[a++]=Jr(i)}}function uR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var fR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function dR(e,t){t.Views||(t.Views=[{}]),(e.match(fR)||[]).forEach(function(r,n){var i=it(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Zt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var hR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Q0("v"),s=Q0("f");return function(u,f,d,p,g,v){for(var m=0,_="",C=[],S=[],w=0,x=0,T=0,A="",N,R,P=0,I=0,b,M,D=0,Q=0,he=Array.isArray(v.CellXf),z,Z=[],ae=[],ne=Array.isArray(f),K=[],ce={},me=!1,L=!!d.sheetStubs,ee=u.split(t),q=0,Y=ee.length;q!=Y;++q){_=ee[q].trim();var de=_.length;if(de!==0){var V=0;e:for(m=0;m<de;++m)switch(_[m]){case">":if(_[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(R=it(_.slice(V,m),!0),P=R.r!=null?parseInt(R.r,10):P+1,I=-1,d.sheetRows&&d.sheetRows<P)continue;ce={},me=!1,R.ht&&(me=!0,ce.hpt=parseFloat(R.ht),ce.hpx=eu(ce.hpt)),R.hidden=="1"&&(me=!0,ce.hidden=!0),R.outlineLevel!=null&&(me=!0,ce.level=+R.outlineLevel),me&&(K[P-1]=ce)}break;case"<":V=m;break}if(V>=m)break;if(R=it(_.slice(V,m),!0),P=R.r!=null?parseInt(R.r,10):P+1,I=-1,!(d.sheetRows&&d.sheetRows<P)){p.s.r>P-1&&(p.s.r=P-1),p.e.r<P-1&&(p.e.r=P-1),d&&d.cellStyles&&(ce={},me=!1,R.ht&&(me=!0,ce.hpt=parseFloat(R.ht),ce.hpx=eu(ce.hpt)),R.hidden=="1"&&(me=!0,ce.hidden=!0),R.outlineLevel!=null&&(me=!0,ce.level=+R.outlineLevel),me&&(K[P-1]=ce)),C=_.slice(m).split(e);for(var ie=0;ie!=C.length&&C[ie].trim().charAt(0)=="<";++ie);for(C=C.slice(ie),m=0;m!=C.length;++m)if(_=C[m].trim(),_.length!==0){if(S=_.match(r),w=m,x=0,T=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,S!=null&&S.length===2){for(w=0,A=S[1],x=0;x!=A.length&&!((T=A.charCodeAt(x)-64)<1||T>26);++x)w=26*w+T;--w,I=w}else++I;for(x=0;x!=_.length&&_.charCodeAt(x)!==62;++x);if(++x,R=it(_.slice(0,x),!0),R.r||(R.r=ct({r:P-1,c:I})),A=_.slice(x),N={t:""},(S=A.match(a))!=null&&S[1]!==""&&(N.v=Nt(S[1])),d.cellFormula){if((S=A.match(s))!=null&&S[1]!==""){if(N.f=Nt(Xt(S[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=S3(N.f)),S[0].indexOf('t="array"')>-1)N.F=(A.match(i)||[])[1],N.F.indexOf(":")>-1&&Z.push([dr(N.F),N.F]);else if(S[0].indexOf('t="shared"')>-1){M=it(S[0]);var ge=Nt(Xt(S[1]));d.xlfn||(ge=S3(ge)),ae[parseInt(M.si,10)]=[M,ge,R.r]}}else(S=A.match(/<f[^>]*\/>/))&&(M=it(S[0]),ae[M.si]&&(N.f=EF(ae[M.si][1],ae[M.si][2],R.r)));var _e=Fn(R.r);for(x=0;x<Z.length;++x)_e.r>=Z[x][0].s.r&&_e.r<=Z[x][0].e.r&&_e.c>=Z[x][0].s.c&&_e.c<=Z[x][0].e.c&&(N.F=Z[x][1])}if(R.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(L)N.t="z";else continue;else N.t=R.t||"n";switch(p.s.c>I&&(p.s.c=I),p.e.c<I&&(p.e.c=I),N.t){case"n":if(N.v==""||N.v==null){if(!L)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!L)continue;N.t="z"}else b=C0[parseInt(N.v,10)],N.v=b.t,N.r=b.r,d.cellHTML&&(N.h=b.h);break;case"str":N.t="s",N.v=N.v!=null?Xt(N.v):"",d.cellHTML&&(N.h=J2(N.v));break;case"inlineStr":S=A.match(n),N.t="s",S!=null&&(b=lx(S[1]))?(N.v=b.t,d.cellHTML&&(N.h=b.h)):N.v="";break;case"b":N.v=Zt(N.v);break;case"d":d.cellDates?N.v=$r(N.v,1):(N.v=In($r(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=MS[N.v];break}if(D=Q=0,z=null,he&&R.s!==void 0&&(z=v.CellXf[R.s],z!=null&&(z.numFmtId!=null&&(D=z.numFmtId),d.cellStyles&&z.fillId!=null&&(Q=z.fillId))),gw(N,D,Q,d,g,v),d.cellDates&&he&&N.t=="n"&&oc(ht[D])&&(N.t="d",N.v=kh(N.v)),R.cm&&d.xlmeta){var Me=(d.xlmeta.Cell||[])[+R.cm-1];Me&&Me.type=="XLDAPR"&&(N.D=!0)}if(ne){var H=Fn(R.r);f[H.r]||(f[H.r]=[]),f[H.r][H.c]=N}else f[R.r]=N}}}}K.length>0&&(f["!rows"]=K)}}();function pR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var gR=Mo;function mR(){}function xR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=j7(e),r}function vR(e){var t=Fi(e);return[t]}function yR(e){var t=Lo(e);return[t]}function _R(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"b"]}function SR(e){var t=Lo(e),r=e.read_shift(1);return[t,r,"b"]}function wR(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"e"]}function kR(e){var t=Lo(e),r=e.read_shift(1);return[t,r,"e"]}function ER(e){var t=Fi(e),r=e.read_shift(4);return[t,r,"s"]}function CR(e){var t=Lo(e),r=e.read_shift(4);return[t,r,"s"]}function TR(e){var t=Fi(e),r=mn(e);return[t,r,"n"]}function xw(e){var t=Lo(e),r=mn(e);return[t,r,"n"]}function AR(e){var t=Fi(e),r=ax(e);return[t,r,"n"]}function PR(e){var t=Lo(e),r=ax(e);return[t,r,"n"]}function FR(e){var t=Fi(e),r=nx(e);return[t,r,"is"]}function NR(e){var t=Fi(e),r=vn(e);return[t,r,"str"]}function RR(e){var t=Lo(e),r=vn(e);return[t,r,"str"]}function IR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function bR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function OR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=mn(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function DR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=vn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}var LR=Mo;function MR(e,t){var r=e.l+t,n=Mo(e),i=ix(e),a=vn(e),s=vn(e),o=vn(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:o};return s&&(u.Tooltip=s),u}function BR(){}function jR(e,t,r){var n=e.l+t,i=OS(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=HN(e,n-e.l,r);s[1]=o}else e.l=n;return s}function UR(e,t,r){var n=e.l+t,i=Mo(e),a=[i];if(r.cellFormula){var s=$N(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}var zR=["left","right","top","bottom","header","footer"];function VR(e){var t={};return zR.forEach(function(r){t[r]=mn(e)}),t}function GR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HR(){}function WR(){}function $R(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,v,m,_,C,S,w,x,T,A,N=[];o.biff=12,o["!row"]=0;var R=0,P=!1,I=[],b={},M=o.supbooks||i.supbooks||[[]];if(M.sharedf=b,M.arrayf=I,M.SheetNames=i.SheetNames||i.Sheets.map(function(ne){return ne.name}),!o.supbooks&&(o.supbooks=M,i.Names))for(var D=0;D<i.Names.length;++D)M[0][D+1]=i.Names[D];var Q=[],he=[],z=!1;Xd[16]={n:"BrtShortReal",f:xw};var Z;if(Ya(e,function(K,ce,me){if(!g)switch(me){case 148:f=K;break;case 0:v=K,o.sheetRows&&o.sheetRows<=v.r&&(g=!0),T=Zr(C=v.r),o["!row"]=v.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=eu(K.hpt)),he[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:K[2]},K[2]){case"n":m.v=K[1];break;case"s":x=C0[K[1]],m.v=x.t,m.r=x.r;break;case"b":m.v=!!K[1];break;case"e":m.v=K[1],o.cellText!==!1&&(m.w=Bo[m.v]);break;case"str":m.t="s",m.v=K[1];break;case"is":m.t="s",m.v=K[1].t;break}if((_=s.CellXf[K[0].iStyleRef])&&gw(m,_.numFmtId,null,o,a,s),S=K[0].c==-1?S+1:K[0].c,o.dense?(u[C]||(u[C]=[]),u[C][S]=m):u[Ir(S)+T]=m,o.cellFormula){for(P=!1,R=0;R<I.length;++R){var L=I[R];v.r>=L[0].s.r&&v.r<=L[0].e.r&&S>=L[0].s.c&&S<=L[0].e.c&&(m.F=At(L[0]),P=!0)}!P&&K.length>3&&(m.f=K[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>S&&(d.s.c=S),d.e.r<v.r&&(d.e.r=v.r),d.e.c<S&&(d.e.c=S),o.cellDates&&_&&m.t=="n"&&oc(ht[_.numFmtId])){var ee=xo(m.v);ee&&(m.t="d",m.v=new Date(ee.y,ee.m-1,ee.d,ee.H,ee.M,ee.S,ee.u))}Z&&(Z.type=="XLDAPR"&&(m.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;m={t:"z",v:void 0},S=K[0].c==-1?S+1:K[0].c,o.dense?(u[C]||(u[C]=[]),u[C][S]=m):u[Ir(S)+T]=m,d.s.r>v.r&&(d.s.r=v.r),d.s.c>S&&(d.s.c=S),d.e.r<v.r&&(d.e.r=v.r),d.e.c<S&&(d.e.c=S),Z&&(Z.type=="XLDAPR"&&(m.D=!0),Z=void 0);break;case 176:N.push(K);break;case 49:Z=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var q=n["!id"][K.relId];for(q?(K.Target=q.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=q):K.relId==""&&(K.Target="#"+K.loc),C=K.rfx.s.r;C<=K.rfx.e.r;++C)for(S=K.rfx.s.c;S<=K.rfx.e.c;++S)o.dense?(u[C]||(u[C]=[]),u[C][S]||(u[C][S]={t:"z",v:void 0}),u[C][S].l=K):(w=ct({c:S,r:C}),u[w]||(u[w]={t:"z",v:void 0}),u[w].l=K);break;case 426:if(!o.cellFormula)break;I.push(K),A=o.dense?u[C][S]:u[Ir(S)+T],A.f=pn(K[1],d,{r:v.r,c:S},M,o),A.F=At(K[0]);break;case 427:if(!o.cellFormula)break;b[ct(K[0].s)]=K[1],A=o.dense?u[C][S]:u[Ir(S)+T],A.f=pn(K[1],d,{r:v.r,c:S},M,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)Q[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},z||(z=!0,cx(K.w/256)),ec(Q[K.e+1]);break;case 161:u["!autofilter"]={ref:At(K)};break;case 476:u["!margins"]=K;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),K.name&&(i.Sheets[r].CodeName=K.name),(K.above||K.left)&&(u["!outline"]={above:K.above,left:K.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),K.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!ce.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=At(f||d)),o.sheetRows&&u["!ref"]){var ae=dr(u["!ref"]);o.sheetRows<=+ae.e.r&&(ae.e.r=o.sheetRows-1,ae.e.r>d.e.r&&(ae.e.r=d.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>d.e.c&&(ae.e.c=d.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),u["!fullref"]=u["!ref"],u["!ref"]=At(ae))}return N.length>0&&(u["!merges"]=N),Q.length>0&&(u["!cols"]=Q),he.length>0&&(u["!rows"]=he),u}function XR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function KR(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=XR(p);d.s.r=d.s.c=0,d.e.c=o,f=Ir(o),g[0].forEach(function(v,m){s[f+Zr(m)]={t:"n",v,z:g[1]},u=m}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(s["!ref"]=At(d)),s}function YR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(mw);return o&&fx(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function QR(e,t){e.l+=10;var r=vn(e);return{name:r}}function qR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Ya(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var vw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZR=[],eI=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function T3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Zt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function A3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Zt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function yw(e){A3(e.WBProps,vw),A3(e.CalcPr,eI),T3(e.WBView,JR),T3(e.Sheets,ZR),zl.date1904=Zt(e.WBProps.date1904)}var tI="][*?/\\".split("");function rI(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return tI.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var nI=/<\w+:workbook/;function iI(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(Sn,function(u,f){var d=it(u);switch(va(d[0])){case"<?xml":break;case"<workbook":u.match(nI)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vw.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Zt(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=Xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Nt(Xt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Xt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Zt(d.hidden||"0")&&(a.Hidden=!0),s=f+u.length;break;case"</definedName>":a.Ref=Nt(Xt(e.slice(s,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),w7.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return yw(r),r}function aI(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pm(e),r.name=vn(e),r}function sI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?vn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function oI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function lI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=U7(e),s=WN(e,0,r),o=ix(e);e.l=n;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function cI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Xd[16]={n:"BrtFRTArchID$",f:oI},Ya(e,function(u,f,d){switch(d){case 156:s.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=pn(u.Ptg,null,null,s,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,u]):s[0]=[d,u],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(u),s.XTI=s.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),yw(r),r.Names=a,r.supbooks=s,r}function uI(e,t,r){return t.slice(-4)===".bin"?cI(e,r):iI(e,r)}function fI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?$R(e,n,r,i,a,s,o):aR(e,n,r,i,a,s,o)}function dI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?qR(e,n,r,i,a):YR(e,n,r,i,a)}function hI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?SF():wF()}function pI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?yF():_F()}function gI(e,t,r,n){return t.slice(-4)===".bin"?LP(e,r,n):NP(e,r,n)}function mI(e,t,r){return aw(e,r)}function xI(e,t,r){return t.slice(-4)===".bin"?JA(e,r):QA(e,r)}function vI(e,t,r){return t.slice(-4)===".bin"?mF(e,r):fF(e,r)}function yI(e,t,r){return t.slice(-4)===".bin"?lF(e):sF(e)}function _I(e,t,r,n){return r.slice(-4)===".bin"?cF(e,t,r,n):void 0}function SI(e,t,r){return t.slice(-4)===".bin"?iF(e,t,r):aF(e,t,r)}var _w=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Sw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(_w),a,s,o,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(Sw),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function wI(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(_w),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Sw),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var A0;function kI(e,t){var r=A0[e]||Nt(e);return r==="General"?Fo(t):Pi(r,t)}function EI(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Zt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=$r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=i}function CI(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v):e.w=Fo(e.v):e.w=kI(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=A0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&oc(n)){var i=xo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function TI(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=EP[n.Pattern]||n.Pattern)}e[t.ID]=t}function AI(e,t,r,n,i,a,s,o,u,f){var d="General",p=n.StyleID,g={};f=f||{};var v=[],m=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);a[p]!==void 0&&(a[p].nf&&(d=a[p].nf),a[p].Interior&&v.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(e);break;case"String":n.t="s",n.r=Yy(Nt(e)),n.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=MS[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Yy(t||e));break}if(CI(n,d,f),f.cellFormula!==!1)if(n.Formula){var _=Nt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=Ul(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ul("RC:RC",i):n.ArrayRange&&(n.F=Ul(n.ArrayRange,i),u.push([dr(n.F),n.F]))}else for(m=0;m<u.length;++m)i.r>=u[m][0].s.r&&i.r<=u[m][0].e.r&&i.c>=u[m][0].s.c&&i.c<=u[m][0].e.c&&(n.F=u[m][1]);f.cellStyles&&(v.forEach(function(C){!g.patternType&&C.patternType&&(g.patternType=C.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function PI(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function fg(e,t){var r=t||{};lS();var n=i0(Z2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Xt(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Jr(r);return s.type="string",J0.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){i.indexOf("<"+Ct)>=0&&(a=!0)}),a)return MI(n,r);A0={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},p=[],g=r.dense?[]:{},v="",m={},_={},C=Bi('<Data ss:Type="String">'),S=0,w=0,x=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},N={},R="",P=0,I=[],b={},M={},D=0,Q=[],he=[],z={},Z=[],ae,ne=!1,K=[],ce=[],me={},L=0,ee=0,q={Sheets:[],WBProps:{date1904:!1}},Y={};q0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=q0.exec(n);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?AI(n.slice(S,o.index),R,C,u[u.length-1][0]=="comment"?z:m,{c:w,r:x},A,Z[w],_,K,r):(R="",C=Bi(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(he.length>0&&(m.c=he),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(g[x]||(g[x]=[]),g[x][w]=m):g[Ir(w)+Zr(x)]=m),m.HRef&&(m.l={Target:Nt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(L=w+(parseInt(m.MergeAcross,10)|0),ee=x+(parseInt(m.MergeDown,10)|0),I.push({s:{c:w,r:x},e:{c:L,r:ee}})),!r.sheetStubs)m.MergeAcross?w=L+1:++w;else if(m.MergeAcross||m.MergeDown){for(var V=w;V<=L;++V)for(var ie=x;ie<=ee;++ie)(V>w||ie>x)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][V]={t:"z"}):g[Ir(V)+Zr(ie)]={t:"z"});w=L+1}else++w;else m=wI(o[0]),m.Index&&(w=+m.Index-1),w<T.s.c&&(T.s.c=w),w>T.e.c&&(T.e.c=w),o[0].slice(-2)==="/>"&&++w,he=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<T.s.r&&(T.s.r=x),x>T.e.r&&(T.e.r=x),o[0].slice(-2)==="/>"&&(_=Bi(o[0]),_.Index&&(x=+_.Index-1)),w=0,++x):(_=Bi(o[0]),_.Index&&(x=+_.Index-1),me={},(_.AutoFitHeight=="0"||_.Height)&&(me.hpx=parseInt(_.Height,10),me.hpt=iw(me.hpx),ce[x]=me),_.Hidden=="1"&&(me.hidden=!0,ce[x]=me));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(v),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(g["!ref"]=At(T),r.sheetRows&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=At(T))),I.length&&(g["!merges"]=I),Z.length>0&&(g["!cols"]=Z),ce.length>0&&(g["!rows"]=ce),d[v]=g}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,u.push([o[3],!1]),f=Bi(o[0]),v=Nt(f.Name),g=r.dense?[]:{},I=[],K=[],ce=[],Y={name:v,Hidden:0},q.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),Z=[],ne=!1}break;case"style":o[1]==="/"?TI(A,N,r):N=Bi(o[0]);break;case"numberformat":N.nf=Nt(Bi(o[0]).Format||"General"),A0[N.nf]&&(N.nf=A0[N.nf]);for(var ge=0;ge!=392&&ht[ge]!=N.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(ht[ge]==null){So(N.nf,ge);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ae=Bi(o[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!ne&&ae.wpx>10){ne=!0,Pn=rw;for(var _e=0;_e<Z.length;++_e)Z[_e]&&ec(Z[_e])}ne&&ec(ae),Z[ae.Index-1||Z.length]=ae;for(var Me=0;Me<+ae.Span;++Me)Z[Z.length]=Jr(ae);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var H=it(o[0]),tt={Name:H.Name,Ref:Ul(H.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(tt.Sheet=q.Sheets.length-1),q.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?R+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Bi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?fT(b,de,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));PI(z),he.push(z)}else u.push([o[3],!1]),f=Bi(o[0]),z={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var nt=Bi(o[0]);g["!autofilter"]={ref:Ul(nt.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return b3(n,r);var Xe=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else D=o.index+o[0].length;break;case"header":g["!margins"]||T0(g["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(g["!margins"].header=+it(o[0]).Margin);break;case"footer":g["!margins"]||T0(g["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(g["!margins"].footer=+it(o[0]).Margin);break;case"pagemargins":var Ze=it(o[0]);g["!margins"]||T0(g["!margins"]={},"xlml"),isNaN(+Ze.Top)||(g["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(g["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(g["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(g["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?EI(M,de,Q,n.slice(D,o.index)):(Q=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=d),be.SheetNames=p,be.Workbook=q,be.SSF=Jr(ht),be.Props=b,be.Custprops=M,be}function Im(e,t){switch(px(t=t||{}),t.type||"base64"){case"base64":return fg(ni(e),t);case"binary":case"buffer":case"file":return fg(e,t);case"array":return fg(Do(e),t)}}function FI(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=G7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=H7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var NI=[60,1084,2066,2165,2175];function RI(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var u=Ma(r,r.l),f=bm[u],d=0;f!=null&&NI.indexOf(u)>-1;)a=Ma(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,f=bm[u=Ma(r,r.l)];var p=vs(s);Qr(p,0);var g=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(g),g+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function ca(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ht[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Bo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Y0(e.v):e.w=Fo(e.v):e.w=Pi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&oc(ht[n]||String(n))){var i=xo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Gf(e,t,r){return{v:e,ixfe:t,t:r}}function II(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,u=[],f="",d={},p,g="",v,m,_,C,S={},w=[],x,T,A=[],N=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},I=function(Fe){return Fe<8?wo[Fe]:Fe<64&&N[Fe-8]||wo[Fe]},b=function(Fe,Ce,Qe){var et=Ce.XF.data;if(!(!et||!et.patternType||!Qe||!Qe.cellStyles)){Ce.s={},Ce.s.patternType=et.patternType;var lt;(lt=Z0(I(et.icvFore)))&&(Ce.s.fgColor={rgb:lt}),(lt=Z0(I(et.icvBack)))&&(Ce.s.bgColor={rgb:lt})}},M=function(Fe,Ce,Qe){if(!(me>1)&&!(Qe.sheetRows&&Fe.r>=Qe.sheetRows)){if(Qe.cellStyles&&Ce.XF&&Ce.XF.data&&b(Fe,Ce,Qe),delete Ce.ixfe,delete Ce.XF,p=Fe,g=ct(Fe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<s.s.r&&(s.s.r=Fe.r),Fe.c<s.s.c&&(s.s.c=Fe.c),Fe.r+1>s.e.r&&(s.e.r=Fe.r+1),Fe.c+1>s.e.c&&(s.e.c=Fe.c+1),Qe.cellFormula&&Ce.f){for(var et=0;et<w.length;++et)if(!(w[et][0].s.c>Fe.c||w[et][0].s.r>Fe.r)&&!(w[et][0].e.c<Fe.c||w[et][0].e.r<Fe.r)){Ce.F=At(w[et][0]),(w[et][0].s.c!=Fe.c||w[et][0].s.r!=Fe.r)&&delete Ce.f,Ce.f&&(Ce.f=""+pn(w[et][1],s,Fe,K,D));break}}Qe.dense?(i[Fe.r]||(i[Fe.r]=[]),i[Fe.r][Fe.c]=Ce):i[g]=Ce}},D={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var Q,he=[],z=[],Z=[],ae=[],ne=!1,K=[];K.SheetNames=D.snames,K.sharedf=D.sharedf,K.arrayf=D.arrayf,K.names=[],K.XTI=[];var ce=0,me=0,L=0,ee=[],q=[],Y;D.codepage=1200,Wi(1200);for(var de=!1;e.l<e.length-1;){var V=e.l,ie=e.read_shift(2);if(ie===0&&ce===10)break;var ge=e.l===e.length?0:e.read_shift(2),_e=bm[ie];if(_e&&_e.f){if(t.bookSheets&&ce===133&&ie!==133)break;if(ce=ie,_e.r===2||_e.r==12){var Me=e.read_shift(2);if(ge-=2,!D.enc&&Me!==ie&&((Me&255)<<8|Me>>8)!==ie)throw new Error("rt mismatch: "+Me+"!="+ie);_e.r==12&&(e.l+=10,ge-=10)}var H={};if(ie===10?H=_e.f(e,ge,D):H=RI(ie,_e,e,ge,D),me==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(ie){case 34:r.opts.Date1904=R.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=H;break;case 66:var tt=Number(H);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}Wi(D.codepage=tt),de=!0;break;case 317:D.rrtabid=H;break;case 25:D.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:D.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:A.push(H);break;case 430:K.push([H]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(H);break;case 24:case 536:Y={Name:H.Name,Ref:pn(H.rgce,s,null,K,D)},H.itab>0&&(Y.Sheet=H.itab-1),K.names.push(Y),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(q[H.itab-1]={ref:At(H.rgce[0][0][1][2])});break;case 22:D.ExternCount=H;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(H),K.XTI=K.XTI.concat(H);break;case 2196:if(D.biff<8)break;Y!=null&&(Y.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&D.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,D.snames.push(H.name);break;case 10:{if(--me)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=At(s),t.sheetRows&&t.sheetRows<=s.e.r){var nt=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=At(s),s.e.r=nt}s.e.r++,s.e.c++}he.length>0&&(i["!merges"]=he),z.length>0&&(i["!objects"]=z),Z.length>0&&(i["!cols"]=Z),ae.length>0&&(i["!rows"]=ae),R.Sheets.push(P)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),D.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(D.biff=5,de=!0,Wi(D.codepage=28591)),D.biff==8&&H.BIFFVer==0&&H.dt==16&&(D.biff=2),me++)break;if(i=t.dense?[]:{},D.biff<8&&!de&&(de=!0,Wi(D.codepage=t.codepage||1252)),D.biff<5||H.BIFFVer==0&&H.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-ge,name:f};a[Xe.pos]=Xe,D.snames.push(f)}else f=(a[V]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),he=[],z=[],D.arrayf=w=[],Z=[],ae=[],ne=!1,P={Hidden:(a[V]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[ct({c:H.c,r:H.r})])&&++H.c,x={ixfe:H.ixfe,XF:A[H.ixfe]||{},v:H.val,t:"n"},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t);break;case 5:case 517:x={ixfe:H.ixfe,XF:A[H.ixfe],v:H.val,t:H.t},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t);break;case 638:x={ixfe:H.ixfe,XF:A[H.ixfe],v:H.rknum,t:"n"},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t);break;case 189:for(var Ze=H.c;Ze<=H.C;++Ze){var be=H.rkrec[Ze-H.c][0];x={ixfe:be,XF:A[be],v:H.rkrec[Ze-H.c][1],t:"n"},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:Ze,r:H.r},x,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){o=H;break}if(x=Gf(H.val,H.cell.ixfe,H.tt),x.XF=A[x.ixfe],t.cellFormula){var Ct=H.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var Lr=Ct[0][0][1][0],ye=Ct[0][0][1][1],xe=ct({r:Lr,c:ye});S[xe]?x.f=""+pn(H.formula,s,H.cell,K,D):x.F=((t.dense?(i[Lr]||[])[ye]:i[xe])||{}).F}else x.f=""+pn(H.formula,s,H.cell,K,D)}L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M(H.cell,x,t),o=H}break;case 7:case 519:if(o)o.val=H,x=Gf(H,o.cell.ixfe,"s"),x.XF=A[x.ixfe],t.cellFormula&&(x.f=""+pn(o.formula,s,o.cell,K,D)),L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(H);var Te=ct(H[0].s);if(v=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[Te],t.cellFormula&&v){if(!o||!Te||!v)break;v.f=""+pn(H[1],s,H[0],K,D),v.F=At(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;S[ct(o.cell)]=H[0],v=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[ct(o.cell)],(v||{}).f=""+pn(H[0],s,p,K,D)}}break;case 253:x=Gf(u[H.isst].t,H.ixfe,"s"),u[H.isst].h&&(x.h=u[H.isst].h),x.XF=A[x.ixfe],L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:H.ixfe,XF:A[H.ixfe],t:"z"},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t));break;case 190:if(t.sheetStubs)for(var Ae=H.c;Ae<=H.C;++Ae){var Pe=H.ixfe[Ae-H.c];x={ixfe:Pe,XF:A[Pe],t:"z"},L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:Ae,r:H.r},x,t)}break;case 214:case 516:case 4:x=Gf(H.val,H.ixfe,"s"),x.XF=A[x.ixfe],L>0&&(x.z=ee[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),M({c:H.c,r:H.r},x,t);break;case 0:case 512:me===1&&(s=H);break;case 252:u=H;break;case 1054:if(D.biff==4){ee[L++]=H[1];for(var Oe=0;Oe<L+163&&ht[Oe]!=H[1];++Oe);Oe>=163&&So(H[1],L+163)}else So(H[1],H[0]);break;case 30:{ee[L++]=H;for(var Ve=0;Ve<L+163&&ht[Ve]!=H;++Ve);Ve>=163&&So(H,L+163)}break;case 229:he=he.concat(H);break;case 93:z[H.cmo[0]]=D.lastobj=H;break;case 438:D.lastobj.TxO=H;break;case 127:D.lastobj.ImData=H;break;case 440:for(C=H[0].s.r;C<=H[0].e.r;++C)for(_=H[0].s.c;_<=H[0].e.c;++_)v=t.dense?(i[C]||[])[_]:i[ct({c:_,r:C})],v&&(v.l=H[1]);break;case 2048:for(C=H[0].s.r;C<=H[0].e.r;++C)for(_=H[0].s.c;_<=H[0].e.c;++_)v=t.dense?(i[C]||[])[_]:i[ct({c:_,r:C})],v&&v.l&&(v.l.Tooltip=H[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;v=t.dense?(i[H[0].r]||[])[H[0].c]:i[ct(H[0])];var Se=z[H[2]];v||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),v=i[H[0].r][H[0].c]={t:"z"}):v=i[ct(H[0])]={t:"z"},s.e.r=Math.max(s.e.r,H[0].r),s.s.r=Math.min(s.s.r,H[0].r),s.e.c=Math.max(s.e.c,H[0].c),s.s.c=Math.min(s.s.c,H[0].c)),v.c||(v.c=[]),m={a:H[1],t:Se.TxO.t},v.c.push(m)}break;case 2173:eF(A[H.ixfe],H.ext);break;case 125:{if(!D.cellStyles)break;for(;H.e>=H.s;)Z[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},ne||(ne=!0,cx(H.w/256)),ec(Z[H.e+1])}break;case 520:{var J={};H.level!=null&&(ae[H.r]=J,J.level=H.level),H.hidden&&(ae[H.r]=J,J.hidden=!0),H.hpt&&(ae[H.r]=J,J.hpt=H.hpt,J.hpx=eu(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||T0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=H;break;case 161:i["!margins"]||T0(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(R.Views[0].RTL=!0);break;case 146:N=H;break;case 2198:Q=H;break;case 140:T=H;break;case 442:f?P.CodeName=H||P.name:R.WBProps.CodeName=H||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=ge}return r.SheetNames=xa(a).sort(function(Ee,Fe){return Number(Ee)-Number(Fe)}).map(function(Ee){return a[Ee].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(Ee,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Ee}),r.Strings=u,r.SSF=Jr(ht),D.enc&&(r.Encryption=D.enc),Q&&(r.Themes=Q),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),K.names.length>0&&(R.Names=K.names),r.Workbook=R,r}var P3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bI(e,t,r){var n=Tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=f3(n,Q7,P3.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var s=Tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=f3(s,q7,P3.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(jS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function ww(e,t){t||(t={}),px(t),Q6(),t.codepage&&$2(t.codepage);var r,n;if(e.FullPaths){if(Tt.find(e,"/encryption"))throw new Error("File is password-protected");r=Tt.find(e,"!CompObj"),n=Tt.find(e,"/Workbook")||Tt.find(e,"/Book")}else{switch(t.type){case"base64":e=Hi(ni(e));break;case"binary":e=Hi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Qr(e,0),n={content:e}}var i,a;if(r&&FI(r),t.bookProps&&!t.bookSheets)i={};else{var s=kt?"buffer":"array";if(n&&n.content)i=II(n.content,t);else if((a=Tt.find(e,"PerfectOffice_MAIN"))&&a.content)i=E0.to_workbook(a.content,(t.type=s,t));else if((a=Tt.find(e,"NativeContent_MAIN"))&&a.content)i=E0.to_workbook(a.content,(t.type=s,t));else throw(a=Tt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=vF(e))}var o={};return e.FullPaths&&bI(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var Xd={0:{f:pR},1:{f:vR},2:{f:AR},3:{f:wR},4:{f:_R},5:{f:TR},6:{f:NR},7:{f:ER},8:{f:DR},9:{f:OR},10:{f:IR},11:{f:bR},12:{f:yR},13:{f:PR},14:{f:kR},15:{f:SR},16:{f:xw},17:{f:RR},18:{f:CR},19:{f:nx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:lI},40:{},42:{},43:{f:IP},44:{f:RP},45:{f:bP},46:{f:DP},47:{f:OP},48:{},49:{f:L7},50:{},51:{f:rF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qS},62:{f:FR},63:{f:oF},64:{f:HR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:GR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xR},148:{f:gR,p:16},151:{f:BR},152:{},153:{f:sI},154:{},155:{},156:{f:aI},157:{},158:{},159:{T:1,f:qA},160:{T:-1},161:{T:1,f:Mo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:LR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tF},336:{T:-1},337:{f:nF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jR},427:{f:UR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:mR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:gF},633:{T:1},634:{T:-1},635:{T:1,f:pF},636:{T:-1},637:{f:B7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:WR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bm={6:{f:cg},10:{f:us},12:{f:wr},13:{f:wr},14:{f:gr},15:{f:gr},16:{f:mn},17:{f:gr},18:{f:gr},19:{f:wr},20:{f:g3},21:{f:g3},23:{f:QS},24:{f:x3},25:{f:gr},26:{},27:{},28:{f:dA},29:{},34:{f:gr},35:{f:m3},38:{f:mn},39:{f:mn},40:{f:mn},41:{f:mn},42:{f:gr},43:{f:gr},47:{f:mP},49:{f:XT},51:{f:wr},60:{},61:{f:HT},64:{f:gr},65:{f:$T},66:{f:wr},77:{},80:{},81:{},82:{},85:{f:wr},89:{},90:{},91:{},92:{f:LT},93:{f:pA},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:qS},128:{f:nA},129:{f:MT},130:{f:wr},131:{f:gr},132:{f:gr},133:{f:BT},134:{},140:{f:_A},141:{f:wr},144:{},146:{f:wA},151:{},152:{},153:{},154:{},155:{},156:{f:wr},157:{},158:{},160:{f:AA},161:{f:EA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ZT},190:{f:eA},193:{f:us},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wr},220:{},221:{f:gr},222:{},224:{f:rA},225:{f:DT},226:{f:us},227:{},229:{f:hA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:jT},253:{f:KT},255:{f:UT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:HS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:us},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:aA},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:xA},439:{f:gr},440:{f:vA},441:{},442:{f:pu},443:{},444:{f:wr},445:{},446:{},448:{f:us},449:{f:GT,r:2},450:{f:us},512:{f:h3},513:{f:TA},515:{f:iA},516:{f:YT},517:{f:p3},519:{f:PA},520:{f:zT},523:{},545:{f:v3},549:{f:d3},566:{},574:{f:WT},638:{f:JT},659:{},1048:{},1054:{f:QT},1084:{},1212:{f:cA},2048:{f:yA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Uf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:us},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kA,r:12},2173:{f:ZP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:lA,r:12},2197:{},2198:{f:XP,r:12},2199:{},2200:{},2201:{},2202:{f:uA,r:12},2203:{f:us},2204:{},2205:{},2206:{},2207:{},2211:{f:VT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:CA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:SA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:h3},1:{},2:{f:IA},3:{f:RA},4:{f:NA},5:{f:p3},7:{f:bA},8:{},9:{f:Uf},11:{},22:{f:wr},30:{f:qT},31:{},32:{},33:{f:v3},36:{},37:{f:d3},50:{f:OA},62:{},52:{},67:{},68:{f:wr},69:{},86:{},126:{},127:{f:FA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DA},223:{},234:{},354:{},421:{},518:{f:cg},521:{f:Uf},536:{f:x3},547:{f:m3},561:{},579:{},1030:{f:cg},1033:{f:Uf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ji(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&RS(r)&&e.push(r)}}function F3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,u=a7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<u.length;++s){var _=u[s].trim(),C=_.slice(0,3).toLowerCase();if(C=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(C!="<td"&&C!="<th")){var S=_.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var w=S[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,T=0;x.charAt(0)=="<"&&(T=x.indexOf(">"))>-1;)x=x.slice(T+1);for(var A=0;A<m.length;++A){var N=m[A];N.s.c==d&&N.s.r<f&&f<=N.e.r&&(d=N.e.c+1,A=-1)}var R=it(w.slice(0,w.indexOf(">")));g=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||g>1)&&m.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+g-1}});var P=R.t||R["data-t"]||"";if(!x.length){d+=g;continue}if(x=vS(x),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!x.length){d+=g;continue}var I={t:"s",v:x};r.raw||!x.trim().length||P=="s"||(x==="TRUE"?I={t:"b",v:!0}:x==="FALSE"?I={t:"b",v:!1}:isNaN(Qi(x))?isNaN(Zl(x).getDate())||(I={t:"d",v:$r(x)},r.cellDates||(I={t:"n",v:In(I.v)}),I.z=r.dateNF||ht[14]):I={t:"n",v:Qi(x)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=I):n[ct({r:f,c:d})]=I,d+=g}}}}return n["!ref"]=At(v),m.length&&(n["!merges"]=m),n}function OI(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){o=-1;break}o=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var d=ct({r,c:s}),p=n.dense?(e[r]||[])[s]:e[d],g=p&&p.v!=null&&(p.h||J2(p.w||(Xa(p),p.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(_7("td",g,v))}}var m="<tr>";return m+a.join("")+"</tr>"}var DI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LI="</body></html>";function MI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vs(F3(r[0],t),t);var n=mx();return r.forEach(function(i,a){xx(n,F3(i,t),"Sheet"+(a+1))}),n}function BI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function jI(e,t){var r=t||{},n=r.header!=null?r.header:DI,i=r.footer!=null?r.footer:LI,a=[n],s=lc(e["!ref"]);r.dense=Array.isArray(e),a.push(BI(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(OI(e,s,o,r));return a.push("</table>"+i),a.join("")}function kw(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Fn(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=lc(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var p=[],g=0,v=e["!rows"]||(e["!rows"]=[]),m=0,_=0,C=0,S=0,w=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&_<u;++m){var T=o[m];if(N3(T)){if(n.display)continue;v[_]={hidden:!0}}var A=T.children;for(C=S=0;C<A.length;++C){var N=A[C];if(!(n.display&&N3(N))){var R=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):vS(N.innerHTML),P=N.getAttribute("data-z")||N.getAttribute("z");for(g=0;g<p.length;++g){var I=p[g];I.s.c==S+a&&I.s.r<_+i&&_+i<=I.e.r&&(S=I.e.c+1-a,g=-1)}x=+N.getAttribute("colspan")||1,((w=+N.getAttribute("rowspan")||1)>1||x>1)&&p.push({s:{r:_+i,c:S+a},e:{r:_+i+(w||1)-1,c:S+a+(x||1)-1}});var b={t:"s",v:R},M=N.getAttribute("data-t")||N.getAttribute("t")||"";R!=null&&(R.length==0?b.t=M||"z":n.raw||R.trim().length==0||M=="s"||(R==="TRUE"?b={t:"b",v:!0}:R==="FALSE"?b={t:"b",v:!1}:isNaN(Qi(R))?isNaN(Zl(R).getDate())||(b={t:"d",v:$r(R)},n.cellDates||(b={t:"n",v:In(b.v)}),b.z=n.dateNF||ht[14]):b={t:"n",v:Qi(R)})),b.z===void 0&&P!=null&&(b.z=P);var D="",Q=N.getElementsByTagName("A");if(Q&&Q.length)for(var he=0;he<Q.length&&!(Q[he].hasAttribute("href")&&(D=Q[he].getAttribute("href"),D.charAt(0)!="#"));++he);D&&D.charAt(0)!="#"&&(b.l={Target:D}),n.dense?(e[_+i]||(e[_+i]=[]),e[_+i][S+a]=b):e[ct({c:S+a,r:_+i})]=b,f.e.c<S+a&&(f.e.c=S+a),S+=x}}++_}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,_-1+i),e["!ref"]=At(f),_>=u&&(e["!fullref"]=At((f.e.r=o.length-m+_-1+i,f))),e}function Ew(e,t){var r=t||{},n=r.dense?[]:{};return kw(n,e,t)}function UI(e,t){return Vs(Ew(e,t),t)}function N3(e){var t="",r=zI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function zI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var R3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Cw(e,t){var r=t||{},n=Z2(e),i=[],a,s,o={name:""},u="",f=0,d,p,g={},v=[],m=r.dense?[]:{},_,C,S={value:""},w="",x=0,T=[],A=-1,N=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,I={},b=[],M={},D=0,Q=0,he=[],z=1,Z=1,ae=[],ne={Names:[]},K={},ce=["",""],me=[],L={},ee="",q=0,Y=!1,de=!1,V=0;for(q0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=q0.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"工作表":_[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?m["!ref"]=At(R):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(m["!fullref"]=m["!ref"],R.e.r=r.sheetRows-1,m["!ref"]=At(R)),b.length&&(m["!merges"]=b),he.length&&(m["!rows"]=he),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),g[d.name]=m,de=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=it(_[0],!1),A=N=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,m=r.dense?[]:{},b=[],he=[],de=!0);break;case"table-row-group":_[1]==="/"?--P:++P;break;case"table-row":case"行":if(_[1]==="/"){A+=z,z=1;break}if(p=it(_[0],!1),p.行号?A=p.行号-1:A==-1&&(A=0),z=+p["number-rows-repeated"]||1,z<10)for(V=0;V<z;++V)P>0&&(he[A+V]={level:P});N=-1;break;case"covered-table-cell":_[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][N]={t:"z"}):m[ct({r:A,c:N})]={t:"z"}),w="",T=[];break;case"table-cell":case"数据":if(_[0].charAt(_[0].length-2)==="/")++N,S=it(_[0],!1),Z=parseInt(S["number-columns-repeated"]||"1",10),C={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(C.f=C3(Nt(S.formula))),(S.数据类型||S["value-type"])=="string"&&(C.t="s",C.v=Nt(S["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][N]=C):m[ct({r:A,c:N})]=C),N+=Z-1;else if(_[1]!=="/"){++N,w="",x=0,T=[],Z=1;var ie=z?A+z-1:A;if(N>R.e.c&&(R.e.c=N),N<R.s.c&&(R.s.c=N),A<R.s.r&&(R.s.r=A),ie>R.e.r&&(R.e.r=ie),S=it(_[0],!1),me=[],L={},C={t:S.数据类型||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Nt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(D=parseInt(S["number-matrix-rows-spanned"],10)||0,Q=parseInt(S["number-matrix-columns-spanned"],10)||0,M={s:{r:A,c:N},e:{r:A+D-1,c:N+Q-1}},C.F=At(M),ae.push([M,C.F])),S.formula)C.f=C3(S.formula);else for(V=0;V<ae.length;++V)A>=ae[V][0].s.r&&A<=ae[V][0].e.r&&N>=ae[V][0].s.c&&N<=ae[V][0].e.c&&(C.F=ae[V][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(D=parseInt(S["number-rows-spanned"],10)||0,Q=parseInt(S["number-columns-spanned"],10)||0,M={s:{r:A,c:N},e:{r:A+D-1,c:N+Q-1}},b.push(M)),S["number-columns-repeated"]&&(Z=parseInt(S["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Zt(S["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(S.value);break;case"percentage":C.t="n",C.v=parseFloat(S.value);break;case"currency":C.t="n",C.v=parseFloat(S.value);break;case"date":C.t="d",C.v=$r(S["date-value"]),r.cellDates||(C.t="n",C.v=In(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=r7(S["time-value"])/86400,r.cellDates&&(C.t="d",C.v=kh(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(S.数据数值);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",S["string-value"]!=null&&(w=Nt(S["string-value"]),T=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(Y=!1,C.t==="s"&&(C.v=w||"",T.length&&(C.R=T),Y=x==0),K.Target&&(C.l=K),me.length>0&&(C.c=me,me=[]),w&&r.cellText!==!1&&(C.w=w),Y&&(C.t="z",delete C.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var ge=0;ge<z;++ge){if(Z=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(m[A+ge]||(m[A+ge]=[]),m[A+ge][N]=ge==0?C:Jr(C);--Z>0;)m[A+ge][N+Z]=Jr(C);else for(m[ct({r:A+ge,c:N})]=C;--Z>0;)m[ct({r:A+ge,c:N+Z})]=Jr(C);R.e.c<=N&&(R.e.c=N)}Z=parseInt(S["number-columns-repeated"]||"1",10),N+=Z-1,Z=0,C={},w="",T=[]}K={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a;L.t=w,T.length&&(L.R=T),L.a=ee,me.push(L)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);ee="",q=0,w="",x=0,T=[];break;case"creator":_[1]==="/"?ee=n.slice(q,_.index):q=_.index+_[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);w="",x=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(I[o.name]=u,(a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(u="",o=it(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=it(_[0],!1),u+=R3[_[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=it(_[0],!1),u+=R3[_[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,_.index);break}else f=_.index+_[0].length;break;case"named-range":s=it(_[0],!1),ce=ug(s["cell-range-address"]);var _e={Name:s.name,Ref:ce[0]+"!"+ce[1]};de&&(_e.Sheet=v.length),ne.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!S||!S["string-value"])){var Me=VI(n.slice(x,_.index));w=(w.length>0?w+`
`:"")+Me[0]}else it(_[0],!1),x=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ce=ug(it(_[0])["target-range-address"]),g[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(K=it(_[0],!1),!K.href)break;K.Target=Nt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(ce=ug(K.Target.slice(1)),K.Target="#"+ce[0]+"!"+ce[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(_)}}var H={Sheets:g,SheetNames:v,Workbook:ne};return r.bookSheets&&delete H.Sheets,H}function I3(e,t){t=t||{},_i(e,"META-INF/manifest.xml")&&iT(Sr(e,"META-INF/manifest.xml"),t);var r=Jn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Cw(Xt(r),t);return _i(e,"meta.xml")&&(n.Props=BS(Sr(e,"meta.xml"))),n}function b3(e,t){return Cw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Om(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(Do(e))}function Dm(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function O3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function GI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function tu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function br(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=tu(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=tu(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function hx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function HI(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=tu(e,n),a=xn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:br(a[1][0].data),messages:[]};a[2].forEach(function(o){var u=xn(o.data),f=br(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(s.merge=br(a[3][0].data)>>>0>0),r.push(s)}return r}function WI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=tu(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Dm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Dm(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function $I(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(WI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Dm(t)}function XI(e,t,r,n){var i=dx(e),a=i.getUint32(4,!0),s=(n>1?12:8)+O3(a&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=O3(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(s,!0),s+=4),a&32&&(f=i.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function KI(e,t,r){var n=dx(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=GI(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function YI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return XI(e,t,r,e[0]);case 5:return KI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rs(e){var t=xn(e);return tu(t[1][0].data)}function D3(e,t){var r=xn(t.data),n=br(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=xn(s.data),u=br(o[1][0].data)>>>0;switch(n){case 1:a[u]=Om(o[3][0].data);break;case 8:{var f=e[Rs(o[9][0].data)][0],d=xn(f.data),p=e[Rs(d[1][0].data)][0],g=br(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=xn(p.data);a[u]=v[3].map(function(m){return Om(m.data)}).join("")}break}}),a}function QI(e,t){var r,n,i,a,s,o,u,f,d,p,g,v,m,_,C=xn(e),S=br(C[1][0].data)>>>0,w=br(C[2][0].data)>>>0,x=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&br(C[8][0].data)>0||!1,T,A;if((a=(i=C[7])==null?void 0:i[0])!=null&&a.data&&t!=0)T=(o=(s=C[7])==null?void 0:s[0])==null?void 0:o.data,A=(f=(u=C[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=C[4])==null?void 0:d[0])!=null&&p.data&&t!=1)T=(v=(g=C[4])==null?void 0:g[0])==null?void 0:v.data,A=(_=(m=C[3])==null?void 0:m[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=x?4:1,R=dx(T),P=[],I=0;I<T.length/2;++I){var b=R.getUint16(I*2,!0);b<65535&&P.push([I,b])}if(P.length!=w)throw"Expected ".concat(w," cells, found ").concat(P.length);var M=[];for(I=0;I<P.length-1;++I)M[P[I][0]]=A.subarray(P[I][1]*N,P[I+1][1]*N);return P.length>=1&&(M[P[P.length-1][0]]=A.subarray(P[P.length-1][1]*N)),{R:S,cells:M}}function qI(e,t){var r,n=xn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?br(n[7][0].data)>>>0>0?1:0:-1,a=hx(n[5],function(s){return QI(s,i)});return{nrows:br(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(u,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=u}),s},[])}}function JI(e,t,r){var n,i=xn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(br(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(br(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=At(a);var s=xn(i[4][0].data),o=D3(e,e[Rs(s[4][0].data)][0]),u=(n=s[17])!=null&&n[0]?D3(e,e[Rs(s[17][0].data)][0]):[],f=xn(s[3][0].data),d=0;f[1].forEach(function(p){var g=xn(p.data),v=e[Rs(g[2][0].data)][0],m=br(v.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var _=qI(e,v);_.data.forEach(function(C,S){C.forEach(function(w,x){var T=ct({r:d+S,c:x}),A=YI(w,o,u);A&&(r[T]=A)})}),d+=_.nrows})}function ZI(e,t){var r=xn(t.data),n={"!ref":"A1"},i=e[Rs(r[2][0].data)],a=br(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return JI(e,i[0],n),n}function eb(e,t){var r,n=xn(t.data),i={name:(r=n[1])!=null&&r[0]?Om(n[1][0].data):"",sheets:[]},a=hx(n[2],Rs);return a.forEach(function(s){e[s].forEach(function(o){var u=br(o.meta[1][0].data);u==6e3&&i.sheets.push(ZI(e,o))})}),i}function tb(e,t){var r=mx(),n=xn(t.data),i=hx(n[1],Rs);if(i.forEach(function(a){e[a].forEach(function(s){var o=br(s.meta[1][0].data);if(o==2){var u=eb(e,s);u.sheets.forEach(function(f,d){xx(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function dg(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=$I(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=HI(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){a[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&br(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(u){a[u].forEach(function(f){var d=br(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tb(a,o)}function rb(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function px(e){rb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function nb(e){return Rl.WS.indexOf(e)>-1?"sheet":e==Rl.CS?"chart":e==Rl.DS?"dialog":e==Rl.MS?"macro":e&&e.length?e:"sheet"}function ib(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,nb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ab(e,t,r,n,i,a,s,o,u,f,d,p){try{a[n]=w0(Jn(e,r,!0),t);var g=Sr(e,t),v;switch(o){case"sheet":v=fI(g,t,i,u,a[n],f,d,p);break;case"chart":if(v=dI(g,t,i,u,a[n],f,d,p),!v||!v["!drawel"])break;var m=s0(v["!drawel"].Target,t),_=Fm(m),C=uF(Jn(e,m,!0),w0(Jn(e,_,!0),m)),S=s0(C,m),w=Fm(S);v=KR(Jn(e,S,!0),S,u,w0(Jn(e,w,!0),S),f,v);break;case"macro":v=hI(g,t,i,u,a[n],f,d,p);break;case"dialog":v=pI(g,t,i,u,a[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var x=[];a&&a[n]&&xa(a[n]).forEach(function(T){var A="";if(a[n][T].Type==Rl.CMNT){A=s0(a[n][T].Target,t);var N=vI(Sr(e,A,!0),A,u);if(!N||!N.length)return;_3(v,N,!1)}a[n][T].Type==Rl.TCMNT&&(A=s0(a[n][T].Target,t),x=x.concat(dF(Sr(e,A,!0),u)))}),x&&x.length&&_3(v,x,!0,u.people||[])}catch(T){if(u.WTF)throw T}}function mi(e){return e.charAt(0)=="/"?e.slice(1):e}function sb(e,t){if(lS(),t=t||{},px(t),_i(e,"META-INF/manifest.xml")||_i(e,"objectdata.xml"))return I3(e,t);if(_i(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof dg<"u"){if(e.FileIndex)return dg(e);var r=Tt.utils.cfb_new();return Xy(e).forEach(function(he){o7(r,he,pS(e,he))}),dg(r)}throw new Error("Unsupported NUMBERS file")}if(!_i(e,"[Content_Types].xml"))throw _i(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_i(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Xy(e),i=rT(Jn(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Sr(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Sr(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(C0=[],i.sst)try{C0=xI(Sr(e,mi(i.sst)),i.sst,t)}catch(he){if(t.WTF)throw he}t.cellStyles&&i.themes.length&&(u=mI(Jn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=gI(Sr(e,mi(i.style)),i.style,u,t))}i.links.map(function(he){try{var z=w0(Jn(e,Fm(mi(he))),he);return _I(Sr(e,mi(he)),z,he,t)}catch{}});var d=uI(Sr(e,mi(i.workbooks[0])),i.workbooks[0],t),p={},g="";i.coreprops.length&&(g=Sr(e,mi(i.coreprops[0]),!0),g&&(p=BS(g)),i.extprops.length!==0&&(g=Sr(e,mi(i.extprops[0]),!0),g&&oT(g,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(g=Jn(e,mi(i.custprops[0]),!0),g&&(v=cT(g,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(z){return z.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=v),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var _={};t.bookDeps&&i.calcchain&&(_=yI(Sr(e,mi(i.calcchain)),i.calcchain));var C=0,S={},w,x;{var T=d.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var A=0;A!=T.length;++A)p.SheetNames[A]=T[A].name}var N=a?"bin":"xml",R=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,R+1)+"_rels/"+i.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");_i(e,P)||(P="xl/_rels/workbook."+N+".rels");var I=w0(Jn(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=SI(Sr(e,mi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=hF(Sr(e,mi(i.people[0])),t)),I&&(I=ib(I,d.Sheets));var b=Sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=p.Worksheets;++C){var M="sheet";if(I&&I[C]?(w="xl/"+I[C][1].replace(/[\/]?xl\//,""),_i(e,w)||(w=I[C][1]),_i(e,w)||(w=P.replace(/_rels\/.*$/,"")+I[C][1]),M=I[C][2]):(w="xl/worksheets/sheet"+(C+1-b)+"."+N,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(p.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==C&&(D=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==p.SheetNames[C].toLowerCase()&&(D=1);if(!D)continue e}}ab(e,w,x,p.SheetNames[C],C,S,s,M,t,d,u,f)}return m={Directory:i,Workbook:d,Props:p,Custprops:v,Deps:_,Sheets:s,SheetNames:p.SheetNames,Strings:C0,Styles:f,Themes:u,SSF:Jr(ht)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(he,z){he=he.replace(/^Root Entry[\/]/,""),m.keys.push(he),m.files[he]=e.FileIndex[z]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Sr(e,mi(i.vba[0]),!0):i.defaults&&i.defaults.bin===xF&&(m.vbaraw=Sr(e,"xl/vbaProject.bin",!0))),m}function ob(e,t){var r=t||{},n="Workbook",i=Tt.find(e,n);try{if(n="/!DataSpaces/Version",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ZA(i.content),n="/!DataSpaces/DataSpaceMap",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=tP(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=rP(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);iP(i.content)}catch{}if(n="/EncryptionInfo",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aP(i.content);if(n="/EncryptedPackage",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function gx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ni(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lb(e,t){return Tt.find(e,"EncryptedPackage")?ob(e,t):ww(e,t)}function cb(e,t){var r,n=e,i=t||{};return i.type||(i.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r=gS(n,i),sb(r,i)}function Tw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Im(e.slice(r),t);default:break e}return J0.to_workbook(e,t)}function ub(e,t){var r="",n=gx(e,t);switch(t.type){case"base64":r=ni(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=No(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Xt(r)),t.type="binary",Tw(r,t)}function fb(e,t){var r=e;return t.type=="base64"&&(r=ni(r)),r=xs.utils.decode(1200,r.slice(2),"str"),t.type="binary",Tw(r,t)}function db(e){return e.match(/[^\x00-\x7F]/)?o0(e):e}function hg(e,t,r,n){return n?(r.type="string",J0.to_workbook(e,r)):J0.to_workbook(t,r)}function Lm(e,t){Q6();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Lm(new Uint8Array(e),(r=Jr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),zl={},r.dateNF&&(zl.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=e7(e),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=db(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Jr(r),r.type="array",Lm(X2(n),r)}switch((i=gx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return lb(Tt.read(n,r),r);break;case 9:if(i[1]<=8)return ww(n,r);break;case 60:return Im(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return UA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return BA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?cb(n,r):hg(e,n,r,a);case 239:return i[3]===60?Im(n,r):hg(e,n,r,a);case 255:if(i[1]===254)return fb(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return E0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return E0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return y3.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return xP.to_workbook(n,r);break;case 10:case 13:case 32:return ub(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?y3.to_workbook(n,r):hg(e,n,r,a)}function hb(e,t,r,n,i,a,s,o){var u=Zr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var m=s?e[r][v]:e[n[v]+u];if(m===void 0||m.t===void 0){if(f===void 0)continue;a[v]!=null&&(g[a[v]]=f);continue}var _=m.v;switch(m.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[v]!=null){if(_==null)if(m.t=="e"&&_===null)g[a[v]]=null;else if(f!==void 0)g[a[v]]=f;else if(d&&_===null)g[a[v]]=null;else continue;else g[a[v]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?_:Xa(m,_,o);_!=null&&(p=!1)}}return{row:g,isempty:p}}function Mm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=dr(d);break;case"number":u=dr(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var p=Zr(u.s.r),g=[],v=[],m=0,_=0,C=Array.isArray(e),S=u.s.r,w=0,x={};C&&!e[S]&&(e[S]=[]);var T=f.skipHidden&&e["!cols"]||[],A=f.skipHidden&&e["!rows"]||[];for(w=u.s.c;w<=u.e.c;++w)if(!(T[w]||{}).hidden)switch(g[w]=Ir(w),r=C?e[S][w]:e[g[w]+p],n){case 1:a[w]=w-u.s.c;break;case 2:a[w]=g[w];break;case 3:a[w]=f.header[w-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Xa(r,null,f),_=x[s]||0,!_)x[s]=1;else{do o=s+"_"+_++;while(x[o]);x[s]=_,x[o]=1}a[w]=o}for(S=u.s.r+i;S<=u.e.r;++S)if(!(A[S]||{}).hidden){var N=hb(e,u,S,g,n,a,C,f);(N.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[m++]=N.row)}return v.length=m,v}var L3=/"/g;function pb(e,t,r,n,i,a,s,o){for(var u=!0,f=[],d="",p=Zr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=o.dense?(e[r]||[])[g]:e[n[g]+p];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:Xa(v,null,o));for(var m=0,_=0;m!==d.length;++m)if((_=d.charCodeAt(m))===i||_===a||_===34||o.forceQuotes){d='"'+d.replace(L3,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(L3,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(s)}function Aw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=dr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(g[m]||{}).hidden||(p[m]=Ir(m));for(var _=0,C=i.s.r;C<=i.e.r;++C)(v[C]||{}).hidden||(d=pb(e,i,C,p,s,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((_++?o:"")+d)));return delete n.dense,r.join("")}function gb(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Aw(e,t);return r}function mb(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=dr(e["!ref"]),a="",s=[],o,u=[],f=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Ir(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=Zr(d),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Pw(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Fn(n.origin):n.origin;s=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var p=dr(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),s==-1&&(s=p.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var g=n.header||[],v=0;t.forEach(function(_,C){xa(_).forEach(function(S){(v=g.indexOf(S))==-1&&(g[v=g.length]=S);var w=_[S],x="z",T="",A=ct({c:o+v,r:s+C+i});f=ru(a,A),w&&typeof w=="object"&&!(w instanceof Date)?a[A]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=In(w)),T=n.dateNF||ht[14]):w===null&&n.nullError&&(x="e",w=0),f?(f.t=x,f.v=w,delete f.w,delete f.R,T&&(f.z=T)):a[A]=f={t:x,v:w},T&&(f.z=T))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var m=Zr(s);if(i)for(v=0;v<g.length;++v)a[Ir(v+o)+m]={t:"s",v:g[v]};return a["!ref"]=At(d),a}function xb(e,t){return Pw(null,e,t)}function ru(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Fn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ru(e,ct(t)):ru(e,ct({r:t,c:r||0}))}function vb(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function mx(){return{SheetNames:[],Sheets:{}}}function xx(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(rI(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yb(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=vb(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function _b(e,t){return e.z=t,e}function Fw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Sb(e,t,r){return Fw(e,"#"+t,r)}function wb(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function kb(e,t,r,n){for(var i=typeof t!="string"?t:dr(t),a=typeof t=="string"?t:At(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var u=ru(e,s,o);u.t="n",u.F=a,delete u.v,s==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var pg={encode_col:Ir,encode_row:Zr,encode_cell:ct,encode_range:At,decode_col:rx,decode_row:tx,split_cell:D7,decode_cell:Fn,decode_range:lc,format_cell:Xa,sheet_add_aoa:bS,sheet_add_json:Pw,sheet_add_dom:kw,aoa_to_sheet:cc,json_to_sheet:xb,table_to_sheet:Ew,table_to_book:UI,sheet_to_csv:Aw,sheet_to_txt:gb,sheet_to_json:Mm,sheet_to_html:jI,sheet_to_formulae:mb,sheet_to_row_object_array:Mm,sheet_get_cell:ru,book_new:mx,book_append_sheet:xx,book_set_sheet_visibility:yb,cell_set_number_format:_b,cell_set_hyperlink:Fw,cell_set_internal_link:Sb,cell_add_comment:wb,sheet_set_array_formula:kb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const vx=class Bm{static async parseCSVFile(t){var r;try{const n=(r=t.name.split(".").pop())==null?void 0:r.toLowerCase();let i;return n==="xlsx"||n==="xls"?i=await this.readXLSXFileContent(t):i=await this.readFileContent(t),this.parseCSVContent(i)}catch(n){return{success:!1,pins:[],warnings:[],errors:[n.message],format:this.getDefaultFormat()}}}static async parseCSVContent(t){console.log("🚀 Starting ultra-fast CSV parsing...");const r=this.tryVersalPatternMatching(t);if(r!==null)return await r;console.log("🔧 About to try Intel/Altera pattern matching...");const n=this.tryIntelAlteraPatternMatching(t);return n!==null?(console.log("✅ Intel/Altera pattern detected, processing..."),await n):(console.log("📋 Versal and Intel/Altera patterns not found, using generic approach..."),this.parseCSVContentGeneric(t))}static async parseCSVContentGeneric(t){console.log("🔄 Fallback to generic CSV processing...");const r=t.split(`
`).map(v=>v.trim()).filter(Boolean);console.log(`📄 Processing ${r.length} lines with generic approach`);let n=-1,i=-1;for(let v=0;v<Math.min(1e3,r.length);v++){const m=r[v];if(!m||!m.includes(","))continue;const _=m.toLowerCase();if(_.includes("copyright")||_.includes("license")||_.includes("xilinx")||m.startsWith("#"))continue;const C=this.parseCSVLine(m);if(C.length>=3&&C.some(w=>{const x=w.toLowerCase().trim();return x==="pin"||x==="ball"||x.includes("pin")})){n=v,i=v+1;break}}if(n===-1)return{success:!1,pins:[],warnings:[],errors:["Pin column not found or empty"],format:this.getDefaultFormat()};const a=r[n];console.log(`📋 Found header at line ${n+1}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log("🔍 Format:",s),console.log("🔍 Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;for(let v=i;v<r.length;v++){const m=r[v];if(!m||m.replace(/,/g,"").trim()==="")continue;const _=this.parseCSVLine(m);try{const C=this.parsePin(_,o,v+1);C&&(u.push(C),g++)}catch(C){d.length<20&&d.push(`Line ${v+1}: ${C.message}`)}p++,p%1e3===0&&console.log(`🔄 Generic processing: ${p} lines, ${g} pins`)}return console.log(`✅ Generic processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static tryVersalPatternMatching(t){console.log("⚡ Trying ultra-fast Versal pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(`📄 Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(7e3,r.length);a++){const s=r[a];if(a%1e3===0&&console.log(`⚡ Pattern matching line ${a+1}...`),s&&s.toLowerCase().startsWith("pin,pin name,")){n=a,i=a+1,console.log(`✅ Found Versal header at line ${a+1}: ${s.substring(0,100)}`);break}if(s&&s.toLowerCase().startsWith("pin,")&&s.toLowerCase().includes("pin name")&&s.split(",").length>=3){n=a,i=a+1,console.log(`✅ Found Versal header variant at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log("❌ Versal pattern not found"),null):this.parseCSVWithKnownHeader(r,n,i)}static tryIntelAlteraPatternMatching(t){console.log("🔧 Trying Intel/Altera pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(`📄 Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(20,r.length);a++){const s=r[a];if(s&&s.toLowerCase().includes("pin name/function")){n=a,i=a+1,console.log(`✅ Found Intel/Altera header at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log("❌ Intel/Altera pattern not found"),null):this.parseIntelAlteraCSV(r,n,i)}static async parseIntelAlteraCSV(t,r,n){var f,d,p,g,v,m,_,C,S;console.log("🔧 Processing Intel/Altera CSV format...");const i=[],a=[],s=[];let o=0,u=0;for(let w=n;w<t.length;w++){const x=t[w];if(!x||x.replace(/,/g,"").trim()==="")continue;const T=this.parseCSVLine(x);if(T.length>=6){const A=(f=T[0])==null?void 0:f.trim(),N=(d=T[1])==null?void 0:d.trim(),R=(p=T[6])==null?void 0:p.trim(),P=(g=T[7])==null?void 0:g.trim();if(!A||!R||!P)continue;try{const I={row:R,col:parseInt(P,10)||1},b=this.gridToPosition(I),M={id:crypto.randomUUID(),pinNumber:A,pinName:N||A,signalName:((v=T[2])==null?void 0:v.trim())||"",direction:this.parseDirection(T[3]),pinType:this.determinePinType(N||A),voltage:((m=T[4])==null?void 0:m.trim())||"3.3V",packagePin:((_=T[5])==null?void 0:_.trim())||A,position:b,gridPosition:I,isAssigned:!!((C=T[2])!=null&&C.trim()),bank:((S=T[8])==null?void 0:S.trim())||"NA"};i.push(M),o++}catch(I){s.length<20&&s.push(`Line ${w+1}: ${I.message}`)}}u++,u%1e3===0&&console.log(`🔄 Intel/Altera processing: ${u} lines, ${o} pins`)}return console.log(`✅ Intel/Altera processing complete: ${o} pins found from ${u} lines`),{success:i.length>0,pins:i,warnings:a,errors:s,format:{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:["Pin","Pin Name","Signal","Direction","Voltage","Package_Pin","Row","Col","Bank","Type"]}}}static async parseCSVWithKnownHeader(t,r,n){console.log("⚡ Fast processing with known header...");const i=t.slice(n).filter(m=>!m||m.trim()===""?!1:m.replace(/,/g,"").trim()!=="");console.log(`📋 Found ${i.length} data lines after header`);const a=t[r];console.log(`📋 Using header line ${r}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log("🔍 Format:",s),console.log("🔍 Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;const v=1e3;for(let m=0;m<i.length;m++){const _=i[m];if(!_||_.replace(/,/g,"").trim()==="")continue;const C=this.parseCSVLine(_);try{const S=this.parsePin(C,o,m+n+1);S&&(u.push(S),g++)}catch(S){d.length<20&&d.push(`Line ${m+n+1}: ${S.message}`)}p++,p%v===0&&console.log(`⚡ Processed ${p}/${i.length} lines, found ${g} pins`)}return console.log(`✅ Ultra-fast processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static async readFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;return r((s=a.target)==null?void 0:s.result)},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static async readXLSXFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=Lm(o,{type:"binary"});console.log("📊 XLSX Workbook info:",{sheetNames:u.SheetNames,totalSheets:u.SheetNames.length});const f=u.SheetNames[0],d=u.Sheets[f],p=pg.decode_range(d["!ref"]||"A1");console.log("📋 Sheet range:",{sheetName:f,range:d["!ref"],rows:p.e.r-p.s.r+1,cols:p.e.c-p.s.c+1});const g=pg.sheet_to_json(d,{header:1,raw:!1});console.log("🔍 Raw data sample (first 15 rows):",g.slice(0,15)),console.log("📊 Total data rows:",g.length);const v=g.filter(_=>_&&Array.isArray(_)&&_.some(C=>C&&C.toString().trim()));console.log("📈 Non-empty rows:",v.length);const m=Bm.detectIntelAlteraFormat(g);if(console.log("🔍 Format detection result:",m?"Intel/Altera":"Standard CSV"),m){console.log("🔍 Intel/Altera format detected, using special processing");const _=Bm.processIntelAlteraXLSX(g);r(_)}else{const _=pg.sheet_to_csv(d,{strip:!1}),C=_.split(`
`).filter(S=>S.trim());console.log("📄 CSV conversion result:",{originalRows:p.e.r-p.s.r+1,csvLines:C.length,firstTenLines:C.slice(0,10),linesWithCommas:C.filter(S=>S.includes(",")).length}),r(_)}}catch(o){console.error("❌ XLSX parsing error:",o),n(new Error(`Failed to parse XLSX file: ${o.message}`))}},i.onerror=()=>n(new Error("Failed to read XLSX file")),i.readAsBinaryString(t)})}static detectFormat(t){const r=this.parseCSVLine(t).map(a=>a.trim());return this.XILINX_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=4?{type:"xilinx",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.XILINX_HEADERS}:this.GENERIC_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=3?{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}:{type:"generic",hasHeader:!1,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static getColumnMapping(t,r){const n=this.parseCSVLine(r).map(s=>s.trim().toLowerCase());console.log("🔍 Detected headers:",n);const i=s=>{for(const o of s){const u=n.findIndex(f=>f.includes(o.toLowerCase()));if(u!==-1)return console.log(`✅ Found column "${o}" at index ${u}: "${n[u]}"`),u}return-1},a={pin:i(["pin","pin_number","pin number","package pin","package_pin","ball","ball_id"]),pinName:i(["pin name","pin_name","name","ball name","ball_name"]),signalName:i(["signal","signal_name","net","net name","signal name"]),direction:i(["direction","dir","type","i/o type","io_type"]),voltage:i(["voltage","volt","io_standard","io standard","vccio"]),bank:i(["bank","bank_number","bank number","io bank"]),memoryByteGroup:i(["memory byte group","byte_group","mbg","memory_byte_group"]),ioType:i(["i/o type","io_type","type","function","io_standard"])};return console.log("📋 Column mapping result:",a),a}static parsePin(t,r,n){var f,d,p,g,v,m,_;if(t.length===0||r.pin===-1||!t[r.pin])return null;const i=(f=t[r.pin])==null?void 0:f.trim();if(!i||i==="NA"||i===""||i.length>10||i.toLowerCase().includes("device")||!/^[A-Za-z0-9]+$/.test(i))return null;const a=((d=t[r.pinName])==null?void 0:d.trim())||i,s=this.parseGridPosition(i);if(!s)return null;const o=this.gridToPosition(s),u={id:crypto.randomUUID(),pinNumber:i,pinName:a,signalName:((p=t[r.signalName||-1])==null?void 0:p.trim())||"",direction:this.parseDirection(t[r.direction||-1]),pinType:this.determinePinType(a),voltage:((g=t[r.voltage||-1])==null?void 0:g.trim())||"3.3V",packagePin:i,position:o,gridPosition:s,isAssigned:!1,bank:(v=t[r.bank||-1])==null?void 0:v.trim(),memoryByteGroup:(m=t[r.memoryByteGroup||-1])==null?void 0:m.trim(),ioType:(_=t[r.ioType||-1])==null?void 0:_.trim()};return u.signalName&&(u.isAssigned=!0),u}static parseGridPosition(t){const r=t.match(/^([A-Z]+)(\d+)$/);return r?{row:r[1],col:parseInt(r[2],10)}:null}static gridToPosition(t){const r=Os(t.row),n=88;return{x:Math.round((t.col-1)*n),y:Math.round(r*n)}}static parseDirection(t){if(!t||t.trim()==="")return"";const r=t.toLowerCase().trim();return r.includes("input")||r.includes("in")?"Input":r.includes("output")||r.includes("out")?"Output":r.includes("inout")||r.includes("bidirectional")?"InOut":r.includes("power")||r.includes("vcc")?"Power":r.includes("ground")||r.includes("gnd")?"Ground":r.includes("clock")||r.includes("clk")?"Clock":r.includes("reset")||r.includes("rst")?"Reset":""}static determinePinType(t){const r=t.toLowerCase();return r.includes("io_l")||r.includes("io_")||r.startsWith("io")?"IO":r.includes("config")||r.includes("tck")||r.includes("tdi")||r.includes("tdo")||r.includes("tms")||r.includes("done")?"CONFIG":r.includes("vcc")||r.includes("vdd")?"POWER":r.includes("gnd")||r.includes("vss")?"GROUND":r.includes("mgt")||r.includes("gt")?"MGT":r.includes("clk")||r.includes("clock")?"CLOCK":r.includes("adc")||r.includes("dac")?"ADC":r.includes("vref")||r.includes("special")?"SPECIAL":r.includes("nc")||r===""?"NC":r.includes("rsvd")||r.includes("reserved")?"RESERVED":"IO"}static parseCSVLine(t){const r=[];let n="",i=!1;for(let a=0;a<t.length;a++){const s=t[a];s==='"'?i=!i:s===","&&!i?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r}static getDefaultFormat(){return{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static createPackageFromPins(t,r="Unknown"){if(t.length===0)return{id:crypto.randomUUID(),name:r,device:"Unknown",packageType:"Unknown",dimensions:{rows:0,cols:0},pins:[],totalPins:0};const n=Math.max(...t.map(a=>Os(a.gridPosition.row)))+1,i=Math.max(...t.map(a=>a.gridPosition.col));return{id:crypto.randomUUID(),name:r,device:r.split("-")[0]||"Unknown",packageType:r.split("-")[1]||"Unknown",dimensions:{rows:n,cols:i},pins:t,totalPins:t.length}}static detectIntelAlteraFormat(t){console.log("🔍 Detecting Intel/Altera format...");for(let r=0;r<Math.min(10,t.length);r++){const n=t[r];if(n&&Array.isArray(n)&&n.length>=4){const i=n.join(",").toLowerCase();if(console.log(`Row ${r}: "${i.substring(0,100)}..."`),i.includes("pin name/function")&&(i.includes("bank number")||i.includes("bank"))&&(i.includes("vref")||i.includes("configuration function")))return console.log("✅ Intel/Altera format detected!"),!0}}return console.log("❌ Intel/Altera format not detected"),!1}static processIntelAlteraXLSX(t){console.log("🔧 Processing Intel/Altera XLSX format...");let r=-1,n=-1,i=-1,a=-1;for(let u=0;u<Math.min(10,t.length);u++){const f=t[u];if(f&&Array.isArray(f)&&f.length>=4){const d=f.map(p=>p?p.toString().toLowerCase().trim():"");if(d.some(p=>p.includes("pin name/function"))){r=u;for(let p=0;p<d.length;p++){const g=d[p];p===0&&(g.includes("v")||g.match(/^[a-z]\d+$/)||g.length<=3)?n=p:g.includes("pin name/function")?i=p:(g.includes("bank number")||g.includes("bank"))&&(a=p)}break}}}if(r===-1)return console.warn("⚠️ Intel/Altera header not found, fallback to standard processing"),"";console.log("📋 Intel/Altera format detected:",{headerRowIndex:r,pinNumberCol:n,pinNameCol:i,bankCol:a});const s=[];let o=0;s.push("Pin,Pin Name,Signal,Direction,Voltage,Package_Pin,Row,Col,Bank,Type");for(let u=r+1;u<t.length;u++){const f=t[u];if(!f||!Array.isArray(f)||f.length<4)continue;const d=f[n]?f[n].toString().trim():"",p=f[i]?f[i].toString().trim():"",g=f[a]?f[a].toString().trim():"";if(o<10&&console.log(`🔍 Processing pin ${o+1}: Number="${d}", Name="${p}", Bank="${g}"`),!d||d===""||p.toLowerCase().includes("nc")||p.toLowerCase().includes("no connect")){o<10&&console.log(`⏭️ Skipping NC/empty pin: "${d}" / "${p}"`);continue}if(!d.match(/^[A-Z0-9_]+\d*$/i)){o<10&&console.log(`🔍 Skipping invalid pin format: "${d}"`);continue}let v="IO";(p.toLowerCase().includes("power")||p.toLowerCase().includes("vcc")||p.toLowerCase().includes("gnd"))&&(v="POWER");const m=d.match(/^([A-Z])(\d+)$/i),_=m?m[1].toUpperCase():"A",C=m?m[2]:"1",S=[d,p||d,"","","",d,_,C,g||"NA",v].join(",");s.push(S),o++}return console.log(`✅ Intel/Altera processing complete: ${o} pins processed from ${t.length-r-1} data rows`),s.join(`
`)}};vx.XILINX_HEADERS=["Pin","Pin Name","Memory Byte Group","Bank","VCCAUX Group","Super Logic Region","I/O Type","No-Connect"];vx.GENERIC_HEADERS=["Pin","Signal","Direction","Voltage","Package_Pin","Row","Col"];let Hf=vx;const nu=["1.0V","1.2V","1.5V","1.8V","2.5V","3.3V","5.0V"],Kd=["LVCMOS12","LVCMOS15","LVCMOS18","LVCMOS25","LVCMOS33","LVTTL","LVDS_18","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","PPDS_25","TMDS_33","SSTL135","SSTL15","SSTL18_I","SSTL18_II","SSTL2_I","SSTL2_II","SSTL3_I","SSTL3_II","POD10","POD12","POD135","POD15","DDR3","DDR4","DDR5","HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18","PCI","PCIX","GTL_PLUS","AUTO"],Eb={"1.0V":"POD10","1.2V":"LVCMOS12","1.5V":"LVCMOS15","1.8V":"LVCMOS18","2.5V":"LVCMOS25","3.3V":"LVCMOS33","5.0V":"LVTTL"},Nw={"1.0V":["POD10"],"1.2V":["LVCMOS12","POD12","SSTL135"],"1.5V":["LVCMOS15","SSTL15","HSTL_I","HSTL_II","POD15"],"1.8V":["LVCMOS18","SSTL18_I","SSTL18_II","HSTL_I_18","HSTL_II_18","LVDS_18"],"2.5V":["LVCMOS25","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","PPDS_25","SSTL2_I","SSTL2_II"],"3.3V":["LVCMOS33","LVTTL","TMDS_33","SSTL3_I","SSTL3_II","PCI","PCIX"],"5.0V":["LVTTL","GTL_PLUS"]},Cb=["---DriveStrength---","2","4","6","8","12","16","20","24"],Tb=["---SlewRate---","SLOW","FAST"];function Yd(e){return Nw[e]||["LVCMOS33"]}function Ms(e){return Eb[e]||"LVCMOS33"}function Ab(e,t){return t==="AUTO"?!0:(Nw[e]||[]).includes(t)}class Ia{static exportToXDC(t,r){const n=t.filter(s=>s.isAssigned&&s.signalName.trim()!==""),i=["# Xilinx Design Constraints (XDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),a=n.map(s=>{var p,g,v;const o=[];o.push(`set_property PACKAGE_PIN ${s.pinNumber} [get_ports ${s.signalName}]`);const u=((p=s.attributes)==null?void 0:p.IO_Standard)||s.ioType;if(u&&u!=="AUTO")o.push(`set_property IOSTANDARD ${u} [get_ports ${s.signalName}]`);else if(s.voltage){const m=Ms(s.voltage);o.push(`set_property IOSTANDARD ${m} [get_ports ${s.signalName}]`)}const f=(g=s.attributes)==null?void 0:g.Drive_Strength;f&&f!=="---DriveStrength---"&&(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property DRIVE ${f} [get_ports ${s.signalName}]`);const d=(v=s.attributes)==null?void 0:v.Slew_Rate;return d&&d!=="---SlewRate---"&&(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property SLEW ${d} [get_ports ${s.signalName}]`),o.join(`
`)}).join(`

`);return i+a}static exportToSDC(t,r){const n=t.filter(o=>o.isAssigned&&o.signalName.trim()!==""),i=o=>o.replace(/[^\w_]/g,"_").replace(/^(\d)/,"sig_$1").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),a=["# Synopsys Design Constraints (SDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),s=n.map(o=>{const u=[],f=i(o.signalName);if(u.push(`set_location_assignment PIN_${o.pinNumber} -to ${f}`),o.voltage){const d=o.voltage==="3.3V"?"LVCMOS33":o.voltage==="1.8V"?"LVCMOS18":o.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";u.push(`set_instance_assignment -name IO_STANDARD "${d}" -to ${f}`)}return(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name CURRENT_STRENGTH_NEW "12mA" -to ${f}`),(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name SLEW_RATE 1 -to ${f}`),u.join(`
`)}).join(`

`);return a+s}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Direction","Pin Type","Voltage","Bank","I/O Type","Is Assigned"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.direction,i.pinType,i.voltage,i.bank||"",i.ioType||"",i.isAssigned?"Yes":"No"]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportReport(t,r){const n=t.filter(o=>o.isAssigned),i=t.filter(o=>!o.isAssigned),a=new Map;return t.forEach(o=>{const u=o.bank||"Unknown";a.has(u)||a.set(u,{assigned:0,total:0});const f=a.get(u);f.total++,o.isAssigned&&f.assigned++}),["# FPGA Pin Assignment Report",`# Generated: ${new Date().toLocaleString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"","## Summary",`- Total Pins: ${t.length}`,`- Assigned Pins: ${n.length}`,`- Unassigned Pins: ${i.length}`,`- Assignment Rate: ${(n.length/t.length*100).toFixed(1)}%`,"","## Bank Statistics",...Array.from(a.entries()).map(([o,u])=>`- Bank ${o}: ${u.assigned}/${u.total} (${(u.assigned/u.total*100).toFixed(1)}%)`),"","## Assigned Pins",...n.map(o=>`${o.pinNumber.padEnd(8)} | ${o.signalName.padEnd(20)} | Bank ${(o.bank||"N/A").padEnd(3)} | ${o.pinType}`),"","## Pin Type Distribution",...Object.entries(t.reduce((o,u)=>(o[u.pinType]=(o[u.pinType]||0)+1,o),{})).map(([o,u])=>`- ${o}: ${u}`)].join(`
`)}static downloadFile(t,r,n="text/plain"){const i=new Blob([t],{type:n}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}class hn{static createSaveData(t){var n,i,a,s,o,u;const r=new Date().toISOString();return{metadata:{version:this.SAVE_VERSION,created:r,modified:r,appVersion:"1.0.0",description:`FPGA Pin Planning Project - ${((n=t.package)==null?void 0:n.device)||"Unknown Device"}`,author:"FPGA Pin Planner User"},package:{device:((i=t.package)==null?void 0:i.device)||"",packageType:((a=t.package)==null?void 0:a.packageType)||""},pins:t.pins.map(f=>({id:f.id,pinNumber:f.pinNumber,pinName:f.pinName,assignedSignalName:f.signalName,comment:f.comment,bank:f.bank,pinType:f.pinType,gridPosition:f.gridPosition,differentialPair:f.differentialPair})),viewSettings:{zoom:t.viewConfig.zoom,rotation:t.viewConfig.rotation,isTopView:t.viewConfig.isTopView,viewport:t.viewConfig.viewport||{x:0,y:0,scale:1},selectedPins:Array.from(t.selectedPins),filters:t.filters},projectSettings:{listViewActiveTab:((s=t.listView)==null?void 0:s.activeTab)||"overview",sidebarWidth:((o=t.ui)==null?void 0:o.sidebarWidth)||300,showDifferentialPairs:((u=t.ui)==null?void 0:u.showDifferentialPairs)||!1,customSettings:t.projectSettings||{}},history:t.history||{currentIndex:0,actions:[]}}}static async saveToFile(t,r){const n=t.package.device.replace(/[^a-zA-Z0-9]/g,"_"),i=new Date().toISOString().split("T")[0],a=`${n}_project_${i}${this.FILE_EXTENSION}`,s=r||a,o=JSON.stringify(t,null,2),u=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=s,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}static async loadFromFile(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=JSON.parse(o);if(!this.isCompatibleVersion(u.metadata.version))throw new Error(`Incompatible save file version: ${u.metadata.version}`);if(!u.package||!u.pins||!Array.isArray(u.pins))throw new Error("Invalid save file format: missing required fields");r(u)}catch(o){n(new Error(`Failed to parse save file: ${o}`))}},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static restoreProject(t){const r={id:`package-${Date.now()}`,name:t.package.device,device:t.package.device,packageType:t.package.packageType,dimensions:{rows:Math.max(...t.pins.map(i=>{var a;return Os(((a=i.gridPosition)==null?void 0:a.row)||"A")+1})),cols:Math.max(...t.pins.map(i=>{var a;return((a=i.gridPosition)==null?void 0:a.col)||1}))},totalPins:t.pins.length,pins:t.pins.map(i=>({id:i.id,pinNumber:i.pinNumber,pinName:i.pinName,signalName:i.assignedSignalName||i.originalSignalName||"",direction:"InOut",pinType:i.pinType,voltage:"3.3V",packagePin:i.pinNumber,position:this.gridToPosition(i.gridPosition||{row:"A",col:1}),gridPosition:i.gridPosition||{row:"A",col:1},isAssigned:!!i.assignedSignalName,bank:i.bank||"NA",comment:i.comment||"",differentialPair:i.differentialPair}))};return{id:`project-${Date.now()}`,name:t.metadata.description||`Restored Project ${new Date().toLocaleDateString()}`,description:t.metadata.description||"",created:new Date(t.metadata.created),modified:new Date(t.metadata.modified),projectInfo:{device:t.package.device,package:t.package.packageType,speedGrade:t.package.speedGrade||"-1",temperature:"C"},packageData:r,pinAssignments:r.pins,viewConfig:{rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,zoom:t.viewSettings.zoom,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},filters:{pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"pinNumber",sortOrder:"asc"}}}static restoreAppState(t,r){return{pins:r.pins.map(i=>{const a=t.pins.find(s=>s.id===i.id||s.pinNumber===i.pinNumber);return a?{...i,signalName:a.assignedSignalName||i.signalName,comment:a.comment||i.comment,differentialPair:a.differentialPair||i.differentialPair}:i}),selectedPins:new Set(t.viewSettings.selectedPins),viewConfig:{zoom:t.viewSettings.zoom,rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,viewport:t.viewSettings.viewport},filters:t.viewSettings.filters,listView:{activeTab:t.projectSettings.listViewActiveTab||"overview"},ui:{sidebarWidth:t.projectSettings.sidebarWidth,showDifferentialPairs:t.projectSettings.showDifferentialPairs},history:t.history,projectSettings:t.projectSettings.customSettings}}static isCompatibleVersion(t){const[r]=t.split(".").map(Number),[n]=this.SAVE_VERSION.split(".").map(Number);return r<=n}static quickSave(t){try{const r=this.createSaveData(t),n=this.compressData(r);localStorage.setItem(this.QUICKSAVE_KEY,n),localStorage.setItem(this.QUICKSAVE_TIMESTAMP_KEY,new Date().toISOString()),console.log("📁 Quick save completed")}catch(r){throw console.error("Failed to quick save:",r),new Error(`Quick save failed: ${r}`)}}static quickLoad(){try{const t=localStorage.getItem(this.QUICKSAVE_KEY);return t?this.decompressData(t):null}catch(t){return console.error("Failed to load quicksave:",t),null}}static getQuickSaveInfo(){const t=localStorage.getItem(this.QUICKSAVE_TIMESTAMP_KEY);return{exists:localStorage.getItem(this.QUICKSAVE_KEY)!==null,timestamp:t||void 0}}static clearQuickSave(){localStorage.removeItem(this.QUICKSAVE_KEY),localStorage.removeItem(this.QUICKSAVE_TIMESTAMP_KEY)}static compressData(t){const r={metadata:{version:t.metadata.version,created:t.metadata.created},package:t.package,pins:t.pins.map(n=>({id:n.id,pinNumber:n.pinNumber,assignedSignalName:n.assignedSignalName,comment:n.comment,...n.differentialPair&&{differentialPair:n.differentialPair},...n.custom&&Object.keys(n.custom).length>0&&{custom:n.custom}})),viewSettings:t.viewSettings,projectSettings:t.projectSettings};return JSON.stringify(r)}static decompressData(t){const r=JSON.parse(t);return{metadata:{version:r.metadata.version,created:r.metadata.created,modified:new Date().toISOString(),appVersion:"1.0.0",description:"Quick Save Data"},package:r.package,pins:r.pins,viewSettings:r.viewSettings,projectSettings:r.projectSettings||{},constraints:{},history:{currentIndex:0,actions:[]}}}static gridToPosition(t){const r=Os(t.row),i=88,a=(t.col-1)*i,s=r*i;return{x:Math.round(a),y:Math.round(s)}}}hn.SAVE_VERSION="1.0.0";hn.FILE_EXTENSION=".fpgaproj";hn.QUICKSAVE_KEY="fpga-planner-quicksave";hn.QUICKSAVE_TIMESTAMP_KEY="fpga-planner-quicksave-timestamp";class Ht{static getDifferentialPairType(t){const r=t.toLowerCase();if(r.endsWith("_p"))return"positive";if(r.endsWith("_n"))return"negative";if(r.endsWith("+"))return"positive";if(r.endsWith("-"))return"negative";if(r.endsWith("p")&&!r.endsWith("_p")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"positive"}if(r.endsWith("n")&&!r.endsWith("_n")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"negative"}const n=r.match(/^(.+_l\d+)([pn])(_.*)?$/);if(n){const i=n[2];if(i==="p")return"positive";if(i==="n")return"negative"}return null}static getPairPinName(t){const r=t.toLowerCase(),n=t;if(r.endsWith("_p"))return n.slice(0,-2)+"_N";if(r.endsWith("_n"))return n.slice(0,-2)+"_P";if(r.endsWith("+"))return n.slice(0,-1)+"-";if(r.endsWith("-"))return n.slice(0,-1)+"+";if(r.endsWith("p")&&!r.endsWith("_p")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"N"}if(r.endsWith("n")&&!r.endsWith("_n")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"P"}const i=n.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const s=i[1],o=i[2].toUpperCase(),u=i[3]||"";if(o==="P")return s+"N"+u;if(o==="N")return s+"P"+u}const a=r.match(/^(.+?)(\d+)$/);if(a){const s=a[1],o=parseInt(a[2]),u=o%2===0?o+1:o-1;return n.substring(0,s.length)+u}return null}static findPairPin(t,r){const n=this.getPairPinName(t.pinName);if(n){const a=r.find(s=>s.pinName.toLowerCase()===n.toLowerCase()&&s.bank===t.bank);if(a)return a}const i=t.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const a=i[1],o=i[2].toUpperCase()==="P"?"N":"P",u=r.find(f=>{if(f.bank!==t.bank)return!1;const d=f.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(d){const p=d[1],g=d[2].toUpperCase();return p.toLowerCase()===a.toLowerCase()&&g===o}return!1});if(u)return u}if(t.signalName){const a=this.getPairPinName(t.signalName);if(a){const s=r.find(o=>o.signalName&&o.signalName.toLowerCase()===a.toLowerCase()&&o.bank===t.bank);if(s)return s}}return null}static isDifferentialPin(t){return!!(this.getDifferentialPairType(t.pinName)!==null||t.signalName&&this.getDifferentialPairType(t.signalName)!==null)}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);const n=r.match(/^(.+?)(\d+)$/);return n?t.substring(0,n[1].length):t}static getDifferentialPriority(t){const r=this.getDifferentialPairType(t.pinName),n=t.signalName?this.getDifferentialPairType(t.signalName):null,i=r||n;return i==="positive"?1:i==="negative"?2:3}}const Pb=({pin:e,isSelected:t,onSelect:r,onAssignSignal:n,onUpdatePin:i,isPairPin:a=!1,isDifferentialPairPartner:s=!1})=>{var m,_,C;const[o,u]=ke.useState(!1),f=S=>{n(e.id,S.target.value)},d=(S,w)=>{var T;if(!i)return;const x={};if(S==="direction")x.direction=w;else if(S==="voltage"){x.voltage=w;const A=((T=e.attributes)==null?void 0:T.IO_Standard)||e.ioType||"AUTO";if(A==="AUTO"||!Yd(w).includes(A)){const N=Ms(w);x.attributes={...e.attributes,IO_Standard:N},x.ioType=N}}else S==="ioStandard"?(x.attributes={...e.attributes,IO_Standard:w},x.ioType=w):S==="driveStrength"?x.attributes={...e.attributes,Drive_Strength:w}:S==="slewRate"&&(x.attributes={...e.attributes,Slew_Rate:w});console.log("PinItem updating pin:",e.id,"with updates:",x),i(e.id,x)},p=S=>({IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999"})[S]||"#666666",g=Ht.getDifferentialPairType(e.pinName)||(e.signalName?Ht.getDifferentialPairType(e.signalName):null),v=Ht.isDifferentialPin(e);return["POWER","GROUND","NC"].includes(e.pinType),k.jsxs("div",{className:`pin-item ${t?"selected":""}`,onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",padding:"8px 12px",margin:"2px 0",backgroundColor:t?"#444":s?"#3d4852":a?"#2d3748":"#2a2a2a",borderRadius:"4px",cursor:"pointer",border:`2px solid ${t?"#4A90E2":s?"#f59e0b":a?"#9333ea":"transparent"}`,position:"relative"},children:[v&&k.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",fontSize:"10px",color:g==="positive"?"#22c55e":"#ef4444",fontWeight:"bold"},title:`Differential ${g==="positive"?"Positive":"Negative"} Pin`,children:g==="positive"?"⚡+":"⚡-"}),s&&k.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"12px",color:"#f59e0b",fontWeight:"bold"},title:"Differential Pair Partner of Selected Pin",children:"⇌"}),a&&!s&&k.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"10px",color:"#9333ea",fontWeight:"bold"},title:"Differential Pair Pin",children:"⟷"}),k.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[k.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:p(e.pinType),marginRight:"8px",flexShrink:0}}),k.jsx("div",{style:{minWidth:"60px",fontFamily:"monospace",fontSize:"12px",color:"#ccc"},children:e.pinNumber}),k.jsx("div",{style:{minWidth:"120px",fontSize:"11px",color:"#999",marginRight:"8px",flex:1},children:e.pinName}),k.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:e.isAssigned?"#4AE24A":"#666",marginLeft:"8px",flexShrink:0}})]}),k.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:k.jsx("input",{type:"text",value:e.signalName,onChange:f,placeholder:"Signal name",onClick:S=>S.stopPropagation(),style:{flex:1,padding:"4px 8px",fontSize:"12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"}})}),!["POWER","GROUND","NC"].includes(e.pinType)&&k.jsxs("div",{style:{display:"flex",gap:"6px",marginTop:"4px",marginBottom:"4px"},children:[k.jsx("div",{style:{flex:1},children:k.jsxs("select",{value:e.direction,onChange:S=>{S.stopPropagation(),d("direction",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"2px 4px",fontSize:"10px",backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"3px",color:"#ccc"},children:[k.jsx("option",{value:"",children:"---Direction---"}),k.jsx("option",{value:"Input",children:"Input"}),k.jsx("option",{value:"Output",children:"Output"}),k.jsx("option",{value:"InOut",children:"InOut"}),k.jsx("option",{value:"Clock",children:"Clock"}),k.jsx("option",{value:"Reset",children:"Reset"})]})}),k.jsx("div",{style:{flex:1},children:k.jsxs("select",{value:((m=e.attributes)==null?void 0:m.IO_Standard)||e.ioType||"AUTO",onChange:S=>{S.stopPropagation(),d("ioStandard",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"2px 4px",fontSize:"10px",backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"3px",color:"#ccc"},children:[k.jsx("option",{value:"",children:"---Standards---"}),k.jsx("option",{value:"AUTO",children:"AUTO"}),Yd(e.voltage||"3.3V").map(S=>k.jsx("option",{value:S,children:S},S))]})})]}),e.bank&&k.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"11px",color:"#666"},children:[k.jsx("span",{style:{marginRight:"4px"},children:"🏦"}),k.jsxs("span",{children:["Bank ",e.bank]})]}),!["POWER","GROUND","NC"].includes(e.pinType)&&k.jsxs("div",{style:{marginTop:"6px"},children:[k.jsxs("button",{onClick:S=>{S.stopPropagation(),u(!o)},style:{width:"100%",padding:"2px 6px",fontSize:"9px",backgroundColor:o?"#2563eb":"#374151",border:"1px solid #555",borderRadius:"2px",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[k.jsx("span",{children:"Advanced"}),k.jsx("span",{style:{fontSize:"7px"},children:o?"▼":"▶"})]}),o&&k.jsxs("div",{style:{marginTop:"4px",padding:"6px",backgroundColor:"#1e1e1e",border:"1px solid #333",borderRadius:"3px"},children:[k.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"4px"},children:[k.jsxs("div",{style:{flex:1},children:[k.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Voltage"}),k.jsx("select",{value:e.voltage||"3.3V",onChange:S=>{S.stopPropagation(),d("voltage",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:nu.map(S=>k.jsx("option",{value:S,children:S},S))})]}),k.jsxs("div",{style:{flex:1},children:[k.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Drive Strength"}),k.jsx("select",{value:((_=e.attributes)==null?void 0:_.Drive_Strength)||"---DriveStrength---",onChange:S=>{S.stopPropagation(),d("driveStrength",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:Cb.map(S=>k.jsx("option",{value:S,children:S==="---DriveStrength---"?S:`${S}mA`},S))})]})]}),k.jsxs("div",{children:[k.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Slew Rate"}),k.jsx("select",{value:((C=e.attributes)==null?void 0:C.Slew_Rate)||"---SlewRate---",onChange:S=>{S.stopPropagation(),d("slewRate",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:Tb.map(S=>k.jsx("option",{value:S,children:S},S))})]})]})]})]})},Fb=({isOpen:e,onClose:t,onExport:r,pins:n,currentPackage:i})=>{const[a,s]=ke.useState("xdc"),[o,u]=ke.useState(!1);if(!e)return null;const f=[{value:"xdc",label:"XDC (Xilinx)",description:"Xilinx Design Constraints format for Vivado and ISE",icon:"📄",example:"set_property PACKAGE_PIN A1 [get_ports clk]"},{value:"sdc",label:"SDC (Intel/Altera)",description:"Synopsys Design Constraints format for Quartus",icon:"📄",example:"set_location_assignment PIN_A1 -to clk"}],d=f.find(m=>m.value===a),p=n.filter(m=>m.isAssigned&&m.signalName.trim()!=="").length,g=()=>{r(a),t()},v=()=>{if(!o)return null;const m=n.filter(_=>_.isAssigned&&_.signalName.trim()!=="").slice(0,3);return a==="xdc"?Ia.exportToXDC(m,i):Ia.exportToSDC(m,i)};return k.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:k.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",padding:"24px",width:"500px",maxHeight:"80vh",overflow:"auto",color:"white"},children:[k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[k.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"Export Constraint File"}),k.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"20px",cursor:"pointer",padding:"4px"},children:"✕"})]}),k.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#ccc"},children:[p," assigned pins will be exported"]}),k.jsxs("div",{style:{marginBottom:"20px"},children:[k.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:"Choose constraint file format:"}),f.map(m=>k.jsxs("div",{style:{border:`2px solid ${a===m.value?"#007acc":"#444"}`,borderRadius:"6px",padding:"12px",marginBottom:"8px",cursor:"pointer",backgroundColor:a===m.value?"#1a4c80":"#333",transition:"all 0.2s ease"},onClick:()=>s(m.value),children:[k.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[k.jsx("span",{style:{fontSize:"16px",marginRight:"8px"},children:m.icon}),k.jsx("span",{style:{fontWeight:"bold",fontSize:"16px"},children:m.label})]}),k.jsx("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"6px"},children:m.description}),k.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:"#bbb",backgroundColor:"#1a1a1a",padding:"4px 8px",borderRadius:"3px"},children:["Example: ",m.example]})]},m.value))]}),p>0&&k.jsxs("div",{style:{marginBottom:"20px"},children:[k.jsx("button",{onClick:()=>u(!o),style:{backgroundColor:"#444",border:"1px solid #666",borderRadius:"4px",color:"white",padding:"6px 12px",cursor:"pointer",fontSize:"12px"},children:o?"Hide Preview":"Show Preview"}),o&&k.jsx("div",{style:{marginTop:"8px",backgroundColor:"#1a1a1a",border:"1px solid #444",borderRadius:"4px",padding:"12px",maxHeight:"200px",overflow:"auto"},children:k.jsx("pre",{style:{margin:0,fontSize:"11px",color:"#ddd",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:v()})})]}),k.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[k.jsx("button",{onClick:t,style:{backgroundColor:"#666",border:"1px solid #888",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),k.jsxs("button",{onClick:g,disabled:p===0,style:{backgroundColor:p>0?"#007acc":"#555",border:"1px solid #007acc",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:p>0?"pointer":"not-allowed",fontSize:"14px",opacity:p>0?1:.6},children:["Export ",d==null?void 0:d.label]})]})]})})},gg=[{id:"overview",title:"Overview",icon:"📋",description:"All pins with key information",showSearch:!0,showFilters:!0,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}]},{id:"signals",title:"Signals",icon:"⚡",description:"Assigned signal information",showSearch:!0,showFilters:!0,columns:[{key:"signalName",title:"Signal Name",width:140,editable:!0,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"direction",title:"Direction",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>!!(e.signalName&&e.signalName.trim()!==""),sort:(e,t)=>(e.signalName||"").localeCompare(t.signalName||"")},{id:"bankGroups",title:"Bank Stats",icon:"📊",description:"Dynamic bank groups statistics and analysis",showSearch:!1,showFilters:!1,isCustomComponent:!0,columns:[],filter:()=>!0,sort:()=>0},{id:"banks",title:"Banks",icon:"🏦",description:"Pin organization by I/O banks",showSearch:!0,showFilters:!0,columns:[{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioType",title:"I/O Type",width:80,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>!!(e.bank&&e.bank.trim()!==""),sort:(e,t)=>{const r=parseInt(e.bank||"999"),n=parseInt(t.bank||"999");return r-n}},{id:"differential",title:"Diff Pairs",icon:"⟷",description:"Differential pair management",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"differentialPair",title:"Pair Name",width:100,sortable:!0,customRender:(e,t)=>t.differentialPair?`${t.differentialPair.pair} (${t.differentialPair.type})`:"-"},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>e.differentialPair!==void 0,sort:(e,t)=>{var i,a;const r=((i=e.differentialPair)==null?void 0:i.pair)||"",n=((a=t.differentialPair)==null?void 0:a.pair)||"";return r.localeCompare(n)}},{id:"comments",title:"Comments",icon:"💬",description:"All pins with user comments",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"signalName",title:"Signal",width:100,sortable:!0},{key:"comment",title:"Comment",width:300,editable:!0},{key:"commentTimestamp",title:"Modified",width:120,render:"datetime",sortable:!0},{key:"commentAuthor",title:"Author",width:80,sortable:!0}],filter:e=>!!(e.comment&&e.comment.trim()!==""),sort:(e,t)=>{var i,a;const r=((i=e.commentTimestamp)==null?void 0:i.getTime())||0;return(((a=t.commentTimestamp)==null?void 0:a.getTime())||0)-r}},{id:"power",title:"Power",icon:"⚡",description:"Power and ground pins",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>e.pinType==="POWER"||e.pinType==="GROUND"||e.direction==="Power"||e.direction==="Ground",sort:(e,t)=>e.pinNumber.localeCompare(t.pinNumber)}],Nb=({value:e,onSave:t,options:r,editable:n=!1,placeholder:i="",className:a="",allowCustomValue:s=!1,getDisplayValue:o})=>{const[u,f]=ke.useState(!1),[d,p]=ke.useState(e||""),g=ke.useRef(null),v=()=>{d!==e&&t(d),f(!1)},m=()=>{p(e||""),f(!1)},_=S=>{S.key==="Enter"?(S.preventDefault(),v()):S.key==="Escape"&&(S.preventDefault(),m())};if(ke.useEffect(()=>{u&&g.current&&g.current.focus()},[u]),ke.useEffect(()=>{p(e||"")},[e]),!n){const S=o?o(e):e;return k.jsx("span",{className:`table-cell-readonly ${a}`,children:S||"-"})}if(u)return k.jsxs("select",{ref:g,value:d,onChange:S=>p(S.target.value),onBlur:v,onKeyDown:_,className:`table-cell-select ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"},children:[i&&k.jsx("option",{value:"",disabled:!0,children:i}),r.map(S=>k.jsx("option",{value:S,children:o?o(S):S},S)),s&&d&&!r.includes(d)&&k.jsxs("option",{value:d,children:[d," (Custom)"]})]});const C=o?o(e):e;return k.jsxs("div",{className:`table-cell-selectable ${a}`,onClick:()=>f(!0),title:"Click to select",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"pointer",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:S=>{S.currentTarget.style.borderColor="#555",S.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:S=>{S.currentTarget.style.borderColor="transparent",S.currentTarget.style.backgroundColor="transparent"},children:[k.jsx("span",{children:C||k.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:i})}),k.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:"4px"},children:"▼"})]})},mg=({value:e,onSave:t,editable:r=!1,placeholder:n="",maxLength:i=500,className:a="",type:s="text",options:o=[],allowCustomValue:u=!1,getDisplayValue:f})=>{const[d,p]=ke.useState(!1),[g,v]=ke.useState(e||""),m=ke.useRef(null),_=()=>{g!==e&&t(g),p(!1)},C=()=>{v(e||""),p(!1)},S=w=>{w.key==="Enter"?(w.preventDefault(),_()):w.key==="Escape"&&(w.preventDefault(),C())};return ke.useEffect(()=>{d&&m.current&&(m.current.focus(),m.current.select())},[d]),ke.useEffect(()=>{v(e||"")},[e]),s==="select"?k.jsx(Nb,{value:e,onSave:t,options:o,editable:r,placeholder:n,className:a,allowCustomValue:u,getDisplayValue:f}):(ke.useEffect(()=>{v(e||"")},[e]),r?d?k.jsx("input",{ref:m,type:"text",value:g,onChange:w=>v(w.target.value),onBlur:_,onKeyDown:S,placeholder:n,maxLength:i,className:`table-cell-input ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"}}):k.jsx("div",{className:`table-cell-editable ${a}`,onClick:()=>p(!0),title:"Click to edit",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"text",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.borderColor="#555",w.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:w=>{w.currentTarget.style.borderColor="transparent",w.currentTarget.style.backgroundColor="transparent"},children:e||k.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:n})}):k.jsx("span",{className:`table-cell-readonly ${a}`,children:e||"-"}))},Rb="#e0e0e0",Ib="#ccc",bb="#cccccc",Ob="#FFF",Db="#000",Lb="#374151",Mb="#666",Bb=[Rb,Ib,bb,Ob,Db,Lb,Mb],jb=[{min:224,max:255,channels:["r","g","b"]},{min:0,max:48,channels:["r","g","b"]},{min:192,max:208,channels:["r","g","b"]}];function Ub(e,t,r){for(const n of jb)if(n.channels.every(a=>{const s=a==="r"?e:a==="g"?t:r;return s>=n.min&&s<=n.max}))return!0;for(const n of Bb){const i=parseInt(n.slice(1,3),16),a=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);if(Math.sqrt(Math.pow(e-i,2)+Math.pow(t-a,2)+Math.pow(r-s,2))<80)return!0}return!1}function zb(e){const t=[],r=.618033988749895,n=.7,i=.5;for(let a=0;a<e;a++){let s=a*r%1,o=0,u=!1;for(;!u&&o<10;){const f=Vb(s,n,i);Ub(f.r,f.g,f.b)?(s=(s+.1)%1,o++):(t.push(`#${f.r.toString(16).padStart(2,"0")}${f.g.toString(16).padStart(2,"0")}${f.b.toString(16).padStart(2,"0")}`),u=!0)}u||t.push(`#${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}`)}return t}function Vb(e,t,r){let n,i,a;if(t===0)n=i=a=r;else{const s=(f,d,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?f+(d-f)*6*p:p<.5?d:p<.6666666666666666?f+(d-f)*(.6666666666666666-p)*6:f),o=r<.5?r*(1+t):r+t-r*t,u=2*r-o;n=s(u,o,e+1/3),i=s(u,o,e),a=s(u,o,e-1/3)}return{r:Math.round(n*255),g:Math.round(i*255),b:Math.round(a*255)}}const Wc=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#F39C12","#E74C3C","#9B59B6","#3498DB","#1ABC9C","#2ECC71","#F1C40F","#E67E22","#E91E63","#673AB7"];function vo(e){if(!e||e==="NA")return"#708090";if(e==="POWER"||e==="VCC")return"#8B4513";if(e==="GROUND"||e==="GND")return"#2C2C2C";const t=parseInt(e);if(!isNaN(t)){if(t<Wc.length)return Wc[t];{const i=zb(t-Wc.length+1);return i[i.length-1]}}let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)&4294967295;const n=Math.abs(r)%Wc.length;return Wc[n]}const Rw=(e,t,r)=>{if(t)return"#2d4f75";if(!e)return r?"#2a2a2a":"#1a1a1a";const n=vo(e),i=Gb(n,.7);return r?Hb(i,.2):i},Gb=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.max(0,(r>>16)-n),a=Math.max(0,(r>>8&255)-n),s=Math.max(0,(r&255)-n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},Hb=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.min(255,(r>>16)+n),a=Math.min(255,(r>>8&255)+n),s=Math.min(255,(r&255)+n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},$c=48,M3=5,Wb=({pins:e,columns:t,selectedRows:r,hoveredRowId:n,sortColumn:i,sortDirection:a,onRowSelection:s,onPinSelect:o,onRangeSelect:u,onHover:f,onColumnSort:d,renderCellContent:p})=>{const[g,v]=ke.useState(0),[m,_]=ke.useState(400),[C,S]=ke.useState(null),w=ke.useRef(null),x=ke.useRef(null),T=ke.useMemo(()=>{const b=Math.floor(g/$c),M=Math.ceil(m/$c),D=Math.min(b+M+M3*2,e.length),Q=Math.max(0,b-M3);return{start:Q,end:D,visibleCount:D-Q}},[g,m,e.length]),A=ke.useCallback((b,M,D)=>{var z;const Q=D.target.checked,he=(z=D.nativeEvent)==null?void 0:z.shiftKey;if(bf("CHECKBOX",pa.CHECKBOX,"Checkbox clicked",{pinId:b.id,index:M,isChecked:Q,shiftKey:he,lastClickedIndex:C,onRangeSelect:!!u}),he&&C!==null&&u){const Z=Math.min(C,M),ae=Math.max(C,M);bf("RANGE",pa.RANGE,"Checkbox range selection",{fromIndex:Z,toIndex:ae,lastClickedIndex:C,currentIndex:M}),u(Z,ae),S(M)}else bf("CHECKBOX",pa.CHECKBOX,"Individual checkbox toggle",{pinId:b.id,isChecked:Q}),s(b.id,Q),S(M)},[C,u,s,S]),N=ke.useCallback(b=>{bf("SELECTION",pa.SELECTION,"Row click - 3D view selection",{pinId:b.id}),o==null||o(b.id)},[o]),R=ke.useMemo(()=>e.slice(T.start,T.end),[e,T.start,T.end]),P=ke.useCallback(b=>{const M=b.target;console.log("📊 Scroll Event:",{scrollTop:M.scrollTop,scrollHeight:M.scrollHeight,clientHeight:M.clientHeight,maxScroll:M.scrollHeight-M.clientHeight}),v(M.scrollTop)},[]);ke.useEffect(()=>{const b=()=>{if(w.current){const D=w.current.getBoundingClientRect();_(D.height)}};b();const M=new ResizeObserver(b);return w.current&&M.observe(w.current),()=>{M.disconnect()}},[]);const I=e.length*$c;return ke.useEffect(()=>{console.log("🚀 VirtualizedPinList Debug:",{totalPins:e.length,visibleCount:T.visibleCount,visiblePercent:Math.round(T.visibleCount/e.length*100),totalHeight:I,containerHeight:m,scrollTop:g,visibleStart:T.start,visibleEnd:T.end})},[T.visibleCount,e.length,I,m,g,T.start,T.end]),k.jsxs("div",{ref:w,style:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},children:[k.jsx("div",{style:{backgroundColor:"#2a2a2a",borderBottom:"2px solid #444",flexShrink:0,zIndex:10},children:k.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:{width:"40px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",backgroundColor:"#2a2a2a",color:"#ffffff"},children:k.jsx("input",{type:"checkbox",checked:e.length>0&&r.size===e.length,onChange:b=>{const M=b.target.checked?new Set(e.map(D=>D.id)):new Set;e.forEach(D=>{r.has(D.id)!==M.has(D.id)&&s(D.id,M.has(D.id))})}})}),t.map(b=>{const M=i===b.key,D=b.sortable!==!1;return k.jsx("th",{style:{width:`${b.width}px`,padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a",cursor:D?"pointer":"default",userSelect:"none",position:"relative"},onClick:()=>{D&&d&&d(b.key)},title:D?`Click to sort by ${b.title}`:void 0,children:k.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[k.jsx("span",{children:b.title}),D&&k.jsx("span",{style:{marginLeft:"4px",fontSize:"12px",opacity:M?1:.3,transition:"opacity 0.2s ease"},children:M?a==="asc"?"▲":"▼":"↕"})]})},b.key)})]})})})}),k.jsx("div",{ref:x,onScroll:P,style:{flex:1,overflow:"auto",position:"relative",scrollbarWidth:"thin",scrollbarColor:"#555 #2a2a2a"},className:"virtualized-list-scroll",children:k.jsx("div",{style:{height:I,position:"relative"},children:k.jsx("div",{style:{position:"absolute",top:T.start*$c,left:0,right:0},children:k.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:k.jsx("tbody",{children:R.map((b,M)=>{const D=T.start+M,Q=n===b.id,he=Rw(b.bank,r.has(b.id),Q);return k.jsxs("tr",{style:{backgroundColor:he,cursor:"pointer",borderBottom:"1px solid #333",color:"#ffffff",height:`${$c}px`},onClick:()=>N(b),onMouseEnter:()=>f(b.id),onMouseLeave:()=>f(null),children:[k.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"40px"},children:k.jsx("input",{type:"checkbox",checked:r.has(b.id),onChange:z=>A(b,D,z),onClick:z=>z.stopPropagation()})}),t.map(z=>k.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",fontSize:"14px",maxWidth:`${z.width}px`,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:Z=>z.editable&&Z.stopPropagation(),children:p(b,z)},z.key))]},b.id)})})})})})})]})};class xg{static calculateBankStatistics(t){const r=new Map;t.forEach(p=>{const g=p.bank||"UNASSIGNED";r.has(g)||r.set(g,[]),r.get(g).push(p)});const n=[];let i=0;Array.from(r.entries()).forEach(([p,g])=>{const v=g.filter(N=>{var R;return N.isAssigned||!!((R=N.signalName)!=null&&R.trim())}),m=g.filter(N=>{var R;return!N.isAssigned&&!((R=N.signalName)!=null&&R.trim())});i+=v.length;const _={};g.forEach(N=>{const R=N.pinType||"UNKNOWN";_[R]=(_[R]||0)+1});const C={};g.forEach(N=>{const R=N.voltage||"UNSPECIFIED";C[R]=(C[R]||0)+1});const S={};g.forEach(N=>{const R=N.direction||"UNSPECIFIED";S[R]=(S[R]||0)+1});const w=g.filter(N=>{var R,P;return N.differentialPair||((R=N.pinName)==null?void 0:R.includes("_P"))||((P=N.pinName)==null?void 0:P.includes("_N"))}).length/2,x=new Map;v.forEach(N=>{if(N.signalName){const R=this.inferSignalType(N.signalName);x.set(R,(x.get(R)||0)+1)}});const T=Array.from(x.entries()).filter(([,N])=>N>=2).sort((N,R)=>R[1]-N[1]).slice(0,3).map(([N])=>N),A=g.length>0?v.length/g.length*100:0;n.push({bankId:p,totalPins:g.length,assignedPins:v.length,unassignedPins:m.length,utilizationRate:A,pinsByType:_,pinsByVoltage:C,pinsByDirection:S,differentialPairs:Math.floor(w),majorSignalTypes:T})}),n.sort((p,g)=>{if(p.bankId==="UNASSIGNED")return 1;if(g.bankId==="UNASSIGNED")return-1;const v=parseInt(p.bankId),m=parseInt(g.bankId);return!isNaN(v)&&!isNaN(m)?v-m:p.bankId.localeCompare(g.bankId)});const a=t.length,s=a>0?i/a*100:0,o=n.filter(p=>p.bankId!=="UNASSIGNED").map(p=>({id:p.bankId,rate:p.utilizationRate})),u=o.length>0?o.reduce((p,g)=>g.rate>p.rate?g:p):{id:"N/A",rate:0},f=o.length>0?o.reduce((p,g)=>g.rate<p.rate?g:p):{id:"N/A",rate:0},d=Array.from(new Set(t.map(p=>p.pinType).filter(Boolean))).sort();return{totalBanks:r.size,totalPins:a,overallUtilization:s,bankStats:n,mostUtilizedBank:u.id,leastUtilizedBank:f.id,bankTypes:d}}static inferSignalType(t){const r=t.toUpperCase();return r.includes("CLK")?"CLOCK":r.includes("RST")||r.includes("RESET")?"RESET":r.includes("PWR")||r.includes("VCC")||r.includes("POWER")?"POWER":r.includes("GND")||r.includes("GROUND")?"GROUND":r.includes("DATA")||r.includes("D[")?"DATA":r.includes("ADDR")||r.includes("A[")?"ADDRESS":r.includes("CS")||r.includes("CE")||r.includes("EN")?"CONTROL":r.includes("LED")?"LED":r.includes("BTN")||r.includes("SW")?"USER_INPUT":r.includes("UART")||r.includes("TX")||r.includes("RX")?"UART":r.includes("SPI")||r.includes("I2C")?"SERIAL":r.includes("USB")?"USB":r.includes("ETH")||r.includes("RMII")||r.includes("RGMII")?"ETHERNET":r.includes("DDR")||r.includes("SDRAM")?"MEMORY":r.includes("HDMI")||r.includes("LVDS")?"DISPLAY":r.includes("_P")||r.includes("_N")?"DIFFERENTIAL":"GENERAL_IO"}static exportBankStatisticsCSV(t){const r=["Bank ID","Total Pins","Assigned Pins","Unassigned Pins","Utilization (%)","Main Pin Types","Main Voltages","Differential Pairs","Major Signal Types"],n=t.bankStats.map(i=>[i.bankId,i.totalPins.toString(),i.assignedPins.toString(),i.unassignedPins.toString(),i.utilizationRate.toFixed(1),Object.entries(i.pinsByType).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),Object.entries(i.pinsByVoltage).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),i.differentialPairs.toString(),i.majorSignalTypes.join("; ")]);return[r.join(","),...n.map(i=>i.map(a=>`"${a}"`).join(","))].join(`
`)}static generateRecommendations(t){const r=[];t.overallUtilization>90?r.push("⚠️ Overall utilization is very high (>90%). Consider using a larger package or optimizing pin assignments."):t.overallUtilization<30&&r.push("💡 Overall utilization is low (<30%). A smaller package might be more cost-effective.");const n=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED").map(a=>a.utilizationRate);if(n.length>1){const a=Math.max(...n),s=Math.min(...n),o=a-s;o>50&&r.push(`⚖️ Bank utilization is unbalanced (${o.toFixed(1)}% variance). Consider redistributing signals.`)}const i=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED"&&a.assignedPins===0);return i.length>0&&r.push(`📊 ${i.length} banks are completely unused: ${i.map(a=>a.bankId).join(", ")}`),r}}const $b=({pins:e})=>{const[t,r]=ke.useState(null),[n,i]=ke.useState("bankId"),[a,s]=ke.useState("asc"),{visibleBanks:o,toggleBankVisibility:u,showAllBanks:f}=Yi(),d=ke.useMemo(()=>xg.calculateBankStatistics(e),[e]),p=ke.useMemo(()=>{const A=[...d.bankStats];return A.sort((N,R)=>{let P=0;switch(n){case"bankId":if(N.bankId==="UNASSIGNED")P=1;else if(R.bankId==="UNASSIGNED")P=-1;else{const I=parseInt(N.bankId),b=parseInt(R.bankId);!isNaN(I)&&!isNaN(b)?P=I-b:P=N.bankId.localeCompare(R.bankId)}break;case"utilization":P=N.utilizationRate-R.utilizationRate;break;case"totalPins":P=N.totalPins-R.totalPins;break}return a==="asc"?P:-P}),A},[d.bankStats,n,a]),g=A=>{n===A?s(a==="asc"?"desc":"asc"):(i(A),s("asc"))},v=()=>{const A=xg.exportBankStatisticsCSV(d),N=new Blob([A],{type:"text/csv"}),R=URL.createObjectURL(N),P=document.createElement("a");P.href=R,P.download=`bank-statistics-${new Date().toISOString().slice(0,10)}.csv`,P.click(),URL.revokeObjectURL(R)},m=ke.useMemo(()=>xg.generateRecommendations(d),[d]),_=A=>n!==A?"↕️":a==="asc"?"↑":"↓",C=A=>o.size===0?!0:o.has(A),S=A=>{console.log(`🎯 Bank ${A} clicked! Current visibility:`,C(A)),alert(`Bank ${A} clicked!`),u(A)},w=()=>{console.log("👁️ Show all banks clicked"),alert("Show all banks clicked!"),f()},x=A=>{if(A==="UNASSIGNED")return{backgroundColor:"#6b7280",color:"white"};const N=vo(A),R=C(A);return{backgroundColor:R?`${N}20`:`${N}05`,borderLeft:`4px solid ${N}`,color:R?"#1f2937":"#9ca3af",opacity:R?1:.5}},T=A=>`${A.toFixed(1)}%`;return k.jsxs("div",{className:"bank-groups-panel p-4 space-y-4",children:[k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Groups Statistics"}),k.jsx("button",{onClick:v,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"📊 Export CSV"})]}),k.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[k.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[k.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Banks"}),k.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.totalBanks})]}),k.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[k.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Pins"}),k.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.totalPins})]}),k.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[k.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overall Utilization"}),k.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T(d.overallUtilization)})]}),k.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[k.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Most Utilized"}),k.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["Bank ",d.mostUtilizedBank]})]})]}),m.length>0&&k.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[k.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:"💡 Recommendations"}),k.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:m.map((A,N)=>k.jsxs("li",{children:["• ",A]},N))})]}),k.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[k.jsx("h3",{className:"text-sm font-medium text-red-800 mb-2",children:"🔧 Debug Test Buttons"}),k.jsxs("div",{className:"flex gap-2",children:[k.jsx("button",{onClick:()=>alert("Simple button works!"),className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Test Simple Click"}),k.jsx("button",{onClick:w,className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Test Show All"}),k.jsx("button",{onClick:()=>S("TEST"),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Bank Click"})]})]}),k.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[k.jsxs("div",{className:"p-4 border-b",children:[k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Bank Details"}),k.jsx("div",{className:"flex gap-2",children:k.jsx("button",{onClick:w,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",title:"Show all banks",children:"👁️ Show All"})})]}),k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"💡 Click on any bank row to toggle its visibility in the pin list"}),k.jsxs("div",{className:"text-xs text-gray-400",children:["Visible Banks: ",o.size===0?"All":Array.from(o).join(", ")]})]})]}),k.jsx("div",{className:"overflow-x-auto",children:k.jsxs("table",{className:"w-full",children:[k.jsx("thead",{className:"bg-gray-50",children:k.jsxs("tr",{children:[k.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("bankId"),children:["Bank ID ",_("bankId")]}),k.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("totalPins"),children:["Total Pins ",_("totalPins")]}),k.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),k.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("utilization"),children:["Utilization ",_("utilization")]}),k.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Main Types"}),k.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diff Pairs"}),k.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),k.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(A=>k.jsxs(kr.Fragment,{children:[k.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200",style:x(A.bankId),onClick:()=>S(A.bankId),title:`Click to ${C(A.bankId)?"hide":"show"} Bank ${A.bankId} pins`,children:[k.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:k.jsxs("div",{className:"flex items-center",children:[k.jsxs("div",{className:"flex items-center mr-2",children:[k.jsx("span",{className:"text-lg mr-1",children:C(A.bankId)?"👁️":"🙈"}),k.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A.bankId==="UNASSIGNED"?"#6b7280":vo(A.bankId)}})]}),k.jsx("span",{className:"text-sm font-medium",children:A.bankId==="UNASSIGNED"?"Unassigned":`Bank ${A.bankId}`})]})}),k.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.totalPins}),k.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[k.jsx("span",{className:"text-green-600 font-medium",children:A.assignedPins}),k.jsxs("span",{className:"text-gray-400",children:["/",A.unassignedPins]})]}),k.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:k.jsxs("div",{className:"flex items-center",children:[k.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:k.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,A.utilizationRate)}%`}})}),k.jsx("span",{className:"text-sm text-gray-700",children:T(A.utilizationRate)})]})}),k.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:Object.entries(A.pinsByType).sort((N,R)=>R[1]-N[1]).slice(0,2).map(([N,R])=>`${N}(${R})`).join(", ")}),k.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.differentialPairs>0?A.differentialPairs:"-"}),k.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:k.jsx("button",{onClick:N=>{N.stopPropagation(),r(t===A.bankId?null:A.bankId)},className:"text-blue-600 hover:text-blue-900 font-medium",children:t===A.bankId?"Hide":"Details"})})]}),t===A.bankId&&k.jsx("tr",{children:k.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:k.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[k.jsxs("div",{children:[k.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Pin Types"}),k.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByType).map(([N,R])=>k.jsxs("div",{className:"flex justify-between text-sm",children:[k.jsx("span",{className:"text-gray-600",children:N}),k.jsx("span",{className:"font-medium",children:R})]},N))})]}),k.jsxs("div",{children:[k.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Voltages"}),k.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByVoltage).map(([N,R])=>k.jsxs("div",{className:"flex justify-between text-sm",children:[k.jsx("span",{className:"text-gray-600",children:N}),k.jsx("span",{className:"font-medium",children:R})]},N))})]}),k.jsxs("div",{children:[k.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Major Signal Types"}),k.jsx("div",{className:"space-y-1",children:A.majorSignalTypes.length>0?A.majorSignalTypes.map(N=>k.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:N},N)):k.jsx("span",{className:"text-gray-500 text-sm",children:"No major signal types"})})]})]})})})]},A.bankId))})]})})]})]})},Xb=({onPinSelect:e})=>{const{pins:t,filteredPins:r,listView:n,visibleBanks:i,setActiveTab:a,setSearchQuery:s,setCommentFilter:o,updatePin:u,updateListViewState:f,bulkUpdateComments:d,toggleBankVisibility:p}=Yi(),[g,v]=ke.useState(""),[m,_]=ke.useState(""),[C,S]=ke.useState(!1),[w,x]=ke.useState(null),T=ke.useMemo(()=>gg.find(z=>z.id===n.activeTab)||gg[0],[n.activeTab]),A=(z,Z)=>{var ae,ne;switch(Z){case"differentialPair":return z.differentialPair?`${z.differentialPair.pair}_${z.differentialPair.type}`:"";case"commentTimestamp":return((ae=z.commentTimestamp)==null?void 0:ae.getTime())||0;case"ioStandard":return((ne=z.attributes)==null?void 0:ne.IO_Standard)||z.ioType||"AUTO";default:return z[Z]||""}},N=ke.useMemo(()=>{let z=r;if(T.filter&&(z=z.filter(T.filter)),n.searchQuery.trim()){const Z=n.searchQuery.toLowerCase();z=z.filter(ae=>ae.pinNumber.toLowerCase().includes(Z)||ae.pinName.toLowerCase().includes(Z)||(ae.signalName||"").toLowerCase().includes(Z)||(ae.comment||"").toLowerCase().includes(Z))}switch(n.commentFilter){case"with-comments":z=z.filter(Z=>Z.comment&&Z.comment.trim()!=="");break;case"without-comments":z=z.filter(Z=>!Z.comment||Z.comment.trim()==="");break}return n.sortColumn?z=[...z].sort((Z,ae)=>{const ne=A(Z,n.sortColumn),K=A(ae,n.sortColumn);let ce=0;return ne<K?ce=-1:ne>K&&(ce=1),n.sortDirection==="desc"?-ce:ce}):T.sort&&(z=[...z].sort(T.sort)),z},[r,T,n.searchQuery,n.commentFilter,n.sortColumn,n.sortDirection]),R=(z,Z)=>{const ae=A(z,Z.key);if(Z.customRender)return Z.customRender(ae,z);if(Z.render==="datetime"&&z.commentTimestamp)return z.commentTimestamp.toLocaleDateString()+" "+z.commentTimestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(Z.render==="boolean")return ae?"✓":"✗";if(Z.editable){if(Z.key==="voltage")return k.jsx(mg,{value:String(ae),onSave:ne=>P(z.id,Z.key,ne),editable:!0,placeholder:"Select voltage...",type:"select",options:[...nu],allowCustomValue:!0});if(Z.key==="ioStandard"||Z.key==="ioType"){const ne=z.voltage?Yd(z.voltage):[...Kd];return k.jsx(mg,{value:String(ae),onSave:K=>P(z.id,Z.key,K),editable:!0,placeholder:"Select I/O standard...",type:"select",options:ne,allowCustomValue:!0,getDisplayValue:K=>K==="AUTO"?`Auto (${Ms(z.voltage||"3.3V")})`:K})}return k.jsx(mg,{value:String(ae),onSave:ne=>P(z.id,Z.key,ne),editable:!0,placeholder:`Enter ${Z.title.toLowerCase()}...`,maxLength:Z.key==="comment"?500:100})}return String(ae)||"-"},P=(z,Z,ae)=>{var ce;const ne=t.find(me=>me.id===z);if(!ne)return;const K={};if(Z==="comment")K.comment=ae,K.commentTimestamp=new Date,K.commentAuthor="current_user";else if(Z==="voltage"){K.voltage=ae;const me=((ce=ne.attributes)==null?void 0:ce.IO_Standard)||ne.ioType||"AUTO";if(me==="AUTO"||!Yd(ae).includes(me)){const L=Ms(ae);K.attributes={...ne.attributes,IO_Standard:L},K.ioType=L}}else Z==="ioStandard"||Z==="ioType"?(K.attributes={...ne.attributes,IO_Standard:ae},K.ioType=ae):K[Z]=ae;u(z,K)},I=(z,Z)=>{const ae=new Set(n.selectedRows);Z?ae.add(z):ae.delete(z),f({selectedRows:ae})},b=(z,Z)=>{console.log("📋 handleRangeSelection called:",{fromIndex:z,toIndex:Z,filteredPinsLength:N.length});const ae=new Set(n.selectedRows),ne=Math.min(z,Z),K=Math.max(z,Z);console.log("📋 Range calculation:",{start:ne,end:K,currentSelection:ae.size});const ce=[];for(let me=ne;me<=K&&me<N.length;me++){const L=N[me].id;ae.add(L),ce.push(L),console.log(`📋 Adding pin ${me}: ${L}`)}console.log("📋 Final selection size:",ae.size,"Selected pins:",ce),f({selectedRows:ae})},M=()=>{g.trim()&&n.selectedRows.size>0&&(Array.from(n.selectedRows).forEach(Z=>{u(Z,{comment:g,commentTimestamp:new Date,commentAuthor:"current_user"})}),v(""),S(!1))},D=()=>{if(m.trim()&&n.selectedRows.size>0){const z=Array.from(n.selectedRows);z.forEach(Z=>{u(Z,{signalName:m.trim()})}),_(""),Bl.log(pa.BULK_EDIT,`Applied signal "${m.trim()}" to ${z.length} pins`)}},Q=()=>{if(n.selectedRows.size>0){const z=Array.from(n.selectedRows);z.forEach(Z=>{u(Z,{signalName:""})}),Bl.log(pa.BULK_EDIT,`Cleared signals from ${z.length} pins`)}},he=z=>{const Z=n.sortColumn===z&&n.sortDirection==="asc"?"desc":"asc";f({sortColumn:z,sortDirection:Z})};return k.jsxs("div",{className:"pin-list-tabs",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[!1,k.jsx("div",{className:"tab-header",style:{display:"flex",borderBottom:"1px solid #444",backgroundColor:"#2a2a2a"},children:gg.map(z=>k.jsxs("button",{className:`tab ${n.activeTab===z.id?"active":""}`,onClick:()=>a(z.id),title:z.description,style:{padding:"12px 16px",border:"none",background:n.activeTab===z.id?"#333":"transparent",borderBottom:n.activeTab===z.id?"2px solid #007acc":"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:n.activeTab===z.id?"600":"normal",color:n.activeTab===z.id?"#007acc":"#cccccc"},children:[k.jsx("span",{children:z.icon}),k.jsx("span",{children:z.title})]},z.id))}),!T.isCustomComponent&&k.jsxs("div",{className:"controls",style:{padding:"16px",display:"flex",gap:"16px",alignItems:"center",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444"},children:[T.showSearch&&k.jsx("div",{style:{flex:1,maxWidth:"300px"},children:k.jsx("input",{type:"text",placeholder:"Search pins, signals, or comments...",value:n.searchQuery,onChange:z=>s(z.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"}})}),k.jsx("div",{children:k.jsxs("select",{value:n.commentFilter,onChange:z=>o(z.target.value),style:{padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[k.jsx("option",{value:"all",children:"All Pins"}),k.jsx("option",{value:"with-comments",children:"With Comments"}),k.jsx("option",{value:"without-comments",children:"Without Comments"})]})}),k.jsxs("div",{style:{color:"#cccccc",fontSize:"14px"},children:[N.length," pins"]}),k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[k.jsx("span",{style:{color:"#cccccc",fontSize:"12px"},children:"BANKs:"}),k.jsx("button",{onClick:()=>{const z=Array.from(new Set(t.map(Z=>Z.bank).filter(Boolean)));i.size===0?z.forEach(Z=>p(Z)):z.forEach(Z=>{i.has(Z)||p(Z)})},style:{padding:"2px 8px",borderRadius:"3px",backgroundColor:i.size===0?"#007acc":"#444444",border:"1px solid #555",cursor:"pointer",fontSize:"10px",color:i.size===0?"#ffffff":"#cccccc",fontWeight:"bold"},title:i.size===0?"Hide All Banks":"Show All Banks",children:i.size===0?"ALL":"SHOW ALL"}),Array.from(new Set(t.map(z=>z.bank).filter(Boolean))).sort((z,Z)=>{const ae=parseInt(z),ne=parseInt(Z);return isNaN(ae)||isNaN(ne)?z.localeCompare(Z):ae-ne}).map(z=>{const Z=i.size===0||i.has(z);return k.jsxs("button",{onClick:()=>p(z),style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"3px",backgroundColor:Z?Rw(z,!1,!1):"#444444",border:Z?"1px solid #555":"1px solid #666",cursor:"pointer",opacity:Z?1:.5,transition:"opacity 0.2s ease, background-color 0.2s ease"},title:Z?`Hide Bank ${z}`:`Show Bank ${z}`,children:[k.jsx("span",{style:{fontSize:"11px",color:Z?"#ffffff":"#999",fontWeight:Z?"normal":"bold"},children:z}),!Z&&k.jsx("span",{style:{fontSize:"8px",color:"#888"},children:"✕"})]},z)})]}),n.selectedRows.size>0&&k.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:[k.jsxs("span",{style:{fontSize:"14px",color:"#cccccc"},children:[n.selectedRows.size," selected"]}),k.jsx("button",{onClick:()=>S(!C),style:{padding:"6px 12px",border:"1px solid #007acc",borderRadius:"4px",backgroundColor:C?"#005a9e":"#007acc",color:"white",fontSize:"12px",cursor:"pointer"},children:C?"Close Bulk Edit":"Bulk Edit"}),k.jsx("button",{onClick:()=>d(Array.from(n.selectedRows),""),style:{padding:"6px 12px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Comments"}),k.jsx("button",{onClick:()=>{f({selectedRows:new Set})},style:{padding:"6px 12px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#6c757d",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Selection"})]})]}),!T.isCustomComponent&&C&&k.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",borderBottom:"1px solid #444"},children:[k.jsx("div",{style:{marginBottom:"12px"},children:k.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:"14px"},children:["Bulk Edit (",n.selectedRows.size," pins selected)"]})}),k.jsxs("div",{style:{marginBottom:"16px"},children:[k.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#cccccc",fontSize:"12px"},children:"Comment"}),k.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[k.jsx("input",{type:"text",placeholder:"Enter comment for selected pins...",value:g,onChange:z=>v(z.target.value),onKeyDown:z=>z.key==="Enter"&&M(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),k.jsx("button",{onClick:M,disabled:!g.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:g.trim()?"#28a745":"#666",color:"white",fontSize:"12px",cursor:g.trim()?"pointer":"not-allowed"},children:"Apply Comment"})]})]}),k.jsxs("div",{style:{marginBottom:"16px"},children:[k.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#cccccc",fontSize:"12px"},children:"Signal Name"}),k.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[k.jsx("input",{type:"text",placeholder:"Enter signal name for selected pins...",value:m,onChange:z=>_(z.target.value),onKeyDown:z=>z.key==="Enter"&&D(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),k.jsx("button",{onClick:D,disabled:!m.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:m.trim()?"#007bff":"#666",color:"white",fontSize:"12px",cursor:m.trim()?"pointer":"not-allowed"},children:"Apply Signal"}),k.jsx("button",{onClick:Q,style:{padding:"8px 16px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"transparent",color:"#dc3545",fontSize:"12px",cursor:"pointer"},children:"Clear Signals"})]})]}),k.jsxs("div",{style:{marginBottom:"16px"},children:[k.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#cccccc",fontSize:"12px"},children:"I/O Settings (leave empty to skip)"}),k.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px"},children:[k.jsxs("div",{children:[k.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"Direction"}),k.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:z=>{z.target.value&&Array.from(n.selectedRows).forEach(ae=>{u(ae,{direction:z.target.value})})},children:[k.jsx("option",{value:"",children:"-- Select Direction --"}),k.jsx("option",{value:"Input",children:"Input"}),k.jsx("option",{value:"Output",children:"Output"}),k.jsx("option",{value:"InOut",children:"InOut"}),k.jsx("option",{value:"Clock",children:"Clock"}),k.jsx("option",{value:"Reset",children:"Reset"})]})]}),k.jsxs("div",{children:[k.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"Voltage"}),k.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:z=>{z.target.value&&Array.from(n.selectedRows).forEach(ae=>{u(ae,{voltage:z.target.value})})},children:[k.jsx("option",{value:"",children:"-- Select Voltage --"}),nu.map(z=>k.jsx("option",{value:z,children:z},z))]})]}),k.jsxs("div",{children:[k.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"I/O Standard"}),k.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:z=>{z.target.value&&Array.from(n.selectedRows).forEach(ae=>{u(ae,{attributes:{IO_Standard:z.target.value},ioType:z.target.value})})},children:[k.jsx("option",{value:"",children:"-- Select Standard --"}),k.jsx("option",{value:"AUTO",children:"AUTO"}),Kd.filter(z=>z!=="AUTO").map(z=>k.jsx("option",{value:z,children:z},z))]})]})]})]}),k.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:k.jsx("button",{onClick:()=>S(!1),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#333",color:"#cccccc",fontSize:"12px",cursor:"pointer"},children:"Close"})})]}),k.jsx("div",{style:{flex:1,minHeight:"400px",overflow:"hidden",display:"flex",flexDirection:"column"},children:T.isCustomComponent?T.id==="bankGroups"?k.jsx($b,{pins:t}):k.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:["Custom component not implemented for ",T.id]}):N.length>0?k.jsxs(k.Fragment,{children:[console.log("🎯 Rendering VirtualizedPinList with",{pinsCount:N.length,selectedRowsCount:n.selectedRows.size,activeTab:T.id}),k.jsx(Wb,{pins:N,columns:T.columns,selectedRows:n.selectedRows,hoveredRowId:w,sortColumn:n.sortColumn,sortDirection:n.sortDirection,onRowSelection:I,onPinSelect:e,onRangeSelect:b,onHover:x,onColumnSort:he,renderCellContent:R})]}):k.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"No pins match the current filters"})})]})};var Iw={exports:{}},Ah={},Qd={},gt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof x4<"u"?x4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return e.Konva.angleDeg?i*t:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var i;return(i=e.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(i){e.glob.Konva=i}};const n=i=>{e.Konva[i.prototype.getClassName()]=i};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(gt);var or={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=gt;class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const A=this.m;return{x:A[0]*T.x+A[2]*T.y+A[4],y:A[1]*T.x+A[3]*T.y+A[5]}}translate(T,A){return this.m[4]+=this.m[0]*T+this.m[2]*A,this.m[5]+=this.m[1]*T+this.m[3]*A,this}scale(T,A){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=A,this.m[3]*=A,this}rotate(T){const A=Math.cos(T),N=Math.sin(T),R=this.m[0]*A+this.m[2]*N,P=this.m[1]*A+this.m[3]*N,I=this.m[0]*-N+this.m[2]*A,b=this.m[1]*-N+this.m[3]*A;return this.m[0]=R,this.m[1]=P,this.m[2]=I,this.m[3]=b,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,A){const N=this.m[0]+this.m[2]*A,R=this.m[1]+this.m[3]*A,P=this.m[2]+this.m[0]*T,I=this.m[3]+this.m[1]*T;return this.m[0]=N,this.m[1]=R,this.m[2]=P,this.m[3]=I,this}multiply(T){const A=this.m[0]*T.m[0]+this.m[2]*T.m[1],N=this.m[1]*T.m[0]+this.m[3]*T.m[1],R=this.m[0]*T.m[2]+this.m[2]*T.m[3],P=this.m[1]*T.m[2]+this.m[3]*T.m[3],I=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],b=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=A,this.m[1]=N,this.m[2]=R,this.m[3]=P,this.m[4]=I,this.m[5]=b,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*T,N=-this.m[1]*T,R=-this.m[2]*T,P=this.m[0]*T,I=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),b=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=N,this.m[2]=R,this.m[3]=P,this.m[4]=I,this.m[5]=b,this}getMatrix(){return this.m}decompose(){const T=this.m[0],A=this.m[1],N=this.m[2],R=this.m[3],P=this.m[4],I=this.m[5],b=T*R-A*N,M={x:P,y:I,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||A!=0){const D=Math.sqrt(T*T+A*A);M.rotation=A>0?Math.acos(T/D):-Math.acos(T/D),M.scaleX=D,M.scaleY=b/D,M.skewX=(T*N+A*R)/b,M.skewY=0}else if(N!=0||R!=0){const D=Math.sqrt(N*N+R*R);M.rotation=Math.PI/2-(R>0?Math.acos(-N/D):-Math.acos(N/D)),M.scaleX=b/D,M.scaleY=D,M.skewX=0,M.skewY=(T*N+A*R)/b}return M.rotation=e.Util._getRotation(M.rotation),M}}e.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,u=180/Math.PI,f="#",d="",p="0",g="Konva warning: ",v="Konva error: ",m="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},C=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(x){setTimeout(x,60)};e.Util={_isElement(x){return!!(x&&x.nodeType==1)},_isFunction(x){return!!(x&&x.constructor&&x.call&&x.apply)},_isPlainObject(x){return!!x&&x.constructor===Object},_isArray(x){return Object.prototype.toString.call(x)===n},_isNumber(x){return Object.prototype.toString.call(x)===i&&!isNaN(x)&&isFinite(x)},_isString(x){return Object.prototype.toString.call(x)===a},_isBoolean(x){return Object.prototype.toString.call(x)===s},isObject(x){return x instanceof Object},isValidSelector(x){if(typeof x!="string")return!1;const T=x[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(x){return x===0||x>0?1:-1},requestAnimFrame(x){S.push(x),S.length===1&&w(function(){const T=S;S=[],T.forEach(function(A){A()})})},createCanvasElement(){const x=document.createElement("canvas");try{x.style=x.style||{}}catch{}return x},createImageElement(){return document.createElement("img")},_isInDocument(x){for(;x=x.parentNode;)if(x==document)return!0;return!1},_urlToImage(x,T){const A=e.Util.createImageElement();A.onload=function(){T(A)},A.src=x},_rgbToHex(x,T,A){return((1<<24)+(x<<16)+(T<<8)+A).toString(16).slice(1)},_hexToRgb(x){x=x.replace(f,d);const T=parseInt(x,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let x=(Math.random()*16777215<<0).toString(16);for(;x.length<6;)x=p+x;return f+x},getRGB(x){let T;return x in _?(T=_[x],{r:T[0],g:T[1],b:T[2]}):x[0]===f?this._hexToRgb(x.substring(1)):x.substr(0,4)===m?(T=C.exec(x.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(x){return x=x||"black",e.Util._namedColorToRBA(x)||e.Util._hex3ColorToRGBA(x)||e.Util._hex4ColorToRGBA(x)||e.Util._hex6ColorToRGBA(x)||e.Util._hex8ColorToRGBA(x)||e.Util._rgbColorToRGBA(x)||e.Util._rgbaColorToRGBA(x)||e.Util._hslColorToRGBA(x)},_namedColorToRBA(x){const T=_[x.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(x){if(x.indexOf("rgb(")===0){x=x.match(/rgb\(([^)]+)\)/)[1];const T=x.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(x){if(x.indexOf("rgba(")===0){x=x.match(/rgba\(([^)]+)\)/)[1];const T=x.split(/ *, */).map((A,N)=>A.slice(-1)==="%"?N===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(x){if(x[0]==="#"&&x.length===9)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:parseInt(x.slice(7,9),16)/255}},_hex6ColorToRGBA(x){if(x[0]==="#"&&x.length===7)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:1}},_hex4ColorToRGBA(x){if(x[0]==="#"&&x.length===5)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:parseInt(x[4]+x[4],16)/255}},_hex3ColorToRGBA(x){if(x[0]==="#"&&x.length===4)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:1}},_hslColorToRGBA(x){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(x)){const[T,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(x),N=Number(A[0])/360,R=Number(A[1])/100,P=Number(A[2])/100;let I,b,M;if(R===0)return M=P*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};P<.5?I=P*(1+R):I=P+R-P*R;const D=2*P-I,Q=[0,0,0];for(let he=0;he<3;he++)b=N+1/3*-(he-1),b<0&&b++,b>1&&b--,6*b<1?M=D+(I-D)*6*b:2*b<1?M=I:3*b<2?M=D+(I-D)*(2/3-b)*6:M=D,Q[he]=M*255;return{r:Math.round(Q[0]),g:Math.round(Q[1]),b:Math.round(Q[2]),a:1}}},haveIntersection(x,T){return!(T.x>x.x+x.width||T.x+T.width<x.x||T.y>x.y+x.height||T.y+T.height<x.y)},cloneObject(x){const T={};for(const A in x)this._isPlainObject(x[A])?T[A]=this.cloneObject(x[A]):this._isArray(x[A])?T[A]=this.cloneArray(x[A]):T[A]=x[A];return T},cloneArray(x){return x.slice(0)},degToRad(x){return x*o},radToDeg(x){return x*u},_degToRad(x){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(x)},_radToDeg(x){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(x)},_getRotation(x){return t.Konva.angleDeg?e.Util.radToDeg(x):x},_capitalize(x){return x.charAt(0).toUpperCase()+x.slice(1)},throw(x){throw new Error(v+x)},error(x){console.error(v+x)},warn(x){t.Konva.showWarnings&&console.warn(g+x)},each(x,T){for(const A in x)T(A,x[A])},_inRange(x,T,A){return T<=x&&x<A},_getProjectionToSegment(x,T,A,N,R,P){let I,b,M;const D=(x-A)*(x-A)+(T-N)*(T-N);if(D==0)I=x,b=T,M=(R-A)*(R-A)+(P-N)*(P-N);else{const Q=((R-x)*(A-x)+(P-T)*(N-T))/D;Q<0?(I=x,b=T,M=(x-R)*(x-R)+(T-P)*(T-P)):Q>1?(I=A,b=N,M=(A-R)*(A-R)+(N-P)*(N-P)):(I=x+Q*(A-x),b=T+Q*(N-T),M=(I-R)*(I-R)+(b-P)*(b-P))}return[I,b,M]},_getProjectionToLine(x,T,A){const N=e.Util.cloneObject(x);let R=Number.MAX_VALUE;return T.forEach(function(P,I){if(!A&&I===T.length-1)return;const b=T[(I+1)%T.length],M=e.Util._getProjectionToSegment(P.x,P.y,b.x,b.y,x.x,x.y),D=M[0],Q=M[1],he=M[2];he<R&&(N.x=D,N.y=Q,R=he)}),N},_prepareArrayForTween(x,T,A){const N=[],R=[];if(x.length>T.length){const I=T;T=x,x=I}for(let I=0;I<x.length;I+=2)N.push({x:x[I],y:x[I+1]});for(let I=0;I<T.length;I+=2)R.push({x:T[I],y:T[I+1]});const P=[];return R.forEach(function(I){const b=e.Util._getProjectionToLine(I,N,A);P.push(b.x),P.push(b.y)}),P},_prepareToStringify(x){let T;x.visitedByCircularReferenceRemoval=!0;for(const A in x)if(x.hasOwnProperty(A)&&x[A]&&typeof x[A]=="object"){if(T=Object.getOwnPropertyDescriptor(x,A),x[A].visitedByCircularReferenceRemoval||e.Util._isElement(x[A]))if(T.configurable)delete x[A];else return null;else if(e.Util._prepareToStringify(x[A])===null)if(T.configurable)delete x[A];else return null}return delete x.visitedByCircularReferenceRemoval,x},_assign(x,T){for(const A in T)x[A]=T[A];return x},_getFirstPointerId(x){return x.touches?x.changedTouches[0].identifier:x.pointerId||999},releaseCanvas(...x){t.Konva.releaseCanvasOnDestroy&&x.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(x,T,A,N){let R=0,P=0,I=0,b=0;typeof N=="number"?R=P=I=b=Math.min(N,T/2,A/2):(R=Math.min(N[0]||0,T/2,A/2),P=Math.min(N[1]||0,T/2,A/2),b=Math.min(N[2]||0,T/2,A/2),I=Math.min(N[3]||0,T/2,A/2)),x.moveTo(R,0),x.lineTo(T-P,0),x.arc(T-P,P,P,Math.PI*3/2,0,!1),x.lineTo(T,A-b),x.arc(T-b,A-b,b,0,Math.PI/2,!1),x.lineTo(I,A),x.arc(I,A-I,I,Math.PI/2,Math.PI,!1),x.lineTo(0,R),x.arc(R,R,R,Math.PI,Math.PI*3/2,!1)}}})(or);var tr={},qi={},za={};Object.defineProperty(za,"__esModule",{value:!0});za.HitContext=za.SceneContext=za.Context=void 0;const bw=or,Kb=gt;function Yb(e){const t=[],r=e.length,n=bw.Util;for(let i=0;i<r;i++){let a=e[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),t.push(a)}return t}const B3=",",Qb="(",qb=")",Jb="([",Zb="])",eO=";",tO="()",rO="=",j3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],nO=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],iO=100;class Ph{constructor(t){this.canvas=t,Kb.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,r){let n=this.traceArr,i=n.length,a="",s,o,u,f;for(s=0;s<i;s++)o=n[s],u=o.method,u?(f=o.args,a+=u,t?a+=tO:bw.Util._isArray(f[0])?a+=Jb+f.join(B3)+Zb:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=Qb+f.join(B3)+qb)):(a+=o.property,t||(a+=rO+o.val)),a+=eO;return a}clearTrace(){this.traceArr=[]}_trace(t){let r=this.traceArr,n;r.push(t),n=r.length,n>=iO&&r.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const r=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(t){const r=t.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(t){const r=t.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(t){const r=t.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(t,r){this._context[t]=r}arc(t,r,n,i,a,s){this._context.arc(t,r,n,i,a,s)}arcTo(t,r,n,i,a){this._context.arcTo(t,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,r,n,i,a,s){this._context.bezierCurveTo(t,r,n,i,a,s)}clearRect(t,r,n,i){this._context.clearRect(t,r,n,i)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,r){const n=arguments;if(n.length===2)return this._context.createImageData(t,r);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,r,n,i){return this._context.createLinearGradient(t,r,n,i)}createPattern(t,r){return this._context.createPattern(t,r)}createRadialGradient(t,r,n,i,a,s){return this._context.createRadialGradient(t,r,n,i,a,s)}drawImage(t,r,n,i,a,s,o,u,f){const d=arguments,p=this._context;d.length===3?p.drawImage(t,r,n):d.length===5?p.drawImage(t,r,n,i,a):d.length===9&&p.drawImage(t,r,n,i,a,s,o,u,f)}ellipse(t,r,n,i,a,s,o,u){this._context.ellipse(t,r,n,i,a,s,o,u)}isPointInPath(t,r,n,i){return n?this._context.isPointInPath(n,t,r,i):this._context.isPointInPath(t,r,i)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,r,n,i){this._context.fillRect(t,r,n,i)}strokeRect(t,r,n,i){this._context.strokeRect(t,r,n,i)}fillText(t,r,n,i){i?this._context.fillText(t,r,n,i):this._context.fillText(t,r,n)}measureText(t){return this._context.measureText(t)}getImageData(t,r,n,i){return this._context.getImageData(t,r,n,i)}lineTo(t,r){this._context.lineTo(t,r)}moveTo(t,r){this._context.moveTo(t,r)}rect(t,r,n,i){this._context.rect(t,r,n,i)}roundRect(t,r,n,i,a){this._context.roundRect(t,r,n,i,a)}putImageData(t,r,n){this._context.putImageData(t,r,n)}quadraticCurveTo(t,r,n,i){this._context.quadraticCurveTo(t,r,n,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,r){this._context.scale(t,r)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,r,n,i,a,s){this._context.setTransform(t,r,n,i,a,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,r,n,i){this._context.strokeText(t,r,n,i)}transform(t,r,n,i,a,s){this._context.transform(t,r,n,i,a,s)}translate(t,r){this._context.translate(t,r)}_enableTrace(){let t=this,r=j3.length,n=this.setAttr,i,a;const s=function(o){let u=t[o],f;t[o]=function(){return a=Yb(Array.prototype.slice.call(arguments,0)),f=u.apply(t,arguments),t._trace({method:o,args:a}),f}};for(i=0;i<r;i++)s(j3[i]);t.setAttr=function(){n.apply(t,arguments);const o=arguments[0];let u=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:o,val:u})}}_applyGlobalCompositeOperation(t){const r=t.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}za.Context=Ph;nO.forEach(function(e){Object.defineProperty(Ph.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});class aO extends Ph{constructor(t,{willReadFrequently:r=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(t){const r=t.fill();this.setAttr("fillStyle",r),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const r=t._getLinearGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fillRadialGradient(t){const r=t._getRadialGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fill(t){const r=t.fill(),n=t.getFillPriority();if(r&&n==="color"){this._fillColor(t);return}const i=t.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(t);return}const a=t.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(t);return}const s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}r?this._fillColor(t):i?this._fillPattern(t):a?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const r=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(t){const r=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),r&&t.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var r,n,i;const a=(r=t.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=t.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=u.x*f,p=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(p))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*p)}}za.SceneContext=aO;class sO extends Ph{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),i=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}za.HitContext=sO;Object.defineProperty(qi,"__esModule",{value:!0});qi.HitCanvas=qi.SceneCanvas=qi.Canvas=void 0;const qd=or,Ow=za,Dw=gt;let Wf;function oO(){if(Wf)return Wf;const e=qd.Util.createCanvasElement(),t=e.getContext("2d");return Wf=function(){const r=Dw.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return r/n}(),qd.Util.releaseCanvas(e),Wf}class yx{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||Dw.Konva.pixelRatio||oO();this.pixelRatio=n,this._canvas=qd.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const r=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,r){this.setWidth(t||0),this.setHeight(r||0)}toDataURL(t,r){try{return this._canvas.toDataURL(t,r)}catch{try{return this._canvas.toDataURL()}catch(i){return qd.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}qi.Canvas=yx;class lO extends yx{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Ow.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}qi.SceneCanvas=lO;class cO extends yx{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Ow.HitContext(this),this.setSize(t.width,t.height)}}qi.HitCanvas=cO;var Fh={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=gt,r=or;e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];e.DD._dragElements.forEach((a,s)=>{const{node:o}=a,u=o.getStage();u.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=u._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];e.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(Fh);var yt={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.RGBComponent=uO;at.alphaComponent=fO;at.getNumberValidator=dO;at.getNumberOrArrayOfNumbersValidator=hO;at.getNumberOrAutoValidator=pO;at.getStringValidator=gO;at.getStringOrGradientValidator=mO;at.getFunctionValidator=xO;at.getNumberArrayValidator=vO;at.getBooleanValidator=yO;at.getComponentValidator=_O;const Qa=gt,fr=or;function qa(e){return fr.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||fr.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function uO(e){return e>255?255:e<0?0:Math.round(e)}function fO(e){return e>1?1:e<1e-4?1e-4:e}function dO(){if(Qa.Konva.isUnminified)return function(e,t){return fr.Util._isNumber(e)||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function hO(e){if(Qa.Konva.isUnminified)return function(t,r){let n=fr.Util._isNumber(t),i=fr.Util._isArray(t)&&t.length==e;return!n&&!i&&fr.Util.warn(qa(t)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function pO(){if(Qa.Konva.isUnminified)return function(e,t){return fr.Util._isNumber(e)||e==="auto"||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function gO(){if(Qa.Konva.isUnminified)return function(e,t){return fr.Util._isString(e)||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function mO(){if(Qa.Konva.isUnminified)return function(e,t){const r=fr.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return r||n||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function xO(){if(Qa.Konva.isUnminified)return function(e,t){return fr.Util._isFunction(e)||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function vO(){if(Qa.Konva.isUnminified)return function(e,t){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&e instanceof r||(fr.Util._isArray(e)?e.forEach(function(n){fr.Util._isNumber(n)||fr.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function yO(){if(Qa.Konva.isUnminified)return function(e,t){return e===!0||e===!1||fr.Util.warn(qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function _O(e){if(Qa.Konva.isUnminified)return function(t,r){return t==null||fr.Util.isObject(t)||fr.Util.warn(qa(t)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+e),t}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=or,r=at,n="get",i="set";e.Factory={addGetterSetter(a,s,o,u,f){e.Factory.addGetter(a,s,o),e.Factory.addSetter(a,s,u,f),e.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const u=n+t.Util._capitalize(s);a.prototype[u]=a.prototype[u]||function(){const f=this.attrs[s];return f===void 0?o:f}},addSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]||e.Factory.overWriteSetter(a,s,o,u)},overWriteSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,s)),this._setAttr(s,d),u&&u.call(this),this}},addComponentsGetterSetter(a,s,o,u,f){const d=o.length,p=t.Util._capitalize,g=n+p(s),v=i+p(s);a.prototype[g]=function(){const _={};for(let C=0;C<d;C++){const S=o[C];_[S]=this.getAttr(s+p(S))}return _};const m=(0,r.getComponentValidator)(o);a.prototype[v]=function(_){const C=this.attrs[s];u&&(_=u.call(this,_,s)),m&&m.call(this,_,s);for(const S in _)_.hasOwnProperty(S)&&this._setAttr(s+p(S),_[S]);return _||o.forEach(S=>{this._setAttr(s+p(S),void 0)}),this._fireChangeEvent(s,C,_),f&&f.call(this),this},e.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=t.Util._capitalize(s),u=i+o,f=n+o;a.prototype[s]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,o,u){t.Util.error("Adding deprecated "+s);const f=n+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){t.Util.error(d);const p=this.attrs[s];return p===void 0?o:p},e.Factory.addSetter(a,s,u,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){t.Util.each(s,function(o,u){const f=a.prototype[u],d=n+t.Util._capitalize(o),p=i+t.Util._capitalize(o);function g(){f.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(yt);Object.defineProperty(tr,"__esModule",{value:!0});tr.Node=void 0;const hl=qi,xi=Fh,vu=yt,fs=gt,wt=or,xr=at,ld="absoluteOpacity",$f="allEventListeners",Na="absoluteTransform",U3="absoluteScale",oo="canvas",SO="Change",wO="children",kO="konva",jm="listening",EO="mouseenter",CO="mouseleave",TO="pointerenter",AO="pointerleave",PO="touchenter",FO="touchleave",z3="set",V3="Shape",cd=" ",G3="stage",ds="transform",NO="Stage",Um="visible",RO=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(cd);let IO=1;class ot{constructor(t){this._id=IO++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ds||t===Na)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,r){let n=this._cache.get(t);return(n===void 0||(t===ds||t===Na)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(t,n)),n}_calculate(t,r,n){if(!this._attachedDepsListeners.get(t)){const i=r.map(a=>a+"Change.konva").join(cd);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(oo)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Na&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(oo)){const{scene:t,filter:r,hit:n,buffer:i}=this._cache.get(oo);wt.Util.releaseCanvas(t,r,n,i),this._cache.delete(oo)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const r=t||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,u=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,p=r.hitCanvasPixelRatio||1;if(!i||!a){wt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const g=Math.abs(Math.round(n.x)-o)>.5?1:0,v=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+g,a+=f*2+v,o-=f,u-=f;const m=new hl.SceneCanvas({pixelRatio:s,width:i,height:a}),_=new hl.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),C=new hl.HitCanvas({pixelRatio:p,width:i,height:a}),S=m.getContext(),w=C.getContext(),x=new hl.SceneCanvas({width:m.width/m.pixelRatio+Math.abs(o),height:m.height/m.pixelRatio+Math.abs(u),pixelRatio:m.pixelRatio}),T=x.getContext();return C.isCache=!0,m.isCache=!0,this._cache.delete(oo),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(m.getContext()._context.imageSmoothingEnabled=!1,_.getContext()._context.imageSmoothingEnabled=!1),S.save(),w.save(),T.save(),S.translate(-o,-u),w.translate(-o,-u),T.translate(-o,-u),x.x=o,x.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(ld),this._clearSelfAndDescendantCache(U3),this.drawScene(m,this,x),this.drawHit(C,this),this._isUnderCache=!1,S.restore(),w.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,i,a),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(oo,{scene:m,filter:_,hit:C,buffer:x,x:o,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(oo)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,r){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const u=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=u.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();t.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()}_drawCachedHitCanvas(t){const r=this._getCanvasCache(),n=r.hit;t.save(),t.translate(r.x,r.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,u,f;if(t){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<s;u++){if(f=t[u],typeof f!="function"){wt.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,o),a.putImageData(o,0,0)}}catch(p){wt.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(t,r){if(this._cache&&this._cache.delete($f),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(cd);for(let i=0;i<n.length;i++){const s=n[i].split("."),o=s[0],u=s[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:u,handler:r})}return this}off(t,r){let n=(t||"").split(cd),i=n.length,a,s,o,u,f,d;if(this._cache&&this._cache.delete($f),!t)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],u=o.split("."),f=u[0],d=u[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(t){const r={target:this,type:t.type,evt:t};return this.fire(t.type,r),this}addEventListener(t,r){return this.on(t,function(n){r.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,r,n){const i=this;this.on(t,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=wt.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),xi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Na),this._clearSelfAndDescendantCache(ld),this._clearSelfAndDescendantCache(U3),this._clearSelfAndDescendantCache(G3),this._clearSelfAndDescendantCache(Um),this._clearSelfAndDescendantCache(jm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const r="get"+wt.Util._capitalize(t);return wt.Util._isFunction(this[r])?this[r]():this.attrs[t]}getAncestors(){let t=this.getParent(),r=[];for(;t;)r.push(t),t=t.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let r,n;if(!t)return this;for(r in t)r!==wO&&(n=z3+wt.Util._capitalize(r),wt.Util._isFunction(this[n])?this[n](t[r]):this._setAttr(r,t[r]))}),this}isListening(){return this._getCache(jm,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Um,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,r=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let i=!1;xi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!fs.Konva.hitOnDragEnabled&&(i||fs.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),r=this,n=0,i,a,s,o;function u(d){for(i=[],a=d.length,s=0;s<a;s++)o=d[s],n++,o.nodeType!==V3&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=t&&u(i)}const f=this.getStage();return r.nodeType!==NO&&f&&u(f.getChildren()),n}getDepth(){let t=0,r=this.parent;for(;r;)t++,r=r.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ds),this._clearSelfAndDescendantCache(Na)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const r=t.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(t){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!t&&(t=!0);const i=this.getAbsoluteTransform(t).getMatrix(),a=new wt.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(t){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(ds);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:t.x,y:t.y}),this._clearCache(ds),this._clearSelfAndDescendantCache(Na),this}_setTransform(t){let r;for(r in t)this.attrs[r]=t[r]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let r=t.x,n=t.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(t,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return wt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return wt.Util.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return wt.Util.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return wt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return wt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&wt.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ld,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(t*=r.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in t)n=t[r],s=wt.Util.isObject(n)&&!wt.Util._isPlainObject(n)&&!wt.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete t[r],a=i?i.call(this):null,t[r]=n,a!==n&&(o.attrs[r]=n));return wt.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,r,n){const i=[];r&&this._isMatch(t)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent}return i}isAncestorOf(t){return!1}findAncestor(t,r,n){return this.findAncestors(t,r,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let r=t.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],wt.Util.isValidSelector(a)||(wt.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),wt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),wt.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(G3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,r={},n){return r.target=r.target||this,n?this._fireAndBubble(t,r):this._fire(t,r),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Na,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let r;if(t)return r=new wt.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),r;{r=this._cache.get(Na)||new wt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(t){let r=this;for(;r;)r._isUnderCache&&(t=r),r=r.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ds,this._getTransform)}_getTransform(){var t,r;const n=this._cache.get(ds)||new wt.Transform;n.reset();const i=this.x(),a=this.y(),s=fs.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,p=this.attrs.offsetX||0,g=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(o!==1||u!==1)&&n.scale(o,u),(p!==0||g!==0)&&n.translate(-1*p,-1*g),n.dirty=!1,n}clone(t){let r=wt.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in t)r[n]=t[n];const u=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(kO)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(o));return u}_toKonvaCanvas(t){t=t||{};const r=this.getClientRect(),n=this.getStage(),i=t.x!==void 0?t.x:Math.floor(r.x),a=t.y!==void 0?t.y:Math.floor(r.y),s=t.pixelRatio||1,o=new hl.SceneCanvas({width:t.width||Math.ceil(r.width)||(n?n.width():0),height:t.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),u=o.getContext(),f=new hl.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||a)&&u.translate(-1*i,-1*a),this.drawScene(o,void 0,f),u.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const r=t.mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(r,n);return t.callback&&t.callback(i),i}toImage(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,wt.Util._urlToImage(this.toDataURL(t),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob(a=>{r(a),i==null||i(a)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(i){n(i)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():fs.Konva.dragDistance}_off(t,r,n){let i=this.eventListeners[t],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,r,n){this._fire(t+SO,{oldVal:r,newVal:n})}addName(t){if(!this.hasName(t)){const r=this.name(),n=r?r+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const r=(this.name()||"").split(/\s/g),n=r.indexOf(t);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(t,r){const n=this[z3+wt.Util._capitalize(t)];return wt.Util._isFunction(n)?n.call(this,r):this._setAttr(t,r),this}_requestDraw(){if(fs.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,r){const n=this.attrs[t];n===r&&!wt.Util.isObject(r)||(r==null?delete this.attrs[t]:this.attrs[t]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,r),this._requestDraw())}_setComponentAttr(t,r,n){let i;n!==void 0&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][r]=n,this._fireChangeEvent(t,i,n))}_fireAndBubble(t,r,n){r&&this.nodeType===V3&&(r.target=this);const i=[EO,CO,TO,AO,PO,FO];if(!(i.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,r);const s=i.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,r,n):this._fireAndBubble.call(this.parent,t,r))}}_getProtoListeners(t){var r,n,i;const a=(r=this._cache.get($f))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[t];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const u=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[t])!==null&&i!==void 0?i:[];s.push(...u),o=Object.getPrototypeOf(o)}a[t]=s,this._cache.set($f,a)}return s}_fire(t,r){r=r||{},r.currentTarget=this,r.type=t;const n=this._getProtoListeners(t);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[t];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const r=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;xi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(t,r=!0){xi.DD._dragElements.has(this._id)||this._createDragElement(t);const n=xi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},r)}_setDragPosition(t,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,t);s?i=s:wt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(t){const r=xi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),xi.DD._endDragBefore(t),xi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=xi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||fs.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let i=!1;xi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=xi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&xi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-t.x,y:-t.y,width:r.width()+2*t.x,height:r.height()+2*t.y};return wt.Util.haveIntersection(n,this.getClientRect())}static create(t,r){return wt.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,r)}static _createNode(t,r){let n=ot.prototype.getClassName.call(t),i=t.children,a,s,o;r&&(t.attrs.container=r),fs.Konva[n]||(wt.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=fs.Konva[n];if(a=new u(t.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(ot._createNode(i[o]));return a}}tr.Node=ot;ot.prototype.nodeType="Node";ot.prototype._attrsAffectingSize=[];ot.prototype.eventListeners={};ot.prototype.on.call(ot.prototype,RO,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ds),this._clearSelfAndDescendantCache(Na)});ot.prototype.on.call(ot.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Um)});ot.prototype.on.call(ot.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(jm)});ot.prototype.on.call(ot.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ld)});const Wt=vu.Factory.addGetterSetter;Wt(ot,"zIndex");Wt(ot,"absolutePosition");Wt(ot,"position");Wt(ot,"x",0,(0,xr.getNumberValidator)());Wt(ot,"y",0,(0,xr.getNumberValidator)());Wt(ot,"globalCompositeOperation","source-over",(0,xr.getStringValidator)());Wt(ot,"opacity",1,(0,xr.getNumberValidator)());Wt(ot,"name","",(0,xr.getStringValidator)());Wt(ot,"id","",(0,xr.getStringValidator)());Wt(ot,"rotation",0,(0,xr.getNumberValidator)());vu.Factory.addComponentsGetterSetter(ot,"scale",["x","y"]);Wt(ot,"scaleX",1,(0,xr.getNumberValidator)());Wt(ot,"scaleY",1,(0,xr.getNumberValidator)());vu.Factory.addComponentsGetterSetter(ot,"skew",["x","y"]);Wt(ot,"skewX",0,(0,xr.getNumberValidator)());Wt(ot,"skewY",0,(0,xr.getNumberValidator)());vu.Factory.addComponentsGetterSetter(ot,"offset",["x","y"]);Wt(ot,"offsetX",0,(0,xr.getNumberValidator)());Wt(ot,"offsetY",0,(0,xr.getNumberValidator)());Wt(ot,"dragDistance",void 0,(0,xr.getNumberValidator)());Wt(ot,"width",0,(0,xr.getNumberValidator)());Wt(ot,"height",0,(0,xr.getNumberValidator)());Wt(ot,"listening",!0,(0,xr.getBooleanValidator)());Wt(ot,"preventDefault",!0,(0,xr.getBooleanValidator)());Wt(ot,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Wt(ot,"visible",!0,(0,xr.getBooleanValidator)());Wt(ot,"transformsEnabled","all",(0,xr.getStringValidator)());Wt(ot,"size");Wt(ot,"dragBoundFunc");Wt(ot,"draggable",!1,(0,xr.getBooleanValidator)());vu.Factory.backCompat(ot,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.Container=void 0;const uc=yt,vg=tr,Nh=at;class zo extends vg.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){const r=this.children||[];return t?r.filter(t):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const r=this._generalFind(t,!0);return r.length>0?r[0]:void 0}_generalFind(t,r){const n=[];return this._descendants(i=>{const a=i._isMatch(t);return a&&n.push(i),!!(a&&r)}),n}_descendants(t){let r=!1;const n=this.getChildren();for(const i of n){if(r=t(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(t),r))return!0}return!1}toObject(){const t=vg.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(r=>{t.children.push(r.toObject())}),t}isAncestorOf(t){let r=t.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(t){const r=vg.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(t){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&r.push(n)}),r}_clearSelfAndDescendantCache(t){var r;super._clearSelfAndDescendantCache(t),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),u=o&&o.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(t,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const u=this.getAbsoluteTransform(r).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(t,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),d=typeof o=="number"&&typeof u=="number"||f,p=n===this;if(d){s.save();const v=this.getAbsoluteTransform(n);let m=v.getMatrix();s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s.beginPath();let _;if(f)_=f.call(this,s,this);else{const C=this.clipX(),S=this.clipY();s.rect(C||0,S||0,o,u)}s.clip.apply(s,_),m=v.copy().invert().getMatrix(),s.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const g=!p&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";g&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(v){v[t](r,n,i)}),g&&s.restore(),d&&s.restore()}getClientRect(t={}){var r;const n=t.skipTransform,i=t.relativeTo;let a,s,o,u,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(v){if(!v.visible())return;const m=v.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});m.width===0&&m.height===0||(a===void 0?(a=m.x,s=m.y,o=m.x+m.width,u=m.y+m.height):(a=Math.min(a,m.x),s=Math.min(s,m.y),o=Math.max(o,m.x+m.width),u=Math.max(u,m.y+m.height)))});const p=this.find("Shape");let g=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){g=!0;break}return g&&a!==void 0?f={x:a,y:s,width:o-a,height:u-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}Uo.Container=zo;uc.Factory.addComponentsGetterSetter(zo,"clip",["x","y","width","height"]);uc.Factory.addGetterSetter(zo,"clipX",void 0,(0,Nh.getNumberValidator)());uc.Factory.addGetterSetter(zo,"clipY",void 0,(0,Nh.getNumberValidator)());uc.Factory.addGetterSetter(zo,"clipWidth",void 0,(0,Nh.getNumberValidator)());uc.Factory.addGetterSetter(zo,"clipHeight",void 0,(0,Nh.getNumberValidator)());uc.Factory.addGetterSetter(zo,"clipFunc");var Lw={},Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.getCapturedShape=OO;Gs.createEvent=_x;Gs.hasPointerCapture=DO;Gs.setPointerCapture=LO;Gs.releaseCapture=Bw;const bO=gt,iu=new Map,Mw=bO.Konva._global.PointerEvent!==void 0;function OO(e){return iu.get(e)}function _x(e){return{evt:e,pointerId:e.pointerId}}function DO(e,t){return iu.get(e)===t}function LO(e,t){Bw(e),t.getStage()&&(iu.set(e,t),Mw&&t._fire("gotpointercapture",_x(new PointerEvent("gotpointercapture"))))}function Bw(e,t){const r=iu.get(e);if(!r)return;const n=r.getStage();n&&n.content,iu.delete(e),Mw&&r._fire("lostpointercapture",_x(new PointerEvent("lostpointercapture")))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=or,r=yt,n=Uo,i=gt,a=qi,s=Fh,o=gt,u=Gs,f="Stage",d="string",p="px",g="mouseout",v="mouseleave",m="mouseover",_="mouseenter",C="mousemove",S="mousedown",w="mouseup",x="pointermove",T="pointerdown",A="pointerup",N="pointercancel",R="lostpointercapture",P="pointerout",I="pointerleave",b="pointerover",M="pointerenter",D="contextmenu",Q="touchstart",he="touchend",z="touchmove",Z="touchcancel",ae="wheel",ne=5,K=[[_,"_pointerenter"],[S,"_pointerdown"],[C,"_pointermove"],[w,"_pointerup"],[v,"_pointerleave"],[Q,"_pointerdown"],[z,"_pointermove"],[he,"_pointerup"],[Z,"_pointercancel"],[m,"_pointerover"],[ae,"_wheel"],[D,"_contextmenu"],[T,"_pointerdown"],[x,"_pointermove"],[A,"_pointerup"],[N,"_pointercancel"],[I,"_pointerleave"],[R,"_lostpointercapture"]],ce={mouse:{[P]:g,[I]:v,[b]:m,[M]:_,[x]:C,[T]:S,[A]:w,[N]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[P]:"touchout",[I]:"touchleave",[b]:"touchover",[M]:"touchenter",[x]:z,[T]:Q,[A]:he,[N]:Z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[P]:P,[I]:I,[b]:b,[M]:M,[x]:x,[T]:T,[A]:A,[N]:N,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},me=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",L=de=>{const V=me(de);if(V==="pointer")return i.Konva.pointerEventsEnabled&&ce.pointer;if(V==="touch")return ce.touch;if(V==="mouse")return ce.mouse};function ee(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class Y extends n.Container{constructor(V){super(ee(V)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ee(this.attrs)}),this._checkVisibility()}_validateAdd(V){const ie=V.getType()==="Layer",ge=V.getType()==="FastLayer";ie||ge||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const V=this.visible()?"":"none";this.content.style.display=V}setContainer(V){if(typeof V===d){let ie;if(V.charAt(0)==="."){const ge=V.slice(1);V=document.getElementsByClassName(ge)[0]}else V.charAt(0)!=="#"?ie=V:ie=V.slice(1),V=document.getElementById(ie);if(!V)throw"Can not find container in document with id "+ie}return this._setAttr("container",V),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),V.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const V=this.children,ie=V.length;for(let ge=0;ge<ie;ge++)V[ge].clear();return this}clone(V){return V||(V={}),V.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,V)}destroy(){super.destroy();const V=this.content;V&&t.Util._isInDocument(V)&&this.container().removeChild(V);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const V=this._pointerPositions[0]||this._changedPointerPositions[0];return V?{x:V.x,y:V.y}:(t.Util.warn(q),null)}_getPointerById(V){return this._pointerPositions.find(ie=>ie.id===V)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(V){V=V||{},V.x=V.x||0,V.y=V.y||0,V.width=V.width||this.width(),V.height=V.height||this.height();const ie=new a.SceneCanvas({width:V.width,height:V.height,pixelRatio:V.pixelRatio||1}),ge=ie.getContext()._context,_e=this.children;return(V.x||V.y)&&ge.translate(-1*V.x,-1*V.y),_e.forEach(function(Me){if(!Me.isVisible())return;const H=Me._toKonvaCanvas(V);ge.drawImage(H._canvas,V.x,V.y,H.getWidth()/H.getPixelRatio(),H.getHeight()/H.getPixelRatio())}),ie}getIntersection(V){if(!V)return null;const ie=this.children,ge=ie.length,_e=ge-1;for(let Me=_e;Me>=0;Me--){const H=ie[Me].getIntersection(V);if(H)return H}return null}_resizeDOM(){const V=this.width(),ie=this.height();this.content&&(this.content.style.width=V+p,this.content.style.height=ie+p),this.bufferCanvas.setSize(V,ie),this.bufferHitCanvas.setSize(V,ie),this.children.forEach(ge=>{ge.setSize({width:V,height:ie}),ge.draw()})}add(V,...ie){if(arguments.length>1){for(let _e=0;_e<arguments.length;_e++)this.add(arguments[_e]);return this}super.add(V);const ge=this.children.length;return ge>ne&&t.Util.warn("The stage has "+ge+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),V.setSize({width:this.width(),height:this.height()}),V.draw(),i.Konva.isBrowser&&this.content.appendChild(V.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(V){return u.hasPointerCapture(V,this)}setPointerCapture(V){u.setPointerCapture(V,this)}releaseCapture(V){u.releaseCapture(V,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&K.forEach(([V,ie])=>{this.content.addEventListener(V,ge=>{this[ie](ge)},{passive:!1})})}_pointerenter(V){this.setPointersPositions(V);const ie=L(V.type);ie&&this._fire(ie.pointerenter,{evt:V,target:this,currentTarget:this})}_pointerover(V){this.setPointersPositions(V);const ie=L(V.type);ie&&this._fire(ie.pointerover,{evt:V,target:this,currentTarget:this})}_getTargetShape(V){let ie=this[V+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(V){const ie=L(V.type),ge=me(V.type);if(!ie)return;this.setPointersPositions(V);const _e=this._getTargetShape(ge),Me=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;_e&&Me?(_e._fireAndBubble(ie.pointerout,{evt:V}),_e._fireAndBubble(ie.pointerleave,{evt:V}),this._fire(ie.pointerleave,{evt:V,target:this,currentTarget:this}),this[ge+"targetShape"]=null):Me&&(this._fire(ie.pointerleave,{evt:V,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:V,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(V){const ie=L(V.type),ge=me(V.type);if(!ie)return;this.setPointersPositions(V);let _e=!1;this._changedPointerPositions.forEach(Me=>{const H=this.getIntersection(Me);if(s.DD.justDragged=!1,i.Konva["_"+ge+"ListenClick"]=!0,!H||!H.isListening()){this[ge+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&H.setPointerCapture(Me.id),this[ge+"ClickStartShape"]=H,H._fireAndBubble(ie.pointerdown,{evt:V,pointerId:Me.id}),_e=!0;const tt=V.type.indexOf("touch")>=0;H.preventDefault()&&V.cancelable&&tt&&V.preventDefault()}),_e||this._fire(ie.pointerdown,{evt:V,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(V){const ie=L(V.type),ge=me(V.type);if(!ie||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&V.cancelable&&V.preventDefault(),this.setPointersPositions(V),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Me={};let H=!1;const tt=this._getTargetShape(ge);this._changedPointerPositions.forEach(nt=>{const Xe=u.getCapturedShape(nt.id)||this.getIntersection(nt),Ze=nt.id,be={evt:V,pointerId:Ze},Ct=tt!==Xe;if(Ct&&tt&&(tt._fireAndBubble(ie.pointerout,{...be},Xe),tt._fireAndBubble(ie.pointerleave,{...be},Xe)),Xe){if(Me[Xe._id])return;Me[Xe._id]=!0}Xe&&Xe.isListening()?(H=!0,Ct&&(Xe._fireAndBubble(ie.pointerover,{...be},tt),Xe._fireAndBubble(ie.pointerenter,{...be},tt),this[ge+"targetShape"]=Xe),Xe._fireAndBubble(ie.pointermove,{...be})):tt&&(this._fire(ie.pointerover,{evt:V,target:this,currentTarget:this,pointerId:Ze}),this[ge+"targetShape"]=null)}),H||this._fire(ie.pointermove,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(V){const ie=L(V.type),ge=me(V.type);if(!ie)return;this.setPointersPositions(V);const _e=this[ge+"ClickStartShape"],Me=this[ge+"ClickEndShape"],H={};let tt=!1;this._changedPointerPositions.forEach(nt=>{const Xe=u.getCapturedShape(nt.id)||this.getIntersection(nt);if(Xe){if(Xe.releaseCapture(nt.id),H[Xe._id])return;H[Xe._id]=!0}const Ze=nt.id,be={evt:V,pointerId:Ze};let Ct=!1;i.Konva["_"+ge+"InDblClickWindow"]?(Ct=!0,clearTimeout(this[ge+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+ge+"InDblClickWindow"]=!0,clearTimeout(this[ge+"DblTimeout"])),this[ge+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ge+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Xe&&Xe.isListening()?(tt=!0,this[ge+"ClickEndShape"]=Xe,Xe._fireAndBubble(ie.pointerup,{...be}),i.Konva["_"+ge+"ListenClick"]&&_e&&_e===Xe&&(Xe._fireAndBubble(ie.pointerclick,{...be}),Ct&&Me&&Me===Xe&&Xe._fireAndBubble(ie.pointerdblclick,{...be}))):(this[ge+"ClickEndShape"]=null,i.Konva["_"+ge+"ListenClick"]&&this._fire(ie.pointerclick,{evt:V,target:this,currentTarget:this,pointerId:Ze}),Ct&&this._fire(ie.pointerdblclick,{evt:V,target:this,currentTarget:this,pointerId:Ze}))}),tt||this._fire(ie.pointerup,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ge+"ListenClick"]=!1,V.cancelable&&ge!=="touch"&&ge!=="pointer"&&V.preventDefault()}_contextmenu(V){this.setPointersPositions(V);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(D,{evt:V}):this._fire(D,{evt:V,target:this,currentTarget:this})}_wheel(V){this.setPointersPositions(V);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(ae,{evt:V}):this._fire(ae,{evt:V,target:this,currentTarget:this})}_pointercancel(V){this.setPointersPositions(V);const ie=u.getCapturedShape(V.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(A,u.createEvent(V)),u.releaseCapture(V.pointerId)}_lostpointercapture(V){u.releaseCapture(V.pointerId)}setPointersPositions(V){const ie=this._getContentPosition();let ge=null,_e=null;V=V||window.event,V.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(V.touches,Me=>{this._pointerPositions.push({id:Me.identifier,x:(Me.clientX-ie.left)/ie.scaleX,y:(Me.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(V.changedTouches||V.touches,Me=>{this._changedPointerPositions.push({id:Me.identifier,x:(Me.clientX-ie.left)/ie.scaleX,y:(Me.clientY-ie.top)/ie.scaleY})})):(ge=(V.clientX-ie.left)/ie.scaleX,_e=(V.clientY-ie.top)/ie.scaleY,this.pointerPos={x:ge,y:_e},this._pointerPositions=[{x:ge,y:_e,id:t.Util._getFirstPointerId(V)}],this._changedPointerPositions=[{x:ge,y:_e,id:t.Util._getFirstPointerId(V)}])}_setPointerPosition(V){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(V)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const V=this.content.getBoundingClientRect();return{top:V.top,left:V.left,scaleX:V.width/this.content.clientWidth||1,scaleY:V.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const V=this.container();if(!V)throw"Stage has no container. A container is required.";V.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),V.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(V){V.batchDraw()}),this}}e.Stage=Y,Y.prototype.nodeType=f,(0,o._registerNode)(Y),r.Factory.addGetterSetter(Y,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(de=>{de.batchDraw()})})})(Lw);var yu={},Or={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=gt,r=or,n=yt,i=tr,a=at,s=gt,o=Gs,u="hasShadow",f="shadowRGBA",d="patternImage",p="linearGradient",g="radialGradient";let v;function m(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}e.shapes={};function _(I){const b=this.attrs.fillRule;b?I.fill(b):I.fill()}function C(I){I.stroke()}function S(I){const b=this.attrs.fillRule;b?I.fill(b):I.fill()}function w(I){I.stroke()}function x(){this._clearCache(u)}function T(){this._clearCache(f)}function A(){this._clearCache(d)}function N(){this._clearCache(p)}function R(){this._clearCache(g)}class P extends i.Node{constructor(b){super(b);let M;for(;M=r.Util.getRandomColor(),!(M&&!(M in e.shapes)););this.colorKey=M,e.shapes[M]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const D=new r.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(t.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Q=D.getMatrix(),he=typeof DOMMatrix>"u"?{a:Q[0],b:Q[1],c:Q[2],d:Q[3],e:Q[4],f:Q[5]}:new DOMMatrix(Q);M.setTransform(he)}return M}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const b=this.fillLinearGradientColorStops();if(b){const M=m(),D=this.fillLinearGradientStartPoint(),Q=this.fillLinearGradientEndPoint(),he=M.createLinearGradient(D.x,D.y,Q.x,Q.y);for(let z=0;z<b.length;z+=2)he.addColorStop(b[z],b[z+1]);return he}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const b=this.fillRadialGradientColorStops();if(b){const M=m(),D=this.fillRadialGradientStartPoint(),Q=this.fillRadialGradientEndPoint(),he=M.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),Q.x,Q.y,this.fillRadialGradientEndRadius());for(let z=0;z<b.length;z+=2)he.addColorStop(b[z],b[z+1]);return he}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const b=r.Util.colorToRGBA(this.shadowColor());if(b)return"rgba("+b.r+","+b.g+","+b.b+","+b.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const b=this.hitStrokeWidth();return b==="auto"?this.hasStroke():this.strokeEnabled()&&!!b}intersects(b){const M=this.getStage();if(!M)return!1;const D=M.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(b.x),Math.round(b.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(b){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const Q=b||this.hasFill(),he=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(Q&&he&&z)return!0;const Z=this.hasShadow(),ae=this.shadowForStrokeEnabled();return!!(Q&&he&&Z&&ae)}setStrokeHitEnabled(b){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),b?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const b=this.size();return{x:this._centroid?-b.width/2:0,y:this._centroid?-b.height/2:0,width:b.width,height:b.height}}getClientRect(b={}){let M=!1,D=this.getParent();for(;D;){if(D.isCached()){M=!0;break}D=D.getParent()}const Q=b.skipTransform,he=b.relativeTo||M&&this.getStage()||void 0,z=this.getSelfRect(),ae=!b.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,ne=z.width+ae,K=z.height+ae,ce=!b.skipShadow&&this.hasShadow(),me=ce?this.shadowOffsetX():0,L=ce?this.shadowOffsetY():0,ee=ne+Math.abs(me),q=K+Math.abs(L),Y=ce&&this.shadowBlur()||0,de=ee+Y*2,V=q+Y*2,ie={width:de,height:V,x:-(ae/2+Y)+Math.min(me,0)+z.x,y:-(ae/2+Y)+Math.min(L,0)+z.y};return Q?ie:this._transformedRect(ie,he)}drawScene(b,M,D){const Q=this.getLayer(),he=b||Q.getCanvas(),z=he.getContext(),Z=this._getCanvasCache(),ae=this.getSceneFunc(),ne=this.hasShadow();let K;const ce=!1,me=M===this;if(!this.isVisible()&&!me)return this;if(Z){z.save();const L=this.getAbsoluteTransform(M).getMatrix();return z.transform(L[0],L[1],L[2],L[3],L[4],L[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!ae)return this;if(z.save(),this._useBufferCanvas()&&!ce){K=this.getStage();const L=D||K.bufferCanvas,ee=L.getContext();ee.clear(),ee.save(),ee._applyLineJoin(this);const q=this.getAbsoluteTransform(M).getMatrix();ee.transform(q[0],q[1],q[2],q[3],q[4],q[5]),ae.call(this,ee,this),ee.restore();const Y=L.pixelRatio;ne&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(L._canvas,L.x||0,L.y||0,L.width/Y,L.height/Y)}else{if(z._applyLineJoin(this),!me){const L=this.getAbsoluteTransform(M).getMatrix();z.transform(L[0],L[1],L[2],L[3],L[4],L[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}ne&&z._applyShadow(this),ae.call(this,z,this)}return z.restore(),this}drawHit(b,M,D=!1){if(!this.shouldDrawHit(M,D))return this;const Q=this.getLayer(),he=b||Q.hitCanvas,z=he&&he.getContext(),Z=this.hitFunc()||this.sceneFunc(),ae=this._getCanvasCache(),ne=ae&&ae.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),ne){z.save();const ce=this.getAbsoluteTransform(M).getMatrix();return z.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!Z)return this;if(z.save(),z._applyLineJoin(this),!(this===M)){const ce=this.getAbsoluteTransform(M).getMatrix();z.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5])}return Z.call(this,z,this),z.restore(),this}drawHitFromCache(b=0){const M=this._getCanvasCache(),D=this._getCachedSceneCanvas(),Q=M.hit,he=Q.getContext(),z=Q.getWidth(),Z=Q.getHeight();he.clear(),he.drawImage(D._canvas,0,0,z,Z);try{const ae=he.getImageData(0,0,z,Z),ne=ae.data,K=ne.length,ce=r.Util._hexToRgb(this.colorKey);for(let me=0;me<K;me+=4)ne[me+3]>b?(ne[me]=ce.r,ne[me+1]=ce.g,ne[me+2]=ce.b,ne[me+3]=255):ne[me+3]=0;he.putImageData(ae,0,0)}catch(ae){r.Util.error("Unable to draw hit graph from cached scene canvas. "+ae.message)}return this}hasPointerCapture(b){return o.hasPointerCapture(b,this)}setPointerCapture(b){o.setPointerCapture(b,this)}releaseCapture(b){o.releaseCapture(b,this)}}e.Shape=P,P.prototype._fillFunc=_,P.prototype._strokeFunc=C,P.prototype._fillFuncHit=S,P.prototype._strokeFuncHit=w,P.prototype._centroid=!1,P.prototype.nodeType="Shape",(0,s._registerNode)(P),P.prototype.eventListeners={},P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",N),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",R),n.Factory.addGetterSetter(P,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(P,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(P,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"lineJoin"),n.Factory.addGetterSetter(P,"lineCap"),n.Factory.addGetterSetter(P,"sceneFunc"),n.Factory.addGetterSetter(P,"hitFunc"),n.Factory.addGetterSetter(P,"dash"),n.Factory.addGetterSetter(P,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(P,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(P,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternImage"),n.Factory.addGetterSetter(P,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(P,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(P,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(P,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(P,"fillEnabled",!0),n.Factory.addGetterSetter(P,"strokeEnabled",!0),n.Factory.addGetterSetter(P,"shadowEnabled",!0),n.Factory.addGetterSetter(P,"dashEnabled",!0),n.Factory.addGetterSetter(P,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(P,"fillPriority","color"),n.Factory.addComponentsGetterSetter(P,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(P,"fillPatternRotation",0),n.Factory.addGetterSetter(P,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(P,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Or);Object.defineProperty(yu,"__esModule",{value:!0});yu.Layer=void 0;const Fa=or,yg=Uo,pl=tr,Sx=yt,H3=qi,MO=at,BO=Or,jO=gt,UO="#",zO="beforeDraw",VO="draw",jw=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],GO=jw.length;let fc=class extends yg.Container{constructor(t){super(t),this.canvas=new H3.SceneCanvas,this.hitCanvas=new H3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),t<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[t+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){pl.Node.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!pl.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(pl.Node.prototype.moveDown.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(pl.Node.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return pl.Node.prototype.remove.call(this),t&&t.parentNode&&Fa.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:r}){return this.canvas.setSize(t,r),this.hitCanvas.setSize(t,r),this._setSmoothEnabled(),this}_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&Fa.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),pl.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Fa.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Fa.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Fa.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<GO;i++){const a=jw[i],s=this._getIntersection({x:t.x+a.x*r,y:t.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(t){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*r),Math.round(t.y*r),1,1).data,i=n[3];if(i===255){const a=Fa.Util._rgbToHex(n[0],n[1],n[2]),s=BO.shapes[UO+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(zO,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),yg.Container.prototype.drawScene.call(this,a,r,n),this._fire(VO,{node:this}),this}drawHit(t,r){const n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),yg.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Fa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Fa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Fa.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};yu.Layer=fc;fc.prototype.nodeType="Layer";(0,jO._registerNode)(fc);Sx.Factory.addGetterSetter(fc,"imageSmoothingEnabled",!0);Sx.Factory.addGetterSetter(fc,"clearBeforeDraw",!0);Sx.Factory.addGetterSetter(fc,"hitGraphEnabled",!0,(0,MO.getBooleanValidator)());var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.FastLayer=void 0;const HO=or,WO=yu,$O=gt;class wx extends WO.Layer{constructor(t){super(t),this.listening(!1),HO.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Rh.FastLayer=wx;wx.prototype.nodeType="FastLayer";(0,$O._registerNode)(wx);var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Group=void 0;const XO=or,KO=Uo,YO=gt;let kx=class extends KO.Container{_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&XO.Util.throw("You may only add groups and shapes to groups.")}};dc.Group=kx;kx.prototype.nodeType="Group";(0,YO._registerNode)(kx);var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.Animation=void 0;const _g=gt,W3=or,Sg=function(){return _g.glob.performance&&_g.glob.performance.now?function(){return _g.glob.performance.now()}:function(){return new Date().getTime()}}();class ha{constructor(t,r){this.id=ha.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Sg(),frameRate:0},this.func=t,this.setLayers(r)}setLayers(t){let r=[];return t&&(r=Array.isArray(t)?t:[t]),this.layers=r,this}getLayers(){return this.layers}addLayer(t){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const r=ha.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Sg(),ha._addAnimation(this),this}stop(){return ha._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const r=t.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const t={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(Sg());const o=a.length;let u;if(s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<o;f++){const d=a[f];d._id!==void 0&&(t[d._id]=d)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=ha;t.animations.length?(t._runFrames(),W3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,W3.Util.requestAnimFrame(this._animationLoop))}}hc.Animation=ha;ha.animations=[];ha.animIdCounter=0;ha.animRunning=!1;var Uw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=or,r=hc,n=tr,i=gt,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,u=3,f=["fill","stroke","shadowColor"];let d=0;class p{constructor(m,_,C,S,w,x,T){this.prop=m,this.propFunc=_,this.begin=S,this._pos=S,this.duration=x,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=C,this._change=w-this.begin,this.pause()}fire(m){const _=this[m];_&&_()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===o?this.setTime(m):this.state===u&&this.setTime(this.duration-m)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(m){const _=this,C=m.node,S=C._id,w=m.easing||e.Easings.Linear,x=!!m.yoyo;let T,A;typeof m.duration>"u"?T=.3:m.duration===0?T=.001:T=m.duration,this.node=C,this._id=d++;const N=C.getLayer()||(C instanceof i.Konva.Stage?C.getLayers():null);N||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){_.tween.onEnterFrame()},N),this.tween=new p(A,function(R){_._tweenFunc(R)},w,0,1,T*1e3,x),this._addListeners(),g.attrs[S]||(g.attrs[S]={}),g.attrs[S][this._id]||(g.attrs[S][this._id]={}),g.tweens[S]||(g.tweens[S]={});for(A in m)a[A]===void 0&&this._addAttr(A,m[A]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,_){const C=this.node,S=C._id;let w,x,T,A,N;const R=g.tweens[S][m];R&&delete g.attrs[S][R][m];let P=C.getAttr(m);if(t.Util._isArray(_))if(w=[],x=Math.max(_.length,P.length),m==="points"&&_.length!==P.length&&(_.length>P.length?(A=P,P=t.Util._prepareArrayForTween(P,_,C.closed())):(T=_,_=t.Util._prepareArrayForTween(_,P,C.closed()))),m.indexOf("fill")===0)for(let I=0;I<x;I++)if(I%2===0)w.push(_[I]-P[I]);else{const b=t.Util.colorToRGBA(P[I]);N=t.Util.colorToRGBA(_[I]),P[I]=b,w.push({r:N.r-b.r,g:N.g-b.g,b:N.b-b.b,a:N.a-b.a})}else for(let I=0;I<x;I++)w.push(_[I]-P[I]);else f.indexOf(m)!==-1?(P=t.Util.colorToRGBA(P),N=t.Util.colorToRGBA(_),w={r:N.r-P.r,g:N.g-P.g,b:N.b-P.b,a:N.a-P.a}):w=_-P;g.attrs[S][this._id][m]={start:P,diff:w,end:_,trueEnd:T,trueStart:A},g.tweens[S][m]=this._id}_tweenFunc(m){const _=this.node,C=g.attrs[_._id][this._id];let S,w,x,T,A,N,R,P;for(S in C){if(w=C[S],x=w.start,T=w.diff,P=w.end,t.Util._isArray(x))if(A=[],R=Math.max(x.length,P.length),S.indexOf("fill")===0)for(N=0;N<R;N++)N%2===0?A.push((x[N]||0)+T[N]*m):A.push("rgba("+Math.round(x[N].r+T[N].r*m)+","+Math.round(x[N].g+T[N].g*m)+","+Math.round(x[N].b+T[N].b*m)+","+(x[N].a+T[N].a*m)+")");else for(N=0;N<R;N++)A.push((x[N]||0)+T[N]*m);else f.indexOf(S)!==-1?A="rgba("+Math.round(x.r+T.r*m)+","+Math.round(x.g+T.g*m)+","+Math.round(x.b+T.b*m)+","+(x.a+T.a*m)+")":A=x+T*m;_.setAttr(S,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,_=g.attrs[m._id][this._id];_.points&&_.points.trueEnd&&m.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,_=g.attrs[m._id][this._id];_.points&&_.points.trueStart&&m.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,_=this._id,C=g.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const S in C)delete g.tweens[m][S];delete g.attrs[m][_],g.tweens[m]&&(Object.keys(g.tweens[m]).length===0&&delete g.tweens[m],Object.keys(g.attrs[m]).length===0&&delete g.attrs[m])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(v){const m=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),m&&m()},new g(v).play()},e.Easings={BackEaseIn(v,m,_,C){return _*(v/=C)*v*((1.70158+1)*v-1.70158)+m},BackEaseOut(v,m,_,C){return _*((v=v/C-1)*v*((1.70158+1)*v+1.70158)+1)+m},BackEaseInOut(v,m,_,C){let S=1.70158;return(v/=C/2)<1?_/2*(v*v*(((S*=1.525)+1)*v-S))+m:_/2*((v-=2)*v*(((S*=1.525)+1)*v+S)+2)+m},ElasticEaseIn(v,m,_,C,S,w){let x=0;return v===0?m:(v/=C)===1?m+_:(w||(w=C*.3),!S||S<Math.abs(_)?(S=_,x=w/4):x=w/(2*Math.PI)*Math.asin(_/S),-(S*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w))+m)},ElasticEaseOut(v,m,_,C,S,w){let x=0;return v===0?m:(v/=C)===1?m+_:(w||(w=C*.3),!S||S<Math.abs(_)?(S=_,x=w/4):x=w/(2*Math.PI)*Math.asin(_/S),S*Math.pow(2,-10*v)*Math.sin((v*C-x)*(2*Math.PI)/w)+_+m)},ElasticEaseInOut(v,m,_,C,S,w){let x=0;return v===0?m:(v/=C/2)===2?m+_:(w||(w=C*(.3*1.5)),!S||S<Math.abs(_)?(S=_,x=w/4):x=w/(2*Math.PI)*Math.asin(_/S),v<1?-.5*(S*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w))+m:S*Math.pow(2,-10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w)*.5+_+m)},BounceEaseOut(v,m,_,C){return(v/=C)<1/2.75?_*(7.5625*v*v)+m:v<2/2.75?_*(7.5625*(v-=1.5/2.75)*v+.75)+m:v<2.5/2.75?_*(7.5625*(v-=2.25/2.75)*v+.9375)+m:_*(7.5625*(v-=2.625/2.75)*v+.984375)+m},BounceEaseIn(v,m,_,C){return _-e.Easings.BounceEaseOut(C-v,0,_,C)+m},BounceEaseInOut(v,m,_,C){return v<C/2?e.Easings.BounceEaseIn(v*2,0,_,C)*.5+m:e.Easings.BounceEaseOut(v*2-C,0,_,C)*.5+_*.5+m},EaseIn(v,m,_,C){return _*(v/=C)*v+m},EaseOut(v,m,_,C){return-_*(v/=C)*(v-2)+m},EaseInOut(v,m,_,C){return(v/=C/2)<1?_/2*v*v+m:-_/2*(--v*(v-2)-1)+m},StrongEaseIn(v,m,_,C){return _*(v/=C)*v*v*v*v+m},StrongEaseOut(v,m,_,C){return _*((v=v/C-1)*v*v*v*v+1)+m},StrongEaseInOut(v,m,_,C){return(v/=C/2)<1?_/2*v*v*v*v*v+m:_/2*((v-=2)*v*v*v*v+2)+m},Linear(v,m,_,C){return _*v/C+m}}})(Uw);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=gt,r=or,n=tr,i=Uo,a=Lw,s=yu,o=Rh,u=dc,f=Fh,d=Or,p=hc,g=Uw,v=za,m=qi;e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:u.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:v.Context,Canvas:m.Canvas}),e.default=e.Konva})(Qd);var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Arc=void 0;const bh=yt,QO=Or,$3=gt,Oh=at,qO=gt;class Ja extends QO.Shape{_sceneFunc(t){const r=$3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,r,n),t.arc(0,0,this.innerRadius(),r,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=$3.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?t:r),d=s*r,p=o*(o>0?t:r),g=u*(u>0?r:t);return{x:f,y:n?-1*g:p,width:d-f,height:g-p}}}Ih.Arc=Ja;Ja.prototype._centroid=!0;Ja.prototype.className="Arc";Ja.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,qO._registerNode)(Ja);bh.Factory.addGetterSetter(Ja,"innerRadius",0,(0,Oh.getNumberValidator)());bh.Factory.addGetterSetter(Ja,"outerRadius",0,(0,Oh.getNumberValidator)());bh.Factory.addGetterSetter(Ja,"angle",0,(0,Oh.getNumberValidator)());bh.Factory.addGetterSetter(Ja,"clockwise",!1,(0,Oh.getBooleanValidator)());var Dh={},_u={};Object.defineProperty(_u,"__esModule",{value:!0});_u.Line=void 0;const Lh=yt,JO=gt,ZO=Or,zw=at;function zm(e,t,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*o/(o+u),d=s*u/(o+u),p=r-f*(i-e),g=n-f*(a-t),v=r+d*(i-e),m=n+d*(a-t);return[p,g,v,m]}function X3(e,t){const r=e.length,n=[];for(let i=2;i<r-2;i+=2){const a=zm(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(e[i]),n.push(e[i+1]),n.push(a[2]),n.push(a[3]))}return n}let Hs=class extends ZO.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let o=0;if(t.beginPath(),t.moveTo(r[0],r[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(o=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);o<f-2;)t.bezierCurveTo(u[o++],u[o++],u[o++],u[o++],u[o++],u[o++]);a||t.quadraticCurveTo(u[f-2],u[f-1],r[n-2],r[n-1])}else if(s)for(o=2;o<n;)t.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)t.lineTo(r[o],r[o+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():X3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),r=t.length,n=this.tension(),i=zm(t[r-2],t[r-1],t[0],t[1],t[2],t[3],n),a=zm(t[r-4],t[r-3],t[r-2],t[r-1],t[0],t[1],n),s=X3(t,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],t[r-2],t[r-1],a[2],a[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};_u.Line=Hs;Hs.prototype.className="Line";Hs.prototype._attrsAffectingSize=["points","bezier","tension"];(0,JO._registerNode)(Hs);Lh.Factory.addGetterSetter(Hs,"closed",!1);Lh.Factory.addGetterSetter(Hs,"bezier",!1);Lh.Factory.addGetterSetter(Hs,"tension",0,(0,zw.getNumberValidator)());Lh.Factory.addGetterSetter(Hs,"points",[],(0,zw.getNumberArrayValidator)());var pc={},Vw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,o,u)=>{let f,d;const g=u/2;f=0;for(let v=0;v<20;v++)d=g*e.tValues[20][v]+g,f+=e.cValues[20][v]*n(s,o,d);return g*f};e.getCubicArcLength=t;const r=(s,o,u)=>{u===void 0&&(u=1);const f=s[0]-2*s[1]+s[2],d=o[0]-2*o[1]+o[2],p=2*s[1]-2*s[0],g=2*o[1]-2*o[0],v=4*(f*f+d*d),m=4*(f*p+d*g),_=p*p+g*g;if(v===0)return u*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const C=m/(2*v),S=_/v,w=u+C,x=S-C*C,T=w*w+x>0?Math.sqrt(w*w+x):0,A=C*C+x>0?Math.sqrt(C*C+x):0,N=C+Math.sqrt(C*C+x)!==0?x*Math.log(Math.abs((w+T)/(C+A))):0;return Math.sqrt(v)/2*(w*T-C*A+N)};e.getQuadraticArcLength=r;function n(s,o,u){const f=i(1,u,s),d=i(1,u,o),p=f*f+d*d;return Math.sqrt(p)}const i=(s,o,u)=>{const f=u.length-1;let d,p;if(f===0)return 0;if(s===0){p=0;for(let g=0;g<=f;g++)p+=e.binomialCoefficients[f][g]*Math.pow(1-o,f-g)*Math.pow(o,g)*u[g];return p}else{d=new Array(f);for(let g=0;g<f;g++)d[g]=f*(u[g+1]-u[g]);return i(s-1,o,d)}},a=(s,o,u)=>{let f=1,d=s/o,p=(s-u(d))/o,g=0;for(;f>.001;){const v=u(d+p),m=Math.abs(s-v)/o;if(m<f)f=m,d+=p;else{const _=u(d-p),C=Math.abs(s-_)/o;C<f?(f=C,d-=p):p/=2}if(g++,g>500)break}return d};e.t2length=a})(Vw);Object.defineProperty(pc,"__esModule",{value:!0});pc.Path=void 0;const eD=yt,tD=gt,rD=Or,gl=Vw;class Pr extends rD.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Pr.parsePathData(this.data()),this.pathLength=Pr.getPathLength(this.dataArray)}_sceneFunc(t){const r=this.dataArray;t.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const o=s[0],u=s[1],f=s[2],d=s[3],p=s[4],g=s[5],v=s[6],m=s[7],_=f>d?f:d,C=f>d?1:f/d,S=f>d?d/f:1;t.translate(o,u),t.rotate(v),t.scale(C,S),t.arc(0,0,_,p,p+g,1-m),t.scale(1/C,1/S),t.rotate(-v),t.translate(-o,-u);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],d=u.points[5],p=u.points[4]+d;let g=Math.PI/180;if(Math.abs(f-p)<g&&(g=Math.abs(f-p)),d<0)for(let v=f-g;v>p;v-=g){const m=Pr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}else for(let v=f+g;v<p;v+=g){const m=Pr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const d=Pr.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(d.x,d.y)}else t=t.concat(u.points)});let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return Pr.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}static getPathLength(t){let r=0;for(let n=0;n<t.length;++n)r+=t[n].pathLength;return r}static getPointAtLengthOfDataArray(t,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&t>r[i].pathLength;)t-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],o=s.points;switch(s.command){case"L":return Pr.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Pr.getPointOnCubicBezier((0,gl.t2length)(t,Pr.getPathLength(r),_=>(0,gl.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],_)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Pr.getPointOnQuadraticBezier((0,gl.t2length)(t,Pr.getPathLength(r),_=>(0,gl.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],_)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":const u=o[0],f=o[1],d=o[2],p=o[3],g=o[5],v=o[6];let m=o[4];return m+=g*t/s.pathLength,Pr.getPointOnEllipticalArc(u,f,d,p,m,v)}return null}static getPointOnLine(t,r,n,i,a,s,o){s=s??r,o=o??n;const u=this.getLineLength(r,n,i,a);if(u<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?t:-t)};const f=(a-n)/(i-r),d=Math.sqrt(t*t/(1+f*f))*(i<r?-1:1),p=f*d;if(Math.abs(o-n-f*(s-r))<1e-10)return{x:s+d,y:o+p};const g=((s-r)*(i-r)+(o-n)*(a-n))/(u*u),v=r+g*(i-r),m=n+g*(a-n),_=this.getLineLength(s,o,v,m),C=Math.sqrt(t*t-_*_),S=Math.sqrt(C*C/(1+f*f))*(i<r?-1:1),w=f*S;return{x:v+S,y:m+w}}static getPointOnCubicBezier(t,r,n,i,a,s,o,u,f){function d(C){return C*C*C}function p(C){return 3*C*C*(1-C)}function g(C){return 3*C*(1-C)*(1-C)}function v(C){return(1-C)*(1-C)*(1-C)}const m=u*d(t)+s*p(t)+i*g(t)+r*v(t),_=f*d(t)+o*p(t)+a*g(t)+n*v(t);return{x:m,y:_}}static getPointOnQuadraticBezier(t,r,n,i,a,s,o){function u(v){return v*v}function f(v){return 2*v*(1-v)}function d(v){return(1-v)*(1-v)}const p=s*u(t)+i*f(t)+r*d(t),g=o*u(t)+a*f(t)+n*d(t);return{x:p,y:g}}static getPointOnEllipticalArc(t,r,n,i,a,s){const o=Math.cos(s),u=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(f.x*o-f.y*u),y:r+(f.x*u+f.y*o)}}static parsePathData(t){if(!t)return[];let r=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let p=0;p<n.length;p++)r=r.replace(new RegExp(n[p],"g"),"|"+n[p]);const i=r.split("|"),a=[],s=[];let o=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let p=1;p<i.length;p++){let g=i[p],v=g.charAt(0);for(g=g.slice(1),s.length=0;d=f.exec(g);)s.push(d[0]);const m=[];for(let _=0,C=s.length;_<C;_++){if(s[_]==="00"){m.push(0,0);continue}const S=parseFloat(s[_]);isNaN(S)?m.push(0):m.push(S)}for(;m.length>0&&!isNaN(m[0]);){let _="",C=[];const S=o,w=u;let x,T,A,N,R,P,I,b,M,D;switch(v){case"l":o+=m.shift(),u+=m.shift(),_="L",C.push(o,u);break;case"L":o=m.shift(),u=m.shift(),C.push(o,u);break;case"m":const Q=m.shift(),he=m.shift();if(o+=Q,u+=he,_="M",a.length>2&&a[a.length-1].command==="z"){for(let z=a.length-2;z>=0;z--)if(a[z].command==="M"){o=a[z].points[0]+Q,u=a[z].points[1]+he;break}}C.push(o,u),v="l";break;case"M":o=m.shift(),u=m.shift(),_="M",C.push(o,u),v="L";break;case"h":o+=m.shift(),_="L",C.push(o,u);break;case"H":o=m.shift(),_="L",C.push(o,u);break;case"v":u+=m.shift(),_="L",C.push(o,u);break;case"V":u=m.shift(),_="L",C.push(o,u);break;case"C":C.push(m.shift(),m.shift(),m.shift(),m.shift()),o=m.shift(),u=m.shift(),C.push(o,u);break;case"c":C.push(o+m.shift(),u+m.shift(),o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),_="C",C.push(o,u);break;case"S":T=o,A=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),A=u+(u-x.points[3])),C.push(T,A,m.shift(),m.shift()),o=m.shift(),u=m.shift(),_="C",C.push(o,u);break;case"s":T=o,A=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),A=u+(u-x.points[3])),C.push(T,A,o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),_="C",C.push(o,u);break;case"Q":C.push(m.shift(),m.shift()),o=m.shift(),u=m.shift(),C.push(o,u);break;case"q":C.push(o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),_="Q",C.push(o,u);break;case"T":T=o,A=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),A=u+(u-x.points[1])),o=m.shift(),u=m.shift(),_="Q",C.push(T,A,o,u);break;case"t":T=o,A=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),A=u+(u-x.points[1])),o+=m.shift(),u+=m.shift(),_="Q",C.push(T,A,o,u);break;case"A":N=m.shift(),R=m.shift(),P=m.shift(),I=m.shift(),b=m.shift(),M=o,D=u,o=m.shift(),u=m.shift(),_="A",C=this.convertEndpointToCenterParameterization(M,D,o,u,I,b,N,R,P);break;case"a":N=m.shift(),R=m.shift(),P=m.shift(),I=m.shift(),b=m.shift(),M=o,D=u,o+=m.shift(),u+=m.shift(),_="A",C=this.convertEndpointToCenterParameterization(M,D,o,u,I,b,N,R,P);break}a.push({command:_||v,points:C,start:{x:S,y:w},pathLength:this.calcLength(S,w,_||v,C)})}(v==="z"||v==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,r,n,i){let a,s,o,u;const f=Pr;switch(n){case"L":return f.getLineLength(t,r,i[0],i[1]);case"C":return(0,gl.getCubicArcLength)([t,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,gl.getQuadraticArcLength)([t,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],p=i[5],g=i[4]+p;let v=Math.PI/180;if(Math.abs(d-g)<v&&(v=Math.abs(d-g)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),p<0)for(u=d-v;u>g;u-=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=d+v;u<g;u+=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],g,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(t,r,n,i,a,s,o,u,f){const d=f*(Math.PI/180),p=Math.cos(d)*(t-n)/2+Math.sin(d)*(r-i)/2,g=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(r-i)/2,v=p*p/(o*o)+g*g/(u*u);v>1&&(o*=Math.sqrt(v),u*=Math.sqrt(v));let m=Math.sqrt((o*o*(u*u)-o*o*(g*g)-u*u*(p*p))/(o*o*(g*g)+u*u*(p*p)));a===s&&(m*=-1),isNaN(m)&&(m=0);const _=m*o*g/u,C=m*-u*p/o,S=(t+n)/2+Math.cos(d)*_-Math.sin(d)*C,w=(r+i)/2+Math.sin(d)*_+Math.cos(d)*C,x=function(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])},T=function(b,M){return(b[0]*M[0]+b[1]*M[1])/(x(b)*x(M))},A=function(b,M){return(b[0]*M[1]<b[1]*M[0]?-1:1)*Math.acos(T(b,M))},N=A([1,0],[(p-_)/o,(g-C)/u]),R=[(p-_)/o,(g-C)/u],P=[(-1*p-_)/o,(-1*g-C)/u];let I=A(R,P);return T(R,P)<=-1&&(I=Math.PI),T(R,P)>=1&&(I=0),s===0&&I>0&&(I=I-2*Math.PI),s===1&&I<0&&(I=I+2*Math.PI),[S,w,o,u,N,I,d,s]}}pc.Path=Pr;Pr.prototype.className="Path";Pr.prototype._attrsAffectingSize=["data"];(0,tD._registerNode)(Pr);eD.Factory.addGetterSetter(Pr,"data");Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Arrow=void 0;const Mh=yt,nD=_u,Gw=at,iD=gt,K3=pc;class Vo extends nD.Line{_sceneFunc(t){super._sceneFunc(t);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let u,f;if(a){const g=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],v=K3.Path.calcLength(i[i.length-4],i[i.length-3],"C",g),m=K3.Path.getPointOnQuadraticBezier(Math.min(1,1-s/v),g[0],g[1],g[2],g[3],g[4],g[5]);u=n[o-2]-m.x,f=n[o-1]-m.y}else u=n[o-2]-n[o-4],f=n[o-1]-n[o-3];const d=(Math.atan2(f,u)+r)%r,p=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[o-2],n[o-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),a?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-u)+r)%r),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),r=this.pointerWidth()/2;return{x:t.x,y:t.y-r,width:t.width,height:t.height+r*2}}}Dh.Arrow=Vo;Vo.prototype.className="Arrow";(0,iD._registerNode)(Vo);Mh.Factory.addGetterSetter(Vo,"pointerLength",10,(0,Gw.getNumberValidator)());Mh.Factory.addGetterSetter(Vo,"pointerWidth",10,(0,Gw.getNumberValidator)());Mh.Factory.addGetterSetter(Vo,"pointerAtBeginning",!1);Mh.Factory.addGetterSetter(Vo,"pointerAtEnding",!0);var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Circle=void 0;const aD=yt,sD=Or,oD=at,lD=gt;let gc=class extends sD.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Bh.Circle=gc;gc.prototype._centroid=!0;gc.prototype.className="Circle";gc.prototype._attrsAffectingSize=["radius"];(0,lD._registerNode)(gc);aD.Factory.addGetterSetter(gc,"radius",0,(0,oD.getNumberValidator)());var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.Ellipse=void 0;const Ex=yt,cD=Or,Hw=at,uD=gt;class Ws extends cD.Shape{_sceneFunc(t){const r=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),r!==n&&t.scale(1,n/r),t.arc(0,0,r,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}jh.Ellipse=Ws;Ws.prototype.className="Ellipse";Ws.prototype._centroid=!0;Ws.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,uD._registerNode)(Ws);Ex.Factory.addComponentsGetterSetter(Ws,"radius",["x","y"]);Ex.Factory.addGetterSetter(Ws,"radiusX",0,(0,Hw.getNumberValidator)());Ex.Factory.addGetterSetter(Ws,"radiusY",0,(0,Hw.getNumberValidator)());var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.Image=void 0;const wg=or,Go=yt,fD=Or,dD=gt,Su=at;class Ni extends fD.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),r=this.hasShadow();return t&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,u=this.attrs.cropHeight;o&&u?s=[a,this.cropX(),this.cropY(),o,u,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?wg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){const r=this.width(),n=this.height(),i=this.cornerRadius();t.beginPath(),i?wg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,r;return(t=this.attrs.width)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var t,r;return(t=this.attrs.height)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(t,r,n=null){const i=wg.Util.createImageElement();i.onload=function(){const a=new Ni({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=t}}Uh.Image=Ni;Ni.prototype.className="Image";(0,dD._registerNode)(Ni);Go.Factory.addGetterSetter(Ni,"cornerRadius",0,(0,Su.getNumberOrArrayOfNumbersValidator)(4));Go.Factory.addGetterSetter(Ni,"image");Go.Factory.addComponentsGetterSetter(Ni,"crop",["x","y","width","height"]);Go.Factory.addGetterSetter(Ni,"cropX",0,(0,Su.getNumberValidator)());Go.Factory.addGetterSetter(Ni,"cropY",0,(0,Su.getNumberValidator)());Go.Factory.addGetterSetter(Ni,"cropWidth",0,(0,Su.getNumberValidator)());Go.Factory.addGetterSetter(Ni,"cropHeight",0,(0,Su.getNumberValidator)());var tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.Tag=tc.Label=void 0;const zh=yt,hD=Or,pD=dc,Cx=at,Ww=gt,$w=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],gD="Change.konva",mD="none",Vm="up",Gm="right",Hm="down",Wm="left",xD=$w.length;class Tx extends pD.Group{constructor(t){super(t),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let r=this,n;const i=function(){r._sync()};for(n=0;n<xD;n++)t.on($w[n]+gD,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),r=this.getTag(),n,i,a,s,o,u,f;if(t&&r){switch(n=t.width(),i=t.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),o=0,u=0,a){case Vm:o=n/2,u=-1*f;break;case Gm:o=n+s,u=i/2;break;case Hm:o=n/2,u=i+f;break;case Wm:o=-1*s,u=i/2;break}r.setAttrs({x:-1*o,y:-1*u,width:n,height:i}),t.setAttrs({x:-1*o,y:-1*u})}}}tc.Label=Tx;Tx.prototype.className="Label";(0,Ww._registerNode)(Tx);class Ho extends hD.Shape{_sceneFunc(t){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let u=0,f=0,d=0,p=0;typeof o=="number"?u=f=d=p=Math.min(o,r/2,n/2):(u=Math.min(o[0]||0,r/2,n/2),f=Math.min(o[1]||0,r/2,n/2),p=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),t.beginPath(),t.moveTo(u,0),i===Vm&&(t.lineTo((r-a)/2,0),t.lineTo(r/2,-1*s),t.lineTo((r+a)/2,0)),t.lineTo(r-f,0),t.arc(r-f,f,f,Math.PI*3/2,0,!1),i===Gm&&(t.lineTo(r,(n-s)/2),t.lineTo(r+a,n/2),t.lineTo(r,(n+s)/2)),t.lineTo(r,n-p),t.arc(r-p,n-p,p,0,Math.PI/2,!1),i===Hm&&(t.lineTo((r+a)/2,n),t.lineTo(r/2,n+s),t.lineTo((r-a)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===Wm&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===Vm?(r-=i,o+=i):a===Hm?o+=i:a===Wm?(t-=n*1.5,s+=n):a===Gm&&(s+=n*1.5),{x:t,y:r,width:s,height:o}}}tc.Tag=Ho;Ho.prototype.className="Tag";(0,Ww._registerNode)(Ho);zh.Factory.addGetterSetter(Ho,"pointerDirection",mD);zh.Factory.addGetterSetter(Ho,"pointerWidth",0,(0,Cx.getNumberValidator)());zh.Factory.addGetterSetter(Ho,"pointerHeight",0,(0,Cx.getNumberValidator)());zh.Factory.addGetterSetter(Ho,"cornerRadius",0,(0,Cx.getNumberOrArrayOfNumbersValidator)(4));var wu={};Object.defineProperty(wu,"__esModule",{value:!0});wu.Rect=void 0;const vD=yt,yD=Or,_D=gt,SD=or,wD=at;let Vh=class extends yD.Shape{_sceneFunc(t){const r=this.cornerRadius(),n=this.width(),i=this.height();t.beginPath(),r?SD.Util.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}};wu.Rect=Vh;Vh.prototype.className="Rect";(0,_D._registerNode)(Vh);vD.Factory.addGetterSetter(Vh,"cornerRadius",0,(0,wD.getNumberOrArrayOfNumbersValidator)(4));var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.RegularPolygon=void 0;const Xw=yt,kD=Or,Kw=at,ED=gt;class Wo extends kD.Shape{_sceneFunc(t){const r=this._getPoints();t.beginPath(),t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<t;i++)n.push({x:r*Math.sin(i*2*Math.PI/t),y:-1*r*Math.cos(i*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let r=t[0].x,n=t[0].y,i=t[0].x,a=t[0].y;return t.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Gh.RegularPolygon=Wo;Wo.prototype.className="RegularPolygon";Wo.prototype._centroid=!0;Wo.prototype._attrsAffectingSize=["radius"];(0,ED._registerNode)(Wo);Xw.Factory.addGetterSetter(Wo,"radius",0,(0,Kw.getNumberValidator)());Xw.Factory.addGetterSetter(Wo,"sides",0,(0,Kw.getNumberValidator)());var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Ring=void 0;const Yw=yt,CD=Or,Qw=at,TD=gt,Y3=Math.PI*2;class $o extends CD.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Y3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Y3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Hh.Ring=$o;$o.prototype.className="Ring";$o.prototype._centroid=!0;$o.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,TD._registerNode)($o);Yw.Factory.addGetterSetter($o,"innerRadius",0,(0,Qw.getNumberValidator)());Yw.Factory.addGetterSetter($o,"outerRadius",0,(0,Qw.getNumberValidator)());var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Sprite=void 0;const Xo=yt,AD=Or,PD=hc,qw=at,FD=gt;class _a extends AD.Shape{constructor(t){super(t),this._updated=!0,this.anim=new PD.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],u=a[i+1],f=a[i+2],d=a[i+3],p=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,d),t.closePath(),t.fillStrokeShape(this)),p)if(s){const g=s[r],v=n*2;t.drawImage(p,o,u,f,d,g[v+0],g[v+1],f,d)}else t.drawImage(p,o,u,f,d,0,0,f,d)}_hitFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],u=a[i+3];if(t.beginPath(),s){const f=s[r],d=n*2;t.rect(f[d+0],f[d+1],o,u)}else t.rect(0,0,o,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}}Wh.Sprite=_a;_a.prototype.className="Sprite";(0,FD._registerNode)(_a);Xo.Factory.addGetterSetter(_a,"animation");Xo.Factory.addGetterSetter(_a,"animations");Xo.Factory.addGetterSetter(_a,"frameOffsets");Xo.Factory.addGetterSetter(_a,"image");Xo.Factory.addGetterSetter(_a,"frameIndex",0,(0,qw.getNumberValidator)());Xo.Factory.addGetterSetter(_a,"frameRate",17,(0,qw.getNumberValidator)());Xo.Factory.backCompat(_a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.Star=void 0;const Ax=yt,ND=Or,Px=at,RD=gt;class $s extends ND.Shape{_sceneFunc(t){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),u=-1*s*Math.cos(a*Math.PI/i);t.lineTo(o,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}$h.Star=$s;$s.prototype.className="Star";$s.prototype._centroid=!0;$s.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,RD._registerNode)($s);Ax.Factory.addGetterSetter($s,"numPoints",5,(0,Px.getNumberValidator)());Ax.Factory.addGetterSetter($s,"innerRadius",0,(0,Px.getNumberValidator)());Ax.Factory.addGetterSetter($s,"outerRadius",0,(0,Px.getNumberValidator)());var mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.Text=void 0;mc.stringToArray=fo;const $m=or,wn=yt,ID=Or,kg=gt,Xs=at,bD=gt;function fo(e){return[...e].reduce((t,r,n,i)=>{if(/\p{Emoji}/u.test(r)){const a=i[n+1];a&&/\p{Emoji_Modifier}|\u200D/u.test(a)?(t.push(r+a),i[n+1]=""):t.push(r)}else/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?t.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?t[t.length-1]+=r:r&&t.push(r);return t},[])}const ml="auto",OD="center",Jw="inherit",Xc="justify",DD="Change.konva",LD="2d",Q3="-",Zw="left",MD="text",BD="Text",jD="top",UD="bottom",q3="middle",e8="normal",zD="px ",Xf=" ",VD="right",J3="rtl",GD="word",HD="char",Z3="none",Eg="…",t8=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],WD=t8.length;function $D(e){return e.split(",").map(t=>{t=t.trim();const r=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return r&&!n&&(t=`"${t}"`),t}).join(", ")}let Kf;function Cg(){return Kf||(Kf=$m.Util.createCanvasElement().getContext(LD),Kf)}function XD(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function KD(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function YD(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}let hr=class extends ID.Shape{constructor(t){super(YD(t)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<WD;r++)this.on(t8[r]+DD,this._setTextData);this._setTextData()}_sceneFunc(t){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),u=this.direction(),f=0,d=this.align(),p=this.getWidth(),g=this.letterSpacing(),v=this.fill(),m=this.textDecoration(),_=m.indexOf("underline")!==-1,C=m.indexOf("line-through")!==-1,S;u=u===Jw?t.direction:u;let w=s/2,x=q3;if(kg.Konva._fixTextRendering){const T=this.measureSize("M");x="alphabetic",w=(T.fontBoundingBoxAscent-T.fontBoundingBoxDescent)/2+s/2}for(u===J3&&t.setAttr("direction",u),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",Zw),o===q3?f=(this.getHeight()-n*s-i*2)/2:o===UD&&(f=this.getHeight()-n*s-i*2),t.translate(i,f+i),S=0;S<n;S++){let T=0,A=0;const N=r[S],R=N.text,P=N.width,I=N.lastInParagraph;if(t.save(),d===VD?T+=p-P-i*2:d===OD&&(T+=(p-P-i*2)/2),_){t.save(),t.beginPath();const b=kg.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),M=T,D=w+A+b;t.moveTo(M,D);const Q=d===Xc&&!I?p-i*2:P;t.lineTo(M+Math.round(Q),D),t.lineWidth=a/15;const he=this._getLinearGradient();t.strokeStyle=he||v,t.stroke(),t.restore()}if(C){t.save(),t.beginPath();const b=kg.Konva._fixTextRendering?-Math.round(a/4):0;t.moveTo(T,w+A+b);const M=d===Xc&&!I?p-i*2:P;t.lineTo(T+Math.round(M),w+A+b),t.lineWidth=a/15;const D=this._getLinearGradient();t.strokeStyle=D||v,t.stroke(),t.restore()}if(u!==J3&&(g!==0||d===Xc)){const b=R.split(" ").length-1,M=fo(R);for(let D=0;D<M.length;D++){const Q=M[D];Q===" "&&!I&&d===Xc&&(T+=(p-i*2-P)/b),this._partialTextX=T,this._partialTextY=w+A,this._partialText=Q,t.fillStrokeShape(this),T+=this.measureSize(Q).width+g}}else g!==0&&t.setAttr("letterSpacing",`${g}px`),this._partialTextX=T,this._partialTextY=w+A,this._partialText=R,t.fillStrokeShape(this);t.restore(),n>1&&(w+=s)}}_hitFunc(t){const r=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const r=$m.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(MD,r),this}getWidth(){return this.attrs.width===ml||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ml||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return $m.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var r,n,i,a,s,o,u,f,d,p,g;let v=Cg(),m=this.fontSize(),_;v.save(),v.font=this._getContextFont(),_=v.measureText(t),v.restore();const C=m/100;return{actualBoundingBoxAscent:(r=_.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*C,actualBoundingBoxDescent:(n=_.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=_.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*C,actualBoundingBoxRight:(a=_.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*C,alphabeticBaseline:(s=_.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=_.emHeightAscent)!==null&&o!==void 0?o:100*C,emHeightDescent:(u=_.emHeightDescent)!==null&&u!==void 0?u:-20*C,fontBoundingBoxAscent:(f=_.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*C,fontBoundingBoxDescent:(d=_.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*C,hangingBaseline:(p=_.hangingBaseline)!==null&&p!==void 0?p:72.80000305175781*C,ideographicBaseline:(g=_.ideographicBaseline)!==null&&g!==void 0?g:-21*C,width:_.width,height:m}}_getContextFont(){return this.fontStyle()+Xf+this.fontVariant()+Xf+(this.fontSize()+zD)+$D(this.fontFamily())}_addTextLine(t){this.align()===Xc&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const r=this.letterSpacing(),n=t.length;return Cg().measureText(t).width+r*n}_setTextData(){let t=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==ml&&a!==void 0,u=s!==ml&&s!==void 0,f=this.padding(),d=a-f*2,p=s-f*2,g=0,v=this.wrap(),m=v!==Z3,_=v!==HD&&m,C=this.ellipsis();this.textArr=[],Cg().font=this._getContextFont();const S=C?this._getTextWidth(Eg):0;for(let w=0,x=t.length;w<x;++w){let T=t[w],A=this._getTextWidth(T);if(o&&A>d)for(;T.length>0;){let N=0,R=fo(T).length,P="",I=0;for(;N<R;){const b=N+R>>>1,M=fo(T),D=M.slice(0,b+1).join(""),Q=this._getTextWidth(D);(C&&u&&g+i>p?Q+S:Q)<=d?(N=b+1,P=D,I=Q):R=b}if(P){if(_){const D=fo(T),Q=fo(P),he=D[Q.length],z=he===Xf||he===Q3;let Z;if(z&&I<=d)Z=Q.length;else{const ae=Q.lastIndexOf(Xf),ne=Q.lastIndexOf(Q3);Z=Math.max(ae,ne)+1}Z>0&&(N=Z,P=D.slice(0,N).join(""),I=this._getTextWidth(P))}if(P=P.trimRight(),this._addTextLine(P),n=Math.max(n,I),g+=i,this._shouldHandleEllipsis(g)){this._tryToAddEllipsisToLastLine();break}if(T=fo(T).slice(N).join("").trimLeft(),T.length>0&&(A=this._getTextWidth(T),A<=d)){this._addTextLine(T),g+=i,n=Math.max(n,A);break}}else break}else this._addTextLine(T),g+=i,n=Math.max(n,A),this._shouldHandleEllipsis(g)&&w<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&g+i>p)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(t){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==ml&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==Z3)||a&&t+n>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,r=t!==ml&&t!==void 0,n=this.padding(),i=t-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+Eg)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+Eg))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return t&&r?!0:super._useBufferCanvas()}};mc.Text=hr;hr.prototype._fillFunc=XD;hr.prototype._strokeFunc=KD;hr.prototype.className=BD;hr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,bD._registerNode)(hr);wn.Factory.overWriteSetter(hr,"width",(0,Xs.getNumberOrAutoValidator)());wn.Factory.overWriteSetter(hr,"height",(0,Xs.getNumberOrAutoValidator)());wn.Factory.addGetterSetter(hr,"direction",Jw);wn.Factory.addGetterSetter(hr,"fontFamily","Arial");wn.Factory.addGetterSetter(hr,"fontSize",12,(0,Xs.getNumberValidator)());wn.Factory.addGetterSetter(hr,"fontStyle",e8);wn.Factory.addGetterSetter(hr,"fontVariant",e8);wn.Factory.addGetterSetter(hr,"padding",0,(0,Xs.getNumberValidator)());wn.Factory.addGetterSetter(hr,"align",Zw);wn.Factory.addGetterSetter(hr,"verticalAlign",jD);wn.Factory.addGetterSetter(hr,"lineHeight",1,(0,Xs.getNumberValidator)());wn.Factory.addGetterSetter(hr,"wrap",GD);wn.Factory.addGetterSetter(hr,"ellipsis",!1,(0,Xs.getBooleanValidator)());wn.Factory.addGetterSetter(hr,"letterSpacing",0,(0,Xs.getNumberValidator)());wn.Factory.addGetterSetter(hr,"text","",(0,Xs.getStringValidator)());wn.Factory.addGetterSetter(hr,"textDecoration","");var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.TextPath=void 0;const Tg=or,Zi=yt,QD=Or,Kc=pc,Ag=mc,r8=at,qD=gt,JD="",n8="normal";function i8(e){e.fillText(this.partialText,0,0)}function a8(e){e.strokeText(this.partialText,0,0)}class Dr extends QD.Shape{constructor(t){super(t),this.dummyCanvas=Tg.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Kc.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const r=this.pathLength;return t-1>r?null:Kc.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Kc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&t.beginPath();for(let s=0;s<a.length;s++){t.save();const o=a[s].p0;t.translate(o.x,o.y),t.rotate(a[s].rotation),this.partialText=a[s].text,t.fillStrokeShape(this),r==="underline"&&(s===0&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}r==="underline"&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Tg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Ag.Text.prototype.setText.call(this,t)}_getContextFont(){return Ag.Text.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const u=(0,Ag.stringToArray)(this.text());let f=o;for(let d=0;d<u.length;d++){const p=this._getPointAtLength(f);if(!p)return;let g=this._getTextSize(u[d]).width+n;if(u[d]===" "&&i==="justify"){const w=this.text().split(" ").length-1;g+=(this.pathLength-s)/w}const v=this._getPointAtLength(f+g);if(!v)return;const m=Kc.Path.getLineLength(p.x,p.y,v.x,v.y);let _=0;if(a)try{_=a(u[d-1],u[d])*this.fontSize()}catch{_=0}p.x+=_,v.x+=_,this.textWidth+=_;const C=Kc.Path.getPointOnLine(_+m/2,p.x,p.y,v.x,v.y),S=Math.atan2(v.y-p.y,v.x-p.x);this.glyphInfo.push({transposeX:C.x,transposeY:C.y,text:u[d],rotation:S,p0:p,p1:v}),f+=g}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(f){t.push(f.p0.x),t.push(f.p0.y),t.push(f.p1.x),t.push(f.p1.y)});let r=t[0]||0,n=t[0]||0,i=t[1]||0,a=t[1]||0,s,o;for(let f=0;f<t.length/2;f++)s=t[f*2],o=t[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const u=this.fontSize();return{x:r-u/2,y:i-u/2,width:n-r+u,height:a-i+u}}destroy(){return Tg.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Xh.TextPath=Dr;Dr.prototype._fillFunc=i8;Dr.prototype._strokeFunc=a8;Dr.prototype._fillFuncHit=i8;Dr.prototype._strokeFuncHit=a8;Dr.prototype.className="TextPath";Dr.prototype._attrsAffectingSize=["text","fontSize","data"];(0,qD._registerNode)(Dr);Zi.Factory.addGetterSetter(Dr,"data");Zi.Factory.addGetterSetter(Dr,"fontFamily","Arial");Zi.Factory.addGetterSetter(Dr,"fontSize",12,(0,r8.getNumberValidator)());Zi.Factory.addGetterSetter(Dr,"fontStyle",n8);Zi.Factory.addGetterSetter(Dr,"align","left");Zi.Factory.addGetterSetter(Dr,"letterSpacing",0,(0,r8.getNumberValidator)());Zi.Factory.addGetterSetter(Dr,"textBaseline","middle");Zi.Factory.addGetterSetter(Dr,"fontVariant",n8);Zi.Factory.addGetterSetter(Dr,"text",JD);Zi.Factory.addGetterSetter(Dr,"textDecoration","");Zi.Factory.addGetterSetter(Dr,"kerningFunc",void 0);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Transformer=void 0;const zt=or,Dt=yt,e5=tr,ZD=Or,eL=wu,t5=dc,Ui=gt,Ks=at,tL=gt,s8="tr-konva",rL=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${s8}`).join(" "),r5="nodesRect",nL=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],iL={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},aL="ontouchstart"in Ui.Konva._global;function sL(e,t,r){if(e==="rotater")return r;t+=zt.Util.degToRad(iL[e]||0);const n=(zt.Util.radToDeg(t)%360+360)%360;return zt.Util._inRange(n,315+22.5,360)||zt.Util._inRange(n,0,22.5)?"ns-resize":zt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":zt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":zt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":zt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":zt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":zt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":zt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(zt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Jd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],n5=1e8;function oL(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function o8(e,t,r){const n=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),i=r.y+(e.x-r.x)*Math.sin(t)+(e.y-r.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:n,y:i}}function lL(e,t){const r=oL(e);return o8(e,t,r)}function cL(e,t,r){let n=t;for(let i=0;i<e.length;i++){const a=Ui.Konva.getAngle(e[i]),s=Math.abs(a-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let Xm=0;class Et extends t5.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(rL,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return zt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return s8+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const r=t.filter(i=>i.isAncestorOf(this)?(zt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=r,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on(nL.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let r;t.on(`dragstart.${this._getEventNamespace()}`,n=>{r=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=t.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const u=o.getAbsolutePosition();o.setAbsolutePosition({x:u.x+a,y:u.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(r5),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(r5,this.__getNodeRect)}__getNodeShape(t,r=this.rotation(),n){const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),o=i.x*a.x-t.offsetX()*a.x,u=i.y*a.y-t.offsetY()*a.y,f=(Ui.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+o*Math.cos(f)+u*Math.sin(-f),y:s.y+u*Math.cos(f)+o*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return o8(d,-Ui.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-n5,y:-n5,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),p=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],g=f.getAbsoluteTransform();p.forEach(function(v){const m=g.point(v);r.push(m)})});const n=new zt.Transform;n.rotate(-Ui.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),n.invert();const u=n.point({x:i,y:a});return{x:u.x,y:u.y,width:s-i,height:o-a,rotation:Ui.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Jd.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const r=new eL.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:aL?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=Ui.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=sL(t,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const t=new ZD.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*zt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",r=>{r.cancelBubble=!0}),t.on("dragmove",r=>{r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},Xm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:t.evt,target:u})})}_handleMouseMove(t){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let u={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,t)),a.setAbsolutePosition(u);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const w=this._getNodeRect();r=a.x()-w.width/2,n=-a.y()+w.height/2;let x=Math.atan2(-n,r)+Math.PI/2;w.height<0&&(x-=Math.PI);const A=Ui.Konva.getAngle(this.rotation())+x,N=Ui.Konva.getAngle(this.rotationSnapTolerance()),P=cL(this.rotationSnaps(),A,N)-w.rotation,I=lL(w,P);this._fitNodesInto(I,t);return}const p=this.shiftBehavior();let g;p==="inverted"?g=this.keepRatio()&&!t.shiftKey:p==="none"?g=this.keepRatio():g=this.keepRatio()||t.shiftKey;let v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-left").x()>w.x?-1:1,T=this.findOne(".top-left").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-left").x(w.x-r),this.findOne(".top-left").y(w.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-right").x()<w.x?-1:1,T=this.findOne(".top-right").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-right").x(w.x+r),this.findOne(".top-right").y(w.y-n)}var m=a.position();this.findOne(".top-left").y(m.y),this.findOne(".bottom-right").x(m.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(a.y()-w.y,2));const x=w.x<a.x()?-1:1,T=a.y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,a.x(w.x-r),a.y(w.y+n)}m=a.position(),this.findOne(".top-left").x(m.x),this.findOne(".bottom-right").y(m.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(a.y()-w.y,2));const x=this.findOne(".bottom-right").x()<w.x?-1:1,T=this.findOne(".bottom-right").y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".bottom-right").x(w.x+r),this.findOne(".bottom-right").y(w.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(v=this.centeredScaling()||t.altKey,v){const w=this.findOne(".top-left"),x=this.findOne(".bottom-right"),T=w.x(),A=w.y(),N=this.getWidth()-x.x(),R=this.getHeight()-x.y();x.move({x:-T,y:-A}),w.move({x:N,y:R})}const _=this.findOne(".top-left").getAbsolutePosition();r=_.x,n=_.y;const C=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:C,height:S,rotation:Ui.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Xm--,this._fire("transformend",{evt:t,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:t,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,r){const n=this._getNodeRect(),i=1;if(zt.Util._inRange(t.width,-this.padding()*2-i,i)){this.update();return}if(zt.Util._inRange(t.height,-this.padding()*2-i,i)){this.update();return}const a=new zt.Transform;if(a.rotate(Ui.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const g=a.point({x:-this.padding()*2,y:0});t.x+=g.x,t.y+=g.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const g=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const g=a.point({x:0,y:-this.padding()*2});t.x+=g.x,t.y+=g.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const g=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const g=this.boundBoxFunc()(n,t);g?t=g:zt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new zt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const u=new zt.Transform,f=t.width/s,d=t.height/s;this.flipEnabled()===!1?(u.translate(t.x,t.y),u.rotate(t.rotation),u.translate(t.width<0?t.width:0,t.height<0?t.height:0),u.scale(Math.abs(f),Math.abs(d))):(u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(f,d));const p=u.multiply(o.invert());this._nodes.forEach(g=>{var v;const m=g.getParent().getAbsoluteTransform(),_=g.getTransform().copy();_.translate(g.offsetX(),g.offsetY());const C=new zt.Transform;C.multiply(m.copy().invert()).multiply(p).multiply(m).multiply(_);const S=C.decompose();g.setAttrs(S),(v=g.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(zt.Util._getRotation(t.rotation)),this._nodes.forEach(g=>{this._fire("transform",{evt:r,target:g}),g._fire("transform",{evt:r,target:g})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,r){this.findOne(t).setAttrs(r)}update(){var t;const r=this._getNodeRect();this.rotation(zt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(p=>{p.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+o,offsetY:u/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-o,offsetY:u/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*zt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(p=>{d(p)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),t5.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return e5.Node.prototype.toObject.call(this)}clone(t){return e5.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Kh.Transformer=Et;Et.isTransforming=()=>Xm>0;function uL(e){return e instanceof Array||zt.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Jd.indexOf(t)===-1&&zt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Jd.join(", "))}),e||[]}Et.prototype.className="Transformer";(0,tL._registerNode)(Et);Dt.Factory.addGetterSetter(Et,"enabledAnchors",Jd,uL);Dt.Factory.addGetterSetter(Et,"flipEnabled",!0,(0,Ks.getBooleanValidator)());Dt.Factory.addGetterSetter(Et,"resizeEnabled",!0);Dt.Factory.addGetterSetter(Et,"anchorSize",10,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"rotateEnabled",!0);Dt.Factory.addGetterSetter(Et,"rotateLineVisible",!0);Dt.Factory.addGetterSetter(Et,"rotationSnaps",[]);Dt.Factory.addGetterSetter(Et,"rotateAnchorOffset",50,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"rotateAnchorCursor","crosshair");Dt.Factory.addGetterSetter(Et,"rotationSnapTolerance",5,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"borderEnabled",!0);Dt.Factory.addGetterSetter(Et,"anchorStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Et,"anchorStrokeWidth",1,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"anchorFill","white");Dt.Factory.addGetterSetter(Et,"anchorCornerRadius",0,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"borderStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Et,"borderStrokeWidth",1,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"borderDash");Dt.Factory.addGetterSetter(Et,"keepRatio",!0);Dt.Factory.addGetterSetter(Et,"shiftBehavior","default");Dt.Factory.addGetterSetter(Et,"centeredScaling",!1);Dt.Factory.addGetterSetter(Et,"ignoreStroke",!1);Dt.Factory.addGetterSetter(Et,"padding",0,(0,Ks.getNumberValidator)());Dt.Factory.addGetterSetter(Et,"nodes");Dt.Factory.addGetterSetter(Et,"node");Dt.Factory.addGetterSetter(Et,"boundBoxFunc");Dt.Factory.addGetterSetter(Et,"anchorDragBoundFunc");Dt.Factory.addGetterSetter(Et,"anchorStyleFunc");Dt.Factory.addGetterSetter(Et,"shouldOverdrawWholeArea",!1);Dt.Factory.addGetterSetter(Et,"useSingleNodeRotation",!0);Dt.Factory.backCompat(Et,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Wedge=void 0;const Qh=yt,fL=Or,dL=gt,l8=at,hL=gt;class Za extends fL.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,dL.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Yh.Wedge=Za;Za.prototype.className="Wedge";Za.prototype._centroid=!0;Za.prototype._attrsAffectingSize=["radius"];(0,hL._registerNode)(Za);Qh.Factory.addGetterSetter(Za,"radius",0,(0,l8.getNumberValidator)());Qh.Factory.addGetterSetter(Za,"angle",0,(0,l8.getNumberValidator)());Qh.Factory.addGetterSetter(Za,"clockwise",!1);Qh.Factory.backCompat(Za,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var qh={};Object.defineProperty(qh,"__esModule",{value:!0});qh.Blur=void 0;const i5=yt,pL=tr,gL=at;function a5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const mL=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],xL=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function vL(e,t){const r=e.data,n=e.width,i=e.height;let a,s,o,u,f,d,p,g,v,m,_,C,S,w,x,T,A,N,R,P;const I=t+t+1,b=n-1,M=i-1,D=t+1,Q=D*(D+1)/2,he=new a5,z=mL[t],Z=xL[t];let ae=null,ne=he,K=null,ce=null;for(let me=1;me<I;me++)ne=ne.next=new a5,me===D&&(ae=ne);ne.next=he,o=s=0;for(let me=0;me<i;me++){C=S=w=x=u=f=d=p=0,g=D*(T=r[s]),v=D*(A=r[s+1]),m=D*(N=r[s+2]),_=D*(R=r[s+3]),u+=Q*T,f+=Q*A,d+=Q*N,p+=Q*R,ne=he;for(let L=0;L<D;L++)ne.r=T,ne.g=A,ne.b=N,ne.a=R,ne=ne.next;for(let L=1;L<D;L++)a=s+((b<L?b:L)<<2),u+=(ne.r=T=r[a])*(P=D-L),f+=(ne.g=A=r[a+1])*P,d+=(ne.b=N=r[a+2])*P,p+=(ne.a=R=r[a+3])*P,C+=T,S+=A,w+=N,x+=R,ne=ne.next;K=he,ce=ae;for(let L=0;L<n;L++)r[s+3]=R=p*z>>Z,R!==0?(R=255/R,r[s]=(u*z>>Z)*R,r[s+1]=(f*z>>Z)*R,r[s+2]=(d*z>>Z)*R):r[s]=r[s+1]=r[s+2]=0,u-=g,f-=v,d-=m,p-=_,g-=K.r,v-=K.g,m-=K.b,_-=K.a,a=o+((a=L+t+1)<b?a:b)<<2,C+=K.r=r[a],S+=K.g=r[a+1],w+=K.b=r[a+2],x+=K.a=r[a+3],u+=C,f+=S,d+=w,p+=x,K=K.next,g+=T=ce.r,v+=A=ce.g,m+=N=ce.b,_+=R=ce.a,C-=T,S-=A,w-=N,x-=R,ce=ce.next,s+=4;o+=n}for(let me=0;me<n;me++){S=w=x=C=f=d=p=u=0,s=me<<2,g=D*(T=r[s]),v=D*(A=r[s+1]),m=D*(N=r[s+2]),_=D*(R=r[s+3]),u+=Q*T,f+=Q*A,d+=Q*N,p+=Q*R,ne=he;for(let ee=0;ee<D;ee++)ne.r=T,ne.g=A,ne.b=N,ne.a=R,ne=ne.next;let L=n;for(let ee=1;ee<=t;ee++)s=L+me<<2,u+=(ne.r=T=r[s])*(P=D-ee),f+=(ne.g=A=r[s+1])*P,d+=(ne.b=N=r[s+2])*P,p+=(ne.a=R=r[s+3])*P,C+=T,S+=A,w+=N,x+=R,ne=ne.next,ee<M&&(L+=n);s=me,K=he,ce=ae;for(let ee=0;ee<i;ee++)a=s<<2,r[a+3]=R=p*z>>Z,R>0?(R=255/R,r[a]=(u*z>>Z)*R,r[a+1]=(f*z>>Z)*R,r[a+2]=(d*z>>Z)*R):r[a]=r[a+1]=r[a+2]=0,u-=g,f-=v,d-=m,p-=_,g-=K.r,v-=K.g,m-=K.b,_-=K.a,a=me+((a=ee+D)<M?a:M)*n<<2,u+=C+=K.r=r[a],f+=S+=K.g=r[a+1],d+=w+=K.b=r[a+2],p+=x+=K.a=r[a+3],K=K.next,g+=T=ce.r,v+=A=ce.g,m+=N=ce.b,_+=R=ce.a,C-=T,S-=A,w-=N,x-=R,ce=ce.next,s+=n}}const yL=function(t){const r=Math.round(this.blurRadius());r>0&&vL(t,r)};qh.Blur=yL;i5.Factory.addGetterSetter(pL.Node,"blurRadius",0,(0,gL.getNumberValidator)(),i5.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Brighten=void 0;const s5=yt,_L=tr,SL=at,wL=function(e){const t=this.brightness()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=t,r[i+1]+=t,r[i+2]+=t};Jh.Brighten=wL;s5.Factory.addGetterSetter(_L.Node,"brightness",0,(0,SL.getNumberValidator)(),s5.Factory.afterSetFilter);var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.Contrast=void 0;const o5=yt,kL=tr,EL=at,CL=function(e){const t=Math.pow((this.contrast()+100)/100,2),r=e.data,n=r.length;let i=150,a=150,s=150;for(let o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};Zh.Contrast=CL;o5.Factory.addGetterSetter(kL.Node,"contrast",0,(0,EL.getNumberValidator)(),o5.Factory.afterSetFilter);var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.Emboss=void 0;const Bs=yt,t1=tr,TL=or,c8=at,AL=function(e){const t=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=e.data,s=e.width,o=e.height,u=s*4;let f=0,d=0,p=o;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:TL.Util.error("Unknown emboss direction: "+n)}do{const g=(p-1)*u;let v=f;p+v<1&&(v=0),p+v>o&&(v=0);const m=(p-1+v)*s*4;let _=s;do{const C=g+(_-1)*4;let S=d;_+S<1&&(S=0),_+S>s&&(S=0);const w=m+(_-1+S)*4,x=a[C]-a[w],T=a[C+1]-a[w+1],A=a[C+2]-a[w+2];let N=x;const R=N>0?N:-N,P=T>0?T:-T,I=A>0?A:-A;if(P>R&&(N=T),I>R&&(N=A),N*=t,i){const b=a[C]+N,M=a[C+1]+N,D=a[C+2]+N;a[C]=b>255?255:b<0?0:b,a[C+1]=M>255?255:M<0?0:M,a[C+2]=D>255?255:D<0?0:D}else{let b=r-N;b<0?b=0:b>255&&(b=255),a[C]=a[C+1]=a[C+2]=b}}while(--_)}while(--p)};e1.Emboss=AL;Bs.Factory.addGetterSetter(t1.Node,"embossStrength",.5,(0,c8.getNumberValidator)(),Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(t1.Node,"embossWhiteLevel",.5,(0,c8.getNumberValidator)(),Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(t1.Node,"embossDirection","top-left",void 0,Bs.Factory.afterSetFilter);Bs.Factory.addGetterSetter(t1.Node,"embossBlend",!1,void 0,Bs.Factory.afterSetFilter);var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Enhance=void 0;const l5=yt,PL=tr,FL=at;function Pg(e,t,r,n,i){const a=r-t,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let o=(e-t)/a;return o=s*o+n,o}const NL=function(e){const t=e.data,r=t.length;let n=t[0],i=n,a,s=t[1],o=s,u,f=t[2],d=f,p;const g=this.enhance();if(g===0)return;for(let x=0;x<r;x+=4)a=t[x+0],a<n?n=a:a>i&&(i=a),u=t[x+1],u<s?s=u:u>o&&(o=u),p=t[x+2],p<f?f=p:p>d&&(d=p);i===n&&(i=255,n=0),o===s&&(o=255,s=0),d===f&&(d=255,f=0);let v,m,_,C,S,w;if(g>0)v=i+g*(255-i),m=n-g*(n-0),_=o+g*(255-o),C=s-g*(s-0),S=d+g*(255-d),w=f-g*(f-0);else{const x=(i+n)*.5;v=i+g*(i-x),m=n+g*(n-x);const T=(o+s)*.5;_=o+g*(o-T),C=s+g*(s-T);const A=(d+f)*.5;S=d+g*(d-A),w=f+g*(f-A)}for(let x=0;x<r;x+=4)t[x+0]=Pg(t[x+0],n,i,m,v),t[x+1]=Pg(t[x+1],s,o,C,_),t[x+2]=Pg(t[x+2],f,d,w,S)};r1.Enhance=NL;l5.Factory.addGetterSetter(PL.Node,"enhance",0,(0,FL.getNumberValidator)(),l5.Factory.afterSetFilter);var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Grayscale=void 0;const RL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=i,t[n+1]=i,t[n+2]=i}};n1.Grayscale=RL;var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.HSL=void 0;const rc=yt,Fx=tr,Nx=at;rc.Factory.addGetterSetter(Fx.Node,"hue",0,(0,Nx.getNumberValidator)(),rc.Factory.afterSetFilter);rc.Factory.addGetterSetter(Fx.Node,"saturation",0,(0,Nx.getNumberValidator)(),rc.Factory.afterSetFilter);rc.Factory.addGetterSetter(Fx.Node,"luminance",0,(0,Nx.getNumberValidator)(),rc.Factory.afterSetFilter);const IL=function(e){const t=e.data,r=t.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*o+.167*u,d=.587*n-.587*o+.33*u,p=.114*n-.114*o-.497*u,g=.299*n-.299*o-.328*u,v=.587*n+.413*o+.035*u,m=.114*n-.114*o+.293*u,_=.299*n-.3*o+1.25*u,C=.587*n-.586*o-1.05*u,S=.114*n+.886*o-.2*u;let w,x,T,A;for(let N=0;N<r;N+=4)w=t[N+0],x=t[N+1],T=t[N+2],A=t[N+3],t[N+0]=f*w+d*x+p*T+s,t[N+1]=g*w+v*x+m*T+s,t[N+2]=_*w+C*x+S*T+s,t[N+3]=A};i1.HSL=IL;var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.HSV=void 0;const nc=yt,Rx=tr,Ix=at,bL=function(e){const t=e.data,r=t.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*s+.167*o,f=.587*n-.587*s+.33*o,d=.114*n-.114*s-.497*o,p=.299*n-.299*s-.328*o,g=.587*n+.413*s+.035*o,v=.114*n-.114*s+.293*o,m=.299*n-.3*s+1.25*o,_=.587*n-.586*s-1.05*o,C=.114*n+.886*s-.2*o;for(let S=0;S<r;S+=4){const w=t[S+0],x=t[S+1],T=t[S+2],A=t[S+3];t[S+0]=u*w+f*x+d*T,t[S+1]=p*w+g*x+v*T,t[S+2]=m*w+_*x+C*T,t[S+3]=A}};a1.HSV=bL;nc.Factory.addGetterSetter(Rx.Node,"hue",0,(0,Ix.getNumberValidator)(),nc.Factory.afterSetFilter);nc.Factory.addGetterSetter(Rx.Node,"saturation",0,(0,Ix.getNumberValidator)(),nc.Factory.afterSetFilter);nc.Factory.addGetterSetter(Rx.Node,"value",0,(0,Ix.getNumberValidator)(),nc.Factory.afterSetFilter);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.Invert=void 0;const OL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};s1.Invert=OL;var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.Kaleidoscope=void 0;const Zd=yt,u8=tr,c5=or,f8=at,DL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,_=360/m*Math.PI/180;for(let C=0;C<m;C+=1){const S=Math.sin(C*_),w=Math.cos(C*_);for(let x=0;x<v;x+=1){d=Math.floor(o+f*x/v*w),p=Math.floor(u+f*x/v*S);let T=(p*a+d)*4;const A=n[T+0],N=n[T+1],R=n[T+2],P=n[T+3];T=(C+x*a)*4,i[T+0]=A,i[T+1]=N,i[T+2]=R,i[T+3]=P}}},LL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,_=r.polarRotation||0;let C,S;for(d=0;d<a;d+=1)for(p=0;p<s;p+=1){const w=d-o,x=p-u,T=Math.sqrt(w*w+x*x)*v/f;let A=(Math.atan2(x,w)*180/Math.PI+360+_)%360;A=A*m/360,C=Math.floor(A),S=Math.floor(T);let N=(S*a+C)*4;const R=n[N+0],P=n[N+1],I=n[N+2],b=n[N+3];N=(p*a+d)*4,i[N+0]=R,i[N+1]=P,i[N+2]=I,i[N+3]=b}},ML=function(e){const t=e.width,r=e.height;let n,i,a,s,o,u,f,d,p,g,v=Math.round(this.kaleidoscopePower());const m=Math.round(this.kaleidoscopeAngle()),_=Math.floor(t*(m%360)/360);if(v<1)return;const C=c5.Util.createCanvasElement();C.width=t,C.height=r;const S=C.getContext("2d").getImageData(0,0,t,r);c5.Util.releaseCanvas(C),DL(e,S,{polarCenterX:t/2,polarCenterY:r/2});let w=t/Math.pow(2,v);for(;w<=8;)w=w*2,v-=1;w=Math.ceil(w);let x=w,T=0,A=x,N=1;for(_+w>t&&(T=x,A=0,N=-1),i=0;i<r;i+=1)for(n=T;n!==A;n+=N)a=Math.round(n+_)%t,p=(t*i+a)*4,o=S.data[p+0],u=S.data[p+1],f=S.data[p+2],d=S.data[p+3],g=(t*i+n)*4,S.data[g+0]=o,S.data[g+1]=u,S.data[g+2]=f,S.data[g+3]=d;for(i=0;i<r;i+=1)for(x=Math.floor(w),s=0;s<v;s+=1){for(n=0;n<x+1;n+=1)p=(t*i+n)*4,o=S.data[p+0],u=S.data[p+1],f=S.data[p+2],d=S.data[p+3],g=(t*i+x*2-n-1)*4,S.data[g+0]=o,S.data[g+1]=u,S.data[g+2]=f,S.data[g+3]=d;x*=2}LL(S,e,{polarRotation:0})};o1.Kaleidoscope=ML;Zd.Factory.addGetterSetter(u8.Node,"kaleidoscopePower",2,(0,f8.getNumberValidator)(),Zd.Factory.afterSetFilter);Zd.Factory.addGetterSetter(u8.Node,"kaleidoscopeAngle",0,(0,f8.getNumberValidator)(),Zd.Factory.afterSetFilter);var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.Mask=void 0;const u5=yt,BL=tr,jL=at;function Yf(e,t,r){let n=(r*e.width+t)*4;const i=[];return i.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),i}function Yc(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function UL(e){const t=[0,0,0];for(let r=0;r<e.length;r++)t[0]+=e[r][0],t[1]+=e[r][1],t[2]+=e[r][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function zL(e,t){const r=Yf(e,0,0),n=Yf(e,e.width-1,0),i=Yf(e,0,e.height-1),a=Yf(e,e.width-1,e.height-1),s=t||10;if(Yc(r,n)<s&&Yc(n,a)<s&&Yc(a,i)<s&&Yc(i,r)<s){const o=UL([n,r,a,i]),u=[];for(let f=0;f<e.width*e.height;f++){const d=Yc(o,[e.data[f*4],e.data[f*4+1],e.data[f*4+2]]);u[f]=d<s?0:255}return u}}function VL(e,t){for(let r=0;r<e.width*e.height;r++)e.data[4*r+3]=t[r]}function GL(e,t,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const _=v*t+m,C=n[p*i+g];d+=e[_]*C}}s[f]=d===255*8?255:0}return s}function HL(e,t,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const _=v*t+m,C=n[p*i+g];d+=e[_]*C}}s[f]=d>=255*4?255:0}return s}function WL(e,t,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const _=v*t+m,C=n[p*i+g];d+=e[_]*C}}s[f]=d}return s}const $L=function(e){const t=this.threshold();let r=zL(e,t);return r&&(r=GL(r,e.width,e.height),r=HL(r,e.width,e.height),r=WL(r,e.width,e.height),VL(e,r)),e};l1.Mask=$L;u5.Factory.addGetterSetter(BL.Node,"threshold",0,(0,jL.getNumberValidator)(),u5.Factory.afterSetFilter);var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.Noise=void 0;const f5=yt,XL=tr,KL=at,YL=function(e){const t=this.noise()*255,r=e.data,n=r.length,i=t/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};c1.Noise=YL;f5.Factory.addGetterSetter(XL.Node,"noise",.2,(0,KL.getNumberValidator)(),f5.Factory.afterSetFilter);var u1={};Object.defineProperty(u1,"__esModule",{value:!0});u1.Pixelate=void 0;const d5=yt,QL=or,qL=tr,JL=at,ZL=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,n=e.height,i=Math.ceil(r/t),a=Math.ceil(n/t),s=e.data;if(t<=0){QL.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let u=0;u<a;u+=1){let f=0,d=0,p=0,g=0;const v=o*t,m=v+t,_=u*t,C=_+t;let S=0;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=_;x<C;x+=1){if(x>=n)continue;const T=(r*x+w)*4;f+=s[T+0],d+=s[T+1],p+=s[T+2],g+=s[T+3],S+=1}f=f/S,d=d/S,p=p/S,g=g/S;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=_;x<C;x+=1){if(x>=n)continue;const T=(r*x+w)*4;s[T+0]=f,s[T+1]=d,s[T+2]=p,s[T+3]=g}}};u1.Pixelate=ZL;d5.Factory.addGetterSetter(qL.Node,"pixelSize",8,(0,JL.getNumberValidator)(),d5.Factory.afterSetFilter);var f1={};Object.defineProperty(f1,"__esModule",{value:!0});f1.Posterize=void 0;const h5=yt,eM=tr,tM=at,rM=function(e){const t=Math.round(this.levels()*254)+1,r=e.data,n=r.length,i=255/t;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};f1.Posterize=rM;h5.Factory.addGetterSetter(eM.Node,"levels",.5,(0,tM.getNumberValidator)(),h5.Factory.afterSetFilter);var d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.RGB=void 0;const eh=yt,bx=tr,nM=at,iM=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const o=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=o*n,t[s+1]=o*i,t[s+2]=o*a,t[s+3]=t[s+3]}};d1.RGB=iM;eh.Factory.addGetterSetter(bx.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});eh.Factory.addGetterSetter(bx.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});eh.Factory.addGetterSetter(bx.Node,"blue",0,nM.RGBComponent,eh.Factory.afterSetFilter);var h1={};Object.defineProperty(h1,"__esModule",{value:!0});h1.RGBA=void 0;const au=yt,p1=tr,aM=at,sM=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const u=1-s;t[o]=n*s+t[o]*u,t[o+1]=i*s+t[o+1]*u,t[o+2]=a*s+t[o+2]*u}};h1.RGBA=sM;au.Factory.addGetterSetter(p1.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});au.Factory.addGetterSetter(p1.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});au.Factory.addGetterSetter(p1.Node,"blue",0,aM.RGBComponent,au.Factory.afterSetFilter);au.Factory.addGetterSetter(p1.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var g1={};Object.defineProperty(g1,"__esModule",{value:!0});g1.Sepia=void 0;const oM=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=t[n+0],a=t[n+1],s=t[n+2];t[n+0]=Math.min(255,i*.393+a*.769+s*.189),t[n+1]=Math.min(255,i*.349+a*.686+s*.168),t[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};g1.Sepia=oM;var m1={};Object.defineProperty(m1,"__esModule",{value:!0});m1.Solarize=void 0;const lM=function(e){const t=e.data,r=e.width,n=e.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const u=s+(o-1)*4;let f=t[u],d=t[u+1],p=t[u+2];f>127&&(f=255-f),d>127&&(d=255-d),p>127&&(p=255-p),t[u]=f,t[u+1]=d,t[u+2]=p}while(--o)}while(--a)};m1.Solarize=lM;var x1={};Object.defineProperty(x1,"__esModule",{value:!0});x1.Threshold=void 0;const p5=yt,cM=tr,uM=at,fM=function(e){const t=this.threshold()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<t?0:255};x1.Threshold=fM;p5.Factory.addGetterSetter(cM.Node,"threshold",.5,(0,uM.getNumberValidator)(),p5.Factory.afterSetFilter);Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Konva=void 0;const g5=Qd,dM=Ih,hM=Dh,pM=Bh,gM=jh,mM=Uh,m5=tc,xM=_u,vM=pc,yM=wu,_M=Gh,SM=Hh,wM=Wh,kM=$h,EM=mc,CM=Xh,TM=Kh,AM=Yh,PM=qh,FM=Jh,NM=Zh,RM=e1,IM=r1,bM=n1,OM=i1,DM=a1,LM=s1,MM=o1,BM=l1,jM=c1,UM=u1,zM=f1,VM=d1,GM=h1,HM=g1,WM=m1,$M=x1;Ah.Konva=g5.Konva.Util._assign(g5.Konva,{Arc:dM.Arc,Arrow:hM.Arrow,Circle:pM.Circle,Ellipse:gM.Ellipse,Image:mM.Image,Label:m5.Label,Tag:m5.Tag,Line:xM.Line,Path:vM.Path,Rect:yM.Rect,RegularPolygon:_M.RegularPolygon,Ring:SM.Ring,Sprite:wM.Sprite,Star:kM.Star,Text:EM.Text,TextPath:CM.TextPath,Transformer:TM.Transformer,Wedge:AM.Wedge,Filters:{Blur:PM.Blur,Brighten:FM.Brighten,Contrast:NM.Contrast,Emboss:RM.Emboss,Enhance:IM.Enhance,Grayscale:bM.Grayscale,HSL:OM.HSL,HSV:DM.HSV,Invert:LM.Invert,Kaleidoscope:MM.Kaleidoscope,Mask:BM.Mask,Noise:jM.Noise,Pixelate:UM.Pixelate,Posterize:zM.Posterize,RGB:VM.RGB,RGBA:GM.RGBA,Sepia:HM.Sepia,Solarize:WM.Solarize,Threshold:$M.Threshold}});var XM=Iw.exports;Object.defineProperty(XM,"__esModule",{value:!0});const KM=Ah;Iw.exports=KM.Konva;var Km={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=Qd;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Qd;e.exports=n.Konva})(Km,Km.exports);var YM=Km.exports;const su=th(YM);var d8={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QM=function(t){var r={},n=ke,i=c0,a=Object.assign;function s(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),m=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),A=Symbol.iterator;function N(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}function R(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case g:return"Profiler";case p:return"StrictMode";case C:return"Suspense";case S:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case m:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case _:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case w:return c=l.displayName||null,c!==null?c:R(l.type)||"Memo";case x:c=l._payload,l=l._init;try{return R(l(c))}catch{}}return null}function P(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(c);case 8:return c===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function I(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function b(l){if(I(l)!==l)throw Error(s(188))}function M(l){var c=l.alternate;if(!c){if(c=I(l),c===null)throw Error(s(188));return c!==l?null:l}for(var h=l,y=c;;){var E=h.return;if(E===null)break;var F=E.alternate;if(F===null){if(y=E.return,y!==null){h=y;continue}break}if(E.child===F.child){for(F=E.child;F;){if(F===h)return b(E),l;if(F===y)return b(E),c;F=F.sibling}throw Error(s(188))}if(h.return!==y.return)h=E,y=F;else{for(var j=!1,te=E.child;te;){if(te===h){j=!0,h=E,y=F;break}if(te===y){j=!0,y=E,h=F;break}te=te.sibling}if(!j){for(te=F.child;te;){if(te===h){j=!0,h=F,y=E;break}if(te===y){j=!0,y=F,h=E;break}te=te.sibling}if(!j)throw Error(s(189))}}if(h.alternate!==y)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?l:c}function D(l){return l=M(l),l!==null?Q(l):null}function Q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Q(l);if(c!==null)return c;l=l.sibling}return null}function he(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=he(l);if(c!==null)return c}l=l.sibling}return null}var z=Array.isArray,Z=t.getPublicInstance,ae=t.getRootHostContext,ne=t.getChildHostContext,K=t.prepareForCommit,ce=t.resetAfterCommit,me=t.createInstance,L=t.appendInitialChild,ee=t.finalizeInitialChildren,q=t.prepareUpdate,Y=t.shouldSetTextContent,de=t.createTextInstance,V=t.scheduleTimeout,ie=t.cancelTimeout,ge=t.noTimeout,_e=t.isPrimaryRenderer,Me=t.supportsMutation,H=t.supportsPersistence,tt=t.supportsHydration,nt=t.getInstanceFromNode,Xe=t.preparePortalMount,Ze=t.getCurrentEventPriority,be=t.detachDeletedInstance,Ct=t.supportsMicrotasks,Lr=t.scheduleMicrotask,ye=t.supportsTestSelectors,xe=t.findFiberRoot,Te=t.getBoundingRect,Ae=t.getTextContent,Pe=t.isHiddenSubtree,Oe=t.matchAccessibilityRole,Ve=t.setFocusIfFocusable,Se=t.setupIntersectionObserver,J=t.appendChild,Ee=t.appendChildToContainer,Fe=t.commitTextUpdate,Ce=t.commitMount,Qe=t.commitUpdate,et=t.insertBefore,lt=t.insertInContainerBefore,Ye=t.removeChild,xt=t.removeChildFromContainer,si=t.resetTextContent,Ie=t.hideInstance,qe=t.hideTextInstance,Ge=t.unhideInstance,Je=t.unhideTextInstance,ut=t.clearContainer,Pt=t.cloneInstance,Ot=t.createContainerChildSet,kn=t.appendChildToContainerChildSet,tn=t.finalizeContainerChildren,mt=t.replaceContainerChildren,rn=t.cloneHiddenInstance,lr=t.cloneHiddenTextInstance,Yo=t.canHydrateInstance,Qo=t.canHydrateTextInstance,xc=t.canHydrateSuspenseInstance,ku=t.isSuspenseInstancePending,vc=t.isSuspenseInstanceFallback,y1=t.getSuspenseInstanceFallbackErrorDetails,O=t.registerSuspenseInstanceRetry,G=t.getNextHydratableSibling,B=t.getFirstHydratableChild,U=t.getFirstHydratableChildWithinContainer,W=t.getFirstHydratableChildWithinSuspenseInstance,X=t.hydrateInstance,oe=t.hydrateTextInstance,we=t.hydrateSuspenseInstance,se=t.getNextHydratableInstanceAfterSuspenseInstance,le=t.commitHydratedContainer,ue=t.commitHydratedSuspenseInstance,Ne=t.clearSuspenseBoundary,Be=t.clearSuspenseBoundaryFromContainer,He=t.shouldDeleteUnhydratedTailInstances,De=t.didNotMatchHydratedContainerTextInstance,je=t.didNotMatchHydratedTextInstance,st;function Mt(l){if(st===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);st=c&&c[1]||""}return`
`+st+l}var Vt=!1;function vr(l,c){if(!l||Vt)return"";Vt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Le){var y=Le}Reflect.construct(l,[],c)}else{try{c.call()}catch(Le){y=Le}l.call(c.prototype)}else{try{throw Error()}catch(Le){y=Le}l()}}catch(Le){if(Le&&y&&typeof Le.stack=="string"){for(var E=Le.stack.split(`
`),F=y.stack.split(`
`),j=E.length-1,te=F.length-1;1<=j&&0<=te&&E[j]!==F[te];)te--;for(;1<=j&&0<=te;j--,te--)if(E[j]!==F[te]){if(j!==1||te!==1)do if(j--,te--,0>te||E[j]!==F[te]){var pe=`
`+E[j].replace(" at new "," at ");return l.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",l.displayName)),pe}while(1<=j&&0<=te);break}}}finally{Vt=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?Mt(l):""}var Qs=Object.prototype.hasOwnProperty,Sa=[],oi=-1;function nn(l){return{current:l}}function Bt(l){0>oi||(l.current=Sa[oi],Sa[oi]=null,oi--)}function St(l,c){oi++,Sa[oi]=l.current,l.current=c}var es={},an=nn(es),Dn=nn(!1),qs=es;function qo(l,c){var h=l.type.contextTypes;if(!h)return es;var y=l.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var E={},F;for(F in h)E[F]=c[F];return y&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=E),E}function Ln(l){return l=l.childContextTypes,l!=null}function Eu(){Bt(Dn),Bt(an)}function Lx(l,c,h){if(an.current!==es)throw Error(s(168));St(an,c),St(Dn,h)}function Mx(l,c,h){var y=l.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return h;y=y.getChildContext();for(var E in y)if(!(E in c))throw Error(s(108,P(l)||"Unknown",E));return a({},h,y)}function Cu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||es,qs=an.current,St(an,l),St(Dn,Dn.current),!0}function Bx(l,c,h){var y=l.stateNode;if(!y)throw Error(s(169));h?(l=Mx(l,c,qs),y.__reactInternalMemoizedMergedChildContext=l,Bt(Dn),Bt(an),St(an,l)):Bt(Dn),St(Dn,h)}var Ri=Math.clz32?Math.clz32:w8,_8=Math.log,S8=Math.LN2;function w8(l){return l>>>=0,l===0?32:31-(_8(l)/S8|0)|0}var Tu=64,Au=4194304;function yc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Pu(l,c){var h=l.pendingLanes;if(h===0)return 0;var y=0,E=l.suspendedLanes,F=l.pingedLanes,j=h&268435455;if(j!==0){var te=j&~E;te!==0?y=yc(te):(F&=j,F!==0&&(y=yc(F)))}else j=h&~E,j!==0?y=yc(j):F!==0&&(y=yc(F));if(y===0)return 0;if(c!==0&&c!==y&&!(c&E)&&(E=y&-y,F=c&-c,E>=F||E===16&&(F&4194240)!==0))return c;if(y&4&&(y|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=y;0<c;)h=31-Ri(c),E=1<<h,y|=l[h],c&=~E;return y}function k8(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E8(l,c){for(var h=l.suspendedLanes,y=l.pingedLanes,E=l.expirationTimes,F=l.pendingLanes;0<F;){var j=31-Ri(F),te=1<<j,pe=E[j];pe===-1?(!(te&h)||te&y)&&(E[j]=k8(te,c)):pe<=c&&(l.expiredLanes|=te),F&=~te}}function _1(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function jx(){var l=Tu;return Tu<<=1,!(Tu&4194240)&&(Tu=64),l}function S1(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function _c(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Ri(c),l[c]=h}function C8(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var y=l.eventTimes;for(l=l.expirationTimes;0<h;){var E=31-Ri(h),F=1<<E;c[E]=0,y[E]=-1,l[E]=-1,h&=~F}}function w1(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var y=31-Ri(h),E=1<<y;E&c|l[y]&c&&(l[y]|=c),h&=~E}}var Rt=0;function Ux(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var k1=i.unstable_scheduleCallback,zx=i.unstable_cancelCallback,T8=i.unstable_shouldYield,A8=i.unstable_requestPaint,Mr=i.unstable_now,E1=i.unstable_ImmediatePriority,P8=i.unstable_UserBlockingPriority,C1=i.unstable_NormalPriority,F8=i.unstable_IdlePriority,Fu=null,ea=null;function N8(l){if(ea&&typeof ea.onCommitFiberRoot=="function")try{ea.onCommitFiberRoot(Fu,l,void 0,(l.current.flags&128)===128)}catch{}}function R8(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Ii=typeof Object.is=="function"?Object.is:R8,wa=null,Nu=!1,T1=!1;function Vx(l){wa===null?wa=[l]:wa.push(l)}function I8(l){Nu=!0,Vx(l)}function ta(){if(!T1&&wa!==null){T1=!0;var l=0,c=Rt;try{var h=wa;for(Rt=1;l<h.length;l++){var y=h[l];do y=y(!0);while(y!==null)}wa=null,Nu=!1}catch(E){throw wa!==null&&(wa=wa.slice(l+1)),k1(E1,ta),E}finally{Rt=c,T1=!1}}return null}var Jo=[],Zo=0,Ru=null,Iu=0,li=[],ci=0,Js=null,ka=1,Ea="";function Zs(l,c){Jo[Zo++]=Iu,Jo[Zo++]=Ru,Ru=l,Iu=c}function Gx(l,c,h){li[ci++]=ka,li[ci++]=Ea,li[ci++]=Js,Js=l;var y=ka;l=Ea;var E=32-Ri(y)-1;y&=~(1<<E),h+=1;var F=32-Ri(c)+E;if(30<F){var j=E-E%5;F=(y&(1<<j)-1).toString(32),y>>=j,E-=j,ka=1<<32-Ri(c)+E|h<<E|y,Ea=F+l}else ka=1<<F|h<<E|y,Ea=l}function A1(l){l.return!==null&&(Zs(l,1),Gx(l,1,0))}function P1(l){for(;l===Ru;)Ru=Jo[--Zo],Jo[Zo]=null,Iu=Jo[--Zo],Jo[Zo]=null;for(;l===Js;)Js=li[--ci],li[ci]=null,Ea=li[--ci],li[ci]=null,ka=li[--ci],li[ci]=null}var Kn=null,ui=null,qt=!1,Sc=!1,bi=null;function Hx(l,c){var h=gi(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function Wx(l,c){switch(l.tag){case 5:return c=Yo(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Kn=l,ui=B(c),!0):!1;case 6:return c=Qo(c,l.pendingProps),c!==null?(l.stateNode=c,Kn=l,ui=null,!0):!1;case 13:if(c=xc(c),c!==null){var h=Js!==null?{id:ka,overflow:Ea}:null;return l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=gi(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Kn=l,ui=null,!0}return!1;default:return!1}}function F1(l){return(l.mode&1)!==0&&(l.flags&128)===0}function N1(l){if(qt){var c=ui;if(c){var h=c;if(!Wx(l,c)){if(F1(l))throw Error(s(418));c=G(h);var y=Kn;c&&Wx(l,c)?Hx(y,h):(l.flags=l.flags&-4097|2,qt=!1,Kn=l)}}else{if(F1(l))throw Error(s(418));l.flags=l.flags&-4097|2,qt=!1,Kn=l}}}function $x(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Kn=l}function bu(l){if(!tt||l!==Kn)return!1;if(!qt)return $x(l),qt=!0,!1;if(l.tag!==3&&(l.tag!==5||He(l.type)&&!Y(l.type,l.memoizedProps))){var c=ui;if(c){if(F1(l))throw Xx(),Error(s(418));for(;c;)Hx(l,c),c=G(c)}}if($x(l),l.tag===13){if(!tt)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));ui=se(l)}else ui=Kn?G(l.stateNode):null;return!0}function Xx(){for(var l=ui;l;)l=G(l)}function el(){tt&&(ui=Kn=null,Sc=qt=!1)}function R1(l){bi===null?bi=[l]:bi.push(l)}var b8=o.ReactCurrentBatchConfig;function Ou(l,c){if(Ii(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),y=Object.keys(c);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var E=h[y];if(!Qs.call(c,E)||!Ii(l[E],c[E]))return!1}return!0}function O8(l){switch(l.tag){case 5:return Mt(l.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return l=vr(l.type,!1),l;case 11:return l=vr(l.type.render,!1),l;case 1:return l=vr(l.type,!0),l;default:return""}}function wc(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var y=h.stateNode}if(!y)throw Error(s(147,l));var E=y,F=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===F?c.ref:(c=function(j){var te=E.refs;j===null?delete te[F]:te[F]=j},c._stringRef=F,c)}if(typeof l!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,l))}return l}function Du(l,c){throw l=Object.prototype.toString.call(c),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Kx(l){var c=l._init;return c(l._payload)}function Yx(l){function c(fe,re){if(l){var ve=fe.deletions;ve===null?(fe.deletions=[re],fe.flags|=16):ve.push(re)}}function h(fe,re){if(!l)return null;for(;re!==null;)c(fe,re),re=re.sibling;return null}function y(fe,re){for(fe=new Map;re!==null;)re.key!==null?fe.set(re.key,re):fe.set(re.index,re),re=re.sibling;return fe}function E(fe,re){return fe=os(fe,re),fe.index=0,fe.sibling=null,fe}function F(fe,re,ve){return fe.index=ve,l?(ve=fe.alternate,ve!==null?(ve=ve.index,ve<re?(fe.flags|=2,re):ve):(fe.flags|=2,re)):(fe.flags|=1048576,re)}function j(fe){return l&&fe.alternate===null&&(fe.flags|=2),fe}function te(fe,re,ve,ze){return re===null||re.tag!==6?(re=Tp(ve,fe.mode,ze),re.return=fe,re):(re=E(re,ve),re.return=fe,re)}function pe(fe,re,ve,ze){var rt=ve.type;return rt===d?Ke(fe,re,ve.props.children,ze,ve.key):re!==null&&(re.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===x&&Kx(rt)===re.type)?(ze=E(re,ve.props),ze.ref=wc(fe,re,ve),ze.return=fe,ze):(ze=hf(ve.type,ve.key,ve.props,null,fe.mode,ze),ze.ref=wc(fe,re,ve),ze.return=fe,ze)}function Le(fe,re,ve,ze){return re===null||re.tag!==4||re.stateNode.containerInfo!==ve.containerInfo||re.stateNode.implementation!==ve.implementation?(re=Ap(ve,fe.mode,ze),re.return=fe,re):(re=E(re,ve.children||[]),re.return=fe,re)}function Ke(fe,re,ve,ze,rt){return re===null||re.tag!==7?(re=so(ve,fe.mode,ze,rt),re.return=fe,re):(re=E(re,ve),re.return=fe,re)}function ft(fe,re,ve){if(typeof re=="string"&&re!==""||typeof re=="number")return re=Tp(""+re,fe.mode,ve),re.return=fe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case u:return ve=hf(re.type,re.key,re.props,null,fe.mode,ve),ve.ref=wc(fe,null,re),ve.return=fe,ve;case f:return re=Ap(re,fe.mode,ve),re.return=fe,re;case x:var ze=re._init;return ft(fe,ze(re._payload),ve)}if(z(re)||N(re))return re=so(re,fe.mode,ve,null),re.return=fe,re;Du(fe,re)}return null}function Ue(fe,re,ve,ze){var rt=re!==null?re.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return rt!==null?null:te(fe,re,""+ve,ze);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case u:return ve.key===rt?pe(fe,re,ve,ze):null;case f:return ve.key===rt?Le(fe,re,ve,ze):null;case x:return rt=ve._init,Ue(fe,re,rt(ve._payload),ze)}if(z(ve)||N(ve))return rt!==null?null:Ke(fe,re,ve,ze,null);Du(fe,ve)}return null}function Kt(fe,re,ve,ze,rt){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return fe=fe.get(ve)||null,te(re,fe,""+ze,rt);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case u:return fe=fe.get(ze.key===null?ve:ze.key)||null,pe(re,fe,ze,rt);case f:return fe=fe.get(ze.key===null?ve:ze.key)||null,Le(re,fe,ze,rt);case x:var pt=ze._init;return Kt(fe,re,ve,pt(ze._payload),rt)}if(z(ze)||N(ze))return fe=fe.get(ve)||null,Ke(re,fe,ze,rt,null);Du(re,ze)}return null}function Gt(fe,re,ve,ze){for(var rt=null,pt=null,dt=re,It=re=0,Ur=null;dt!==null&&It<ve.length;It++){dt.index>It?(Ur=dt,dt=null):Ur=dt.sibling;var bt=Ue(fe,dt,ve[It],ze);if(bt===null){dt===null&&(dt=Ur);break}l&&dt&&bt.alternate===null&&c(fe,dt),re=F(bt,re,It),pt===null?rt=bt:pt.sibling=bt,pt=bt,dt=Ur}if(It===ve.length)return h(fe,dt),qt&&Zs(fe,It),rt;if(dt===null){for(;It<ve.length;It++)dt=ft(fe,ve[It],ze),dt!==null&&(re=F(dt,re,It),pt===null?rt=dt:pt.sibling=dt,pt=dt);return qt&&Zs(fe,It),rt}for(dt=y(fe,dt);It<ve.length;It++)Ur=Kt(dt,fe,It,ve[It],ze),Ur!==null&&(l&&Ur.alternate!==null&&dt.delete(Ur.key===null?It:Ur.key),re=F(Ur,re,It),pt===null?rt=Ur:pt.sibling=Ur,pt=Ur);return l&&dt.forEach(function(ls){return c(fe,ls)}),qt&&Zs(fe,It),rt}function Un(fe,re,ve,ze){var rt=N(ve);if(typeof rt!="function")throw Error(s(150));if(ve=rt.call(ve),ve==null)throw Error(s(151));for(var pt=rt=null,dt=re,It=re=0,Ur=null,bt=ve.next();dt!==null&&!bt.done;It++,bt=ve.next()){dt.index>It?(Ur=dt,dt=null):Ur=dt.sibling;var ls=Ue(fe,dt,bt.value,ze);if(ls===null){dt===null&&(dt=Ur);break}l&&dt&&ls.alternate===null&&c(fe,dt),re=F(ls,re,It),pt===null?rt=ls:pt.sibling=ls,pt=ls,dt=Ur}if(bt.done)return h(fe,dt),qt&&Zs(fe,It),rt;if(dt===null){for(;!bt.done;It++,bt=ve.next())bt=ft(fe,bt.value,ze),bt!==null&&(re=F(bt,re,It),pt===null?rt=bt:pt.sibling=bt,pt=bt);return qt&&Zs(fe,It),rt}for(dt=y(fe,dt);!bt.done;It++,bt=ve.next())bt=Kt(dt,fe,It,bt.value,ze),bt!==null&&(l&&bt.alternate!==null&&dt.delete(bt.key===null?It:bt.key),re=F(bt,re,It),pt===null?rt=bt:pt.sibling=bt,pt=bt);return l&&dt.forEach(function(uk){return c(fe,uk)}),qt&&Zs(fe,It),rt}function Pa(fe,re,ve,ze){if(typeof ve=="object"&&ve!==null&&ve.type===d&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case u:e:{for(var rt=ve.key,pt=re;pt!==null;){if(pt.key===rt){if(rt=ve.type,rt===d){if(pt.tag===7){h(fe,pt.sibling),re=E(pt,ve.props.children),re.return=fe,fe=re;break e}}else if(pt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===x&&Kx(rt)===pt.type){h(fe,pt.sibling),re=E(pt,ve.props),re.ref=wc(fe,pt,ve),re.return=fe,fe=re;break e}h(fe,pt);break}else c(fe,pt);pt=pt.sibling}ve.type===d?(re=so(ve.props.children,fe.mode,ze,ve.key),re.return=fe,fe=re):(ze=hf(ve.type,ve.key,ve.props,null,fe.mode,ze),ze.ref=wc(fe,re,ve),ze.return=fe,fe=ze)}return j(fe);case f:e:{for(pt=ve.key;re!==null;){if(re.key===pt)if(re.tag===4&&re.stateNode.containerInfo===ve.containerInfo&&re.stateNode.implementation===ve.implementation){h(fe,re.sibling),re=E(re,ve.children||[]),re.return=fe,fe=re;break e}else{h(fe,re);break}else c(fe,re);re=re.sibling}re=Ap(ve,fe.mode,ze),re.return=fe,fe=re}return j(fe);case x:return pt=ve._init,Pa(fe,re,pt(ve._payload),ze)}if(z(ve))return Gt(fe,re,ve,ze);if(N(ve))return Un(fe,re,ve,ze);Du(fe,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,re!==null&&re.tag===6?(h(fe,re.sibling),re=E(re,ve),re.return=fe,fe=re):(h(fe,re),re=Tp(ve,fe.mode,ze),re.return=fe,fe=re),j(fe)):h(fe,re)}return Pa}var tl=Yx(!0),Qx=Yx(!1),Lu=nn(null),Mu=null,rl=null,I1=null;function b1(){I1=rl=Mu=null}function qx(l,c,h){_e?(St(Lu,c._currentValue),c._currentValue=h):(St(Lu,c._currentValue2),c._currentValue2=h)}function O1(l){var c=Lu.current;Bt(Lu),_e?l._currentValue=c:l._currentValue2=c}function D1(l,c,h){for(;l!==null;){var y=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),l===h)break;l=l.return}}function nl(l,c){Mu=l,I1=rl=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(Mn=!0),l.firstContext=null)}function fi(l){var c=_e?l._currentValue:l._currentValue2;if(I1!==l)if(l={context:l,memoizedValue:c,next:null},rl===null){if(Mu===null)throw Error(s(308));rl=l,Mu.dependencies={lanes:0,firstContext:l}}else rl=rl.next=l;return c}var eo=null;function L1(l){eo===null?eo=[l]:eo.push(l)}function Jx(l,c,h,y){var E=c.interleaved;return E===null?(h.next=h,L1(c)):(h.next=E.next,E.next=h),c.interleaved=h,ra(l,y)}function ra(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var ts=!1;function M1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ca(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function rs(l,c,h){var y=l.updateQueue;if(y===null)return null;if(y=y.shared,vt&2){var E=y.pending;return E===null?c.next=c:(c.next=E.next,E.next=c),y.pending=c,ra(l,h)}return E=y.interleaved,E===null?(c.next=c,L1(y)):(c.next=E.next,E.next=c),y.interleaved=c,ra(l,h)}function Bu(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var y=c.lanes;y&=l.pendingLanes,h|=y,c.lanes=h,w1(l,h)}}function ev(l,c){var h=l.updateQueue,y=l.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var E=null,F=null;if(h=h.firstBaseUpdate,h!==null){do{var j={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};F===null?E=F=j:F=F.next=j,h=h.next}while(h!==null);F===null?E=F=c:F=F.next=c}else E=F=c;h={baseState:y.baseState,firstBaseUpdate:E,lastBaseUpdate:F,shared:y.shared,effects:y.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function ju(l,c,h,y){var E=l.updateQueue;ts=!1;var F=E.firstBaseUpdate,j=E.lastBaseUpdate,te=E.shared.pending;if(te!==null){E.shared.pending=null;var pe=te,Le=pe.next;pe.next=null,j===null?F=Le:j.next=Le,j=pe;var Ke=l.alternate;Ke!==null&&(Ke=Ke.updateQueue,te=Ke.lastBaseUpdate,te!==j&&(te===null?Ke.firstBaseUpdate=Le:te.next=Le,Ke.lastBaseUpdate=pe))}if(F!==null){var ft=E.baseState;j=0,Ke=Le=pe=null,te=F;do{var Ue=te.lane,Kt=te.eventTime;if((y&Ue)===Ue){Ke!==null&&(Ke=Ke.next={eventTime:Kt,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var Gt=l,Un=te;switch(Ue=c,Kt=h,Un.tag){case 1:if(Gt=Un.payload,typeof Gt=="function"){ft=Gt.call(Kt,ft,Ue);break e}ft=Gt;break e;case 3:Gt.flags=Gt.flags&-65537|128;case 0:if(Gt=Un.payload,Ue=typeof Gt=="function"?Gt.call(Kt,ft,Ue):Gt,Ue==null)break e;ft=a({},ft,Ue);break e;case 2:ts=!0}}te.callback!==null&&te.lane!==0&&(l.flags|=64,Ue=E.effects,Ue===null?E.effects=[te]:Ue.push(te))}else Kt={eventTime:Kt,lane:Ue,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Ke===null?(Le=Ke=Kt,pe=ft):Ke=Ke.next=Kt,j|=Ue;if(te=te.next,te===null){if(te=E.shared.pending,te===null)break;Ue=te,te=Ue.next,Ue.next=null,E.lastBaseUpdate=Ue,E.shared.pending=null}}while(1);if(Ke===null&&(pe=ft),E.baseState=pe,E.firstBaseUpdate=Le,E.lastBaseUpdate=Ke,c=E.shared.interleaved,c!==null){E=c;do j|=E.lane,E=E.next;while(E!==c)}else F===null&&(E.shared.lanes=0);ro|=j,l.lanes=j,l.memoizedState=ft}}function tv(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var y=l[c],E=y.callback;if(E!==null){if(y.callback=null,y=h,typeof E!="function")throw Error(s(191,E));E.call(y)}}}var kc={},di=nn(kc),Ec=nn(kc),il=nn(kc);function na(l){if(l===kc)throw Error(s(174));return l}function B1(l,c){St(il,c),St(Ec,l),St(di,kc),l=ae(c),Bt(di),St(di,l)}function al(){Bt(di),Bt(Ec),Bt(il)}function rv(l){var c=na(il.current),h=na(di.current);c=ne(h,l.type,c),h!==c&&(St(Ec,l),St(di,c))}function j1(l){Ec.current===l&&(Bt(di),Bt(Ec))}var rr=nn(0);function Uu(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||ku(h)||vc(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var U1=[];function z1(){for(var l=0;l<U1.length;l++){var c=U1[l];_e?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}U1.length=0}var zu=o.ReactCurrentDispatcher,V1=o.ReactCurrentBatchConfig,to=0,nr=null,Cr=null,Br=null,Vu=!1,Cc=!1,Tc=0,D8=0;function sn(){throw Error(s(321))}function G1(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!Ii(l[h],c[h]))return!1;return!0}function H1(l,c,h,y,E,F){if(to=F,nr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,zu.current=l===null||l.memoizedState===null?j8:U8,l=h(y,E),Cc){F=0;do{if(Cc=!1,Tc=0,25<=F)throw Error(s(301));F+=1,Br=Cr=null,c.updateQueue=null,zu.current=z8,l=h(y,E)}while(Cc)}if(zu.current=Wu,c=Cr!==null&&Cr.next!==null,to=0,Br=Cr=nr=null,Vu=!1,c)throw Error(s(300));return l}function W1(){var l=Tc!==0;return Tc=0,l}function ia(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?nr.memoizedState=Br=l:Br=Br.next=l,Br}function hi(){if(Cr===null){var l=nr.alternate;l=l!==null?l.memoizedState:null}else l=Cr.next;var c=Br===null?nr.memoizedState:Br.next;if(c!==null)Br=c,Cr=l;else{if(l===null)throw Error(s(310));Cr=l,l={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Br===null?nr.memoizedState=Br=l:Br=Br.next=l}return Br}function Ac(l,c){return typeof c=="function"?c(l):c}function $1(l){var c=hi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var y=Cr,E=y.baseQueue,F=h.pending;if(F!==null){if(E!==null){var j=E.next;E.next=F.next,F.next=j}y.baseQueue=E=F,h.pending=null}if(E!==null){F=E.next,y=y.baseState;var te=j=null,pe=null,Le=F;do{var Ke=Le.lane;if((to&Ke)===Ke)pe!==null&&(pe=pe.next={lane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),y=Le.hasEagerState?Le.eagerState:l(y,Le.action);else{var ft={lane:Ke,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null};pe===null?(te=pe=ft,j=y):pe=pe.next=ft,nr.lanes|=Ke,ro|=Ke}Le=Le.next}while(Le!==null&&Le!==F);pe===null?j=y:pe.next=te,Ii(y,c.memoizedState)||(Mn=!0),c.memoizedState=y,c.baseState=j,c.baseQueue=pe,h.lastRenderedState=y}if(l=h.interleaved,l!==null){E=l;do F=E.lane,nr.lanes|=F,ro|=F,E=E.next;while(E!==l)}else E===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function X1(l){var c=hi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var y=h.dispatch,E=h.pending,F=c.memoizedState;if(E!==null){h.pending=null;var j=E=E.next;do F=l(F,j.action),j=j.next;while(j!==E);Ii(F,c.memoizedState)||(Mn=!0),c.memoizedState=F,c.baseQueue===null&&(c.baseState=F),h.lastRenderedState=F}return[F,y]}function nv(){}function iv(l,c){var h=nr,y=hi(),E=c(),F=!Ii(y.memoizedState,E);if(F&&(y.memoizedState=E,Mn=!0),y=y.queue,K1(ov.bind(null,h,y,l),[l]),y.getSnapshot!==c||F||Br!==null&&Br.memoizedState.tag&1){if(h.flags|=2048,Pc(9,sv.bind(null,h,y,E,c),void 0,null),jr===null)throw Error(s(349));to&30||av(h,c,E)}return E}function av(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function sv(l,c,h,y){c.value=h,c.getSnapshot=y,lv(c)&&cv(l)}function ov(l,c,h){return h(function(){lv(c)&&cv(l)})}function lv(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!Ii(l,h)}catch{return!0}}function cv(l){var c=ra(l,1);c!==null&&pi(c,l,1,-1)}function uv(l){var c=ia();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:l},c.queue=l,l=l.dispatch=B8.bind(null,nr,l),[c.memoizedState,l]}function Pc(l,c,h,y){return l={tag:l,create:c,destroy:h,deps:y,next:null},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(y=h.next,h.next=l,l.next=y,c.lastEffect=l)),l}function fv(){return hi().memoizedState}function Gu(l,c,h,y){var E=ia();nr.flags|=l,E.memoizedState=Pc(1|c,h,void 0,y===void 0?null:y)}function Hu(l,c,h,y){var E=hi();y=y===void 0?null:y;var F=void 0;if(Cr!==null){var j=Cr.memoizedState;if(F=j.destroy,y!==null&&G1(y,j.deps)){E.memoizedState=Pc(c,h,F,y);return}}nr.flags|=l,E.memoizedState=Pc(1|c,h,F,y)}function dv(l,c){return Gu(8390656,8,l,c)}function K1(l,c){return Hu(2048,8,l,c)}function hv(l,c){return Hu(4,2,l,c)}function pv(l,c){return Hu(4,4,l,c)}function gv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function mv(l,c,h){return h=h!=null?h.concat([l]):null,Hu(4,4,gv.bind(null,c,l),h)}function Y1(){}function xv(l,c){var h=hi();c=c===void 0?null:c;var y=h.memoizedState;return y!==null&&c!==null&&G1(c,y[1])?y[0]:(h.memoizedState=[l,c],l)}function vv(l,c){var h=hi();c=c===void 0?null:c;var y=h.memoizedState;return y!==null&&c!==null&&G1(c,y[1])?y[0]:(l=l(),h.memoizedState=[l,c],l)}function yv(l,c,h){return to&21?(Ii(h,c)||(h=jx(),nr.lanes|=h,ro|=h,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,Mn=!0),l.memoizedState=h)}function L8(l,c){var h=Rt;Rt=h!==0&&4>h?h:4,l(!0);var y=V1.transition;V1.transition={};try{l(!1),c()}finally{Rt=h,V1.transition=y}}function _v(){return hi().memoizedState}function M8(l,c,h){var y=as(l);if(h={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null},Sv(l))wv(c,h);else if(h=Jx(l,c,h,y),h!==null){var E=cn();pi(h,l,y,E),kv(h,c,y)}}function B8(l,c,h){var y=as(l),E={lane:y,action:h,hasEagerState:!1,eagerState:null,next:null};if(Sv(l))wv(c,E);else{var F=l.alternate;if(l.lanes===0&&(F===null||F.lanes===0)&&(F=c.lastRenderedReducer,F!==null))try{var j=c.lastRenderedState,te=F(j,h);if(E.hasEagerState=!0,E.eagerState=te,Ii(te,j)){var pe=c.interleaved;pe===null?(E.next=E,L1(c)):(E.next=pe.next,pe.next=E),c.interleaved=E;return}}catch{}finally{}h=Jx(l,c,E,y),h!==null&&(E=cn(),pi(h,l,y,E),kv(h,c,y))}}function Sv(l){var c=l.alternate;return l===nr||c!==null&&c===nr}function wv(l,c){Cc=Vu=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function kv(l,c,h){if(h&4194240){var y=c.lanes;y&=l.pendingLanes,h|=y,c.lanes=h,w1(l,h)}}var Wu={readContext:fi,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},j8={readContext:fi,useCallback:function(l,c){return ia().memoizedState=[l,c===void 0?null:c],l},useContext:fi,useEffect:dv,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,Gu(4194308,4,gv.bind(null,c,l),h)},useLayoutEffect:function(l,c){return Gu(4194308,4,l,c)},useInsertionEffect:function(l,c){return Gu(4,2,l,c)},useMemo:function(l,c){var h=ia();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var y=ia();return c=h!==void 0?h(c):c,y.memoizedState=y.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},y.queue=l,l=l.dispatch=M8.bind(null,nr,l),[y.memoizedState,l]},useRef:function(l){var c=ia();return l={current:l},c.memoizedState=l},useState:uv,useDebugValue:Y1,useDeferredValue:function(l){return ia().memoizedState=l},useTransition:function(){var l=uv(!1),c=l[0];return l=L8.bind(null,l[1]),ia().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var y=nr,E=ia();if(qt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=c(),jr===null)throw Error(s(349));to&30||av(y,c,h)}E.memoizedState=h;var F={value:h,getSnapshot:c};return E.queue=F,dv(ov.bind(null,y,F,l),[l]),y.flags|=2048,Pc(9,sv.bind(null,y,F,h,c),void 0,null),h},useId:function(){var l=ia(),c=jr.identifierPrefix;if(qt){var h=Ea,y=ka;h=(y&~(1<<32-Ri(y)-1)).toString(32)+h,c=":"+c+"R"+h,h=Tc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=D8++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},U8={readContext:fi,useCallback:xv,useContext:fi,useEffect:K1,useImperativeHandle:mv,useInsertionEffect:hv,useLayoutEffect:pv,useMemo:vv,useReducer:$1,useRef:fv,useState:function(){return $1(Ac)},useDebugValue:Y1,useDeferredValue:function(l){var c=hi();return yv(c,Cr.memoizedState,l)},useTransition:function(){var l=$1(Ac)[0],c=hi().memoizedState;return[l,c]},useMutableSource:nv,useSyncExternalStore:iv,useId:_v,unstable_isNewReconciler:!1},z8={readContext:fi,useCallback:xv,useContext:fi,useEffect:K1,useImperativeHandle:mv,useInsertionEffect:hv,useLayoutEffect:pv,useMemo:vv,useReducer:X1,useRef:fv,useState:function(){return X1(Ac)},useDebugValue:Y1,useDeferredValue:function(l){var c=hi();return Cr===null?c.memoizedState=l:yv(c,Cr.memoizedState,l)},useTransition:function(){var l=X1(Ac)[0],c=hi().memoizedState;return[l,c]},useMutableSource:nv,useSyncExternalStore:iv,useId:_v,unstable_isNewReconciler:!1};function Oi(l,c){if(l&&l.defaultProps){c=a({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function Q1(l,c,h,y){c=l.memoizedState,h=h(y,c),h=h==null?c:a({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var $u={isMounted:function(l){return(l=l._reactInternals)?I(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var y=cn(),E=as(l),F=Ca(y,E);F.payload=c,h!=null&&(F.callback=h),c=rs(l,F,E),c!==null&&(pi(c,l,E,y),Bu(c,l,E))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var y=cn(),E=as(l),F=Ca(y,E);F.tag=1,F.payload=c,h!=null&&(F.callback=h),c=rs(l,F,E),c!==null&&(pi(c,l,E,y),Bu(c,l,E))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=cn(),y=as(l),E=Ca(h,y);E.tag=2,c!=null&&(E.callback=c),c=rs(l,E,y),c!==null&&(pi(c,l,y,h),Bu(c,l,y))}};function Ev(l,c,h,y,E,F,j){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(y,F,j):c.prototype&&c.prototype.isPureReactComponent?!Ou(h,y)||!Ou(E,F):!0}function Cv(l,c,h){var y=!1,E=es,F=c.contextType;return typeof F=="object"&&F!==null?F=fi(F):(E=Ln(c)?qs:an.current,y=c.contextTypes,F=(y=y!=null)?qo(l,E):es),c=new c(h,F),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=$u,l.stateNode=c,c._reactInternals=l,y&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=F),c}function Tv(l,c,h,y){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,y),c.state!==l&&$u.enqueueReplaceState(c,c.state,null)}function q1(l,c,h,y){var E=l.stateNode;E.props=h,E.state=l.memoizedState,E.refs={},M1(l);var F=c.contextType;typeof F=="object"&&F!==null?E.context=fi(F):(F=Ln(c)?qs:an.current,E.context=qo(l,F)),E.state=l.memoizedState,F=c.getDerivedStateFromProps,typeof F=="function"&&(Q1(l,c,F,h),E.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(c=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),c!==E.state&&$u.enqueueReplaceState(E,E.state,null),ju(l,h,E,y),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}function sl(l,c){try{var h="",y=c;do h+=O8(y),y=y.return;while(y);var E=h}catch(F){E=`
Error generating stack: `+F.message+`
`+F.stack}return{value:l,source:c,stack:E,digest:null}}function J1(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function Z1(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var V8=typeof WeakMap=="function"?WeakMap:Map;function Av(l,c,h){h=Ca(-1,h),h.tag=3,h.payload={element:null};var y=c.value;return h.callback=function(){of||(of=!0,yp=y),Z1(l,c)},h}function Pv(l,c,h){h=Ca(-1,h),h.tag=3;var y=l.type.getDerivedStateFromError;if(typeof y=="function"){var E=c.value;h.payload=function(){return y(E)},h.callback=function(){Z1(l,c)}}var F=l.stateNode;return F!==null&&typeof F.componentDidCatch=="function"&&(h.callback=function(){Z1(l,c),typeof y!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})}),h}function Fv(l,c,h){var y=l.pingCache;if(y===null){y=l.pingCache=new V8;var E=new Set;y.set(c,E)}else E=y.get(c),E===void 0&&(E=new Set,y.set(c,E));E.has(h)||(E.add(h),l=rk.bind(null,l,c,h),c.then(l,l))}function Nv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Rv(l,c,h,y,E){return l.mode&1?(l.flags|=65536,l.lanes=E,l):(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Ca(-1,1),c.tag=2,rs(h,c,1))),h.lanes|=1),l)}var G8=o.ReactCurrentOwner,Mn=!1;function En(l,c,h,y){c.child=l===null?Qx(c,null,h,y):tl(c,l.child,h,y)}function Iv(l,c,h,y,E){h=h.render;var F=c.ref;return nl(c,E),y=H1(l,c,h,y,F,E),h=W1(),l!==null&&!Mn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,Ta(l,c,E)):(qt&&h&&A1(c),c.flags|=1,En(l,c,y,E),c.child)}function bv(l,c,h,y,E){if(l===null){var F=h.type;return typeof F=="function"&&!Cp(F)&&F.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=F,Ov(l,c,F,y,E)):(l=hf(h.type,null,y,c,c.mode,E),l.ref=c.ref,l.return=c,c.child=l)}if(F=l.child,!(l.lanes&E)){var j=F.memoizedProps;if(h=h.compare,h=h!==null?h:Ou,h(j,y)&&l.ref===c.ref)return Ta(l,c,E)}return c.flags|=1,l=os(F,y),l.ref=c.ref,l.return=c,c.child=l}function Ov(l,c,h,y,E){if(l!==null){var F=l.memoizedProps;if(Ou(F,y)&&l.ref===c.ref)if(Mn=!1,c.pendingProps=y=F,(l.lanes&E)!==0)l.flags&131072&&(Mn=!0);else return c.lanes=l.lanes,Ta(l,c,E)}return ep(l,c,h,y,E)}function Dv(l,c,h){var y=c.pendingProps,E=y.children,F=l!==null?l.memoizedState:null;if(y.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(ll,Yn),Yn|=h;else{if(!(h&1073741824))return l=F!==null?F.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,St(ll,Yn),Yn|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=F!==null?F.baseLanes:h,St(ll,Yn),Yn|=y}else F!==null?(y=F.baseLanes|h,c.memoizedState=null):y=h,St(ll,Yn),Yn|=y;return En(l,c,E,h),c.child}function Lv(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function ep(l,c,h,y,E){var F=Ln(h)?qs:an.current;return F=qo(c,F),nl(c,E),h=H1(l,c,h,y,F,E),y=W1(),l!==null&&!Mn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~E,Ta(l,c,E)):(qt&&y&&A1(c),c.flags|=1,En(l,c,h,E),c.child)}function Mv(l,c,h,y,E){if(Ln(h)){var F=!0;Cu(c)}else F=!1;if(nl(c,E),c.stateNode===null)Ku(l,c),Cv(c,h,y),q1(c,h,y,E),y=!0;else if(l===null){var j=c.stateNode,te=c.memoizedProps;j.props=te;var pe=j.context,Le=h.contextType;typeof Le=="object"&&Le!==null?Le=fi(Le):(Le=Ln(h)?qs:an.current,Le=qo(c,Le));var Ke=h.getDerivedStateFromProps,ft=typeof Ke=="function"||typeof j.getSnapshotBeforeUpdate=="function";ft||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(te!==y||pe!==Le)&&Tv(c,j,y,Le),ts=!1;var Ue=c.memoizedState;j.state=Ue,ju(c,y,j,E),pe=c.memoizedState,te!==y||Ue!==pe||Dn.current||ts?(typeof Ke=="function"&&(Q1(c,h,Ke,y),pe=c.memoizedState),(te=ts||Ev(c,h,te,y,Ue,pe,Le))?(ft||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(c.flags|=4194308)):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=pe),j.props=y,j.state=pe,j.context=Le,y=te):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{j=c.stateNode,Zx(l,c),te=c.memoizedProps,Le=c.type===c.elementType?te:Oi(c.type,te),j.props=Le,ft=c.pendingProps,Ue=j.context,pe=h.contextType,typeof pe=="object"&&pe!==null?pe=fi(pe):(pe=Ln(h)?qs:an.current,pe=qo(c,pe));var Kt=h.getDerivedStateFromProps;(Ke=typeof Kt=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(te!==ft||Ue!==pe)&&Tv(c,j,y,pe),ts=!1,Ue=c.memoizedState,j.state=Ue,ju(c,y,j,E);var Gt=c.memoizedState;te!==ft||Ue!==Gt||Dn.current||ts?(typeof Kt=="function"&&(Q1(c,h,Kt,y),Gt=c.memoizedState),(Le=ts||Ev(c,h,Le,y,Ue,Gt,pe)||!1)?(Ke||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(y,Gt,pe),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(y,Gt,pe)),typeof j.componentDidUpdate=="function"&&(c.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof j.componentDidUpdate!="function"||te===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||te===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Gt),j.props=y,j.state=Gt,j.context=pe,y=Le):(typeof j.componentDidUpdate!="function"||te===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||te===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=1024),y=!1)}return tp(l,c,h,y,F,E)}function tp(l,c,h,y,E,F){Lv(l,c);var j=(c.flags&128)!==0;if(!y&&!j)return E&&Bx(c,h,!1),Ta(l,c,F);y=c.stateNode,G8.current=c;var te=j&&typeof h.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,l!==null&&j?(c.child=tl(c,l.child,null,F),c.child=tl(c,null,te,F)):En(l,c,te,F),c.memoizedState=y.state,E&&Bx(c,h,!0),c.child}function Bv(l){var c=l.stateNode;c.pendingContext?Lx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&Lx(l,c.context,!1),B1(l,c.containerInfo)}function jv(l,c,h,y,E){return el(),R1(E),c.flags|=256,En(l,c,h,y),c.child}var rp={dehydrated:null,treeContext:null,retryLane:0};function np(l){return{baseLanes:l,cachePool:null,transitions:null}}function Uv(l,c,h){var y=c.pendingProps,E=rr.current,F=!1,j=(c.flags&128)!==0,te;if((te=j)||(te=l!==null&&l.memoizedState===null?!1:(E&2)!==0),te?(F=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),St(rr,E&1),l===null)return N1(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?vc(l)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(j=y.children,l=y.fallback,F?(y=c.mode,F=c.child,j={mode:"hidden",children:j},!(y&1)&&F!==null?(F.childLanes=0,F.pendingProps=j):F=pf(j,y,0,null),l=so(l,y,h,null),F.return=c,l.return=c,F.sibling=l,c.child=F,c.child.memoizedState=np(h),c.memoizedState=rp,l):ip(c,j));if(E=l.memoizedState,E!==null&&(te=E.dehydrated,te!==null))return H8(l,c,j,y,te,E,h);if(F){F=y.fallback,j=c.mode,E=l.child,te=E.sibling;var pe={mode:"hidden",children:y.children};return!(j&1)&&c.child!==E?(y=c.child,y.childLanes=0,y.pendingProps=pe,c.deletions=null):(y=os(E,pe),y.subtreeFlags=E.subtreeFlags&14680064),te!==null?F=os(te,F):(F=so(F,j,h,null),F.flags|=2),F.return=c,y.return=c,y.sibling=F,c.child=y,y=F,F=c.child,j=l.child.memoizedState,j=j===null?np(h):{baseLanes:j.baseLanes|h,cachePool:null,transitions:j.transitions},F.memoizedState=j,F.childLanes=l.childLanes&~h,c.memoizedState=rp,y}return F=l.child,l=F.sibling,y=os(F,{mode:"visible",children:y.children}),!(c.mode&1)&&(y.lanes=h),y.return=c,y.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=y,c.memoizedState=null,y}function ip(l,c){return c=pf({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Xu(l,c,h,y){return y!==null&&R1(y),tl(c,l.child,null,h),l=ip(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function H8(l,c,h,y,E,F,j){if(h)return c.flags&256?(c.flags&=-257,y=J1(Error(s(422))),Xu(l,c,j,y)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(F=y.fallback,E=c.mode,y=pf({mode:"visible",children:y.children},E,0,null),F=so(F,E,j,null),F.flags|=2,y.return=c,F.return=c,y.sibling=F,c.child=y,c.mode&1&&tl(c,l.child,null,j),c.child.memoizedState=np(j),c.memoizedState=rp,F);if(!(c.mode&1))return Xu(l,c,j,null);if(vc(E))return y=y1(E).digest,F=Error(s(419)),y=J1(F,y,void 0),Xu(l,c,j,y);if(h=(j&l.childLanes)!==0,Mn||h){if(y=jr,y!==null){switch(j&-j){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=E&(y.suspendedLanes|j)?0:E,E!==0&&E!==F.retryLane&&(F.retryLane=E,ra(l,E),pi(y,l,E,-1))}return Ep(),y=J1(Error(s(421))),Xu(l,c,j,y)}return ku(E)?(c.flags|=128,c.child=l.child,c=nk.bind(null,l),O(E,c),null):(l=F.treeContext,tt&&(ui=W(E),Kn=c,qt=!0,bi=null,Sc=!1,l!==null&&(li[ci++]=ka,li[ci++]=Ea,li[ci++]=Js,ka=l.id,Ea=l.overflow,Js=c)),c=ip(c,y.children),c.flags|=4096,c)}function zv(l,c,h){l.lanes|=c;var y=l.alternate;y!==null&&(y.lanes|=c),D1(l.return,c,h)}function ap(l,c,h,y,E){var F=l.memoizedState;F===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:E}:(F.isBackwards=c,F.rendering=null,F.renderingStartTime=0,F.last=y,F.tail=h,F.tailMode=E)}function Vv(l,c,h){var y=c.pendingProps,E=y.revealOrder,F=y.tail;if(En(l,c,y.children,h),y=rr.current,y&2)y=y&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&zv(l,h,c);else if(l.tag===19)zv(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}y&=1}if(St(rr,y),!(c.mode&1))c.memoizedState=null;else switch(E){case"forwards":for(h=c.child,E=null;h!==null;)l=h.alternate,l!==null&&Uu(l)===null&&(E=h),h=h.sibling;h=E,h===null?(E=c.child,c.child=null):(E=h.sibling,h.sibling=null),ap(c,!1,E,h,F);break;case"backwards":for(h=null,E=c.child,c.child=null;E!==null;){if(l=E.alternate,l!==null&&Uu(l)===null){c.child=E;break}l=E.sibling,E.sibling=h,h=E,E=l}ap(c,!0,h,null,F);break;case"together":ap(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ku(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Ta(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),ro|=c.lanes,!(h&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(s(153));if(c.child!==null){for(l=c.child,h=os(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=os(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function W8(l,c,h){switch(c.tag){case 3:Bv(c),el();break;case 5:rv(c);break;case 1:Ln(c.type)&&Cu(c);break;case 4:B1(c,c.stateNode.containerInfo);break;case 10:qx(c,c.type._context,c.memoizedProps.value);break;case 13:var y=c.memoizedState;if(y!==null)return y.dehydrated!==null?(St(rr,rr.current&1),c.flags|=128,null):h&c.child.childLanes?Uv(l,c,h):(St(rr,rr.current&1),l=Ta(l,c,h),l!==null?l.sibling:null);St(rr,rr.current&1);break;case 19:if(y=(h&c.childLanes)!==0,l.flags&128){if(y)return Vv(l,c,h);c.flags|=128}var E=c.memoizedState;if(E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),St(rr,rr.current),y)break;return null;case 22:case 23:return c.lanes=0,Dv(l,c,h)}return Ta(l,c,h)}function aa(l){l.flags|=4}function Gv(l,c){if(l!==null&&l.child===c.child)return!0;if(c.flags&16)return!1;for(l=c.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Fc,Nc,Yu,Qu;if(Me)Fc=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)L(l,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Nc=function(){},Yu=function(l,c,h,y,E){if(l=l.memoizedProps,l!==y){var F=c.stateNode,j=na(di.current);h=q(F,h,l,y,E,j),(c.updateQueue=h)&&aa(c)}},Qu=function(l,c,h,y){h!==y&&aa(c)};else if(H){Fc=function(l,c,h,y){for(var E=c.child;E!==null;){if(E.tag===5){var F=E.stateNode;h&&y&&(F=rn(F,E.type,E.memoizedProps,E)),L(l,F)}else if(E.tag===6)F=E.stateNode,h&&y&&(F=lr(F,E.memoizedProps,E)),L(l,F);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)F=E.child,F!==null&&(F.return=E),Fc(l,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===c)break;for(;E.sibling===null;){if(E.return===null||E.return===c)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};var Hv=function(l,c,h,y){for(var E=c.child;E!==null;){if(E.tag===5){var F=E.stateNode;h&&y&&(F=rn(F,E.type,E.memoizedProps,E)),kn(l,F)}else if(E.tag===6)F=E.stateNode,h&&y&&(F=lr(F,E.memoizedProps,E)),kn(l,F);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)F=E.child,F!==null&&(F.return=E),Hv(l,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===c)break;for(;E.sibling===null;){if(E.return===null||E.return===c)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};Nc=function(l,c){var h=c.stateNode;if(!Gv(l,c)){l=h.containerInfo;var y=Ot(l);Hv(y,c,!1,!1),h.pendingChildren=y,aa(c),tn(l,y)}},Yu=function(l,c,h,y,E){var F=l.stateNode,j=l.memoizedProps;if((l=Gv(l,c))&&j===y)c.stateNode=F;else{var te=c.stateNode,pe=na(di.current),Le=null;j!==y&&(Le=q(te,h,j,y,E,pe)),l&&Le===null?c.stateNode=F:(F=Pt(F,Le,h,j,y,c,l,te),ee(F,h,y,E,pe)&&aa(c),c.stateNode=F,l?aa(c):Fc(F,c,!1,!1))}},Qu=function(l,c,h,y){h!==y?(l=na(il.current),h=na(di.current),c.stateNode=de(y,l,h,c),aa(c)):c.stateNode=l.stateNode}}else Nc=function(){},Yu=function(){},Qu=function(){};function Rc(l,c){if(!qt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:y.sibling=null}}function on(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,y=0;if(c)for(var E=l.child;E!==null;)h|=E.lanes|E.childLanes,y|=E.subtreeFlags&14680064,y|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)h|=E.lanes|E.childLanes,y|=E.subtreeFlags,y|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=y,l.childLanes=h,c}function $8(l,c,h){var y=c.pendingProps;switch(P1(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(c),null;case 1:return Ln(c.type)&&Eu(),on(c),null;case 3:return h=c.stateNode,al(),Bt(Dn),Bt(an),z1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(l===null||l.child===null)&&(bu(c)?aa(c):l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,bi!==null&&(wp(bi),bi=null))),Nc(l,c),on(c),null;case 5:j1(c),h=na(il.current);var E=c.type;if(l!==null&&c.stateNode!=null)Yu(l,c,E,y,h),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(s(166));return on(c),null}if(l=na(di.current),bu(c)){if(!tt)throw Error(s(175));l=X(c.stateNode,c.type,c.memoizedProps,h,l,c,!Sc),c.updateQueue=l,l!==null&&aa(c)}else{var F=me(E,y,h,l,c);Fc(F,c,!1,!1),c.stateNode=F,ee(F,E,y,h,l)&&aa(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return on(c),null;case 6:if(l&&c.stateNode!=null)Qu(l,c,l.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(s(166));if(l=na(il.current),h=na(di.current),bu(c)){if(!tt)throw Error(s(176));if(l=c.stateNode,h=c.memoizedProps,(y=oe(l,h,c,!Sc))&&(E=Kn,E!==null))switch(E.tag){case 3:De(E.stateNode.containerInfo,l,h,(E.mode&1)!==0);break;case 5:je(E.type,E.memoizedProps,E.stateNode,l,h,(E.mode&1)!==0)}y&&aa(c)}else c.stateNode=de(y,l,h,c)}return on(c),null;case 13:if(Bt(rr),y=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(qt&&ui!==null&&c.mode&1&&!(c.flags&128))Xx(),el(),c.flags|=98560,E=!1;else if(E=bu(c),y!==null&&y.dehydrated!==null){if(l===null){if(!E)throw Error(s(318));if(!tt)throw Error(s(344));if(E=c.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(s(317));we(E,c)}else el(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;on(c),E=!1}else bi!==null&&(wp(bi),bi=null),E=!0;if(!E)return c.flags&65536?c:null}return c.flags&128?(c.lanes=h,c):(h=y!==null,h!==(l!==null&&l.memoizedState!==null)&&h&&(c.child.flags|=8192,c.mode&1&&(l===null||rr.current&1?Tr===0&&(Tr=3):Ep())),c.updateQueue!==null&&(c.flags|=4),on(c),null);case 4:return al(),Nc(l,c),l===null&&Xe(c.stateNode.containerInfo),on(c),null;case 10:return O1(c.type._context),on(c),null;case 17:return Ln(c.type)&&Eu(),on(c),null;case 19:if(Bt(rr),E=c.memoizedState,E===null)return on(c),null;if(y=(c.flags&128)!==0,F=E.rendering,F===null)if(y)Rc(E,!1);else{if(Tr!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(F=Uu(l),F!==null){for(c.flags|=128,Rc(E,!1),l=F.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=h,h=c.child;h!==null;)y=h,E=l,y.flags&=14680066,F=y.alternate,F===null?(y.childLanes=0,y.lanes=E,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=F.childLanes,y.lanes=F.lanes,y.child=F.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=F.memoizedProps,y.memoizedState=F.memoizedState,y.updateQueue=F.updateQueue,y.type=F.type,E=F.dependencies,y.dependencies=E===null?null:{lanes:E.lanes,firstContext:E.firstContext}),h=h.sibling;return St(rr,rr.current&1|2),c.child}l=l.sibling}E.tail!==null&&Mr()>vp&&(c.flags|=128,y=!0,Rc(E,!1),c.lanes=4194304)}else{if(!y)if(l=Uu(F),l!==null){if(c.flags|=128,y=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Rc(E,!0),E.tail===null&&E.tailMode==="hidden"&&!F.alternate&&!qt)return on(c),null}else 2*Mr()-E.renderingStartTime>vp&&h!==1073741824&&(c.flags|=128,y=!0,Rc(E,!1),c.lanes=4194304);E.isBackwards?(F.sibling=c.child,c.child=F):(l=E.last,l!==null?l.sibling=F:c.child=F,E.last=F)}return E.tail!==null?(c=E.tail,E.rendering=c,E.tail=c.sibling,E.renderingStartTime=Mr(),c.sibling=null,l=rr.current,St(rr,y?l&1|2:l&1),c):(on(c),null);case 22:case 23:return kp(),h=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==h&&(c.flags|=8192),h&&c.mode&1?Yn&1073741824&&(on(c),Me&&c.subtreeFlags&6&&(c.flags|=8192)):on(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function X8(l,c){switch(P1(c),c.tag){case 1:return Ln(c.type)&&Eu(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return al(),Bt(Dn),Bt(an),z1(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return j1(c),null;case 13:if(Bt(rr),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(s(340));el()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Bt(rr),null;case 4:return al(),null;case 10:return O1(c.type._context),null;case 22:case 23:return kp(),null;case 24:return null;default:return null}}var qu=!1,ln=!1,K8=typeof WeakSet=="function"?WeakSet:Set,We=null;function ol(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(y){Jt(l,c,y)}else h.current=null}function sp(l,c,h){try{h()}catch(y){Jt(l,c,y)}}var Wv=!1;function Y8(l,c){for(K(l.containerInfo),We=c;We!==null;)if(l=We,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,We=c;else for(;We!==null;){l=We;try{var h=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var y=h.memoizedProps,E=h.memoizedState,F=l.stateNode,j=F.getSnapshotBeforeUpdate(l.elementType===l.type?y:Oi(l.type,y),E);F.__reactInternalSnapshotBeforeUpdate=j}break;case 3:Me&&ut(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(te){Jt(l,l.return,te)}if(c=l.sibling,c!==null){c.return=l.return,We=c;break}We=l.return}return h=Wv,Wv=!1,h}function Ic(l,c,h){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var E=y=y.next;do{if((E.tag&l)===l){var F=E.destroy;E.destroy=void 0,F!==void 0&&sp(c,h,F)}E=E.next}while(E!==y)}}function Ju(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var y=h.create;h.destroy=y()}h=h.next}while(h!==c)}}function op(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=Z(h);break;default:l=h}typeof c=="function"?c(l):c.current=l}}function $v(l){var c=l.alternate;c!==null&&(l.alternate=null,$v(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&be(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Xv(l){return l.tag===5||l.tag===3||l.tag===4}function Kv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Xv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function lp(l,c,h){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?lt(h,l,c):Ee(h,l);else if(y!==4&&(l=l.child,l!==null))for(lp(l,c,h),l=l.sibling;l!==null;)lp(l,c,h),l=l.sibling}function cp(l,c,h){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?et(h,l,c):J(h,l);else if(y!==4&&(l=l.child,l!==null))for(cp(l,c,h),l=l.sibling;l!==null;)cp(l,c,h),l=l.sibling}var Xr=null,Di=!1;function sa(l,c,h){for(h=h.child;h!==null;)up(l,c,h),h=h.sibling}function up(l,c,h){if(ea&&typeof ea.onCommitFiberUnmount=="function")try{ea.onCommitFiberUnmount(Fu,h)}catch{}switch(h.tag){case 5:ln||ol(h,c);case 6:if(Me){var y=Xr,E=Di;Xr=null,sa(l,c,h),Xr=y,Di=E,Xr!==null&&(Di?xt(Xr,h.stateNode):Ye(Xr,h.stateNode))}else sa(l,c,h);break;case 18:Me&&Xr!==null&&(Di?Be(Xr,h.stateNode):Ne(Xr,h.stateNode));break;case 4:Me?(y=Xr,E=Di,Xr=h.stateNode.containerInfo,Di=!0,sa(l,c,h),Xr=y,Di=E):(H&&(y=h.stateNode.containerInfo,E=Ot(y),mt(y,E)),sa(l,c,h));break;case 0:case 11:case 14:case 15:if(!ln&&(y=h.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){E=y=y.next;do{var F=E,j=F.destroy;F=F.tag,j!==void 0&&(F&2||F&4)&&sp(h,c,j),E=E.next}while(E!==y)}sa(l,c,h);break;case 1:if(!ln&&(ol(h,c),y=h.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=h.memoizedProps,y.state=h.memoizedState,y.componentWillUnmount()}catch(te){Jt(h,c,te)}sa(l,c,h);break;case 21:sa(l,c,h);break;case 22:h.mode&1?(ln=(y=ln)||h.memoizedState!==null,sa(l,c,h),ln=y):sa(l,c,h);break;default:sa(l,c,h)}}function Yv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new K8),c.forEach(function(y){var E=ik.bind(null,l,y);h.has(y)||(h.add(y),y.then(E,E))})}}function Li(l,c){var h=c.deletions;if(h!==null)for(var y=0;y<h.length;y++){var E=h[y];try{var F=l,j=c;if(Me){var te=j;e:for(;te!==null;){switch(te.tag){case 5:Xr=te.stateNode,Di=!1;break e;case 3:Xr=te.stateNode.containerInfo,Di=!0;break e;case 4:Xr=te.stateNode.containerInfo,Di=!0;break e}te=te.return}if(Xr===null)throw Error(s(160));up(F,j,E),Xr=null,Di=!1}else up(F,j,E);var pe=E.alternate;pe!==null&&(pe.return=null),E.return=null}catch(Le){Jt(E,c,Le)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Qv(c,l),c=c.sibling}function Qv(l,c){var h=l.alternate,y=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Li(c,l),oa(l),y&4){try{Ic(3,l,l.return),Ju(3,l)}catch(Ue){Jt(l,l.return,Ue)}try{Ic(5,l,l.return)}catch(Ue){Jt(l,l.return,Ue)}}break;case 1:Li(c,l),oa(l),y&512&&h!==null&&ol(h,h.return);break;case 5:if(Li(c,l),oa(l),y&512&&h!==null&&ol(h,h.return),Me){if(l.flags&32){var E=l.stateNode;try{si(E)}catch(Ue){Jt(l,l.return,Ue)}}if(y&4&&(E=l.stateNode,E!=null)){var F=l.memoizedProps;if(h=h!==null?h.memoizedProps:F,y=l.type,c=l.updateQueue,l.updateQueue=null,c!==null)try{Qe(E,c,y,h,F,l)}catch(Ue){Jt(l,l.return,Ue)}}}break;case 6:if(Li(c,l),oa(l),y&4&&Me){if(l.stateNode===null)throw Error(s(162));E=l.stateNode,F=l.memoizedProps,h=h!==null?h.memoizedProps:F;try{Fe(E,h,F)}catch(Ue){Jt(l,l.return,Ue)}}break;case 3:if(Li(c,l),oa(l),y&4){if(Me&&tt&&h!==null&&h.memoizedState.isDehydrated)try{le(c.containerInfo)}catch(Ue){Jt(l,l.return,Ue)}if(H){E=c.containerInfo,F=c.pendingChildren;try{mt(E,F)}catch(Ue){Jt(l,l.return,Ue)}}}break;case 4:if(Li(c,l),oa(l),y&4&&H){F=l.stateNode,E=F.containerInfo,F=F.pendingChildren;try{mt(E,F)}catch(Ue){Jt(l,l.return,Ue)}}break;case 13:Li(c,l),oa(l),E=l.child,E.flags&8192&&(F=E.memoizedState!==null,E.stateNode.isHidden=F,!F||E.alternate!==null&&E.alternate.memoizedState!==null||(xp=Mr())),y&4&&Yv(l);break;case 22:var j=h!==null&&h.memoizedState!==null;if(l.mode&1?(ln=(h=ln)||j,Li(c,l),ln=h):Li(c,l),oa(l),y&8192){if(h=l.memoizedState!==null,(l.stateNode.isHidden=h)&&!j&&l.mode&1)for(We=l,y=l.child;y!==null;){for(c=We=y;We!==null;){j=We;var te=j.child;switch(j.tag){case 0:case 11:case 14:case 15:Ic(4,j,j.return);break;case 1:ol(j,j.return);var pe=j.stateNode;if(typeof pe.componentWillUnmount=="function"){var Le=j,Ke=j.return;try{var ft=Le;pe.props=ft.memoizedProps,pe.state=ft.memoizedState,pe.componentWillUnmount()}catch(Ue){Jt(Le,Ke,Ue)}}break;case 5:ol(j,j.return);break;case 22:if(j.memoizedState!==null){Zv(c);continue}}te!==null?(te.return=j,We=te):Zv(c)}y=y.sibling}if(Me){e:if(y=null,Me)for(c=l;;){if(c.tag===5){if(y===null){y=c;try{E=c.stateNode,h?Ie(E):Ge(c.stateNode,c.memoizedProps)}catch(Ue){Jt(l,l.return,Ue)}}}else if(c.tag===6){if(y===null)try{F=c.stateNode,h?qe(F):Je(F,c.memoizedProps)}catch(Ue){Jt(l,l.return,Ue)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;y===c&&(y=null),c=c.return}y===c&&(y=null),c.sibling.return=c.return,c=c.sibling}}}break;case 19:Li(c,l),oa(l),y&4&&Yv(l);break;case 21:break;default:Li(c,l),oa(l)}}function oa(l){var c=l.flags;if(c&2){try{if(Me){e:{for(var h=l.return;h!==null;){if(Xv(h)){var y=h;break e}h=h.return}throw Error(s(160))}switch(y.tag){case 5:var E=y.stateNode;y.flags&32&&(si(E),y.flags&=-33);var F=Kv(l);cp(l,F,E);break;case 3:case 4:var j=y.stateNode.containerInfo,te=Kv(l);lp(l,te,j);break;default:throw Error(s(161))}}}catch(pe){Jt(l,l.return,pe)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function Q8(l,c,h){We=l,qv(l)}function qv(l,c,h){for(var y=(l.mode&1)!==0;We!==null;){var E=We,F=E.child;if(E.tag===22&&y){var j=E.memoizedState!==null||qu;if(!j){var te=E.alternate,pe=te!==null&&te.memoizedState!==null||ln;te=qu;var Le=ln;if(qu=j,(ln=pe)&&!Le)for(We=E;We!==null;)j=We,pe=j.child,j.tag===22&&j.memoizedState!==null?e4(E):pe!==null?(pe.return=j,We=pe):e4(E);for(;F!==null;)We=F,qv(F),F=F.sibling;We=E,qu=te,ln=Le}Jv(l)}else E.subtreeFlags&8772&&F!==null?(F.return=E,We=F):Jv(l)}}function Jv(l){for(;We!==null;){var c=We;if(c.flags&8772){var h=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:ln||Ju(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!ln)if(h===null)y.componentDidMount();else{var E=c.elementType===c.type?h.memoizedProps:Oi(c.type,h.memoizedProps);y.componentDidUpdate(E,h.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var F=c.updateQueue;F!==null&&tv(c,F,y);break;case 3:var j=c.updateQueue;if(j!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=Z(c.child.stateNode);break;case 1:h=c.child.stateNode}tv(c,j,h)}break;case 5:var te=c.stateNode;h===null&&c.flags&4&&Ce(te,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(tt&&c.memoizedState===null){var pe=c.alternate;if(pe!==null){var Le=pe.memoizedState;if(Le!==null){var Ke=Le.dehydrated;Ke!==null&&ue(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}ln||c.flags&512&&op(c)}catch(ft){Jt(c,c.return,ft)}}if(c===l){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function Zv(l){for(;We!==null;){var c=We;if(c===l){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function e4(l){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Ju(4,c)}catch(pe){Jt(c,h,pe)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var E=c.return;try{y.componentDidMount()}catch(pe){Jt(c,E,pe)}}var F=c.return;try{op(c)}catch(pe){Jt(c,F,pe)}break;case 5:var j=c.return;try{op(c)}catch(pe){Jt(c,j,pe)}}}catch(pe){Jt(c,c.return,pe)}if(c===l){We=null;break}var te=c.sibling;if(te!==null){te.return=c.return,We=te;break}We=c.return}}var Zu=0,ef=1,tf=2,rf=3,nf=4;if(typeof Symbol=="function"&&Symbol.for){var bc=Symbol.for;Zu=bc("selector.component"),ef=bc("selector.has_pseudo_class"),tf=bc("selector.role"),rf=bc("selector.test_id"),nf=bc("selector.text")}function fp(l){var c=nt(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(s(364));return c}if(l=xe(l),l===null)throw Error(s(362));return l.stateNode.current}function dp(l,c){switch(c.$$typeof){case Zu:if(l.type===c.value)return!0;break;case ef:e:{c=c.value,l=[l,0];for(var h=0;h<l.length;){var y=l[h++],E=l[h++],F=c[E];if(y.tag!==5||!Pe(y)){for(;F!=null&&dp(y,F);)E++,F=c[E];if(E===c.length){c=!0;break e}else for(y=y.child;y!==null;)l.push(y,E),y=y.sibling}}c=!1}return c;case tf:if(l.tag===5&&Oe(l.stateNode,c.value))return!0;break;case nf:if((l.tag===5||l.tag===6)&&(l=Ae(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case rf:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function hp(l){switch(l.$$typeof){case Zu:return"<"+(R(l.value)||"Unknown")+">";case ef:return":has("+(hp(l)||"")+")";case tf:return'[role="'+l.value+'"]';case nf:return'"'+l.value+'"';case rf:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function t4(l,c){var h=[];l=[l,0];for(var y=0;y<l.length;){var E=l[y++],F=l[y++],j=c[F];if(E.tag!==5||!Pe(E)){for(;j!=null&&dp(E,j);)F++,j=c[F];if(F===c.length)h.push(E);else for(E=E.child;E!==null;)l.push(E,F),E=E.sibling}}return h}function pp(l,c){if(!ye)throw Error(s(363));l=fp(l),l=t4(l,c),c=[],l=Array.from(l);for(var h=0;h<l.length;){var y=l[h++];if(y.tag===5)Pe(y)||c.push(y.stateNode);else for(y=y.child;y!==null;)l.push(y),y=y.sibling}return c}var q8=Math.ceil,af=o.ReactCurrentDispatcher,gp=o.ReactCurrentOwner,pr=o.ReactCurrentBatchConfig,vt=0,jr=null,yr=null,Kr=0,Yn=0,ll=nn(0),Tr=0,Oc=null,ro=0,sf=0,mp=0,Dc=null,Bn=null,xp=0,vp=1/0,Aa=null;function cl(){vp=Mr()+500}var of=!1,yp=null,ns=null,lf=!1,is=null,cf=0,Lc=0,_p=null,uf=-1,ff=0;function cn(){return vt&6?Mr():uf!==-1?uf:uf=Mr()}function as(l){return l.mode&1?vt&2&&Kr!==0?Kr&-Kr:b8.transition!==null?(ff===0&&(ff=jx()),ff):(l=Rt,l!==0?l:Ze()):1}function pi(l,c,h,y){if(50<Lc)throw Lc=0,_p=null,Error(s(185));_c(l,h,y),(!(vt&2)||l!==jr)&&(l===jr&&(!(vt&2)&&(sf|=h),Tr===4&&ss(l,Kr)),jn(l,y),h===1&&vt===0&&!(c.mode&1)&&(cl(),Nu&&ta()))}function jn(l,c){var h=l.callbackNode;E8(l,c);var y=Pu(l,l===jr?Kr:0);if(y===0)h!==null&&zx(h),l.callbackNode=null,l.callbackPriority=0;else if(c=y&-y,l.callbackPriority!==c){if(h!=null&&zx(h),c===1)l.tag===0?I8(n4.bind(null,l)):Vx(n4.bind(null,l)),Ct?Lr(function(){!(vt&6)&&ta()}):k1(E1,ta),h=null;else{switch(Ux(y)){case 1:h=E1;break;case 4:h=P8;break;case 16:h=C1;break;case 536870912:h=F8;break;default:h=C1}h=d4(h,r4.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function r4(l,c){if(uf=-1,ff=0,vt&6)throw Error(s(327));var h=l.callbackNode;if(ao()&&l.callbackNode!==h)return null;var y=Pu(l,l===jr?Kr:0);if(y===0)return null;if(y&30||y&l.expiredLanes||c)c=df(l,y);else{c=y;var E=vt;vt|=2;var F=s4();(jr!==l||Kr!==c)&&(Aa=null,cl(),no(l,c));do try{ek();break}catch(te){a4(l,te)}while(1);b1(),af.current=F,vt=E,yr!==null?c=0:(jr=null,Kr=0,c=Tr)}if(c!==0){if(c===2&&(E=_1(l),E!==0&&(y=E,c=Sp(l,E))),c===1)throw h=Oc,no(l,0),ss(l,y),jn(l,Mr()),h;if(c===6)ss(l,y);else{if(E=l.current.alternate,!(y&30)&&!J8(E)&&(c=df(l,y),c===2&&(F=_1(l),F!==0&&(y=F,c=Sp(l,F))),c===1))throw h=Oc,no(l,0),ss(l,y),jn(l,Mr()),h;switch(l.finishedWork=E,l.finishedLanes=y,c){case 0:case 1:throw Error(s(345));case 2:io(l,Bn,Aa);break;case 3:if(ss(l,y),(y&130023424)===y&&(c=xp+500-Mr(),10<c)){if(Pu(l,0)!==0)break;if(E=l.suspendedLanes,(E&y)!==y){cn(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=V(io.bind(null,l,Bn,Aa),c);break}io(l,Bn,Aa);break;case 4:if(ss(l,y),(y&4194240)===y)break;for(c=l.eventTimes,E=-1;0<y;){var j=31-Ri(y);F=1<<j,j=c[j],j>E&&(E=j),y&=~F}if(y=E,y=Mr()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*q8(y/1960))-y,10<y){l.timeoutHandle=V(io.bind(null,l,Bn,Aa),y);break}io(l,Bn,Aa);break;case 5:io(l,Bn,Aa);break;default:throw Error(s(329))}}}return jn(l,Mr()),l.callbackNode===h?r4.bind(null,l):null}function Sp(l,c){var h=Dc;return l.current.memoizedState.isDehydrated&&(no(l,c).flags|=256),l=df(l,c),l!==2&&(c=Bn,Bn=h,c!==null&&wp(c)),l}function wp(l){Bn===null?Bn=l:Bn.push.apply(Bn,l)}function J8(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var y=0;y<h.length;y++){var E=h[y],F=E.getSnapshot;E=E.value;try{if(!Ii(F(),E))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ss(l,c){for(c&=~mp,c&=~sf,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-Ri(c),y=1<<h;l[h]=-1,c&=~y}}function n4(l){if(vt&6)throw Error(s(327));ao();var c=Pu(l,0);if(!(c&1))return jn(l,Mr()),null;var h=df(l,c);if(l.tag!==0&&h===2){var y=_1(l);y!==0&&(c=y,h=Sp(l,y))}if(h===1)throw h=Oc,no(l,0),ss(l,c),jn(l,Mr()),h;if(h===6)throw Error(s(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,io(l,Bn,Aa),jn(l,Mr()),null}function i4(l){is!==null&&is.tag===0&&!(vt&6)&&ao();var c=vt;vt|=1;var h=pr.transition,y=Rt;try{if(pr.transition=null,Rt=1,l)return l()}finally{Rt=y,pr.transition=h,vt=c,!(vt&6)&&ta()}}function kp(){Yn=ll.current,Bt(ll)}function no(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==ge&&(l.timeoutHandle=ge,ie(h)),yr!==null)for(h=yr.return;h!==null;){var y=h;switch(P1(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Eu();break;case 3:al(),Bt(Dn),Bt(an),z1();break;case 5:j1(y);break;case 4:al();break;case 13:Bt(rr);break;case 19:Bt(rr);break;case 10:O1(y.type._context);break;case 22:case 23:kp()}h=h.return}if(jr=l,yr=l=os(l.current,null),Kr=Yn=c,Tr=0,Oc=null,mp=sf=ro=0,Bn=Dc=null,eo!==null){for(c=0;c<eo.length;c++)if(h=eo[c],y=h.interleaved,y!==null){h.interleaved=null;var E=y.next,F=h.pending;if(F!==null){var j=F.next;F.next=E,y.next=j}h.pending=y}eo=null}return l}function a4(l,c){do{var h=yr;try{if(b1(),zu.current=Wu,Vu){for(var y=nr.memoizedState;y!==null;){var E=y.queue;E!==null&&(E.pending=null),y=y.next}Vu=!1}if(to=0,Br=Cr=nr=null,Cc=!1,Tc=0,gp.current=null,h===null||h.return===null){Tr=1,Oc=c,yr=null;break}e:{var F=l,j=h.return,te=h,pe=c;if(c=Kr,te.flags|=32768,pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var Le=pe,Ke=te,ft=Ke.tag;if(!(Ke.mode&1)&&(ft===0||ft===11||ft===15)){var Ue=Ke.alternate;Ue?(Ke.updateQueue=Ue.updateQueue,Ke.memoizedState=Ue.memoizedState,Ke.lanes=Ue.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var Kt=Nv(j);if(Kt!==null){Kt.flags&=-257,Rv(Kt,j,te,F,c),Kt.mode&1&&Fv(F,Le,c),c=Kt,pe=Le;var Gt=c.updateQueue;if(Gt===null){var Un=new Set;Un.add(pe),c.updateQueue=Un}else Gt.add(pe);break e}else{if(!(c&1)){Fv(F,Le,c),Ep();break e}pe=Error(s(426))}}else if(qt&&te.mode&1){var Pa=Nv(j);if(Pa!==null){!(Pa.flags&65536)&&(Pa.flags|=256),Rv(Pa,j,te,F,c),R1(sl(pe,te));break e}}F=pe=sl(pe,te),Tr!==4&&(Tr=2),Dc===null?Dc=[F]:Dc.push(F),F=j;do{switch(F.tag){case 3:F.flags|=65536,c&=-c,F.lanes|=c;var fe=Av(F,pe,c);ev(F,fe);break e;case 1:te=pe;var re=F.type,ve=F.stateNode;if(!(F.flags&128)&&(typeof re.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(ns===null||!ns.has(ve)))){F.flags|=65536,c&=-c,F.lanes|=c;var ze=Pv(F,te,c);ev(F,ze);break e}}F=F.return}while(F!==null)}l4(h)}catch(rt){c=rt,yr===h&&h!==null&&(yr=h=h.return);continue}break}while(1)}function s4(){var l=af.current;return af.current=Wu,l===null?Wu:l}function Ep(){(Tr===0||Tr===3||Tr===2)&&(Tr=4),jr===null||!(ro&268435455)&&!(sf&268435455)||ss(jr,Kr)}function df(l,c){var h=vt;vt|=2;var y=s4();(jr!==l||Kr!==c)&&(Aa=null,no(l,c));do try{Z8();break}catch(E){a4(l,E)}while(1);if(b1(),vt=h,af.current=y,yr!==null)throw Error(s(261));return jr=null,Kr=0,Tr}function Z8(){for(;yr!==null;)o4(yr)}function ek(){for(;yr!==null&&!T8();)o4(yr)}function o4(l){var c=f4(l.alternate,l,Yn);l.memoizedProps=l.pendingProps,c===null?l4(l):yr=c,gp.current=null}function l4(l){var c=l;do{var h=c.alternate;if(l=c.return,c.flags&32768){if(h=X8(h,c),h!==null){h.flags&=32767,yr=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Tr=6,yr=null;return}}else if(h=$8(h,c,Yn),h!==null){yr=h;return}if(c=c.sibling,c!==null){yr=c;return}yr=c=l}while(c!==null);Tr===0&&(Tr=5)}function io(l,c,h){var y=Rt,E=pr.transition;try{pr.transition=null,Rt=1,tk(l,c,h,y)}finally{pr.transition=E,Rt=y}return null}function tk(l,c,h,y){do ao();while(is!==null);if(vt&6)throw Error(s(327));h=l.finishedWork;var E=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(s(177));l.callbackNode=null,l.callbackPriority=0;var F=h.lanes|h.childLanes;if(C8(l,F),l===jr&&(yr=jr=null,Kr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||lf||(lf=!0,d4(C1,function(){return ao(),null})),F=(h.flags&15990)!==0,h.subtreeFlags&15990||F){F=pr.transition,pr.transition=null;var j=Rt;Rt=1;var te=vt;vt|=4,gp.current=null,Y8(l,h),Qv(h,l),ce(l.containerInfo),l.current=h,Q8(h),A8(),vt=te,Rt=j,pr.transition=F}else l.current=h;if(lf&&(lf=!1,is=l,cf=E),F=l.pendingLanes,F===0&&(ns=null),N8(h.stateNode),jn(l,Mr()),c!==null)for(y=l.onRecoverableError,h=0;h<c.length;h++)E=c[h],y(E.value,{componentStack:E.stack,digest:E.digest});if(of)throw of=!1,l=yp,yp=null,l;return cf&1&&l.tag!==0&&ao(),F=l.pendingLanes,F&1?l===_p?Lc++:(Lc=0,_p=l):Lc=0,ta(),null}function ao(){if(is!==null){var l=Ux(cf),c=pr.transition,h=Rt;try{if(pr.transition=null,Rt=16>l?16:l,is===null)var y=!1;else{if(l=is,is=null,cf=0,vt&6)throw Error(s(331));var E=vt;for(vt|=4,We=l.current;We!==null;){var F=We,j=F.child;if(We.flags&16){var te=F.deletions;if(te!==null){for(var pe=0;pe<te.length;pe++){var Le=te[pe];for(We=Le;We!==null;){var Ke=We;switch(Ke.tag){case 0:case 11:case 15:Ic(8,Ke,F)}var ft=Ke.child;if(ft!==null)ft.return=Ke,We=ft;else for(;We!==null;){Ke=We;var Ue=Ke.sibling,Kt=Ke.return;if($v(Ke),Ke===Le){We=null;break}if(Ue!==null){Ue.return=Kt,We=Ue;break}We=Kt}}}var Gt=F.alternate;if(Gt!==null){var Un=Gt.child;if(Un!==null){Gt.child=null;do{var Pa=Un.sibling;Un.sibling=null,Un=Pa}while(Un!==null)}}We=F}}if(F.subtreeFlags&2064&&j!==null)j.return=F,We=j;else e:for(;We!==null;){if(F=We,F.flags&2048)switch(F.tag){case 0:case 11:case 15:Ic(9,F,F.return)}var fe=F.sibling;if(fe!==null){fe.return=F.return,We=fe;break e}We=F.return}}var re=l.current;for(We=re;We!==null;){j=We;var ve=j.child;if(j.subtreeFlags&2064&&ve!==null)ve.return=j,We=ve;else e:for(j=re;We!==null;){if(te=We,te.flags&2048)try{switch(te.tag){case 0:case 11:case 15:Ju(9,te)}}catch(rt){Jt(te,te.return,rt)}if(te===j){We=null;break e}var ze=te.sibling;if(ze!==null){ze.return=te.return,We=ze;break e}We=te.return}}if(vt=E,ta(),ea&&typeof ea.onPostCommitFiberRoot=="function")try{ea.onPostCommitFiberRoot(Fu,l)}catch{}y=!0}return y}finally{Rt=h,pr.transition=c}}return!1}function c4(l,c,h){c=sl(h,c),c=Av(l,c,1),l=rs(l,c,1),c=cn(),l!==null&&(_c(l,1,c),jn(l,c))}function Jt(l,c,h){if(l.tag===3)c4(l,l,h);else for(;c!==null;){if(c.tag===3){c4(c,l,h);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(ns===null||!ns.has(y))){l=sl(h,l),l=Pv(c,l,1),c=rs(c,l,1),l=cn(),c!==null&&(_c(c,1,l),jn(c,l));break}}c=c.return}}function rk(l,c,h){var y=l.pingCache;y!==null&&y.delete(c),c=cn(),l.pingedLanes|=l.suspendedLanes&h,jr===l&&(Kr&h)===h&&(Tr===4||Tr===3&&(Kr&130023424)===Kr&&500>Mr()-xp?no(l,0):mp|=h),jn(l,c)}function u4(l,c){c===0&&(l.mode&1?(c=Au,Au<<=1,!(Au&130023424)&&(Au=4194304)):c=1);var h=cn();l=ra(l,c),l!==null&&(_c(l,c,h),jn(l,h))}function nk(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),u4(l,h)}function ik(l,c){var h=0;switch(l.tag){case 13:var y=l.stateNode,E=l.memoizedState;E!==null&&(h=E.retryLane);break;case 19:y=l.stateNode;break;default:throw Error(s(314))}y!==null&&y.delete(c),u4(l,h)}var f4;f4=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||Dn.current)Mn=!0;else{if(!(l.lanes&h)&&!(c.flags&128))return Mn=!1,W8(l,c,h);Mn=!!(l.flags&131072)}else Mn=!1,qt&&c.flags&1048576&&Gx(c,Iu,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;Ku(l,c),l=c.pendingProps;var E=qo(c,an.current);nl(c,h),E=H1(null,c,y,l,E,h);var F=W1();return c.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ln(y)?(F=!0,Cu(c)):F=!1,c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,M1(c),E.updater=$u,c.stateNode=E,E._reactInternals=c,q1(c,y,l,h),c=tp(null,c,y,!0,F,h)):(c.tag=0,qt&&F&&A1(c),En(null,c,E,h),c=c.child),c;case 16:y=c.elementType;e:{switch(Ku(l,c),l=c.pendingProps,E=y._init,y=E(y._payload),c.type=y,E=c.tag=sk(y),l=Oi(y,l),E){case 0:c=ep(null,c,y,l,h);break e;case 1:c=Mv(null,c,y,l,h);break e;case 11:c=Iv(null,c,y,l,h);break e;case 14:c=bv(null,c,y,Oi(y.type,l),h);break e}throw Error(s(306,y,""))}return c;case 0:return y=c.type,E=c.pendingProps,E=c.elementType===y?E:Oi(y,E),ep(l,c,y,E,h);case 1:return y=c.type,E=c.pendingProps,E=c.elementType===y?E:Oi(y,E),Mv(l,c,y,E,h);case 3:e:{if(Bv(c),l===null)throw Error(s(387));y=c.pendingProps,F=c.memoizedState,E=F.element,Zx(l,c),ju(c,y,null,h);var j=c.memoizedState;if(y=j.element,tt&&F.isDehydrated)if(F={element:y,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},c.updateQueue.baseState=F,c.memoizedState=F,c.flags&256){E=sl(Error(s(423)),c),c=jv(l,c,y,h,E);break e}else if(y!==E){E=sl(Error(s(424)),c),c=jv(l,c,y,h,E);break e}else for(tt&&(ui=U(c.stateNode.containerInfo),Kn=c,qt=!0,bi=null,Sc=!1),h=Qx(c,null,y,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(el(),y===E){c=Ta(l,c,h);break e}En(l,c,y,h)}c=c.child}return c;case 5:return rv(c),l===null&&N1(c),y=c.type,E=c.pendingProps,F=l!==null?l.memoizedProps:null,j=E.children,Y(y,E)?j=null:F!==null&&Y(y,F)&&(c.flags|=32),Lv(l,c),En(l,c,j,h),c.child;case 6:return l===null&&N1(c),null;case 13:return Uv(l,c,h);case 4:return B1(c,c.stateNode.containerInfo),y=c.pendingProps,l===null?c.child=tl(c,null,y,h):En(l,c,y,h),c.child;case 11:return y=c.type,E=c.pendingProps,E=c.elementType===y?E:Oi(y,E),Iv(l,c,y,E,h);case 7:return En(l,c,c.pendingProps,h),c.child;case 8:return En(l,c,c.pendingProps.children,h),c.child;case 12:return En(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(y=c.type._context,E=c.pendingProps,F=c.memoizedProps,j=E.value,qx(c,y,j),F!==null)if(Ii(F.value,j)){if(F.children===E.children&&!Dn.current){c=Ta(l,c,h);break e}}else for(F=c.child,F!==null&&(F.return=c);F!==null;){var te=F.dependencies;if(te!==null){j=F.child;for(var pe=te.firstContext;pe!==null;){if(pe.context===y){if(F.tag===1){pe=Ca(-1,h&-h),pe.tag=2;var Le=F.updateQueue;if(Le!==null){Le=Le.shared;var Ke=Le.pending;Ke===null?pe.next=pe:(pe.next=Ke.next,Ke.next=pe),Le.pending=pe}}F.lanes|=h,pe=F.alternate,pe!==null&&(pe.lanes|=h),D1(F.return,h,c),te.lanes|=h;break}pe=pe.next}}else if(F.tag===10)j=F.type===c.type?null:F.child;else if(F.tag===18){if(j=F.return,j===null)throw Error(s(341));j.lanes|=h,te=j.alternate,te!==null&&(te.lanes|=h),D1(j,h,c),j=F.sibling}else j=F.child;if(j!==null)j.return=F;else for(j=F;j!==null;){if(j===c){j=null;break}if(F=j.sibling,F!==null){F.return=j.return,j=F;break}j=j.return}F=j}En(l,c,E.children,h),c=c.child}return c;case 9:return E=c.type,y=c.pendingProps.children,nl(c,h),E=fi(E),y=y(E),c.flags|=1,En(l,c,y,h),c.child;case 14:return y=c.type,E=Oi(y,c.pendingProps),E=Oi(y.type,E),bv(l,c,y,E,h);case 15:return Ov(l,c,c.type,c.pendingProps,h);case 17:return y=c.type,E=c.pendingProps,E=c.elementType===y?E:Oi(y,E),Ku(l,c),c.tag=1,Ln(y)?(l=!0,Cu(c)):l=!1,nl(c,h),Cv(c,y,E),q1(c,y,E,h),tp(null,c,y,!0,l,h);case 19:return Vv(l,c,h);case 22:return Dv(l,c,h)}throw Error(s(156,c.tag))};function d4(l,c){return k1(l,c)}function ak(l,c,h,y){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(l,c,h,y){return new ak(l,c,h,y)}function Cp(l){return l=l.prototype,!(!l||!l.isReactComponent)}function sk(l){if(typeof l=="function")return Cp(l)?1:0;if(l!=null){if(l=l.$$typeof,l===_)return 11;if(l===w)return 14}return 2}function os(l,c){var h=l.alternate;return h===null?(h=gi(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function hf(l,c,h,y,E,F){var j=2;if(y=l,typeof l=="function")Cp(l)&&(j=1);else if(typeof l=="string")j=5;else e:switch(l){case d:return so(h.children,E,F,c);case p:j=8,E|=8;break;case g:return l=gi(12,h,c,E|2),l.elementType=g,l.lanes=F,l;case C:return l=gi(13,h,c,E),l.elementType=C,l.lanes=F,l;case S:return l=gi(19,h,c,E),l.elementType=S,l.lanes=F,l;case T:return pf(h,E,F,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:j=10;break e;case m:j=9;break e;case _:j=11;break e;case w:j=14;break e;case x:j=16,y=null;break e}throw Error(s(130,l==null?l:typeof l,""))}return c=gi(j,h,c,E),c.elementType=l,c.type=y,c.lanes=F,c}function so(l,c,h,y){return l=gi(7,l,y,c),l.lanes=h,l}function pf(l,c,h,y){return l=gi(22,l,y,c),l.elementType=T,l.lanes=h,l.stateNode={isHidden:!1},l}function Tp(l,c,h){return l=gi(6,l,null,c),l.lanes=h,l}function Ap(l,c,h){return c=gi(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function ok(l,c,h,y,E){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ge,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S1(0),this.expirationTimes=S1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S1(0),this.identifierPrefix=y,this.onRecoverableError=E,tt&&(this.mutableSourceEagerHydrationData=null)}function h4(l,c,h,y,E,F,j,te,pe){return l=new ok(l,c,h,te,pe),c===1?(c=1,F===!0&&(c|=8)):c=0,F=gi(3,null,null,c),l.current=F,F.stateNode=l,F.memoizedState={element:y,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},M1(F),l}function p4(l){if(!l)return es;l=l._reactInternals;e:{if(I(l)!==l||l.tag!==1)throw Error(s(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ln(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(s(171))}if(l.tag===1){var h=l.type;if(Ln(h))return Mx(l,h,c)}return c}function g4(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=D(c),l===null?null:l.stateNode}function m4(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function gf(l,c){m4(l,c),(l=l.alternate)&&m4(l,c)}function lk(l){return l=D(l),l===null?null:l.stateNode}function ck(){return null}return r.attemptContinuousHydration=function(l){if(l.tag===13){var c=ra(l,134217728);if(c!==null){var h=cn();pi(c,l,134217728,h)}gf(l,134217728)}},r.attemptDiscreteHydration=function(l){if(l.tag===13){var c=ra(l,1);if(c!==null){var h=cn();pi(c,l,1,h)}gf(l,1)}},r.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=as(l),h=ra(l,c);if(h!==null){var y=cn();pi(h,l,c,y)}gf(l,c)}},r.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=yc(c.pendingLanes);h!==0&&(w1(c,h|1),jn(c,Mr()),!(vt&6)&&(cl(),ta()))}break;case 13:i4(function(){var y=ra(l,1);if(y!==null){var E=cn();pi(y,l,1,E)}}),gf(l,1)}},r.batchedUpdates=function(l,c){var h=vt;vt|=1;try{return l(c)}finally{vt=h,vt===0&&(cl(),Nu&&ta())}},r.createComponentSelector=function(l){return{$$typeof:Zu,value:l}},r.createContainer=function(l,c,h,y,E,F,j){return h4(l,c,!1,null,h,y,E,F,j)},r.createHasPseudoClassSelector=function(l){return{$$typeof:ef,value:l}},r.createHydrationContainer=function(l,c,h,y,E,F,j,te,pe){return l=h4(h,y,!0,l,E,F,j,te,pe),l.context=p4(null),h=l.current,y=cn(),E=as(h),F=Ca(y,E),F.callback=c??null,rs(h,F,E),l.current.lanes=E,_c(l,E,y),jn(l,y),l},r.createPortal=function(l,c,h){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:y==null?null:""+y,children:l,containerInfo:c,implementation:h}},r.createRoleSelector=function(l){return{$$typeof:tf,value:l}},r.createTestNameSelector=function(l){return{$$typeof:rf,value:l}},r.createTextSelector=function(l){return{$$typeof:nf,value:l}},r.deferredUpdates=function(l){var c=Rt,h=pr.transition;try{return pr.transition=null,Rt=16,l()}finally{Rt=c,pr.transition=h}},r.discreteUpdates=function(l,c,h,y,E){var F=Rt,j=pr.transition;try{return pr.transition=null,Rt=1,l(c,h,y,E)}finally{Rt=F,pr.transition=j,vt===0&&cl()}},r.findAllNodes=pp,r.findBoundingRects=function(l,c){if(!ye)throw Error(s(363));c=pp(l,c),l=[];for(var h=0;h<c.length;h++)l.push(Te(c[h]));for(c=l.length-1;0<c;c--){h=l[c];for(var y=h.x,E=y+h.width,F=h.y,j=F+h.height,te=c-1;0<=te;te--)if(c!==te){var pe=l[te],Le=pe.x,Ke=Le+pe.width,ft=pe.y,Ue=ft+pe.height;if(y>=Le&&F>=ft&&E<=Ke&&j<=Ue){l.splice(c,1);break}else if(y!==Le||h.width!==pe.width||Ue<F||ft>j){if(!(F!==ft||h.height!==pe.height||Ke<y||Le>E)){Le>y&&(pe.width+=Le-y,pe.x=y),Ke<E&&(pe.width=E-Le),l.splice(c,1);break}}else{ft>F&&(pe.height+=ft-F,pe.y=F),Ue<j&&(pe.height=j-ft),l.splice(c,1);break}}}return l},r.findHostInstance=g4,r.findHostInstanceWithNoPortals=function(l){return l=M(l),l=l!==null?he(l):null,l===null?null:l.stateNode},r.findHostInstanceWithWarning=function(l){return g4(l)},r.flushControlled=function(l){var c=vt;vt|=1;var h=pr.transition,y=Rt;try{pr.transition=null,Rt=1,l()}finally{Rt=y,pr.transition=h,vt=c,vt===0&&(cl(),ta())}},r.flushPassiveEffects=ao,r.flushSync=i4,r.focusWithin=function(l,c){if(!ye)throw Error(s(363));for(l=fp(l),c=t4(l,c),c=Array.from(c),l=0;l<c.length;){var h=c[l++];if(!Pe(h)){if(h.tag===5&&Ve(h.stateNode))return!0;for(h=h.child;h!==null;)c.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Rt},r.getFindAllNodesFailureDescription=function(l,c){if(!ye)throw Error(s(363));var h=0,y=[];l=[fp(l),0];for(var E=0;E<l.length;){var F=l[E++],j=l[E++],te=c[j];if((F.tag!==5||!Pe(F))&&(dp(F,te)&&(y.push(hp(te)),j++,j>h&&(h=j)),j<c.length))for(F=F.child;F!==null;)l.push(F,j),F=F.sibling}if(h<c.length){for(l=[];h<c.length;h++)l.push(hp(c[h]));return`findAllNodes was able to match part of the selector:
  `+(y.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},r.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return Z(l.child.stateNode);default:return l.child.stateNode}},r.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:lk,findFiberByHostInstance:l.findFiberByHostInstance||ck,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Fu=c.inject(l),ea=c}catch{}l=!!c.checkDCE}}return l},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(l,c,h,y){if(!ye)throw Error(s(363));l=pp(l,c);var E=Se(l,h,y).disconnect;return{disconnect:function(){E()}}},r.registerMutableSourceForHydration=function(l,c){var h=c._getVersion;h=h(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,h]:l.mutableSourceEagerHydrationData.push(c,h)},r.runWithPriority=function(l,c){var h=Rt;try{return Rt=l,c()}finally{Rt=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(l,c,h,y){var E=c.current,F=cn(),j=as(E);return h=p4(h),c.context===null?c.context=h:c.pendingContext=h,c=Ca(F,j),c.payload={element:l},y=y===void 0?null:y,y!==null&&(c.callback=y),l=rs(E,c,j),l!==null&&(pi(l,E,j,F),Bu(l,E,j)),j},r};d8.exports=QM;var qM=d8.exports;const JM=th(qM);var h8={exports:{}},Ko={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Ko.ConcurrentRoot=1;Ko.ContinuousEventPriority=4;Ko.DefaultEventPriority=16;Ko.DiscreteEventPriority=1;Ko.IdleEventPriority=536870912;Ko.LegacyRoot=0;h8.exports=Ko;var p8=h8.exports;const x5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let v5=!1,y5=!1;const Ox=".react-konva-event",ZM=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,eB=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,tB={};function v1(e,t,r=tB){if(!v5&&"zIndex"in t&&(console.warn(eB),v5=!0),!y5&&t.draggable){var n=t.x!==void 0||t.y!==void 0,i=t.onDragEnd||t.onDragMove;n&&!i&&(console.warn(ZM),y5=!0)}for(var a in r)if(!x5[a]){var s=a.slice(0,2)==="on",o=r[a]!==t[a];if(s&&o){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e.off(u,r[a])}var f=!t.hasOwnProperty(a);f&&e.setAttr(a,void 0)}var d=t._useStrictMode,p={},g=!1;const v={};for(var a in t)if(!x5[a]){var s=a.slice(0,2)==="on",m=r[a]!==t[a];if(s&&m){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t[a]&&(v[u]=t[a])}!s&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,p[a]=t[a])}g&&(e.setAttrs(p),Ys(e));for(var u in v)e.on(u+Ox,v[u])}function Ys(e){if(!gt.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const g8={},rB={};su.Node.prototype._applyProps=v1;function nB(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Ys(e)}function iB(e,t,r){let n=su[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=su.Group);const i={},a={};for(var s in t){var o=s.slice(0,2)==="on";o?a[s]=t[s]:i[s]=t[s]}const u=new n(i);return v1(u,a),u}function aB(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function sB(e,t,r){return!1}function oB(e){return e}function lB(){return null}function cB(){return null}function uB(e,t,r,n){return rB}function fB(){}function dB(e){}function hB(e,t){return!1}function pB(){return g8}function gB(){return g8}const mB=setTimeout,xB=clearTimeout,vB=-1;function yB(e,t){return!1}const _B=!1,SB=!0,wB=!0;function kB(e,t){t.parent===e?t.moveToTop():e.add(t),Ys(e)}function EB(e,t){t.parent===e?t.moveToTop():e.add(t),Ys(e)}function m8(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Ys(e)}function CB(e,t,r){m8(e,t,r)}function TB(e,t){t.destroy(),t.off(Ox),Ys(e)}function AB(e,t){t.destroy(),t.off(Ox),Ys(e)}function PB(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function FB(e,t,r){}function NB(e,t,r,n,i){v1(e,i,n)}function RB(e){e.hide(),Ys(e)}function IB(e){}function bB(e,t){(t.visible==null||t.visible)&&e.show()}function OB(e,t){}function DB(e){}function LB(){}const MB=()=>p8.DefaultEventPriority,BB=Object.freeze(Object.defineProperty({__proto__:null,appendChild:kB,appendChildToContainer:EB,appendInitialChild:nB,cancelTimeout:xB,clearContainer:DB,commitMount:FB,commitTextUpdate:PB,commitUpdate:NB,createInstance:iB,createTextInstance:aB,detachDeletedInstance:LB,finalizeInitialChildren:sB,getChildHostContext:gB,getCurrentEventPriority:MB,getPublicInstance:oB,getRootHostContext:pB,hideInstance:RB,hideTextInstance:IB,idlePriority:c0.unstable_IdlePriority,insertBefore:m8,insertInContainerBefore:CB,isPrimaryRenderer:_B,noTimeout:vB,now:c0.unstable_now,prepareForCommit:lB,preparePortalMount:cB,prepareUpdate:uB,removeChild:TB,removeChildFromContainer:AB,resetAfterCommit:fB,resetTextContent:dB,run:c0.unstable_runWithPriority,scheduleTimeout:mB,shouldDeprioritizeSubtree:hB,shouldSetTextContent:yB,supportsMutation:wB,unhideInstance:bB,unhideTextInstance:OB,warnsIfNotActing:SB},Symbol.toStringTag,{value:"Module"}));var jB=Object.defineProperty,UB=Object.defineProperties,zB=Object.getOwnPropertyDescriptors,_5=Object.getOwnPropertySymbols,VB=Object.prototype.hasOwnProperty,GB=Object.prototype.propertyIsEnumerable,S5=(e,t,r)=>t in e?jB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w5=(e,t)=>{for(var r in t||(t={}))VB.call(t,r)&&S5(e,r,t[r]);if(_5)for(var r of _5(t))GB.call(t,r)&&S5(e,r,t[r]);return e},HB=(e,t)=>UB(e,zB(t)),k5,E5;typeof window<"u"&&((k5=window.document)!=null&&k5.createElement||((E5=window.navigator)==null?void 0:E5.product)==="ReactNative")?ke.useLayoutEffect:ke.useEffect;function x8(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const i=x8(n,t,r);if(i)return i;n=t?null:n.sibling}}function v8(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const C5=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=C5;return}return C5.apply(this,arguments)};const Dx=v8(ke.createContext(null));class y8 extends ke.Component{render(){return ke.createElement(Dx.Provider,{value:this._reactInternals},this.props.children)}}function WB(){const e=ke.useContext(Dx);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=ke.useId();return ke.useMemo(()=>{for(const n of[e,e==null?void 0:e.alternate]){if(!n)continue;const i=x8(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===t)return!0;s=s.next}});if(i)return i}},[e,t])}function $B(){const e=WB(),[t]=ke.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==Dx&&!t.has(i)&&t.set(i,ke.useContext(v8(i)))}r=r.return}return t}function XB(){const e=$B();return ke.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>ke.createElement(t,null,ke.createElement(r.Provider,HB(w5({},n),{value:e.get(r)}))),t=>ke.createElement(y8,w5({},t))),[e])}function KB(e){const t=kr.useRef({});return kr.useLayoutEffect(()=>{t.current=e}),kr.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const YB=e=>{const t=kr.useRef(),r=kr.useRef(),n=kr.useRef(),i=KB(e),a=XB(),s=o=>{const{forwardedRef:u}=e;u&&(typeof u=="function"?u(o):u.current=o)};return kr.useLayoutEffect(()=>(r.current=new su.Stage({width:e.width,height:e.height,container:t.current}),s(r.current),n.current=l0.createContainer(r.current,p8.LegacyRoot,!1,null),l0.updateContainer(kr.createElement(a,{},e.children),n.current),()=>{su.isBrowser&&(s(null),l0.updateContainer(null,n.current,null),r.current.destroy())}),[]),kr.useLayoutEffect(()=>{s(r.current),v1(r.current,e,i),l0.updateContainer(kr.createElement(a,{},e.children),n.current,null)}),kr.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},QB="Layer",Qc="Group",Cn="Rect",qc="Circle",T5="Line",vi="Text",l0=JM(BB);l0.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:kr.version,rendererPackageName:"react-konva"});const qB=kr.forwardRef((e,t)=>kr.createElement(y8,{},kr.createElement(YB,{...e,forwardedRef:t}))),Jc=[{level:0,threshold:.1,description:"Ultra Low - Package outline only"},{level:1,threshold:.3,description:"Low - Package + major banks"},{level:2,threshold:.7,description:"Medium - + pin circles"},{level:3,threshold:1.5,description:"High - + pin/signal names"},{level:4,threshold:1/0,description:"Ultra High - All details"}];function JB(e){for(let t=0;t<Jc.length;t++)if(e<Jc[t].threshold)return Jc[t].level;return Jc[Jc.length-1].level}function ZB(e,t){return e>=t}function ej(e){switch(e){case 0:return 1;case 1:return .8;case 2:return .6;case 3:return .4;case 4:return .2;default:return .5}}function tj(e){switch(e){case 0:return 50;case 1:return 200;case 2:return 500;case 3:return 1e3;case 4:return 5e3;default:return 1e3}}function rj(e,t="pin"){return e>={pin:.7,signal:.7,bank:.3}[t]}function nj(e,t=12){if(e<.5)return 0;const r=t*Math.min(e,2);return Math.max(8,Math.min(r,24))}function ij(e){return e>=.3}function aj(e){return e>=.7}class Gn{}Gn.getLODLevel=JB;Gn.shouldRenderAtLOD=ZB;Gn.getPerformanceMultiplier=ej;Gn.getMaxElements=tj;Gn.shouldRenderText=rj;Gn.getAdaptiveTextSize=nj;Gn.shouldRenderDifferentialPairs=ij;Gn.shouldRenderPinDetails=aj;class zr{static createVirtualizedPinList(t,r,n){const i=Math.ceil(r/n)+5;return{getVisibleRange:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length);return{startIndex:s,endIndex:o}},getVisiblePins:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length),{startIndex:u,endIndex:f}={startIndex:s,endIndex:o};return t.slice(u,f).map((d,p)=>({pin:d,index:u+p,top:(u+p)*n}))},getTotalHeight:()=>t.length*n}}static createDebouncedSearch(t,r=300){let n,i=[];return{search:a=>new Promise(s=>{if(clearTimeout(n),!a.trim()){s([]);return}n=setTimeout(()=>{i=t(a),s(i)},r)}),getLastResults:()=>i,cancel:()=>{clearTimeout(n)}}}static optimizeCanvasRendering(){return{getLODLevel:t=>t<.3?"ultra-low":t<.6?"low":t<1.2?"medium":t<2.5?"high":"ultra-high",cullPins:(t,r)=>{const i={left:r.x-100,right:r.x+r.width+100,top:r.y-100,bottom:r.y+r.height+100};return t.filter(a=>{const s=a.position.x*r.scale,o=a.position.y*r.scale;return s>=i.left&&s<=i.right&&o>=i.top&&o<=i.bottom})},batchDOMUpdates:t=>{requestAnimationFrame(()=>{t.forEach(r=>r())})}}}static createPinIndexes(t){const r=new Map,n=new Map,i=new Map,a=new Map,s=new Map;return t.forEach(o=>{r.set(o.id,o),n.set(o.pinNumber,o),o.signalName&&(i.has(o.signalName)||i.set(o.signalName,[]),i.get(o.signalName).push(o)),o.bank&&(a.has(o.bank)||a.set(o.bank,[]),a.get(o.bank).push(o)),s.has(o.pinType)||s.set(o.pinType,[]),s.get(o.pinType).push(o)}),{byId:r,byPinNumber:n,bySignalName:i,byBank:a,byPinType:s,findById:o=>r.get(o),findByPinNumber:o=>n.get(o),findBySignalName:o=>i.get(o)||[],findByBank:o=>a.get(o)||[],findByPinType:o=>s.get(o)||[]}}static startRenderMeasurement(t){this.renderMetrics.set(t,performance.now())}static endRenderMeasurement(t){const r=this.renderMetrics.get(t);if(!r)return 0;const n=performance.now()-r;return this.renderMetrics.delete(t),n}static trackFrameRate(){this.frameCount++;const t=performance.now();if(t-this.lastFrameTime>=1e3){const r=this.frameCount/((t-this.lastFrameTime)/1e3);return this.frameCount=0,this.lastFrameTime=t,r}return null}static createSmartFilter(t){return{filter:(r,n)=>{const i=[];for(const a of t){if(n&&i.length>=n)break;let s=!0;for(const o of r)if(!o(a)){s=!1;break}s&&i.push(a)}return i}}}static createPinSearchRanker(){return{rankPins:(t,r)=>{const n=r.toLowerCase(),i=[];return t.forEach(a=>{let s=0;a.pinNumber.toLowerCase()===n?s+=100:a.pinNumber.toLowerCase().startsWith(n)?s+=80:a.pinNumber.toLowerCase().includes(n)&&(s+=40),a.signalName&&a.signalName.toLowerCase().includes(n)&&(s+=60),a.pinName.toLowerCase().includes(n)&&(s+=30),a.bank&&a.bank.toLowerCase().includes(n)&&(s+=20),s>0&&i.push({pin:a,score:s})}),i.sort((a,s)=>s.score-a.score)}}}}zr.renderMetrics=new Map;zr.frameCount=0;zr.lastFrameTime=performance.now();const sj=({fileName:e,viewInfo:t})=>k.jsxs("div",{style:{width:"100%",height:"32px",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0 16px",position:"relative",zIndex:2,color:"#e0e0e0",fontSize:"12px",fontWeight:500,boxSizing:"border-box",borderBottom:"1px solid #333"},children:[k.jsx("span",{style:{transform:"translateY(-2px)"},children:t}),k.jsx("span",{style:{transform:"translateY(-2px)",marginLeft:"360px"},children:e})]}),oj=({package:e,pins:t,selectedPins:r,onPinSelect:n,onPinDoubleClick:i,zoom:a,rotation:s,isTopView:o,onZoomChange:u,resetTrigger:f=0})=>{const{togglePinSelection:d,selectPins:p,visibleBanks:g,toggleBankVisibility:v,showAllBanks:m}=Yi(),_=ke.useRef(null),C=ke.useRef(null),[S,w]=ke.useState({width:window.innerWidth,height:window.innerHeight-32}),[x,T]=ke.useState(null),[A,N]=ke.useState({x:0,y:0,scale:1}),[R,P]=ke.useState(!1),[I,b]=ke.useState({x:0,y:0}),[M,D]=ke.useState(0),[Q,he]=ke.useState({x:0,y:0});console.log(`📦 PackageCanvas: Received ${t.length} pins (filtered)`);const z=Gn.getLODLevel(A.scale),Z=ke.useMemo(()=>{zr.startRenderMeasurement("pin-indexing");const ye=zr.createPinIndexes(t);return zr.endRenderMeasurement("pin-indexing"),ye},[t]),ae=ke.useMemo(()=>{zr.startRenderMeasurement("viewport-culling");const ye=S.width,xe=S.height,Te=.2,Ae=ye*Te/A.scale,Pe=xe*Te/A.scale,Oe={x:-A.x/A.scale-ye/(2*A.scale)-Ae,y:-A.y/A.scale-xe/(2*A.scale)-Pe,width:ye/A.scale+Ae*2,height:xe/A.scale+Pe*2,scale:A.scale},Ve=(Se,J)=>{if(!Se.position)return console.warn("📦 Pin missing position:",Se.pinName||Se.pinNumber),!1;let{x:Ee,y:Fe}=Se.position;if(s!==0){const Ce=s*Math.PI/180,Qe=Math.cos(Ce),et=Math.sin(Ce),lt=Ee*Qe-Fe*et,Ye=Ee*et+Fe*Qe;Ee=lt,Fe=Ye}return o||(Ee=-Ee),Ee>=J.x&&Ee<=J.x+J.width&&Fe>=J.y&&Fe<=J.y+J.height};if(A.scale>.6){const Se=300/A.scale,J={...Oe,x:Oe.x-Se*1.5,y:Oe.y-Se*3,width:Oe.width+Se*3,height:Oe.height+Se*6},Ee=Array.from(r).map(et=>Z.findById(et)).filter(Boolean),Fe=t.filter(et=>Ve(et,J)),Ce=new Map;Fe.forEach(et=>Ce.set(et.id,et)),Ee.forEach(et=>Ce.set(et.id,et));const Qe=Array.from(Ce.values());return console.log(`🔍 高ズーム時カリング: ${Qe.length}/${t.length} pins visible (scale: ${A.scale.toFixed(2)})`),console.log("📐 Extended bounds:",J),zr.endRenderMeasurement("viewport-culling"),Qe}else{if(A.scale<=.2)return zr.endRenderMeasurement("viewport-culling"),t;if(A.scale<=.4){const J=new Map;t.forEach(Ce=>{const Qe=Ce.bank||"NA";J.has(Qe)||J.set(Qe,[]),J.get(Qe).push(Ce)});const Ee=[],Fe=Array.from(r).map(Ce=>Z.findById(Ce)).filter(Boolean);return Ee.push(...Fe),J.forEach(Ce=>{const Qe=Math.max(1,Math.floor(Ce.length*.85)),et=Math.max(1,Math.floor(Ce.length/Qe));for(let lt=0;lt<Ce.length;lt+=et){const Ye=Ce[lt];r.has(Ye.id)||Ee.push(Ye)}}),zr.endRenderMeasurement("viewport-culling"),Ee}else if(A.scale<=.6){const Se=400/A.scale,J={x:Oe.x-Se*1.5,y:Oe.y-Se*2.5,width:Oe.width+Se*3,height:Oe.height+Se*5},Ee=Array.from(r).map(xt=>Z.findById(xt)).filter(Boolean),Fe=t.filter(xt=>Ve(xt,J)),Ce=t.filter(xt=>!Fe.some(si=>si.id===xt.id)&&!r.has(xt.id)),Qe=Math.max(1,Math.floor(Ce.length/200)),et=Ce.filter((xt,si)=>si%Qe===0),lt=new Map;Ee.forEach(xt=>lt.set(xt.id,xt)),Fe.forEach(xt=>lt.set(xt.id,xt)),et.forEach(xt=>lt.set(xt.id,xt));const Ye=Array.from(lt.values());return zr.endRenderMeasurement("viewport-culling"),Ye}else{const Se=new Map;t.forEach(Fe=>{const Ce=Fe.bank||"NA";Se.has(Ce)||Se.set(Ce,[]),Se.get(Ce).push(Fe)});const J=Math.max(10,Math.floor(800/Se.size)),Ee=[];return Se.forEach(Fe=>{const Ce=Fe.filter(et=>r.has(et.id));Ee.push(...Ce);const Qe=J-Ce.length;if(Qe>0){const et=Fe.filter(Ye=>!r.has(Ye.id)),lt=Math.max(1,Math.floor(et.length/Qe));for(let Ye=0;Ye<et.length&&Ee.length-Ce.length<Qe;Ye+=lt)Ee.push(et[Ye])}}),zr.endRenderMeasurement("viewport-culling"),Ee}}},[t,A,r,S,Z]),ne=200,K=8,ce=(ye,xe)=>{if(xe.ctrlKey||xe.metaKey)d(ye),T(ye);else if(xe.shiftKey&&x){const Te=t.findIndex(Pe=>Pe.id===ye),Ae=t.findIndex(Pe=>Pe.id===x);if(Te!==-1&&Ae!==-1){const Pe=Math.min(Te,Ae),Oe=Math.max(Te,Ae),Ve=t.slice(Pe,Oe+1).map(J=>J.id),Se=new Set(r);Ve.forEach(J=>Se.add(J)),p(Array.from(Se))}}else n(ye),T(ye)};ke.useEffect(()=>{var Ae,Pe;const ye=()=>{var Ve;if((Ve=_.current)==null?void 0:Ve.container()){const J={width:window.innerWidth,height:window.innerHeight-32};w(Ee=>Ee.width!==J.width||Ee.height!==J.height?(console.log("📐 Canvas size updated for dynamic maximization (excluding header):",J),_.current&&(_.current.width(J.width),_.current.height(J.height),_.current.getLayer().batchDraw()),J):Ee)}},xe=setTimeout(()=>{ye()},200),Te=(Pe=(Ae=_.current)==null?void 0:Ae.container())==null?void 0:Pe.parentElement;if(Te){const Oe=new ResizeObserver(()=>{C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{ye()},16)});Oe.observe(Te);const Ve=()=>{ye()};return window.addEventListener("resize",Ve),()=>{clearTimeout(xe),C.current&&clearTimeout(C.current),Oe.disconnect(),window.removeEventListener("resize",Ve)}}return()=>{clearTimeout(xe)}},[]),ke.useEffect(()=>{if(e&&t.length>0&&S.width>0&&S.height>0){const ye=Y();if(ye){const{width:xe,height:Te,centerX:Ae,centerY:Pe}=ye,Oe=0,Ve=S.width-Oe*2,Se=S.height-Oe*2,J=Ve/xe,Ee=Se/Te,Fe=Math.max(.8,Math.min(J,Ee,2)),Ce={x:S.width/2,y:S.height/2+30},Qe={x:Ce.x-Ae*Fe,y:Ce.y-Pe*Fe,scale:Fe};console.log("📐 Auto-fit viewport:",Qe,"for package:",xe,"x",Te,"scale:",Fe),N(Qe)}}},[e,t.length,S]);const me=ye=>{var xe;return ye.pinType==="GROUND"||ye.pinName==="GND"?vo("GROUND"):ye.pinType==="POWER"||(xe=ye.pinName)!=null&&xe.includes("VCC")?vo("POWER"):vo(ye.bank)},L=ye=>({IO:"#FFF",CONFIG:"#FFD700",POWER:"#FF4500",GROUND:"#000",MGT:"#9B4AE2",CLOCK:"#FF69B4",ADC:"#00FFFF",SPECIAL:"#FF1493",MIO:"#32CD32",DDR:"#8A2BE2",NC:"#696969",RESERVED:"#999999"})[ye.pinType]||"#FFF",ee=(ye,xe,Te)=>{if(!Ht||typeof Ht.isDifferentialPin!="function"||!Ht.isDifferentialPin(ye))return null;const Ae=Ht.findPairPin(ye,xe);if(!Ae)return null;const Pe=Te.has(ye.id),Oe=Te.has(Ae.id);return Pe||Oe?(Ht.getDifferentialPairType(ye.pinName)||(ye.signalName?Ht.getDifferentialPairType(ye.signalName):null))==="positive"?"#FF3333":"#FF9933":null},q=(ye,xe)=>!Ht||typeof Ht.isDifferentialPin!="function"||!Ht.isDifferentialPin(ye)?!1:Ht.findPairPin(ye,xe)!==null,Y=()=>{if(!e||t.length===0)return{width:600,height:600,centerX:300,centerY:300,minX:0,minY:0,maxX:600,maxY:600};const ye=t.map(Ye=>{var xt;return(xt=Ye.gridPosition)==null?void 0:xt.row}).filter(Boolean),xe=t.map(Ye=>{var xt;return(xt=Ye.gridPosition)==null?void 0:xt.col}).filter(Boolean);console.log(`🔍 Found rows: ${ye.join(", ")}`);const Te=Math.min(...ye.map(Ye=>Os(Ye))),Ae=Math.max(...ye.map(Ye=>Os(Ye))),Pe=Math.min(...xe),Oe=Math.max(...xe);console.log(`🔍 Row indices - min: ${Te} (${fl(Te)}), max: ${Ae} (${fl(Ae)})`),console.log(`🔍 Col indices - min: ${Pe}, max: ${Oe}`);const Se=88,J=(Oe-Pe+1)*Se,Ee=(Ae-Te+1)*Se,Fe=0,Ce=J+Fe*2,Qe=Ee+Fe*2,et=(Pe+Oe-1)*Se/2,lt=(Te+Ae)*Se/2;return{width:Ce,height:Qe,centerX:et,centerY:lt,minX:(Pe-1)*Se,minY:Te*Se,maxX:Oe*Se,maxY:(Ae+1)*Se,gridSpacing:Se,minRow:Te,maxRow:Ae,minCol:Pe,maxCol:Oe}},de=Y();ke.useEffect(()=>{t.length>0&&console.log("📦 PackageCanvas: Package loaded with",t.length,"pins")},[t.length]);const V=ye=>{let{x:xe,y:Te}=ye.position;if(s!==0){const Se=s*Math.PI/180,J=Math.cos(Se),Ee=Math.sin(Se),Fe=xe*J-Te*Ee,Ce=xe*Ee+Te*J;xe=Fe,Te=Ce}o||(xe=-xe);const Ae=S.width,Pe=S.height,Oe=xe*A.scale+A.x+Ae/2,Ve=Te*A.scale+A.y+Pe/2;return{x:Oe,y:Ve}},ie=(ye,xe)=>{const Te=Y(),Ae=Te.width*xe,Pe=Te.height*xe,Oe=S.width,Ve=S.height,Se=Oe*.5,J=Ve*.8,Ee=-(Ae/2+Se),Fe=Ae/2+Se,Ce=-(Pe/2+J*1.5),Qe=Pe/2+J;return{x:Math.max(Ee,Math.min(Fe,ye.x)),y:Math.max(Ce,Math.min(Qe,ye.y))}},ge=ye=>{ye.evt.preventDefault();const xe=_.current;if(!xe)return;const Te=xe.getPointerPosition(),Ae=1.05;if(ye.evt.ctrlKey){const Pe=A.scale,Oe=ye.evt.deltaY>0?Pe/Ae:Pe*Ae,Ve=Math.max(.1,Math.min(5,Oe)),Se={x:(Te.x-A.x)/Pe,y:(Te.y-A.y)/Pe},J={x:Te.x-Se.x*Ve,y:Te.y-Se.y*Ve},Ee=ie(J,Ve);N({scale:Ve,x:Ee.x,y:Ee.y}),u==null||u(Ve)}else{const Pe=A.y-ye.evt.deltaY*.5,Oe=ie({x:A.x,y:Pe},A.scale);N(Ve=>({...Ve,x:Oe.x,y:Oe.y}))}},_e=()=>{const ye=_.current;if(!ye)return;const xe=ye.getPointerPosition(),Te=Date.now();D(Te),he(xe),b(xe),P(!1)},Me=()=>{const ye=_.current;if(!ye)return;const xe=ye.getPointerPosition(),Te=Date.now();if(!R&&M>0){const Ae=Te-M,Pe=Math.sqrt(Math.pow(xe.x-Q.x,2)+Math.pow(xe.y-Q.y,2));(Ae>ne||Pe>K)&&P(!0)}if(R){const Ae=xe.x-I.x,Pe=xe.y-I.y,Oe={x:A.x+Ae,y:A.y+Pe},Ve=ie(Oe,A.scale);N(Se=>({...Se,x:Ve.x,y:Ve.y}))}b(xe)},H=()=>{P(!1),D(0)},tt=()=>{P(!1),D(0)},nt=()=>{N({x:0,y:0,scale:1}),u==null||u(1)};ke.useEffect(()=>{Math.abs(a-1)<.001?N({x:0,y:0,scale:1}):N(ye=>({...ye,scale:a}))},[a,f]),ke.useEffect(()=>{const ye=xe=>{(xe.key==="r"||xe.key==="R")&&nt()};return window.addEventListener("keydown",ye),()=>window.removeEventListener("keydown",ye)},[]);const Xe=(ye,xe)=>{const Te=Date.now();if(M>0){const Ae=Te-M,Pe=_.current;if(Pe&&Ae<ne){const Oe=Pe.getPointerPosition();Math.sqrt(Math.pow(Oe.x-Q.x,2)+Math.pow(Oe.y-Q.y,2))<K&&!R&&(ye.cancelBubble=!0,ce(xe.id,ye.evt))}}},Ze=(ye,xe)=>{ye.cancelBubble=!0,i(xe.id)},be=ye=>{const xe=Date.now();if(!R&&M>0){const Te=xe-M,Ae=_.current;if(Ae&&Te<ne){const Pe=Ae.getPointerPosition();Math.sqrt(Math.pow(Pe.x-Q.x,2)+Math.pow(Pe.y-Q.y,2))<K&&ye.target===ye.target.getStage()&&n("")}}};if(!e)return k.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"No package loaded. Please import a CSV file."});if(S.width<=0||S.height<=0)return k.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"Loading canvas..."});const Ct=`View: ${o?"TOP":"BOTTOM"} | Rotation: ${s}° | Zoom: ${Math.round(a*100)}%`,Lr=e?`${e.device}pkg.csv (${e.packageType})`:"No package loaded";return k.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column"},children:[k.jsx(sj,{fileName:Lr,viewInfo:Ct}),k.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[k.jsx("div",{style:{position:"absolute",top:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:ye,minCol:xe,maxCol:Te,minRow:Ae,maxRow:Pe}=de;if(!ye)return null;const Oe=[];if(s===0||s===180)for(let Se=xe;Se<=Te;Se++){const J=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===Se);if(!J)continue;const Fe={left:V(J).x-10,top:-5};Fe.left>=-50&&Fe.left<=S.width+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:Se},`top-col-${Se}`))}else for(let Se=Ae;Se<=Pe;Se++){const J=fl(Se),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===J);if(!Ee)continue;const Ce={left:V(Ee).x-10,top:-5};Ce.left>=-50&&Ce.left<=S.width+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:J},`top-row-${Se}`))}return Oe})()}),k.jsx("div",{style:{position:"absolute",top:16,right:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:ye,minCol:xe,maxCol:Te,minRow:Ae,maxRow:Pe}=de;if(!ye)return null;const Oe=[];if(s===0||s===180)for(let Se=Ae;Se<=Pe;Se++){const J=fl(Se),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===J);if(!Ee)continue;const Ce={left:-5,top:V(Ee).y-8};Ce.top>=-50&&Ce.top<=S.height+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:J},`right-row-${Se}`))}else for(let Se=xe;Se<=Te;Se++){const J=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===Se);if(!J)continue;const Fe={left:-5,top:V(J).y-8};Fe.top>=-50&&Fe.top<=S.height+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:Se},`right-col-${Se}`))}return Oe})()}),k.jsx("div",{style:{position:"absolute",bottom:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:ye,minCol:xe,maxCol:Te,minRow:Ae,maxRow:Pe}=de;if(!ye)return null;const Oe=[];if(s===0||s===180)for(let Se=xe;Se<=Te;Se++){const J=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===Se);if(!J)continue;const Fe={left:V(J).x-10,top:-5};Fe.left>=-50&&Fe.left<=S.width+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:Se},`bottom-col-${Se}`))}else for(let Se=Ae;Se<=Pe;Se++){const J=fl(Se),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===J);if(!Ee)continue;const Ce={left:V(Ee).x-10,top:-5};Ce.left>=-50&&Ce.left<=S.width+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:J},`bottom-row-${Se}`))}return Oe})()}),k.jsx("div",{style:{position:"absolute",top:16,left:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:ye,minCol:xe,maxCol:Te,minRow:Ae,maxRow:Pe}=de;if(!ye)return null;const Oe=[];if(s===0||s===180)for(let Se=Ae;Se<=Pe;Se++){const J=fl(Se),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===J);if(!Ee)continue;const Ce={left:-5,top:V(Ee).y-8};Ce.top>=-50&&Ce.top<=S.height+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:J},`left-row-${Se}`))}else for(let Se=xe;Se<=Te;Se++){const J=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===Se);if(!J)continue;const Fe={left:-5,top:V(J).y-8};Fe.top>=-50&&Fe.top<=S.height+50&&Oe.push(k.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:Se},`left-col-${Se}`))}return Oe})()}),k.jsx("div",{style:{position:"absolute",top:16,left:16,right:16,bottom:16,overflow:"hidden"},children:k.jsx(qB,{ref:ye=>{_.current=ye},width:window.innerWidth,height:window.innerHeight,x:0,y:0,onClick:be,onWheel:ge,onMouseDown:_e,onMouseMove:Me,onMouseUp:H,onMouseLeave:tt,style:{cursor:R?"grabbing":"grab"},children:k.jsxs(QB,{children:[(()=>{const{gridSpacing:ye,minRow:xe,maxRow:Te,minCol:Ae,maxCol:Pe}=de;if(!ye)return null;const Oe=(Ce,Qe)=>V({position:{x:Ce,y:Qe}}),Ve=0,Se=Oe((Ae-1.5)*ye-Ve,(xe-.5)*ye-Ve),J=Oe((Pe+.5)*ye+Ve,(xe-.5)*ye-Ve),Ee=Oe((Ae-1.5)*ye-Ve,(Te+.5)*ye+Ve),Fe=Oe((Pe+.5)*ye+Ve,(Te+.5)*ye+Ve);return k.jsx(k.Fragment,{children:k.jsx(T5,{points:[Se.x,Se.y,J.x,J.y,Fe.x,Fe.y,Ee.x,Ee.y,Se.x,Se.y],stroke:"#555",strokeWidth:2,dash:[5,5],closed:!0,fill:"rgba(40, 40, 40, 0.3)"})})})(),!1,(()=>{zr.startRenderMeasurement("pin-rendering");const xe=Math.max(20,88*A.scale),Te=A.scale>=.7,Ae=Gn.shouldRenderText(A.scale,"pin"),Pe=Gn.shouldRenderText(A.scale,"signal"),Oe=Gn.getAdaptiveTextSize(A.scale,12)/12,Ve=ae,Se=zr.endRenderMeasurement("pin-rendering");return console.log(`🎯 Smart culling: Rendering ${Ve.length}/${t.length} pins (${Se.toFixed(2)}ms)`),Ve.map(J=>{var qe,Ge,Je,ut,Pt,Ot,kn,tn;const Ee=V(J),Fe=r&&r.has?r.has(J.id):!1,Ce=me(J),Qe=L(J),et=A.scale*10*Oe,lt=Math.max(8,Math.min(20,et)),Ye=Math.max(6,Math.min(16,A.scale*8*Oe)),xt=ee(J,ae,r),si=q(J,t),Ie=Te||Fe;return k.jsxs(Qc,{children:[k.jsx(Cn,{x:Ee.x-xe/2,y:Ee.y-xe/2,width:xe,height:xe,fill:Ce,stroke:"#000",strokeWidth:1,cornerRadius:4,onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"}}),xt&&k.jsx(Cn,{x:Ee.x-xe/2-2,y:Ee.y-xe/2-2,width:xe+4,height:xe+4,fill:"transparent",stroke:xt,strokeWidth:2,cornerRadius:6,listening:!1}),k.jsx(qc,{x:Ee.x,y:Ee.y,radius:Math.max(8,xe*.3),fill:Qe,stroke:"#000",strokeWidth:1,listening:!1}),si&&!xt&&xe>40&&k.jsx(qc,{x:Ee.x+xe*.3,y:Ee.y-xe*.3,radius:3,fill:"#FF6600",stroke:"#FFF",strokeWidth:1,listening:!1}),xt&&k.jsx(qc,{x:Ee.x,y:Ee.y,radius:Math.max(10,xe*.4),fill:"transparent",stroke:xt,strokeWidth:3,listening:!1,dash:[5,5]}),k.jsx(Cn,{x:Ee.x-J.pinNumber.length*lt/4-2,y:Ee.y-lt/2-2,width:J.pinNumber.length*lt/2+4,height:lt+4,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:Ee.x,y:Ee.y-lt/2,text:J.pinNumber,fontSize:lt,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"},fontStyle:"bold",offsetX:J.pinNumber.length*lt/4,listening:!1}),J.pinName&&Ie&&Ae&&xe>50&&k.jsxs(k.Fragment,{children:[k.jsx(Cn,{x:Ee.x-(J.pinName.length>14?17:J.pinName.length)*Ye/4-2,y:Ee.y+lt/2+1,width:(J.pinName.length>14?17:J.pinName.length)*Ye/2+4,height:Ye+4,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3,text:J.pinName.length>14?J.pinName.substring(0,14)+"...":J.pinName,fontSize:Ye,fill:"#E0E0E0",align:"center",onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"},offsetX:(J.pinName.length>14?17:J.pinName.length)*Ye/4,listening:!1})]}),J.signalName&&J.signalName.trim()!==""&&Pe&&k.jsxs(k.Fragment,{children:[k.jsx(Cn,{x:Ee.x-(J.signalName.length>12?15:J.signalName.length)*Ye*.35-6,y:Ee.y+lt/2+3+Ye-1,width:(J.signalName.length>12?15:J.signalName.length)*Ye*.7+12,height:Ye+6,fill:"rgba(255, 215, 0, 0.9)",cornerRadius:3,listening:!1}),k.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+Ye+2,text:J.signalName.length>12?J.signalName.substring(0,12)+"...":J.signalName,fontSize:Ye,fill:"#000",align:"center",onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(J.signalName.length>12?15:J.signalName.length)*Ye/4,listening:!1})]}),!["POWER","GROUND","NC"].includes(J.pinType)&&Pe&&xe>40&&k.jsxs(k.Fragment,{children:[J.direction&&J.direction.trim()!==""&&k.jsxs(k.Fragment,{children:[k.jsx(Cn,{x:Ee.x-J.direction.length*(Ye*.6)/2-4,y:Ee.y+lt/2+3+(J.signalName?Ye*2+6:Ye+4),width:J.direction.length*(Ye*.6)+8,height:Ye+3,fill:"rgba(100, 149, 237, 0.8)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+(J.signalName?Ye*2+8:Ye+6),text:J.direction,fontSize:Ye*.8,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"},fontStyle:"bold",offsetX:J.direction.length*(Ye*.6)/4,listening:!1})]}),(((qe=J.attributes)==null?void 0:qe.IO_Standard)||J.ioType)&&(((Ge=J.attributes)==null?void 0:Ge.IO_Standard)||J.ioType||"").trim()!==""&&k.jsxs(k.Fragment,{children:[k.jsx(Cn,{x:Ee.x-(((Je=J.attributes)==null?void 0:Je.IO_Standard)||J.ioType||"AUTO").length*(Ye*.5)/2-3,y:Ee.y+lt/2+3+(J.signalName?J.direction&&J.direction.trim()!==""?Ye*3+12:Ye*2+6:J.direction&&J.direction.trim()!==""?Ye*2+8:Ye+4),width:(((ut=J.attributes)==null?void 0:ut.IO_Standard)||J.ioType||"AUTO").length*(Ye*.5)+6,height:Ye*.9+2,fill:"rgba(76, 175, 80, 0.8)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+(J.signalName?J.direction&&J.direction.trim()!==""?Ye*3+13:Ye*2+7:J.direction&&J.direction.trim()!==""?Ye*2+9:Ye+5),text:(((Pt=J.attributes)==null?void 0:Pt.IO_Standard)||J.ioType||"AUTO").length>8?(((Ot=J.attributes)==null?void 0:Ot.IO_Standard)||J.ioType||"AUTO").substring(0,8)+"...":((kn=J.attributes)==null?void 0:kn.IO_Standard)||J.ioType||"AUTO",fontSize:Ye*.7,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,J),onDblClick:mt=>Ze(mt,J),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(((tn=J.attributes)==null?void 0:tn.IO_Standard)||J.ioType||"AUTO").length*(Ye*.5)/4,listening:!1})]})]})]},J.id)})})(),Gn.shouldRenderDifferentialPairs(A.scale)&&(()=>{zr.startRenderMeasurement("diff-pair-lines");const ye=[],xe=new Set;ae.forEach(Ae=>{if(!xe.has(Ae.id)&&Ht&&typeof Ht.isDifferentialPin=="function"&&Ht.isDifferentialPin(Ae)){const Pe=Ht.findPairPin&&Ht.findPairPin(Ae,t),Oe=Pe&&ae.includes(Pe),Ve=r.has(Ae.id)||Pe&&r.has(Pe.id);if(Pe&&!xe.has(Pe.id)&&(Oe||Ve)){xe.add(Ae.id),xe.add(Pe.id);const Se=V(Ae),J=V(Pe),Ee=ee(Ae,ae,r),Fe=ee(Pe,ae,r),Ce=Ee||Fe||"#FF6600",Qe=Math.sqrt(Math.pow(J.x-Se.x,2)+Math.pow(J.y-Se.y,2));if(Qe>50&&ye.push(k.jsx(T5,{points:[Se.x,Se.y,J.x,J.y],stroke:Ce,strokeWidth:2,opacity:.6,dash:[8,4],listening:!1},`diff-pair-${Ae.id}-${Pe.id}`)),Qe>100&&A.scale>.4){const et=(Se.x+J.x)/2,lt=(Se.y+J.y)/2,xt=Ht.getDifferentialPairType(Ae.pinName)==="positive"?"+/-":"-/+";ye.push(k.jsxs(Qc,{children:[k.jsx(Cn,{x:et-10,y:lt-8,width:20,height:16,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:et,y:lt-6,text:xt,fontSize:10,fill:Ce,align:"center",offsetX:10,listening:!1})]},`diff-label-${Ae.id}-${Pe.id}`))}}}});const Te=zr.endRenderMeasurement("diff-pair-lines");return console.log(`🔗 Differential pairs: ${ye.length} lines (${Te.toFixed(2)}ms)`),ye})(),Gn.shouldRenderAtLOD(z,2)&&(()=>{zr.startRenderMeasurement("bank-boundaries");const ye=new Map;ae.forEach(Se=>{const J=Se.bank||"NA";ye.has(J)||ye.set(J,[]),ye.get(J).push(Se)});const Te=Math.max(20,88*A.scale),Ae=6,Pe=new Map;Array.from(ye.entries()).forEach(([Se,J])=>{if(Se==="NA"||J.length<2)return;const Ee=J.map(Ce=>V(Ce)),Fe={minX:Math.min(...Ee.map(Ce=>Ce.x))-Te/2-Ae,maxX:Math.max(...Ee.map(Ce=>Ce.x))+Te/2+Ae,minY:Math.min(...Ee.map(Ce=>Ce.y))-Te/2-Ae,maxY:Math.max(...Ee.map(Ce=>Ce.y))+Te/2+Ae,bankKey:Se,pins:J};Pe.set(Se,Fe)});const Oe=Array.from(Pe.entries()).map(([Se,J])=>{const Ee=me(J.pins[0]);return k.jsx(Cn,{x:J.minX,y:J.minY,width:J.maxX-J.minX,height:J.maxY-J.minY,fill:`${Ee}10`,stroke:"transparent",cornerRadius:6,opacity:.3,listening:!1},`bank-boundary-${Se}`)}),Ve=zr.endRenderMeasurement("bank-boundaries");return console.log(`🏦 Bank boundaries: ${Pe.size} boundaries (${Ve.toFixed(2)}ms)`),Oe})(),(()=>{const xe=Math.max(20,88*A.scale);return t.filter(Te=>r&&r.has?r.has(Te.id):!1).map(Te=>{const Ae=V(Te);return k.jsx(Cn,{x:Ae.x-xe/2-2,y:Ae.y-xe/2-2,width:xe+4,height:xe+4,fill:"transparent",stroke:"#FFD700",strokeWidth:3,cornerRadius:4,onClick:Pe=>Xe(Pe,Te),onDblClick:Pe=>Ze(Pe,Te),style:{cursor:"pointer"}},`highlight-${Te.id}`)})})(),k.jsxs(Qc,{x:10,y:30,children:[(()=>{const ye="Bank Groups";return k.jsxs(k.Fragment,{children:[k.jsx(Cn,{x:24,y:-2,width:ye.length*6+8,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2,onClick:()=>{console.log("🎯 Bank Groups header clicked - showing all banks!"),m()},onMouseEnter:xe=>{var Ae;const Te=xe.target;Te.fill("rgba(0, 0, 0, 0.9)"),(Ae=Te.getLayer())==null||Ae.batchDraw()},onMouseLeave:xe=>{var Ae;const Te=xe.target;Te.fill("rgba(0, 0, 0, 0.85)"),(Ae=Te.getLayer())==null||Ae.batchDraw()},style:{cursor:"pointer"}}),k.jsx(vi,{x:27,y:0,text:ye,fontSize:12,fill:"#4AE24A",onClick:()=>{console.log("🎯 Bank Groups text clicked - showing all banks!"),m()},onMouseEnter:xe=>{var Ae;const Te=xe.target;Te.fill("#fff"),(Ae=Te.getLayer())==null||Ae.batchDraw()},onMouseLeave:xe=>{var Ae;const Te=xe.target;Te.fill("#4AE24A"),(Ae=Te.getLayer())==null||Ae.batchDraw()},style:{cursor:"pointer"}})]})})(),(()=>[...new Set(ae.map(xe=>xe.bank).filter(Boolean))].sort((xe,Te)=>{const Ae=parseInt(xe),Pe=parseInt(Te);return Ae-Pe}).map((xe,Te)=>{const Ae=g&&g.size!==void 0?g.size===0||g.has(xe):!0;return k.jsxs(Qc,{y:20+Te*18,x:27,children:[k.jsx(Cn,{x:8,y:-8,width:`Bank ${xe}`.length*6+20,height:16,fill:"rgba(0, 0, 0, 0)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:1,cornerRadius:2,onClick:()=>{console.log(`🎯 BANK ${xe} CLICKED!`),console.log("Before: visibleBanks =",Array.from(g)),console.log(`Before: Bank ${xe} is visible =`,g.has(xe)),console.log("Before: Total pins received =",t.length),v(xe)},onMouseEnter:Pe=>{var Ve;const Oe=Pe.target;Oe.stroke("rgba(255, 255, 255, 0.3)"),(Ve=Oe.getLayer())==null||Ve.batchDraw()},onMouseLeave:Pe=>{var Ve;const Oe=Pe.target;Oe.stroke("rgba(255, 255, 255, 0.1)"),(Ve=Oe.getLayer())==null||Ve.batchDraw()},style:{cursor:"pointer"}}),k.jsx(qc,{x:12,y:2,radius:4,fill:Ae?vo(xe):"#444",stroke:Ae?"#000":"#666",strokeWidth:1,listening:!1}),k.jsx(Cn,{x:23,y:-8,width:`Bank ${xe}`.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),k.jsx(vi,{x:25,y:-6,text:`Bank ${xe}`,fontSize:10,fill:Ae?"#ccc":"#666",listening:!1}),k.jsx(vi,{x:10,y:-6,text:Ae?"👁":"🚫",fontSize:8,listening:!1})]},xe)}))(),k.jsx(Cn,{x:117,y:-2,width:130,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2}),k.jsx(vi,{x:120,y:0,text:"Pin Types (Circle):",fontSize:12,fill:"#ccc"}),(()=>{const ye=[...new Set(t.map(Te=>Te.pinType).filter(Boolean))].sort(),xe={IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999",MIO:"#32CD32",DDR:"#8A2BE2"};return ye.map((Te,Ae)=>k.jsxs(Qc,{y:20+Ae*18,x:120,children:[k.jsx(qc,{x:12,y:2,radius:4,fill:xe[Te]||"#666666",stroke:"#000",strokeWidth:1}),k.jsx(vi,{x:25,y:-6,text:Te,fontSize:10,fill:"#999"}),k.jsx(Cn,{x:23,y:-8,width:Te.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2}),k.jsx(vi,{x:25,y:-6,text:Te,fontSize:10,fill:"#ccc"})]},Te))})()]})]})})})]})]})},lj=()=>{const e=ke.useRef(null),[t,r]=ke.useState(!1),[n,i]=ke.useState(""),{package:a,pins:s,selectedPins:o,viewConfig:u,loadProject:f}=Yi(),d=()=>({package:a,pins:s,selectedPins:o,viewConfig:u,listView:{activeTab:"overview"},ui:{sidebarWidth:300,showDifferentialPairs:!1},filters:{},history:{currentIndex:0,actions:[]},projectSettings:{}}),p=(w,x=3e3)=>{i(w),setTimeout(()=>i(""),x)},g=()=>typeof window.vscode<"u",v=async()=>{try{if(r(!0),!a||s.length===0)throw new Error("No project data to save");const w=d(),x=hn.createSaveData(w);if(g())try{const T=window.vscode,A=x.package.device.replace(/[^a-zA-Z0-9]/g,"_"),N=new Date().toISOString().split("T")[0],R=`${A}_project_${N}.fpgaproj`,P=await new Promise((I,b)=>{const M=setTimeout(()=>{window.removeEventListener("message",D),b(new Error("Save dialog timeout"))},3e4),D=he=>{he.data.command==="saveDialogResult"&&(clearTimeout(M),window.removeEventListener("message",D),I(he.data.result))};window.addEventListener("message",D);const Q={command:"showSaveDialog",options:{saveLabel:"Save FPGA Project",filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}};try{T.postMessage(Q)}catch(he){console.error("Failed to send message to VS Code:",he),b(he)}});if(P){let I;if(typeof P=="string")I=P;else if(P&&typeof P=="object"){const D=P;I=D.fsPath||D.path,!I&&typeof P.toString=="function"&&(I=P.toString())}if(!I)throw new Error("Failed to extract file path from URI");const b=JSON.stringify(x,null,2);if(await new Promise(D=>{const Q=he=>{he.data.command==="saveFileResult"&&(window.removeEventListener("message",Q),D(he.data.success))};window.addEventListener("message",Q),T.postMessage({command:"saveFile",filePath:I,content:b,filename:R})}))p("✅ Project saved successfully!");else throw new Error("File save operation failed")}else return}catch(T){console.error("VS Code save failed:",T),await hn.saveToFile(x),p("✅ Project saved successfully!")}else await hn.saveToFile(x),p("✅ Project saved successfully!")}catch(w){console.error("Save failed:",w),p(`❌ Save failed: ${w}`,5e3)}finally{r(!1)}},m=async w=>{var x;if(console.log("🔍 handleLoad called, isInVSCode:",g()),g())try{r(!0);const T=window.vscode;console.log("📨 Sending showOpenDialog message to VS Code"),T.postMessage({command:"showOpenDialog",options:{openLabel:"Open FPGA Project",canSelectFiles:!0,canSelectMany:!1,filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}}),console.log("✅ Message sent to VS Code extension"),setTimeout(()=>{r(!1)},1e3)}catch(T){console.error("VS Code open failed:",T),p(`❌ Open failed: ${T}`,5e3),r(!1)}else{console.log("📂 Browser environment - using file input");const T=(x=w==null?void 0:w.target.files)==null?void 0:x[0];if(!T)return;try{r(!0);const A=await hn.loadFromFile(T),N=hn.restoreProject(A);f(N),p(`✅ Project loaded: ${A.metadata.description}`),w&&(w.target.value="")}catch(A){console.error("Load failed:",A),p(`❌ Load failed: ${A}`,5e3)}finally{r(!1)}}},_=()=>{try{if(!a||s.length===0)throw new Error("No project data to save");const w=d();hn.quickSave(w),p("⚡ Quick save completed")}catch(w){console.error("Quick save failed:",w),p(`❌ Quick save failed: ${w}`,5e3)}},C=async()=>{try{const w=hn.quickLoad();if(!w){p("📭 No quick save found");return}const x=hn.restoreProject(w);f(x),p("⚡ Quick save loaded")}catch(w){console.error("Quick load failed:",w),p(`❌ Quick load failed: ${w}`,5e3)}},S=hn.getQuickSaveInfo();return kr.useEffect(()=>{const w=x=>{var T;if(x.ctrlKey||x.metaKey)switch(x.key.toLowerCase()){case"s":x.preventDefault(),a&&s.length>0&&_();break;case"l":x.preventDefault(),S.exists?C():(T=e.current)==null||T.click();break}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[a,s.length,S.exists]),k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",position:"relative"},children:[k.jsx("button",{onClick:v,disabled:t||!a||s.length===0,title:"Save Project (💾)",style:{padding:"6px 8px",backgroundColor:"#00a8ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t||!a||s.length===0?.5:1},children:"💾"}),k.jsx("button",{onClick:()=>{var w;g()?m():(w=e.current)==null||w.click()},disabled:t,title:"Load Project (📁)",style:{padding:"6px 8px",backgroundColor:"#ffa500",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t?.5:1},children:"📁"}),k.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:m,style:{display:"none"}}),k.jsx("button",{onClick:_,disabled:t||!a||s.length===0,title:"Quick Save (Ctrl+S)",style:{padding:"6px 8px",backgroundColor:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",opacity:t||!a||s.length===0?.5:1},children:"⚡"}),n&&k.jsx("div",{style:{position:"absolute",top:"40px",right:"0",padding:"8px 12px",backgroundColor:n.includes("❌")?"#dc3545":"#28a745",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:n}),!g()&&k.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:m,style:{display:"none"}})]})},cj=({className:e=""})=>{const{canUndo:t,canRedo:r,currentActionDescription:n,nextRedoActionDescription:i,undo:a,redo:s}=Yi(),o=u=>({padding:"6px",backgroundColor:u?"#333":"#222",border:"1px solid #555",borderRadius:"4px",color:u?"#ccc":"#666",cursor:u?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",transition:"background-color 0.2s"});return k.jsxs("div",{className:`flex flex-row items-center ${e}`,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[k.jsx("button",{onClick:a,disabled:!t,title:`Undo${n?`: ${n}`:""} (Ctrl+Z)`,style:{...o(t),borderRadius:"4px 0 0 4px",borderRight:"none"},onMouseEnter:u=>{t&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{t&&(u.currentTarget.style.backgroundColor="#333")},children:k.jsx(uj,{className:"w-3 h-3"})}),k.jsx("button",{onClick:s,disabled:!r,title:`Redo${i?`: ${i}`:""} (Ctrl+Y)`,style:{...o(r),borderRadius:"0 4px 4px 0"},onMouseEnter:u=>{r&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{r&&(u.currentTarget.style.backgroundColor="#333")},children:k.jsx(fj,{className:"w-3 h-3"})})]})},uj=({className:e})=>k.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[k.jsx("path",{d:"M3 7v6h6"}),k.jsx("path",{d:"m21 17a9 9 0 00-9-9 9 9 0 00-6 2.3l-3 3"})]}),fj=({className:e})=>k.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[k.jsx("path",{d:"M21 7v6h-6"}),k.jsx("path",{d:"m3 17a9 9 0 019-9 9 9 0 016 2.3l3 3"})]}),dj=({isOpen:e,onClose:t})=>{if(!e)return null;const r=[{key:"Ctrl+Z",description:"Undo"},{key:"Ctrl+Y",description:"Redo"},{key:"Ctrl+O",description:"Open CSV file"},{key:"Ctrl+S",description:"Save project"},{key:"Ctrl+E",description:"Export XDC file"},{key:"Ctrl+F",description:"Focus search field"},{key:"Click",description:"Select pin"},{key:"Ctrl+Click",description:"Toggle pin selection"},{key:"Shift+Click",description:"Range select pins"},{key:"Ctrl+A",description:"Select all pins"},{key:"Ctrl+D",description:"Deselect all"},{key:"Space",description:"Rotate view 90 degrees"},{key:"F",description:"Toggle top/bottom view"},{key:"R",description:"Reset zoom and pan"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"Escape",description:"Deselect all"},{key:"Delete",description:"Unassign selected pins"}];return k.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:k.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-hidden flex flex-col",children:[k.jsxs("div",{className:"flex items-center justify-between mb-4",children:[k.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Keyboard Shortcuts"}),k.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-xl",children:"×"})]}),k.jsx("div",{className:"flex-1 overflow-y-auto",children:k.jsx("div",{className:"space-y-1",children:r.map((n,i)=>k.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-50",children:[k.jsx("span",{className:"text-sm text-gray-600",children:n.description}),k.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-gray-100 rounded border",children:n.key})]},i))})}),k.jsx("div",{className:"mt-4 pt-4 border-t",children:k.jsx("button",{onClick:t,className:"w-full py-2 px-4 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Close"})})]})})},hj=({validationResult:e,onIssueClick:t,onPinHighlight:r,className:n=""})=>{const[i,a]=ke.useState(!0),[s,o]=ke.useState("all"),[u,f]=ke.useState("all"),d=m=>{switch(m){case"pin_conflict":return"Pin Conflict";case"differential_pair":return"Differential Pair";case"bank_constraint":return"Bank Constraint";case"clock_constraint":return"Clock Constraint";default:return m}},p=(e==null?void 0:e.issues.filter(m=>{const _=s==="all"||m.severity===s,C=u==="all"||m.type===u;return _&&C}))||[],g=m=>{t==null||t(m),r==null||r(m.affectedPins)},v=m=>{switch(m){case"error":return"🔴";case"warning":return"🟡";case"info":return"🔵"}};return e?k.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[k.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),k.jsx("button",{onClick:()=>a(!i),className:"text-gray-500 hover:text-gray-700",children:i?"📉":"📊"})]})}),k.jsx("div",{className:"flex-1 overflow-y-auto right-sidebar-scroll",children:i&&k.jsxs("div",{className:"p-4",children:[k.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[k.jsxs("div",{className:"text-center",children:[k.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.summary.errorCount}),k.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]}),k.jsxs("div",{className:"text-center",children:[k.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.summary.warningCount}),k.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),k.jsxs("div",{className:"text-center",children:[k.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.summary.infoCount}),k.jsx("div",{className:"text-xs text-gray-500",children:"Info"})]})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Severity"}),k.jsxs("select",{value:s,onChange:m=>o(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsxs("option",{value:"all",children:["All Issues (",e.issues.length,")"]}),k.jsxs("option",{value:"error",children:["Errors (",e.summary.errorCount,")"]}),k.jsxs("option",{value:"warning",children:["Warnings (",e.summary.warningCount,")"]}),k.jsxs("option",{value:"info",children:["Info (",e.summary.infoCount,")"]})]})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Type"}),k.jsxs("select",{value:u,onChange:m=>f(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"all",children:"All Types"}),Array.from(new Set(e.issues.map(m=>m.type))).map(m=>k.jsx("option",{value:m,children:d(m)},m))]})]})]}),k.jsx("div",{className:"mt-4 space-y-2 max-h-64 overflow-y-auto right-sidebar-scroll",children:p.map((m,_)=>k.jsxs("div",{onClick:()=>g(m),className:`p-3 rounded-lg cursor-pointer transition-colors ${m.severity==="error"?"bg-red-50 border border-red-200 hover:bg-red-100":m.severity==="warning"?"bg-yellow-50 border border-yellow-200 hover:bg-yellow-100":"bg-blue-50 border border-blue-200 hover:bg-blue-100"}`,children:[k.jsxs("div",{className:"flex items-start justify-between mb-1",children:[k.jsx("span",{className:"text-sm",children:v(m.severity)}),k.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded",children:d(m.type)})]}),k.jsx("p",{className:"text-xs mb-2 line-clamp-2",children:m.description}),m.affectedPins.length>0&&k.jsxs("div",{className:"text-xs mb-2",children:[k.jsx("span",{className:"font-medium",children:"Affected pins: "}),k.jsxs("span",{className:"font-mono",children:[m.affectedPins.slice(0,3).join(", "),m.affectedPins.length>3&&` +${m.affectedPins.length-3} more`]})]}),m.suggestion&&k.jsxs("div",{className:"text-xs mt-2 p-2 bg-white bg-opacity-50 rounded",children:[k.jsx("span",{className:"font-medium",children:"💡 Suggestion: "}),m.suggestion]})]},_))})]})}),k.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-3 bg-white",children:k.jsx("div",{className:"text-xs text-gray-500 text-center",children:(e==null?void 0:e.lastChecked)&&k.jsxs(k.Fragment,{children:["Last checked: ",new Date(e.lastChecked).toLocaleTimeString()]})})})]}):k.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[k.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[k.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),k.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No validation data available"})]}),k.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:k.jsxs("div",{className:"text-center",children:[k.jsx("div",{className:"text-4xl mb-2",children:"📊"}),k.jsx("div",{className:"text-sm",children:"Run validation to see results"})]})})]})},pj=({validationResult:e,className:t=""})=>{if(!e)return k.jsx("div",{className:`inline-flex items-center text-gray-400 ${t}`,children:k.jsx("span",{className:"text-sm",children:"⚪"})});const{summary:r}=e;return r.errorCount>0?k.jsxs("div",{className:`inline-flex items-center text-red-600 ${t}`,children:[k.jsx("span",{className:"text-sm",children:"🔴"}),k.jsx("span",{className:"ml-1 text-xs font-bold",children:r.errorCount})]}):r.warningCount>0?k.jsxs("div",{className:`inline-flex items-center text-yellow-600 ${t}`,children:[k.jsx("span",{className:"text-sm",children:"🟡"}),k.jsx("span",{className:"ml-1 text-xs font-bold",children:r.warningCount})]}):k.jsx("div",{className:`inline-flex items-center text-green-600 ${t}`,children:k.jsx("span",{className:"text-sm",children:"✅"})})};class Zc{static assignArrayPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(r.startIndex>r.endIndex)throw new Error("Start index must be less than or equal to end index");const i=[];for(let s=r.startIndex;s<=r.endIndex;s+=r.step){const o=r.padding>0?s.toString().padStart(r.padding,"0"):s.toString(),u=r.indexFormat.replace("{i}",o).replace("{index}",o);i.push(r.baseName+u)}const a=Math.min(t.length,i.length);for(let s=0;s<a;s++){const o=t[s],u=i[s];if(o.pinType&&["POWER","GROUND","NC"].includes(o.pinType)){n.skippedPins++,n.errors.push(`Skipped ${o.pinNumber}: Cannot assign to ${o.pinType} pin`);continue}n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:u}),n.processedPins++}}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static assignDifferentialPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(!r.positiveFormat||!r.negativeFormat)throw new Error("Both positive and negative formats are required");t.length%2!==0&&n.errors.push(`Warning: Odd number of pins (${t.length}). Last pin will be skipped.`);const i=Math.floor(t.length/2);for(let a=0;a<i;a++){const s=t[a*2],o=t[a*2+1],u=s.pinType&&["POWER","GROUND","NC"].includes(s.pinType),f=o.pinType&&["POWER","GROUND","NC"].includes(o.pinType);if(u||f){n.skippedPins+=2,n.errors.push(`Skipped pair ${s.pinNumber}/${o.pinNumber}: Cannot assign to ${s.pinType}/${o.pinType} pins`);continue}let d=r.baseName;if(r.indexFormat&&r.startIndex!==void 0){const v=(r.startIndex||0)+a,m=r.padding&&r.padding>0?v.toString().padStart(r.padding,"0"):v.toString();d=r.indexFormat.replace("{i}",m).replace("{index}",m),d=r.baseName+d}const p=d+r.positiveFormat,g=d+r.negativeFormat;n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:s.signalName,newSignal:p}),n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:g}),n.processedPins+=2}t.length%2!==0&&n.skippedPins++}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static filterPinsByCriteria(t,r){return t.filter(n=>{if(r.pinTypes&&r.pinTypes.length>0&&(!n.pinType||!r.pinTypes.includes(n.pinType))||r.banks&&r.banks.length>0&&(!n.bank||!r.banks.includes(n.bank))||r.voltages&&r.voltages.length>0&&(!n.voltage||!r.voltages.includes(n.voltage)))return!1;if(r.assignmentStatus){const i=n.signalName&&n.signalName.trim()!=="";if(r.assignmentStatus==="assigned"&&!i||r.assignmentStatus==="unassigned"&&i)return!1}if(r.pinNumberPattern)try{if(!new RegExp(r.pinNumberPattern).test(n.pinNumber))return!1}catch{}if(r.gridRange&&n.gridPosition){const{rowStart:i,rowEnd:a,colStart:s,colEnd:o}=r.gridRange;if(i&&n.gridPosition.row<i||a&&n.gridPosition.row>a||s&&n.gridPosition.col<s||o&&n.gridPosition.col>o)return!1}return!0})}static clearSignals(t){const r={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{for(const n of t)n.signalName&&n.signalName.trim()!==""?(r.assignments.push({pinId:n.id,pinNumber:n.pinNumber,oldSignal:n.signalName,newSignal:""}),r.processedPins++):r.skippedPins++}catch(n){r.success=!1,r.errors.push(n instanceof Error?n.message:"Unknown error occurred")}return r}static validateBatchOperation(t,r){const n=[];if(t.length===0)return n.push("No pins selected for batch operation"),n;t.length>1e3&&n.push(`Warning: Large dataset (${t.length} pins). Operation may take some time.`);const i=new Set(t.map(a=>a.pinType).filter(Boolean));return i.size>1&&(i.has("POWER")||i.has("GROUND"))&&n.push("Warning: Selection includes power/ground pins which cannot be assigned signals"),r==="differential"&&(t.length<2&&n.push("At least 2 pins required for differential pair assignment"),new Set(t.map(s=>s.bank).filter(Boolean)).size>1&&n.push("Warning: Differential pairs should typically be in the same bank")),n}static previewBatchOperation(t,r,n){try{let i;return n==="array"?i=this.assignArrayPattern(t,r):i=this.assignDifferentialPattern(t,r),i.assignments.map(a=>({pinNumber:a.pinNumber,currentSignal:a.oldSignal||"",newSignal:a.newSignal}))}catch{return[]}}static setVoltageAndIO(t,r){var i,a;const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.voltage&&!r.ioStandard)throw new Error("At least voltage or I/O standard must be specified");r.voltage&&!nu.includes(r.voltage)&&n.errors.push(`Invalid voltage: ${r.voltage}`),r.ioStandard&&!Kd.includes(r.ioStandard)&&r.ioStandard!=="AUTO"&&n.errors.push(`Invalid I/O standard: ${r.ioStandard}`);for(const s of t){if(!["IO","CLOCK"].includes(s.pinType)&&r.voltage){n.skippedPins++;continue}let o=s.voltage,u=((i=s.attributes)==null?void 0:i.IO_Standard)||s.ioType||"AUTO";if(r.voltage&&(o=r.voltage),r.ioStandard)if(r.ioStandard==="AUTO"||r.autoDetectIO)u=Ms(o||"3.3V");else{if(o&&!Ab(o,r.ioStandard)){n.errors.push(`I/O standard ${r.ioStandard} is not compatible with voltage ${o} for pin ${s.pinNumber}`),n.skippedPins++;continue}u=r.ioStandard}else r.autoDetectIO&&o&&(u=Ms(o));n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:`${s.voltage||"Unknown"}V / ${((a=s.attributes)==null?void 0:a.IO_Standard)||s.ioType||"Unknown"}`,newSignal:`${o}V / ${u}`}),n.processedPins++}n.processedPins===0&&n.skippedPins>0&&(n.errors.push("No pins were processed. All pins were skipped."),n.success=!1)}catch(s){n.success=!1,n.errors.push(s instanceof Error?s.message:"Unknown error occurred")}return n}static setPinDirections(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!["Input","Output","InOut","Clock","Reset"].includes(r))throw new Error(`Invalid direction: ${r}`);for(const a of t){if(!["IO","CLOCK"].includes(a.pinType)){n.skippedPins++;continue}const s=a.direction||"Unknown";n.assignments.push({pinId:a.id,pinNumber:a.pinNumber,oldSignal:`Direction: ${s}`,newSignal:`Direction: ${r}`}),n.processedPins++}n.processedPins===0&&(n.errors.push("No I/O pins found to update"),n.success=!1)}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}}const gj=({isVisible:e})=>{const{pins:t,selectedPins:r,assignSignal:n}=Yi(),[i,a]=ke.useState("array"),[s,o]=ke.useState("manual"),[u,f]=ke.useState(!1),[d,p]=ke.useState({baseName:"DATA",startIndex:0,endIndex:31,indexFormat:"[{i}]",padding:0,step:1}),[g,v]=ke.useState({voltage:"3.3V",ioStandard:"AUTO",autoDetectIO:!0,driveStrength:"---DriveStrength---",slewRate:"---SlewRate---"}),[m,_]=ke.useState("Input"),[C,S]=ke.useState({pinTypes:["IO"],assignmentStatus:"unassigned"}),[w,x]=ke.useState(null),T=ke.useMemo(()=>s==="manual"?t.filter(P=>r.has(P.id)):Zc.filterPinsByCriteria(t,C),[t,r,s,C]),A=ke.useMemo(()=>i==="clear"?[]:i==="voltage-io"||i==="direction"?T.length===0?["No pins selected"]:[]:T.length===0?["No pins selected"]:[],[T,i]),N=()=>{let P;switch(i){case"array":P=Zc.assignArrayPattern(T,d);break;case"voltage-io":P=Zc.setVoltageAndIO(T,g);break;case"direction":P=Zc.setPinDirections(T,m);break;case"clear":P=Zc.clearSignals(T);break;default:return}const I={...P,errors:P.errors.filter(b=>!b.includes("Need")&&!b.includes("pins, got")&&!b.includes("Not enough pins")&&!b.includes("pins selected"))};x(I),f(!0)},R=()=>{if(!w)return;const P=`Batch ${i} operation on ${w.processedPins} pins`,I=w.assignments.map(b=>({pinId:b.pinId,oldSignal:b.oldSignal||"",newSignal:b.newSignal}));Ar.recordAction("batch_operation",I,P),w.assignments.forEach(b=>{if(i==="voltage-io"){const{updatePin:M}=Yi.getState();M(b.pinId,{voltage:g.voltage,attributes:{IO_Standard:g.ioStandard==="AUTO"?Ms(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"},ioType:g.ioStandard==="AUTO"?Ms(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"})}else if(i==="direction"){const{updatePin:M}=Yi.getState();M(b.pinId,{direction:m})}else n(b.pinId,b.newSignal)}),f(!1),x(null)};return e?k.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[k.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[k.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Batch Operations"}),k.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Assign patterns to multiple pins efficiently"})]}),k.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),k.jsxs("div",{className:"space-y-2",children:[k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"operationType",value:"array",checked:i==="array",onChange:P=>a(P.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:"Array Pattern (DATA[0], DATA[1], ...)"})]}),k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"operationType",value:"voltage-io",checked:i==="voltage-io",onChange:P=>a(P.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:"Voltage & I/O Standards"})]}),k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"operationType",value:"direction",checked:i==="direction",onChange:P=>a(P.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:"Pin Directions"})]}),k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"operationType",value:"clear",checked:i==="clear",onChange:P=>a(P.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:"Clear Signals"})]})]})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Selection"}),k.jsxs("div",{className:"space-y-2",children:[k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"selectionMode",value:"manual",checked:s==="manual",onChange:P=>o(P.target.value),className:"mr-2"}),k.jsxs("span",{className:"text-sm",children:["Use Selected Pins (",r.size,")"]})]}),k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"selectionMode",value:"criteria",checked:s==="criteria",onChange:P=>o(P.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:"Auto-select by Criteria"})]})]})]}),s==="criteria"&&k.jsxs("div",{className:"space-y-4 p-3 bg-blue-50 rounded-lg",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Types"}),k.jsx("div",{className:"space-x-4",children:["IO","POWER","GROUND","CLOCK"].map(P=>{var I;return k.jsxs("label",{className:"inline-flex items-center",children:[k.jsx("input",{type:"checkbox",checked:(I=C.pinTypes)==null?void 0:I.includes(P),onChange:b=>{b.target.checked?S(M=>({...M,pinTypes:[...M.pinTypes||[],P]})):S(M=>{var D;return{...M,pinTypes:((D=M.pinTypes)==null?void 0:D.filter(Q=>Q!==P))||[]}})},className:"mr-1"}),k.jsx("span",{className:"text-xs",children:P})]},P)})})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Status"}),k.jsxs("select",{value:C.assignmentStatus,onChange:P=>S(I=>({...I,assignmentStatus:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"any",children:"Any"}),k.jsx("option",{value:"assigned",children:"Assigned"}),k.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),k.jsxs("div",{className:"text-xs text-gray-600",children:["Matches ",T.length," pins"]})]}),i==="array"&&k.jsxs("div",{className:"space-y-3 p-3 bg-green-50 rounded-lg",children:[k.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Array Pattern Configuration"}),k.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Base Name"}),k.jsx("input",{type:"text",value:d.baseName,onChange:P=>p(I=>({...I,baseName:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"DATA"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Index Format"}),k.jsx("input",{type:"text",value:d.indexFormat,onChange:P=>p(I=>({...I,indexFormat:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"[{i}]"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Index"}),k.jsx("input",{type:"number",value:d.startIndex,onChange:P=>p(I=>({...I,startIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Index"}),k.jsx("input",{type:"number",value:d.endIndex,onChange:P=>p(I=>({...I,endIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Step"}),k.jsx("input",{type:"number",value:d.step,onChange:P=>p(I=>({...I,step:parseInt(P.target.value)||1})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"1"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Padding"}),k.jsx("input",{type:"number",value:d.padding,onChange:P=>p(I=>({...I,padding:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0"})]})]}),k.jsxs("div",{className:"text-xs text-gray-600",children:["Preview: ",d.baseName,d.indexFormat.replace("{i}",d.startIndex.toString().padStart(d.padding,"0"))]})]}),i==="voltage-io"&&k.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded-lg",children:[k.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Voltage & I/O Standard Configuration"}),k.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voltage Level"}),k.jsxs("select",{value:g.voltage||"",onChange:P=>v(I=>({...I,voltage:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"",children:"Keep current"}),nu.map(P=>k.jsx("option",{value:P,children:P},P))]})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"I/O Standard"}),k.jsxs("select",{value:g.ioStandard||"",onChange:P=>v(I=>({...I,ioStandard:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"",children:"Keep current"}),k.jsx("option",{value:"AUTO",children:"AUTO (based on voltage)"}),Kd.map(P=>k.jsx("option",{value:P,children:P},P))]})]})]}),k.jsx("div",{className:"flex items-center space-x-4",children:k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"checkbox",checked:g.autoDetectIO||!1,onChange:P=>v(I=>({...I,autoDetectIO:P.target.checked})),className:"mr-2"}),k.jsx("span",{className:"text-xs",children:"Auto-detect I/O standard"})]})}),k.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Drive Strength (mA)"}),k.jsxs("select",{value:g.driveStrength||"",onChange:P=>v(I=>({...I,driveStrength:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"",children:"Keep current"}),k.jsx("option",{value:"---DriveStrength---",children:"---DriveStrength---"}),k.jsx("option",{value:"2",children:"2 mA"}),k.jsx("option",{value:"4",children:"4 mA"}),k.jsx("option",{value:"6",children:"6 mA"}),k.jsx("option",{value:"8",children:"8 mA"}),k.jsx("option",{value:"12",children:"12 mA"}),k.jsx("option",{value:"16",children:"16 mA"}),k.jsx("option",{value:"20",children:"20 mA"}),k.jsx("option",{value:"24",children:"24 mA"})]})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Slew Rate"}),k.jsxs("select",{value:g.slewRate||"",onChange:P=>v(I=>({...I,slewRate:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[k.jsx("option",{value:"",children:"Keep current"}),k.jsx("option",{value:"---SlewRate---",children:"---SlewRate---"}),k.jsx("option",{value:"SLOW",children:"SLOW"}),k.jsx("option",{value:"FAST",children:"FAST"})]})]})]})]}),i==="direction"&&k.jsxs("div",{className:"space-y-3 p-3 bg-orange-50 rounded-lg",children:[k.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Pin Direction Configuration"}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Direction"}),k.jsx("div",{className:"space-y-2",children:["Input","Output","InOut","Clock","Reset"].map(P=>k.jsxs("label",{className:"flex items-center",children:[k.jsx("input",{type:"radio",name:"direction",value:P,checked:m===P,onChange:I=>_(I.target.value),className:"mr-2"}),k.jsx("span",{className:"text-sm",children:P})]},P))})]})]}),k.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg",children:[k.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Target Summary"}),k.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[k.jsxs("div",{children:["Selected pins: ",T.length]}),k.jsxs("div",{children:["Operation: ",i]}),A.length>0&&k.jsxs("div",{className:"text-red-600",children:[k.jsx("div",{className:"font-medium",children:"Validation Issues:"}),k.jsx("ul",{className:"text-xs mt-1 space-y-1",children:A.map((P,I)=>k.jsxs("li",{children:["• ",P]},I))})]})]})]}),k.jsx("div",{children:k.jsx("button",{onClick:N,disabled:T.length===0||A.length>0,className:"w-full py-3 px-4 bg-blue-500 text-black rounded-lg hover:bg-blue-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-blue-600",children:"Generate Preview"})}),u&&w&&k.jsxs("div",{className:"border rounded-lg bg-white",children:[k.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[k.jsx("h4",{className:"font-medium text-gray-800",children:"Preview Results"}),k.jsx("p",{className:"text-sm text-gray-600 mt-1",children:w.success?`${w.processedPins} pins will be assigned`:"Operation preview failed"})]}),w.errors.length>0&&k.jsxs("div",{className:"p-3 bg-red-50 border-b",children:[k.jsx("h5",{className:"text-sm font-medium text-red-800 mb-1",children:"Errors:"}),k.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:w.errors.map((P,I)=>k.jsxs("li",{children:["• ",P]},I))})]}),w.assignments.length>0&&k.jsxs("div",{className:"p-4",children:[k.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Assignments"}),k.jsx("div",{className:"max-h-48 overflow-y-auto border rounded custom-scrollbar",children:k.jsxs("table",{className:"w-full text-sm",children:[k.jsx("thead",{className:"bg-gray-50 sticky top-0",children:k.jsxs("tr",{children:[k.jsx("th",{className:"px-3 py-2 text-left",children:"Pin"}),k.jsx("th",{className:"px-3 py-2 text-left",children:"Current"}),k.jsx("th",{className:"px-3 py-2 text-left",children:"New"})]})}),k.jsxs("tbody",{children:[w.assignments.slice(0,50).map((P,I)=>k.jsxs("tr",{className:"border-t",children:[k.jsx("td",{className:"px-3 py-2 font-mono",children:P.pinNumber}),k.jsx("td",{className:"px-3 py-2 text-gray-600",children:P.oldSignal||"-"}),k.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:P.newSignal})]},I)),w.assignments.length>50&&k.jsx("tr",{children:k.jsxs("td",{colSpan:3,className:"px-3 py-2 text-center text-gray-500 italic",children:["... and ",w.assignments.length-50," more"]})})]})]})})]})]})]}),u&&w&&k.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:k.jsxs("div",{className:"flex gap-3",children:[k.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),k.jsx("button",{onClick:R,disabled:!w.success||w.processedPins===0,className:"flex-1 py-2 px-4 bg-green-500 text-black rounded-lg hover:bg-green-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-green-600",children:"Execute Operation"})]})})]}):null},Vl=class{static initialize(){this.isInitialized||(document.addEventListener("keydown",this.handleKeyDown),this.isInitialized=!0)}static cleanup(){document.removeEventListener("keydown",this.handleKeyDown),this.shortcuts.clear(),this.isInitialized=!1}static registerShortcut(t,r){this.shortcuts.set(t.toLowerCase(),r)}static unregisterShortcut(t){this.shortcuts.delete(t.toLowerCase())}static getKeyString(t){const r=[];return t.ctrlKey&&r.push("ctrl"),t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),t.metaKey&&r.push("meta"),r.push(t.key.toLowerCase()),r.join("+")}static getAvailableShortcuts(){return[{key:"ctrl+o",description:"Open CSV file"},{key:"ctrl+s",description:"Save project"},{key:"ctrl+e",description:"Export XDC"},{key:"ctrl+f",description:"Focus search"},{key:"ctrl+a",description:"Select all pins"},{key:"ctrl+d",description:"Deselect all"},{key:"r",description:"Reset zoom and pan"},{key:"space",description:"Rotate view 90°"},{key:"f",description:"Flip top/bottom view"},{key:"ctrl+z",description:"Undo"},{key:"ctrl+y",description:"Redo"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"escape",description:"Clear selection"},{key:"delete",description:"Clear selected pin assignments"},{key:"ctrl+shift+?",description:"Show keyboard shortcuts"}]}};Vl.shortcuts=new Map;Vl.isInitialized=!1;Vl.handleKeyDown=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return;const t=Vl.getKeyString(e),r=Vl.shortcuts.get(t);r&&(e.preventDefault(),r())};let Ut=Vl;const mj=()=>{const{undo:e,redo:t,updateUndoRedoState:r}=Yi();ke.useEffect(()=>{Ar.initialize();const n=()=>{r()};return Ar.addListener(n),Ut.initialize(),Ut.registerShortcut("ctrl+z",()=>{e()}),Ut.registerShortcut("ctrl+y",()=>{t()}),Ut.registerShortcut("ctrl+shift+z",()=>{t()}),r(),()=>{Ar.removeListener(n),Ut.unregisterShortcut("ctrl+z"),Ut.unregisterShortcut("ctrl+y"),Ut.unregisterShortcut("ctrl+shift+z")}},[e,t,r])},xj=()=>{const{clearSelection:e,resetZoom:t,rotatePins:r,flipView:n,setZoom:i,viewConfig:a,pins:s,selectPins:o}=Yi();ke.useEffect(()=>(Ut.registerShortcut("escape",()=>{e()}),Ut.registerShortcut("ctrl+a",()=>{o(s.map(u=>u.id))}),Ut.registerShortcut("ctrl+d",()=>{e()}),Ut.registerShortcut("r",()=>{t()}),Ut.registerShortcut("space",()=>{r(90)}),Ut.registerShortcut("f",()=>{n()}),Ut.registerShortcut("+",()=>{const u=Math.min(a.zoom*1.2,5);i(u)}),Ut.registerShortcut("-",()=>{const u=Math.max(a.zoom/1.2,.1);i(u)}),Ut.registerShortcut("0",()=>{i(1)}),Ut.registerShortcut("ctrl+shift+?",()=>{document.dispatchEvent(new CustomEvent("showKeyboardHelp"))}),()=>{Ut.unregisterShortcut("escape"),Ut.unregisterShortcut("ctrl+a"),Ut.unregisterShortcut("ctrl+d"),Ut.unregisterShortcut("r"),Ut.unregisterShortcut("space"),Ut.unregisterShortcut("f"),Ut.unregisterShortcut("+"),Ut.unregisterShortcut("-"),Ut.unregisterShortcut("0"),Ut.unregisterShortcut("ctrl+shift+?")}),[e,t,r,n,i,a.zoom,s,o])},vj=()=>{mj(),xj(),ke.useEffect(()=>()=>{Ut.cleanup()},[])};class vl{static async validateProjectAsync(t,r){return new Promise(n=>{const i=this.validateProject(t,r);n(i)})}static validateProject(t,r){const n=[];n.push(...this.checkPinConflicts(r)),n.push(...this.checkDifferentialPairs(r)),n.push(...this.checkBankConstraints(r));const i=this.calculateSummary(n);return{issues:n,summary:i,lastChecked:Date.now()}}static checkPinConflicts(t){const r=[],n=new Map;return t.forEach(i=>{if(i.signalName&&i.signalName.trim()!==""){const a=i.signalName.trim();if(i.pinType==="POWER"||i.pinType==="GROUND")return;n.has(a)||n.set(a,[]),n.get(a).push(i)}}),n.forEach((i,a)=>{i.length>1&&r.push({id:`conflict_${a}_${Date.now()}`,type:"pin_conflict",severity:"error",title:"Pin Conflict",description:`Signal "${a}" is assigned to ${i.length} pins.`,affectedPins:i.map(s=>s.id),suggestion:"Each signal should be assigned to only one pin.",autoFixable:!1,timestamp:Date.now()})}),r}static checkDifferentialPairs(t){const r=[],n=new Set;return t.forEach(i=>{if(!Ht.isDifferentialPin(i))return;const a=Ht.getDifferentialPairType(i.pinName)||(i.signalName?Ht.getDifferentialPairType(i.signalName):null);if(!a)return;const s=Ht.findPairPin(i,t),o=Ht.getDifferentialBaseName(i.pinName),u=`${i.id}_${(s==null?void 0:s.id)||"missing"}`;if(!n.has(u))if(n.add(u),!s)r.push({id:`diff_pair_incomplete_${i.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Incomplete differential pair: ${o}`,description:`Pin ${i.pinNumber} (${i.pinName}) has no differential pair partner.`,affectedPins:[i.id],suggestion:`Find and assign the ${a==="positive"?"negative":"positive"} side pin in the same bank.`,autoFixable:!1,timestamp:Date.now()});else{i.bank!==s.bank&&r.push({id:`diff_pair_bank_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"error",title:`Differential pair bank mismatch: ${o}`,description:`Differential pair pins are in different banks. Pin ${i.pinNumber} (Bank ${i.bank}) and Pin ${s.pinNumber} (Bank ${s.bank})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be placed in the same bank.",autoFixable:!1,timestamp:Date.now()}),i.voltage!==s.voltage&&r.push({id:`diff_pair_voltage_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Differential pair voltage mismatch: ${o}`,description:`Differential pair pins have different voltages. Pin ${i.pinNumber} (${i.voltage}) and Pin ${s.pinNumber} (${s.voltage})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be set to the same voltage level.",autoFixable:!1,timestamp:Date.now()});const f=i.signalName&&i.signalName.trim()!=="",d=s.signalName&&s.signalName.trim()!=="";if(f&&d){const p=Ht.getPairPinName(i.signalName);p&&p.toLowerCase()!==s.signalName.toLowerCase()&&r.push({id:`diff_pair_signal_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`差動ペアの信号名不一致: ${o}`,description:`差動ペアの信号名が対応していません。"${i.signalName}" と "${s.signalName}"`,affectedPins:[i.id,s.id],suggestion:`信号名を対応させてください（例: "${i.signalName}" と "${p}"）`,autoFixable:!1,timestamp:Date.now()})}else f&&!d&&r.push({id:`diff_pair_incomplete_signal_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"info",title:`差動ペアの信号割り当てが片方のみ: ${o}`,description:`ピン ${i.pinNumber} には信号 "${i.signalName}" が割り当てられていますが、ペアのピン ${s.pinNumber} には信号が割り当てられていません。`,affectedPins:[i.id,s.id],suggestion:"ペアのピンにも対応する信号を割り当てることを検討してください。",autoFixable:!1,timestamp:Date.now()})}}),r}static checkBankConstraints(t){const r=[],n=new Map;return t.forEach(i=>{i.bank&&i.signalName&&i.signalName.trim()!==""&&(n.has(i.bank)||n.set(i.bank,[]),n.get(i.bank).push(i))}),n.forEach((i,a)=>{r.push(...this.checkVCCOConsistency(a,i)),r.push(...this.checkIOStandardCompatibility(a,i)),r.push(...this.checkDifferentialPairBankConstraints(a,i)),r.push(...this.checkSpecialPinConstraints(a,i)),r.push(...this.checkHighSpeedSignalConstraints(a,i))}),r}static getIOStandard(t){var r,n,i;return((r=t.attributes)==null?void 0:r.IO_Standard)||((n=t.attributes)==null?void 0:n.io_standard)||((i=t.attributes)==null?void 0:i.iostandard)}static checkVCCOConsistency(t,r){const n=[],i=new Set(r.map(a=>a.voltage).filter(a=>a&&a!==""&&a!=="0V"));return i.size>1&&n.push({id:`bank-vcco-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`VCCO voltage mismatch in Bank ${t}`,description:`Bank ${t} contains pins with different VCCO voltages: ${Array.from(i).join(", ")}. All pins in a bank must share the same VCCO.`,affectedPins:r.map(a=>a.id),suggestion:"Configure all pins in the same bank to use the same VCCO voltage level.",autoFixable:!1,timestamp:Date.now()}),n}static checkIOStandardCompatibility(t,r){const n=[],i=r.map(o=>this.getIOStandard(o)).filter(o=>o&&o!=="");if(i.length===0)return n;const a=[...new Set(i)];if(a.length<=1)return n;const s=[{group1:["LVCMOS33","LVCMOS25","LVCMOS18","LVCMOS15","LVCMOS12"],group2:["LVDS","LVDS_25","BLVDS_25","MLVDS_25"],reason:"Single-ended and differential standards cannot share the same bank"},{group1:["SSTL135","SSTL125","SSTL15"],group2:["POD12","POD10"],reason:"SSTL and POD standards require different reference voltages"},{group1:["HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18"],group2:["LVCMOS33","LVCMOS25"],reason:"HSTL requires center-tap termination, incompatible with LVCMOS"},{group1:["MIPI_DPHY_DCI"],group2:["LVCMOS18","LVCMOS12"],reason:"MIPI DPHY requires dedicated differential signaling"}];for(const o of s){const u=o.group1.some(d=>a.includes(d)),f=o.group2.some(d=>a.includes(d));if(u&&f){const d=r.filter(p=>o.group1.includes(this.getIOStandard(p)||"")||o.group2.includes(this.getIOStandard(p)||""));n.push({id:`bank-iostd-conflict-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`Incompatible I/O standards in Bank ${t}`,description:`${o.reason}. Found: ${a.join(", ")}`,affectedPins:d.map(p=>p.id),suggestion:"Separate incompatible I/O standards into different banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkDifferentialPairBankConstraints(t,r){const n=[],i=new Map;return r.forEach(a=>{if(!a.signalName)return;const s=this.getDifferentialBaseName(a.signalName);s&&(i.has(s)||i.set(s,[]),i.get(s).push(a))}),i.forEach((a,s)=>{if(a.length===2){const[o,u]=a;o.bank!==u.bank&&n.push({id:`diff-pair-bank-cross-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair crosses bank boundary",description:`Differential pair "${s}" has pins in different banks: ${o.pinNumber} (Bank ${o.bank}) and ${u.pinNumber} (Bank ${u.bank})`,affectedPins:[o.id,u.id],suggestion:"Place both pins of a differential pair in the same bank.",autoFixable:!1,timestamp:Date.now()});const f=this.getIOStandard(o),d=this.getIOStandard(u);f&&d&&f!==d&&n.push({id:`diff-pair-iostd-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair I/O standard mismatch",description:`Differential pair "${s}" has mismatched I/O standards: ${f} vs ${d}`,affectedPins:[o.id,u.id],suggestion:"Use the same I/O standard for both pins in a differential pair.",autoFixable:!1,timestamp:Date.now()})}}),n}static checkSpecialPinConstraints(t,r){const n=[],i=r.filter(s=>{var o,u,f,d,p;return((o=s.pinType)==null?void 0:o.includes("CLOCK"))||((u=s.pinType)==null?void 0:u.includes("GLOBAL"))||((f=s.pinType)==null?void 0:f.includes("CONFIG"))||((d=s.pinName)==null?void 0:d.startsWith("IO_L"))&&((p=s.pinName)==null?void 0:p.includes("CC"))}),a=r.filter(s=>!i.includes(s));if(i.length>0&&a.length>0){const s=i.filter(o=>{var u,f;return((u=o.signalName)==null?void 0:u.toLowerCase().includes("clk"))||((f=o.signalName)==null?void 0:f.toLowerCase().includes("clock"))});if(s.length>0){const o=s.filter(u=>{var f,d,p,g;return((f=u.signalName)==null?void 0:f.includes("100"))||((d=u.signalName)==null?void 0:d.includes("200"))||((p=u.signalName)==null?void 0:p.includes("GHz"))||((g=this.getIOStandard(u))==null?void 0:g.includes("LVDS"))});o.length>0&&a.length>0&&n.push({id:`bank-clock-isolation-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`High-speed clocks mixed with regular I/O in Bank ${t}`,description:"High-speed clock signals may cause noise coupling with regular I/O signals",affectedPins:[...o.map(u=>u.id),...a.slice(0,3).map(u=>u.id)],suggestion:"Consider isolating high-speed clock signals in dedicated banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkHighSpeedSignalConstraints(t,r){const n=[],i=r.filter(s=>{var u,f,d,p;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return o.includes("ddr")||o.includes("pcie")||o.includes("serdes")||o.includes("mgt")||o.includes("lvds")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVDS"))||((d=this.getIOStandard(s))==null?void 0:d.includes("SSTL"))||((p=this.getIOStandard(s))==null?void 0:p.includes("POD"))}),a=r.filter(s=>{var u,f;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return(o.includes("gpio")||o.includes("led")||o.includes("button")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVCMOS")))&&!i.includes(s)});return i.length>0&&a.length>0&&n.push({id:`bank-speed-mix-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`Mixed signal speeds in Bank ${t}`,description:`Bank ${t} contains both high-speed (${i.length}) and low-speed (${a.length}) signals`,affectedPins:[...i.slice(0,2).map(s=>s.id),...a.slice(0,2).map(s=>s.id)],suggestion:"Consider grouping signals by speed to minimize noise coupling.",autoFixable:!1,timestamp:Date.now()}),n}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);if(r.endsWith("p")&&!r.endsWith("_p")||r.endsWith("n")&&!r.endsWith("_n")){const n=r.charAt(r.length-2);if(/[\d_-]/.test(n))return t.slice(0,-1)}return null}static calculateSummary(t){const r={totalIssues:t.length,errorCount:0,warningCount:0,infoCount:0};return t.forEach(n=>{switch(n.severity){case"error":r.errorCount++;break;case"warning":r.warningCount++;break;case"info":r.infoCount++;break}}),r}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static getIssuesForPin(t,r){return r.filter(n=>n.affectedPins.includes(t))}static getIssuesByType(t,r){return r.filter(n=>n.type===t)}static getIssuesBySeverity(t,r){return r.filter(n=>n.severity===t)}}vl.listeners=new Set;const yj=(e,t,r={})=>{const{enabled:n=!0,debounceMs:i=1e3,backgroundCheck:a=!0}=r,[s,o]=ke.useState(null),[u,f]=ke.useState(!1),d=ke.useRef(null),p=ke.useRef(""),g=ke.useCallback(async()=>{if(!n||!e||t.length===0)return;const w=JSON.stringify({packageId:e.id,pinsData:t.map(x=>({id:x.id,signalName:x.signalName,bank:x.bank,voltage:x.voltage,pinName:x.pinName}))});if(w!==p.current)if(p.current=w,a){f(!0);try{const x=await vl.validateProjectAsync(e,t);o(x)}catch(x){console.error("Validation error:",x)}finally{f(!1)}}else{const x=vl.validateProject(e,t);o(x)}},[e,t,n,a]),v=ke.useCallback(()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{g()},i)},[g,i]);ke.useEffect(()=>(n&&v(),()=>{d.current&&clearTimeout(d.current)}),[t,e,n,v]);const m=ke.useCallback(()=>{p.current="",g()},[g]),_=ke.useCallback(w=>s?vl.getIssuesForPin(w,s.issues):[],[s]),C=ke.useCallback(w=>s?vl.getIssuesByType(w,s.issues):[],[s]),S=ke.useCallback(w=>s?vl.getIssuesBySeverity(w,s.issues):[],[s]);return{validationResult:s,isValidating:u,manualValidate:m,getIssuesForPin:_,getIssuesByType:C,getIssuesBySeverity:S,hasErrors:s?s.summary.errorCount>0:!1,hasWarnings:s?s.summary.warningCount>0:!1,hasIssues:s?s.summary.totalIssues>0:!1,errorCount:(s==null?void 0:s.summary.errorCount)||0,warningCount:(s==null?void 0:s.summary.warningCount)||0,totalIssues:(s==null?void 0:s.summary.totalIssues)||0}},_j=`# Xilinx XC7A12T Package Data
# Copyright (C) 2024 Sample Data
Pin,Pin Name,Memory Byte Group,Bank,VCCAUX Group,Super Logic Region,I/O Type,No-Connect
A1,IO_L1P_T0_D00_MOSI_14,0,14,NA,X0Y0,HR,FALSE
A2,IO_L1N_T0_D01_DIN_14,0,14,NA,X0Y0,HR,FALSE
B1,VCCINT,NA,NA,NA,NA,POWER,FALSE
B2,GND,NA,NA,NA,NA,GROUND,FALSE
C1,IO_L2P_T0_D02_14,0,14,NA,X0Y0,HR,FALSE
C2,IO_L2N_T0_D03_14,0,14,NA,X0Y0,HR,FALSE
D1,CONFIG_DONE,NA,NA,NA,NA,CONFIG,FALSE
D2,MGTPRXP1_216,NA,216,NA,NA,GTP,FALSE`,Sj=()=>{const e=new Blob([_j],{type:"text/csv"});return new File([e],"sample-fpga-pins.csv",{type:"text/csv"})},wj=()=>{const e=ke.useRef(null),[t,r]=ke.useState(!1),[n,i]=ke.useState(null),[a,s]=ke.useState(!1),[o,u]=ke.useState(!1),[f,d]=ke.useState("validation"),[p,g]=ke.useState(!1),[v,m]=ke.useState(!1),[_,C]=ke.useState(!1),[S,w]=ke.useState(!1),[x,T]=ke.useState(320),[A,N]=ke.useState(280),[R,P]=ke.useState(null);vj(),ke.useEffect(()=>{const Ie=qe=>{qe.key==="F11"&&(qe.preventDefault(),_e())};return document.addEventListener("keydown",Ie),()=>{document.removeEventListener("keydown",Ie)}},[v,_,S]),ke.useEffect(()=>{const Ie=()=>{u(!0)};return document.addEventListener("showKeyboardHelp",Ie),()=>{document.removeEventListener("showKeyboardHelp",Ie)}},[]),ke.useEffect(()=>{if(typeof window.acquireVsCodeApi<"u"&&!window.vscode)try{const Ie=window.acquireVsCodeApi();window.vscode=Ie}catch(Ie){console.error("Failed to initialize VS Code API:",Ie)}},[]),ke.useEffect(()=>{const Ie=qe=>{p&&(qe.target.closest("[data-export-menu]")||g(!1))};return document.addEventListener("click",Ie),()=>{document.removeEventListener("click",Ie)}},[p]);const{pins:I,filteredPins:b,selectedPins:M,package:D,filters:Q,viewConfig:he,listView:z,loadPackage:Z,selectPin:ae,assignSignal:ne,updatePin:K,updateFilters:ce,setError:me,setLoading:L,setRotation:ee,toggleView:q,setZoom:Y,resetZoom:de,setSortField:V,setSortOrder:ie,setViewMode:ge}=Yi(),_e=()=>{m(!v),v?(C(!1),w(!1)):(C(!0),w(!0),setTimeout(()=>{de()},100))},Me=Ie=>qe=>{qe.preventDefault(),P(Ie)},H=Ie=>{if(!R)return;const qe=window.innerWidth;if(R==="left"){const Ge=Math.max(200,Math.min(500,Ie.clientX));T(Ge)}else if(R==="right"){const Ge=Math.max(200,Math.min(500,qe-Ie.clientX));N(Ge)}},tt=()=>{P(null)};ke.useEffect(()=>(document.addEventListener("mousemove",H),document.addEventListener("mouseup",tt),()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",tt)}),[R]),ke.useEffect(()=>{const Ie=qe=>{const Ge=qe.data;switch(Ge.command||Ge.type){case"update":try{if(Ge.text&&Ge.filePath){const Je=JSON.parse(Ge.text);if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)Z(ut.packageData),me(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid file format: missing package or pins data")}else console.warn("📄 Update message missing text or filePath")}catch(Je){console.error("Failed to parse .fpgaproj file:",Je),me(`Failed to load .fpgaproj file: ${Je}`)}break;case"loadFileContent":try{if(Ge.error)throw new Error(Ge.error);if(Ge.content&&Ge.filePath){const Je=JSON.parse(Ge.content);if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)Z(ut.packageData),me(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid file format: missing package or pins data")}}catch(Je){console.error("Failed to load file content:",Je),me(`Failed to load file: ${Je}`)}break;case"loadProject":try{if(Ge.projectData){const Je=Ge.projectData;if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)Z(ut.packageData),me(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid project data format")}}catch(Je){console.error("Failed to load project from VS Code:",Je),me(`Failed to load project: ${Je}`)}break;case"loadSampleData":(async()=>{try{const Je=Sj();r(!0),L(!0),me(null);const ut=await Hf.parseCSVFile(Je);if(ut.success){const Pt=Hf.createPackageFromPins(ut.pins,Je.name);Z(Pt),ut.warnings.length>0&&console.warn("Sample data import warnings:",ut.warnings)}else me(`Failed to load sample data: ${ut.errors.join(", ")}`)}catch(Je){console.error("Failed to load sample data from VS Code:",Je),me(`Failed to load sample data: ${Je}`)}finally{r(!1),L(!1)}})();break}};return typeof window.vscode<"u"?(window.addEventListener("message",Ie),setTimeout(()=>{window.vscode.postMessage({command:"webviewReady"})},500),()=>{window.removeEventListener("message",Ie)}):()=>{}},[Z,me]);const{validationResult:nt,isValidating:Xe,hasErrors:Ze,hasWarnings:be,errorCount:Ct,warningCount:Lr}=yj(D,I,{enabled:!0,debounceMs:1e3,backgroundCheck:!0}),ye=()=>{var Ie;(Ie=e.current)==null||Ie.click()},xe=async Ie=>{var Ge;const qe=(Ge=Ie.target.files)==null?void 0:Ge[0];if(qe){r(!0),L(!0),me(null);try{const Je=await Hf.parseCSVFile(qe);if(Je.success){const ut=Hf.createPackageFromPins(Je.pins,qe.name);Z(ut),Je.warnings.length>0&&console.warn("Import warnings:",Je.warnings)}else me(`Failed to import file: ${Je.errors.join(", ")}`)}catch(Je){console.error("💥 ファイル読み取りエラー:",Je),me(`Error reading file: ${Je.message}`)}finally{r(!1),L(!1),e.current&&(e.current.value="")}}},Te=Ie=>{ce({searchText:Ie.target.value})},Ae=Ie=>{const qe=Q.pinTypes,Ge=qe.includes(Ie)?qe.filter(Je=>Je!==Ie):[...qe,Ie];ce({pinTypes:Ge})},Pe=()=>{const Ie=I.length,qe=I.filter(Je=>Je.isAssigned).length,Ge=Ie-qe;return{total:Ie,assigned:qe,unassigned:Ge}},Oe=()=>{ee(he.rotation+90)},Ve=()=>{Y(Math.min(3,he.zoom+.1))},Se=()=>{Y(Math.max(.2,he.zoom-.1))},J=Ie=>{const qe=I.find(Ge=>Ge.id===Ie);if(qe){const Ge=prompt("Enter signal name:",qe.signalName);Ge!==null&&ne(Ie,Ge)}},Ee=Ie=>{ae(Ie),i(Ie||null)},Fe=Ie=>{ae(Ie)},Ce=()=>{const Ie=typeof window.vscode<"u",qe=typeof window.acquireVsCodeApi<"u",Ge=window.location.protocol.includes("vscode-resource")||window.location.protocol.includes("vscode-webview")||window.navigator.userAgent.includes("Electron");return Ie||qe||Ge},Qe=async(Ie,qe,Ge,Je)=>{if(!Ce())return!1;try{let ut=window.vscode;if(!ut&&typeof window.acquireVsCodeApi<"u"&&(ut=window.acquireVsCodeApi(),window.vscode=ut),!ut||typeof ut.postMessage!="function")return!1;const Pt=await new Promise((Ot,kn)=>{const tn=setTimeout(()=>{window.removeEventListener("message",mt),kn(new Error("Save dialog timeout"))},3e4),mt=lr=>{lr.data.command==="saveDialogResult"&&(clearTimeout(tn),window.removeEventListener("message",mt),Ot(lr.data.result))};window.addEventListener("message",mt);const rn={command:"showSaveDialog",options:{saveLabel:Je,filters:Ge}};try{ut.postMessage(rn)}catch(lr){console.error("Failed to send message:",lr),kn(lr)}});if(Pt){let Ot;if(typeof Pt=="string")Ot=Pt;else if(Pt&&typeof Pt=="object"){const tn=Pt;Ot=tn.fsPath||tn.path,!Ot&&typeof Pt.toString=="function"&&(Ot=Pt.toString())}return!Ot||Ot==="undefined"||Ot==="[object Object]"?(console.error("Failed to extract valid file path from URI"),!1):await new Promise(tn=>{const mt=rn=>{rn.data.command==="saveFileResult"&&(window.removeEventListener("message",mt),tn(rn.data.success))};window.addEventListener("message",mt),ut.postMessage({command:"saveFile",filePath:Ot,content:Ie,filename:qe})})}}catch(ut){console.error("VS Code save failed:",ut)}return!1},et=async Ie=>{const qe=b.length>0?b:I;if(qe.length===0)return;let Ge,Je,ut,Pt,Ot;Ie==="xdc"?(Ge=Ia.exportToXDC(qe,D),Je=`${(D==null?void 0:D.device)||"fpga"}_pins.xdc`,ut="text/plain",Pt={"XDC Files":["xdc"],"All Files":["*"]},Ot="Export XDC Constraints"):(Ge=Ia.exportToSDC(qe,D),Je=`${(D==null?void 0:D.device)||"fpga"}_pins.sdc`,ut="text/plain",Pt={"SDC Files":["sdc"],"All Files":["*"]},Ot="Export SDC Constraints"),await Qe(Ge,Je,Pt,Ot)||Ia.downloadFile(Ge,Je,ut)},lt=async()=>{const Ie=b.length>0?b:I;if(Ie.length===0)return;const qe=Ia.exportToCSV(Ie),Ge=`${(D==null?void 0:D.device)||"fpga"}_pins.csv`;await Qe(qe,Ge,{"CSV Files":["csv"],"All Files":["*"]},"Export Pin Data to CSV")||Ia.downloadFile(qe,Ge,"text/csv")},Ye=async()=>{const Ie=b.length>0?b:I;if(Ie.length===0)return;const qe=Ia.exportReport(Ie,D),Ge=`${(D==null?void 0:D.device)||"fpga"}_report.txt`;await Qe(qe,Ge,{"Text Files":["txt"],"All Files":["*"]},"Export Pin Assignment Report")||Ia.downloadFile(qe,Ge,"text/plain")},xt=Pe(),{sortedPinsForList:si}=kr.useMemo(()=>{const Ie=[...b];return Ie.sort((qe,Ge)=>{var tn,mt;const Je=n&&qe.id===n,ut=n&&Ge.id===n;if(Je&&!ut)return-1;if(!Je&&ut)return 1;if(n&&!Je&&!ut){const rn=b.find(lr=>lr.id===n);if(rn){const lr=Ht.findPairPin(rn,b),Yo=(lr==null?void 0:lr.id)===qe.id,Qo=(lr==null?void 0:lr.id)===Ge.id;if(Yo&&!Qo)return-1;if(!Yo&&Qo)return 1}}let Pt,Ot;switch(Q.sortField){case"pinNumber":Pt=qe.pinNumber,Ot=Ge.pinNumber;break;case"pinName":Pt=qe.pinName,Ot=Ge.pinName;break;case"signalName":Pt=qe.signalName||"",Ot=Ge.signalName||"";break;case"pinType":Pt=qe.pinType,Ot=Ge.pinType;break;case"bank":Pt=qe.bank||"",Ot=Ge.bank||"";break;case"grid":if(qe.gridPosition&&Ge.gridPosition){const rn=K6(qe.gridPosition.row,Ge.gridPosition.row);if(rn!==0)return Q.sortOrder==="asc"?rn:-rn;const lr=qe.gridPosition.col-Ge.gridPosition.col;return Q.sortOrder==="asc"?lr:-lr}Pt=((tn=qe.gridPosition)==null?void 0:tn.row)||"",Ot=((mt=Ge.gridPosition)==null?void 0:mt.row)||"";break;default:Pt=qe.pinNumber,Ot=Ge.pinNumber}const kn=Pt.localeCompare(Ot,void 0,{numeric:!0,sensitivity:"base"});return Q.sortOrder==="asc"?kn:-kn}),{sortedPinsForList:Ie}},[b,Q.sortField,Q.sortOrder,n,I]);return k.jsxs("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',display:"flex",flexDirection:"column"},children:[k.jsxs("header",{style:{height:"36px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",flexShrink:0,minHeight:"36px"},children:[k.jsx("h1",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#4A90E2"},children:"FPGA Pin Planner"}),k.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"12px",alignItems:"center"},children:[k.jsx("button",{onClick:_e,style:{padding:"6px 12px",backgroundColor:v?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px",color:v?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},title:v?"Restore Normal View (F11)":"Maximize Viewer (F11)",children:v?"� Restore":"� Maximize"}),k.jsx("input",{ref:e,type:"file",accept:".csv,.txt,.xlsx,.xls",onChange:xe,style:{display:"none"}}),k.jsx("button",{onClick:ye,disabled:t,style:{padding:"8px 16px",backgroundColor:t?"#666":"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:t?"not-allowed":"pointer",fontSize:"14px"},children:t?"📂 Loading...":"📂 Open Pin File"}),k.jsxs("div",{style:{position:"relative"},"data-export-menu":!0,children:[k.jsxs("button",{onClick:()=>g(!p),disabled:b.length===0&&I.length===0,style:{padding:"8px 16px",backgroundColor:b.length>0||I.length>0?"#4A90E2":"#666",border:"none",borderRadius:"4px",color:"white",cursor:b.length>0||I.length>0?"pointer":"not-allowed",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},title:"Export Pin Data",children:["💾 Export ",p?"▲":"▼"]}),p&&(b.length>0||I.length>0)&&k.jsxs("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",zIndex:1e3,minWidth:"160px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[k.jsx("button",{onClick:()=>{s(!0),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Ie=>Ie.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ie=>Ie.currentTarget.style.backgroundColor="transparent",children:"📄 Constraints (XDC/SDC)"}),k.jsx("button",{onClick:()=>{lt(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Ie=>Ie.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ie=>Ie.currentTarget.style.backgroundColor="transparent",children:"� CSV Data"}),k.jsx("button",{onClick:()=>{Ye(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px"},onMouseEnter:Ie=>Ie.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ie=>Ie.currentTarget.style.backgroundColor="transparent",children:"📋 Report"})]})]})]})]}),k.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0,height:"100%"},children:[!_&&k.jsxs("aside",{style:{width:`${x}px`,backgroundColor:"#252525",borderRight:"1px solid #444",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%",minWidth:"200px",maxWidth:"500px"},children:[k.jsx("div",{onMouseDown:Me("left"),style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:R==="left"?"#007acc":"transparent"},title:"Drag to resize panel"}),k.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #444"},children:[k.jsx("input",{type:"text",placeholder:"Search pins...",value:Q.searchText,onChange:Te,style:{width:"100%",padding:"8px 12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),k.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",alignItems:"center"},children:[k.jsx("span",{style:{fontSize:"12px",color:"#999"},children:"Sort:"}),k.jsxs("select",{value:Q.sortField,onChange:Ie=>V(Ie.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",fontSize:"12px",cursor:"pointer"},children:[k.jsx("option",{value:"pinNumber",children:"Pin Number"}),k.jsx("option",{value:"pinName",children:"Pin Name"}),k.jsx("option",{value:"signalName",children:"Signal Name"}),k.jsx("option",{value:"pinType",children:"Pin Type"}),k.jsx("option",{value:"bank",children:"Bank"}),k.jsx("option",{value:"grid",children:"Grid Position"})]}),k.jsx("button",{onClick:()=>ie(Q.sortOrder==="asc"?"desc":"asc"),style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px"},title:`Sort ${Q.sortOrder==="asc"?"Descending":"Ascending"}`,children:Q.sortOrder==="asc"?"↑":"↓"})]}),k.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",flexWrap:"wrap"},children:[k.jsxs("button",{onClick:()=>ce({pinTypes:[]}),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.length===0?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["All (",I.length,")"]}),k.jsxs("button",{onClick:()=>Ae("IO"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("IO")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["I/O (",I.filter(Ie=>Ie.pinType==="IO").length,")"]}),k.jsxs("button",{onClick:()=>Ae("POWER"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("POWER")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["Power (",I.filter(Ie=>Ie.pinType==="POWER").length,")"]})]})]}),k.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:I.length===0?k.jsxs(k.Fragment,{children:[k.jsx("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px"},children:"No package loaded"}),k.jsxs("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:["Debug: pins=",I.length,", package=",(D==null?void 0:D.name)||"null"]}),k.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"14px"},children:[k.jsx("div",{style:{marginBottom:"12px"},children:"📁"}),k.jsx("div",{children:"Load a CSV file to start"})]})]}):k.jsxs(k.Fragment,{children:[k.jsxs("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px",display:"flex",justifyContent:"space-between"},children:[k.jsx("span",{children:(D==null?void 0:D.name)||"Package"}),k.jsxs("span",{children:["Showing ",b.length," of ",I.length]})]}),k.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:si.map(Ie=>{const qe=n?I.find(ut=>ut.id===n):null,Ge=qe?Ht.findPairPin(qe,I):null,Je=(Ge==null?void 0:Ge.id)===Ie.id;return k.jsx(Pb,{pin:Ie,isSelected:M.has(Ie.id),onSelect:Fe,onAssignSignal:ne,onUpdatePin:K,isPairPin:!1,isDifferentialPairPartner:Je},Ie.id)})})]})})]}),k.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0,minHeight:0},children:[k.jsxs("div",{className:"toolbar-scrollbar",style:{height:"32px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 12px",gap:"8px",overflowX:"auto",overflowY:"hidden",flexShrink:0,minHeight:"32px"},children:[k.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[k.jsx("button",{onClick:()=>ge("grid"),style:{padding:"4px 8px",backgroundColor:z.viewMode==="grid"?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px 0 0 4px",color:z.viewMode==="grid"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"Grid View",children:"🎯 Grid"}),k.jsx("button",{onClick:()=>ge("list"),style:{padding:"4px 8px",backgroundColor:z.viewMode==="list"?"#007acc":"#333",border:"1px solid #555",borderRadius:"0 4px 4px 0",color:z.viewMode==="list"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"List View",children:"📋 List"})]}),k.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),k.jsx("button",{onClick:Oe,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:"🔄 Rotate 90°"}),k.jsx("button",{onClick:q,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:"↕️ Flip View"}),k.jsx("div",{style:{flexShrink:0},children:k.jsx(lj,{})}),k.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),k.jsx("div",{style:{flexShrink:0},children:k.jsx(cj,{})}),k.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),k.jsxs("button",{onClick:()=>d(f==="validation"?null:"validation"),style:{padding:"6px 12px",backgroundColor:f==="validation"?"#4a5568":Ze?"#dc2626":be?"#d97706":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:`Validation: ${Ct} errors, ${Lr} warnings (click for details)`,children:[k.jsx(pj,{validationResult:nt}),k.jsx("span",{children:"Validation"}),Xe&&k.jsx("span",{className:"animate-spin",children:"⚡"})]}),k.jsxs("button",{onClick:()=>d(f==="batch"?null:"batch"),style:{padding:"6px 12px",backgroundColor:f==="batch"?"#4a5568":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:"Batch Operations - Assign patterns to multiple pins",children:[k.jsx("span",{children:"🔧"}),k.jsx("span",{children:"Batch Ops"})]}),k.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),k.jsx("button",{onClick:()=>u(!0),style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},title:"Keyboard Shortcuts (Ctrl+Shift+?)",children:"⌨️ Shortcuts"}),k.jsx("div",{style:{flex:1,minWidth:"20px"}}),k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0,backgroundColor:"#2a2a2a",padding:"0 8px",borderRadius:"4px"},children:[k.jsx("span",{style:{fontSize:"12px",color:"#999",whiteSpace:"nowrap"},children:"Zoom:"}),k.jsx("button",{onClick:Se,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"-"}),k.jsxs("button",{onClick:de,style:{padding:"4px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",minWidth:"50px",whiteSpace:"nowrap"},title:"Reset zoom to 100%",children:[Math.round(he.zoom*100),"%"]}),k.jsx("button",{onClick:Ve,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"+"})]})]}),k.jsxs("div",{style:{flex:1,minWidth:"0",backgroundColor:"#1a1a1a",overflow:"hidden",display:"flex",flexShrink:1,width:"100%",minHeight:0,height:"100%"},children:[k.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minWidth:0,width:"100%",minHeight:0,height:"100%"},children:z.viewMode==="grid"?k.jsx(oj,{package:D,pins:b,selectedPins:M,onPinSelect:Ee,onPinDoubleClick:J,zoom:he.zoom,rotation:he.rotation,isTopView:he.isTopView,onZoomChange:Y}):k.jsx("div",{style:{height:"100%",backgroundColor:"#1a1a1a",overflow:"hidden",width:"100%",minHeight:0},children:k.jsx(Xb,{onPinSelect:Fe})})}),!_&&f&&k.jsxs("div",{style:{width:`${A}px`,minWidth:"200px",maxWidth:"500px",borderLeft:"1px solid #555",backgroundColor:"#1e1e1e",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minHeight:0,position:"relative"},children:[k.jsx("div",{onMouseDown:Me("right"),style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:R==="right"?"#007acc":"transparent"},title:"Drag to resize panel"}),f==="validation"&&k.jsx("div",{style:{height:"100%",overflow:"hidden"},className:"custom-scrollbar",children:k.jsx(hj,{validationResult:nt,onIssueClick:Ie=>{Ie.affectedPins&&Ie.affectedPins.length>0}})}),f==="batch"&&k.jsx("div",{style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:k.jsx(gj,{isVisible:!0})})]})]})]})]}),!S&&k.jsxs("footer",{style:{height:"16px",backgroundColor:"#2a2a2a",borderTop:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",fontSize:"10px",color:"#999",flexShrink:0},children:[k.jsx("span",{children:"Ready"}),k.jsx("div",{style:{marginLeft:"auto"},children:k.jsxs("span",{children:["Pins: ",xt.total," | Assigned: ",xt.assigned," | Unassigned: ",xt.unassigned]})})]}),k.jsx(Fb,{isOpen:a,onClose:()=>s(!1),onExport:et,pins:I,currentPackage:D}),k.jsx(dj,{isOpen:o,onClose:()=>u(!1)})]})};Fg.createRoot(document.getElementById("root")).render(k.jsx(kr.StrictMode,{children:k.jsx(wj,{})}));
