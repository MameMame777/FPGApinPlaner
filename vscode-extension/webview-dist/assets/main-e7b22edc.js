(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var h4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k5={exports:{}},Jd={},E5={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iu=Symbol.for("react.element"),ok=Symbol.for("react.portal"),lk=Symbol.for("react.fragment"),ck=Symbol.for("react.strict_mode"),uk=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),hk=Symbol.for("react.forward_ref"),pk=Symbol.for("react.suspense"),gk=Symbol.for("react.memo"),mk=Symbol.for("react.lazy"),p4=Symbol.iterator;function xk(e){return e===null||typeof e!="object"?null:(e=p4&&e[p4]||e["@@iterator"],typeof e=="function"?e:null)}var C5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T5=Object.assign,A5={};function tc(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}tc.prototype.isReactComponent={};tc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};tc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function P5(){}P5.prototype=tc.prototype;function Wm(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}var $m=Wm.prototype=new P5;$m.constructor=Wm;T5($m,tc.prototype);$m.isPureReactComponent=!0;var g4=Array.isArray,F5=Object.prototype.hasOwnProperty,Xm={current:null},N5={key:!0,ref:!0,__self:!0,__source:!0};function R5(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)F5.call(t,n)&&!N5.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),f=0;f<o;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:iu,type:e,key:a,ref:s,props:i,_owner:Xm.current}}function vk(e,t){return{$$typeof:iu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Km(e){return typeof e=="object"&&e!==null&&e.$$typeof===iu}function yk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var m4=/\/+/g;function Ep(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yk(""+e.key):t.toString(36)}function $f(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case iu:case ok:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+Ep(s,0):n,g4(i)?(r="",e!=null&&(r=e.replace(m4,"$&/")+"/"),$f(i,t,r,"",function(f){return f})):i!=null&&(Km(i)&&(i=vk(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(m4,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",g4(e))for(var o=0;o<e.length;o++){a=e[o];var u=n+Ep(a,o);s+=$f(a,t,r,u,i)}else if(u=xk(e),typeof u=="function")for(e=u.call(e),o=0;!(a=e.next()).done;)a=a.value,u=n+Ep(a,o++),s+=$f(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function hf(e,t,r){if(e==null)return e;var n=[],i=0;return $f(e,n,"","",function(a){return t.call(r,a,i++)}),n}function _k(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var In={current:null},Xf={transition:null},Sk={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:Xf,ReactCurrentOwner:Xm};function b5(){throw Error("act(...) is not supported in production builds of React.")}_t.Children={map:hf,forEach:function(e,t,r){hf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return hf(e,function(){t++}),t},toArray:function(e){return hf(e,function(t){return t})||[]},only:function(e){if(!Km(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_t.Component=tc;_t.Fragment=lk;_t.Profiler=uk;_t.PureComponent=Wm;_t.StrictMode=ck;_t.Suspense=pk;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sk;_t.act=b5;_t.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=T5({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Xm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)F5.call(t,u)&&!N5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var f=0;f<u;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:iu,type:e.type,key:i,ref:a,props:n,_owner:s}};_t.createContext=function(e){return e={$$typeof:dk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fk,_context:e},e.Consumer=e};_t.createElement=R5;_t.createFactory=function(e){var t=R5.bind(null,e);return t.type=e,t};_t.createRef=function(){return{current:null}};_t.forwardRef=function(e){return{$$typeof:hk,render:e}};_t.isValidElement=Km;_t.lazy=function(e){return{$$typeof:mk,_payload:{_status:-1,_result:e},_init:_k}};_t.memo=function(e,t){return{$$typeof:gk,type:e,compare:t===void 0?null:t}};_t.startTransition=function(e){var t=Xf.transition;Xf.transition={};try{e()}finally{Xf.transition=t}};_t.unstable_act=b5;_t.useCallback=function(e,t){return In.current.useCallback(e,t)};_t.useContext=function(e){return In.current.useContext(e)};_t.useDebugValue=function(){};_t.useDeferredValue=function(e){return In.current.useDeferredValue(e)};_t.useEffect=function(e,t){return In.current.useEffect(e,t)};_t.useId=function(){return In.current.useId()};_t.useImperativeHandle=function(e,t,r){return In.current.useImperativeHandle(e,t,r)};_t.useInsertionEffect=function(e,t){return In.current.useInsertionEffect(e,t)};_t.useLayoutEffect=function(e,t){return In.current.useLayoutEffect(e,t)};_t.useMemo=function(e,t){return In.current.useMemo(e,t)};_t.useReducer=function(e,t,r){return In.current.useReducer(e,t,r)};_t.useRef=function(e){return In.current.useRef(e)};_t.useState=function(e){return In.current.useState(e)};_t.useSyncExternalStore=function(e,t,r){return In.current.useSyncExternalStore(e,t,r)};_t.useTransition=function(){return In.current.useTransition()};_t.version="18.3.1";E5.exports=_t;var Se=E5.exports;const kr=qd(Se);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk=Se,kk=Symbol.for("react.element"),Ek=Symbol.for("react.fragment"),Ck=Object.prototype.hasOwnProperty,Tk=wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ak={key:!0,ref:!0,__self:!0,__source:!0};function I5(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Ck.call(t,n)&&!Ak.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:kk,type:e,key:a,ref:s,props:i,_owner:Tk.current}}Jd.Fragment=Ek;Jd.jsx=I5;Jd.jsxs=I5;k5.exports=Jd;var E=k5.exports,Cg={},D5={exports:{}},ii={},O5={exports:{}},L5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,X){var he=oe.length;oe.push(X);e:for(;0<he;){var _e=he-1>>>1,M=oe[_e];if(0<i(M,X))oe[_e]=X,oe[he]=M,he=_e;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var X=oe[0],he=oe.pop();if(he!==X){oe[0]=he;e:for(var _e=0,M=oe.length,J=M>>>1;_e<J;){var Q=2*(_e+1)-1,Y=oe[Q],ue=Q+1,z=oe[ue];if(0>i(Y,he))ue<M&&0>i(z,Y)?(oe[_e]=z,oe[ue]=he,_e=ue):(oe[_e]=Y,oe[Q]=he,_e=Q);else if(ue<M&&0>i(z,he))oe[_e]=z,oe[ue]=he,_e=ue;else break e}}return X}function i(oe,X){var he=oe.sortIndex-X.sortIndex;return he!==0?he:oe.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],f=[],d=1,p=null,g=3,v=!1,m=!1,y=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(oe){for(var X=r(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=oe)n(f),X.sortIndex=X.expirationTime,t(u,X);else break;X=r(f)}}function T(oe){if(y=!1,x(oe),!m)if(r(u)!==null)m=!0,ke(A);else{var X=r(f);X!==null&&we(T,X.startTime-oe)}}function A(oe,X){m=!1,y&&(y=!1,S(P),P=-1),v=!0;var he=g;try{for(x(X),p=r(u);p!==null&&(!(p.expirationTime>X)||oe&&!O());){var _e=p.callback;if(typeof _e=="function"){p.callback=null,g=p.priorityLevel;var M=_e(p.expirationTime<=X);X=e.unstable_now(),typeof M=="function"?p.callback=M:p===r(u)&&n(u),x(X)}else n(u);p=r(u)}if(p!==null)var J=!0;else{var Q=r(f);Q!==null&&we(T,Q.startTime-X),J=!1}return J}finally{p=null,g=he,v=!1}}var F=!1,N=null,P=-1,I=5,b=-1;function O(){return!(e.unstable_now()-b<I)}function L(){if(N!==null){var oe=e.unstable_now();b=oe;var X=!0;try{X=N(!0,oe)}finally{X?K():(F=!1,N=null)}}else F=!1}var K;if(typeof w=="function")K=function(){w(L)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,re=ie.port2;ie.port1.onmessage=L,K=function(){re.postMessage(null)}}else K=function(){C(L,0)};function ke(oe){N=oe,F||(F=!0,K())}function we(oe,X){P=C(function(){oe(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){m||v||(m=!0,ke(A))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(oe){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var he=g;g=X;try{return oe()}finally{g=he}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,X){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var he=g;g=oe;try{return X()}finally{g=he}},e.unstable_scheduleCallback=function(oe,X,he){var _e=e.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?_e+he:_e):he=_e,oe){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=he+M,oe={id:d++,callback:X,priorityLevel:oe,startTime:he,expirationTime:M,sortIndex:-1},he>_e?(oe.sortIndex=he,t(f,oe),r(u)===null&&oe===r(f)&&(y?(S(P),P=-1):y=!0,we(T,he-_e))):(oe.sortIndex=M,t(u,oe),m||v||(m=!0,ke(A))),oe},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(oe){var X=g;return function(){var he=g;g=X;try{return oe.apply(this,arguments)}finally{g=he}}}})(L5);O5.exports=L5;var s0=O5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pk=Se,ti=s0;function Re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M5=new Set,C0={};function No(e,t){Ul(e,t),Ul(e+"Capture",t)}function Ul(e,t){for(C0[e]=t,e=0;e<t.length;e++)M5.add(t[e])}var za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tg=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x4={},v4={};function Nk(e){return Tg.call(v4,e)?!0:Tg.call(x4,e)?!1:Fk.test(e)?v4[e]=!0:(x4[e]=!0,!1)}function Rk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function bk(e,t,r,n){if(t===null||typeof t>"u"||Rk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dn(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var en={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){en[e]=new Dn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];en[t]=new Dn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){en[e]=new Dn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){en[e]=new Dn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){en[e]=new Dn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){en[e]=new Dn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){en[e]=new Dn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){en[e]=new Dn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){en[e]=new Dn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ym=/[\-:]([a-z])/g;function Qm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ym,Qm);en[t]=new Dn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ym,Qm);en[t]=new Dn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ym,Qm);en[t]=new Dn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){en[e]=new Dn(e,1,!1,e.toLowerCase(),null,!1,!1)});en.xlinkHref=new Dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){en[e]=new Dn(e,1,!1,e.toLowerCase(),null,!0,!0)});function qm(e,t,r,n){var i=en.hasOwnProperty(t)?en[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(bk(t,r,i,n)&&(r=null),n||i===null?Nk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Xa=Pk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pf=Symbol.for("react.element"),xl=Symbol.for("react.portal"),vl=Symbol.for("react.fragment"),Jm=Symbol.for("react.strict_mode"),Ag=Symbol.for("react.profiler"),B5=Symbol.for("react.provider"),j5=Symbol.for("react.context"),Zm=Symbol.for("react.forward_ref"),Pg=Symbol.for("react.suspense"),Fg=Symbol.for("react.suspense_list"),e2=Symbol.for("react.memo"),ds=Symbol.for("react.lazy"),U5=Symbol.for("react.offscreen"),y4=Symbol.iterator;function Dc(e){return e===null||typeof e!="object"?null:(e=y4&&e[y4]||e["@@iterator"],typeof e=="function"?e:null)}var sr=Object.assign,Cp;function qc(e){if(Cp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cp=t&&t[1]||""}return`
`+Cp+e}var Tp=!1;function Ap(e,t){if(!e||Tp)return"";Tp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=o);break}}}finally{Tp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qc(e):""}function Ik(e){switch(e.tag){case 5:return qc(e.type);case 16:return qc("Lazy");case 13:return qc("Suspense");case 19:return qc("SuspenseList");case 0:case 2:case 15:return e=Ap(e.type,!1),e;case 11:return e=Ap(e.type.render,!1),e;case 1:return e=Ap(e.type,!0),e;default:return""}}function Ng(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vl:return"Fragment";case xl:return"Portal";case Ag:return"Profiler";case Jm:return"StrictMode";case Pg:return"Suspense";case Fg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case j5:return(e.displayName||"Context")+".Consumer";case B5:return(e._context.displayName||"Context")+".Provider";case Zm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case e2:return t=e.displayName||null,t!==null?t:Ng(e.type)||"Memo";case ds:t=e._payload,e=e._init;try{return Ng(e(t))}catch{}}return null}function Dk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ng(t);case 8:return t===Jm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Rs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function z5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ok(e){var t=z5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function gf(e){e._valueTracker||(e._valueTracker=Ok(e))}function V5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=z5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Rg(e,t){var r=t.checked;return sr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function _4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Rs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function G5(e,t){t=t.checked,t!=null&&qm(e,"checked",t,!1)}function bg(e,t){G5(e,t);var r=Rs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ig(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ig(e,t.type,Rs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function S4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ig(e,t,r){(t!=="number"||sd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jc=Array.isArray;function Nl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Rs(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Dg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Re(91));return sr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function w4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Re(92));if(Jc(r)){if(1<r.length)throw Error(Re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Rs(r)}}function H5(e,t){var r=Rs(t.value),n=Rs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function k4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Og(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mf,$5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(mf=mf||document.createElement("div"),mf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function T0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var o0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lk=["Webkit","ms","Moz","O"];Object.keys(o0).forEach(function(e){Lk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),o0[t]=o0[e]})});function X5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||o0.hasOwnProperty(e)&&o0[e]?(""+t).trim():t+"px"}function K5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=X5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Mk=sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lg(e,t){if(t){if(Mk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Re(62))}}function Mg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bg=null;function t2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jg=null,Rl=null,bl=null;function E4(e){if(e=ou(e)){if(typeof jg!="function")throw Error(Re(280));var t=e.stateNode;t&&(t=nh(t),jg(e.stateNode,e.type,t))}}function Y5(e){Rl?bl?bl.push(e):bl=[e]:Rl=e}function Q5(){if(Rl){var e=Rl,t=bl;if(bl=Rl=null,E4(e),t)for(e=0;e<t.length;e++)E4(t[e])}}function q5(e,t){return e(t)}function J5(){}var Pp=!1;function Z5(e,t,r){if(Pp)return e(t,r);Pp=!0;try{return q5(e,t,r)}finally{Pp=!1,(Rl!==null||bl!==null)&&(J5(),Q5())}}function A0(e,t){var r=e.stateNode;if(r===null)return null;var n=nh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Re(231,t,typeof r));return r}var Ug=!1;if(za)try{var Oc={};Object.defineProperty(Oc,"passive",{get:function(){Ug=!0}}),window.addEventListener("test",Oc,Oc),window.removeEventListener("test",Oc,Oc)}catch{Ug=!1}function Bk(e,t,r,n,i,a,s,o,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var l0=!1,od=null,ld=!1,zg=null,jk={onError:function(e){l0=!0,od=e}};function Uk(e,t,r,n,i,a,s,o,u){l0=!1,od=null,Bk.apply(jk,arguments)}function zk(e,t,r,n,i,a,s,o,u){if(Uk.apply(this,arguments),l0){if(l0){var f=od;l0=!1,od=null}else throw Error(Re(198));ld||(ld=!0,zg=f)}}function Ro(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function e_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function C4(e){if(Ro(e)!==e)throw Error(Re(188))}function Vk(e){var t=e.alternate;if(!t){if(t=Ro(e),t===null)throw Error(Re(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return C4(i),e;if(a===n)return C4(i),t;a=a.sibling}throw Error(Re(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Re(189))}}if(r.alternate!==n)throw Error(Re(190))}if(r.tag!==3)throw Error(Re(188));return r.stateNode.current===r?e:t}function t_(e){return e=Vk(e),e!==null?r_(e):null}function r_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=r_(e);if(t!==null)return t;e=e.sibling}return null}var n_=ti.unstable_scheduleCallback,T4=ti.unstable_cancelCallback,Gk=ti.unstable_shouldYield,Hk=ti.unstable_requestPaint,mr=ti.unstable_now,Wk=ti.unstable_getCurrentPriorityLevel,r2=ti.unstable_ImmediatePriority,i_=ti.unstable_UserBlockingPriority,cd=ti.unstable_NormalPriority,$k=ti.unstable_LowPriority,a_=ti.unstable_IdlePriority,Zd=null,pa=null;function Xk(e){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(Zd,e,void 0,(e.current.flags&128)===128)}catch{}}var Xi=Math.clz32?Math.clz32:Qk,Kk=Math.log,Yk=Math.LN2;function Qk(e){return e>>>=0,e===0?32:31-(Kk(e)/Yk|0)|0}var xf=64,vf=4194304;function Zc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ud(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=Zc(o):(a&=s,a!==0&&(n=Zc(a)))}else s=r&~i,s!==0?n=Zc(s):a!==0&&(n=Zc(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Xi(t),i=1<<r,n|=e[r],t&=~i;return n}function qk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Xi(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=qk(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}function Vg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function s_(){var e=xf;return xf<<=1,!(xf&4194240)&&(xf=64),e}function Fp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function au(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xi(t),e[t]=r}function Zk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Xi(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function n2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Xi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var jt=0;function o_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var l_,i2,c_,u_,f_,Gg=!1,yf=[],ws=null,ks=null,Es=null,P0=new Map,F0=new Map,ps=[],e9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A4(e,t){switch(e){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":P0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":F0.delete(t.pointerId)}}function Lc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=ou(t),t!==null&&i2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function t9(e,t,r,n,i){switch(t){case"focusin":return ws=Lc(ws,e,t,r,n,i),!0;case"dragenter":return ks=Lc(ks,e,t,r,n,i),!0;case"mouseover":return Es=Lc(Es,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return P0.set(a,Lc(P0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,F0.set(a,Lc(F0.get(a)||null,e,t,r,n,i)),!0}return!1}function d_(e){var t=uo(e.target);if(t!==null){var r=Ro(t);if(r!==null){if(t=r.tag,t===13){if(t=e_(r),t!==null){e.blockedOn=t,f_(e.priority,function(){c_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Kf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Hg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Bg=n,r.target.dispatchEvent(n),Bg=null}else return t=ou(r),t!==null&&i2(t),e.blockedOn=r,!1;t.shift()}return!0}function P4(e,t,r){Kf(e)&&r.delete(t)}function r9(){Gg=!1,ws!==null&&Kf(ws)&&(ws=null),ks!==null&&Kf(ks)&&(ks=null),Es!==null&&Kf(Es)&&(Es=null),P0.forEach(P4),F0.forEach(P4)}function Mc(e,t){e.blockedOn===t&&(e.blockedOn=null,Gg||(Gg=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,r9)))}function N0(e){function t(i){return Mc(i,e)}if(0<yf.length){Mc(yf[0],e);for(var r=1;r<yf.length;r++){var n=yf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ws!==null&&Mc(ws,e),ks!==null&&Mc(ks,e),Es!==null&&Mc(Es,e),P0.forEach(t),F0.forEach(t),r=0;r<ps.length;r++)n=ps[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ps.length&&(r=ps[0],r.blockedOn===null);)d_(r),r.blockedOn===null&&ps.shift()}var Il=Xa.ReactCurrentBatchConfig,fd=!0;function n9(e,t,r,n){var i=jt,a=Il.transition;Il.transition=null;try{jt=1,a2(e,t,r,n)}finally{jt=i,Il.transition=a}}function i9(e,t,r,n){var i=jt,a=Il.transition;Il.transition=null;try{jt=4,a2(e,t,r,n)}finally{jt=i,Il.transition=a}}function a2(e,t,r,n){if(fd){var i=Hg(e,t,r,n);if(i===null)jp(e,t,n,dd,r),A4(e,n);else if(t9(i,e,t,r,n))n.stopPropagation();else if(A4(e,n),t&4&&-1<e9.indexOf(e)){for(;i!==null;){var a=ou(i);if(a!==null&&l_(a),a=Hg(e,t,r,n),a===null&&jp(e,t,n,dd,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else jp(e,t,n,null,r)}}var dd=null;function Hg(e,t,r,n){if(dd=null,e=t2(n),e=uo(e),e!==null)if(t=Ro(e),t===null)e=null;else if(r=t.tag,r===13){if(e=e_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dd=e,null}function h_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wk()){case r2:return 1;case i_:return 4;case cd:case $k:return 16;case a_:return 536870912;default:return 16}default:return 16}}var vs=null,s2=null,Yf=null;function p_(){if(Yf)return Yf;var e,t=s2,r=t.length,n,i="value"in vs?vs.value:vs.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return Yf=i.slice(e,1<n?1-n:void 0)}function Qf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _f(){return!0}function F4(){return!1}function ai(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?_f:F4,this.isPropagationStopped=F4,this}return sr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=_f)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=_f)},persist:function(){},isPersistent:_f}),t}var rc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o2=ai(rc),su=sr({},rc,{view:0,detail:0}),a9=ai(su),Np,Rp,Bc,eh=sr({},su,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bc&&(Bc&&e.type==="mousemove"?(Np=e.screenX-Bc.screenX,Rp=e.screenY-Bc.screenY):Rp=Np=0,Bc=e),Np)},movementY:function(e){return"movementY"in e?e.movementY:Rp}}),N4=ai(eh),s9=sr({},eh,{dataTransfer:0}),o9=ai(s9),l9=sr({},su,{relatedTarget:0}),bp=ai(l9),c9=sr({},rc,{animationName:0,elapsedTime:0,pseudoElement:0}),u9=ai(c9),f9=sr({},rc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),d9=ai(f9),h9=sr({},rc,{data:0}),R4=ai(h9),p9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x9(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m9[e])?!!t[e]:!1}function l2(){return x9}var v9=sr({},su,{key:function(e){if(e.key){var t=p9[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l2,charCode:function(e){return e.type==="keypress"?Qf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),y9=ai(v9),_9=sr({},eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),b4=ai(_9),S9=sr({},su,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l2}),w9=ai(S9),k9=sr({},rc,{propertyName:0,elapsedTime:0,pseudoElement:0}),E9=ai(k9),C9=sr({},eh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),T9=ai(C9),A9=[9,13,27,32],c2=za&&"CompositionEvent"in window,c0=null;za&&"documentMode"in document&&(c0=document.documentMode);var P9=za&&"TextEvent"in window&&!c0,g_=za&&(!c2||c0&&8<c0&&11>=c0),I4=String.fromCharCode(32),D4=!1;function m_(e,t){switch(e){case"keyup":return A9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function x_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yl=!1;function F9(e,t){switch(e){case"compositionend":return x_(t);case"keypress":return t.which!==32?null:(D4=!0,I4);case"textInput":return e=t.data,e===I4&&D4?null:e;default:return null}}function N9(e,t){if(yl)return e==="compositionend"||!c2&&m_(e,t)?(e=p_(),Yf=s2=vs=null,yl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return g_&&t.locale!=="ko"?null:t.data;default:return null}}var R9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!R9[e.type]:t==="textarea"}function v_(e,t,r,n){Y5(n),t=hd(t,"onChange"),0<t.length&&(r=new o2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var u0=null,R0=null;function b9(e){F_(e,0)}function th(e){var t=wl(e);if(V5(t))return e}function I9(e,t){if(e==="change")return t}var y_=!1;if(za){var Ip;if(za){var Dp="oninput"in document;if(!Dp){var L4=document.createElement("div");L4.setAttribute("oninput","return;"),Dp=typeof L4.oninput=="function"}Ip=Dp}else Ip=!1;y_=Ip&&(!document.documentMode||9<document.documentMode)}function M4(){u0&&(u0.detachEvent("onpropertychange",__),R0=u0=null)}function __(e){if(e.propertyName==="value"&&th(R0)){var t=[];v_(t,R0,e,t2(e)),Z5(b9,t)}}function D9(e,t,r){e==="focusin"?(M4(),u0=t,R0=r,u0.attachEvent("onpropertychange",__)):e==="focusout"&&M4()}function O9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return th(R0)}function L9(e,t){if(e==="click")return th(t)}function M9(e,t){if(e==="input"||e==="change")return th(t)}function B9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ji=typeof Object.is=="function"?Object.is:B9;function b0(e,t){if(Ji(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Tg.call(t,i)||!Ji(e[i],t[i]))return!1}return!0}function B4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function j4(e,t){var r=B4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=B4(r)}}function S_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?S_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function w_(){for(var e=window,t=sd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sd(e.document)}return t}function u2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function j9(e){var t=w_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&S_(r.ownerDocument.documentElement,r)){if(n!==null&&u2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=j4(r,a);var s=j4(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var U9=za&&"documentMode"in document&&11>=document.documentMode,_l=null,Wg=null,f0=null,$g=!1;function U4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$g||_l==null||_l!==sd(n)||(n=_l,"selectionStart"in n&&u2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),f0&&b0(f0,n)||(f0=n,n=hd(Wg,"onSelect"),0<n.length&&(t=new o2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=_l)))}function Sf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Sl={animationend:Sf("Animation","AnimationEnd"),animationiteration:Sf("Animation","AnimationIteration"),animationstart:Sf("Animation","AnimationStart"),transitionend:Sf("Transition","TransitionEnd")},Op={},k_={};za&&(k_=document.createElement("div").style,"AnimationEvent"in window||(delete Sl.animationend.animation,delete Sl.animationiteration.animation,delete Sl.animationstart.animation),"TransitionEvent"in window||delete Sl.transitionend.transition);function rh(e){if(Op[e])return Op[e];if(!Sl[e])return e;var t=Sl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in k_)return Op[e]=t[r];return e}var E_=rh("animationend"),C_=rh("animationiteration"),T_=rh("animationstart"),A_=rh("transitionend"),P_=new Map,z4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ms(e,t){P_.set(e,t),No(t,[e])}for(var Lp=0;Lp<z4.length;Lp++){var Mp=z4[Lp],z9=Mp.toLowerCase(),V9=Mp[0].toUpperCase()+Mp.slice(1);Ms(z9,"on"+V9)}Ms(E_,"onAnimationEnd");Ms(C_,"onAnimationIteration");Ms(T_,"onAnimationStart");Ms("dblclick","onDoubleClick");Ms("focusin","onFocus");Ms("focusout","onBlur");Ms(A_,"onTransitionEnd");Ul("onMouseEnter",["mouseout","mouseover"]);Ul("onMouseLeave",["mouseout","mouseover"]);Ul("onPointerEnter",["pointerout","pointerover"]);Ul("onPointerLeave",["pointerout","pointerover"]);No("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));No("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));No("onBeforeInput",["compositionend","keypress","textInput","paste"]);No("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));No("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));No("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var e0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G9=new Set("cancel close invalid load scroll toggle".split(" ").concat(e0));function V4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zk(n,t,void 0,e),e.currentTarget=null}function F_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,f=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;V4(i,o,f),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,f=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;V4(i,o,f),a=u}}}if(ld)throw e=zg,ld=!1,zg=null,e}function Yt(e,t){var r=t[qg];r===void 0&&(r=t[qg]=new Set);var n=e+"__bubble";r.has(n)||(N_(t,e,2,!1),r.add(n))}function Bp(e,t,r){var n=0;t&&(n|=4),N_(r,e,n,t)}var wf="_reactListening"+Math.random().toString(36).slice(2);function I0(e){if(!e[wf]){e[wf]=!0,M5.forEach(function(r){r!=="selectionchange"&&(G9.has(r)||Bp(r,!1,e),Bp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[wf]||(t[wf]=!0,Bp("selectionchange",!1,t))}}function N_(e,t,r,n){switch(h_(t)){case 1:var i=n9;break;case 4:i=i9;break;default:i=a2}r=i.bind(null,t,r,e),i=void 0,!Ug||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function jp(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=uo(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}Z5(function(){var f=a,d=t2(r),p=[];e:{var g=P_.get(e);if(g!==void 0){var v=o2,m=e;switch(e){case"keypress":if(Qf(r)===0)break e;case"keydown":case"keyup":v=y9;break;case"focusin":m="focus",v=bp;break;case"focusout":m="blur",v=bp;break;case"beforeblur":case"afterblur":v=bp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=N4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=o9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=w9;break;case E_:case C_:case T_:v=u9;break;case A_:v=E9;break;case"scroll":v=a9;break;case"wheel":v=T9;break;case"copy":case"cut":case"paste":v=d9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=b4}var y=(t&4)!==0,C=!y&&e==="scroll",S=y?g!==null?g+"Capture":null:g;y=[];for(var w=f,x;w!==null;){x=w;var T=x.stateNode;if(x.tag===5&&T!==null&&(x=T,S!==null&&(T=A0(w,S),T!=null&&y.push(D0(w,T,x)))),C)break;w=w.return}0<y.length&&(g=new v(g,m,null,r,d),p.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&r!==Bg&&(m=r.relatedTarget||r.fromElement)&&(uo(m)||m[Va]))break e;if((v||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,v?(m=r.relatedTarget||r.toElement,v=f,m=m?uo(m):null,m!==null&&(C=Ro(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(v=null,m=f),v!==m)){if(y=N4,T="onMouseLeave",S="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(y=b4,T="onPointerLeave",S="onPointerEnter",w="pointer"),C=v==null?g:wl(v),x=m==null?g:wl(m),g=new y(T,w+"leave",v,r,d),g.target=C,g.relatedTarget=x,T=null,uo(d)===f&&(y=new y(S,w+"enter",m,r,d),y.target=x,y.relatedTarget=C,T=y),C=T,v&&m)t:{for(y=v,S=m,w=0,x=y;x;x=ll(x))w++;for(x=0,T=S;T;T=ll(T))x++;for(;0<w-x;)y=ll(y),w--;for(;0<x-w;)S=ll(S),x--;for(;w--;){if(y===S||S!==null&&y===S.alternate)break t;y=ll(y),S=ll(S)}y=null}else y=null;v!==null&&G4(p,g,v,y,!1),m!==null&&C!==null&&G4(p,C,m,y,!0)}}e:{if(g=f?wl(f):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var A=I9;else if(O4(g))if(y_)A=M9;else{A=O9;var F=D9}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(A=L9);if(A&&(A=A(e,f))){v_(p,A,r,d);break e}F&&F(e,g,f),e==="focusout"&&(F=g._wrapperState)&&F.controlled&&g.type==="number"&&Ig(g,"number",g.value)}switch(F=f?wl(f):window,e){case"focusin":(O4(F)||F.contentEditable==="true")&&(_l=F,Wg=f,f0=null);break;case"focusout":f0=Wg=_l=null;break;case"mousedown":$g=!0;break;case"contextmenu":case"mouseup":case"dragend":$g=!1,U4(p,r,d);break;case"selectionchange":if(U9)break;case"keydown":case"keyup":U4(p,r,d)}var N;if(c2)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else yl?m_(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(g_&&r.locale!=="ko"&&(yl||P!=="onCompositionStart"?P==="onCompositionEnd"&&yl&&(N=p_()):(vs=d,s2="value"in vs?vs.value:vs.textContent,yl=!0)),F=hd(f,P),0<F.length&&(P=new R4(P,e,null,r,d),p.push({event:P,listeners:F}),N?P.data=N:(N=x_(r),N!==null&&(P.data=N)))),(N=P9?F9(e,r):N9(e,r))&&(f=hd(f,"onBeforeInput"),0<f.length&&(d=new R4("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:f}),d.data=N))}F_(p,t)})}function D0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function hd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=A0(e,r),a!=null&&n.unshift(D0(e,a,i)),a=A0(e,t),a!=null&&n.push(D0(e,a,i))),e=e.return}return n}function ll(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function G4(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,f=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&f!==null&&(o=f,i?(u=A0(r,a),u!=null&&s.unshift(D0(r,u,o))):i||(u=A0(r,a),u!=null&&s.push(D0(r,u,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var H9=/\r\n?/g,W9=/\u0000|\uFFFD/g;function H4(e){return(typeof e=="string"?e:""+e).replace(H9,`
`).replace(W9,"")}function kf(e,t,r){if(t=H4(t),H4(e)!==t&&r)throw Error(Re(425))}function pd(){}var Xg=null,Kg=null;function Yg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qg=typeof setTimeout=="function"?setTimeout:void 0,$9=typeof clearTimeout=="function"?clearTimeout:void 0,W4=typeof Promise=="function"?Promise:void 0,X9=typeof queueMicrotask=="function"?queueMicrotask:typeof W4<"u"?function(e){return W4.resolve(null).then(e).catch(K9)}:Qg;function K9(e){setTimeout(function(){throw e})}function Up(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),N0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);N0(t)}function Cs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var nc=Math.random().toString(36).slice(2),da="__reactFiber$"+nc,O0="__reactProps$"+nc,Va="__reactContainer$"+nc,qg="__reactEvents$"+nc,Y9="__reactListeners$"+nc,Q9="__reactHandles$"+nc;function uo(e){var t=e[da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Va]||r[da]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$4(e);e!==null;){if(r=e[da])return r;e=$4(e)}return t}e=r,r=e.parentNode}return null}function ou(e){return e=e[da]||e[Va],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Re(33))}function nh(e){return e[O0]||null}var Jg=[],kl=-1;function Bs(e){return{current:e}}function Qt(e){0>kl||(e.current=Jg[kl],Jg[kl]=null,kl--)}function $t(e,t){kl++,Jg[kl]=e.current,e.current=t}var bs={},yn=Bs(bs),Wn=Bs(!1),_o=bs;function zl(e,t){var r=e.type.contextTypes;if(!r)return bs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function $n(e){return e=e.childContextTypes,e!=null}function gd(){Qt(Wn),Qt(yn)}function X4(e,t,r){if(yn.current!==bs)throw Error(Re(168));$t(yn,t),$t(Wn,r)}function R_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Re(108,Dk(e)||"Unknown",i));return sr({},r,n)}function md(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,_o=yn.current,$t(yn,e),$t(Wn,Wn.current),!0}function K4(e,t,r){var n=e.stateNode;if(!n)throw Error(Re(169));r?(e=R_(e,t,_o),n.__reactInternalMemoizedMergedChildContext=e,Qt(Wn),Qt(yn),$t(yn,e)):Qt(Wn),$t(Wn,r)}var ba=null,ih=!1,zp=!1;function b_(e){ba===null?ba=[e]:ba.push(e)}function q9(e){ih=!0,b_(e)}function js(){if(!zp&&ba!==null){zp=!0;var e=0,t=jt;try{var r=ba;for(jt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ba=null,ih=!1}catch(i){throw ba!==null&&(ba=ba.slice(e+1)),n_(r2,js),i}finally{jt=t,zp=!1}}return null}var El=[],Cl=0,xd=null,vd=0,Si=[],wi=0,So=null,Da=1,Oa="";function so(e,t){El[Cl++]=vd,El[Cl++]=xd,xd=e,vd=t}function I_(e,t,r){Si[wi++]=Da,Si[wi++]=Oa,Si[wi++]=So,So=e;var n=Da;e=Oa;var i=32-Xi(n)-1;n&=~(1<<i),r+=1;var a=32-Xi(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Da=1<<32-Xi(t)+i|r<<i|n,Oa=a+e}else Da=1<<a|r<<i|n,Oa=e}function f2(e){e.return!==null&&(so(e,1),I_(e,1,0))}function d2(e){for(;e===xd;)xd=El[--Cl],El[Cl]=null,vd=El[--Cl],El[Cl]=null;for(;e===So;)So=Si[--wi],Si[wi]=null,Oa=Si[--wi],Si[wi]=null,Da=Si[--wi],Si[wi]=null}var ei=null,Zn=null,er=!1,Gi=null;function D_(e,t){var r=Ei(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Y4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ei=e,Zn=Cs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ei=e,Zn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=So!==null?{id:Da,overflow:Oa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ei(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ei=e,Zn=null,!0):!1;default:return!1}}function Zg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function em(e){if(er){var t=Zn;if(t){var r=t;if(!Y4(e,t)){if(Zg(e))throw Error(Re(418));t=Cs(r.nextSibling);var n=ei;t&&Y4(e,t)?D_(n,r):(e.flags=e.flags&-4097|2,er=!1,ei=e)}}else{if(Zg(e))throw Error(Re(418));e.flags=e.flags&-4097|2,er=!1,ei=e}}}function Q4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ei=e}function Ef(e){if(e!==ei)return!1;if(!er)return Q4(e),er=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yg(e.type,e.memoizedProps)),t&&(t=Zn)){if(Zg(e))throw O_(),Error(Re(418));for(;t;)D_(e,t),t=Cs(t.nextSibling)}if(Q4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zn=Cs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zn=null}}else Zn=ei?Cs(e.stateNode.nextSibling):null;return!0}function O_(){for(var e=Zn;e;)e=Cs(e.nextSibling)}function Vl(){Zn=ei=null,er=!1}function h2(e){Gi===null?Gi=[e]:Gi.push(e)}var J9=Xa.ReactCurrentBatchConfig;function jc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Re(309));var n=r.stateNode}if(!n)throw Error(Re(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(Re(284));if(!r._owner)throw Error(Re(290,e))}return e}function Cf(e,t){throw e=Object.prototype.toString.call(t),Error(Re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function q4(e){var t=e._init;return t(e._payload)}function L_(e){function t(S,w){if(e){var x=S.deletions;x===null?(S.deletions=[w],S.flags|=16):x.push(w)}}function r(S,w){if(!e)return null;for(;w!==null;)t(S,w),w=w.sibling;return null}function n(S,w){for(S=new Map;w!==null;)w.key!==null?S.set(w.key,w):S.set(w.index,w),w=w.sibling;return S}function i(S,w){return S=Fs(S,w),S.index=0,S.sibling=null,S}function a(S,w,x){return S.index=x,e?(x=S.alternate,x!==null?(x=x.index,x<w?(S.flags|=2,w):x):(S.flags|=2,w)):(S.flags|=1048576,w)}function s(S){return e&&S.alternate===null&&(S.flags|=2),S}function o(S,w,x,T){return w===null||w.tag!==6?(w=Kp(x,S.mode,T),w.return=S,w):(w=i(w,x),w.return=S,w)}function u(S,w,x,T){var A=x.type;return A===vl?d(S,w,x.props.children,T,x.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ds&&q4(A)===w.type)?(T=i(w,x.props),T.ref=jc(S,w,x),T.return=S,T):(T=nd(x.type,x.key,x.props,null,S.mode,T),T.ref=jc(S,w,x),T.return=S,T)}function f(S,w,x,T){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=Yp(x,S.mode,T),w.return=S,w):(w=i(w,x.children||[]),w.return=S,w)}function d(S,w,x,T,A){return w===null||w.tag!==7?(w=xo(x,S.mode,T,A),w.return=S,w):(w=i(w,x),w.return=S,w)}function p(S,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Kp(""+w,S.mode,x),w.return=S,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pf:return x=nd(w.type,w.key,w.props,null,S.mode,x),x.ref=jc(S,null,w),x.return=S,x;case xl:return w=Yp(w,S.mode,x),w.return=S,w;case ds:var T=w._init;return p(S,T(w._payload),x)}if(Jc(w)||Dc(w))return w=xo(w,S.mode,x,null),w.return=S,w;Cf(S,w)}return null}function g(S,w,x,T){var A=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return A!==null?null:o(S,w,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case pf:return x.key===A?u(S,w,x,T):null;case xl:return x.key===A?f(S,w,x,T):null;case ds:return A=x._init,g(S,w,A(x._payload),T)}if(Jc(x)||Dc(x))return A!==null?null:d(S,w,x,T,null);Cf(S,x)}return null}function v(S,w,x,T,A){if(typeof T=="string"&&T!==""||typeof T=="number")return S=S.get(x)||null,o(w,S,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case pf:return S=S.get(T.key===null?x:T.key)||null,u(w,S,T,A);case xl:return S=S.get(T.key===null?x:T.key)||null,f(w,S,T,A);case ds:var F=T._init;return v(S,w,x,F(T._payload),A)}if(Jc(T)||Dc(T))return S=S.get(x)||null,d(w,S,T,A,null);Cf(w,T)}return null}function m(S,w,x,T){for(var A=null,F=null,N=w,P=w=0,I=null;N!==null&&P<x.length;P++){N.index>P?(I=N,N=null):I=N.sibling;var b=g(S,N,x[P],T);if(b===null){N===null&&(N=I);break}e&&N&&b.alternate===null&&t(S,N),w=a(b,w,P),F===null?A=b:F.sibling=b,F=b,N=I}if(P===x.length)return r(S,N),er&&so(S,P),A;if(N===null){for(;P<x.length;P++)N=p(S,x[P],T),N!==null&&(w=a(N,w,P),F===null?A=N:F.sibling=N,F=N);return er&&so(S,P),A}for(N=n(S,N);P<x.length;P++)I=v(N,S,P,x[P],T),I!==null&&(e&&I.alternate!==null&&N.delete(I.key===null?P:I.key),w=a(I,w,P),F===null?A=I:F.sibling=I,F=I);return e&&N.forEach(function(O){return t(S,O)}),er&&so(S,P),A}function y(S,w,x,T){var A=Dc(x);if(typeof A!="function")throw Error(Re(150));if(x=A.call(x),x==null)throw Error(Re(151));for(var F=A=null,N=w,P=w=0,I=null,b=x.next();N!==null&&!b.done;P++,b=x.next()){N.index>P?(I=N,N=null):I=N.sibling;var O=g(S,N,b.value,T);if(O===null){N===null&&(N=I);break}e&&N&&O.alternate===null&&t(S,N),w=a(O,w,P),F===null?A=O:F.sibling=O,F=O,N=I}if(b.done)return r(S,N),er&&so(S,P),A;if(N===null){for(;!b.done;P++,b=x.next())b=p(S,b.value,T),b!==null&&(w=a(b,w,P),F===null?A=b:F.sibling=b,F=b);return er&&so(S,P),A}for(N=n(S,N);!b.done;P++,b=x.next())b=v(N,S,P,b.value,T),b!==null&&(e&&b.alternate!==null&&N.delete(b.key===null?P:b.key),w=a(b,w,P),F===null?A=b:F.sibling=b,F=b);return e&&N.forEach(function(L){return t(S,L)}),er&&so(S,P),A}function C(S,w,x,T){if(typeof x=="object"&&x!==null&&x.type===vl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case pf:e:{for(var A=x.key,F=w;F!==null;){if(F.key===A){if(A=x.type,A===vl){if(F.tag===7){r(S,F.sibling),w=i(F,x.props.children),w.return=S,S=w;break e}}else if(F.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===ds&&q4(A)===F.type){r(S,F.sibling),w=i(F,x.props),w.ref=jc(S,F,x),w.return=S,S=w;break e}r(S,F);break}else t(S,F);F=F.sibling}x.type===vl?(w=xo(x.props.children,S.mode,T,x.key),w.return=S,S=w):(T=nd(x.type,x.key,x.props,null,S.mode,T),T.ref=jc(S,w,x),T.return=S,S=T)}return s(S);case xl:e:{for(F=x.key;w!==null;){if(w.key===F)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(S,w.sibling),w=i(w,x.children||[]),w.return=S,S=w;break e}else{r(S,w);break}else t(S,w);w=w.sibling}w=Yp(x,S.mode,T),w.return=S,S=w}return s(S);case ds:return F=x._init,C(S,w,F(x._payload),T)}if(Jc(x))return m(S,w,x,T);if(Dc(x))return y(S,w,x,T);Cf(S,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(S,w.sibling),w=i(w,x),w.return=S,S=w):(r(S,w),w=Kp(x,S.mode,T),w.return=S,S=w),s(S)):r(S,w)}return C}var Gl=L_(!0),M_=L_(!1),yd=Bs(null),_d=null,Tl=null,p2=null;function g2(){p2=Tl=_d=null}function m2(e){var t=yd.current;Qt(yd),e._currentValue=t}function tm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Dl(e,t){_d=e,p2=Tl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Hn=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(p2!==e)if(e={context:e,memoizedValue:t,next:null},Tl===null){if(_d===null)throw Error(Re(308));Tl=e,_d.dependencies={lanes:0,firstContext:e}}else Tl=Tl.next=e;return t}var fo=null;function x2(e){fo===null?fo=[e]:fo.push(e)}function B_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,x2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ga(e,n)}function Ga(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var hs=!1;function v2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function j_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ma(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ts(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ft&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ga(e,r)}return i=n.interleaved,i===null?(t.next=t,x2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ga(e,r)}function qf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,n2(e,r)}}function J4(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Sd(e,t,r,n){var i=e.updateQueue;hs=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,f=u.next;u.next=null,s===null?a=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=f:o.next=f,d.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;s=0,d=f=u=null,o=a;do{var g=o.lane,v=o.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,y=o;switch(g=t,v=r,y.tag){case 1:if(m=y.payload,typeof m=="function"){p=m.call(v,p,g);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,g=typeof m=="function"?m.call(v,p,g):m,g==null)break e;p=sr({},p,g);break e;case 2:hs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else v={eventTime:v,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(f=d=v,u=p):d=d.next=v,s|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ko|=s,e.lanes=s,e.memoizedState=p}}function Z4(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Re(191,i));i.call(n)}}}var lu={},ga=Bs(lu),L0=Bs(lu),M0=Bs(lu);function ho(e){if(e===lu)throw Error(Re(174));return e}function y2(e,t){switch($t(M0,t),$t(L0,e),$t(ga,lu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Og(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Og(t,e)}Qt(ga),$t(ga,t)}function Hl(){Qt(ga),Qt(L0),Qt(M0)}function U_(e){ho(M0.current);var t=ho(ga.current),r=Og(t,e.type);t!==r&&($t(L0,e),$t(ga,r))}function _2(e){L0.current===e&&(Qt(ga),Qt(L0))}var ir=Bs(0);function wd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vp=[];function S2(){for(var e=0;e<Vp.length;e++)Vp[e]._workInProgressVersionPrimary=null;Vp.length=0}var Jf=Xa.ReactCurrentDispatcher,Gp=Xa.ReactCurrentBatchConfig,wo=0,ar=null,Nr=null,Hr=null,kd=!1,d0=!1,B0=0,Z9=0;function un(){throw Error(Re(321))}function w2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ji(e[r],t[r]))return!1;return!0}function k2(e,t,r,n,i,a){if(wo=a,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jf.current=e===null||e.memoizedState===null?nE:iE,e=r(n,i),d0){a=0;do{if(d0=!1,B0=0,25<=a)throw Error(Re(301));a+=1,Hr=Nr=null,t.updateQueue=null,Jf.current=aE,e=r(n,i)}while(d0)}if(Jf.current=Ed,t=Nr!==null&&Nr.next!==null,wo=0,Hr=Nr=ar=null,kd=!1,t)throw Error(Re(300));return e}function E2(){var e=B0!==0;return B0=0,e}function fa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?ar.memoizedState=Hr=e:Hr=Hr.next=e,Hr}function Ai(){if(Nr===null){var e=ar.alternate;e=e!==null?e.memoizedState:null}else e=Nr.next;var t=Hr===null?ar.memoizedState:Hr.next;if(t!==null)Hr=t,Nr=e;else{if(e===null)throw Error(Re(310));Nr=e,e={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Hr===null?ar.memoizedState=Hr=e:Hr=Hr.next=e}return Hr}function j0(e,t){return typeof t=="function"?t(e):t}function Hp(e){var t=Ai(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=Nr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,f=a;do{var d=f.lane;if((wo&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(o=u=p,s=n):u=u.next=p,ar.lanes|=d,ko|=d}f=f.next}while(f!==null&&f!==a);u===null?s=n:u.next=o,Ji(n,t.memoizedState)||(Hn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,ar.lanes|=a,ko|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Wp(e){var t=Ai(),r=t.queue;if(r===null)throw Error(Re(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Ji(a,t.memoizedState)||(Hn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function z_(){}function V_(e,t){var r=ar,n=Ai(),i=t(),a=!Ji(n.memoizedState,i);if(a&&(n.memoizedState=i,Hn=!0),n=n.queue,C2(W_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Hr!==null&&Hr.memoizedState.tag&1){if(r.flags|=2048,U0(9,H_.bind(null,r,n,i,t),void 0,null),Wr===null)throw Error(Re(349));wo&30||G_(r,t,i)}return i}function G_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function H_(e,t,r,n){t.value=r,t.getSnapshot=n,$_(t)&&X_(e)}function W_(e,t,r){return r(function(){$_(t)&&X_(e)})}function $_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ji(e,r)}catch{return!0}}function X_(e){var t=Ga(e,1);t!==null&&Ki(t,e,1,-1)}function ey(e){var t=fa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:j0,lastRenderedState:e},t.queue=e,e=e.dispatch=rE.bind(null,ar,e),[t.memoizedState,e]}function U0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function K_(){return Ai().memoizedState}function Zf(e,t,r,n){var i=fa();ar.flags|=e,i.memoizedState=U0(1|t,r,void 0,n===void 0?null:n)}function ah(e,t,r,n){var i=Ai();n=n===void 0?null:n;var a=void 0;if(Nr!==null){var s=Nr.memoizedState;if(a=s.destroy,n!==null&&w2(n,s.deps)){i.memoizedState=U0(t,r,a,n);return}}ar.flags|=e,i.memoizedState=U0(1|t,r,a,n)}function ty(e,t){return Zf(8390656,8,e,t)}function C2(e,t){return ah(2048,8,e,t)}function Y_(e,t){return ah(4,2,e,t)}function Q_(e,t){return ah(4,4,e,t)}function q_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function J_(e,t,r){return r=r!=null?r.concat([e]):null,ah(4,4,q_.bind(null,t,e),r)}function T2(){}function Z_(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&w2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function e6(e,t){var r=Ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&w2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function t6(e,t,r){return wo&21?(Ji(r,t)||(r=s_(),ar.lanes|=r,ko|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Hn=!0),e.memoizedState=r)}function eE(e,t){var r=jt;jt=r!==0&&4>r?r:4,e(!0);var n=Gp.transition;Gp.transition={};try{e(!1),t()}finally{jt=r,Gp.transition=n}}function r6(){return Ai().memoizedState}function tE(e,t,r){var n=Ps(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},n6(e))i6(t,r);else if(r=B_(e,t,r,n),r!==null){var i=Nn();Ki(r,e,n,i),a6(r,t,n)}}function rE(e,t,r){var n=Ps(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(n6(e))i6(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Ji(o,s)){var u=t.interleaved;u===null?(i.next=i,x2(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=B_(e,t,i,n),r!==null&&(i=Nn(),Ki(r,e,n,i),a6(r,t,n))}}function n6(e){var t=e.alternate;return e===ar||t!==null&&t===ar}function i6(e,t){d0=kd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function a6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,n2(e,r)}}var Ed={readContext:Ti,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},nE={readContext:Ti,useCallback:function(e,t){return fa().memoizedState=[e,t===void 0?null:t],e},useContext:Ti,useEffect:ty,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Zf(4194308,4,q_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Zf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Zf(4,2,e,t)},useMemo:function(e,t){var r=fa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tE.bind(null,ar,e),[n.memoizedState,e]},useRef:function(e){var t=fa();return e={current:e},t.memoizedState=e},useState:ey,useDebugValue:T2,useDeferredValue:function(e){return fa().memoizedState=e},useTransition:function(){var e=ey(!1),t=e[0];return e=eE.bind(null,e[1]),fa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ar,i=fa();if(er){if(r===void 0)throw Error(Re(407));r=r()}else{if(r=t(),Wr===null)throw Error(Re(349));wo&30||G_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,ty(W_.bind(null,n,a,e),[e]),n.flags|=2048,U0(9,H_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=fa(),t=Wr.identifierPrefix;if(er){var r=Oa,n=Da;r=(n&~(1<<32-Xi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=B0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Z9++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iE={readContext:Ti,useCallback:Z_,useContext:Ti,useEffect:C2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:Hp,useRef:K_,useState:function(){return Hp(j0)},useDebugValue:T2,useDeferredValue:function(e){var t=Ai();return t6(t,Nr.memoizedState,e)},useTransition:function(){var e=Hp(j0)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1},aE={readContext:Ti,useCallback:Z_,useContext:Ti,useEffect:C2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:Wp,useRef:K_,useState:function(){return Wp(j0)},useDebugValue:T2,useDeferredValue:function(e){var t=Ai();return Nr===null?t.memoizedState=e:t6(t,Nr.memoizedState,e)},useTransition:function(){var e=Wp(j0)[0],t=Ai().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1};function zi(e,t){if(e&&e.defaultProps){t=sr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function rm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:sr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var sh={isMounted:function(e){return(e=e._reactInternals)?Ro(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nn(),i=Ps(e),a=Ma(n,i);a.payload=t,r!=null&&(a.callback=r),t=Ts(e,a,i),t!==null&&(Ki(t,e,i,n),qf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nn(),i=Ps(e),a=Ma(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ts(e,a,i),t!==null&&(Ki(t,e,i,n),qf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nn(),n=Ps(e),i=Ma(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ts(e,i,n),t!==null&&(Ki(t,e,n,r),qf(t,e,n))}};function ry(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!b0(r,n)||!b0(i,a):!0}function s6(e,t,r){var n=!1,i=bs,a=t.contextType;return typeof a=="object"&&a!==null?a=Ti(a):(i=$n(t)?_o:yn.current,n=t.contextTypes,a=(n=n!=null)?zl(e,i):bs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=sh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ny(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&sh.enqueueReplaceState(t,t.state,null)}function nm(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},v2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Ti(a):(a=$n(t)?_o:yn.current,i.context=zl(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(rm(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&sh.enqueueReplaceState(i,i.state,null),Sd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Wl(e,t){try{var r="",n=t;do r+=Ik(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function $p(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function im(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sE=typeof WeakMap=="function"?WeakMap:Map;function o6(e,t,r){r=Ma(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Td||(Td=!0,pm=n),im(e,t)},r}function l6(e,t,r){r=Ma(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){im(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){im(e,t),typeof n!="function"&&(As===null?As=new Set([this]):As.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function iy(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sE;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_E.bind(null,e,t,r),t.then(e,e))}function ay(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sy(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ma(-1,1),t.tag=2,Ts(r,t,1))),r.lanes|=1),e)}var oE=Xa.ReactCurrentOwner,Hn=!1;function Tn(e,t,r,n){t.child=e===null?M_(t,null,r,n):Gl(t,e.child,r,n)}function oy(e,t,r,n,i){r=r.render;var a=t.ref;return Dl(t,i),n=k2(e,t,r,n,a,i),r=E2(),e!==null&&!Hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i)):(er&&r&&f2(t),t.flags|=1,Tn(e,t,n,i),t.child)}function ly(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!D2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,c6(e,t,a,n,i)):(e=nd(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:b0,r(s,n)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,e=Fs(a,n),e.ref=t.ref,e.return=t,t.child=e}function c6(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(b0(a,n)&&e.ref===t.ref)if(Hn=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(Hn=!0);else return t.lanes=e.lanes,Ha(e,t,i)}return am(e,t,r,n,i)}function u6(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(Pl,Qn),Qn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$t(Pl,Qn),Qn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,$t(Pl,Qn),Qn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,$t(Pl,Qn),Qn|=n;return Tn(e,t,i,r),t.child}function f6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function am(e,t,r,n,i){var a=$n(r)?_o:yn.current;return a=zl(t,a),Dl(t,i),r=k2(e,t,r,n,a,i),n=E2(),e!==null&&!Hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i)):(er&&n&&f2(t),t.flags|=1,Tn(e,t,r,i),t.child)}function cy(e,t,r,n,i){if($n(r)){var a=!0;md(t)}else a=!1;if(Dl(t,i),t.stateNode===null)ed(e,t),s6(t,r,n),nm(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=Ti(f):(f=$n(r)?_o:yn.current,f=zl(t,f));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==f)&&ny(t,s,n,f),hs=!1;var g=t.memoizedState;s.state=g,Sd(t,n,s,i),u=t.memoizedState,o!==n||g!==u||Wn.current||hs?(typeof d=="function"&&(rm(t,r,d,n),u=t.memoizedState),(o=hs||ry(t,r,o,n,g,u,f))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=f,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,j_(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:zi(t.type,o),s.props=f,p=t.pendingProps,g=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=Ti(u):(u=$n(r)?_o:yn.current,u=zl(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==p||g!==u)&&ny(t,s,n,u),hs=!1,g=t.memoizedState,s.state=g,Sd(t,n,s,i);var m=t.memoizedState;o!==p||g!==m||Wn.current||hs?(typeof v=="function"&&(rm(t,r,v,n),m=t.memoizedState),(f=hs||ry(t,r,f,n,g,m,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=u,n=f):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return sm(e,t,r,n,a,i)}function sm(e,t,r,n,i,a){f6(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&K4(t,r,!1),Ha(e,t,a);n=t.stateNode,oE.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Gl(t,e.child,null,a),t.child=Gl(t,null,o,a)):Tn(e,t,o,a),t.memoizedState=n.state,i&&K4(t,r,!0),t.child}function d6(e){var t=e.stateNode;t.pendingContext?X4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&X4(e,t.context,!1),y2(e,t.containerInfo)}function uy(e,t,r,n,i){return Vl(),h2(i),t.flags|=256,Tn(e,t,r,n),t.child}var om={dehydrated:null,treeContext:null,retryLane:0};function lm(e){return{baseLanes:e,cachePool:null,transitions:null}}function h6(e,t,r){var n=t.pendingProps,i=ir.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),$t(ir,i&1),e===null)return em(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=ch(s,n,0,null),e=xo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=lm(r),t.memoizedState=om,e):A2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lE(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Fs(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Fs(o,a):(a=xo(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?lm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=om,n}return a=e.child,e=a.sibling,n=Fs(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function A2(e,t){return t=ch({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tf(e,t,r,n){return n!==null&&h2(n),Gl(t,e.child,null,r),e=A2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lE(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=$p(Error(Re(422))),Tf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=ch({mode:"visible",children:n.children},i,0,null),a=xo(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Gl(t,e.child,null,s),t.child.memoizedState=lm(s),t.memoizedState=om,a);if(!(t.mode&1))return Tf(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Re(419)),n=$p(a,n,void 0),Tf(e,t,s,n)}if(o=(s&e.childLanes)!==0,Hn||o){if(n=Wr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Ga(e,i),Ki(n,e,i,-1))}return I2(),n=$p(Error(Re(421))),Tf(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=SE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Zn=Cs(i.nextSibling),ei=t,er=!0,Gi=null,e!==null&&(Si[wi++]=Da,Si[wi++]=Oa,Si[wi++]=So,Da=e.id,Oa=e.overflow,So=t),t=A2(t,n.children),t.flags|=4096,t)}function fy(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),tm(e.return,t,r)}function Xp(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function p6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Tn(e,t,n.children,r),n=ir.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&fy(e,r,t);else if(e.tag===19)fy(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if($t(ir,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&wd(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Xp(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&wd(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Xp(t,!0,r,null,a);break;case"together":Xp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ed(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ko|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Re(153));if(t.child!==null){for(e=t.child,r=Fs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cE(e,t,r){switch(t.tag){case 3:d6(t),Vl();break;case 5:U_(t);break;case 1:$n(t.type)&&md(t);break;case 4:y2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;$t(yd,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?($t(ir,ir.current&1),t.flags|=128,null):r&t.child.childLanes?h6(e,t,r):($t(ir,ir.current&1),e=Ha(e,t,r),e!==null?e.sibling:null);$t(ir,ir.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return p6(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$t(ir,ir.current),n)break;return null;case 22:case 23:return t.lanes=0,u6(e,t,r)}return Ha(e,t,r)}var g6,cm,m6,x6;g6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cm=function(){};m6=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ho(ga.current);var a=null;switch(r){case"input":i=Rg(e,i),n=Rg(e,n),a=[];break;case"select":i=sr({},i,{value:void 0}),n=sr({},n,{value:void 0}),a=[];break;case"textarea":i=Dg(e,i),n=Dg(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=pd)}Lg(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var o=i[f];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(C0.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(o=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==o&&(u!=null||o!=null))if(f==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(C0.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Yt("scroll",e),a||o===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};x6=function(e,t,r,n){r!==n&&(t.flags|=4)};function Uc(e,t){if(!er)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function fn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uE(e,t,r){var n=t.pendingProps;switch(d2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(t),null;case 1:return $n(t.type)&&gd(),fn(t),null;case 3:return n=t.stateNode,Hl(),Qt(Wn),Qt(yn),S2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ef(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gi!==null&&(xm(Gi),Gi=null))),cm(e,t),fn(t),null;case 5:_2(t);var i=ho(M0.current);if(r=t.type,e!==null&&t.stateNode!=null)m6(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Re(166));return fn(t),null}if(e=ho(ga.current),Ef(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[da]=t,n[O0]=a,e=(t.mode&1)!==0,r){case"dialog":Yt("cancel",n),Yt("close",n);break;case"iframe":case"object":case"embed":Yt("load",n);break;case"video":case"audio":for(i=0;i<e0.length;i++)Yt(e0[i],n);break;case"source":Yt("error",n);break;case"img":case"image":case"link":Yt("error",n),Yt("load",n);break;case"details":Yt("toggle",n);break;case"input":_4(n,a),Yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Yt("invalid",n);break;case"textarea":w4(n,a),Yt("invalid",n)}Lg(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&kf(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&kf(n.textContent,o,e),i=["children",""+o]):C0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Yt("scroll",n)}switch(r){case"input":gf(n),S4(n,a,!0);break;case"textarea":gf(n),k4(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=pd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[da]=t,e[O0]=n,g6(e,t,!1,!1),t.stateNode=e;e:{switch(s=Mg(r,n),r){case"dialog":Yt("cancel",e),Yt("close",e),i=n;break;case"iframe":case"object":case"embed":Yt("load",e),i=n;break;case"video":case"audio":for(i=0;i<e0.length;i++)Yt(e0[i],e);i=n;break;case"source":Yt("error",e),i=n;break;case"img":case"image":case"link":Yt("error",e),Yt("load",e),i=n;break;case"details":Yt("toggle",e),i=n;break;case"input":_4(e,n),i=Rg(e,n),Yt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=sr({},n,{value:void 0}),Yt("invalid",e);break;case"textarea":w4(e,n),i=Dg(e,n),Yt("invalid",e);break;default:i=n}Lg(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?K5(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$5(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&T0(e,u):typeof u=="number"&&T0(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(C0.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Yt("scroll",e):u!=null&&qm(e,a,u,s))}switch(r){case"input":gf(e),S4(e,n,!1);break;case"textarea":gf(e),k4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Rs(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Nl(e,!!n.multiple,a,!1):n.defaultValue!=null&&Nl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=pd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fn(t),null;case 6:if(e&&t.stateNode!=null)x6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Re(166));if(r=ho(M0.current),ho(ga.current),Ef(t)){if(n=t.stateNode,r=t.memoizedProps,n[da]=t,(a=n.nodeValue!==r)&&(e=ei,e!==null))switch(e.tag){case 3:kf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&kf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[da]=t,t.stateNode=n}return fn(t),null;case 13:if(Qt(ir),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(er&&Zn!==null&&t.mode&1&&!(t.flags&128))O_(),Vl(),t.flags|=98560,a=!1;else if(a=Ef(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Re(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Re(317));a[da]=t}else Vl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fn(t),a=!1}else Gi!==null&&(xm(Gi),Gi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ir.current&1?Rr===0&&(Rr=3):I2())),t.updateQueue!==null&&(t.flags|=4),fn(t),null);case 4:return Hl(),cm(e,t),e===null&&I0(t.stateNode.containerInfo),fn(t),null;case 10:return m2(t.type._context),fn(t),null;case 17:return $n(t.type)&&gd(),fn(t),null;case 19:if(Qt(ir),a=t.memoizedState,a===null)return fn(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)Uc(a,!1);else{if(Rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=wd(e),s!==null){for(t.flags|=128,Uc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $t(ir,ir.current&1|2),t.child}e=e.sibling}a.tail!==null&&mr()>$l&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304)}else{if(!n)if(e=wd(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!er)return fn(t),null}else 2*mr()-a.renderingStartTime>$l&&r!==1073741824&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=mr(),t.sibling=null,r=ir.current,$t(ir,n?r&1|2:r&1),t):(fn(t),null);case 22:case 23:return b2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qn&1073741824&&(fn(t),t.subtreeFlags&6&&(t.flags|=8192)):fn(t),null;case 24:return null;case 25:return null}throw Error(Re(156,t.tag))}function fE(e,t){switch(d2(t),t.tag){case 1:return $n(t.type)&&gd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hl(),Qt(Wn),Qt(yn),S2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _2(t),null;case 13:if(Qt(ir),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Re(340));Vl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qt(ir),null;case 4:return Hl(),null;case 10:return m2(t.type._context),null;case 22:case 23:return b2(),null;case 24:return null;default:return null}}var Af=!1,gn=!1,dE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Al(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){cr(e,t,n)}else r.current=null}function um(e,t,r){try{r()}catch(n){cr(e,t,n)}}var dy=!1;function hE(e,t){if(Xg=fd,e=w_(),u2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,f=0,d=0,p=e,g=null;t:for(;;){for(var v;p!==r||i!==0&&p.nodeType!==3||(o=s+i),p!==a||n!==0&&p.nodeType!==3||(u=s+n),p.nodeType===3&&(s+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===e)break t;if(g===r&&++f===i&&(o=s),g===a&&++d===n&&(u=s),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kg={focusedElem:e,selectionRange:r},fd=!1,$e=t;$e!==null;)if(t=$e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$e=e;else for(;$e!==null;){t=$e;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,C=m.memoizedState,S=t.stateNode,w=S.getSnapshotBeforeUpdate(t.elementType===t.type?y:zi(t.type,y),C);S.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(T){cr(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,$e=e;break}$e=t.return}return m=dy,dy=!1,m}function h0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&um(t,r,a)}i=i.next}while(i!==n)}}function oh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function fm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function v6(e){var t=e.alternate;t!==null&&(e.alternate=null,v6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[da],delete t[O0],delete t[qg],delete t[Y9],delete t[Q9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function y6(e){return e.tag===5||e.tag===3||e.tag===4}function hy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||y6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=pd));else if(n!==4&&(e=e.child,e!==null))for(dm(e,t,r),e=e.sibling;e!==null;)dm(e,t,r),e=e.sibling}function hm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(hm(e,t,r),e=e.sibling;e!==null;)hm(e,t,r),e=e.sibling}var Yr=null,Vi=!1;function ls(e,t,r){for(r=r.child;r!==null;)_6(e,t,r),r=r.sibling}function _6(e,t,r){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(Zd,r)}catch{}switch(r.tag){case 5:gn||Al(r,t);case 6:var n=Yr,i=Vi;Yr=null,ls(e,t,r),Yr=n,Vi=i,Yr!==null&&(Vi?(e=Yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yr.removeChild(r.stateNode));break;case 18:Yr!==null&&(Vi?(e=Yr,r=r.stateNode,e.nodeType===8?Up(e.parentNode,r):e.nodeType===1&&Up(e,r),N0(e)):Up(Yr,r.stateNode));break;case 4:n=Yr,i=Vi,Yr=r.stateNode.containerInfo,Vi=!0,ls(e,t,r),Yr=n,Vi=i;break;case 0:case 11:case 14:case 15:if(!gn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&um(r,t,s),i=i.next}while(i!==n)}ls(e,t,r);break;case 1:if(!gn&&(Al(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){cr(r,t,o)}ls(e,t,r);break;case 21:ls(e,t,r);break;case 22:r.mode&1?(gn=(n=gn)||r.memoizedState!==null,ls(e,t,r),gn=n):ls(e,t,r);break;default:ls(e,t,r)}}function py(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dE),t.forEach(function(n){var i=wE.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Mi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yr=o.stateNode,Vi=!1;break e;case 3:Yr=o.stateNode.containerInfo,Vi=!0;break e;case 4:Yr=o.stateNode.containerInfo,Vi=!0;break e}o=o.return}if(Yr===null)throw Error(Re(160));_6(a,s,i),Yr=null,Vi=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){cr(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)S6(t,e),t=t.sibling}function S6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mi(t,e),la(e),n&4){try{h0(3,e,e.return),oh(3,e)}catch(y){cr(e,e.return,y)}try{h0(5,e,e.return)}catch(y){cr(e,e.return,y)}}break;case 1:Mi(t,e),la(e),n&512&&r!==null&&Al(r,r.return);break;case 5:if(Mi(t,e),la(e),n&512&&r!==null&&Al(r,r.return),e.flags&32){var i=e.stateNode;try{T0(i,"")}catch(y){cr(e,e.return,y)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&G5(i,a),Mg(o,s);var f=Mg(o,a);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];d==="style"?K5(i,p):d==="dangerouslySetInnerHTML"?$5(i,p):d==="children"?T0(i,p):qm(i,d,p,f)}switch(o){case"input":bg(i,a);break;case"textarea":H5(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Nl(i,!!a.multiple,v,!1):g!==!!a.multiple&&(a.defaultValue!=null?Nl(i,!!a.multiple,a.defaultValue,!0):Nl(i,!!a.multiple,a.multiple?[]:"",!1))}i[O0]=a}catch(y){cr(e,e.return,y)}}break;case 6:if(Mi(t,e),la(e),n&4){if(e.stateNode===null)throw Error(Re(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(y){cr(e,e.return,y)}}break;case 3:if(Mi(t,e),la(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{N0(t.containerInfo)}catch(y){cr(e,e.return,y)}break;case 4:Mi(t,e),la(e);break;case 13:Mi(t,e),la(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(N2=mr())),n&4&&py(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(gn=(f=gn)||d,Mi(t,e),gn=f):Mi(t,e),la(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for($e=e,d=e.child;d!==null;){for(p=$e=d;$e!==null;){switch(g=$e,v=g.child,g.tag){case 0:case 11:case 14:case 15:h0(4,g,g.return);break;case 1:Al(g,g.return);var m=g.stateNode;if(typeof m.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(y){cr(n,r,y)}}break;case 5:Al(g,g.return);break;case 22:if(g.memoizedState!==null){my(p);continue}}v!==null?(v.return=g,$e=v):my(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,u=p.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=X5("display",s))}catch(y){cr(e,e.return,y)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(y){cr(e,e.return,y)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Mi(t,e),la(e),n&4&&py(e);break;case 21:break;default:Mi(t,e),la(e)}}function la(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(y6(r)){var n=r;break e}r=r.return}throw Error(Re(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(T0(i,""),n.flags&=-33);var a=hy(e);hm(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=hy(e);dm(e,o,s);break;default:throw Error(Re(161))}}catch(u){cr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pE(e,t,r){$e=e,w6(e)}function w6(e,t,r){for(var n=(e.mode&1)!==0;$e!==null;){var i=$e,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Af;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||gn;o=Af;var f=gn;if(Af=s,(gn=u)&&!f)for($e=i;$e!==null;)s=$e,u=s.child,s.tag===22&&s.memoizedState!==null?xy(i):u!==null?(u.return=s,$e=u):xy(i);for(;a!==null;)$e=a,w6(a),a=a.sibling;$e=i,Af=o,gn=f}gy(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,$e=a):gy(e)}}function gy(e){for(;$e!==null;){var t=$e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:gn||oh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!gn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:zi(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Z4(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Z4(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&N0(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}gn||t.flags&512&&fm(t)}catch(g){cr(t,t.return,g)}}if(t===e){$e=null;break}if(r=t.sibling,r!==null){r.return=t.return,$e=r;break}$e=t.return}}function my(e){for(;$e!==null;){var t=$e;if(t===e){$e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,$e=r;break}$e=t.return}}function xy(e){for(;$e!==null;){var t=$e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{oh(4,t)}catch(u){cr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){cr(t,i,u)}}var a=t.return;try{fm(t)}catch(u){cr(t,a,u)}break;case 5:var s=t.return;try{fm(t)}catch(u){cr(t,s,u)}}}catch(u){cr(t,t.return,u)}if(t===e){$e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,$e=o;break}$e=t.return}}var gE=Math.ceil,Cd=Xa.ReactCurrentDispatcher,P2=Xa.ReactCurrentOwner,Ci=Xa.ReactCurrentBatchConfig,Ft=0,Wr=null,Er=null,qr=0,Qn=0,Pl=Bs(0),Rr=0,z0=null,ko=0,lh=0,F2=0,p0=null,Vn=null,N2=0,$l=1/0,Na=null,Td=!1,pm=null,As=null,Pf=!1,ys=null,Ad=0,g0=0,gm=null,td=-1,rd=0;function Nn(){return Ft&6?mr():td!==-1?td:td=mr()}function Ps(e){return e.mode&1?Ft&2&&qr!==0?qr&-qr:J9.transition!==null?(rd===0&&(rd=s_()),rd):(e=jt,e!==0||(e=window.event,e=e===void 0?16:h_(e.type)),e):1}function Ki(e,t,r,n){if(50<g0)throw g0=0,gm=null,Error(Re(185));au(e,r,n),(!(Ft&2)||e!==Wr)&&(e===Wr&&(!(Ft&2)&&(lh|=r),Rr===4&&gs(e,qr)),Xn(e,n),r===1&&Ft===0&&!(t.mode&1)&&($l=mr()+500,ih&&js()))}function Xn(e,t){var r=e.callbackNode;Jk(e,t);var n=ud(e,e===Wr?qr:0);if(n===0)r!==null&&T4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&T4(r),t===1)e.tag===0?q9(vy.bind(null,e)):b_(vy.bind(null,e)),X9(function(){!(Ft&6)&&js()}),r=null;else{switch(o_(n)){case 1:r=r2;break;case 4:r=i_;break;case 16:r=cd;break;case 536870912:r=a_;break;default:r=cd}r=N6(r,k6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function k6(e,t){if(td=-1,rd=0,Ft&6)throw Error(Re(327));var r=e.callbackNode;if(Ol()&&e.callbackNode!==r)return null;var n=ud(e,e===Wr?qr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Pd(e,n);else{t=n;var i=Ft;Ft|=2;var a=C6();(Wr!==e||qr!==t)&&(Na=null,$l=mr()+500,mo(e,t));do try{vE();break}catch(o){E6(e,o)}while(1);g2(),Cd.current=a,Ft=i,Er!==null?t=0:(Wr=null,qr=0,t=Rr)}if(t!==0){if(t===2&&(i=Vg(e),i!==0&&(n=i,t=mm(e,i))),t===1)throw r=z0,mo(e,0),gs(e,n),Xn(e,mr()),r;if(t===6)gs(e,n);else{if(i=e.current.alternate,!(n&30)&&!mE(i)&&(t=Pd(e,n),t===2&&(a=Vg(e),a!==0&&(n=a,t=mm(e,a))),t===1))throw r=z0,mo(e,0),gs(e,n),Xn(e,mr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Re(345));case 2:oo(e,Vn,Na);break;case 3:if(gs(e,n),(n&130023424)===n&&(t=N2+500-mr(),10<t)){if(ud(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Nn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Qg(oo.bind(null,e,Vn,Na),t);break}oo(e,Vn,Na);break;case 4:if(gs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Xi(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=mr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gE(n/1960))-n,10<n){e.timeoutHandle=Qg(oo.bind(null,e,Vn,Na),n);break}oo(e,Vn,Na);break;case 5:oo(e,Vn,Na);break;default:throw Error(Re(329))}}}return Xn(e,mr()),e.callbackNode===r?k6.bind(null,e):null}function mm(e,t){var r=p0;return e.current.memoizedState.isDehydrated&&(mo(e,t).flags|=256),e=Pd(e,t),e!==2&&(t=Vn,Vn=r,t!==null&&xm(t)),e}function xm(e){Vn===null?Vn=e:Vn.push.apply(Vn,e)}function mE(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ji(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gs(e,t){for(t&=~F2,t&=~lh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xi(t),n=1<<r;e[r]=-1,t&=~n}}function vy(e){if(Ft&6)throw Error(Re(327));Ol();var t=ud(e,0);if(!(t&1))return Xn(e,mr()),null;var r=Pd(e,t);if(e.tag!==0&&r===2){var n=Vg(e);n!==0&&(t=n,r=mm(e,n))}if(r===1)throw r=z0,mo(e,0),gs(e,t),Xn(e,mr()),r;if(r===6)throw Error(Re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,oo(e,Vn,Na),Xn(e,mr()),null}function R2(e,t){var r=Ft;Ft|=1;try{return e(t)}finally{Ft=r,Ft===0&&($l=mr()+500,ih&&js())}}function Eo(e){ys!==null&&ys.tag===0&&!(Ft&6)&&Ol();var t=Ft;Ft|=1;var r=Ci.transition,n=jt;try{if(Ci.transition=null,jt=1,e)return e()}finally{jt=n,Ci.transition=r,Ft=t,!(Ft&6)&&js()}}function b2(){Qn=Pl.current,Qt(Pl)}function mo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$9(r)),Er!==null)for(r=Er.return;r!==null;){var n=r;switch(d2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gd();break;case 3:Hl(),Qt(Wn),Qt(yn),S2();break;case 5:_2(n);break;case 4:Hl();break;case 13:Qt(ir);break;case 19:Qt(ir);break;case 10:m2(n.type._context);break;case 22:case 23:b2()}r=r.return}if(Wr=e,Er=e=Fs(e.current,null),qr=Qn=t,Rr=0,z0=null,F2=lh=ko=0,Vn=p0=null,fo!==null){for(t=0;t<fo.length;t++)if(r=fo[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}fo=null}return e}function E6(e,t){do{var r=Er;try{if(g2(),Jf.current=Ed,kd){for(var n=ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}kd=!1}if(wo=0,Hr=Nr=ar=null,d0=!1,B0=0,P2.current=null,r===null||r.return===null){Rr=1,z0=t,Er=null;break}e:{var a=e,s=r.return,o=r,u=t;if(t=qr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=o,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=ay(s);if(v!==null){v.flags&=-257,sy(v,s,o,a,t),v.mode&1&&iy(a,f,t),t=v,u=f;var m=t.updateQueue;if(m===null){var y=new Set;y.add(u),t.updateQueue=y}else m.add(u);break e}else{if(!(t&1)){iy(a,f,t),I2();break e}u=Error(Re(426))}}else if(er&&o.mode&1){var C=ay(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),sy(C,s,o,a,t),h2(Wl(u,o));break e}}a=u=Wl(u,o),Rr!==4&&(Rr=2),p0===null?p0=[a]:p0.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var S=o6(a,u,t);J4(a,S);break e;case 1:o=u;var w=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(As===null||!As.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var T=l6(a,o,t);J4(a,T);break e}}a=a.return}while(a!==null)}A6(r)}catch(A){t=A,Er===r&&r!==null&&(Er=r=r.return);continue}break}while(1)}function C6(){var e=Cd.current;return Cd.current=Ed,e===null?Ed:e}function I2(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Wr===null||!(ko&268435455)&&!(lh&268435455)||gs(Wr,qr)}function Pd(e,t){var r=Ft;Ft|=2;var n=C6();(Wr!==e||qr!==t)&&(Na=null,mo(e,t));do try{xE();break}catch(i){E6(e,i)}while(1);if(g2(),Ft=r,Cd.current=n,Er!==null)throw Error(Re(261));return Wr=null,qr=0,Rr}function xE(){for(;Er!==null;)T6(Er)}function vE(){for(;Er!==null&&!Gk();)T6(Er)}function T6(e){var t=F6(e.alternate,e,Qn);e.memoizedProps=e.pendingProps,t===null?A6(e):Er=t,P2.current=null}function A6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fE(r,t),r!==null){r.flags&=32767,Er=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rr=6,Er=null;return}}else if(r=uE(r,t,Qn),r!==null){Er=r;return}if(t=t.sibling,t!==null){Er=t;return}Er=t=e}while(t!==null);Rr===0&&(Rr=5)}function oo(e,t,r){var n=jt,i=Ci.transition;try{Ci.transition=null,jt=1,yE(e,t,r,n)}finally{Ci.transition=i,jt=n}return null}function yE(e,t,r,n){do Ol();while(ys!==null);if(Ft&6)throw Error(Re(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Re(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Zk(e,a),e===Wr&&(Er=Wr=null,qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Pf||(Pf=!0,N6(cd,function(){return Ol(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ci.transition,Ci.transition=null;var s=jt;jt=1;var o=Ft;Ft|=4,P2.current=null,hE(e,r),S6(r,e),j9(Kg),fd=!!Xg,Kg=Xg=null,e.current=r,pE(r),Hk(),Ft=o,jt=s,Ci.transition=a}else e.current=r;if(Pf&&(Pf=!1,ys=e,Ad=i),a=e.pendingLanes,a===0&&(As=null),Xk(r.stateNode),Xn(e,mr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Td)throw Td=!1,e=pm,pm=null,e;return Ad&1&&e.tag!==0&&Ol(),a=e.pendingLanes,a&1?e===gm?g0++:(g0=0,gm=e):g0=0,js(),null}function Ol(){if(ys!==null){var e=o_(Ad),t=Ci.transition,r=jt;try{if(Ci.transition=null,jt=16>e?16:e,ys===null)var n=!1;else{if(e=ys,ys=null,Ad=0,Ft&6)throw Error(Re(331));var i=Ft;for(Ft|=4,$e=e.current;$e!==null;){var a=$e,s=a.child;if($e.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var f=o[u];for($e=f;$e!==null;){var d=$e;switch(d.tag){case 0:case 11:case 15:h0(8,d,a)}var p=d.child;if(p!==null)p.return=d,$e=p;else for(;$e!==null;){d=$e;var g=d.sibling,v=d.return;if(v6(d),d===f){$e=null;break}if(g!==null){g.return=v,$e=g;break}$e=v}}}var m=a.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var C=y.sibling;y.sibling=null,y=C}while(y!==null)}}$e=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,$e=s;else e:for(;$e!==null;){if(a=$e,a.flags&2048)switch(a.tag){case 0:case 11:case 15:h0(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,$e=S;break e}$e=a.return}}var w=e.current;for($e=w;$e!==null;){s=$e;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,$e=x;else e:for(s=w;$e!==null;){if(o=$e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:oh(9,o)}}catch(A){cr(o,o.return,A)}if(o===s){$e=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,$e=T;break e}$e=o.return}}if(Ft=i,js(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(Zd,e)}catch{}n=!0}return n}finally{jt=r,Ci.transition=t}}return!1}function yy(e,t,r){t=Wl(r,t),t=o6(e,t,1),e=Ts(e,t,1),t=Nn(),e!==null&&(au(e,1,t),Xn(e,t))}function cr(e,t,r){if(e.tag===3)yy(e,e,r);else for(;t!==null;){if(t.tag===3){yy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(As===null||!As.has(n))){e=Wl(r,e),e=l6(t,e,1),t=Ts(t,e,1),e=Nn(),t!==null&&(au(t,1,e),Xn(t,e));break}}t=t.return}}function _E(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nn(),e.pingedLanes|=e.suspendedLanes&r,Wr===e&&(qr&r)===r&&(Rr===4||Rr===3&&(qr&130023424)===qr&&500>mr()-N2?mo(e,0):F2|=r),Xn(e,t)}function P6(e,t){t===0&&(e.mode&1?(t=vf,vf<<=1,!(vf&130023424)&&(vf=4194304)):t=1);var r=Nn();e=Ga(e,t),e!==null&&(au(e,t,r),Xn(e,r))}function SE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),P6(e,r)}function wE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Re(314))}n!==null&&n.delete(t),P6(e,r)}var F6;F6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wn.current)Hn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Hn=!1,cE(e,t,r);Hn=!!(e.flags&131072)}else Hn=!1,er&&t.flags&1048576&&I_(t,vd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ed(e,t),e=t.pendingProps;var i=zl(t,yn.current);Dl(t,r),i=k2(null,t,n,e,i,r);var a=E2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$n(n)?(a=!0,md(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,v2(t),i.updater=sh,t.stateNode=i,i._reactInternals=t,nm(t,n,e,r),t=sm(null,t,n,!0,a,r)):(t.tag=0,er&&a&&f2(t),Tn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ed(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=EE(n),e=zi(n,e),i){case 0:t=am(null,t,n,e,r);break e;case 1:t=cy(null,t,n,e,r);break e;case 11:t=oy(null,t,n,e,r);break e;case 14:t=ly(null,t,n,zi(n.type,e),r);break e}throw Error(Re(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),am(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),cy(e,t,n,i,r);case 3:e:{if(d6(t),e===null)throw Error(Re(387));n=t.pendingProps,a=t.memoizedState,i=a.element,j_(e,t),Sd(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Wl(Error(Re(423)),t),t=uy(e,t,n,r,i);break e}else if(n!==i){i=Wl(Error(Re(424)),t),t=uy(e,t,n,r,i);break e}else for(Zn=Cs(t.stateNode.containerInfo.firstChild),ei=t,er=!0,Gi=null,r=M_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Vl(),n===i){t=Ha(e,t,r);break e}Tn(e,t,n,r)}t=t.child}return t;case 5:return U_(t),e===null&&em(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,Yg(n,i)?s=null:a!==null&&Yg(n,a)&&(t.flags|=32),f6(e,t),Tn(e,t,s,r),t.child;case 6:return e===null&&em(t),null;case 13:return h6(e,t,r);case 4:return y2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Gl(t,null,n,r):Tn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),oy(e,t,n,i,r);case 7:return Tn(e,t,t.pendingProps,r),t.child;case 8:return Tn(e,t,t.pendingProps.children,r),t.child;case 12:return Tn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,$t(yd,n._currentValue),n._currentValue=s,a!==null)if(Ji(a.value,s)){if(a.children===i.children&&!Wn.current){t=Ha(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=Ma(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),tm(a.return,r,t),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Re(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),tm(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Tn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Dl(t,r),i=Ti(i),n=n(i),t.flags|=1,Tn(e,t,n,r),t.child;case 14:return n=t.type,i=zi(n,t.pendingProps),i=zi(n.type,i),ly(e,t,n,i,r);case 15:return c6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:zi(n,i),ed(e,t),t.tag=1,$n(n)?(e=!0,md(t)):e=!1,Dl(t,r),s6(t,n,i),nm(t,n,i,r),sm(null,t,n,!0,e,r);case 19:return p6(e,t,r);case 22:return u6(e,t,r)}throw Error(Re(156,t.tag))};function N6(e,t){return n_(e,t)}function kE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(e,t,r,n){return new kE(e,t,r,n)}function D2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function EE(e){if(typeof e=="function")return D2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zm)return 11;if(e===e2)return 14}return 2}function Fs(e,t){var r=e.alternate;return r===null?(r=Ei(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function nd(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")D2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case vl:return xo(r.children,i,a,t);case Jm:s=8,i|=8;break;case Ag:return e=Ei(12,r,t,i|2),e.elementType=Ag,e.lanes=a,e;case Pg:return e=Ei(13,r,t,i),e.elementType=Pg,e.lanes=a,e;case Fg:return e=Ei(19,r,t,i),e.elementType=Fg,e.lanes=a,e;case U5:return ch(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B5:s=10;break e;case j5:s=9;break e;case Zm:s=11;break e;case e2:s=14;break e;case ds:s=16,n=null;break e}throw Error(Re(130,e==null?e:typeof e,""))}return t=Ei(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function xo(e,t,r,n){return e=Ei(7,e,n,t),e.lanes=r,e}function ch(e,t,r,n){return e=Ei(22,e,n,t),e.elementType=U5,e.lanes=r,e.stateNode={isHidden:!1},e}function Kp(e,t,r){return e=Ei(6,e,null,t),e.lanes=r,e}function Yp(e,t,r){return t=Ei(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function CE(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fp(0),this.expirationTimes=Fp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function O2(e,t,r,n,i,a,s,o,u){return e=new CE(e,t,r,o,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ei(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},v2(a),e}function TE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function R6(e){if(!e)return bs;e=e._reactInternals;e:{if(Ro(e)!==e||e.tag!==1)throw Error(Re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($n(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Re(171))}if(e.tag===1){var r=e.type;if($n(r))return R_(e,r,t)}return t}function b6(e,t,r,n,i,a,s,o,u){return e=O2(r,n,!0,e,i,a,s,o,u),e.context=R6(null),r=e.current,n=Nn(),i=Ps(r),a=Ma(n,i),a.callback=t??null,Ts(r,a,i),e.current.lanes=i,au(e,i,n),Xn(e,n),e}function uh(e,t,r,n){var i=t.current,a=Nn(),s=Ps(i);return r=R6(r),t.context===null?t.context=r:t.pendingContext=r,t=Ma(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ts(i,t,s),e!==null&&(Ki(e,i,s,a),qf(e,i,s)),s}function Fd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _y(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function L2(e,t){_y(e,t),(e=e.alternate)&&_y(e,t)}function AE(){return null}var I6=typeof reportError=="function"?reportError:function(e){console.error(e)};function M2(e){this._internalRoot=e}fh.prototype.render=M2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Re(409));uh(e,t,null,null)};fh.prototype.unmount=M2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Eo(function(){uh(null,e,null,null)}),t[Va]=null}};function fh(e){this._internalRoot=e}fh.prototype.unstable_scheduleHydration=function(e){if(e){var t=u_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ps.length&&t!==0&&t<ps[r].priority;r++);ps.splice(r,0,e),r===0&&d_(e)}};function B2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function dh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sy(){}function PE(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Fd(s);a.call(f)}}var s=b6(t,n,e,0,null,!1,!1,"",Sy);return e._reactRootContainer=s,e[Va]=s.current,I0(e.nodeType===8?e.parentNode:e),Eo(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var f=Fd(u);o.call(f)}}var u=O2(e,0,!1,null,null,!1,!1,"",Sy);return e._reactRootContainer=u,e[Va]=u.current,I0(e.nodeType===8?e.parentNode:e),Eo(function(){uh(t,u,r,n)}),u}function hh(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=Fd(s);o.call(u)}}uh(t,s,e,i)}else s=PE(r,t,e,i,n);return Fd(s)}l_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zc(t.pendingLanes);r!==0&&(n2(t,r|1),Xn(t,mr()),!(Ft&6)&&($l=mr()+500,js()))}break;case 13:Eo(function(){var n=Ga(e,1);if(n!==null){var i=Nn();Ki(n,e,1,i)}}),L2(e,1)}};i2=function(e){if(e.tag===13){var t=Ga(e,134217728);if(t!==null){var r=Nn();Ki(t,e,134217728,r)}L2(e,134217728)}};c_=function(e){if(e.tag===13){var t=Ps(e),r=Ga(e,t);if(r!==null){var n=Nn();Ki(r,e,t,n)}L2(e,t)}};u_=function(){return jt};f_=function(e,t){var r=jt;try{return jt=e,t()}finally{jt=r}};jg=function(e,t,r){switch(t){case"input":if(bg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=nh(n);if(!i)throw Error(Re(90));V5(n),bg(n,i)}}}break;case"textarea":H5(e,r);break;case"select":t=r.value,t!=null&&Nl(e,!!r.multiple,t,!1)}};q5=R2;J5=Eo;var FE={usingClientEntryPoint:!1,Events:[ou,wl,nh,Y5,Q5,R2]},zc={findFiberByHostInstance:uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NE={bundleType:zc.bundleType,version:zc.version,rendererPackageName:zc.rendererPackageName,rendererConfig:zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=t_(e),e===null?null:e.stateNode},findFiberByHostInstance:zc.findFiberByHostInstance||AE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{Zd=Ff.inject(NE),pa=Ff}catch{}}ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;ii.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B2(t))throw Error(Re(200));return TE(e,t,null,r)};ii.createRoot=function(e,t){if(!B2(e))throw Error(Re(299));var r=!1,n="",i=I6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=O2(e,1,!1,null,null,r,!1,n,i),e[Va]=t.current,I0(e.nodeType===8?e.parentNode:e),new M2(t)};ii.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Re(188)):(e=Object.keys(e).join(","),Error(Re(268,e)));return e=t_(t),e=e===null?null:e.stateNode,e};ii.flushSync=function(e){return Eo(e)};ii.hydrate=function(e,t,r){if(!dh(t))throw Error(Re(200));return hh(null,e,t,!0,r)};ii.hydrateRoot=function(e,t,r){if(!B2(e))throw Error(Re(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=I6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=b6(t,null,e,1,r??null,i,!1,a,s),e[Va]=t.current,I0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new fh(t)};ii.render=function(e,t,r){if(!dh(t))throw Error(Re(200));return hh(null,e,t,!1,r)};ii.unmountComponentAtNode=function(e){if(!dh(e))throw Error(Re(40));return e._reactRootContainer?(Eo(function(){hh(null,null,e,!1,function(){e._reactRootContainer=null,e[Va]=null})}),!0):!1};ii.unstable_batchedUpdates=R2;ii.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!dh(r))throw Error(Re(200));if(e==null||e._reactInternals===void 0)throw Error(Re(38));return hh(e,t,r,!1,n)};ii.version="18.3.1-next-f1338f8080-20240426";function D6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(D6)}catch(e){console.error(e)}}D6(),D5.exports=ii;var RE=D5.exports,wy=RE;Cg.createRoot=wy.createRoot,Cg.hydrateRoot=wy.hydrateRoot;const ky=e=>{let t;const r=new Set,n=(d,p)=>{const g=typeof d=="function"?d(t):d;if(!Object.is(g,t)){const v=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(m=>m(t,v))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>f,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},f=t=e(n,i,u);return u},bE=e=>e?ky(e):ky;var O6={exports:{}},L6={},M6={exports:{}},B6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xl=Se;function IE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var DE=typeof Object.is=="function"?Object.is:IE,OE=Xl.useState,LE=Xl.useEffect,ME=Xl.useLayoutEffect,BE=Xl.useDebugValue;function jE(e,t){var r=t(),n=OE({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return ME(function(){i.value=r,i.getSnapshot=t,Qp(i)&&a({inst:i})},[e,r,t]),LE(function(){return Qp(i)&&a({inst:i}),e(function(){Qp(i)&&a({inst:i})})},[e]),BE(r),r}function Qp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!DE(e,r)}catch{return!0}}function UE(e,t){return t()}var zE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?UE:jE;B6.useSyncExternalStore=Xl.useSyncExternalStore!==void 0?Xl.useSyncExternalStore:zE;M6.exports=B6;var VE=M6.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph=Se,GE=VE;function HE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var WE=typeof Object.is=="function"?Object.is:HE,$E=GE.useSyncExternalStore,XE=ph.useRef,KE=ph.useEffect,YE=ph.useMemo,QE=ph.useDebugValue;L6.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=XE(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=YE(function(){function u(v){if(!f){if(f=!0,d=v,v=n(v),i!==void 0&&s.hasValue){var m=s.value;if(i(m,v))return p=m}return p=v}if(m=p,WE(d,v))return m;var y=n(v);return i!==void 0&&i(m,y)?(d=v,m):(d=v,p=y)}var f=!1,d,p,g=r===void 0?null:r;return[function(){return u(t())},g===null?void 0:function(){return u(g())}]},[t,r,n,i]);var o=$E(e,a[0],a[1]);return KE(function(){s.hasValue=!0,s.value=o},[o]),QE(o),o};O6.exports=L6;var qE=O6.exports;const JE=qd(qE),{useDebugValue:ZE}=kr,{useSyncExternalStoreWithSelector:eC}=JE;const tC=e=>e;function rC(e,t=tC,r){const n=eC(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return ZE(n),n}const Ey=e=>{const t=typeof e=="function"?bE(e):e,r=(n,i)=>rC(t,n,i);return Object.assign(r,t),r},nC=e=>e?Ey(e):Ey;var j6=Symbol.for("immer-nothing"),Cy=Symbol.for("immer-draftable"),Lt=Symbol.for("immer-state");function ki(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Kl=Object.getPrototypeOf;function Yl(e){return!!e&&!!e[Lt]}function Wa(e){var t;return e?U6(e)||Array.isArray(e)||!!e[Cy]||!!((t=e.constructor)!=null&&t[Cy])||mh(e)||xh(e):!1}var iC=Object.prototype.constructor.toString();function U6(e){if(!e||typeof e!="object")return!1;const t=Kl(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===iC}function V0(e,t){gh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function gh(e){const t=e[Lt];return t?t.type_:Array.isArray(e)?1:mh(e)?2:xh(e)?3:0}function vm(e,t){return gh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function z6(e,t,r){const n=gh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function aC(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function mh(e){return e instanceof Map}function xh(e){return e instanceof Set}function Vr(e){return e.copy_||e.base_}function ym(e,t){if(mh(e))return new Map(e);if(xh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=U6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Lt];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Kl(e),n)}else{const n=Kl(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function j2(e,t=!1){return vh(e)||Yl(e)||!Wa(e)||(gh(e)>1&&(e.set=e.add=e.clear=e.delete=sC),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>j2(n,!0))),e}function sC(){ki(2)}function vh(e){return Object.isFrozen(e)}var _m={};function Co(e){const t=_m[e];return t||ki(0,e),t}function oC(e,t){_m[e]||(_m[e]=t)}var G0;function Nd(){return G0}function lC(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ty(e,t){t&&(Co("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Sm(e){wm(e),e.drafts_.forEach(cC),e.drafts_=null}function wm(e){e===G0&&(G0=e.parent_)}function Ay(e){return G0=lC(G0,e)}function cC(e){const t=e[Lt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Py(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Lt].modified_&&(Sm(t),ki(4)),Wa(e)&&(e=Rd(t,e),t.parent_||bd(t,e)),t.patches_&&Co("Patches").generateReplacementPatches_(r[Lt].base_,e,t.patches_,t.inversePatches_)):e=Rd(t,r,[]),Sm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==j6?e:void 0}function Rd(e,t,r){if(vh(t))return t;const n=t[Lt];if(!n)return V0(t,(i,a)=>Fy(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return bd(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),V0(a,(o,u)=>Fy(e,n,i,o,u,r,s)),bd(e,i,!1),r&&e.patches_&&Co("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Fy(e,t,r,n,i,a,s){if(Yl(i)){const o=a&&t&&t.type_!==3&&!vm(t.assigned_,n)?a.concat(n):void 0,u=Rd(e,i,o);if(z6(r,n,u),Yl(u))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Wa(i)&&!vh(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Rd(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&bd(e,i)}}function bd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&j2(t,r)}function uC(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Nd(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=U2;r&&(i=[n],a=H0);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var U2={get(e,t){if(t===Lt)return e;const r=Vr(e);if(!vm(r,t))return fC(e,r,t);const n=r[t];return e.finalized_||!Wa(n)?n:n===qp(e.base_,t)?(Jp(e),e.copy_[t]=W0(n,e)):n},has(e,t){return t in Vr(e)},ownKeys(e){return Reflect.ownKeys(Vr(e))},set(e,t,r){const n=V6(Vr(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=qp(Vr(e),t),a=i==null?void 0:i[Lt];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(aC(r,i)&&(r!==void 0||vm(e.base_,t)))return!0;Jp(e),Ia(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return qp(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Jp(e),Ia(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Vr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ki(11)},getPrototypeOf(e){return Kl(e.base_)},setPrototypeOf(){ki(12)}},H0={};V0(U2,(e,t)=>{H0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});H0.deleteProperty=function(e,t){return H0.set.call(this,e,t,void 0)};H0.set=function(e,t,r){return U2.set.call(this,e[0],t,r,e[0])};function qp(e,t){const r=e[Lt];return(r?Vr(r):e)[t]}function fC(e,t,r){var i;const n=V6(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function V6(e,t){if(!(t in e))return;let r=Kl(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Kl(r)}}function Ia(e){e.modified_||(e.modified_=!0,e.parent_&&Ia(e.parent_))}function Jp(e){e.copy_||(e.copy_=ym(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dC=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(u=a,...f){return s.produce(u,d=>r.call(this,d,...f))}}typeof r!="function"&&ki(6),n!==void 0&&typeof n!="function"&&ki(7);let i;if(Wa(t)){const a=Ay(this),s=W0(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Sm(a):wm(a)}return Ty(a,n),Py(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===j6&&(i=void 0),this.autoFreeze_&&j2(i,!0),n){const a=[],s=[];Co("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else ki(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,u=>t(u,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Wa(e)||ki(8),Yl(e)&&(e=hC(e));const t=Ay(this),r=W0(e,void 0);return r[Lt].isManual_=!0,wm(t),r}finishDraft(e,t){const r=e&&e[Lt];(!r||!r.isManual_)&&ki(9);const{scope_:n}=r;return Ty(n,t),Py(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Co("Patches").applyPatches_;return Yl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function W0(e,t){const r=mh(e)?Co("MapSet").proxyMap_(e,t):xh(e)?Co("MapSet").proxySet_(e,t):uC(e,t);return(t?t.scope_:Nd()).drafts_.push(r),r}function hC(e){return Yl(e)||ki(10,e),G6(e)}function G6(e){if(!Wa(e)||vh(e))return e;const t=e[Lt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ym(e,t.scope_.immer_.useStrictShallowCopy_)}else r=ym(e,!0);return V0(r,(n,i)=>{z6(r,n,G6(i))}),t&&(t.finalized_=!1),r}function pC(){class e extends Map{constructor(u,f){super(),this[Lt]={type_:2,parent_:f,scope_:f?f.scope_:Nd(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:u,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Vr(this[Lt]).size}has(u){return Vr(this[Lt]).has(u)}set(u,f){const d=this[Lt];return s(d),(!Vr(d).has(u)||Vr(d).get(u)!==f)&&(r(d),Ia(d),d.assigned_.set(u,!0),d.copy_.set(u,f),d.assigned_.set(u,!0)),this}delete(u){if(!this.has(u))return!1;const f=this[Lt];return s(f),r(f),Ia(f),f.base_.has(u)?f.assigned_.set(u,!1):f.assigned_.delete(u),f.copy_.delete(u),!0}clear(){const u=this[Lt];s(u),Vr(u).size&&(r(u),Ia(u),u.assigned_=new Map,V0(u.base_,f=>{u.assigned_.set(f,!1)}),u.copy_.clear())}forEach(u,f){const d=this[Lt];Vr(d).forEach((p,g,v)=>{u.call(f,this.get(g),g,this)})}get(u){const f=this[Lt];s(f);const d=Vr(f).get(u);if(f.finalized_||!Wa(d)||d!==f.base_.get(u))return d;const p=W0(d,f);return r(f),f.copy_.set(u,p),p}keys(){return Vr(this[Lt]).keys()}values(){const u=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const f=u.next();return f.done?f:{done:!1,value:this.get(f.value)}}}}entries(){const u=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const f=u.next();if(f.done)return f;const d=this.get(f.value);return{done:!1,value:[f.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,u){return new e(o,u)}function r(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class n extends Set{constructor(u,f){super(),this[Lt]={type_:3,parent_:f,scope_:f?f.scope_:Nd(),modified_:!1,finalized_:!1,copy_:void 0,base_:u,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Vr(this[Lt]).size}has(u){const f=this[Lt];return s(f),f.copy_?!!(f.copy_.has(u)||f.drafts_.has(u)&&f.copy_.has(f.drafts_.get(u))):f.base_.has(u)}add(u){const f=this[Lt];return s(f),this.has(u)||(a(f),Ia(f),f.copy_.add(u)),this}delete(u){if(!this.has(u))return!1;const f=this[Lt];return s(f),a(f),Ia(f),f.copy_.delete(u)||(f.drafts_.has(u)?f.copy_.delete(f.drafts_.get(u)):!1)}clear(){const u=this[Lt];s(u),Vr(u).size&&(a(u),Ia(u),u.copy_.clear())}values(){const u=this[Lt];return s(u),a(u),u.copy_.values()}entries(){const u=this[Lt];return s(u),a(u),u.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(u,f){const d=this.values();let p=d.next();for(;!p.done;)u.call(f,p.value,p.value,this),p=d.next()}}function i(o,u){return new n(o,u)}function a(o){o.copy_||(o.copy_=new Set,o.base_.forEach(u=>{if(Wa(u)){const f=W0(u,o);o.drafts_.set(u,f),o.copy_.add(f)}else o.copy_.add(u)}))}function s(o){o.revoked_&&ki(3,JSON.stringify(Vr(o)))}oC("MapSet",{proxyMap_:t,proxySet_:i})}var ri=new dC,gC=ri.produce;ri.produceWithPatches.bind(ri);ri.setAutoFreeze.bind(ri);ri.setUseStrictShallowCopy.bind(ri);ri.applyPatches.bind(ri);ri.createDraft.bind(ri);ri.finishDraft.bind(ri);const mC=e=>(t,r,n)=>(n.setState=(i,a,...s)=>{const o=typeof i=="function"?gC(i):i;return t(o,a,...s)},e(n.setState,r,n)),xC=mC;class Ar{static initialize(t=50){this.state.maxHistorySize=t}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static notifyListeners(){this.listeners.forEach(t=>t())}static recordAction(t,r,n){const i={id:crypto.randomUUID(),type:t,timestamp:new Date,data:JSON.parse(JSON.stringify(r)),description:n};return this.state.history=this.state.history.slice(0,this.state.currentIndex+1),this.state.history.push(i),this.state.currentIndex++,this.state.history.length>this.state.maxHistorySize&&(this.state.history.shift(),this.state.currentIndex--),this.notifyListeners(),i.id}static canUndo(){return this.state.currentIndex>=0}static canRedo(){return this.state.currentIndex<this.state.history.length-1}static undo(){if(!this.canUndo())return null;const t=this.state.history[this.state.currentIndex];return this.state.currentIndex--,this.notifyListeners(),t}static redo(){if(!this.canRedo())return null;this.state.currentIndex++;const t=this.state.history[this.state.currentIndex];return this.notifyListeners(),t}static getHistory(){return[...this.state.history]}static getCurrentIndex(){return this.state.currentIndex}static clear(){this.state.history=[],this.state.currentIndex=-1,this.notifyListeners()}static createPinAssignmentAction(t,r,n){return{type:"PIN_ASSIGNMENT",data:{pinId:t,oldSignal:r,newSignal:n}}}static createBulkAssignmentAction(t){return{type:"BULK_ASSIGNMENT",data:{assignments:t}}}static createSelectionAction(t,r){return{type:"SELECTION_CHANGE",data:{oldSelection:Array.from(t),newSelection:Array.from(r)}}}static createViewChangeAction(t,r){return{type:"VIEW_CHANGE",data:{oldView:t,newView:r}}}static getActionDescription(t){switch(t.type){case"PIN_ASSIGNMENT":{const{pinId:r,newSignal:n}=t.data;return n?`Assigned "${n}" to pin ${r}`:`Cleared assignment from pin ${r}`}case"BULK_ASSIGNMENT":return`Bulk assignment to ${t.data.assignments.length} pins`;case"SELECTION_CHANGE":return`Selected ${t.data.newSelection.length} pin(s)`;case"VIEW_CHANGE":return"Changed view settings";default:return t.description||`Unknown action: ${t.type}`}}}Ar.state={history:[],currentIndex:-1,maxHistorySize:50};Ar.listeners=new Set;function Is(e){if(e.length===1)return e.charCodeAt(0)-65;if(e.length===2){const t=e.charCodeAt(0)-65,r=e.charCodeAt(1)-65;return 26+t*26+r}return 0}function cl(e){if(e<0)return console.warn(` Invalid index ${e}, defaulting to 'A'`),"A";if(e<26)return String.fromCharCode(65+e);{const t=e-26,r=Math.floor(t/26),n=t%26;return String.fromCharCode(65+r)+String.fromCharCode(65+n)}}function H6(e,t){const r=Is(e),n=Is(t);return r-n}pC();const Zp={rotation:0,isTopView:!0,zoom:1,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},Nf={pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"grid",sortOrder:"asc"},vC={activeTab:"overview",viewMode:"grid",searchQuery:"",selectedRows:new Set,sortColumn:void 0,sortDirection:"asc",commentFilter:"all"},Yi=nC()(xC((e,t)=>({currentProject:null,package:null,pins:[],filteredPins:[],selectedPins:new Set,visibleBanks:new Set,viewConfig:Zp,listView:vC,pinColorMode:"bank",filters:Nf,isLoading:!1,error:null,recentFiles:[],canUndo:!1,canRedo:!1,currentActionDescription:null,nextRedoActionDescription:null,loadProject:r=>{e(n=>{n.currentProject=r,n.package=r.packageData,n.pins=r.pinAssignments,n.viewConfig=r.viewConfig,n.filters=r.filters}),t().applyFilters()},createNewProject:(r,n)=>e(i=>{const a={id:crypto.randomUUID(),name:r,description:"",created:new Date,modified:new Date,projectInfo:{device:n.device,package:n.packageType,speedGrade:"-1",temperature:"C"},packageData:n,pinAssignments:n.pins,viewConfig:Zp,filters:Nf};i.currentProject=a,i.package=n,i.pins=n.pins,i.filteredPins=n.pins,i.viewConfig=Zp,i.filters=Nf;const s=new Set;n.pins.forEach(o=>{const u=o.bank||"NA";s.add(u)}),i.visibleBanks=s,console.log(" : newProject -  visibleBanks:",Array.from(s)),t().applyFilters()}),saveProject:()=>e(r=>{r.currentProject&&(r.currentProject.modified=new Date,r.currentProject.pinAssignments=r.pins,r.currentProject.viewConfig=r.viewConfig,r.currentProject.filters=r.filters)}),loadPackage:r=>e(n=>{var a;console.log(" : loadPackage",r),n.package=r,n.pins=r.pins,n.filteredPins=r.pins,n.selectedPins.clear();const i=new Set;r.pins.forEach(s=>{const o=s.bank||"NA";i.add(o)}),n.visibleBanks=i,console.log(" :  visibleBanks:",Array.from(i)),console.log(" :",{packageName:(a=n.package)==null?void 0:a.name,pinsCount:n.pins.length,filteredPinsCount:n.filteredPins.length})}),updatePin:(r,n)=>{e(i=>{const a=i.pins.find(s=>s.id===r);a&&(Object.assign(a,n),n.signalName!==void 0&&(a.isAssigned=n.signalName!==""))}),t().applyFilters()},updatePins:r=>e(n=>{r.forEach((i,a)=>{const s=n.pins.find(o=>o.id===a);s&&(Object.assign(s,i),i.signalName!==void 0&&(s.isAssigned=i.signalName!==""))})}),assignSignal:(r,n)=>{const a=t().pins.find(u=>u.id===r);if(!a)return;const s=a.signalName,o=Ar.createPinAssignmentAction(r,s,n);Ar.recordAction(o.type,o.data,n?` "${n}"  ${r} `:` ${r} `),e(u=>{const f=u.pins.find(d=>d.id===r);f&&(f.signalName=n,f.isAssigned=n!=="")}),t().applyFilters(),t().updateUndoRedoState()},clearSignal:r=>{const i=t().pins.find(o=>o.id===r);if(!i||!i.signalName)return;const a=i.signalName,s=Ar.createPinAssignmentAction(r,a,"");Ar.recordAction(s.type,s.data,` ${r} `),e(o=>{const u=o.pins.find(f=>f.id===r);u&&(u.signalName="",u.isAssigned=!1)}),t().applyFilters(),t().updateUndoRedoState()},selectPin:r=>e(n=>{n.selectedPins.clear(),n.selectedPins.add(r)}),selectPins:r=>e(n=>{n.selectedPins.clear(),r.forEach(i=>n.selectedPins.add(i))}),clearSelection:()=>e(r=>{r.selectedPins.clear()}),togglePinSelection:r=>e(n=>{n.selectedPins.has(r)?n.selectedPins.delete(r):n.selectedPins.add(r)}),setRotation:r=>e(n=>{n.viewConfig.rotation=r%360}),toggleView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setZoom:r=>e(n=>{n.viewConfig.zoom=Math.max(.1,Math.min(5,r))}),resetZoom:()=>e(r=>{r.viewConfig.zoom=1}),updateViewConfig:r=>e(n=>{Object.assign(n.viewConfig,r)}),updateFilters:r=>e(n=>{Object.assign(n.filters,r);let i=[...n.pins];if(n.filters.pinTypes.length>0&&(i=i.filter(a=>n.filters.pinTypes.includes(a.pinType))),n.filters.banks.length>0&&(i=i.filter(a=>a.bank&&n.filters.banks.includes(a.bank))),n.filters.searchText){const a=n.filters.searchText.toLowerCase();i=i.filter(s=>s.pinNumber.toLowerCase().includes(a)||s.pinName.toLowerCase().includes(a)||s.signalName.toLowerCase().includes(a))}n.filters.voltageFilter.length>0&&(i=i.filter(a=>n.filters.voltageFilter.includes(a.voltage))),n.filters.assignmentStatus!=="all"&&(i=i.filter(a=>n.filters.assignmentStatus==="assigned"?a.isAssigned:!a.isAssigned)),n.filters.showOnlyDifferentialPairs&&(i=i.filter(a=>a.differentialPair)),i.sort((a,s)=>{var d,p;let o,u;switch(n.filters.sortField){case"pinNumber":o=a.pinNumber,u=s.pinNumber;break;case"pinName":o=a.pinName,u=s.pinName;break;case"signalName":o=a.signalName,u=s.signalName;break;case"pinType":o=a.pinType,u=s.pinType;break;case"bank":o=a.bank||"",u=s.bank||"";break;case"grid":if(a.gridPosition&&s.gridPosition){const g=H6(a.gridPosition.row,s.gridPosition.row);if(g!==0)return n.filters.sortOrder==="asc"?g:-g;const v=a.gridPosition.col-s.gridPosition.col;return n.filters.sortOrder==="asc"?v:-v}o=((d=a.gridPosition)==null?void 0:d.row)||"",u=((p=s.gridPosition)==null?void 0:p.row)||"";break;default:o=a.pinNumber,u=s.pinNumber}const f=o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"});return n.filters.sortOrder==="asc"?f:-f}),n.filteredPins=i}),clearFilters:()=>e(r=>{r.filters={...Nf},r.filteredPins=r.pins}),applyFilters:()=>e(r=>{let n=[...r.pins];if(console.log(" applyFilters: visibleBanks =",Array.from(r.visibleBanks)),console.log(" applyFilters: pins before bank filter =",n.length),r.visibleBanks.size>0){const i=n.length;n=n.filter(a=>{const s=a.bank||"UNASSIGNED";return r.visibleBanks.has(s)}),console.log(` applyFilters: filtered from ${i} to ${n.length} pins`)}else console.log(" applyFilters: visibleBanks is empty, showing all pins");if(r.filters.pinTypes.length>0&&(n=n.filter(i=>r.filters.pinTypes.includes(i.pinType))),r.filters.banks.length>0&&(n=n.filter(i=>i.bank&&r.filters.banks.includes(i.bank))),r.filters.searchText){const i=r.filters.searchText.toLowerCase();n=n.filter(a=>a.pinNumber.toLowerCase().includes(i)||a.pinName.toLowerCase().includes(i)||a.signalName.toLowerCase().includes(i))}r.filters.voltageFilter.length>0&&(n=n.filter(i=>r.filters.voltageFilter.includes(i.voltage))),r.filters.assignmentStatus!=="all"&&(n=n.filter(i=>r.filters.assignmentStatus==="assigned"?i.isAssigned:!i.isAssigned)),r.filters.showOnlyDifferentialPairs&&(n=n.filter(i=>i.differentialPair)),n.sort((i,a)=>{let s,o;switch(r.filters.sortField){case"pinNumber":s=i.pinNumber,o=a.pinNumber;break;case"pinName":s=i.pinName,o=a.pinName;break;case"signalName":s=i.signalName||"",o=a.signalName||"";break;case"pinType":s=i.pinType,o=a.pinType;break;case"bank":s=i.bank||"",o=a.bank||"";break;default:s=i.pinNumber,o=a.pinNumber}const u=s.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"});return r.filters.sortOrder==="asc"?u:-u}),r.filteredPins=n}),setSortField:r=>e(n=>{n.filters.sortField=r,t().applyFilters()}),setSortOrder:r=>e(n=>{n.filters.sortOrder=r,t().applyFilters()}),toggleBankVisibility:r=>{e(n=>{console.log(` toggleBankVisibility called for Bank ${r}`),console.log(" Before: visibleBanks =",Array.from(n.visibleBanks)),n.visibleBanks.has(r)?(n.visibleBanks.delete(r),console.log(` Removed Bank ${r} from visibleBanks`)):(n.visibleBanks.add(r),console.log(` Added Bank ${r} to visibleBanks`)),console.log(" After: visibleBanks =",Array.from(n.visibleBanks))}),console.log(" Calling applyFilters after state update..."),t().applyFilters()},setBankVisibility:(r,n)=>{e(i=>{n?i.visibleBanks.add(r):i.visibleBanks.delete(r)}),t().applyFilters()},showAllBanks:()=>{e(r=>{console.log(" showAllBanks: clearing visibleBanks"),r.visibleBanks.clear()}),t().applyFilters()},assignDifferentialPair:(r,n,i)=>e(a=>{const s=a.pins.find(u=>u.id===r),o=a.pins.find(u=>u.id===n);s&&o&&(s.signalName=`${i}_P`,s.isAssigned=!0,s.differentialPair={pair:n,type:"positive"},o.signalName=`${i}_N`,o.isAssigned=!0,o.differentialPair={pair:r,type:"negative"})}),clearDifferentialPair:r=>e(n=>{const i=n.pins.find(a=>a.id===r);if(i&&i.differentialPair){const a=n.pins.find(s=>s.id===i.differentialPair.pair);i.differentialPair=void 0,i.signalName="",i.isAssigned=!1,a&&(a.differentialPair=void 0,a.signalName="",a.isAssigned=!1)}}),rotatePins:r=>e(n=>{n.viewConfig.rotation=(n.viewConfig.rotation+r)%360}),flipView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setLoading:r=>e(n=>{n.isLoading=r}),setError:r=>e(n=>{n.error=r}),setViewMode:r=>e(n=>{n.listView.viewMode=r}),setActiveTab:r=>e(n=>{n.listView.activeTab=r}),setSearchQuery:r=>e(n=>{n.listView.searchQuery=r}),setCommentFilter:r=>e(n=>{n.listView.commentFilter=r}),updateListViewState:r=>e(n=>{Object.assign(n.listView,r)}),bulkUpdateComments:(r,n)=>{e(i=>{const a=new Date;r.forEach(s=>{const o=i.pins.find(u=>u.id===s);o&&(o.comment=n,o.commentTimestamp=a,o.commentAuthor="current_user")}),i.listView.selectedRows.clear()}),t().applyFilters()},setPinColorMode:r=>e(n=>{n.pinColorMode=r}),addRecentFile:r=>e(n=>{const i=n.recentFiles.filter(a=>a!==r);n.recentFiles=[r,...i].slice(0,10)}),undo:()=>{const r=Ar.undo();r&&(t().handleUndoRedoAction(r,"undo"),t().updateUndoRedoState())},redo:()=>{const r=Ar.redo();r&&(t().handleUndoRedoAction(r,"redo"),t().updateUndoRedoState())},updateUndoRedoState:()=>e(r=>{r.canUndo=Ar.canUndo(),r.canRedo=Ar.canRedo();const n=Ar.getHistory(),i=Ar.getCurrentIndex();i>=0&&i<n.length?r.currentActionDescription=Ar.getActionDescription(n[i]):r.currentActionDescription=null,i+1<n.length?r.nextRedoActionDescription=Ar.getActionDescription(n[i+1]):r.nextRedoActionDescription=null}),clearHistory:()=>{Ar.clear(),t().updateUndoRedoState()},handleUndoRedoAction:(r,n)=>{const{type:i,data:a}=r;switch(i){case"PIN_ASSIGNMENT":{const{pinId:s,oldSignal:o,newSignal:u}=a,f=n==="undo"?o:u;e(d=>{const p=d.pins.find(g=>g.id===s);p&&(p.signalName=f||"",p.isAssigned=!!f)}),t().applyFilters();break}case"BULK_ASSIGNMENT":{const{assignments:s}=a;e(o=>{s.forEach(({pinId:u,oldSignal:f,newSignal:d})=>{const p=o.pins.find(g=>g.id===u);if(p){const g=n==="undo"?f:d;p.signalName=g||"",p.isAssigned=!!g}})}),t().applyFilters();break}case"SELECTION_CHANGE":{const{oldSelection:s,newSelection:o}=a,u=n==="undo"?s:o;e(f=>{f.selectedPins=new Set(u)});break}case"VIEW_CHANGE":{const{oldView:s,newView:o}=a,u=n==="undo"?s:o;e(f=>{Object.assign(f.viewConfig,u)});break}default:console.warn(`Unhandled undo/redo action type: ${i}`);break}}})));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var W6=1252,yC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],z2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V2=function(e){yC.indexOf(e)!=-1&&(W6=z2[0]=e)};function _C(){V2(1252)}var Wi=function(e){V2(e)};function $6(){Wi(1200),_C()}function Ny(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function SC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function X6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var t0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?SC(e.slice(2)):t==254&&r==255?X6(e.slice(2)):t==65279?e.slice(1):e},Rf=function(t){return String.fromCharCode(t)},Ry=function(t){return String.fromCharCode(t)},ms,_s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function by(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,i=e.charCodeAt(f++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),t+=_s.charAt(a)+_s.charAt(s)+_s.charAt(o)+_s.charAt(u);return t}function ni(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=_s.indexOf(e.charAt(f++)),s=_s.indexOf(e.charAt(f++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=_s.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=_s.indexOf(e.charAt(f++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),bo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ds(e){return kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Iy(e){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hi=function(t){return kt?bo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Io(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function G2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return G2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xs=kt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:bo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function wC(e){for(var t=[],r=0,n=e.length+250,i=Ds(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ds(65535),n=65530)}return t.push(i.slice(0,r)),xs(t)}var Rn=/\u0000/g,r0=/[\u0001-\u0006]/g;function Ll(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $i(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}function H2(e,t){var r=""+e;return r.length>=t?r:ur(" ",t-r.length)+r}function Id(e,t){var r=""+e;return r.length>=t?r:r+ur(" ",t-r.length)}function kC(e,t){var r=""+Math.round(e);return r.length>=t?r:ur("0",t-r.length)+r}function EC(e,t){var r=""+e;return r.length>=t?r:ur("0",t-r.length)+r}var Dy=Math.pow(2,32);function ul(e,t){if(e>Dy||e<-Dy)return kC(e,t);var r=Math.round(e);return EC(r,t)}function Dd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Oy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ly={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},TC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Od(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),o=p*s+a,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),a=s,s=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=a):(d=f,o=s)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function po(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=bC(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var K6=new Date(1899,11,31,0,0,0),AC=K6.getTime(),PC=new Date(1900,2,1,0,0,0);function Y6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=PC&&(r+=24*60*60*1e3),(r-(AC+(e.getTimezoneOffset()-K6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function W2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NC(e){var t=e<0?12:11,r=W2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function RC(e){var t=W2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NC(e):t===10?r=e.toFixed(10).substr(0,12):r=RC(e),W2(FC(r.toUpperCase()))}function To(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Pi(14,Y6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function bC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function IC(e,t,r,n){var i="",a=0,s=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return eg[r.m-1][1];case 5:return eg[r.m-1][0];default:return eg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Oy[r.q][0];default:return Oy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$i(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=$i(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?$i(u,f):"";return d}function Ss(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Q6=/%/g;function DC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*i))+ur("%",i)}function OC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function q6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J6=/# (\?+)( ?)\/( ?)(\d+)/;function LC(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?ur(" ",e[1].length+1+e[4].length):H2(s,e[1].length)+e[2]+"/"+e[3]+$i(o,e[4].length))}function MC(e,t,r){return r+(t===0?"":""+t)+ur(" ",e[1].length+2+e[4].length)}var Z6=/^#*0*\.([0#]+)/,eS=/\).*[0#]/,tS=/\(###\) ###\\?-####/;function An(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function My(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function By(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function BC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function yi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yi("n",n,r):"("+yi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return OC(e,t,r);if(t.indexOf("%")!==-1)return DC(e,t,r);if(t.indexOf("E")!==-1)return q6(t,r);if(t.charCodeAt(0)===36)return"$"+yi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ul(u,t.length);if(t.match(/^[#?]+$/))return i=ul(r,0),i==="0"&&(i=""),i.length>t.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return LC(a,u,f);if(t.match(/^#+0+$/))return f+ul(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=My(r,a[1].length).replace(/^([^\.]+)$/,"$1."+An(a[1])).replace(/\.$/,"."+An(a[1])).replace(/\.(\d*)$/,function(m,y){return"."+y+ur("0",An(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+My(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Ss(ul(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yi(e,t,-r):Ss(""+(Math.floor(r)+BC(r,a[1].length)))+"."+$i(By(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return yi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(yi(e,t.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(tS))return i=yi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Od(u,Math.pow(10,s)-1,!1),i=""+f,d=Ba("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Id(o[2],s),d.length<a[4].length&&(d=An(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Od(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H2(o[1],s)+a[2]+"/"+a[3]+Id(o[2],s):ur(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ul(r,0),t.length<=i.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return An(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=By(r,a[1].length),r<0?"-"+yi(e,t,-r):Ss(jC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?$i(0,3-m.length):"")+m})+"."+$i(s,a[1].length);switch(t){case"###,##0.00":return yi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Ss(ul(u,0));return v!=="0"?f+v:"";case"###,###.00":return yi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return yi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function UC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ba(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function zC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ba(e,n,r*Math.pow(10,2*i))+ur("%",i)}function rS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rS(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ua(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ua("n",n,r):"("+ua("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UC(e,t,r);if(t.indexOf("%")!==-1)return zC(e,t,r);if(t.indexOf("E")!==-1)return rS(t,r);if(t.charCodeAt(0)===36)return"$"+ua(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+$i(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return MC(a,u,f);if(t.match(/^#+0+$/))return f+$i(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=(""+r).replace(/^([^\.]+)$/,"$1."+An(a[1])).replace(/\.$/,"."+An(a[1])),i=i.replace(/\.(\d*)$/,function(m,y){return"."+y+ur("0",An(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+Ss(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):Ss(""+r)+"."+ur("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ua(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ll(ua(e,t.replace(/[\\-]/g,""),r)),s=0,Ll(Ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(tS))return i=ua(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Od(u,Math.pow(10,s)-1,!1),i=""+f,d=Ba("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Id(o[2],s),d.length<a[4].length&&(d=An(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Od(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H2(o[1],s)+a[2]+"/"+a[3]+Id(o[2],s):ur(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:An(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return An(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ua(e,t,-r):Ss(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?$i(0,3-m.length):"")+m})+"."+$i(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Ss(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return ua(e,t.slice(0,t.lastIndexOf(".")),r)+An(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ba(e,t,r){return(r|0)===r?ua(e,t,r):yi(e,t,r)}function VC(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var nS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ic(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Dd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(nS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function GC(e,t,r,n){for(var i=[],a="",s=0,o="",u="t",f,d,p,g="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Dd(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(p=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++s;break;case"\\":var v=e.charAt(++s),m=v==="("||v===")"?v:"t";i[i.length]={t:m,v},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=po(t,r,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=po(t,r),f==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:a},u=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=po(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,g="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",s+=5,g="h"):(y.t="t",++s),f==null&&y.t==="T")return"";i[i.length]=y,u=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(nS)){if(f==null&&(f=po(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ic(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var C=0,S=0,w;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=g,u="h",C<1&&(C=1);break;case"s":(w=i[s].v.match(/\.0+$/))&&(S=Math.max(S,w[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&i[s].v.match(/[Hh]/)&&(C=1),C<2&&i[s].v.match(/[Mm]/)&&(C=2),C<3&&i[s].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",T;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=IC(i[s].t.charCodeAt(0),i[s].v,f,S),i[s].t="t";break;case"n":case"?":for(T=s+1;i[T]!=null&&((o=i[T].t)==="?"||o==="D"||(o===" "||o==="t")&&i[T+1]!=null&&(i[T+1].t==="?"||i[T+1].t==="t"&&i[T+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[T].v==="/"||i[T].v===" "&&i[T+1]!=null&&i[T+1].t=="?"));)i[s].v+=i[T].v,i[T]={v:"",t:";"},++T;x+=i[s].v,s=T-1;break;case"G":i[s].t="t",i[s].v=To(t,r);break}var A="",F,N;if(x.length>0){x.charCodeAt(0)==40?(F=t<0&&x.charCodeAt(0)===45?-t:t,N=Ba("n",x,F)):(F=t<0&&n>1?-t:t,N=Ba("n",x,F),F<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),T=N.length-1;var P=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){P=s;break}var I=i.length;if(P===i.length&&N.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(T>=i[s].v.length-1?(T-=i[s].v.length,i[s].v=N.substr(T+1,i[s].v.length)):T<0?i[s].v="":(i[s].v=N.substr(0,T+1),T=-1),i[s].t="t",I=s);T>=0&&I<i.length&&(i[I].v=N.substr(0,T+1)+i[I].v)}else if(P!==i.length&&N.indexOf("E")===-1){for(T=N.indexOf(".")-1,s=P;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")-1:i[s].v.length-1,A=i[s].v.substr(d+1);d>=0;--d)T>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(A=N.charAt(T--)+A);i[s].v=A,i[s].t="t",I=s}for(T>=0&&I<i.length&&(i[I].v=N.substr(0,T+1)+i[I].v),T=N.indexOf(".")+1,s=P;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==P)){for(d=i[s].v.indexOf(".")>-1&&s===P?i[s].v.indexOf(".")+1:0,A=i[s].v.substr(0,d);d<i[s].v.length;++d)T<N.length&&(A+=N.charAt(T++));i[s].v=A,i[s].t="t",I=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(F=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Ba(i[s].t,i[s].v,F),i[s].t="t");var b="";for(s=0;s!==i.length;++s)i[s]!=null&&(b+=i[s].v);return b}var jy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function HC(e,t){var r=VC(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(jy),o=r[1].match(jy);return Uy(t,s)?[n,r[0]]:Uy(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Pi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[e],n==null&&(n=r.table&&r.table[Ly[e]]||ht[Ly[e]]),n==null&&(n=TC[e]||"General");break}if(Dd(n,0))return To(t,r);t instanceof Date&&(t=Y6(t,r.date1904));var i=HC(n,t);if(Dd(i[1]))return To(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return GC(i[1],t,r,i[0])}function vo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ht[r]==null){t<0&&(t=r);continue}if(ht[r]==e){t=r;break}}t<0&&(t=391)}return ht[t]=e,t}function iS(){ht=CC()}var WC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $C(e){var t=typeof e=="number"?ht[e]:e;return t=t.replace(aS,"(\\d+)"),new RegExp("^"+t+"$")}function XC(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,u=-1;(t.match(aS)||[]).forEach(function(p,g){var v=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":s=v;break;case"s":u=v;break;case"m":s>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var KC=function(){var e={};e.version="1.2.0";function t(){for(var N=0,P=new Array(256),I=0;I!=256;++I)N=I,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,P[I]=N;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(N){var P=0,I=0,b=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)O[b]=N[b];for(b=0;b!=256;++b)for(I=N[b],P=256+b;P<4096;P+=256)I=O[P]=I>>>8^N[I&255];var L=[];for(b=1;b!=16;++b)L[b-1]=typeof Int32Array<"u"?O.subarray(b*256,b*256+256):O.slice(b*256,b*256+256);return L}var i=n(r),a=i[0],s=i[1],o=i[2],u=i[3],f=i[4],d=i[5],p=i[6],g=i[7],v=i[8],m=i[9],y=i[10],C=i[11],S=i[12],w=i[13],x=i[14];function T(N,P){for(var I=P^-1,b=0,O=N.length;b<O;)I=I>>>8^r[(I^N.charCodeAt(b++))&255];return~I}function A(N,P){for(var I=P^-1,b=N.length-15,O=0;O<b;)I=x[N[O++]^I&255]^w[N[O++]^I>>8&255]^S[N[O++]^I>>16&255]^C[N[O++]^I>>>24]^y[N[O++]]^m[N[O++]]^v[N[O++]]^g[N[O++]]^p[N[O++]]^d[N[O++]]^f[N[O++]]^u[N[O++]]^o[N[O++]]^s[N[O++]]^a[N[O++]]^r[N[O++]];for(b+=15;O<b;)I=I>>>8^r[(I^N[O++])&255];return~I}function F(N,P){for(var I=P^-1,b=0,O=N.length,L=0,K=0;b<O;)L=N.charCodeAt(b++),L<128?I=I>>>8^r[(I^L)&255]:L<2048?(I=I>>>8^r[(I^(192|L>>6&31))&255],I=I>>>8^r[(I^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,K=N.charCodeAt(b++)&1023,I=I>>>8^r[(I^(240|L>>8&7))&255],I=I>>>8^r[(I^(128|L>>2&63))&255],I=I>>>8^r[(I^(128|K>>6&15|(L&3)<<4))&255],I=I>>>8^r[(I^(128|K&63))&255]):(I=I>>>8^r[(I^(224|L>>12&15))&255],I=I>>>8^r[(I^(128|L>>6&63))&255],I=I>>>8^r[(I^(128|L&63))&255]);return~I}return e.table=r,e.bstr=T,e.buf=A,e.str=F,e}(),Tt=function(){var t={};t.version="1.2.1";function r(D,V){for(var B=D.split("/"),U=V.split("/"),H=0,W=0,ae=Math.min(B.length,U.length);H<ae;++H){if(W=B[H].length-U[H].length)return W;if(B[H]!=U[H])return B[H]<U[H]?-1:1}return B.length-U.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(0,V+1)}function i(D){if(D.charAt(D.length-1)=="/")return i(D.slice(0,-1));var V=D.lastIndexOf("/");return V===-1?D:D.slice(V+1)}function a(D,V){typeof V=="string"&&(V=new Date(V));var B=V.getHours();B=B<<6|V.getMinutes(),B=B<<5|V.getSeconds()>>>1,D.write_shift(2,B);var U=V.getFullYear()-1980;U=U<<4|V.getMonth()+1,U=U<<5|V.getDate(),D.write_shift(2,U)}function s(D){var V=D.read_shift(2)&65535,B=D.read_shift(2)&65535,U=new Date,H=B&31;B>>>=5;var W=B&15;B>>>=4,U.setMilliseconds(0),U.setFullYear(B+1980),U.setMonth(W-1),U.setDate(H);var ae=V&31;V>>>=5;var ye=V&63;return V>>>=6,U.setHours(V),U.setMinutes(ye),U.setSeconds(ae<<1),U}function o(D){Qr(D,0);for(var V={},B=0;D.l<=D.length-4;){var U=D.read_shift(2),H=D.read_shift(2),W=D.l+H,ae={};switch(U){case 21589:B=D.read_shift(1),B&1&&(ae.mtime=D.read_shift(4)),H>5&&(B&2&&(ae.atime=D.read_shift(4)),B&4&&(ae.ctime=D.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}D.l=W,V[U]=ae}return V}var u;function f(){return u||(u={})}function d(D,V){if(D[0]==80&&D[1]==75)return Ge(D,V);if((D[0]|32)==109&&(D[1]|32)==105)return lr(D,V);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var B=3,U=512,H=0,W=0,ae=0,ye=0,ne=0,se=[],le=D.slice(0,512);Qr(le,0);var Ne=p(le);switch(B=Ne[0],B){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ne[1]==0)return Ge(D,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}U!==512&&(le=D.slice(0,U),Qr(le,28));var Be=D.slice(0,U);g(le,B);var He=le.read_shift(4,"i");if(B===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ye=le.read_shift(4,"i"),H=le.read_shift(4,"i"),ne=le.read_shift(4,"i"),W=le.read_shift(4,"i");for(var Oe=-1,je=0;je<109&&(Oe=le.read_shift(4,"i"),!(Oe<0));++je)se[je]=Oe;var st=v(D,U);C(ne,W,st,U,se);var Mt=w(st,ae,se,U);Mt[ae].name="!Directory",H>0&&ye!==K&&(Mt[ye].name="!MiniFAT"),Mt[se[0]].name="!FAT",Mt.fat_addrs=se,Mt.ssz=U;var Vt={},vr=[],Ks=[],_a=[];x(ae,Mt,st,vr,H,Vt,Ks,ye),m(Ks,_a,vr),vr.shift();var oi={FileIndex:Ks,FullPaths:_a};return V&&V.raw&&(oi.raw={header:Be,sectors:st}),oi}function p(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ie,"Header Signature: "),D.l+=16;var V=D.read_shift(2,"u");return[D.read_shift(2,"u"),V]}function g(D,V){var B=9;switch(D.l+=2,B=D.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function v(D,V){for(var B=Math.ceil(D.length/V)-1,U=[],H=1;H<B;++H)U[H-1]=D.slice(H*V,(H+1)*V);return U[B-1]=D.slice(B*V),U}function m(D,V,B){for(var U=0,H=0,W=0,ae=0,ye=0,ne=B.length,se=[],le=[];U<ne;++U)se[U]=le[U]=U,V[U]=B[U];for(;ye<le.length;++ye)U=le[ye],H=D[U].L,W=D[U].R,ae=D[U].C,se[U]===U&&(H!==-1&&se[H]!==H&&(se[U]=se[H]),W!==-1&&se[W]!==W&&(se[U]=se[W])),ae!==-1&&(se[ae]=U),H!==-1&&U!=se[U]&&(se[H]=se[U],le.lastIndexOf(H)<ye&&le.push(H)),W!==-1&&U!=se[U]&&(se[W]=se[U],le.lastIndexOf(W)<ye&&le.push(W));for(U=1;U<ne;++U)se[U]===U&&(W!==-1&&se[W]!==W?se[U]=se[W]:H!==-1&&se[H]!==H&&(se[U]=se[H]));for(U=1;U<ne;++U)if(D[U].type!==0){if(ye=U,ye!=se[ye])do ye=se[ye],V[U]=V[ye]+"/"+V[U];while(ye!==0&&se[ye]!==-1&&ye!=se[ye]);se[U]=-1}for(V[0]+="/",U=1;U<ne;++U)D[U].type!==2&&(V[U]+="/")}function y(D,V,B){for(var U=D.start,H=D.size,W=[],ae=U;B&&H>0&&ae>=0;)W.push(V.slice(ae*L,ae*L+L)),H-=L,ae=co(B,ae*4);return W.length===0?Fr(0):xs(W).slice(0,D.size)}function C(D,V,B,U,H){var W=K;if(D===K){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ae=B[D],ye=(U>>>2)-1;if(!ae)return;for(var ne=0;ne<ye&&(W=co(ae,ne*4))!==K;++ne)H.push(W);C(co(ae,U-4),V-1,B,U,H)}}function S(D,V,B,U,H){var W=[],ae=[];H||(H=[]);var ye=U-1,ne=0,se=0;for(ne=V;ne>=0;){H[ne]=!0,W[W.length]=ne,ae.push(D[ne]);var le=B[Math.floor(ne*4/U)];if(se=ne*4&ye,U<4+se)throw new Error("FAT boundary crossed: "+ne+" 4 "+U);if(!D[le])break;ne=co(D[le],se)}return{nodes:W,data:Qy([ae])}}function w(D,V,B,U){var H=D.length,W=[],ae=[],ye=[],ne=[],se=U-1,le=0,Ne=0,Be=0,He=0;for(le=0;le<H;++le)if(ye=[],Be=le+V,Be>=H&&(Be-=H),!ae[Be]){ne=[];var Oe=[];for(Ne=Be;Ne>=0;){Oe[Ne]=!0,ae[Ne]=!0,ye[ye.length]=Ne,ne.push(D[Ne]);var je=B[Math.floor(Ne*4/U)];if(He=Ne*4&se,U<4+He)throw new Error("FAT boundary crossed: "+Ne+" 4 "+U);if(!D[je]||(Ne=co(D[je],He),Oe[Ne]))break}W[Be]={nodes:ye,data:Qy([ne])}}return W}function x(D,V,B,U,H,W,ae,ye){for(var ne=0,se=U.length?2:0,le=V[D].data,Ne=0,Be=0,He;Ne<le.length;Ne+=128){var Oe=le.slice(Ne,Ne+128);Qr(Oe,64),Be=Oe.read_shift(2),He=Q2(Oe,0,Be-se),U.push(He);var je={name:He,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},st=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);st!==0&&(je.ct=T(Oe,Oe.l-8));var Mt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Mt!==0&&(je.mt=T(Oe,Oe.l-8)),je.start=Oe.read_shift(4,"i"),je.size=Oe.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=K,je.name=""),je.type===5?(ne=je.start,H>0&&ne!==K&&(V[ne].name="!StreamData")):je.size>=4096?(je.storage="fat",V[je.start]===void 0&&(V[je.start]=S(B,je.start,V.fat_addrs,V.ssz)),V[je.start].name=je.name,je.content=V[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ne!==K&&je.start!==K&&V[ne]&&(je.content=y(je,V[ne].data,(V[ye]||{}).data))),je.content&&Qr(je.content,0),W[He]=je,ae.push(je)}}function T(D,V){return new Date((qn(D,V+4)/1e7*Math.pow(2,32)+qn(D,V)/1e7-11644473600)*1e3)}function A(D,V){return f(),d(u.readFileSync(D),V)}function F(D,V){var B=V&&V.type;switch(B||kt&&Buffer.isBuffer(D)&&(B="buffer"),B||"base64"){case"file":return A(D,V);case"base64":return d(Hi(ni(D)),V);case"binary":return d(Hi(D),V)}return d(D,V)}function N(D,V){var B=V||{},U=B.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=U+"/",D.FileIndex[0]={name:U,type:5}),B.CLSID&&(D.FileIndex[0].clsid=B.CLSID),P(D)}function P(D){var V="Sh33tJ5";if(!Tt.find(D,"/"+V)){var B=Fr(4);B[0]=55,B[1]=B[3]=50,B[2]=54,D.FileIndex.push({name:V,type:2,content:B,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+V),I(D)}}function I(D,V){N(D);for(var B=!1,U=!1,H=D.FullPaths.length-1;H>=0;--H){var W=D.FileIndex[H];switch(W.type){case 0:U?B=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(W.R*W.L*W.C)&&(B=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!V)){var ae=new Date(1987,1,19),ye=0,ne=Object.create?Object.create(null):{},se=[];for(H=0;H<D.FullPaths.length;++H)ne[D.FullPaths[H]]=!0,D.FileIndex[H].type!==0&&se.push([D.FullPaths[H],D.FileIndex[H]]);for(H=0;H<se.length;++H){var le=n(se[H][0]);U=ne[le],U||(se.push([le,{name:i(le).replace("/",""),type:1,clsid:ke,ct:ae,mt:ae,content:null}]),ne[le]=!0)}for(se.sort(function(He,Oe){return r(He[0],Oe[0])}),D.FullPaths=[],D.FileIndex=[],H=0;H<se.length;++H)D.FullPaths[H]=se[H][0],D.FileIndex[H]=se[H][1];for(H=0;H<se.length;++H){var Ne=D.FileIndex[H],Be=D.FullPaths[H];if(Ne.name=i(Be).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||ke,H===0)Ne.C=se.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Be.slice(-1)=="/"){for(ye=H+1;ye<se.length&&n(D.FullPaths[ye])!=Be;++ye);for(Ne.C=ye>=se.length?-1:ye,ye=H+1;ye<se.length&&n(D.FullPaths[ye])!=n(Be);++ye);Ne.R=ye>=se.length?-1:ye,Ne.type=1}else n(D.FullPaths[H+1]||"")==n(Be)&&(Ne.R=H+1),Ne.type=2}}}function b(D,V){var B=V||{};if(B.fileType=="mad")return Xo(D,B);switch(I(D),B.fileType){case"zip":return ut(D,B)}var U=function(He){for(var Oe=0,je=0,st=0;st<He.FileIndex.length;++st){var Mt=He.FileIndex[st];if(Mt.content){var Vt=Mt.content.length;Vt>0&&(Vt<4096?Oe+=Vt+63>>6:je+=Vt+511>>9)}}for(var vr=He.FullPaths.length+3>>2,Ks=Oe+7>>3,_a=Oe+127>>7,oi=Ks+je+vr+_a,nn=oi+127>>7,Bt=nn<=109?0:Math.ceil((nn-109)/127);oi+nn+Bt+127>>7>nn;)Bt=++nn<=109?0:Math.ceil((nn-109)/127);var St=[1,Bt,nn,_a,vr,je,Oe,0];return He.FileIndex[0].size=Oe<<6,St[7]=(He.FileIndex[0].start=St[0]+St[1]+St[2]+St[3]+St[4]+St[5])+(St[6]+7>>3),St}(D),H=Fr(U[7]<<9),W=0,ae=0;{for(W=0;W<8;++W)H.write_shift(1,re[W]);for(W=0;W<8;++W)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),W=0;W<3;++W)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,U[2]),H.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:K),H.write_shift(4,U[3]),H.write_shift(-4,U[1]?U[0]-1:K),H.write_shift(4,U[1]),W=0;W<109;++W)H.write_shift(-4,W<U[2]?U[1]+W:-1)}if(U[1])for(ae=0;ae<U[1];++ae){for(;W<236+ae*127;++W)H.write_shift(-4,W<U[2]?U[1]+W:-1);H.write_shift(-4,ae===U[1]-1?K:ae+1)}var ye=function(He){for(ae+=He;W<ae-1;++W)H.write_shift(-4,W+1);He&&(++W,H.write_shift(-4,K))};for(ae=W=0,ae+=U[1];W<ae;++W)H.write_shift(-4,we.DIFSECT);for(ae+=U[2];W<ae;++W)H.write_shift(-4,we.FATSECT);ye(U[3]),ye(U[4]);for(var ne=0,se=0,le=D.FileIndex[0];ne<D.FileIndex.length;++ne)le=D.FileIndex[ne],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ae,ye(se+511>>9)));for(ye(U[6]+7>>3);H.l&511;)H.write_shift(-4,we.ENDOFCHAIN);for(ae=W=0,ne=0;ne<D.FileIndex.length;++ne)le=D.FileIndex[ne],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ae,ye(se+63>>6)));for(;H.l&511;)H.write_shift(-4,we.ENDOFCHAIN);for(W=0;W<U[4]<<2;++W){var Ne=D.FullPaths[W];if(!Ne||Ne.length===0){for(ne=0;ne<17;++ne)H.write_shift(4,0);for(ne=0;ne<3;++ne)H.write_shift(4,-1);for(ne=0;ne<12;++ne)H.write_shift(4,0);continue}le=D.FileIndex[W],W===0&&(le.start=le.size?le.start-1:K);var Be=W===0&&B.root||le.name;if(se=2*(Be.length+1),H.write_shift(64,Be,"utf16le"),H.write_shift(2,se),H.write_shift(1,le.type),H.write_shift(1,le.color),H.write_shift(-4,le.L),H.write_shift(-4,le.R),H.write_shift(-4,le.C),le.clsid)H.write_shift(16,le.clsid,"hex");else for(ne=0;ne<4;++ne)H.write_shift(4,0);H.write_shift(4,le.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,le.start),H.write_shift(4,le.size),H.write_shift(4,0)}for(W=1;W<D.FileIndex.length;++W)if(le=D.FileIndex[W],le.size>=4096)if(H.l=le.start+1<<9,kt&&Buffer.isBuffer(le.content))le.content.copy(H,H.l,0,le.size),H.l+=le.size+511&-512;else{for(ne=0;ne<le.size;++ne)H.write_shift(1,le.content[ne]);for(;ne&511;++ne)H.write_shift(1,0)}for(W=1;W<D.FileIndex.length;++W)if(le=D.FileIndex[W],le.size>0&&le.size<4096)if(kt&&Buffer.isBuffer(le.content))le.content.copy(H,H.l,0,le.size),H.l+=le.size+63&-64;else{for(ne=0;ne<le.size;++ne)H.write_shift(1,le.content[ne]);for(;ne&63;++ne)H.write_shift(1,0)}if(kt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function O(D,V){var B=D.FullPaths.map(function(ne){return ne.toUpperCase()}),U=B.map(function(ne){var se=ne.split("/");return se[se.length-(ne.slice(-1)=="/"?2:1)]}),H=!1;V.charCodeAt(0)===47?(H=!0,V=B[0].slice(0,-1)+V):H=V.indexOf("/")!==-1;var W=V.toUpperCase(),ae=H===!0?B.indexOf(W):U.indexOf(W);if(ae!==-1)return D.FileIndex[ae];var ye=!W.match(r0);for(W=W.replace(Rn,""),ye&&(W=W.replace(r0,"!")),ae=0;ae<B.length;++ae)if((ye?B[ae].replace(r0,"!"):B[ae]).replace(Rn,"")==W||(ye?U[ae].replace(r0,"!"):U[ae]).replace(Rn,"")==W)return D.FileIndex[ae];return null}var L=64,K=-2,ie="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(D,V,B){f();var U=b(D,B);u.writeFileSync(V,U)}function X(D){for(var V=new Array(D.length),B=0;B<D.length;++B)V[B]=String.fromCharCode(D[B]);return V.join("")}function he(D,V){var B=b(D,V);switch(V&&V.type||"buffer"){case"file":return f(),u.writeFileSync(V.filename,B),B;case"binary":return typeof B=="string"?B:X(B);case"base64":return by(typeof B=="string"?B:X(B));case"buffer":if(kt)return Buffer.isBuffer(B)?B:bo(B);case"array":return typeof B=="string"?Hi(B):B}return B}var _e;function M(D){try{var V=D.InflateRaw,B=new V;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)_e=D;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function J(D,V){if(!_e)return be(D,V);var B=_e.InflateRaw,U=new B,H=U._processChunk(D.slice(D.l),U._finishFlushFlag);return D.l+=U.bytesRead,H}function Q(D){return _e?_e.deflateRawSync(D):Fe(D)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function te(D){var V=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(V>>16|V>>8|V)&255}for(var de=typeof Uint8Array<"u",xe=de?new Uint8Array(256):[],Me=0;Me<256;++Me)xe[Me]=te(Me);function G(D,V){var B=xe[D&255];return V<=8?B>>>8-V:(B=B<<8|xe[D>>8&255],V<=16?B>>>16-V:(B=B<<8|xe[D>>16&255],B>>>24-V))}function tt(D,V){var B=V&7,U=V>>>3;return(D[U]|(B<=6?0:D[U+1]<<8))>>>B&3}function nt(D,V){var B=V&7,U=V>>>3;return(D[U]|(B<=5?0:D[U+1]<<8))>>>B&7}function Xe(D,V){var B=V&7,U=V>>>3;return(D[U]|(B<=4?0:D[U+1]<<8))>>>B&15}function Ze(D,V){var B=V&7,U=V>>>3;return(D[U]|(B<=3?0:D[U+1]<<8))>>>B&31}function Ie(D,V){var B=V&7,U=V>>>3;return(D[U]|(B<=1?0:D[U+1]<<8))>>>B&127}function Ct(D,V,B){var U=V&7,H=V>>>3,W=(1<<B)-1,ae=D[H]>>>U;return B<8-U||(ae|=D[H+1]<<8-U,B<16-U)||(ae|=D[H+2]<<16-U,B<24-U)||(ae|=D[H+3]<<24-U),ae&W}function Lr(D,V,B){var U=V&7,H=V>>>3;return U<=5?D[H]|=(B&7)<<U:(D[H]|=B<<U&255,D[H+1]=(B&7)>>8-U),V+3}function me(D,V,B){var U=V&7,H=V>>>3;return B=(B&1)<<U,D[H]|=B,V+1}function pe(D,V,B){var U=V&7,H=V>>>3;return B<<=U,D[H]|=B&255,B>>>=8,D[H+1]=B,V+8}function Te(D,V,B){var U=V&7,H=V>>>3;return B<<=U,D[H]|=B&255,B>>>=8,D[H+1]=B&255,D[H+2]=B>>>8,V+16}function Ae(D,V){var B=D.length,U=2*B>V?2*B:V+5,H=0;if(B>=V)return D;if(kt){var W=Iy(U);if(D.copy)D.copy(W);else for(;H<D.length;++H)W[H]=D[H];return W}else if(de){var ae=new Uint8Array(U);if(ae.set)ae.set(D);else for(;H<B;++H)ae[H]=D[H];return ae}return D.length=U,D}function Pe(D){for(var V=new Array(D),B=0;B<D;++B)V[B]=0;return V}function De(D,V,B){var U=1,H=0,W=0,ae=0,ye=0,ne=D.length,se=de?new Uint16Array(32):Pe(32);for(W=0;W<32;++W)se[W]=0;for(W=ne;W<B;++W)D[W]=0;ne=D.length;var le=de?new Uint16Array(ne):Pe(ne);for(W=0;W<ne;++W)se[H=D[W]]++,U<H&&(U=H),le[W]=0;for(se[0]=0,W=1;W<=U;++W)se[W+16]=ye=ye+se[W-1]<<1;for(W=0;W<ne;++W)ye=D[W],ye!=0&&(le[W]=se[ye+16]++);var Ne=0;for(W=0;W<ne;++W)if(Ne=D[W],Ne!=0)for(ye=G(le[W],U)>>U-Ne,ae=(1<<U+4-Ne)-1;ae>=0;--ae)V[ye|ae<<Ne]=Ne&15|W<<4;return U}var Ve=de?new Uint16Array(512):Pe(512),ve=de?new Uint16Array(32):Pe(32);if(!de){for(var q=0;q<512;++q)Ve[q]=0;for(q=0;q<32;++q)ve[q]=0}(function(){for(var D=[],V=0;V<32;V++)D.push(5);De(D,ve,32);var B=[];for(V=0;V<=143;V++)B.push(8);for(;V<=255;V++)B.push(9);for(;V<=279;V++)B.push(7);for(;V<=287;V++)B.push(8);De(B,Ve,288)})();var Ee=function(){for(var V=de?new Uint8Array(32768):[],B=0,U=0;B<z.length-1;++B)for(;U<z[B+1];++U)V[U]=B;for(;U<32768;++U)V[U]=29;var H=de?new Uint8Array(259):[];for(B=0,U=0;B<ue.length-1;++B)for(;U<ue[B+1];++U)H[U]=B;function W(ye,ne){for(var se=0;se<ye.length;){var le=Math.min(65535,ye.length-se),Ne=se+le==ye.length;for(ne.write_shift(1,+Ne),ne.write_shift(2,le),ne.write_shift(2,~le&65535);le-- >0;)ne[ne.l++]=ye[se++]}return ne.l}function ae(ye,ne){for(var se=0,le=0,Ne=de?new Uint16Array(32768):[];le<ye.length;){var Be=Math.min(65535,ye.length-le);if(Be<10){for(se=Lr(ne,se,+(le+Be==ye.length)),se&7&&(se+=8-(se&7)),ne.l=se/8|0,ne.write_shift(2,Be),ne.write_shift(2,~Be&65535);Be-- >0;)ne[ne.l++]=ye[le++];se=ne.l*8;continue}se=Lr(ne,se,+(le+Be==ye.length)+2);for(var He=0;Be-- >0;){var Oe=ye[le];He=(He<<5^Oe)&32767;var je=-1,st=0;if((je=Ne[He])&&(je|=le&-32768,je>le&&(je-=32768),je<le))for(;ye[je+st]==ye[le+st]&&st<250;)++st;if(st>2){Oe=H[st],Oe<=22?se=pe(ne,se,xe[Oe+1]>>1)-1:(pe(ne,se,3),se+=5,pe(ne,se,xe[Oe-23]>>5),se+=3);var Mt=Oe<8?0:Oe-4>>2;Mt>0&&(Te(ne,se,st-ue[Oe]),se+=Mt),Oe=V[le-je],se=pe(ne,se,xe[Oe]>>3),se-=3;var Vt=Oe<4?0:Oe-2>>1;Vt>0&&(Te(ne,se,le-je-z[Oe]),se+=Vt);for(var vr=0;vr<st;++vr)Ne[He]=le&32767,He=(He<<5^ye[le])&32767,++le;Be-=st-1}else Oe<=143?Oe=Oe+48:se=me(ne,se,1),se=pe(ne,se,xe[Oe]),Ne[He]=le&32767,++le}se=pe(ne,se,0)-1}return ne.l=(se+7)/8|0,ne.l}return function(ne,se){return ne.length<8?W(ne,se):ae(ne,se)}}();function Fe(D){var V=Fr(50+Math.floor(D.length*1.1)),B=Ee(D,V);return V.slice(0,B)}var Ce=de?new Uint16Array(32768):Pe(32768),Qe=de?new Uint16Array(32768):Pe(32768),et=de?new Uint16Array(128):Pe(128),lt=1,Ye=1;function xt(D,V){var B=Ze(D,V)+257;V+=5;var U=Ze(D,V)+1;V+=5;var H=Xe(D,V)+4;V+=4;for(var W=0,ae=de?new Uint8Array(19):Pe(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,se=de?new Uint8Array(8):Pe(8),le=de?new Uint8Array(8):Pe(8),Ne=ae.length,Be=0;Be<H;++Be)ae[Y[Be]]=W=nt(D,V),ne<W&&(ne=W),se[W]++,V+=3;var He=0;for(se[0]=0,Be=1;Be<=ne;++Be)le[Be]=He=He+se[Be-1]<<1;for(Be=0;Be<Ne;++Be)(He=ae[Be])!=0&&(ye[Be]=le[He]++);var Oe=0;for(Be=0;Be<Ne;++Be)if(Oe=ae[Be],Oe!=0){He=xe[ye[Be]]>>8-Oe;for(var je=(1<<7-Oe)-1;je>=0;--je)et[He|je<<Oe]=Oe&7|Be<<3}var st=[];for(ne=1;st.length<B+U;)switch(He=et[Ie(D,V)],V+=He&7,He>>>=3){case 16:for(W=3+tt(D,V),V+=2,He=st[st.length-1];W-- >0;)st.push(He);break;case 17:for(W=3+nt(D,V),V+=3;W-- >0;)st.push(0);break;case 18:for(W=11+Ie(D,V),V+=7;W-- >0;)st.push(0);break;default:st.push(He),ne<He&&(ne=He);break}var Mt=st.slice(0,B),Vt=st.slice(B);for(Be=B;Be<286;++Be)Mt[Be]=0;for(Be=U;Be<30;++Be)Vt[Be]=0;return lt=De(Mt,Ce,286),Ye=De(Vt,Qe,30),V}function si(D,V){if(D[0]==3&&!(D[1]&3))return[Ds(V),2];for(var B=0,U=0,H=Iy(V||1<<18),W=0,ae=H.length>>>0,ye=0,ne=0;!(U&1);){if(U=nt(D,B),B+=3,U>>>1)U>>1==1?(ye=9,ne=5):(B=xt(D,B),ye=lt,ne=Ye);else{B&7&&(B+=8-(B&7));var se=D[B>>>3]|D[(B>>>3)+1]<<8;if(B+=32,se>0)for(!V&&ae<W+se&&(H=Ae(H,W+se),ae=H.length);se-- >0;)H[W++]=D[B>>>3],B+=8;continue}for(;;){!V&&ae<W+32767&&(H=Ae(H,W+32767),ae=H.length);var le=Ct(D,B,ye),Ne=U>>>1==1?Ve[le]:Ce[le];if(B+=Ne&15,Ne>>>=4,!(Ne>>>8&255))H[W++]=Ne;else{if(Ne==256)break;Ne-=257;var Be=Ne<8?0:Ne-4>>2;Be>5&&(Be=0);var He=W+ue[Ne];Be>0&&(He+=Ct(D,B,Be),B+=Be),le=Ct(D,B,ne),Ne=U>>>1==1?ve[le]:Qe[le],B+=Ne&15,Ne>>>=4;var Oe=Ne<4?0:Ne-2>>1,je=z[Ne];for(Oe>0&&(je+=Ct(D,B,Oe),B+=Oe),!V&&ae<He&&(H=Ae(H,He+100),ae=H.length);W<He;)H[W]=H[W-je],++W}}}return V?[H,B+7>>>3]:[H.slice(0,W),B+7>>>3]}function be(D,V){var B=D.slice(D.l||0),U=si(B,V);return D.l+=U[1],U[0]}function qe(D,V){if(D)typeof console<"u"&&console.error(V);else throw new Error(V)}function Ge(D,V){var B=D;Qr(B,0);var U=[],H=[],W={FileIndex:U,FullPaths:H};N(W,{root:V.root});for(var ae=B.length-4;(B[ae]!=80||B[ae+1]!=75||B[ae+2]!=5||B[ae+3]!=6)&&ae>=0;)--ae;B.l=ae+4,B.l+=4;var ye=B.read_shift(2);B.l+=6;var ne=B.read_shift(4);for(B.l=ne,ae=0;ae<ye;++ae){B.l+=20;var se=B.read_shift(4),le=B.read_shift(4),Ne=B.read_shift(2),Be=B.read_shift(2),He=B.read_shift(2);B.l+=8;var Oe=B.read_shift(4),je=o(B.slice(B.l+Ne,B.l+Ne+Be));B.l+=Ne+Be+He;var st=B.l;B.l=Oe+4,Je(B,se,le,W,je),B.l=st}return W}function Je(D,V,B,U,H){D.l+=2;var W=D.read_shift(2),ae=D.read_shift(2),ye=s(D);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ne=D.read_shift(4),se=D.read_shift(4),le=D.read_shift(4),Ne=D.read_shift(2),Be=D.read_shift(2),He="",Oe=0;Oe<Ne;++Oe)He+=String.fromCharCode(D[D.l++]);if(Be){var je=o(D.slice(D.l,D.l+Be));(je[21589]||{}).mt&&(ye=je[21589].mt),((H||{})[21589]||{}).mt&&(ye=H[21589].mt)}D.l+=Be;var st=D.slice(D.l,D.l+se);switch(ae){case 8:st=J(D,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Mt=!1;W&8&&(ne=D.read_shift(4),ne==134695760&&(ne=D.read_shift(4),Mt=!0),se=D.read_shift(4),le=D.read_shift(4)),se!=V&&qe(Mt,"Bad compressed size: "+V+" != "+se),le!=B&&qe(Mt,"Bad uncompressed size: "+B+" != "+le),pc(U,He,st,{unsafe:!0,mt:ye})}function ut(D,V){var B=V||{},U=[],H=[],W=Fr(1),ae=B.compression?8:0,ye=0,ne=0,se=0,le=0,Ne=0,Be=D.FullPaths[0],He=Be,Oe=D.FileIndex[0],je=[],st=0;for(ne=1;ne<D.FullPaths.length;++ne)if(He=D.FullPaths[ne].slice(Be.length),Oe=D.FileIndex[ne],!(!Oe.size||!Oe.content||He=="Sh33tJ5")){var Mt=le,Vt=Fr(He.length);for(se=0;se<He.length;++se)Vt.write_shift(1,He.charCodeAt(se)&127);Vt=Vt.slice(0,Vt.l),je[Ne]=KC.buf(Oe.content,0);var vr=Oe.content;ae==8&&(vr=Q(vr)),W=Fr(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,ae),Oe.mt?a(W,Oe.mt):W.write_shift(4,0),W.write_shift(-4,je[Ne]),W.write_shift(4,vr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,Vt.length),W.write_shift(2,0),le+=W.length,U.push(W),le+=Vt.length,U.push(Vt),le+=vr.length,U.push(vr),W=Fr(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ye),W.write_shift(2,ae),W.write_shift(4,0),W.write_shift(-4,je[Ne]),W.write_shift(4,vr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,Vt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Mt),st+=W.l,H.push(W),st+=Vt.length,H.push(Vt),++Ne}return W=Fr(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Ne),W.write_shift(2,Ne),W.write_shift(4,st),W.write_shift(4,le),W.write_shift(2,0),xs([xs(U),xs(H),W])}var Pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Dt(D,V){if(D.ctype)return D.ctype;var B=D.name||"",U=B.match(/\.([^\.]+)$/);return U&&Pt[U[1]]||V&&(U=(B=V).match(/[\.\\]([^\.\\])+$/),U&&Pt[U[1]])?Pt[U[1]]:"application/octet-stream"}function kn(D){for(var V=by(D),B=[],U=0;U<V.length;U+=76)B.push(V.slice(U,U+76));return B.join(`\r
`)+`\r
`}function tn(D){var V=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],U=V.split(`\r
`),H=0;H<U.length;++H){var W=U[H];if(W.length==0){B.push("");continue}for(var ae=0;ae<W.length;){var ye=76,ne=W.slice(ae,ae+ye);ne.charAt(ye-1)=="="?ye--:ne.charAt(ye-2)=="="?ye-=2:ne.charAt(ye-3)=="="&&(ye-=3),ne=W.slice(ae,ae+ye),ae+=ye,ae<W.length&&(ne+="="),B.push(ne)}}return B.join(`\r
`)}function mt(D){for(var V=[],B=0;B<D.length;++B){for(var U=D[B];B<=D.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+D[++B];V.push(U)}for(var H=0;H<V.length;++H)V[H]=V[H].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Hi(V.join(`\r
`))}function rn(D,V,B){for(var U="",H="",W="",ae,ye=0;ye<10;++ye){var ne=V[ye];if(!ne||ne.match(/^\s*$/))break;var se=ne.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":U=se[2].trim();break;case"content-type":W=se[2].trim();break;case"content-transfer-encoding":H=se[2].trim();break}}switch(++ye,H.toLowerCase()){case"base64":ae=Hi(ni(V.slice(ye).join("")));break;case"quoted-printable":ae=mt(V.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var le=pc(D,U.slice(B.length),ae,{unsafe:!0});W&&(le.ctype=W)}function lr(D,V){if(X(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=V&&V.root||"",U=(kt&&Buffer.isBuffer(D)?D.toString("binary"):X(D)).split(`\r
`),H=0,W="";for(H=0;H<U.length;++H)if(W=U[H],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),B||(B=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),W.slice(0,B.length)!=B););var ae=(U[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ye="--"+(ae[1]||""),ne=[],se=[],le={FileIndex:ne,FullPaths:se};N(le);var Ne,Be=0;for(H=0;H<U.length;++H){var He=U[H];He!==ye&&He!==ye+"--"||(Be++&&rn(le,U.slice(Ne,H),B),Ne=H)}return le}function Xo(D,V){var B=V||{},U=B.boundary||"SheetJS";U="------="+U;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],W=D.FullPaths[0],ae=W,ye=D.FileIndex[0],ne=1;ne<D.FullPaths.length;++ne)if(ae=D.FullPaths[ne].slice(W.length),ye=D.FileIndex[ne],!(!ye.size||!ye.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var se=ye.content,le=kt&&Buffer.isBuffer(se)?se.toString("binary"):X(se),Ne=0,Be=Math.min(1024,le.length),He=0,Oe=0;Oe<=Be;++Oe)(He=le.charCodeAt(Oe))>=32&&He<128&&++Ne;var je=Ne>=Be*4/5;H.push(U),H.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+ae),H.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),H.push("Content-Type: "+Dt(ye,ae)),H.push(""),H.push(je?tn(le):kn(le))}return H.push(U+`--\r
`),H.join(`\r
`)}function Ko(D){var V={};return N(V,D),V}function pc(D,V,B,U){var H=U&&U.unsafe;H||N(D);var W=!H&&Tt.find(D,V);if(!W){var ae=D.FullPaths[0];V.slice(0,ae.length)==ae?ae=V:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+V).replace("//","/")),W={name:i(V),type:2},D.FileIndex.push(W),D.FullPaths.push(ae),H||Tt.utils.cfb_gc(D)}return W.content=B,W.size=B?B.length:0,U&&(U.CLSID&&(W.clsid=U.CLSID),U.mt&&(W.mt=U.mt),U.ct&&(W.ct=U.ct)),W}function _u(D,V){N(D);var B=Tt.find(D,V);if(B){for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==B)return D.FileIndex.splice(U,1),D.FullPaths.splice(U,1),!0}return!1}function gc(D,V,B){N(D);var U=Tt.find(D,V);if(U){for(var H=0;H<D.FileIndex.length;++H)if(D.FileIndex[H]==U)return D.FileIndex[H].name=i(B),D.FullPaths[H]=B,!0}return!1}function g1(D){I(D,!0)}return t.find=O,t.read=F,t.parse=d,t.write=he,t.writeFile=oe,t.utils={cfb_new:Ko,cfb_add:pc,cfb_del:_u,cfb_mov:gc,cfb_gc:g1,ReadShift:m0,CheckField:PS,prep_blob:Qr,bconcat:xs,use_zlib:M,_deflateRaw:Fe,_inflateRaw:be,consts:we},t}();function YC(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ma(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $2(e){for(var t=[],r=ma(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Ld=new Date(1899,11,30,0,0,0);function bn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Ld.getTime()+(e.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var sS=new Date,QC=Ld.getTime()+(sS.getTimezoneOffset()-Ld.getTimezoneOffset())*6e4,zy=sS.getTimezoneOffset();function yh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+QC),t.getTimezoneOffset()!==zy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-zy)*6e4),t}function qC(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Vy=new Date("2017-02-19T19:06:09.000Z"),oS=isNaN(Vy.getFullYear())?new Date("2/19/17"):Vy,JC=oS.getFullYear()==2017;function $r(e,t){var r=new Date(e);if(JC)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(oS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ao(e,t){if(kt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return i0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return i0(X6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return i0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return i0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Jr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Jr(e[r]));return t}function ur(e,t){for(var r="";r.length<t;)r+=e;return r}function Qi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var ZC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ql(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&ZC.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var e7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function lS(e){return e?e.content&&e.type?Ao(e.content,!0):e.data?t0(e.data):e.asNodeBuffer&&kt?t0(e.asNodeBuffer().toString("binary")):e.asBinary?t0(e.asBinary()):e._data&&e._data.getContent?t0(Ao(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cS(e){if(!e)return null;if(e.data)return Ny(e.data);if(e.asNodeBuffer&&kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ny(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function t7(e){return e&&e.name.slice(-4)===".bin"?cS(e):lS(e)}function _i(e,t){for(var r=e.FullPaths||ma(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function X2(e,t){var r=_i(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Sr(e,t,r){if(!r)return t7(X2(e,t));if(!t)return null;try{return Sr(e,t)}catch{return null}}function Jn(e,t,r){if(!r)return lS(X2(e,t));if(!t)return null;try{return Jn(e,t)}catch{return null}}function uS(e,t,r){if(!r)return cS(X2(e,t));if(!t)return null;try{return uS(e,t)}catch{return null}}function Gy(e){for(var t=e.FullPaths||ma(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function r7(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return kt?n=bo(r):n=wC(r),Tt.utils.cfb_add(e,t,n)}Tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function fS(e,t){switch(t.type){case"base64":return Tt.read(e,{type:"base64"});case"binary":return Tt.read(e,{type:"binary"});case"buffer":case"array":return Tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function n0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var dS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,n7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,i7=/<[^>]*>/g,Sn=dS.match(Hy)?Hy:i7,a7=/<\w*:/,s7=/<(\/?)\w+:/;function it(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(n7),o=0,u="",f=0,d="",p="",g=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(d=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(i=p.charCodeAt(a+1))==34||i==39?1:0,u=p.slice(a+1+g,p.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,r||(n[d.toLowerCase()]=u);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=u,r||(n[v.toLowerCase()]=u)}}return n}function xa(e){return e.replace(s7,"<$1")}var hS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o7=$2(hS),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,u){return hS[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),l7=/[&<>'"]/g,c7=/[\u0000-\u001f]/g;function K2(e){var t=e+"";return t.replace(l7,function(r){return o7[r]}).replace(/\n/g,"<br/>").replace(c7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Wy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tg(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function $y(e){var t=Ds(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Xy(e){return bo(e,"binary").toString("utf8")}var bf="foo bar baz",Xt=kt&&(Xy(bf)==tg(bf)&&Xy||$y(bf)==tg(bf)&&$y)||tg,i0=kt?function(e){return bo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},X0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),pS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),u7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),f7=/<\/?(?:vt:)?variant>/g,d7=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ky(e,t){var r=it(e),n=e.match(u7(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(f7,"").match(d7);s&&i.push({v:Xt(s[2]),t:s[1]})}),i}var h7=/(^\s|\s$|\n)/;function p7(e){return ma(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function g7(e,t,r){return"<"+e+(r!=null?p7(r):"")+(t!=null?(t.match(h7)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Y2(e){if(kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(Io(G2(e)));throw new Error("Bad input format: expected Buffer or string")}var K0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,m7={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},x7=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function v7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function y7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Yy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Qy=kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:bo(t)})):Yy(e)}:Yy,qy=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(La(e,i)));return n.join("").replace(Rn,"")},Q2=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Rn,""):qy(e,t,r)}:qy,Jy=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},gS=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Jy(e,t,r)}:Jy,Zy=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(gl(e,i)));return n.join("")},cu=kt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Zy(t,r,n)}:Zy,mS=function(e,t){var r=qn(e,t);return r>0?cu(e,t+4,t+4+r-1):""},xS=mS,vS=function(e,t){var r=qn(e,t);return r>0?cu(e,t+4,t+4+r-1):""},yS=vS,_S=function(e,t){var r=2*qn(e,t);return r>0?cu(e,t+4,t+4+r-1):""},SS=_S,wS=function(t,r){var n=qn(t,r);return n>0?Q2(t,r+4,r+4+n):""},kS=wS,ES=function(e,t){var r=qn(e,t);return r>0?cu(e,t+4,t+4+r):""},CS=ES,TS=function(e,t){return v7(e,t)},Md=TS,AS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};kt&&(xS=function(t,r){if(!Buffer.isBuffer(t))return mS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},yS=function(t,r){if(!Buffer.isBuffer(t))return vS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},SS=function(t,r){if(!Buffer.isBuffer(t))return _S(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},kS=function(t,r){if(!Buffer.isBuffer(t))return wS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},CS=function(t,r){if(!Buffer.isBuffer(t))return ES(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Md=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):TS(t,r)},AS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var gl=function(e,t){return e[t]},La=function(e,t){return e[t+1]*256+e[t]},_7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},co=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},S7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function m0(e,t){var r="",n,i,a=[],s,o,u,f;switch(t){case"dbcs":if(f=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(La(this,f)),f+=2;e*=2;break;case"utf8":r=cu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Q2(this,this.l,this.l+e);break;case"wstr":return m0.call(this,e,"dbcs");case"lpstr-ansi":r=xS(this,this.l),e=4+qn(this,this.l);break;case"lpstr-cp":r=yS(this,this.l),e=4+qn(this,this.l);break;case"lpwstr":r=SS(this,this.l),e=4+2*qn(this,this.l);break;case"lpp4":e=4+qn(this,this.l),r=kS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qn(this,this.l),r=CS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=gl(this,this.l+e++))!==0;)a.push(Rf(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=La(this,this.l+e))!==0;)a.push(Rf(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=gl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Rf(La(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=gl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Rf(gl(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=gl(this,this.l),this.l++,n;case 2:return n=(t==="i"?_7:La)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?co:S7)(this,this.l),this.l+=4,n):(i=qn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Md(this,this.l):i=Md([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=gS(this,this.l,e);break}}return this.l+=e,r}var w7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},k7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},E7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function C7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)E7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,w7(this,t,this.l);break;case 8:if(n=8,r==="f"){y7(this,t,this.l);break}case 16:break;case-4:n=4,k7(this,t,this.l);break}return this.l+=n,this}function PS(e,t){var r=gS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Qr(e,t){e.l=t,e.read_shift=m0,e.chk=PS,e.write_shift=C7}function _n(e,t){e.l+=t}function Fr(e){var t=Ds(e);return Qr(t,0),t}function Ka(e,t,r){if(e){var n,i,a;Qr(e,e.l||0);for(var s=e.length,o=0,u=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=Gd[o]||Gd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,o))return}}}function km(){var e=[],t=kt?256:2048,r=function(f){var d=Fr(f);return Qr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},s=function(){return i(),xs(e)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function x0(e,t,r){var n=Jr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function e3(e,t,r){var n=Jr(e);return n.s=x0(n.s,t.s,r),n.e=x0(n.e,t.s,r),n}function v0(e,t){if(e.cRel&&e.c<0)for(e=Jr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ct(e);return!e.cRel&&e.cRel!=null&&(r=P7(r)),!e.rRel&&e.rRel!=null&&(r=T7(r)),r}function rg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+br(e.s.c)+":"+(e.e.cRel?"":"$")+br(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zr(e.s.r)+":"+(e.e.rRel?"":"$")+Zr(e.e.r):v0(e.s,t.biff)+":"+v0(e.e,t.biff)}function q2(e){return parseInt(A7(e),10)-1}function Zr(e){return""+(e+1)}function T7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function A7(e){return e.replace(/\$(\d+)$/,"$1")}function J2(e){for(var t=F7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function br(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function P7(e){return e.replace(/^([A-Z])/,"$$$1")}function F7(e){return e.replace(/^\$([A-Z])/,"$1")}function N7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ac(e){var t=e.indexOf(":");return t==-1?{s:Fn(e),e:Fn(e)}:{s:Fn(e.slice(0,t)),e:Fn(e.slice(t+1))}}function At(e,t){return typeof t>"u"||typeof t=="number"?At(e.s,e.e):(typeof e!="string"&&(e=ct(e)),typeof t!="string"&&(t=ct(t)),e==t?e:e+":"+t)}function dr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function t3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Pi(e.z,r?bn(t):t)}catch{}try{return e.w=Pi((e.XF||{}).numFmtId||(r?14:0),r?bn(t):t)}catch{return""+t}}function $a(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Lo[e.v]||e.v:t==null?t3(e,e.v):t3(e,t))}function Us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function FS(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Fn(n.origin):n.origin;s=u.r,o=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=dr(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var v={v:t[p][g]},m=s+p,y=o+g;if(f.s.r>m&&(f.s.r=m),f.s.c>y&&(f.s.c=y),f.e.r<m&&(f.e.r=m),f.e.c<y&&(f.e.c=y),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))v=t[p][g];else if(Array.isArray(v.v)&&(v.f=t[p][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ht[14],n.cellDates?(v.t="d",v.w=Pi(v.z,bn(v.v))):(v.t="n",v.v=bn(v.v),v.w=Pi(v.z,v.v))):v.t="s";if(i)a[m]||(a[m]=[]),a[m][y]&&a[m][y].z&&(v.z=a[m][y].z),a[m][y]=v;else{var C=ct({c:y,r:m});a[C]&&a[C].z&&(v.z=a[C].z),a[C]=v}}}return f.s.c<1e7&&(a["!ref"]=At(f)),a}function sc(e,t){return FS(null,e,t)}function R7(e){return e.read_shift(4,"i")}function vn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function b7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Z2(e,t){var r=e.l,n=e.read_shift(1),i=vn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),u=0;u!=o;++u)a.push(b7(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var I7=Z2;function Fi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Do(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var D7=vn;function ex(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var O7=vn,Em=ex;function tx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Md([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):co(t,0)>>2;return r?i/100:i}function NS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Oo=NS;function mn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function L7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=yo[i];f&&(t.rgb=Q0(f));break;case 2:t.rgb=Q0([s,o,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function M7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function RS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function B7(e){return RS(e,1)}function j7(e){return RS(e,2)}var rx=2,zn=3,If=11,r3=12,Bd=19,Df=64,U7=65,z7=71,V7=4108,G7=4126,Gr=80,bS=81,H7=[Gr,bS],W7={1:{n:"CodePage",t:rx},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:zn},5:{n:"LineCount",t:zn},6:{n:"ParagraphCount",t:zn},7:{n:"SlideCount",t:zn},8:{n:"NoteCount",t:zn},9:{n:"HiddenCount",t:zn},10:{n:"MultimediaClipCount",t:zn},11:{n:"ScaleCrop",t:If},12:{n:"HeadingPairs",t:V7},13:{n:"TitlesOfParts",t:G7},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:If},17:{n:"CharacterCount",t:zn},19:{n:"SharedDoc",t:If},22:{n:"HyperlinksChanged",t:If},23:{n:"AppVersion",t:zn,p:"version"},24:{n:"DigSig",t:U7},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:Bd},2147483651:{n:"Behavior",t:Bd},1919054434:{}},$7={1:{n:"CodePage",t:rx},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:Df},11:{n:"LastPrinted",t:Df},12:{n:"CreatedDate",t:Df},13:{n:"ModifiedDate",t:Df},14:{n:"PageCount",t:zn},15:{n:"WordCount",t:zn},16:{n:"CharCount",t:zn},17:{n:"Thumbnail",t:z7},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:zn},255:{},2147483648:{n:"Locale",t:Bd},2147483651:{n:"Behavior",t:Bd},1919054434:{}},n3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},X7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function K7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Y7=K7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yo=Jr(Y7),Lo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},IS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},i3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Q7(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function q7(e){var t=Q7();if(!e||!e.match)return t;var r={};if((e.match(Sn)||[]).forEach(function(n){var i=it(n);switch(i[0].replace(a7,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[i3[i.ContentType]]!==void 0&&t[i3[i.ContentType]].push(i.PartName);break}}),t.xmlns!==m7.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Fl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function y0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Sn)||[]).forEach(function(i){var a=it(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:n0(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var J7="application/vnd.oasis.opendocument.spreadsheet";function Z7(e,t){for(var r=Y2(e),n,i;n=K0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=it(n[0],!1),i.path=="/"&&i.type!==J7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var _0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],eT=function(){for(var e=new Array(_0.length),t=0;t<_0.length;++t){var r=_0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function DS(e){var t={};e=Xt(e);for(var r=0;r<_0.length;++r){var n=_0[r],i=e.match(eT[r]);i!=null&&i.length>0&&(t[n[1]]=Nt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$r(t[n[1]]))}return t}var tT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function OS(e,t,r,n){var i=[];if(typeof e=="string")i=Ky(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var s=typeof t=="string"?Ky(t,n).map(function(d){return d.v}):t,o=0,u=0;if(s.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=s.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=s.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=s.slice(o,o+u);break}o+=u}}function rT(e,t,r){var n={};return t||(t={}),e=Xt(e),tT.forEach(function(i){var a=(e.match(X0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Nt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&OS(n.HeadingPairs,n.TitlesOfParts,t,r),t}var nT=/<[^>]+>[^<]*/g;function iT(e,t){var r={},n="",i=e.match(nT);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=it(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var u=s.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(d);break;case"bool":r[n]=Zt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=$r(d);break;case"cy":case"error":r[n]=Nt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,u)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var aT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ng;function sT(e,t,r){ng||(ng=$2(aT)),t=ng[t]||t,e[t]=r}function nx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LS(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function MS(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function BS(e,t,r){return t===31?MS(e):LS(e,t,r)}function Tm(e,t,r){return BS(e,t,r===!1?0:4)}function oT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return BS(e,t,0)}function lT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Rn,""),e.l-i&2&&(e.l+=2)}return r}function cT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Rn,"");return r}function uT(e){var t=e.l,r=jd(e,bS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=jd(e,zn);return[r,n]}function fT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(uT(e));return r}function a3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Rn,"").replace(r0,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function jS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function dT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jd(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==r3&&n!==t&&H7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===r3?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return LS(e,n,4).replace(Rn,"");case 31:return MS(e);case 64:return nx(e);case 65:return jS(e);case 71:return dT(e);case 80:return Tm(e,n,!a.raw).replace(Rn,"");case 81:return oT(e,n).replace(Rn,"");case 4108:return fT(e);case 4126:case 4127:return n==4127?lT(e):cT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function s3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,u=-1,f={};for(s=0;s!=i;++s){var d=e.read_shift(4),p=e.read_shift(4);a[s]=[d,p+r]}a.sort(function(w,x){return w[1]-x[1]});var g={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var v=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(v=!1,e.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[a[s][0]];if(g[m.n]=jd(e,m.t,{raw:!0}),m.p==="version"&&(g[m.n]=String(g[m.n]>>16)+"."+("0000"+String(g[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(g[m.n]){case 0:g[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Wi(o=g[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[m.n])}}else if(a[s][0]===1){if(o=g.CodePage=jd(e,rx),Wi(o),u!==-1){var y=e.l;e.l=a[u][1],f=a3(e,o),e.l=y}}else if(a[s][0]===0){if(o===0){u=s,e.l=a[s+1][1];continue}f=a3(e,o)}else{var C=f[a[s][0]],S;switch(e[e.l]){case 65:e.l+=4,S=jS(e);break;case 30:e.l+=4,S=Tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=gr(e,4);break;case 64:e.l+=4,S=$r(nx(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[C]=S}}return e.l=r+n,g}function o3(e,t,r){var n=e.content;if(!n)return{};Qr(n,0);var i,a,s,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==Tt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),u=n.read_shift(4));var p=s3(n,t),g={SystemIdentifier:f};for(var v in p)g[v]=p[v];if(g.FMTID=a,i===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var m;try{m=s3(n,null)}catch{}for(v in m)g[v]=m[v];return g.FMTID=[a,s],g}function cs(e,t){return e.read_shift(t),null}function hT(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function gr(e,t){return e.read_shift(t)===1}function wr(e){return e.read_shift(2,"u")}function US(e,t){return hT(e,t,wr)}function pT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function uu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function gT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,u={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*s),n&&(e.l+=o),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Po(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function fu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Po(e,n,r)}function Mo(e,t,r){if(r.biff>5)return fu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function xT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Rn,"");return n&&(e.l+=24),i}function vT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Rn,"");return r+s}function yT(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xT(e);case"0303000000000000c000000000000046":return vT(e);default:throw new Error("Unsupported Moniker "+r)}}function Of(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Rn,""):"";return r}function _T(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,u,f="",d,p;i&16&&(a=Of(e,r-e.l)),i&128&&(s=Of(e,r-e.l)),(i&257)===257&&(o=Of(e,r-e.l)),(i&257)===1&&(u=yT(e,r-e.l)),i&8&&(f=Of(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(p=nx(e)),e.l=r;var g=s||o||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return d&&(v.guid=d),p&&(v.time=p),a&&(v.Tooltip=a),v}function zS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function VS(e,t){var r=zS(e);return r[3]=0,r}function va(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ST(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function wT(e,t,r){return t===0?"":Mo(e,t,r)}function kT(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function GS(e){var t=e.read_shift(2),r=tx(e);return[t,r]}function ET(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=uu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function _h(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function HS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var CT=HS;function WS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function TT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function AT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function dn(e){e.l+=2,e.l+=e.read_shift(2)}var PT={0:dn,4:dn,5:dn,6:dn,7:AT,8:dn,9:dn,10:dn,11:dn,12:dn,13:TT,14:dn,15:dn,16:dn,17:dn,18:dn,19:dn,20:dn,21:WS};function FT(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(PT[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Lf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function NT(e,t){return t===0||e.read_shift(2),1200}function RT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Mo(e,0,r);return e.read_shift(t+n-e.l),i}function bT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function IT(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=uu(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function DT(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(gT(e));return a.Count=n,a.Unique=i,a}function OT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function LT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function MT(e){var t=ST(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function BT(e){return e.read_shift(2),e.read_shift(4)}function l3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function jT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:u,TabRatio:f}}function UT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zT(){}function VT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=uu(e,0,r),n}function GT(e){var t=va(e);return t.isst=e.read_shift(4),t}function HT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=va(e);r.biff==2&&e.l++;var a=fu(e,n-e.l,r);return i.val=a,i}function WT(e,t,r){var n=e.read_shift(2),i=Mo(e,0,r);return[n,i]}var $T=Mo;function c3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:u}}}function XT(e){var t=e.read_shift(2),r=e.read_shift(2),n=GS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(GS(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function YT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function QT(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return i.patternType=X7[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function qT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=QT(e,t,n.fStyle,r),n}function JT(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function u3(e,t,r){var n=va(e);(r.biff==2||t==9)&&++e.l;var i=pT(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function ZT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=va(e),i=mn(e);return n.val=i,n}var f3=wT;function eA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Po(e,a),o=[];n>e.l;)o.push(fu(e));return[a,i,s,o]}function d3(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=ET(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var tA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h3(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Po(e,s,r);i&32&&(f=tA[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||o===0||!(d>0)?[]:LN(e,d,r,o);return{chKey:a,Name:f,itab:u,rgce:p}}function $S(e,t,r){if(r.biff<8)return rA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(kT(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function rA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=uu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Po(e,n,r),s=Po(e,i,r);return[a,s]}function iA(e,t,r){var n=HS(e);e.l++;var i=e.read_shift(1);return t-=8,[MN(e,t,r),i,n]}function p3(e,t,r){var n=CT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,DN(e,t,r)]}function aA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function sA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=Mo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function oA(e,t,r){return sA(e,t,r)}function lA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(_h(e));return r}function cA(e,t,r){if(r&&r.biff<8)return fA(e,t,r);var n=WS(e),i=FT(e,t-22,n[1]);return{cmo:n,ft:i}}var uA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function fA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((uA[n]||_n)(e,t,r)),{cmo:[i,n,a],ft:s}}function dA(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=mT(e,6,r);var o=e.read_shift(2);e.read_shift(2),wr(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=Po(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function hA(e,t){var r=_h(e);e.l+=16;var n=_T(e,t-24);return[r,n]}function pA(e,t){e.read_shift(2);var r=_h(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Rn,""),[r,n]}function gA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=n3[r]||r,r=e.read_shift(2),t[1]=n3[r]||r,t}function mA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(VS(e));return r}function xA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(VS(e));return r}function vA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function XS(e,t,r){if(!r.cellStyles)return _n(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:s,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function yA(e,t){var r={};return t<32||(e.l+=16,r.header=mn(e),r.footer=mn(e),e.l+=2),r}function _A(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var SA=va,wA=US,kA=fu;function EA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function CA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=va(e);++e.l;var i=Mo(e,t-7,r);return n.t="str",n.val=i,n}function TA(e){var t=va(e);++e.l;var r=mn(e);return t.t="n",t.val=r,t}function AA(e){var t=va(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function PA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function FA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function NA(e,t,r){var n=e.l+t,i=va(e),a=e.read_shift(2),s=Po(e,a,r);return e.l=n,i.t="str",i.val=s,i}var RA=[2,3,48,49,131,139,140,245],g3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=$2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ds(1);switch(u.type){case"base64":d=Hi(ni(o));break;case"binary":d=Hi(o);break;case"buffer":case"array":d=o;break}Qr(d,0);var p=d.read_shift(1),g=!!(p&136),v=!1,m=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,C=521;p==2&&(y=d.read_shift(2)),d.l+=3,p!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(C=d.read_shift(2));var S=d.read_shift(2),w=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var x=[],T={},A=Math.min(d.length,p==2?521:C-10-(v?264:0)),F=m?32:11;d.l<A&&d[d.l]!=13;)switch(T={},T.name=ms.utils.decode(w,d.slice(d.l,d.l+F)).replace(/[\u0000\r\n].*$/g,""),d.l+=F,T.type=String.fromCharCode(d.read_shift(1)),p!=2&&!m&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),p==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&x.push(T),p!=2&&(d.l+=m?13:14),T.type){case"B":(!v||T.len!=8)&&u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=C-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=C;var N=0,P=0;for(f[0]=[],P=0;P!=x.length;++P)f[0][P]=x[P].name;for(;y-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,f[++N]=[],P=0,P=0;P!=x.length;++P){var I=d.slice(d.l,d.l+x[P].len);d.l+=x[P].len,Qr(I,0);var b=ms.utils.decode(w,I);switch(x[P].type){case"C":b.trim().length&&(f[N][P]=b.replace(/\s+$/,""));break;case"D":b.length===8?f[N][P]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):f[N][P]=b;break;case"F":f[N][P]=parseFloat(b.trim());break;case"+":case"I":f[N][P]=m?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":f[N][P]=!0;break;case"N":case"F":f[N][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][P]="##MEMO##"+(m?parseInt(b.trim(),10):I.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(f[N][P]=+b||0);break;case"@":f[N][P]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[N][P]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[N][P]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][P]=-I.read_shift(-8,"f");break;case"B":if(v&&x[P].len==8){f[N][P]=I.read_shift(8,"f");break}case"G":case"P":I.l+=x[P].len;break;case"0":if(x[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[P].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=x,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=sc(r(o,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(o,u){try{return Us(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var f=u||{};if(+f.codepage>=0&&Wi(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=km(),p=Im(o,{header:1,raw:!0,cellDates:!0}),g=p[0],v=p.slice(1),m=o["!cols"]||[],y=0,C=0,S=0,w=1;for(y=0;y<g.length;++y){if(((m[y]||{}).DBF||{}).name){g[y]=m[y].DBF.name,++S;continue}if(g[y]!=null){if(++S,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(C=0;C<1024;++C)if(g.indexOf(g[y]+"_"+C)==-1){g[y]+="_"+C;break}}}}var x=dr(o["!ref"]),T=[],A=[],F=[];for(y=0;y<=x.e.c-x.s.c;++y){var N="",P="",I=0,b=[];for(C=0;C<v.length;++C)v[C][y]!=null&&b.push(v[C][y]);if(b.length==0||g[y]==null){T[y]="?";continue}for(C=0;C<b.length;++C){switch(typeof b[C]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=b[C]instanceof Date?"D":"C";break;default:P="C"}I=Math.max(I,String(b[C]).length),N=N&&N!=P?"C":P}I>250&&(I=250),P=((m[y]||{}).DBF||{}).type,P=="C"&&m[y].DBF.len>I&&(I=m[y].DBF.len),N=="B"&&P=="N"&&(N="N",F[y]=m[y].DBF.dec,I=m[y].DBF.len),A[y]=N=="C"||P=="N"?I:a[N]||0,w+=A[y],T[y]=N}var O=d.next(32);for(O.write_shift(4,318902576),O.write_shift(4,v.length),O.write_shift(2,296+32*S),O.write_shift(2,w),y=0;y<4;++y)O.write_shift(4,0);for(O.write_shift(4,0|(+t[W6]||3)<<8),y=0,C=0;y<g.length;++y)if(g[y]!=null){var L=d.next(32),K=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,K,"sbcs"),L.write_shift(1,T[y]=="?"?"C":T[y],"sbcs"),L.write_shift(4,C),L.write_shift(1,A[y]||a[T[y]]||0),L.write_shift(1,F[y]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),C+=A[y]||a[T[y]]||0}var ie=d.next(264);for(ie.write_shift(4,13),y=0;y<65;++y)ie.write_shift(4,0);for(y=0;y<v.length;++y){var re=d.next(w);for(re.write_shift(1,0),C=0;C<g.length;++C)if(g[C]!=null)switch(T[C]){case"L":re.write_shift(1,v[y][C]==null?63:v[y][C]?84:70);break;case"B":re.write_shift(8,v[y][C]||0,"f");break;case"N":var ke="0";for(typeof v[y][C]=="number"&&(ke=v[y][C].toFixed(F[C]||0)),S=0;S<A[C]-ke.length;++S)re.write_shift(1,32);re.write_shift(1,ke,"sbcs");break;case"D":v[y][C]?(re.write_shift(4,("0000"+v[y][C].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(v[y][C].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+v[y][C].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var we=String(v[y][C]!=null?v[y][C]:"").slice(0,A[C]);for(re.write_shift(1,we,"sbcs"),S=0;S<A[C]-we.length;++S)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),bA=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ma(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,v){var m=e[v];return typeof m=="number"?Ry(m):m},n=function(g,v,m){var y=v.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return y==59?g:Ry(y)};e["|"]=254;function i(g,v){switch(v.type){case"base64":return a(ni(g),v);case"binary":return a(g,v);case"buffer":return a(kt&&Buffer.isBuffer(g)?g.toString("binary"):Io(g),v);case"array":return a(Ao(g),v)}throw new Error("Unrecognized type "+v.type)}function a(g,v){var m=g.split(/[\n\r]+/),y=-1,C=-1,S=0,w=0,x=[],T=[],A=null,F={},N=[],P=[],I=[],b=0,O;for(+v.codepage>=0&&Wi(+v.codepage);S!==m.length;++S){b=0;var L=m[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=L.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),ie=K[0],re;if(L.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&T.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,we=!1,oe=!1,X=!1,he=-1,_e=-1;for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"A":break;case"X":C=parseInt(K[w].slice(1))-1,we=!0;break;case"Y":for(y=parseInt(K[w].slice(1))-1,we||(C=0),O=x.length;O<=y;++O)x[O]=[];break;case"K":re=K[w].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Qi(re))?isNaN(Ql(re).getDate())||(re=$r(re)):(re=Qi(re),A!==null&&ic(A)&&(re=yh(re))),ke=!0;break;case"E":X=!0;var M=Ml(K[w].slice(1),{r:y,c:C});x[y][C]=[x[y][C],M];break;case"S":oe=!0,x[y][C]=[x[y][C],"S5S"];break;case"G":break;case"R":he=parseInt(K[w].slice(1))-1;break;case"C":_e=parseInt(K[w].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}if(ke&&(x[y][C]&&x[y][C].length==2?x[y][C][0]=re:x[y][C]=re,A=null),oe){if(X)throw new Error("SYLK shared formula cannot have own formula");var J=he>-1&&x[he][_e];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");x[y][C][1]=n8(J[1],{r:y-he,c:C-_e})}break;case"F":var Q=0;for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"X":C=parseInt(K[w].slice(1))-1,++Q;break;case"Y":for(y=parseInt(K[w].slice(1))-1,O=x.length;O<=y;++O)x[O]=[];break;case"M":b=parseInt(K[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=T[parseInt(K[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=K[w].slice(1).split(" "),O=parseInt(I[0],10);O<=parseInt(I[1],10);++O)b=parseInt(I[2],10),P[O-1]=b===0?{hidden:!0}:{wch:b},ql(P[O-1]);break;case"C":C=parseInt(K[w].slice(1))-1,P[C]||(P[C]={});break;case"R":y=parseInt(K[w].slice(1))-1,N[y]||(N[y]={}),b>0?(N[y].hpt=b,N[y].hpx=q0(b)):b===0&&(N[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}Q<1&&(A=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}}return N.length>0&&(F["!rows"]=N),P.length>0&&(F["!cols"]=P),v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),[x,F]}function s(g,v){var m=i(g,v),y=m[0],C=m[1],S=sc(y,v);return ma(C).forEach(function(w){S[w]=C[w]}),S}function o(g,v){return Us(s(g,v),v)}function u(g,v,m,y){var C="C;Y"+(m+1)+";X"+(y+1)+";K";switch(g.t){case"n":C+=g.v||0,g.f&&!g.F&&(C+=";E"+vF(g.f,{r:m,c:y}));break;case"b":C+=g.v?"TRUE":"FALSE";break;case"e":C+=g.w||g.v;break;case"d":C+='"'+(g.w||g.v)+'"';break;case"s":C+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function f(g,v){v.forEach(function(m,y){var C="F;W"+(y+1)+" "+(y+1)+" ";m.hidden?C+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=zd(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Vd(m.wpx)),typeof m.wch=="number"&&(C+=Math.round(m.wch))),C.charAt(C.length-1)!=" "&&g.push(C)})}function d(g,v){v.forEach(function(m,y){var C="F;";m.hidden?C+="M0;":m.hpt?C+="M"+20*m.hpt+";":m.hpx&&(C+="M"+20*e8(m.hpx)+";"),C.length>2&&g.push(C+"R"+(y+1))})}function p(g,v){var m=["ID;PWXL;N;E"],y=[],C=dr(g["!ref"]),S,w=Array.isArray(g),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),g["!cols"]&&f(m,g["!cols"]),g["!rows"]&&d(m,g["!rows"]),m.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var T=C.s.r;T<=C.e.r;++T)for(var A=C.s.c;A<=C.e.c;++A){var F=ct({r:T,c:A});S=w?(g[T]||[])[A]:g[F],!(!S||S.v==null&&(!S.f||S.F))&&y.push(u(S,g,T,A))}return m.join(x)+x+y.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),IA=function(){function e(a,s){switch(s.type){case"base64":return t(ni(a),s);case"binary":return t(a,s);case"buffer":return t(kt&&Buffer.isBuffer(a)?a.toString("binary"):Io(a),s);case"array":return t(Ao(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),u=-1,f=-1,d=0,p=[];d!==o.length;++d){if(o[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var g=o[d].trim().split(","),v=g[0],m=g[1];++d;for(var y=o[d]||"";(y.match(/["]/g)||[]).length&1&&d<o.length-1;)y+=`
`+o[++d];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[u][f]=!0:y==="FALSE"?p[u][f]=!1:isNaN(Qi(m))?isNaN(Ql(m).getDate())?p[u][f]=m:p[u][f]=$r(m):p[u][f]=Qi(m),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(a,s){return sc(e(a,s),s)}function n(a,s){return Us(r(a,s),s)}var i=function(){var a=function(u,f,d,p,g){u.push(f),u.push(d+","+p),u.push('"'+g.replace(/"/g,'""')+'"')},s=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=dr(u["!ref"]),p,g=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(f,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var y=ct({r:v,c:m});if(p=g?(u[v]||[])[m]:u[y],!p){s(f,1,0,"");continue}switch(p.t){case"n":var C=p.w;!C&&p.v!=null&&(C=p.v),C==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,C,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Pi(p.z||ht[14],bn($r(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var S=`\r
`,w=f.join(S);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),DA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var v=p.split(`
`),m=-1,y=-1,C=0,S=[];C!==v.length;++C){var w=v[C].trim().split(":");if(w[0]==="cell"){var x=Fn(w[1]);if(S.length<=x.r)for(m=S.length;m<=x.r;++m)S[m]||(S[m]=[]);switch(m=x.r,y=x.c,w[2]){case"t":S[m][y]=e(w[3]);break;case"v":S[m][y]=+w[3];break;case"vtf":var T=w[w.length-1];case"vtc":switch(w[3]){case"nl":S[m][y]=!!+w[4];break;default:S[m][y]=+w[4];break}w[2]=="vtf"&&(S[m][y]=[S[m][y],T])}}}return g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),S}function n(p,g){return sc(r(p,g),g)}function i(p,g){return Us(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],m,y="",C=ac(p["!ref"]),S=Array.isArray(p),w=C.s.r;w<=C.e.r;++w)for(var x=C.s.c;x<=C.e.c;++x)if(y=ct({r:w,c:x}),m=S?(p[w]||[])[x]:p[y],!(!m||m.v==null||m.t==="z")){switch(v=["cell",y,"t"],m.t){case"s":case"str":v.push(t(m.v));break;case"n":m.f?(v[2]="vtf",v[3]="n",v[4]=m.v,v[5]=t(m.f)):(v[2]="v",v[3]=m.v);break;case"b":v[2]="vt"+(m.f?"f":"c"),v[3]="nl",v[4]=m.v?"1":"0",v[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=bn($r(m.v));v[2]="vtc",v[3]="nd",v[4]=""+T,v[5]=m.w||Pi(m.z||ht[14],T);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(p){return[a,s,o,s,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Y0=function(){function e(d,p,g,v,m){m.raw?p[g][v]=d:d===""||(d==="TRUE"?p[g][v]=!0:d==="FALSE"?p[g][v]=!1:isNaN(Qi(d))?isNaN(Ql(d).getDate())?p[g][v]=d:p[g][v]=$r(d):p[g][v]=Qi(d))}function t(d,p){var g=p||{},v=[];if(!d||d.length===0)return v;for(var m=d.split(/[\r\n]/),y=m.length-1;y>=0&&m[y].length===0;)--y;for(var C=10,S=0,w=0;w<=y;++w)S=m[w].indexOf(" "),S==-1?S=m[w].length:S++,C=Math.max(C,S);for(w=0;w<=y;++w){v[w]=[];var x=0;for(e(m[w].slice(0,C).trim(),v,w,x,g),x=1;x<=(m[w].length-C)/10+1;++x)e(m[w].slice(C+(x-1)*10,C+x*10).trim(),v,w,x,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var p={},g=!1,v=0,m=0;v<d.length;++v)(m=d.charCodeAt(v))==34?g=!g:!g&&m in r&&(p[m]=(p[m]||0)+1);m=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v]);if(!m.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v])}return m.sort(function(y,C){return y[0]-C[0]||n[y[1]]-n[C[1]]}),r[m.pop()[1]]||44}function a(d,p){var g=p||{},v="",m=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):g&&g.FS?v=g.FS:v=i(d.slice(0,1024));var C=0,S=0,w=0,x=0,T=0,A=v.charCodeAt(0),F=!1,N=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=g.dateNF!=null?$C(g.dateNF):null;function b(){var O=d.slice(x,T),L={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)L.t="z";else if(g.raw)L.t="s",L.v=O;else if(O.trim().length===0)L.t="s",L.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(L.t="s",L.v=O.slice(2,-1).replace(/""/g,'"')):_F(O)?(L.t="n",L.f=O.slice(1)):(L.t="s",L.v=O);else if(O=="TRUE")L.t="b",L.v=!0;else if(O=="FALSE")L.t="b",L.v=!1;else if(!isNaN(w=Qi(O)))L.t="n",g.cellText!==!1&&(L.w=O),L.v=w;else if(!isNaN(Ql(O).getDate())||I&&O.match(I)){L.z=g.dateNF||ht[14];var K=0;I&&O.match(I)&&(O=XC(O,g.dateNF,O.match(I)||[]),K=1),g.cellDates?(L.t="d",L.v=$r(O,K)):(L.t="n",L.v=bn($r(O,K))),g.cellText!==!1&&(L.w=Pi(L.z,L.v instanceof Date?bn(L.v):L.v)),g.cellNF||delete L.z}else L.t="s",L.v=O;if(L.t=="z"||(g.dense?(m[C]||(m[C]=[]),m[C][S]=L):m[ct({c:S,r:C})]=L),x=T+1,P=d.charCodeAt(x),y.e.c<S&&(y.e.c=S),y.e.r<C&&(y.e.r=C),N==A)++S;else if(S=0,++C,g.sheetRows&&g.sheetRows<=C)return!0}e:for(;T<d.length;++T)switch(N=d.charCodeAt(T)){case 34:P===34&&(F=!F);break;case A:case 10:case 13:if(!F&&b())break e;break}return T-x>0&&b(),m["!ref"]=At(y),m}function s(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,p):sc(t(d,p),p)}function o(d,p){var g="",v=p.type=="string"?[0,0,0,0]:fx(d,p);switch(p.type){case"base64":g=ni(d);break;case"binary":g=d;break;case"buffer":p.codepage==65001?g=d.toString("utf8"):p.codepage&&typeof ms<"u"?g=ms.utils.decode(p.codepage,d):g=kt&&Buffer.isBuffer(d)?d.toString("binary"):Io(d);break;case"array":g=Ao(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Xt(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=Xt(g):p.type=="binary"&&typeof ms<"u"&&p.codepage&&(g=ms.utils.decode(p.codepage,ms.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?DA.to_sheet(p.type=="string"?g:Xt(g),p):s(g,p)}function u(d,p){return Us(o(d,p),p)}function f(d){for(var p=[],g=dr(d["!ref"]),v,m=Array.isArray(d),y=g.s.r;y<=g.e.r;++y){for(var C=[],S=g.s.c;S<=g.e.c;++S){var w=ct({r:y,c:S});if(v=m?(d[y]||[])[S]:d[w],!v||v.v==null){C.push("          ");continue}for(var x=(v.w||($a(v),v.w)||"").slice(0,10);x.length<10;)x+=" ";C.push(x+(S===0?" ":""))}p.push(C.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}}();function OA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=bA.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Y0.to_workbook(e,t)}}var S0=function(){function e(M,J,Q){if(M){Qr(M,M.l||0);for(var Y=Q.Enum||he;M.l<M.length;){var ue=M.read_shift(2),z=Y[ue]||Y[65535],te=M.read_shift(2),de=M.l+te,xe=z.f&&z.f(M,te,Q);if(M.l=de,J(xe,z,ue))return}}}function t(M,J){switch(J.type){case"base64":return r(Hi(ni(M)),J);case"binary":return r(Hi(M),J);case"buffer":case"array":return r(M,J)}throw"Unsupported type "+J.type}function r(M,J){if(!M)return M;var Q=J||{},Y=Q.dense?[]:{},ue="Sheet1",z="",te=0,de={},xe=[],Me=[],G={s:{r:0,c:0},e:{r:0,c:0}},tt=Q.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)Q.Enum=he,e(M,function(Ie,Ct,Lr){switch(Lr){case 0:Q.vers=Ie,Ie>=4096&&(Q.qpro=!0);break;case 6:G=Ie;break;case 204:Ie&&(z=Ie);break;case 222:z=Ie;break;case 15:case 51:Q.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:Lr==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=Q.dateNF||ht[14],Q.cellDates&&(Ie[1].t="d",Ie[1].v=yh(Ie[1].v))),Q.qpro&&Ie[3]>te&&(Y["!ref"]=At(G),de[ue]=Y,xe.push(ue),Y=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},te=Ie[3],ue=z||"Sheet"+(te+1),z="");var me=Q.dense?(Y[Ie[0].r]||[])[Ie[0].c]:Y[ct(Ie[0])];if(me){me.t=Ie[1].t,me.v=Ie[1].v,Ie[1].z!=null&&(me.z=Ie[1].z),Ie[1].f!=null&&(me.f=Ie[1].f);break}Q.dense?(Y[Ie[0].r]||(Y[Ie[0].r]=[]),Y[Ie[0].r][Ie[0].c]=Ie[1]):Y[ct(Ie[0])]=Ie[1];break}},Q);else if(M[2]==26||M[2]==14)Q.Enum=_e,M[2]==14&&(Q.qpro=!0,M.l=0),e(M,function(Ie,Ct,Lr){switch(Lr){case 204:ue=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>te&&(Y["!ref"]=At(G),de[ue]=Y,xe.push(ue),Y=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},te=Ie[3],ue="Sheet"+(te+1)),tt>0&&Ie[0].r>=tt)break;Q.dense?(Y[Ie[0].r]||(Y[Ie[0].r]=[]),Y[Ie[0].r][Ie[0].c]=Ie[1]):Y[ct(Ie[0])]=Ie[1],G.e.c<Ie[0].c&&(G.e.c=Ie[0].c),G.e.r<Ie[0].r&&(G.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(Me[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:Me[Ie[0]]=Ie[1],Ie[0]==te&&(ue=Ie[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(Y["!ref"]=At(G),de[z||ue]=Y,xe.push(z||ue),!Me.length)return{SheetNames:xe,Sheets:de};for(var nt={},Xe=[],Ze=0;Ze<Me.length;++Ze)de[xe[Ze]]?(Xe.push(Me[Ze]||xe[Ze]),nt[Me[Ze]]=de[Me[Ze]]||de[xe[Ze]]):(Xe.push(Me[Ze]),nt[Me[Ze]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:nt}}function n(M,J){var Q=J||{};if(+Q.codepage>=0&&Wi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=km(),ue=dr(M["!ref"]),z=Array.isArray(M),te=[];ji(Y,0,a(1030)),ji(Y,6,u(ue));for(var de=Math.min(ue.e.r,8191),xe=ue.s.r;xe<=de;++xe)for(var Me=Zr(xe),G=ue.s.c;G<=ue.e.c;++G){xe===ue.s.r&&(te[G]=br(G));var tt=te[G]+Me,nt=z?(M[xe]||[])[G]:M[tt];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?ji(Y,13,v(xe,G,nt.v)):ji(Y,14,y(xe,G,nt.v));else{var Xe=$a(nt);ji(Y,15,p(xe,G,Xe.slice(0,239)))}}return ji(Y,1),Y.end()}function i(M,J){var Q=J||{};if(+Q.codepage>=0&&Wi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=km();ji(Y,0,s(M));for(var ue=0,z=0;ue<M.SheetNames.length;++ue)(M.Sheets[M.SheetNames[ue]]||{})["!ref"]&&ji(Y,27,X(M.SheetNames[ue],z++));var te=0;for(ue=0;ue<M.SheetNames.length;++ue){var de=M.Sheets[M.SheetNames[ue]];if(!(!de||!de["!ref"])){for(var xe=dr(de["!ref"]),Me=Array.isArray(de),G=[],tt=Math.min(xe.e.r,8191),nt=xe.s.r;nt<=tt;++nt)for(var Xe=Zr(nt),Ze=xe.s.c;Ze<=xe.e.c;++Ze){nt===xe.s.r&&(G[Ze]=br(Ze));var Ie=G[Ze]+Xe,Ct=Me?(de[nt]||[])[Ze]:de[Ie];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")ji(Y,23,b(nt,Ze,te,Ct.v));else{var Lr=$a(Ct);ji(Y,22,N(nt,Ze,te,Lr.slice(0,239)))}}++te}}return ji(Y,1),Y.end()}function a(M){var J=Fr(2);return J.write_shift(2,M),J}function s(M){var J=Fr(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Q=0,Y=0,ue=0,z=0;z<M.SheetNames.length;++z){var te=M.SheetNames[z],de=M.Sheets[te];if(!(!de||!de["!ref"])){++ue;var xe=ac(de["!ref"]);Q<xe.e.r&&(Q=xe.e.r),Y<xe.e.c&&(Y=xe.e.c)}}return Q>8191&&(Q=8191),J.write_shift(2,Q),J.write_shift(1,ue),J.write_shift(1,Y),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function o(M,J,Q){var Y={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&Q.qpro?(Y.s.c=M.read_shift(1),M.l++,Y.s.r=M.read_shift(2),Y.e.c=M.read_shift(1),M.l++,Y.e.r=M.read_shift(2),Y):(Y.s.c=M.read_shift(2),Y.s.r=M.read_shift(2),J==12&&Q.qpro&&(M.l+=2),Y.e.c=M.read_shift(2),Y.e.r=M.read_shift(2),J==12&&Q.qpro&&(M.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function u(M){var J=Fr(8);return J.write_shift(2,M.s.c),J.write_shift(2,M.s.r),J.write_shift(2,M.e.c),J.write_shift(2,M.e.r),J}function f(M,J,Q){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(Y[0].c=M.read_shift(1),Y[3]=M.read_shift(1),Y[0].r=M.read_shift(2),M.l+=2):(Y[2]=M.read_shift(1),Y[0].c=M.read_shift(2),Y[0].r=M.read_shift(2)),Y}function d(M,J,Q){var Y=M.l+J,ue=f(M,J,Q);if(ue[1].t="s",Q.vers==20768){M.l++;var z=M.read_shift(1);return ue[1].v=M.read_shift(z,"utf8"),ue}return Q.qpro&&M.l++,ue[1].v=M.read_shift(Y-M.l,"cstr"),ue}function p(M,J,Q){var Y=Fr(7+Q.length);Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,M),Y.write_shift(1,39);for(var ue=0;ue<Y.length;++ue){var z=Q.charCodeAt(ue);Y.write_shift(1,z>=128?95:z)}return Y.write_shift(1,0),Y}function g(M,J,Q){var Y=f(M,J,Q);return Y[1].v=M.read_shift(2,"i"),Y}function v(M,J,Q){var Y=Fr(7);return Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,M),Y.write_shift(2,Q,"i"),Y}function m(M,J,Q){var Y=f(M,J,Q);return Y[1].v=M.read_shift(8,"f"),Y}function y(M,J,Q){var Y=Fr(13);return Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,M),Y.write_shift(8,Q,"f"),Y}function C(M,J,Q){var Y=M.l+J,ue=f(M,J,Q);if(ue[1].v=M.read_shift(8,"f"),Q.qpro)M.l=Y;else{var z=M.read_shift(2);T(M.slice(M.l,M.l+z),ue),M.l+=z}return ue}function S(M,J,Q){var Y=J&32768;return J&=-32769,J=(Y?M:0)+(J>=8192?J-16384:J),(Y?"":"$")+(Q?br(J):Zr(J))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(M,J){Qr(M,0);for(var Q=[],Y=0,ue="",z="",te="",de="";M.l<M.length;){var xe=M[M.l++];switch(xe){case 0:Q.push(M.read_shift(8,"f"));break;case 1:z=S(J[0].c,M.read_shift(2),!0),ue=S(J[0].r,M.read_shift(2),!1),Q.push(z+ue);break;case 2:{var Me=S(J[0].c,M.read_shift(2),!0),G=S(J[0].r,M.read_shift(2),!1);z=S(J[0].c,M.read_shift(2),!0),ue=S(J[0].r,M.read_shift(2),!1),Q.push(Me+G+":"+z+ue)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(M.read_shift(2));break;case 6:{for(var tt="";xe=M[M.l++];)tt+=String.fromCharCode(xe);Q.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:de=Q.pop(),te=Q.pop(),Q.push(["AND","OR"][xe-20]+"("+te+","+de+")");break;default:if(xe<32&&x[xe])de=Q.pop(),te=Q.pop(),Q.push(te+x[xe]+de);else if(w[xe]){if(Y=w[xe][1],Y==69&&(Y=M[M.l++]),Y>Q.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+Q.join("|")+"|");return}var nt=Q.slice(-Y);Q.length-=Y,Q.push(w[xe][0]+"("+nt.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}Q.length==1?J[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function A(M){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=M.read_shift(2),J[3]=M[M.l++],J[0].c=M[M.l++],J}function F(M,J){var Q=A(M);return Q[1].t="s",Q[1].v=M.read_shift(J-4,"cstr"),Q}function N(M,J,Q,Y){var ue=Fr(6+Y.length);ue.write_shift(2,M),ue.write_shift(1,Q),ue.write_shift(1,J),ue.write_shift(1,39);for(var z=0;z<Y.length;++z){var te=Y.charCodeAt(z);ue.write_shift(1,te>=128?95:te)}return ue.write_shift(1,0),ue}function P(M,J){var Q=A(M);Q[1].v=M.read_shift(2);var Y=Q[1].v>>1;if(Q[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return Q[1].v=Y,Q}function I(M,J){var Q=A(M),Y=M.read_shift(4),ue=M.read_shift(4),z=M.read_shift(2);if(z==65535)return Y===0&&ue===3221225472?(Q[1].t="e",Q[1].v=15):Y===0&&ue===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var te=z&32768;return z=(z&32767)-16446,Q[1].v=(1-te*2)*(ue*Math.pow(2,z+32)+Y*Math.pow(2,z)),Q}function b(M,J,Q,Y){var ue=Fr(14);if(ue.write_shift(2,M),ue.write_shift(1,Q),ue.write_shift(1,J),Y==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var z=0,te=0,de=0,xe=0;return Y<0&&(z=1,Y=-Y),te=Math.log2(Y)|0,Y/=Math.pow(2,te-31),xe=Y>>>0,xe&2147483648||(Y/=2,++te,xe=Y>>>0),Y-=xe,xe|=2147483648,xe>>>=0,Y*=Math.pow(2,32),de=Y>>>0,ue.write_shift(4,de),ue.write_shift(4,xe),te+=16383+(z?32768:0),ue.write_shift(2,te),ue}function O(M,J){var Q=I(M);return M.l+=J-14,Q}function L(M,J){var Q=A(M),Y=M.read_shift(4);return Q[1].v=Y>>6,Q}function K(M,J){var Q=A(M),Y=M.read_shift(8,"f");return Q[1].v=Y,Q}function ie(M,J){var Q=K(M);return M.l+=J-10,Q}function re(M,J){return M[M.l+J-1]==0?M.read_shift(J,"cstr"):""}function ke(M,J){var Q=M[M.l++];Q>J-1&&(Q=J-1);for(var Y="";Y.length<Q;)Y+=String.fromCharCode(M[M.l++]);return Y}function we(M,J,Q){if(!(!Q.qpro||J<21)){var Y=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ue=M.read_shift(J-21,"cstr");return[Y,ue]}}function oe(M,J){for(var Q={},Y=M.l+J;M.l<Y;){var ue=M.read_shift(2);if(ue==14e3){for(Q[ue]=[0,""],Q[ue][0]=M.read_shift(2);M[M.l];)Q[ue][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return Q}function X(M,J){var Q=Fr(5+M.length);Q.write_shift(2,14e3),Q.write_shift(2,J);for(var Y=0;Y<M.length;++Y){var ue=M.charCodeAt(Y);Q[Q.l++]=ue>127?95:ue}return Q[Q.l++]=0,Q}var he={0:{n:"BOF",f:wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function LA(e){var t={},r=e.match(Sn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=it(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=z2[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var MA=function(){var e=X0("t"),t=X0("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Nt(s[1])},u=a.match(t);return u&&(o.s=LA(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),BA=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),s.push("</"+u+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),jA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UA=/<(?:\w+:)?r>/,zA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ix(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(e),r&&(n.h=K2(n.t))):e.match(UA)&&(n.r=Xt(e),n.t=Nt(Xt((e.replace(zA,"").match(jA)||[]).join("").replace(Sn,""))),r&&(n.h=BA(MA(n.r)))),n):{t:""}}var VA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GA=/<(?:\w+:)?(?:si|sstItem)>/g,HA=/<\/(?:\w+:)?(?:si|sstItem)>/;function WA(e,t){var r=[],n="";if(!e)return r;var i=e.match(VA);if(i){n=i[2].replace(GA,"").split(HA);for(var a=0;a!=n.length;++a){var s=ix(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=it(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function $A(e){return[e.read_shift(4),e.read_shift(4)]}function XA(e,t){var r=[],n=!1;return Ka(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function KS(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ja(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function KA(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function YA(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function QA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YA(e));return t}function qA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function JA(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ja(e,4),t.U=ja(e,4),t.W=ja(e,4),t}function ZA(e){var t=JA(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function YS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function QS(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function eP(e){var t=ja(e);switch(t.Minor){case 2:return[t.Minor,tP(e)];case 3:return[t.Minor,rP()];case 4:return[t.Minor,nP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function tP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=YS(e,r),i=QS(e,e.length-e.l);return{t:"Std",h:n,v:i}}function rP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function nP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Sn,function(a){var s=it(a);switch(xa(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function iP(e,t){var r={},n=r.EncryptionVersionInfo=ja(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=YS(e,i),t-=i,r.EncryptionVerifier=QS(e,t),r}function aP(e){var t={},r=t.EncryptionVersionInfo=ja(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function sP(e){var t=0,r,n=KS(e),i=n.length+1,a,s,o,u,f;for(r=Ds(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,u=t<<1&32767,f=o|u,t=f^s;return t^52811}var qS=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],u=104,f=s.length-1;f>=0;--f)for(var d=s[f],p=0;p!=7;++p)d&64&&(o^=r[u]),d*=2,--u;return o};return function(s){for(var o=KS(s),u=a(o),f=o.length,d=Ds(16),p=0;p!=16;++p)d[p]=0;var g,v,m;for((f&1)===1&&(g=u>>8,d[f]=i(e[0],g),--f,g=u&255,v=o[o.length-1],d[f]=i(v,g));f>0;)--f,g=u>>8,d[f]=i(o[f],g),--f,g=u&255,d[f]=i(o[f],g);for(f=15,m=15-o.length;m>0;)g=u>>8,d[f]=i(e[m],g),--f,--m,g=u&255,d[f]=i(o[f],g),--f,--m;return d}}(),oP=function(e,t,r,n,i){i||(i=t),n||(n=qS(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},lP=function(e){var t=0,r=qS(e);return function(n){var i=oP("",n,t,r);return t=i[1],i[0]}};function cP(e,t,r,n){var i={key:wr(e),verificationBytes:wr(e)};return r.password&&(i.verifier=sP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=lP(r.password)),i}function uP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=aP(e):n.Data=iP(e,t),n}function fP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?uP(e,t-2,n):cP(e,r.biff>=8?t:t-2,r,n),n}var dP=function(){function e(i,a){switch(a.type){case"base64":return t(ni(i),a);case"binary":return t(i,a);case"buffer":return t(kt&&Buffer.isBuffer(i)?i.toString("binary"):Io(i),a);case"array":return t(Ao(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,v=0,m,y=-1;m=g.exec(d);){switch(m[0]){case"\\cell":var C=d.slice(v,g.lastIndex-m[0].length);if(C[0]==" "&&(C=C.slice(1)),++y,C.length){var S={v:C,t:"s"};Array.isArray(o)?o[p][y]=S:o[ct({r:p,c:y})]=S}break}v=g.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=At(f),o}function r(i,a){return Us(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=dr(i["!ref"]),o,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var p=ct({r:f,c:d});o=u?(i[f]||[])[d]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||($a(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function hP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Q0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function pP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,u=0,f=i+a;switch(u=s/(f>1?2-f:f),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,u,f/2]}function gP(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,s[0]+=i,s[1]+=u;break;case 1:u=i*(2-o),s[0]+=u,s[1]+=i;break;case 2:u=i*(o-2),s[1]+=i,s[2]+=u;break;case 3:u=i*(4-o),s[1]+=u,s[2]+=i;break;case 4:u=i*(o-4),s[2]+=i,s[0]+=u;break;case 5:u=i*(6-o),s[2]+=u,s[0]+=i;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Ud(e,t){if(t===0)return e;var r=pP(hP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Q0(gP(r))}var JS=6,mP=15,xP=1,Pn=JS;function zd(e){return Math.floor((e+Math.round(128/Pn)/256)*Pn)}function Vd(e){return Math.floor((e-5)/Pn*100+.5)/100}function Am(e){return Math.round((e*Pn+5)/Pn*256)/256}function ig(e){return Am(Vd(zd(e)))}function ax(e){var t=Math.abs(e-ig(e)),r=Pn;if(t>.005)for(Pn=xP;Pn<mP;++Pn)Math.abs(e-ig(e))<=t&&(t=Math.abs(e-ig(e)),r=Pn);Pn=r}function ql(e){e.width?(e.wpx=zd(e.width),e.wch=Vd(e.wpx),e.MDW=Pn):e.wpx?(e.wch=Vd(e.wpx),e.width=Am(e.wch),e.MDW=Pn):typeof e.wch=="number"&&(e.width=Am(e.wch),e.wpx=zd(e.width),e.MDW=Pn),e.customWidth&&delete e.customWidth}var vP=96,ZS=vP;function e8(e){return e*96/ZS}function q0(e){return e*ZS/96}var yP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _P(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(xa(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function SP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(xa(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function wP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Sn)||[]).forEach(function(s){var o=it(s);switch(xa(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Xt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Zt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Zt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Zt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Zt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Zt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Zt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=z2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Zt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=yo[i.color.index];i.color.index==81&&(u=yo[1]),u||(u=yo[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Ud(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kP(e,t,r){t.NumberFmt=[];for(var n=ma(ht),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ht[n[i]];var a=e[0].match(Sn);if(a)for(i=0;i<a.length;++i){var s=it(a[i]);switch(xa(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Nt(Xt(s.formatCode)),u=parseInt(s.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}vo(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Mf=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function EP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Sn)||[]).forEach(function(a){var s=it(a),o=0;switch(xa(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<Mf.length;++o)n[Mf[o]]&&(n[Mf[o]]=parseInt(n[Mf[o]],10));for(o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=Zt(n[Bf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};s.vertical&&(u.vertical=s.vertical),s.horizontal&&(u.horizontal=s.horizontal),s.textRotation!=null&&(u.textRotation=s.textRotation),s.indent&&(u.indent=s.indent),s.wrapText&&(u.wrapText=Zt(s.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var CP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&kP(p,d,f),(p=o.match(i))&&wP(p,d,u,f),(p=o.match(n))&&SP(p,d,u,f),(p=o.match(a))&&_P(p,d,u,f),(p=o.match(r))&&EP(p,d,f),d}}();function TP(e,t){var r=e.read_shift(2),n=vn(e);return[r,n]}function AP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=M7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=L7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vn(e),n}var PP=_n;function FP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var NP=_n;function RP(e,t,r){var n={};n.NumberFmt=[];for(var i in ht)n.NumberFmt[i]=ht[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return Ka(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],vo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Ud(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var bP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function IP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Sn)||[]).forEach(function(i){var a=it(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[bP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function DP(){}function OP(){}var LP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jP(e,t,r){t.themeElements={};var n;[["clrScheme",LP,IP],["fontScheme",MP,DP],["fmtScheme",BP,OP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var UP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function t8(e,t){(!e||e.length===0)&&(e=zP());var r,n={};if(!(r=e.match(UP)))throw new Error("themeElements not found in theme");return jP(r[0],n,t),n.raw=e,n}function zP(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[dS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function VP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=fS(a,{type:"array"})}catch{return}var o=Jn(s,"theme/theme/theme1.xml",!0);if(o)return t8(o,r)}}function GP(e){return e.read_shift(4)}function HP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=WP(e,4);break;case 2:t.xclrValue=zS(e);break;case 3:t.xclrValue=GP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function WP(e,t){return _n(e,t)}function $P(e,t){return _n(e,t)}function XP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=HP(e);break;case 6:n[1]=$P(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(XP(e,r-e.l));return{ixfe:n,ext:a}}function YP(e,t){t.forEach(function(r){switch(r[0]){}})}function QP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:vn(e)}}function qP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JP(e){return e.l+=4,e.read_shift(4)!=0}function ZP(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return Ka(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!f.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function eF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(Sn,function(o){var u=it(o);switch(xa(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function tF(e){var t=[];if(!e)return t;var r=1;return(e.match(Sn)||[]).forEach(function(n){var i=it(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function rF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ct(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function nF(e,t,r){var n=[];return Ka(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function iF(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Ka(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function aF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function m3(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=Fn(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var u=dr(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=At(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}a.c.push(d)})}function sF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=it(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Fn(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&ix(p[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function oF(e,t){var r=[],n=!1,i={},a=0;return e.replace(Sn,function(o,u){var f=it(o);switch(xa(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+o.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function lF(e,t){var r=[],n=!1;return e.replace(Sn,function(a){var s=it(a);switch(xa(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function cF(e){var t={};t.iauthor=e.read_shift(4);var r=Oo(e);return t.rfx=r.s,t.ref=ct(r.s),e.l+=16,t}var uF=vn;function fF(e,t){var r=[],n=[],i={},a=!1;return Ka(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var dF="application/vnd.ms-office.vbaProject";function hF(e){var t=Tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Tt.write(t)}function pF(){return{"!type":"dialog"}}function gF(){return{"!type":"dialog"}}function mF(){return{"!type":"macro"}}function xF(){return{"!type":"macro"}}var Ml=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,i+(o?"":"$")+br(d)+(u?"":"$")+Zr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),r8=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vF=function(){return function(t,r){return t.replace(r8,function(n,i,a,s,o,u){var f=J2(s)-(a?0:r.c),d=q2(u)-(o?0:r.r),p=d==0?"":o?d+1:"["+d+"]",g=f==0?"":a?f+1:"["+f+"]";return i+"R"+p+"C"+g})}}();function n8(e,t){return e.replace(r8,function(r,n,i,a,s,o){return n+(i=="$"?i+a:br(J2(a)+t.c))+(s=="$"?s+o:Zr(q2(o)+t.r))})}function yF(e,t,r){var n=ac(t),i=n.s,a=Fn(r),s={r:a.r-i.r,c:a.c-i.c};return n8(e,s)}function _F(e){return e.length!=1}function x3(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function Os(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function i8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return a8(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=Os(e,2),o=Os(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function a8(e){var t=Os(e,2),r=Os(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function SF(e,t,r){if(r.biff<8)return a8(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Os(e,2),s=Os(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function s8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return wF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Os(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function wF(e){var t=Os(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function EF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return CF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function CF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function TF(e,t,r){var n=(e[e.l++]&96)>>5,i=i8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=i8(e,a,r);return[n,i,s]}function PF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function NF(e,t,r){var n=(e[e.l++]&96)>>5,i=SF(e,t-1,r);return[n,i]}function RF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function bF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function IF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function DF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function LF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function o8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MF(e){return e.read_shift(2),o8(e)}function BF(e){return e.read_shift(2),o8(e)}function jF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=s8(e,0,r);return[n,i]}function UF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=EF(e,0,r);return[n,i]}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=s8(e,0,r);return[n,i,a]}function VF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[GN[i],u8[i],n]}function GF(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HF(e);return[i,(a[0]===0?u8:VN)[a[1]]]}function HF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WF(e,t,r){e.l+=r&&r.biff==2?3:4}function $F(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function XF(e){return e.l++,Lo[e.read_shift(1)]}function KF(e){return e.l++,e.read_shift(2)}function YF(e){return e.l++,e.read_shift(1)!==0}function QF(e){return e.l++,mn(e)}function qF(e,t,r){return e.l++,uu(e,t-1,r)}function JF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Lo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=mn(e);break;case 2:r[1]=Mo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ZF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Oo:_h)(e));return i}function eN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=JF(e,r.biff);return s}function tN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function rN(e,t,r){if(r.biff==5)return nN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function nN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function iN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aN(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sN(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function oN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var lN=_n,cN=_n,uN=_n;function du(e,t,r){return e.l+=2,[kF(e)]}function sx(e){return e.l+=6,[]}var fN=du,dN=sx,hN=sx,pN=du;function l8(e){return e.l+=2,[wr(e),e.read_shift(2)&1]}var gN=du,mN=l8,xN=sx,vN=du,yN=du,_N=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=_N[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function wN(e){return e.l+=2,[e.read_shift(4)]}function kN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function EN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AN(e){return e.l+=4,[0,0]}var y3={1:{n:"PtgExp",f:$F},2:{n:"PtgTbl",f:uN},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:qF},26:{n:"PtgSheet",f:kN},27:{n:"PtgEndSheet",f:EN},28:{n:"PtgErr",f:XF},29:{n:"PtgBool",f:YF},30:{n:"PtgInt",f:KF},31:{n:"PtgNum",f:QF},32:{n:"PtgArray",f:RF},33:{n:"PtgFunc",f:VF},34:{n:"PtgFuncVar",f:GF},35:{n:"PtgName",f:tN},36:{n:"PtgRef",f:jF},37:{n:"PtgArea",f:TF},38:{n:"PtgMemArea",f:iN},39:{n:"PtgMemErr",f:lN},40:{n:"PtgMemNoMem",f:cN},41:{n:"PtgMemFunc",f:aN},42:{n:"PtgRefErr",f:sN},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:UF},45:{n:"PtgAreaN",f:NF},46:{n:"PtgMemAreaN",f:CN},47:{n:"PtgMemNoMemN",f:TN},57:{n:"PtgNameX",f:rN},58:{n:"PtgRef3d",f:zF},59:{n:"PtgArea3d",f:AF},60:{n:"PtgRefErr3d",f:oN},61:{n:"PtgAreaErr3d",f:FF},255:{}},PN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FN={1:{n:"PtgElfLel",f:l8},2:{n:"PtgElfRw",f:vN},3:{n:"PtgElfCol",f:fN},6:{n:"PtgElfRwV",f:yN},7:{n:"PtgElfColV",f:pN},10:{n:"PtgElfRadical",f:gN},11:{n:"PtgElfRadicalS",f:xN},13:{n:"PtgElfColS",f:dN},15:{n:"PtgElfColSV",f:hN},16:{n:"PtgElfRadicalLel",f:mN},25:{n:"PtgList",f:SN},29:{n:"PtgSxName",f:wN},255:{}},NN={0:{n:"PtgAttrNoop",f:AN},1:{n:"PtgAttrSemi",f:LF},2:{n:"PtgAttrIf",f:DF},4:{n:"PtgAttrChoose",f:bF},8:{n:"PtgAttrGoto",f:IF},16:{n:"PtgAttrSum",f:WF},32:{n:"PtgAttrBaxcel",f:v3},33:{n:"PtgAttrBaxcel",f:v3},64:{n:"PtgAttrSpace",f:MF},65:{n:"PtgAttrSpaceSemi",f:BF},128:{n:"PtgAttrIfError",f:OF},255:{}};function hu(e,t,r,n){if(n.biff<8)return _n(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=eN(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ZF(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(_n(e,t)),a}function pu(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=y3[a]||y3[PN[a]],(a===24||a===25)&&(i=(a===24?FN:NN)[e[e.l+1]]),!i||!i.f?_n(e,t):s.push([i.n,i.f(e,t,r)]);return s}function RN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var bN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function c8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _3(e,t,r){var n=c8(e,t,r);return n=="#REF"?n:IN(n,r)}function pn(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],u,f,d,p=0,g=0,v,m="";if(!e[0]||!e[0][0])return"";for(var y=-1,C="",S=0,w=e[0].length;S<w;++S){var x=e[0][S];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:C=ur(" ",e[0][y][1][1]);break;case 1:C=ur("\r",e[0][y][1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+C,y=-1}o.push(f+bN[x[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=x0(x[1][1],s,i),o.push(v0(d,a));break;case"PtgRefN":d=r?x0(x[1][1],r,i):x[1][1],o.push(v0(d,a));break;case"PtgRef3d":p=x[1][1],d=x0(x[1][2],s,i),m=_3(n,p,i),o.push(m+"!"+v0(d,a));break;case"PtgFunc":case"PtgFuncVar":var T=x[1][0],A=x[1][1];T||(T=0),T&=127;var F=T==0?[]:o.slice(-T);o.length-=T,A==="User"&&(A=F.shift()),o.push(A+"("+F.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":v=e3(x[1][1],r?{s:r}:s,i),o.push(rg(v,i));break;case"PtgArea":v=e3(x[1][1],s,i),o.push(rg(v,i));break;case"PtgArea3d":p=x[1][1],v=x[1][2],m=_3(n,p,i),o.push(m+"!"+rg(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=x[1][2];var N=(n.names||[])[g-1]||(n[0]||[])[g],P=N?N.Name:"SH33TJSNAME"+String(g);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var I=x[1][1];g=x[1][2];var b;if(i.biff<=5)I<0&&(I=-I),n[I]&&(b=n[I][g]);else{var O="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][g]&&n[I][g].itab>0&&(O=n.SheetNames[n[I][g].itab-1]+"!"):O=n.SheetNames[g-1]+"!"),n[I]&&n[I][g])O+=n[I][g].Name;else if(n[0]&&n[0][g])O+=n[0][g].Name;else{var L=(c8(n,I,i)||"").split(";;");L[g-1]?O=L[g-1]:O+="SH33TJSERRX"}o.push(O);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var K="(",ie=")";if(y>=0){switch(C="",e[0][y][1][0]){case 2:K=ur(" ",e[0][y][1][1])+K;break;case 3:K=ur("\r",e[0][y][1][1])+K;break;case 4:ie=ur(" ",e[0][y][1][1])+ie;break;case 5:ie=ur("\r",e[0][y][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(K+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[ct(d)]){var ke=n.sharedf[ct(d)];o.push(pn(ke,s,re,n,i))}else{var we=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(pn(f[1],s,re,n,i)),we=!0;break}we||o.push(x[1])}break;case"PtgArray":o.push("{"+RN(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&oe.indexOf(e[0][S][0])==-1){x=e[0][y];var X=!0;switch(x[1][0]){case 4:X=!1;case 0:C=ur(" ",x[1][1]);break;case 5:X=!1;case 1:C=ur("\r",x[1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((X?C:"")+o.pop()+(X?"":C)),y=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function DN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],_n(e,t-2)];var o=pu(e,s,r);return t!==s+i&&(a=hu(e,t-s-i,o,r)),e.l=n,[o,a]}function ON(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],_n(e,t-2)];var o=pu(e,s,r);return t!==s+i&&(a=hu(e,t-s-i,o,r)),e.l=n,[o,a]}function LN(e,t,r,n){var i=e.l+t,a=pu(e,n,r),s;return i!==e.l&&(s=hu(e,i-e.l,a,r)),[a,s]}function MN(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=pu(e,a,r);return a==65535?[[],_n(e,t-2)]:(t!==a+2&&(i=hu(e,n-a-2,s,r)),[s,i])}function BN(e){var t;if(La(e,e.l+6)!==65535)return[mn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function ag(e,t,r){var n=e.l+t,i=va(e);r.biff==2&&++e.l;var a=BN(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=ON(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function Sh(e,t,r){var n=e.read_shift(4),i=pu(e,n,r),a=e.read_shift(4),s=a>0?hu(e,a,i,r):null;return[i,s]}var jN=Sh,wh=Sh,UN=Sh,zN=Sh,VN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},u8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function S3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function sg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var w0={},Bl={};function k0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function f8(e,t,r,n,i,a){try{n.cellNF&&(e.z=ht[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ht[t]==null&&vo(WC[t]||"General",t),e.t==="e")e.w=e.w||Lo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v);else if(e.t==="d"){var s=bn(e.v);(s|0)===s?e.w=s.toString(10):e.w=$0(s)}else{if(e.v===void 0)return"";e.w=To(e.v,Bl)}else e.t==="d"?e.w=Pi(t,bn(e.v),Bl):e.w=Pi(t,e.v,Bl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ud(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ud(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function HN(e,t){var r=dr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=At(r))}var WN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,$N=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XN=/<(?:\w:)?hyperlink [^>]*>/mg,KN=/"(\w*:\w*)"/,YN=/<(?:\w:)?col\b[^>]*[\/]?>/g,QN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qN=/<(?:\w:)?pageMargins[^>]*\/>/g,d8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,JN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function eR(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match($N);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var g=f.match(d8);g?ox(g[0],o,i,r):(g=f.match(JN))&&tR(g[0],g[1]||"",o,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var m=f.slice(v,v+50).match(KN);m&&HN(o,m[1])}var y=f.match(ZN);y&&y[1]&&oR(y[1],i);var C=[];if(t.cellStyles){var S=f.match(YN);S&&iR(C,S)}p&&lR(p[1],o,t,u,a,s);var w=d.match(QN);w&&(o["!autofilter"]=aR(w[0]));var x=[],T=d.match(WN);if(T)for(v=0;v!=T.length;++v)x[v]=dr(T[v].slice(T[v].indexOf('"')+1));var A=d.match(XN);A&&rR(o,A,n);var F=d.match(qN);if(F&&(o["!margins"]=nR(it(F[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=At(u)),t.sheetRows>0&&o["!ref"]){var N=dr(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>u.e.r&&(N.e.r=u.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>u.e.c&&(N.e.c=u.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=At(N))}return C.length>0&&(o["!cols"]=C),x.length>0&&(o["!merges"]=x),o}function ox(e,t,r,n){var i=it(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Xt(i.codeName)))}function tR(e,t,r,n,i){ox(e.slice(0,e.indexOf(">")),r,n,i)}function rR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=it(Xt(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Nt(a.location))):(a.Target="#"+Nt(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=dr(a.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=ct({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function nR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function iR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=it(t[n],!0);i.hidden&&(i.hidden=Zt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ax(i.width)),ql(i);a<=s;)e[a++]=Jr(i)}}function aR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var sR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oR(e,t){t.Views||(t.Views=[{}]),(e.match(sR)||[]).forEach(function(r,n){var i=it(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Zt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var lR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=X0("v"),s=X0("f");return function(u,f,d,p,g,v){for(var m=0,y="",C=[],S=[],w=0,x=0,T=0,A="",F,N,P=0,I=0,b,O,L=0,K=0,ie=Array.isArray(v.CellXf),re,ke=[],we=[],oe=Array.isArray(f),X=[],he={},_e=!1,M=!!d.sheetStubs,J=u.split(t),Q=0,Y=J.length;Q!=Y;++Q){y=J[Q].trim();var ue=y.length;if(ue!==0){var z=0;e:for(m=0;m<ue;++m)switch(y[m]){case">":if(y[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(N=it(y.slice(z,m),!0),P=N.r!=null?parseInt(N.r,10):P+1,I=-1,d.sheetRows&&d.sheetRows<P)continue;he={},_e=!1,N.ht&&(_e=!0,he.hpt=parseFloat(N.ht),he.hpx=q0(he.hpt)),N.hidden=="1"&&(_e=!0,he.hidden=!0),N.outlineLevel!=null&&(_e=!0,he.level=+N.outlineLevel),_e&&(X[P-1]=he)}break;case"<":z=m;break}if(z>=m)break;if(N=it(y.slice(z,m),!0),P=N.r!=null?parseInt(N.r,10):P+1,I=-1,!(d.sheetRows&&d.sheetRows<P)){p.s.r>P-1&&(p.s.r=P-1),p.e.r<P-1&&(p.e.r=P-1),d&&d.cellStyles&&(he={},_e=!1,N.ht&&(_e=!0,he.hpt=parseFloat(N.ht),he.hpx=q0(he.hpt)),N.hidden=="1"&&(_e=!0,he.hidden=!0),N.outlineLevel!=null&&(_e=!0,he.level=+N.outlineLevel),_e&&(X[P-1]=he)),C=y.slice(m).split(e);for(var te=0;te!=C.length&&C[te].trim().charAt(0)=="<";++te);for(C=C.slice(te),m=0;m!=C.length;++m)if(y=C[m].trim(),y.length!==0){if(S=y.match(r),w=m,x=0,T=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,S!=null&&S.length===2){for(w=0,A=S[1],x=0;x!=A.length&&!((T=A.charCodeAt(x)-64)<1||T>26);++x)w=26*w+T;--w,I=w}else++I;for(x=0;x!=y.length&&y.charCodeAt(x)!==62;++x);if(++x,N=it(y.slice(0,x),!0),N.r||(N.r=ct({r:P-1,c:I})),A=y.slice(x),F={t:""},(S=A.match(a))!=null&&S[1]!==""&&(F.v=Nt(S[1])),d.cellFormula){if((S=A.match(s))!=null&&S[1]!==""){if(F.f=Nt(Xt(S[1])).replace(/\r\n/g,`
`),d.xlfn||(F.f=x3(F.f)),S[0].indexOf('t="array"')>-1)F.F=(A.match(i)||[])[1],F.F.indexOf(":")>-1&&ke.push([dr(F.F),F.F]);else if(S[0].indexOf('t="shared"')>-1){O=it(S[0]);var de=Nt(Xt(S[1]));d.xlfn||(de=x3(de)),we[parseInt(O.si,10)]=[O,de,N.r]}}else(S=A.match(/<f[^>]*\/>/))&&(O=it(S[0]),we[O.si]&&(F.f=yF(we[O.si][1],we[O.si][2],N.r)));var xe=Fn(N.r);for(x=0;x<ke.length;++x)xe.r>=ke[x][0].s.r&&xe.r<=ke[x][0].e.r&&xe.c>=ke[x][0].s.c&&xe.c<=ke[x][0].e.c&&(F.F=ke[x][1])}if(N.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(M)F.t="z";else continue;else F.t=N.t||"n";switch(p.s.c>I&&(p.s.c=I),p.e.c<I&&(p.e.c=I),F.t){case"n":if(F.v==""||F.v==null){if(!M)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!M)continue;F.t="z"}else b=w0[parseInt(F.v,10)],F.v=b.t,F.r=b.r,d.cellHTML&&(F.h=b.h);break;case"str":F.t="s",F.v=F.v!=null?Xt(F.v):"",d.cellHTML&&(F.h=K2(F.v));break;case"inlineStr":S=A.match(n),F.t="s",S!=null&&(b=ix(S[1]))?(F.v=b.t,d.cellHTML&&(F.h=b.h)):F.v="";break;case"b":F.v=Zt(F.v);break;case"d":d.cellDates?F.v=$r(F.v,1):(F.v=bn($r(F.v,1)),F.t="n");break;case"e":(!d||d.cellText!==!1)&&(F.w=F.v),F.v=IS[F.v];break}if(L=K=0,re=null,ie&&N.s!==void 0&&(re=v.CellXf[N.s],re!=null&&(re.numFmtId!=null&&(L=re.numFmtId),d.cellStyles&&re.fillId!=null&&(K=re.fillId))),f8(F,L,K,d,g,v),d.cellDates&&ie&&F.t=="n"&&ic(ht[L])&&(F.t="d",F.v=yh(F.v)),N.cm&&d.xlmeta){var Me=(d.xlmeta.Cell||[])[+N.cm-1];Me&&Me.type=="XLDAPR"&&(F.D=!0)}if(oe){var G=Fn(N.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=F}else f[N.r]=F}}}}X.length>0&&(f["!rows"]=X)}}();function cR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var uR=Oo;function fR(){}function dR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=D7(e),r}function hR(e){var t=Fi(e);return[t]}function pR(e){var t=Do(e);return[t]}function gR(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"b"]}function mR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"b"]}function xR(e){var t=Fi(e),r=e.read_shift(1);return[t,r,"e"]}function vR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"e"]}function yR(e){var t=Fi(e),r=e.read_shift(4);return[t,r,"s"]}function _R(e){var t=Do(e),r=e.read_shift(4);return[t,r,"s"]}function SR(e){var t=Fi(e),r=mn(e);return[t,r,"n"]}function h8(e){var t=Do(e),r=mn(e);return[t,r,"n"]}function wR(e){var t=Fi(e),r=tx(e);return[t,r,"n"]}function kR(e){var t=Do(e),r=tx(e);return[t,r,"n"]}function ER(e){var t=Fi(e),r=Z2(e);return[t,r,"is"]}function CR(e){var t=Fi(e),r=vn(e);return[t,r,"str"]}function TR(e){var t=Do(e),r=vn(e);return[t,r,"str"]}function AR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=wh(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function PR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=wh(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function FR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=mn(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=wh(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}function NR(e,t,r){var n=e.l+t,i=Fi(e);i.r=r["!row"];var a=vn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=wh(e,n-e.l,r);s[3]=pn(o,null,i,r.supbooks,r)}else e.l=n;return s}var RR=Oo;function bR(e,t){var r=e.l+t,n=Oo(e),i=ex(e),a=vn(e),s=vn(e),o=vn(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:o};return s&&(u.Tooltip=s),u}function IR(){}function DR(e,t,r){var n=e.l+t,i=NS(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=jN(e,n-e.l,r);s[1]=o}else e.l=n;return s}function OR(e,t,r){var n=e.l+t,i=Oo(e),a=[i];if(r.cellFormula){var s=zN(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}var LR=["left","right","top","bottom","header","footer"];function MR(e){var t={};return LR.forEach(function(r){t[r]=mn(e)}),t}function BR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function jR(){}function UR(){}function zR(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,v,m,y,C,S,w,x,T,A,F=[];o.biff=12,o["!row"]=0;var N=0,P=!1,I=[],b={},O=o.supbooks||i.supbooks||[[]];if(O.sharedf=b,O.arrayf=I,O.SheetNames=i.SheetNames||i.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=O,i.Names))for(var L=0;L<i.Names.length;++L)O[0][L+1]=i.Names[L];var K=[],ie=[],re=!1;Gd[16]={n:"BrtShortReal",f:h8};var ke;if(Ka(e,function(X,he,_e){if(!g)switch(_e){case 148:f=X;break;case 0:v=X,o.sheetRows&&o.sheetRows<=v.r&&(g=!0),T=Zr(C=v.r),o["!row"]=v.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=q0(X.hpt)),ie[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:X[2]},X[2]){case"n":m.v=X[1];break;case"s":x=w0[X[1]],m.v=x.t,m.r=x.r;break;case"b":m.v=!!X[1];break;case"e":m.v=X[1],o.cellText!==!1&&(m.w=Lo[m.v]);break;case"str":m.t="s",m.v=X[1];break;case"is":m.t="s",m.v=X[1].t;break}if((y=s.CellXf[X[0].iStyleRef])&&f8(m,y.numFmtId,null,o,a,s),S=X[0].c==-1?S+1:X[0].c,o.dense?(u[C]||(u[C]=[]),u[C][S]=m):u[br(S)+T]=m,o.cellFormula){for(P=!1,N=0;N<I.length;++N){var M=I[N];v.r>=M[0].s.r&&v.r<=M[0].e.r&&S>=M[0].s.c&&S<=M[0].e.c&&(m.F=At(M[0]),P=!0)}!P&&X.length>3&&(m.f=X[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>S&&(d.s.c=S),d.e.r<v.r&&(d.e.r=v.r),d.e.c<S&&(d.e.c=S),o.cellDates&&y&&m.t=="n"&&ic(ht[y.numFmtId])){var J=po(m.v);J&&(m.t="d",m.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ke&&(ke.type=="XLDAPR"&&(m.D=!0),ke=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;m={t:"z",v:void 0},S=X[0].c==-1?S+1:X[0].c,o.dense?(u[C]||(u[C]=[]),u[C][S]=m):u[br(S)+T]=m,d.s.r>v.r&&(d.s.r=v.r),d.s.c>S&&(d.s.c=S),d.e.r<v.r&&(d.e.r=v.r),d.e.c<S&&(d.e.c=S),ke&&(ke.type=="XLDAPR"&&(m.D=!0),ke=void 0);break;case 176:F.push(X);break;case 49:ke=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var Q=n["!id"][X.relId];for(Q?(X.Target=Q.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=Q):X.relId==""&&(X.Target="#"+X.loc),C=X.rfx.s.r;C<=X.rfx.e.r;++C)for(S=X.rfx.s.c;S<=X.rfx.e.c;++S)o.dense?(u[C]||(u[C]=[]),u[C][S]||(u[C][S]={t:"z",v:void 0}),u[C][S].l=X):(w=ct({c:S,r:C}),u[w]||(u[w]={t:"z",v:void 0}),u[w].l=X);break;case 426:if(!o.cellFormula)break;I.push(X),A=o.dense?u[C][S]:u[br(S)+T],A.f=pn(X[1],d,{r:v.r,c:S},O,o),A.F=At(X[0]);break;case 427:if(!o.cellFormula)break;b[ct(X[0].s)]=X[1],A=o.dense?u[C][S]:u[br(S)+T],A.f=pn(X[1],d,{r:v.r,c:S},O,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)K[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},re||(re=!0,ax(X.w/256)),ql(K[X.e+1]);break;case 161:u["!autofilter"]={ref:At(X)};break;case 476:u["!margins"]=X;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),X.name&&(i.Sheets[r].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!he.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=At(f||d)),o.sheetRows&&u["!ref"]){var we=dr(u["!ref"]);o.sheetRows<=+we.e.r&&(we.e.r=o.sheetRows-1,we.e.r>d.e.r&&(we.e.r=d.e.r),we.e.r<we.s.r&&(we.s.r=we.e.r),we.e.c>d.e.c&&(we.e.c=d.e.c),we.e.c<we.s.c&&(we.s.c=we.e.c),u["!fullref"]=u["!ref"],u["!ref"]=At(we))}return F.length>0&&(u["!merges"]=F),K.length>0&&(u["!cols"]=K),ie.length>0&&(u["!rows"]=ie),u}function VR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function GR(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=VR(p);d.s.r=d.s.c=0,d.e.c=o,f=br(o),g[0].forEach(function(v,m){s[f+Zr(m)]={t:"n",v,z:g[1]},u=m}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(s["!ref"]=At(d)),s}function HR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(d8);return o&&ox(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function WR(e,t){e.l+=10;var r=vn(e);return{name:r}}function $R(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Ka(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var p8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],XR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KR=[],YR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Zt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function k3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Zt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function g8(e){k3(e.WBProps,p8),k3(e.CalcPr,YR),w3(e.WBView,XR),w3(e.Sheets,KR),Bl.date1904=Zt(e.WBProps.date1904)}var QR="][*?/\\".split("");function qR(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return QR.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var JR=/<\w+:workbook/;function ZR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(Sn,function(u,f){var d=it(u);switch(xa(d[0])){case"<?xml":break;case"<workbook":u.match(JR)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":p8.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Zt(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=Xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Nt(Xt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Xt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Zt(d.hidden||"0")&&(a.Hidden=!0),s=f+u.length;break;case"</definedName>":a.Ref=Nt(Xt(e.slice(s,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),x7.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return g8(r),r}function eb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Em(e),r.name=vn(e),r}function tb(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?vn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rb(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nb(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=O7(e),s=UN(e,0,r),o=ex(e);e.l=n;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function ib(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Gd[16]={n:"BrtFRTArchID$",f:rb},Ka(e,function(u,f,d){switch(d){case 156:s.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=pn(u.Ptg,null,null,s,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,u]):s[0]=[d,u],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(u),s.XTI=s.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),g8(r),r.Names=a,r.supbooks=s,r}function ab(e,t,r){return t.slice(-4)===".bin"?ib(e,r):ZR(e,r)}function sb(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?zR(e,n,r,i,a,s,o):eR(e,n,r,i,a,s,o)}function ob(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?$R(e,n,r,i,a):HR(e,n,r,i,a)}function lb(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?mF():xF()}function cb(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?pF():gF()}function ub(e,t,r,n){return t.slice(-4)===".bin"?RP(e,r,n):CP(e,r,n)}function fb(e,t,r){return t8(e,r)}function db(e,t,r){return t.slice(-4)===".bin"?XA(e,r):WA(e,r)}function hb(e,t,r){return t.slice(-4)===".bin"?fF(e,r):sF(e,r)}function pb(e,t,r){return t.slice(-4)===".bin"?nF(e):tF(e)}function gb(e,t,r,n){return r.slice(-4)===".bin"?iF(e,t,r,n):void 0}function mb(e,t,r){return t.slice(-4)===".bin"?ZP(e,t,r):eF(e,t,r)}var m8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,x8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(m8),a,s,o,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(x8),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function xb(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(m8),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(x8),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var E0;function vb(e,t){var r=E0[e]||Nt(e);return r==="General"?To(t):Pi(r,t)}function yb(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Zt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=$r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=i}function _b(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Lo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=vb(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=E0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ic(n)){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function Sb(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=yP[n.Pattern]||n.Pattern)}e[t.ID]=t}function wb(e,t,r,n,i,a,s,o,u,f){var d="General",p=n.StyleID,g={};f=f||{};var v=[],m=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);a[p]!==void 0&&(a[p].nf&&(d=a[p].nf),a[p].Interior&&v.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(e);break;case"String":n.t="s",n.r=Wy(Nt(e)),n.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=IS[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Wy(t||e));break}if(_b(n,d,f),f.cellFormula!==!1)if(n.Formula){var y=Nt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Ml(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ml("RC:RC",i):n.ArrayRange&&(n.F=Ml(n.ArrayRange,i),u.push([dr(n.F),n.F]))}else for(m=0;m<u.length;++m)i.r>=u[m][0].s.r&&i.r<=u[m][0].e.r&&i.c>=u[m][0].s.c&&i.c<=u[m][0].e.c&&(n.F=u[m][1]);f.cellStyles&&(v.forEach(function(C){!g.patternType&&C.patternType&&(g.patternType=C.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kb(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function og(e,t){var r=t||{};iS();var n=t0(Y2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Xt(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Jr(r);return s.type="string",Y0.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){i.indexOf("<"+Ct)>=0&&(a=!0)}),a)return bb(n,r);E0={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},p=[],g=r.dense?[]:{},v="",m={},y={},C=Bi('<Data ss:Type="String">'),S=0,w=0,x=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},F={},N="",P=0,I=[],b={},O={},L=0,K=[],ie=[],re={},ke=[],we,oe=!1,X=[],he=[],_e={},M=0,J=0,Q={Sheets:[],WBProps:{date1904:!1}},Y={};K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";o=K0.exec(n);)switch(o[3]=(ue=o[3]).toLowerCase()){case"data":if(ue=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?wb(n.slice(S,o.index),N,C,u[u.length-1][0]=="comment"?re:m,{c:w,r:x},A,ke[w],y,X,r):(N="",C=Bi(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ie.length>0&&(m.c=ie),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(g[x]||(g[x]=[]),g[x][w]=m):g[br(w)+Zr(x)]=m),m.HRef&&(m.l={Target:Nt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(M=w+(parseInt(m.MergeAcross,10)|0),J=x+(parseInt(m.MergeDown,10)|0),I.push({s:{c:w,r:x},e:{c:M,r:J}})),!r.sheetStubs)m.MergeAcross?w=M+1:++w;else if(m.MergeAcross||m.MergeDown){for(var z=w;z<=M;++z)for(var te=x;te<=J;++te)(z>w||te>x)&&(r.dense?(g[te]||(g[te]=[]),g[te][z]={t:"z"}):g[br(z)+Zr(te)]={t:"z"});w=M+1}else++w;else m=xb(o[0]),m.Index&&(w=+m.Index-1),w<T.s.c&&(T.s.c=w),w>T.e.c&&(T.e.c=w),o[0].slice(-2)==="/>"&&++w,ie=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<T.s.r&&(T.s.r=x),x>T.e.r&&(T.e.r=x),o[0].slice(-2)==="/>"&&(y=Bi(o[0]),y.Index&&(x=+y.Index-1)),w=0,++x):(y=Bi(o[0]),y.Index&&(x=+y.Index-1),_e={},(y.AutoFitHeight=="0"||y.Height)&&(_e.hpx=parseInt(y.Height,10),_e.hpt=e8(_e.hpx),he[x]=_e),y.Hidden=="1"&&(_e.hidden=!0,he[x]=_e));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(v),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(g["!ref"]=At(T),r.sheetRows&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=At(T))),I.length&&(g["!merges"]=I),ke.length>0&&(g["!cols"]=ke),he.length>0&&(g["!rows"]=he),d[v]=g}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,u.push([o[3],!1]),f=Bi(o[0]),v=Nt(f.Name),g=r.dense?[]:{},I=[],X=[],he=[],Y={name:v,Hidden:0},Q.Sheets.push(Y);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),ke=[],oe=!1}break;case"style":o[1]==="/"?Sb(A,F,r):F=Bi(o[0]);break;case"numberformat":F.nf=Nt(Bi(o[0]).Format||"General"),E0[F.nf]&&(F.nf=E0[F.nf]);for(var de=0;de!=392&&ht[de]!=F.nf;++de);if(de==392){for(de=57;de!=392;++de)if(ht[de]==null){vo(F.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(we=Bi(o[0]),we.Hidden&&(we.hidden=!0,delete we.Hidden),we.Width&&(we.wpx=parseInt(we.Width,10)),!oe&&we.wpx>10){oe=!0,Pn=JS;for(var xe=0;xe<ke.length;++xe)ke[xe]&&ql(ke[xe])}oe&&ql(we),ke[we.Index-1||ke.length]=we;for(var Me=0;Me<+we.Span;++Me)ke[ke.length]=Jr(we);break;case"namedrange":if(o[1]==="/")break;Q.Names||(Q.Names=[]);var G=it(o[0]),tt={Name:G.Name,Ref:Ml(G.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(tt.Sheet=Q.Sheets.length-1),Q.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Bi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sT(b,ue,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));kb(re),ie.push(re)}else u.push([o[3],!1]),f=Bi(o[0]),re={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var nt=Bi(o[0]);g["!autofilter"]={ref:Ml(nt.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return F3(n,r);var Xe=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else L=o.index+o[0].length;break;case"header":g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(g["!margins"].header=+it(o[0]).Margin);break;case"footer":g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(g["!margins"].footer=+it(o[0]).Margin);break;case"pagemargins":var Ze=it(o[0]);g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+Ze.Top)||(g["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(g["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(g["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(g["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?yb(O,ue,K,n.slice(L,o.index)):(K=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var Ie={};return!r.bookSheets&&!r.bookProps&&(Ie.Sheets=d),Ie.SheetNames=p,Ie.Workbook=Q,Ie.SSF=Jr(ht),Ie.Props=b,Ie.Custprops=O,Ie}function Pm(e,t){switch(ux(t=t||{}),t.type||"base64"){case"base64":return og(ni(e),t);case"binary":case"buffer":case"file":return og(e,t);case"array":return og(Io(e),t)}}function Eb(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=B7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=j7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Cb=[60,1084,2066,2165,2175];function Tb(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var u=La(r,r.l),f=Fm[u],d=0;f!=null&&Cb.indexOf(u)>-1;)a=La(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,f=Fm[u=La(r,r.l)];var p=xs(s);Qr(p,0);var g=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(g),g+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function ca(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ht[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Lo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=Pi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&ic(ht[n]||String(n))){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function jf(e,t,r){return{v:e,ixfe:t,t:r}}function Ab(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,u=[],f="",d={},p,g="",v,m,y,C,S={},w=[],x,T,A=[],F=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},I=function(Fe){return Fe<8?yo[Fe]:Fe<64&&F[Fe-8]||yo[Fe]},b=function(Fe,Ce,Qe){var et=Ce.XF.data;if(!(!et||!et.patternType||!Qe||!Qe.cellStyles)){Ce.s={},Ce.s.patternType=et.patternType;var lt;(lt=Q0(I(et.icvFore)))&&(Ce.s.fgColor={rgb:lt}),(lt=Q0(I(et.icvBack)))&&(Ce.s.bgColor={rgb:lt})}},O=function(Fe,Ce,Qe){if(!(_e>1)&&!(Qe.sheetRows&&Fe.r>=Qe.sheetRows)){if(Qe.cellStyles&&Ce.XF&&Ce.XF.data&&b(Fe,Ce,Qe),delete Ce.ixfe,delete Ce.XF,p=Fe,g=ct(Fe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<s.s.r&&(s.s.r=Fe.r),Fe.c<s.s.c&&(s.s.c=Fe.c),Fe.r+1>s.e.r&&(s.e.r=Fe.r+1),Fe.c+1>s.e.c&&(s.e.c=Fe.c+1),Qe.cellFormula&&Ce.f){for(var et=0;et<w.length;++et)if(!(w[et][0].s.c>Fe.c||w[et][0].s.r>Fe.r)&&!(w[et][0].e.c<Fe.c||w[et][0].e.r<Fe.r)){Ce.F=At(w[et][0]),(w[et][0].s.c!=Fe.c||w[et][0].s.r!=Fe.r)&&delete Ce.f,Ce.f&&(Ce.f=""+pn(w[et][1],s,Fe,X,L));break}}Qe.dense?(i[Fe.r]||(i[Fe.r]=[]),i[Fe.r][Fe.c]=Ce):i[g]=Ce}},L={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var K,ie=[],re=[],ke=[],we=[],oe=!1,X=[];X.SheetNames=L.snames,X.sharedf=L.sharedf,X.arrayf=L.arrayf,X.names=[],X.XTI=[];var he=0,_e=0,M=0,J=[],Q=[],Y;L.codepage=1200,Wi(1200);for(var ue=!1;e.l<e.length-1;){var z=e.l,te=e.read_shift(2);if(te===0&&he===10)break;var de=e.l===e.length?0:e.read_shift(2),xe=Fm[te];if(xe&&xe.f){if(t.bookSheets&&he===133&&te!==133)break;if(he=te,xe.r===2||xe.r==12){var Me=e.read_shift(2);if(de-=2,!L.enc&&Me!==te&&((Me&255)<<8|Me>>8)!==te)throw new Error("rt mismatch: "+Me+"!="+te);xe.r==12&&(e.l+=10,de-=10)}var G={};if(te===10?G=xe.f(e,de,L):G=Tb(te,xe,e,de,L),_e==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(te){case 34:r.opts.Date1904=N.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=G;break;case 66:var tt=Number(G);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}Wi(L.codepage=tt),ue=!0;break;case 317:L.rrtabid=G;break;case 25:L.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:L.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:A.push(G);break;case 430:X.push([G]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(G);break;case 24:case 536:Y={Name:G.Name,Ref:pn(G.rgce,s,null,X,L)},G.itab>0&&(Y.Sheet=G.itab-1),X.names.push(Y),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Q[G.itab-1]={ref:At(G.rgce[0][0][1][2])});break;case 22:L.ExternCount=G;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(G),X.XTI=X.XTI.concat(G);break;case 2196:if(L.biff<8)break;Y!=null&&(Y.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&L.WTF&&console.error("Password verifier: "+G);break;case 133:a[G.pos]=G,L.snames.push(G.name);break;case 10:{if(--_e)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=At(s),t.sheetRows&&t.sheetRows<=s.e.r){var nt=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=At(s),s.e.r=nt}s.e.r++,s.e.c++}ie.length>0&&(i["!merges"]=ie),re.length>0&&(i["!objects"]=re),ke.length>0&&(i["!cols"]=ke),we.length>0&&(i["!rows"]=we),N.Sheets.push(P)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),L.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(L.biff=5,ue=!0,Wi(L.codepage=28591)),L.biff==8&&G.BIFFVer==0&&G.dt==16&&(L.biff=2),_e++)break;if(i=t.dense?[]:{},L.biff<8&&!ue&&(ue=!0,Wi(L.codepage=t.codepage||1252)),L.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-de,name:f};a[Xe.pos]=Xe,L.snames.push(f)}else f=(a[z]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),ie=[],re=[],L.arrayf=w=[],ke=[],we=[],oe=!1,P={Hidden:(a[z]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[G.r]||[])[G.c]:i[ct({c:G.c,r:G.r})])&&++G.c,x={ixfe:G.ixfe,XF:A[G.ixfe]||{},v:G.val,t:"n"},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 5:case 517:x={ixfe:G.ixfe,XF:A[G.ixfe],v:G.val,t:G.t},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 638:x={ixfe:G.ixfe,XF:A[G.ixfe],v:G.rknum,t:"n"},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 189:for(var Ze=G.c;Ze<=G.C;++Ze){var Ie=G.rkrec[Ze-G.c][0];x={ixfe:Ie,XF:A[Ie],v:G.rkrec[Ze-G.c][1],t:"n"},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:Ze,r:G.r},x,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(x=jf(G.val,G.cell.ixfe,G.tt),x.XF=A[x.ixfe],t.cellFormula){var Ct=G.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var Lr=Ct[0][0][1][0],me=Ct[0][0][1][1],pe=ct({r:Lr,c:me});S[pe]?x.f=""+pn(G.formula,s,G.cell,X,L):x.F=((t.dense?(i[Lr]||[])[me]:i[pe])||{}).F}else x.f=""+pn(G.formula,s,G.cell,X,L)}M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O(G.cell,x,t),o=G}break;case 7:case 519:if(o)o.val=G,x=jf(G,o.cell.ixfe,"s"),x.XF=A[x.ixfe],t.cellFormula&&(x.f=""+pn(o.formula,s,o.cell,X,L)),M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(G);var Te=ct(G[0].s);if(v=t.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Te],t.cellFormula&&v){if(!o||!Te||!v)break;v.f=""+pn(G[1],s,G[0],X,L),v.F=At(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;S[ct(o.cell)]=G[0],v=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[ct(o.cell)],(v||{}).f=""+pn(G[0],s,p,X,L)}}break;case 253:x=jf(u[G.isst].t,G.ixfe,"s"),u[G.isst].h&&(x.h=u[G.isst].h),x.XF=A[x.ixfe],M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:G.ixfe,XF:A[G.ixfe],t:"z"},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t));break;case 190:if(t.sheetStubs)for(var Ae=G.c;Ae<=G.C;++Ae){var Pe=G.ixfe[Ae-G.c];x={ixfe:Pe,XF:A[Pe],t:"z"},M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:Ae,r:G.r},x,t)}break;case 214:case 516:case 4:x=jf(G.val,G.ixfe,"s"),x.XF=A[x.ixfe],M>0&&(x.z=J[x.ixfe>>8&63]),ca(x,t,r.opts.Date1904),O({c:G.c,r:G.r},x,t);break;case 0:case 512:_e===1&&(s=G);break;case 252:u=G;break;case 1054:if(L.biff==4){J[M++]=G[1];for(var De=0;De<M+163&&ht[De]!=G[1];++De);De>=163&&vo(G[1],M+163)}else vo(G[1],G[0]);break;case 30:{J[M++]=G;for(var Ve=0;Ve<M+163&&ht[Ve]!=G;++Ve);Ve>=163&&vo(G,M+163)}break;case 229:ie=ie.concat(G);break;case 93:re[G.cmo[0]]=L.lastobj=G;break;case 438:L.lastobj.TxO=G;break;case 127:L.lastobj.ImData=G;break;case 440:for(C=G[0].s.r;C<=G[0].e.r;++C)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[C]||[])[y]:i[ct({c:y,r:C})],v&&(v.l=G[1]);break;case 2048:for(C=G[0].s.r;C<=G[0].e.r;++C)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[C]||[])[y]:i[ct({c:y,r:C})],v&&v.l&&(v.l.Tooltip=G[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;v=t.dense?(i[G[0].r]||[])[G[0].c]:i[ct(G[0])];var ve=re[G[2]];v||(t.dense?(i[G[0].r]||(i[G[0].r]=[]),v=i[G[0].r][G[0].c]={t:"z"}):v=i[ct(G[0])]={t:"z"},s.e.r=Math.max(s.e.r,G[0].r),s.s.r=Math.min(s.s.r,G[0].r),s.e.c=Math.max(s.e.c,G[0].c),s.s.c=Math.min(s.s.c,G[0].c)),v.c||(v.c=[]),m={a:G[1],t:ve.TxO.t},v.c.push(m)}break;case 2173:YP(A[G.ixfe],G.ext);break;case 125:{if(!L.cellStyles)break;for(;G.e>=G.s;)ke[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},oe||(oe=!0,ax(G.w/256)),ql(ke[G.e+1])}break;case 520:{var q={};G.level!=null&&(we[G.r]=q,q.level=G.level),G.hidden&&(we[G.r]=q,q.hidden=!0),G.hpt&&(we[G.r]=q,q.hpt=G.hpt,q.hpx=q0(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||k0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[te]]=G;break;case 161:i["!margins"]||k0(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(N.Views[0].RTL=!0);break;case 146:F=G;break;case 2198:K=G;break;case 140:T=G;break;case 442:f?P.CodeName=G||P.name:N.WBProps.CodeName=G||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+te.toString(16)),e.l+=de}return r.SheetNames=ma(a).sort(function(Ee,Fe){return Number(Ee)-Number(Fe)}).map(function(Ee){return a[Ee].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Q.forEach(function(Ee,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Ee}),r.Strings=u,r.SSF=Jr(ht),L.enc&&(r.Encryption=L.enc),K&&(r.Themes=K),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),X.names.length>0&&(N.Names=X.names),r.Workbook=N,r}var E3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Pb(e,t,r){var n=Tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=o3(n,W7,E3.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var s=Tt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=o3(s,$7,E3.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(OS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function v8(e,t){t||(t={}),ux(t),$6(),t.codepage&&V2(t.codepage);var r,n;if(e.FullPaths){if(Tt.find(e,"/encryption"))throw new Error("File is password-protected");r=Tt.find(e,"!CompObj"),n=Tt.find(e,"/Workbook")||Tt.find(e,"/Book")}else{switch(t.type){case"base64":e=Hi(ni(e));break;case"binary":e=Hi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Qr(e,0),n={content:e}}var i,a;if(r&&Eb(r),t.bookProps&&!t.bookSheets)i={};else{var s=kt?"buffer":"array";if(n&&n.content)i=Ab(n.content,t);else if((a=Tt.find(e,"PerfectOffice_MAIN"))&&a.content)i=S0.to_workbook(a.content,(t.type=s,t));else if((a=Tt.find(e,"NativeContent_MAIN"))&&a.content)i=S0.to_workbook(a.content,(t.type=s,t));else throw(a=Tt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=hF(e))}var o={};return e.FullPaths&&Pb(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var Gd={0:{f:cR},1:{f:hR},2:{f:wR},3:{f:xR},4:{f:gR},5:{f:SR},6:{f:CR},7:{f:yR},8:{f:NR},9:{f:FR},10:{f:AR},11:{f:PR},12:{f:pR},13:{f:kR},14:{f:vR},15:{f:mR},16:{f:h8},17:{f:TR},18:{f:_R},19:{f:Z2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nb},40:{},42:{},43:{f:AP},44:{f:TP},45:{f:PP},46:{f:NP},47:{f:FP},48:{},49:{f:R7},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:XS},62:{f:ER},63:{f:rF},64:{f:jR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dR},148:{f:uR,p:16},151:{f:IR},152:{},153:{f:tb},154:{},155:{},156:{f:eb},157:{},158:{},159:{T:1,f:$A},160:{T:-1},161:{T:1,f:Oo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:QP},336:{T:-1},337:{f:JP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Em},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$S},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:DR},427:{f:OR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Em},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uF},633:{T:1},634:{T:-1},635:{T:1,f:cF},636:{T:-1},637:{f:I7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:UR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fm={6:{f:ag},10:{f:cs},12:{f:wr},13:{f:wr},14:{f:gr},15:{f:gr},16:{f:mn},17:{f:gr},18:{f:gr},19:{f:wr},20:{f:f3},21:{f:f3},23:{f:$S},24:{f:h3},25:{f:gr},26:{},27:{},28:{f:oA},29:{},34:{f:gr},35:{f:d3},38:{f:mn},39:{f:mn},40:{f:mn},41:{f:mn},42:{f:gr},43:{f:gr},47:{f:fP},49:{f:VT},51:{f:wr},60:{},61:{f:jT},64:{f:gr},65:{f:zT},66:{f:wr},77:{},80:{},81:{},82:{},85:{f:wr},89:{},90:{},91:{},92:{f:RT},93:{f:cA},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:XS},128:{f:JT},129:{f:bT},130:{f:wr},131:{f:gr},132:{f:gr},133:{f:IT},134:{},140:{f:gA},141:{f:wr},144:{},146:{f:xA},151:{},152:{},153:{},154:{},155:{},156:{f:wr},157:{},158:{},160:{f:wA},161:{f:yA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KT},190:{f:YT},193:{f:cs},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wr},220:{},221:{f:gr},222:{},224:{f:qT},225:{f:NT},226:{f:cs},227:{},229:{f:lA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:DT},253:{f:GT},255:{f:OT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:US},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:cs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eA},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:dA},439:{f:gr},440:{f:hA},441:{},442:{f:fu},443:{},444:{f:wr},445:{},446:{},448:{f:cs},449:{f:BT,r:2},450:{f:cs},512:{f:c3},513:{f:SA},515:{f:ZT},516:{f:HT},517:{f:u3},519:{f:kA},520:{f:LT},523:{},545:{f:p3},549:{f:l3},566:{},574:{f:UT},638:{f:XT},659:{},1048:{},1054:{f:WT},1084:{},1212:{f:iA},2048:{f:pA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Lf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:cs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vA,r:12},2173:{f:KP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nA,r:12},2197:{},2198:{f:VP,r:12},2199:{},2200:{},2201:{},2202:{f:aA,r:12},2203:{f:cs},2204:{},2205:{},2206:{},2207:{},2211:{f:MT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_A},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:c3},1:{},2:{f:AA},3:{f:TA},4:{f:CA},5:{f:u3},7:{f:PA},8:{},9:{f:Lf},11:{},22:{f:wr},30:{f:$T},31:{},32:{},33:{f:p3},36:{},37:{f:l3},50:{f:FA},62:{},52:{},67:{},68:{f:wr},69:{},86:{},126:{},127:{f:EA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:NA},223:{},234:{},354:{},421:{},518:{f:ag},521:{f:Lf},536:{f:h3},547:{f:d3},561:{},579:{},1030:{f:ag},1033:{f:Lf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ji(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&AS(r)&&e.push(r)}}function C3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,u=e7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<u.length;++s){var y=u[s].trim(),C=y.slice(0,3).toLowerCase();if(C=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(C!="<td"&&C!="<th")){var S=y.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var w=S[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,T=0;x.charAt(0)=="<"&&(T=x.indexOf(">"))>-1;)x=x.slice(T+1);for(var A=0;A<m.length;++A){var F=m[A];F.s.c==d&&F.s.r<f&&f<=F.e.r&&(d=F.e.c+1,A=-1)}var N=it(w.slice(0,w.indexOf(">")));g=N.colspan?+N.colspan:1,((p=+N.rowspan)>1||g>1)&&m.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+g-1}});var P=N.t||N["data-t"]||"";if(!x.length){d+=g;continue}if(x=pS(x),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!x.length){d+=g;continue}var I={t:"s",v:x};r.raw||!x.trim().length||P=="s"||(x==="TRUE"?I={t:"b",v:!0}:x==="FALSE"?I={t:"b",v:!1}:isNaN(Qi(x))?isNaN(Ql(x).getDate())||(I={t:"d",v:$r(x)},r.cellDates||(I={t:"n",v:bn(I.v)}),I.z=r.dateNF||ht[14]):I={t:"n",v:Qi(x)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=I):n[ct({r:f,c:d})]=I,d+=g}}}}return n["!ref"]=At(v),m.length&&(n["!merges"]=m),n}function Fb(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){o=-1;break}o=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var d=ct({r,c:s}),p=n.dense?(e[r]||[])[s]:e[d],g=p&&p.v!=null&&(p.h||K2(p.w||($a(p),p.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(g7("td",g,v))}}var m="<tr>";return m+a.join("")+"</tr>"}var Nb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Rb="</body></html>";function bb(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Us(C3(r[0],t),t);var n=dx();return r.forEach(function(i,a){hx(n,C3(i,t),"Sheet"+(a+1))}),n}function Ib(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Db(e,t){var r=t||{},n=r.header!=null?r.header:Nb,i=r.footer!=null?r.footer:Rb,a=[n],s=ac(e["!ref"]);r.dense=Array.isArray(e),a.push(Ib(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(Fb(e,s,o,r));return a.push("</table>"+i),a.join("")}function y8(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Fn(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=ac(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var p=[],g=0,v=e["!rows"]||(e["!rows"]=[]),m=0,y=0,C=0,S=0,w=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&y<u;++m){var T=o[m];if(T3(T)){if(n.display)continue;v[y]={hidden:!0}}var A=T.children;for(C=S=0;C<A.length;++C){var F=A[C];if(!(n.display&&T3(F))){var N=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):pS(F.innerHTML),P=F.getAttribute("data-z")||F.getAttribute("z");for(g=0;g<p.length;++g){var I=p[g];I.s.c==S+a&&I.s.r<y+i&&y+i<=I.e.r&&(S=I.e.c+1-a,g=-1)}x=+F.getAttribute("colspan")||1,((w=+F.getAttribute("rowspan")||1)>1||x>1)&&p.push({s:{r:y+i,c:S+a},e:{r:y+i+(w||1)-1,c:S+a+(x||1)-1}});var b={t:"s",v:N},O=F.getAttribute("data-t")||F.getAttribute("t")||"";N!=null&&(N.length==0?b.t=O||"z":n.raw||N.trim().length==0||O=="s"||(N==="TRUE"?b={t:"b",v:!0}:N==="FALSE"?b={t:"b",v:!1}:isNaN(Qi(N))?isNaN(Ql(N).getDate())||(b={t:"d",v:$r(N)},n.cellDates||(b={t:"n",v:bn(b.v)}),b.z=n.dateNF||ht[14]):b={t:"n",v:Qi(N)})),b.z===void 0&&P!=null&&(b.z=P);var L="",K=F.getElementsByTagName("A");if(K&&K.length)for(var ie=0;ie<K.length&&!(K[ie].hasAttribute("href")&&(L=K[ie].getAttribute("href"),L.charAt(0)!="#"));++ie);L&&L.charAt(0)!="#"&&(b.l={Target:L}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][S+a]=b):e[ct({c:S+a,r:y+i})]=b,f.e.c<S+a&&(f.e.c=S+a),S+=x}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+i),e["!ref"]=At(f),y>=u&&(e["!fullref"]=At((f.e.r=o.length-m+y-1+i,f))),e}function _8(e,t){var r=t||{},n=r.dense?[]:{};return y8(n,e,t)}function Ob(e,t){return Us(_8(e,t),t)}function T3(e){var t="",r=Lb(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Lb(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Mb(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var A3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function S8(e,t){var r=t||{},n=Y2(e),i=[],a,s,o={name:""},u="",f=0,d,p,g={},v=[],m=r.dense?[]:{},y,C,S={value:""},w="",x=0,T=[],A=-1,F=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,I={},b=[],O={},L=0,K=0,ie=[],re=1,ke=1,we=[],oe={Names:[]},X={},he=["",""],_e=[],M={},J="",Q=0,Y=!1,ue=!1,z=0;for(K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=K0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=At(N):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=At(N)),b.length&&(m["!merges"]=b),ie.length&&(m["!rows"]=ie),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),g[d.name]=m,ue=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=it(y[0],!1),A=F=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=r.dense?[]:{},b=[],ie=[],ue=!0);break;case"table-row-group":y[1]==="/"?--P:++P;break;case"table-row":case"":if(y[1]==="/"){A+=re,re=1;break}if(p=it(y[0],!1),p.?A=p.-1:A==-1&&(A=0),re=+p["number-rows-repeated"]||1,re<10)for(z=0;z<re;++z)P>0&&(ie[A+z]={level:P});F=-1;break;case"covered-table-cell":y[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][F]={t:"z"}):m[ct({r:A,c:F})]={t:"z"}),w="",T=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++F,S=it(y[0],!1),ke=parseInt(S["number-columns-repeated"]||"1",10),C={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(C.f=S3(Nt(S.formula))),(S.||S["value-type"])=="string"&&(C.t="s",C.v=Nt(S["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][F]=C):m[ct({r:A,c:F})]=C),F+=ke-1;else if(y[1]!=="/"){++F,w="",x=0,T=[],ke=1;var te=re?A+re-1:A;if(F>N.e.c&&(N.e.c=F),F<N.s.c&&(N.s.c=F),A<N.s.r&&(N.s.r=A),te>N.e.r&&(N.e.r=te),S=it(y[0],!1),_e=[],M={},C={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Nt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(L=parseInt(S["number-matrix-rows-spanned"],10)||0,K=parseInt(S["number-matrix-columns-spanned"],10)||0,O={s:{r:A,c:F},e:{r:A+L-1,c:F+K-1}},C.F=At(O),we.push([O,C.F])),S.formula)C.f=S3(S.formula);else for(z=0;z<we.length;++z)A>=we[z][0].s.r&&A<=we[z][0].e.r&&F>=we[z][0].s.c&&F<=we[z][0].e.c&&(C.F=we[z][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(L=parseInt(S["number-rows-spanned"],10)||0,K=parseInt(S["number-columns-spanned"],10)||0,O={s:{r:A,c:F},e:{r:A+L-1,c:F+K-1}},b.push(O)),S["number-columns-repeated"]&&(ke=parseInt(S["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Zt(S["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(S.value);break;case"percentage":C.t="n",C.v=parseFloat(S.value);break;case"currency":C.t="n",C.v=parseFloat(S.value);break;case"date":C.t="d",C.v=$r(S["date-value"]),r.cellDates||(C.t="n",C.v=bn(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=qC(S["time-value"])/86400,r.cellDates&&(C.t="d",C.v=yh(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(S.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",S["string-value"]!=null&&(w=Nt(S["string-value"]),T=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(Y=!1,C.t==="s"&&(C.v=w||"",T.length&&(C.R=T),Y=x==0),X.Target&&(C.l=X),_e.length>0&&(C.c=_e,_e=[]),w&&r.cellText!==!1&&(C.w=w),Y&&(C.t="z",delete C.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var de=0;de<re;++de){if(ke=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(m[A+de]||(m[A+de]=[]),m[A+de][F]=de==0?C:Jr(C);--ke>0;)m[A+de][F+ke]=Jr(C);else for(m[ct({r:A+de,c:F})]=C;--ke>0;)m[ct({r:A+de,c:F+ke})]=Jr(C);N.e.c<=F&&(N.e.c=F)}ke=parseInt(S["number-columns-repeated"]||"1",10),F+=ke-1,ke=0,C={},w="",T=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a;M.t=w,T.length&&(M.R=T),M.a=J,_e.push(M)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);J="",Q=0,w="",x=0,T=[];break;case"creator":y[1]==="/"?J=n.slice(Q,y.index):Q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);w="",x=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[o.name]=u,(a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(u="",o=it(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=it(y[0],!1),u+=A3[y[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=it(y[0],!1),u+=A3[y[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":s=it(y[0],!1),he=sg(s["cell-range-address"]);var xe={Name:s.name,Ref:he[0]+"!"+he[1]};ue&&(xe.Sheet=v.length),oe.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!S||!S["string-value"])){var Me=Mb(n.slice(x,y.index));w=(w.length>0?w+`
`:"")+Me[0]}else it(y[0],!1),x=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{he=sg(it(y[0])["target-range-address"]),g[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=it(y[0],!1),!X.href)break;X.Target=Nt(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(he=sg(X.Target.slice(1)),X.Target="#"+he[0]+"!"+he[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:g,SheetNames:v,Workbook:oe};return r.bookSheets&&delete G.Sheets,G}function P3(e,t){t=t||{},_i(e,"META-INF/manifest.xml")&&Z7(Sr(e,"META-INF/manifest.xml"),t);var r=Jn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=S8(Xt(r),t);return _i(e,"meta.xml")&&(n.Props=DS(Sr(e,"meta.xml"))),n}function F3(e,t){return S8(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function lx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(Io(e))}function Rm(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function N3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Bb(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function J0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ir(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=J0(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=J0(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function cx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function jb(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=J0(e,n),a=xn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:Ir(a[1][0].data),messages:[]};a[2].forEach(function(o){var u=xn(o.data),f=Ir(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(s.merge=Ir(a[3][0].data)>>>0>0),r.push(s)}return r}function Ub(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=J0(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Rm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Rm(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function zb(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ub(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Rm(t)}function Vb(e,t,r,n){var i=lx(e),a=i.getUint32(4,!0),s=(n>1?12:8)+N3(a&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=N3(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(s,!0),s+=4),a&32&&(f=i.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function Gb(e,t,r){var n=lx(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=Bb(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function Hb(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Vb(e,t,r,e[0]);case 5:return Gb(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ns(e){var t=xn(e);return J0(t[1][0].data)}function R3(e,t){var r=xn(t.data),n=Ir(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=xn(s.data),u=Ir(o[1][0].data)>>>0;switch(n){case 1:a[u]=Nm(o[3][0].data);break;case 8:{var f=e[Ns(o[9][0].data)][0],d=xn(f.data),p=e[Ns(d[1][0].data)][0],g=Ir(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=xn(p.data);a[u]=v[3].map(function(m){return Nm(m.data)}).join("")}break}}),a}function Wb(e,t){var r,n,i,a,s,o,u,f,d,p,g,v,m,y,C=xn(e),S=Ir(C[1][0].data)>>>0,w=Ir(C[2][0].data)>>>0,x=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&Ir(C[8][0].data)>0||!1,T,A;if((a=(i=C[7])==null?void 0:i[0])!=null&&a.data&&t!=0)T=(o=(s=C[7])==null?void 0:s[0])==null?void 0:o.data,A=(f=(u=C[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=C[4])==null?void 0:d[0])!=null&&p.data&&t!=1)T=(v=(g=C[4])==null?void 0:g[0])==null?void 0:v.data,A=(y=(m=C[3])==null?void 0:m[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=x?4:1,N=lx(T),P=[],I=0;I<T.length/2;++I){var b=N.getUint16(I*2,!0);b<65535&&P.push([I,b])}if(P.length!=w)throw"Expected ".concat(w," cells, found ").concat(P.length);var O=[];for(I=0;I<P.length-1;++I)O[P[I][0]]=A.subarray(P[I][1]*F,P[I+1][1]*F);return P.length>=1&&(O[P[P.length-1][0]]=A.subarray(P[P.length-1][1]*F)),{R:S,cells:O}}function $b(e,t){var r,n=xn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ir(n[7][0].data)>>>0>0?1:0:-1,a=cx(n[5],function(s){return Wb(s,i)});return{nrows:Ir(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(u,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=u}),s},[])}}function Xb(e,t,r){var n,i=xn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ir(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Ir(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=At(a);var s=xn(i[4][0].data),o=R3(e,e[Ns(s[4][0].data)][0]),u=(n=s[17])!=null&&n[0]?R3(e,e[Ns(s[17][0].data)][0]):[],f=xn(s[3][0].data),d=0;f[1].forEach(function(p){var g=xn(p.data),v=e[Ns(g[2][0].data)][0],m=Ir(v.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var y=$b(e,v);y.data.forEach(function(C,S){C.forEach(function(w,x){var T=ct({r:d+S,c:x}),A=Hb(w,o,u);A&&(r[T]=A)})}),d+=y.nrows})}function Kb(e,t){var r=xn(t.data),n={"!ref":"A1"},i=e[Ns(r[2][0].data)],a=Ir(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Xb(e,i[0],n),n}function Yb(e,t){var r,n=xn(t.data),i={name:(r=n[1])!=null&&r[0]?Nm(n[1][0].data):"",sheets:[]},a=cx(n[2],Ns);return a.forEach(function(s){e[s].forEach(function(o){var u=Ir(o.meta[1][0].data);u==6e3&&i.sheets.push(Kb(e,o))})}),i}function Qb(e,t){var r=dx(),n=xn(t.data),i=cx(n[1],Ns);if(i.forEach(function(a){e[a].forEach(function(s){var o=Ir(s.meta[1][0].data);if(o==2){var u=Yb(e,s);u.sheets.forEach(function(f,d){hx(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lg(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=zb(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=jb(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){a[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ir(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(u){a[u].forEach(function(f){var d=Ir(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Qb(a,o)}function qb(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ux(e){qb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Jb(e){return Fl.WS.indexOf(e)>-1?"sheet":e==Fl.CS?"chart":e==Fl.DS?"dialog":e==Fl.MS?"macro":e&&e.length?e:"sheet"}function Zb(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Jb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eI(e,t,r,n,i,a,s,o,u,f,d,p){try{a[n]=y0(Jn(e,r,!0),t);var g=Sr(e,t),v;switch(o){case"sheet":v=sb(g,t,i,u,a[n],f,d,p);break;case"chart":if(v=ob(g,t,i,u,a[n],f,d,p),!v||!v["!drawel"])break;var m=n0(v["!drawel"].Target,t),y=Cm(m),C=aF(Jn(e,m,!0),y0(Jn(e,y,!0),m)),S=n0(C,m),w=Cm(S);v=GR(Jn(e,S,!0),S,u,y0(Jn(e,w,!0),S),f,v);break;case"macro":v=lb(g,t,i,u,a[n],f,d,p);break;case"dialog":v=cb(g,t,i,u,a[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var x=[];a&&a[n]&&ma(a[n]).forEach(function(T){var A="";if(a[n][T].Type==Fl.CMNT){A=n0(a[n][T].Target,t);var F=hb(Sr(e,A,!0),A,u);if(!F||!F.length)return;m3(v,F,!1)}a[n][T].Type==Fl.TCMNT&&(A=n0(a[n][T].Target,t),x=x.concat(oF(Sr(e,A,!0),u)))}),x&&x.length&&m3(v,x,!0,u.people||[])}catch(T){if(u.WTF)throw T}}function mi(e){return e.charAt(0)=="/"?e.slice(1):e}function tI(e,t){if(iS(),t=t||{},ux(t),_i(e,"META-INF/manifest.xml")||_i(e,"objectdata.xml"))return P3(e,t);if(_i(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lg<"u"){if(e.FileIndex)return lg(e);var r=Tt.utils.cfb_new();return Gy(e).forEach(function(ie){r7(r,ie,uS(e,ie))}),lg(r)}throw new Error("Unsupported NUMBERS file")}if(!_i(e,"[Content_Types].xml"))throw _i(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_i(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Gy(e),i=q7(Jn(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Sr(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Sr(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(w0=[],i.sst)try{w0=db(Sr(e,mi(i.sst)),i.sst,t)}catch(ie){if(t.WTF)throw ie}t.cellStyles&&i.themes.length&&(u=fb(Jn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=ub(Sr(e,mi(i.style)),i.style,u,t))}i.links.map(function(ie){try{var re=y0(Jn(e,Cm(mi(ie))),ie);return gb(Sr(e,mi(ie)),re,ie,t)}catch{}});var d=ab(Sr(e,mi(i.workbooks[0])),i.workbooks[0],t),p={},g="";i.coreprops.length&&(g=Sr(e,mi(i.coreprops[0]),!0),g&&(p=DS(g)),i.extprops.length!==0&&(g=Sr(e,mi(i.extprops[0]),!0),g&&rT(g,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(g=Jn(e,mi(i.custprops[0]),!0),g&&(v=iT(g,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(re){return re.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=v),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var y={};t.bookDeps&&i.calcchain&&(y=pb(Sr(e,mi(i.calcchain)),i.calcchain));var C=0,S={},w,x;{var T=d.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var A=0;A!=T.length;++A)p.SheetNames[A]=T[A].name}var F=a?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");_i(e,P)||(P="xl/_rels/workbook."+F+".rels");var I=y0(Jn(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mb(Sr(e,mi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=lF(Sr(e,mi(i.people[0])),t)),I&&(I=Zb(I,d.Sheets));var b=Sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=p.Worksheets;++C){var O="sheet";if(I&&I[C]?(w="xl/"+I[C][1].replace(/[\/]?xl\//,""),_i(e,w)||(w=I[C][1]),_i(e,w)||(w=P.replace(/_rels\/.*$/,"")+I[C][1]),O=I[C][2]):(w="xl/worksheets/sheet"+(C+1-b)+"."+F,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(p.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==C&&(L=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==p.SheetNames[C].toLowerCase()&&(L=1);if(!L)continue e}}eI(e,w,x,p.SheetNames[C],C,S,s,O,t,d,u,f)}return m={Directory:i,Workbook:d,Props:p,Custprops:v,Deps:y,Sheets:s,SheetNames:p.SheetNames,Strings:w0,Styles:f,Themes:u,SSF:Jr(ht)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(ie,re){ie=ie.replace(/^Root Entry[\/]/,""),m.keys.push(ie),m.files[ie]=e.FileIndex[re]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Sr(e,mi(i.vba[0]),!0):i.defaults&&i.defaults.bin===dF&&(m.vbaraw=Sr(e,"xl/vbaProject.bin",!0))),m}function rI(e,t){var r=t||{},n="Workbook",i=Tt.find(e,n);try{if(n="/!DataSpaces/Version",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KA(i.content),n="/!DataSpaces/DataSpaceMap",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=QA(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qA(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ZA(i.content)}catch{}if(n="/EncryptionInfo",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=eP(i.content);if(n="/EncryptedPackage",i=Tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function fx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ni(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nI(e,t){return Tt.find(e,"EncryptedPackage")?rI(e,t):v8(e,t)}function iI(e,t){var r,n=e,i=t||{};return i.type||(i.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r=fS(n,i),tI(r,i)}function w8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Pm(e.slice(r),t);default:break e}return Y0.to_workbook(e,t)}function aI(e,t){var r="",n=fx(e,t);switch(t.type){case"base64":r=ni(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ao(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Xt(r)),t.type="binary",w8(r,t)}function sI(e,t){var r=e;return t.type=="base64"&&(r=ni(r)),r=ms.utils.decode(1200,r.slice(2),"str"),t.type="binary",w8(r,t)}function oI(e){return e.match(/[^\x00-\x7F]/)?i0(e):e}function cg(e,t,r,n){return n?(r.type="string",Y0.to_workbook(e,r)):Y0.to_workbook(t,r)}function bm(e,t){$6();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return bm(new Uint8Array(e),(r=Jr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bl={},r.dateNF&&(Bl.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=YC(e),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=oI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Jr(r),r.type="array",bm(G2(n),r)}switch((i=fx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return nI(Tt.read(n,r),r);break;case 9:if(i[1]<=8)return v8(n,r);break;case 60:return Pm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return OA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return IA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?iI(n,r):cg(e,n,r,a);case 239:return i[3]===60?Pm(n,r):cg(e,n,r,a);case 255:if(i[1]===254)return sI(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return S0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return S0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return g3.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return dP.to_workbook(n,r);break;case 10:case 13:case 32:return aI(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return RA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?g3.to_workbook(n,r):cg(e,n,r,a)}function lI(e,t,r,n,i,a,s,o){var u=Zr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var m=s?e[r][v]:e[n[v]+u];if(m===void 0||m.t===void 0){if(f===void 0)continue;a[v]!=null&&(g[a[v]]=f);continue}var y=m.v;switch(m.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[v]!=null){if(y==null)if(m.t=="e"&&y===null)g[a[v]]=null;else if(f!==void 0)g[a[v]]=f;else if(d&&y===null)g[a[v]]=null;else continue;else g[a[v]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?y:$a(m,y,o);y!=null&&(p=!1)}}return{row:g,isempty:p}}function Im(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=dr(d);break;case"number":u=dr(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var p=Zr(u.s.r),g=[],v=[],m=0,y=0,C=Array.isArray(e),S=u.s.r,w=0,x={};C&&!e[S]&&(e[S]=[]);var T=f.skipHidden&&e["!cols"]||[],A=f.skipHidden&&e["!rows"]||[];for(w=u.s.c;w<=u.e.c;++w)if(!(T[w]||{}).hidden)switch(g[w]=br(w),r=C?e[S][w]:e[g[w]+p],n){case 1:a[w]=w-u.s.c;break;case 2:a[w]=g[w];break;case 3:a[w]=f.header[w-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=$a(r,null,f),y=x[s]||0,!y)x[s]=1;else{do o=s+"_"+y++;while(x[o]);x[s]=y,x[o]=1}a[w]=o}for(S=u.s.r+i;S<=u.e.r;++S)if(!(A[S]||{}).hidden){var F=lI(e,u,S,g,n,a,C,f);(F.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[m++]=F.row)}return v.length=m,v}var b3=/"/g;function cI(e,t,r,n,i,a,s,o){for(var u=!0,f=[],d="",p=Zr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=o.dense?(e[r]||[])[g]:e[n[g]+p];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:$a(v,null,o));for(var m=0,y=0;m!==d.length;++m)if((y=d.charCodeAt(m))===i||y===a||y===34||o.forceQuotes){d='"'+d.replace(b3,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(b3,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(s)}function k8(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=dr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(g[m]||{}).hidden||(p[m]=br(m));for(var y=0,C=i.s.r;C<=i.e.r;++C)(v[C]||{}).hidden||(d=cI(e,i,C,p,s,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((y++?o:"")+d)));return delete n.dense,r.join("")}function uI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=k8(e,t);return r}function fI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=dr(e["!ref"]),a="",s=[],o,u=[],f=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=br(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=Zr(d),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function E8(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Fn(n.origin):n.origin;s=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var p=dr(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),s==-1&&(s=p.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var g=n.header||[],v=0;t.forEach(function(y,C){ma(y).forEach(function(S){(v=g.indexOf(S))==-1&&(g[v=g.length]=S);var w=y[S],x="z",T="",A=ct({c:o+v,r:s+C+i});f=Z0(a,A),w&&typeof w=="object"&&!(w instanceof Date)?a[A]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=bn(w)),T=n.dateNF||ht[14]):w===null&&n.nullError&&(x="e",w=0),f?(f.t=x,f.v=w,delete f.w,delete f.R,T&&(f.z=T)):a[A]=f={t:x,v:w},T&&(f.z=T))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var m=Zr(s);if(i)for(v=0;v<g.length;++v)a[br(v+o)+m]={t:"s",v:g[v]};return a["!ref"]=At(d),a}function dI(e,t){return E8(null,e,t)}function Z0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Fn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Z0(e,ct(t)):Z0(e,ct({r:t,c:r||0}))}function hI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function dx(){return{SheetNames:[],Sheets:{}}}function hx(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(qR(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function pI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function gI(e,t){return e.z=t,e}function C8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mI(e,t,r){return C8(e,"#"+t,r)}function xI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vI(e,t,r,n){for(var i=typeof t!="string"?t:dr(t),a=typeof t=="string"?t:At(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var u=Z0(e,s,o);u.t="n",u.F=a,delete u.v,s==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var ug={encode_col:br,encode_row:Zr,encode_cell:ct,encode_range:At,decode_col:J2,decode_row:q2,split_cell:N7,decode_cell:Fn,decode_range:ac,format_cell:$a,sheet_add_aoa:FS,sheet_add_json:E8,sheet_add_dom:y8,aoa_to_sheet:sc,json_to_sheet:dI,table_to_sheet:_8,table_to_book:Ob,sheet_to_csv:k8,sheet_to_txt:uI,sheet_to_json:Im,sheet_to_html:Db,sheet_to_formulae:fI,sheet_to_row_object_array:Im,sheet_get_cell:Z0,book_new:dx,book_append_sheet:hx,book_set_sheet_visibility:pI,cell_set_number_format:gI,cell_set_hyperlink:C8,cell_set_internal_link:mI,cell_add_comment:xI,sheet_set_array_formula:vI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const px=class Dm{static async parseCSVFile(t){var r;try{const n=(r=t.name.split(".").pop())==null?void 0:r.toLowerCase();let i;return n==="xlsx"||n==="xls"?i=await this.readXLSXFileContent(t):i=await this.readFileContent(t),this.parseCSVContent(i)}catch(n){return{success:!1,pins:[],warnings:[],errors:[n.message],format:this.getDefaultFormat()}}}static async parseCSVContent(t){console.log(" Starting ultra-fast CSV parsing...");const r=this.tryVersalPatternMatching(t);if(r!==null)return await r;console.log(" About to try Intel/Altera pattern matching...");const n=this.tryIntelAlteraPatternMatching(t);return n!==null?(console.log(" Intel/Altera pattern detected, processing..."),await n):(console.log(" Versal and Intel/Altera patterns not found, using generic approach..."),this.parseCSVContentGeneric(t))}static async parseCSVContentGeneric(t){console.log(" Fallback to generic CSV processing...");const r=t.split(`
`).map(v=>v.trim()).filter(Boolean);console.log(` Processing ${r.length} lines with generic approach`);let n=-1,i=-1;for(let v=0;v<Math.min(1e3,r.length);v++){const m=r[v];if(!m||!m.includes(","))continue;const y=m.toLowerCase();if(y.includes("copyright")||y.includes("license")||y.includes("xilinx")||m.startsWith("#"))continue;const C=this.parseCSVLine(m);if(C.length>=3&&C.some(w=>{const x=w.toLowerCase().trim();return x==="pin"||x==="ball"||x.includes("pin")})){n=v,i=v+1;break}}if(n===-1)return{success:!1,pins:[],warnings:[],errors:["Pin column not found or empty"],format:this.getDefaultFormat()};const a=r[n];console.log(` Found header at line ${n+1}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;for(let v=i;v<r.length;v++){const m=r[v];if(!m||m.replace(/,/g,"").trim()==="")continue;const y=this.parseCSVLine(m);try{const C=this.parsePin(y,o,v+1);C&&(u.push(C),g++)}catch(C){d.length<20&&d.push(`Line ${v+1}: ${C.message}`)}p++,p%1e3===0&&console.log(` Generic processing: ${p} lines, ${g} pins`)}return console.log(` Generic processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static tryVersalPatternMatching(t){console.log(" Trying ultra-fast Versal pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(7e3,r.length);a++){const s=r[a];if(a%1e3===0&&console.log(` Pattern matching line ${a+1}...`),s&&s.toLowerCase().startsWith("pin,pin name,")){n=a,i=a+1,console.log(` Found Versal header at line ${a+1}: ${s.substring(0,100)}`);break}if(s&&s.toLowerCase().startsWith("pin,")&&s.toLowerCase().includes("pin name")&&s.split(",").length>=3){n=a,i=a+1,console.log(` Found Versal header variant at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Versal pattern not found"),null):this.parseCSVWithKnownHeader(r,n,i)}static tryIntelAlteraPatternMatching(t){console.log(" Trying Intel/Altera pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(20,r.length);a++){const s=r[a];if(s&&s.toLowerCase().includes("pin name/function")){n=a,i=a+1,console.log(` Found Intel/Altera header at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Intel/Altera pattern not found"),null):this.parseIntelAlteraCSV(r,n,i)}static async parseIntelAlteraCSV(t,r,n){var f,d,p,g,v,m,y,C,S;console.log(" Processing Intel/Altera CSV format...");const i=[],a=[],s=[];let o=0,u=0;for(let w=n;w<t.length;w++){const x=t[w];if(!x||x.replace(/,/g,"").trim()==="")continue;const T=this.parseCSVLine(x);if(T.length>=6){const A=(f=T[0])==null?void 0:f.trim(),F=(d=T[1])==null?void 0:d.trim(),N=(p=T[6])==null?void 0:p.trim(),P=(g=T[7])==null?void 0:g.trim();if(!A||!N||!P)continue;try{const I={row:N,col:parseInt(P,10)||1},b=this.gridToPosition(I),O={id:crypto.randomUUID(),pinNumber:A,pinName:F||A,signalName:((v=T[2])==null?void 0:v.trim())||"",direction:this.parseDirection(T[3]),pinType:this.determinePinType(F||A),voltage:((m=T[4])==null?void 0:m.trim())||"3.3V",packagePin:((y=T[5])==null?void 0:y.trim())||A,position:b,gridPosition:I,isAssigned:!!((C=T[2])!=null&&C.trim()),bank:((S=T[8])==null?void 0:S.trim())||"NA"};i.push(O),o++}catch(I){s.length<20&&s.push(`Line ${w+1}: ${I.message}`)}}u++,u%1e3===0&&console.log(` Intel/Altera processing: ${u} lines, ${o} pins`)}return console.log(` Intel/Altera processing complete: ${o} pins found from ${u} lines`),{success:i.length>0,pins:i,warnings:a,errors:s,format:{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:["Pin","Pin Name","Signal","Direction","Voltage","Package_Pin","Row","Col","Bank","Type"]}}}static async parseCSVWithKnownHeader(t,r,n){console.log(" Fast processing with known header...");const i=t.slice(n).filter(m=>!m||m.trim()===""?!1:m.replace(/,/g,"").trim()!=="");console.log(` Found ${i.length} data lines after header`);const a=t[r];console.log(` Using header line ${r}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;const v=1e3;for(let m=0;m<i.length;m++){const y=i[m];if(!y||y.replace(/,/g,"").trim()==="")continue;const C=this.parseCSVLine(y);try{const S=this.parsePin(C,o,m+n+1);S&&(u.push(S),g++)}catch(S){d.length<20&&d.push(`Line ${m+n+1}: ${S.message}`)}p++,p%v===0&&console.log(` Processed ${p}/${i.length} lines, found ${g} pins`)}return console.log(` Ultra-fast processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static async readFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;return r((s=a.target)==null?void 0:s.result)},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static async readXLSXFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=bm(o,{type:"binary"});console.log(" XLSX Workbook info:",{sheetNames:u.SheetNames,totalSheets:u.SheetNames.length});const f=u.SheetNames[0],d=u.Sheets[f],p=ug.decode_range(d["!ref"]||"A1");console.log(" Sheet range:",{sheetName:f,range:d["!ref"],rows:p.e.r-p.s.r+1,cols:p.e.c-p.s.c+1});const g=ug.sheet_to_json(d,{header:1,raw:!1});console.log(" Raw data sample (first 15 rows):",g.slice(0,15)),console.log(" Total data rows:",g.length);const v=g.filter(y=>y&&Array.isArray(y)&&y.some(C=>C&&C.toString().trim()));console.log(" Non-empty rows:",v.length);const m=Dm.detectIntelAlteraFormat(g);if(console.log(" Format detection result:",m?"Intel/Altera":"Standard CSV"),m){console.log(" Intel/Altera format detected, using special processing");const y=Dm.processIntelAlteraXLSX(g);r(y)}else{const y=ug.sheet_to_csv(d,{strip:!1}),C=y.split(`
`).filter(S=>S.trim());console.log(" CSV conversion result:",{originalRows:p.e.r-p.s.r+1,csvLines:C.length,firstTenLines:C.slice(0,10),linesWithCommas:C.filter(S=>S.includes(",")).length}),r(y)}}catch(o){console.error(" XLSX parsing error:",o),n(new Error(`Failed to parse XLSX file: ${o.message}`))}},i.onerror=()=>n(new Error("Failed to read XLSX file")),i.readAsBinaryString(t)})}static detectFormat(t){const r=this.parseCSVLine(t).map(a=>a.trim());return this.XILINX_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=4?{type:"xilinx",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.XILINX_HEADERS}:this.GENERIC_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=3?{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}:{type:"generic",hasHeader:!1,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static getColumnMapping(t,r){const n=this.parseCSVLine(r).map(s=>s.trim().toLowerCase());console.log(" Detected headers:",n);const i=s=>{for(const o of s){const u=n.findIndex(f=>f.includes(o.toLowerCase()));if(u!==-1)return console.log(` Found column "${o}" at index ${u}: "${n[u]}"`),u}return-1},a={pin:i(["pin","pin_number","pin number","package pin","package_pin","ball","ball_id"]),pinName:i(["pin name","pin_name","name","ball name","ball_name"]),signalName:i(["signal","signal_name","net","net name","signal name"]),direction:i(["direction","dir","type","i/o type","io_type"]),voltage:i(["voltage","volt","io_standard","io standard","vccio"]),bank:i(["bank","bank_number","bank number","io bank"]),memoryByteGroup:i(["memory byte group","byte_group","mbg","memory_byte_group"]),ioType:i(["i/o type","io_type","type","function","io_standard"])};return console.log(" Column mapping result:",a),a}static parsePin(t,r,n){var f,d,p,g,v,m,y;if(t.length===0||r.pin===-1||!t[r.pin])return null;const i=(f=t[r.pin])==null?void 0:f.trim();if(!i||i==="NA"||i===""||i.length>10||i.toLowerCase().includes("device")||!/^[A-Za-z0-9]+$/.test(i))return null;const a=((d=t[r.pinName])==null?void 0:d.trim())||i,s=this.parseGridPosition(i);if(!s)return null;const o=this.gridToPosition(s),u={id:crypto.randomUUID(),pinNumber:i,pinName:a,signalName:((p=t[r.signalName||-1])==null?void 0:p.trim())||"",direction:this.parseDirection(t[r.direction||-1]),pinType:this.determinePinType(a),voltage:((g=t[r.voltage||-1])==null?void 0:g.trim())||"3.3V",packagePin:i,position:o,gridPosition:s,isAssigned:!1,bank:(v=t[r.bank||-1])==null?void 0:v.trim(),memoryByteGroup:(m=t[r.memoryByteGroup||-1])==null?void 0:m.trim(),ioType:(y=t[r.ioType||-1])==null?void 0:y.trim()};return u.signalName&&(u.isAssigned=!0),u}static parseGridPosition(t){const r=t.match(/^([A-Z]+)(\d+)$/);return r?{row:r[1],col:parseInt(r[2],10)}:null}static gridToPosition(t){const r=Is(t.row),n=88;return{x:Math.round((t.col-1)*n),y:Math.round(r*n)}}static parseDirection(t){if(!t||t.trim()==="")return"";const r=t.toLowerCase().trim();return r.includes("input")||r.includes("in")?"Input":r.includes("output")||r.includes("out")?"Output":r.includes("inout")||r.includes("bidirectional")?"InOut":r.includes("power")||r.includes("vcc")?"Power":r.includes("ground")||r.includes("gnd")?"Ground":r.includes("clock")||r.includes("clk")?"Clock":r.includes("reset")||r.includes("rst")?"Reset":""}static determinePinType(t){const r=t.toLowerCase();return r.includes("io_l")||r.includes("io_")||r.startsWith("io")?"IO":r.includes("config")||r.includes("tck")||r.includes("tdi")||r.includes("tdo")||r.includes("tms")||r.includes("done")?"CONFIG":r.includes("vcc")||r.includes("vdd")?"POWER":r.includes("gnd")||r.includes("vss")?"GROUND":r.includes("mgt")||r.includes("gt")?"MGT":r.includes("clk")||r.includes("clock")?"CLOCK":r.includes("adc")||r.includes("dac")?"ADC":r.includes("vref")||r.includes("special")?"SPECIAL":r.includes("nc")||r===""?"NC":r.includes("rsvd")||r.includes("reserved")?"RESERVED":"IO"}static parseCSVLine(t){const r=[];let n="",i=!1;for(let a=0;a<t.length;a++){const s=t[a];s==='"'?i=!i:s===","&&!i?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r}static getDefaultFormat(){return{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static createPackageFromPins(t,r="Unknown"){if(t.length===0)return{id:crypto.randomUUID(),name:r,device:"Unknown",packageType:"Unknown",dimensions:{rows:0,cols:0},pins:[],totalPins:0};const n=Math.max(...t.map(a=>Is(a.gridPosition.row)))+1,i=Math.max(...t.map(a=>a.gridPosition.col));return{id:crypto.randomUUID(),name:r,device:r.split("-")[0]||"Unknown",packageType:r.split("-")[1]||"Unknown",dimensions:{rows:n,cols:i},pins:t,totalPins:t.length}}static detectIntelAlteraFormat(t){console.log(" Detecting Intel/Altera format...");for(let r=0;r<Math.min(10,t.length);r++){const n=t[r];if(n&&Array.isArray(n)&&n.length>=4){const i=n.join(",").toLowerCase();if(console.log(`Row ${r}: "${i.substring(0,100)}..."`),i.includes("pin name/function")&&(i.includes("bank number")||i.includes("bank"))&&(i.includes("vref")||i.includes("configuration function")))return console.log(" Intel/Altera format detected!"),!0}}return console.log(" Intel/Altera format not detected"),!1}static processIntelAlteraXLSX(t){console.log(" Processing Intel/Altera XLSX format...");let r=-1,n=-1,i=-1,a=-1;for(let u=0;u<Math.min(10,t.length);u++){const f=t[u];if(f&&Array.isArray(f)&&f.length>=4){const d=f.map(p=>p?p.toString().toLowerCase().trim():"");if(d.some(p=>p.includes("pin name/function"))){r=u;for(let p=0;p<d.length;p++){const g=d[p];p===0&&(g.includes("v")||g.match(/^[a-z]\d+$/)||g.length<=3)?n=p:g.includes("pin name/function")?i=p:(g.includes("bank number")||g.includes("bank"))&&(a=p)}break}}}if(r===-1)return console.warn(" Intel/Altera header not found, fallback to standard processing"),"";console.log(" Intel/Altera format detected:",{headerRowIndex:r,pinNumberCol:n,pinNameCol:i,bankCol:a});const s=[];let o=0;s.push("Pin,Pin Name,Signal,Direction,Voltage,Package_Pin,Row,Col,Bank,Type");for(let u=r+1;u<t.length;u++){const f=t[u];if(!f||!Array.isArray(f)||f.length<4)continue;const d=f[n]?f[n].toString().trim():"",p=f[i]?f[i].toString().trim():"",g=f[a]?f[a].toString().trim():"";if(o<10&&console.log(` Processing pin ${o+1}: Number="${d}", Name="${p}", Bank="${g}"`),!d||d===""||p.toLowerCase().includes("nc")||p.toLowerCase().includes("no connect")){o<10&&console.log(` Skipping NC/empty pin: "${d}" / "${p}"`);continue}if(!d.match(/^[A-Z0-9_]+\d*$/i)){o<10&&console.log(` Skipping invalid pin format: "${d}"`);continue}let v="IO";(p.toLowerCase().includes("power")||p.toLowerCase().includes("vcc")||p.toLowerCase().includes("gnd"))&&(v="POWER");const m=d.match(/^([A-Z])(\d+)$/i),y=m?m[1].toUpperCase():"A",C=m?m[2]:"1",S=[d,p||d,"","","",d,y,C,g||"NA",v].join(",");s.push(S),o++}return console.log(` Intel/Altera processing complete: ${o} pins processed from ${t.length-r-1} data rows`),s.join(`
`)}};px.XILINX_HEADERS=["Pin","Pin Name","Memory Byte Group","Bank","VCCAUX Group","Super Logic Region","I/O Type","No-Connect"];px.GENERIC_HEADERS=["Pin","Signal","Direction","Voltage","Package_Pin","Row","Col"];let Uf=px;class Ra{static exportToXDC(t,r){const n=t.filter(s=>s.isAssigned&&s.signalName.trim()!==""),i=["# Xilinx Design Constraints (XDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),a=n.map(s=>{const o=[];if(o.push(`set_property PACKAGE_PIN ${s.pinNumber} [get_ports ${s.signalName}]`),s.voltage){const u=s.voltage==="3.3V"?"LVCMOS33":s.voltage==="1.8V"?"LVCMOS18":s.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";o.push(`set_property IOSTANDARD ${u} [get_ports ${s.signalName}]`)}return(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property DRIVE 12 [get_ports ${s.signalName}]`),o.join(`
`)}).join(`

`);return i+a}static exportToSDC(t,r){const n=t.filter(o=>o.isAssigned&&o.signalName.trim()!==""),i=o=>o.replace(/[^\w_]/g,"_").replace(/^(\d)/,"sig_$1").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),a=["# Synopsys Design Constraints (SDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),s=n.map(o=>{const u=[],f=i(o.signalName);if(u.push(`set_location_assignment PIN_${o.pinNumber} -to ${f}`),o.voltage){const d=o.voltage==="3.3V"?"LVCMOS33":o.voltage==="1.8V"?"LVCMOS18":o.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";u.push(`set_instance_assignment -name IO_STANDARD "${d}" -to ${f}`)}return(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name CURRENT_STRENGTH_NEW "12mA" -to ${f}`),(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name SLEW_RATE 1 -to ${f}`),u.join(`
`)}).join(`

`);return a+s}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Direction","Pin Type","Voltage","Bank","I/O Type","Is Assigned"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.direction,i.pinType,i.voltage,i.bank||"",i.ioType||"",i.isAssigned?"Yes":"No"]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportReport(t,r){const n=t.filter(o=>o.isAssigned),i=t.filter(o=>!o.isAssigned),a=new Map;return t.forEach(o=>{const u=o.bank||"Unknown";a.has(u)||a.set(u,{assigned:0,total:0});const f=a.get(u);f.total++,o.isAssigned&&f.assigned++}),["# FPGA Pin Assignment Report",`# Generated: ${new Date().toLocaleString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"","## Summary",`- Total Pins: ${t.length}`,`- Assigned Pins: ${n.length}`,`- Unassigned Pins: ${i.length}`,`- Assignment Rate: ${(n.length/t.length*100).toFixed(1)}%`,"","## Bank Statistics",...Array.from(a.entries()).map(([o,u])=>`- Bank ${o}: ${u.assigned}/${u.total} (${(u.assigned/u.total*100).toFixed(1)}%)`),"","## Assigned Pins",...n.map(o=>`${o.pinNumber.padEnd(8)} | ${o.signalName.padEnd(20)} | Bank ${(o.bank||"N/A").padEnd(3)} | ${o.pinType}`),"","## Pin Type Distribution",...Object.entries(t.reduce((o,u)=>(o[u.pinType]=(o[u.pinType]||0)+1,o),{})).map(([o,u])=>`- ${o}: ${u}`)].join(`
`)}static downloadFile(t,r,n="text/plain"){const i=new Blob([t],{type:n}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}class hn{static createSaveData(t){var n,i,a,s,o,u;const r=new Date().toISOString();return{metadata:{version:this.SAVE_VERSION,created:r,modified:r,appVersion:"1.0.0",description:`FPGA Pin Planning Project - ${((n=t.package)==null?void 0:n.device)||"Unknown Device"}`,author:"FPGA Pin Planner User"},package:{device:((i=t.package)==null?void 0:i.device)||"",packageType:((a=t.package)==null?void 0:a.packageType)||""},pins:t.pins.map(f=>({id:f.id,pinNumber:f.pinNumber,pinName:f.pinName,assignedSignalName:f.signalName,comment:f.comment,bank:f.bank,pinType:f.pinType,gridPosition:f.gridPosition,differentialPair:f.differentialPair})),viewSettings:{zoom:t.viewConfig.zoom,rotation:t.viewConfig.rotation,isTopView:t.viewConfig.isTopView,viewport:t.viewConfig.viewport||{x:0,y:0,scale:1},selectedPins:Array.from(t.selectedPins),filters:t.filters},projectSettings:{listViewActiveTab:((s=t.listView)==null?void 0:s.activeTab)||"overview",sidebarWidth:((o=t.ui)==null?void 0:o.sidebarWidth)||300,showDifferentialPairs:((u=t.ui)==null?void 0:u.showDifferentialPairs)||!1,customSettings:t.projectSettings||{}},history:t.history||{currentIndex:0,actions:[]}}}static async saveToFile(t,r){const n=t.package.device.replace(/[^a-zA-Z0-9]/g,"_"),i=new Date().toISOString().split("T")[0],a=`${n}_project_${i}${this.FILE_EXTENSION}`,s=r||a,o=JSON.stringify(t,null,2),u=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=s,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}static async loadFromFile(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=JSON.parse(o);if(!this.isCompatibleVersion(u.metadata.version))throw new Error(`Incompatible save file version: ${u.metadata.version}`);if(!u.package||!u.pins||!Array.isArray(u.pins))throw new Error("Invalid save file format: missing required fields");r(u)}catch(o){n(new Error(`Failed to parse save file: ${o}`))}},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static restoreProject(t){const r={id:`package-${Date.now()}`,name:t.package.device,device:t.package.device,packageType:t.package.packageType,dimensions:{rows:Math.max(...t.pins.map(i=>{var a;return Is(((a=i.gridPosition)==null?void 0:a.row)||"A")+1})),cols:Math.max(...t.pins.map(i=>{var a;return((a=i.gridPosition)==null?void 0:a.col)||1}))},totalPins:t.pins.length,pins:t.pins.map(i=>({id:i.id,pinNumber:i.pinNumber,pinName:i.pinName,signalName:i.assignedSignalName||i.originalSignalName||"",direction:"InOut",pinType:i.pinType,voltage:"3.3V",packagePin:i.pinNumber,position:this.gridToPosition(i.gridPosition||{row:"A",col:1}),gridPosition:i.gridPosition||{row:"A",col:1},isAssigned:!!i.assignedSignalName,bank:i.bank||"NA",comment:i.comment||"",differentialPair:i.differentialPair}))};return{id:`project-${Date.now()}`,name:t.metadata.description||`Restored Project ${new Date().toLocaleDateString()}`,description:t.metadata.description||"",created:new Date(t.metadata.created),modified:new Date(t.metadata.modified),projectInfo:{device:t.package.device,package:t.package.packageType,speedGrade:t.package.speedGrade||"-1",temperature:"C"},packageData:r,pinAssignments:r.pins,viewConfig:{rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,zoom:t.viewSettings.zoom,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},filters:{pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"pinNumber",sortOrder:"asc"}}}static restoreAppState(t,r){return{pins:r.pins.map(i=>{const a=t.pins.find(s=>s.id===i.id||s.pinNumber===i.pinNumber);return a?{...i,signalName:a.assignedSignalName||i.signalName,comment:a.comment||i.comment,differentialPair:a.differentialPair||i.differentialPair}:i}),selectedPins:new Set(t.viewSettings.selectedPins),viewConfig:{zoom:t.viewSettings.zoom,rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,viewport:t.viewSettings.viewport},filters:t.viewSettings.filters,listView:{activeTab:t.projectSettings.listViewActiveTab||"overview"},ui:{sidebarWidth:t.projectSettings.sidebarWidth,showDifferentialPairs:t.projectSettings.showDifferentialPairs},history:t.history,projectSettings:t.projectSettings.customSettings}}static isCompatibleVersion(t){const[r]=t.split(".").map(Number),[n]=this.SAVE_VERSION.split(".").map(Number);return r<=n}static quickSave(t){try{const r=this.createSaveData(t),n=this.compressData(r);localStorage.setItem(this.QUICKSAVE_KEY,n),localStorage.setItem(this.QUICKSAVE_TIMESTAMP_KEY,new Date().toISOString()),console.log(" Quick save completed")}catch(r){throw console.error("Failed to quick save:",r),new Error(`Quick save failed: ${r}`)}}static quickLoad(){try{const t=localStorage.getItem(this.QUICKSAVE_KEY);return t?this.decompressData(t):null}catch(t){return console.error("Failed to load quicksave:",t),null}}static getQuickSaveInfo(){const t=localStorage.getItem(this.QUICKSAVE_TIMESTAMP_KEY);return{exists:localStorage.getItem(this.QUICKSAVE_KEY)!==null,timestamp:t||void 0}}static clearQuickSave(){localStorage.removeItem(this.QUICKSAVE_KEY),localStorage.removeItem(this.QUICKSAVE_TIMESTAMP_KEY)}static compressData(t){const r={metadata:{version:t.metadata.version,created:t.metadata.created},package:t.package,pins:t.pins.map(n=>({id:n.id,pinNumber:n.pinNumber,assignedSignalName:n.assignedSignalName,comment:n.comment,...n.differentialPair&&{differentialPair:n.differentialPair},...n.custom&&Object.keys(n.custom).length>0&&{custom:n.custom}})),viewSettings:t.viewSettings,projectSettings:t.projectSettings};return JSON.stringify(r)}static decompressData(t){const r=JSON.parse(t);return{metadata:{version:r.metadata.version,created:r.metadata.created,modified:new Date().toISOString(),appVersion:"1.0.0",description:"Quick Save Data"},package:r.package,pins:r.pins,viewSettings:r.viewSettings,projectSettings:r.projectSettings||{},constraints:{},history:{currentIndex:0,actions:[]}}}static gridToPosition(t){const r=Is(t.row),i=88,a=(t.col-1)*i,s=r*i;return{x:Math.round(a),y:Math.round(s)}}}hn.SAVE_VERSION="1.0.0";hn.FILE_EXTENSION=".fpgaproj";hn.QUICKSAVE_KEY="fpga-planner-quicksave";hn.QUICKSAVE_TIMESTAMP_KEY="fpga-planner-quicksave-timestamp";class Ht{static getDifferentialPairType(t){const r=t.toLowerCase();if(r.endsWith("_p"))return"positive";if(r.endsWith("_n"))return"negative";if(r.endsWith("+"))return"positive";if(r.endsWith("-"))return"negative";if(r.endsWith("p")&&!r.endsWith("_p")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"positive"}if(r.endsWith("n")&&!r.endsWith("_n")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"negative"}const n=r.match(/^(.+_l\d+)([pn])(_.*)?$/);if(n){const i=n[2];if(i==="p")return"positive";if(i==="n")return"negative"}return null}static getPairPinName(t){const r=t.toLowerCase(),n=t;if(r.endsWith("_p"))return n.slice(0,-2)+"_N";if(r.endsWith("_n"))return n.slice(0,-2)+"_P";if(r.endsWith("+"))return n.slice(0,-1)+"-";if(r.endsWith("-"))return n.slice(0,-1)+"+";if(r.endsWith("p")&&!r.endsWith("_p")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"N"}if(r.endsWith("n")&&!r.endsWith("_n")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"P"}const i=n.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const s=i[1],o=i[2].toUpperCase(),u=i[3]||"";if(o==="P")return s+"N"+u;if(o==="N")return s+"P"+u}const a=r.match(/^(.+?)(\d+)$/);if(a){const s=a[1],o=parseInt(a[2]),u=o%2===0?o+1:o-1;return n.substring(0,s.length)+u}return null}static findPairPin(t,r){const n=this.getPairPinName(t.pinName);if(n){const a=r.find(s=>s.pinName.toLowerCase()===n.toLowerCase()&&s.bank===t.bank);if(a)return a}const i=t.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const a=i[1],o=i[2].toUpperCase()==="P"?"N":"P",u=r.find(f=>{if(f.bank!==t.bank)return!1;const d=f.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(d){const p=d[1],g=d[2].toUpperCase();return p.toLowerCase()===a.toLowerCase()&&g===o}return!1});if(u)return u}if(t.signalName){const a=this.getPairPinName(t.signalName);if(a){const s=r.find(o=>o.signalName&&o.signalName.toLowerCase()===a.toLowerCase()&&o.bank===t.bank);if(s)return s}}return null}static isDifferentialPin(t){return!!(this.getDifferentialPairType(t.pinName)!==null||t.signalName&&this.getDifferentialPairType(t.signalName)!==null)}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);const n=r.match(/^(.+?)(\d+)$/);return n?t.substring(0,n[1].length):t}static getDifferentialPriority(t){const r=this.getDifferentialPairType(t.pinName),n=t.signalName?this.getDifferentialPairType(t.signalName):null,i=r||n;return i==="positive"?1:i==="negative"?2:3}}const eu=["1.0V","1.2V","1.5V","1.8V","2.5V","3.3V","5.0V"],Hd=["LVCMOS12","LVCMOS15","LVCMOS18","LVCMOS25","LVCMOS33","LVTTL","LVDS_18","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","PPDS_25","TMDS_33","SSTL135","SSTL15","SSTL18_I","SSTL18_II","SSTL2_I","SSTL2_II","SSTL3_I","SSTL3_II","POD10","POD12","POD135","POD15","DDR3","DDR4","DDR5","HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18","PCI","PCIX","GTL_PLUS","AUTO"],yI={"1.0V":"POD10","1.2V":"LVCMOS12","1.5V":"LVCMOS15","1.8V":"LVCMOS18","2.5V":"LVCMOS25","3.3V":"LVCMOS33","5.0V":"LVTTL"},T8={"1.0V":["POD10"],"1.2V":["LVCMOS12","POD12","SSTL135"],"1.5V":["LVCMOS15","SSTL15","HSTL_I","HSTL_II","POD15"],"1.8V":["LVCMOS18","SSTL18_I","SSTL18_II","HSTL_I_18","HSTL_II_18","LVDS_18"],"2.5V":["LVCMOS25","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","PPDS_25","SSTL2_I","SSTL2_II"],"3.3V":["LVCMOS33","LVTTL","TMDS_33","SSTL3_I","SSTL3_II","PCI","PCIX"],"5.0V":["LVTTL","GTL_PLUS"]},_I=[2,4,6,8,12,16,20,24],SI=["SLOW","FAST"];function Wd(e){return T8[e]||["LVCMOS33"]}function Fo(e){return yI[e]||"LVCMOS33"}function wI(e,t){return t==="AUTO"?!0:(T8[e]||[]).includes(t)}const kI=({pin:e,isSelected:t,onSelect:r,onAssignSignal:n,onUpdatePin:i,isPairPin:a=!1,isDifferentialPairPartner:s=!1})=>{var m,y,C;const[o,u]=Se.useState(!1),f=S=>{n(e.id,S.target.value)},d=(S,w)=>{var T;if(!i)return;const x={};if(S==="direction")x.direction=w;else if(S==="voltage"){x.voltage=w;const A=((T=e.attributes)==null?void 0:T.IO_Standard)||e.ioType||"AUTO";if(A==="AUTO"||!Wd(w).includes(A)){const F=Fo(w);x.attributes={...e.attributes,IO_Standard:F},x.ioType=F}}else S==="ioStandard"?(x.attributes={...e.attributes,IO_Standard:w},x.ioType=w):S==="driveStrength"?x.attributes={...e.attributes,Drive_Strength:w}:S==="slewRate"&&(x.attributes={...e.attributes,Slew_Rate:w});console.log("PinItem updating pin:",e.id,"with updates:",x),i(e.id,x)},p=S=>({IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999"})[S]||"#666666",g=Ht.getDifferentialPairType(e.pinName)||(e.signalName?Ht.getDifferentialPairType(e.signalName):null),v=Ht.isDifferentialPin(e);return["POWER","GROUND","NC"].includes(e.pinType),E.jsxs("div",{className:`pin-item ${t?"selected":""}`,onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",padding:"8px 12px",margin:"2px 0",backgroundColor:t?"#444":s?"#3d4852":a?"#2d3748":"#2a2a2a",borderRadius:"4px",cursor:"pointer",border:`2px solid ${t?"#4A90E2":s?"#f59e0b":a?"#9333ea":"transparent"}`,position:"relative"},children:[v&&E.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",fontSize:"10px",color:g==="positive"?"#22c55e":"#ef4444",fontWeight:"bold"},title:`Differential ${g==="positive"?"Positive":"Negative"} Pin`,children:g==="positive"?"+":"-"}),s&&E.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"12px",color:"#f59e0b",fontWeight:"bold"},title:"Differential Pair Partner of Selected Pin",children:""}),a&&!s&&E.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"10px",color:"#9333ea",fontWeight:"bold"},title:"Differential Pair Pin",children:""}),E.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[E.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:p(e.pinType),marginRight:"8px",flexShrink:0}}),E.jsx("div",{style:{minWidth:"60px",fontFamily:"monospace",fontSize:"12px",color:"#ccc"},children:e.pinNumber}),E.jsx("div",{style:{minWidth:"120px",fontSize:"11px",color:"#999",marginRight:"8px",flex:1},children:e.pinName}),E.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:e.isAssigned?"#4AE24A":"#666",marginLeft:"8px",flexShrink:0}})]}),E.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:E.jsx("input",{type:"text",value:e.signalName,onChange:f,placeholder:"Signal name",onClick:S=>S.stopPropagation(),style:{flex:1,padding:"4px 8px",fontSize:"12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"}})}),!["POWER","GROUND","NC"].includes(e.pinType)&&E.jsxs("div",{style:{display:"flex",gap:"6px",marginTop:"4px",marginBottom:"4px"},children:[E.jsx("div",{style:{flex:1},children:E.jsxs("select",{value:e.direction,onChange:S=>{S.stopPropagation(),d("direction",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"2px 4px",fontSize:"10px",backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"3px",color:"#ccc"},children:[E.jsx("option",{value:"",children:"---Direction---"}),E.jsx("option",{value:"Input",children:"Input"}),E.jsx("option",{value:"Output",children:"Output"}),E.jsx("option",{value:"InOut",children:"InOut"}),E.jsx("option",{value:"Clock",children:"Clock"}),E.jsx("option",{value:"Reset",children:"Reset"})]})}),E.jsx("div",{style:{flex:1},children:E.jsxs("select",{value:((m=e.attributes)==null?void 0:m.IO_Standard)||e.ioType||"AUTO",onChange:S=>{S.stopPropagation(),d("ioStandard",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"2px 4px",fontSize:"10px",backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"3px",color:"#ccc"},children:[E.jsx("option",{value:"",children:"---Standards---"}),E.jsx("option",{value:"AUTO",children:"AUTO"}),Wd(e.voltage||"3.3V").map(S=>E.jsx("option",{value:S,children:S},S))]})})]}),e.bank&&E.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"11px",color:"#666"},children:[E.jsx("span",{style:{marginRight:"4px"},children:""}),E.jsxs("span",{children:["Bank ",e.bank]})]}),!["POWER","GROUND","NC"].includes(e.pinType)&&E.jsxs("div",{style:{marginTop:"6px"},children:[E.jsxs("button",{onClick:S=>{S.stopPropagation(),u(!o)},style:{width:"100%",padding:"2px 6px",fontSize:"9px",backgroundColor:o?"#2563eb":"#374151",border:"1px solid #555",borderRadius:"2px",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[E.jsx("span",{children:"Advanced"}),E.jsx("span",{style:{fontSize:"7px"},children:o?"":""})]}),o&&E.jsxs("div",{style:{marginTop:"4px",padding:"6px",backgroundColor:"#1e1e1e",border:"1px solid #333",borderRadius:"3px"},children:[E.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"4px"},children:[E.jsxs("div",{style:{flex:1},children:[E.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Voltage"}),E.jsx("select",{value:e.voltage||"3.3V",onChange:S=>{S.stopPropagation(),d("voltage",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:eu.map(S=>E.jsx("option",{value:S,children:S},S))})]}),E.jsxs("div",{style:{flex:1},children:[E.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Drive Strength"}),E.jsx("select",{value:((y=e.attributes)==null?void 0:y.Drive_Strength)||"12",onChange:S=>{S.stopPropagation(),d("driveStrength",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:_I.map(S=>E.jsxs("option",{value:S,children:[S,"mA"]},S))})]})]}),E.jsxs("div",{children:[E.jsx("label",{style:{fontSize:"8px",color:"#999",display:"block",marginBottom:"1px"},children:"Slew Rate"}),E.jsx("select",{value:((C=e.attributes)==null?void 0:C.Slew_Rate)||"FAST",onChange:S=>{S.stopPropagation(),d("slewRate",S.target.value)},onClick:S=>S.stopPropagation(),style:{width:"100%",padding:"1px 3px",fontSize:"9px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"2px",color:"#fff"},children:SI.map(S=>E.jsx("option",{value:S,children:S},S))})]})]})]})]})},EI=({isOpen:e,onClose:t,onExport:r,pins:n,currentPackage:i})=>{const[a,s]=Se.useState("xdc"),[o,u]=Se.useState(!1);if(!e)return null;const f=[{value:"xdc",label:"XDC (Xilinx)",description:"Xilinx Design Constraints format for Vivado and ISE",icon:"",example:"set_property PACKAGE_PIN A1 [get_ports clk]"},{value:"sdc",label:"SDC (Intel/Altera)",description:"Synopsys Design Constraints format for Quartus",icon:"",example:"set_location_assignment PIN_A1 -to clk"}],d=f.find(m=>m.value===a),p=n.filter(m=>m.isAssigned&&m.signalName.trim()!=="").length,g=()=>{r(a),t()},v=()=>{if(!o)return null;const m=n.filter(y=>y.isAssigned&&y.signalName.trim()!=="").slice(0,3);return a==="xdc"?Ra.exportToXDC(m,i):Ra.exportToSDC(m,i)};return E.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:E.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",padding:"24px",width:"500px",maxHeight:"80vh",overflow:"auto",color:"white"},children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[E.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"Export Constraint File"}),E.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"20px",cursor:"pointer",padding:"4px"},children:""})]}),E.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#ccc"},children:[p," assigned pins will be exported"]}),E.jsxs("div",{style:{marginBottom:"20px"},children:[E.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:"Choose constraint file format:"}),f.map(m=>E.jsxs("div",{style:{border:`2px solid ${a===m.value?"#007acc":"#444"}`,borderRadius:"6px",padding:"12px",marginBottom:"8px",cursor:"pointer",backgroundColor:a===m.value?"#1a4c80":"#333",transition:"all 0.2s ease"},onClick:()=>s(m.value),children:[E.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[E.jsx("span",{style:{fontSize:"16px",marginRight:"8px"},children:m.icon}),E.jsx("span",{style:{fontWeight:"bold",fontSize:"16px"},children:m.label})]}),E.jsx("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"6px"},children:m.description}),E.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:"#bbb",backgroundColor:"#1a1a1a",padding:"4px 8px",borderRadius:"3px"},children:["Example: ",m.example]})]},m.value))]}),p>0&&E.jsxs("div",{style:{marginBottom:"20px"},children:[E.jsx("button",{onClick:()=>u(!o),style:{backgroundColor:"#444",border:"1px solid #666",borderRadius:"4px",color:"white",padding:"6px 12px",cursor:"pointer",fontSize:"12px"},children:o?"Hide Preview":"Show Preview"}),o&&E.jsx("div",{style:{marginTop:"8px",backgroundColor:"#1a1a1a",border:"1px solid #444",borderRadius:"4px",padding:"12px",maxHeight:"200px",overflow:"auto"},children:E.jsx("pre",{style:{margin:0,fontSize:"11px",color:"#ddd",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:v()})})]}),E.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[E.jsx("button",{onClick:t,style:{backgroundColor:"#666",border:"1px solid #888",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),E.jsxs("button",{onClick:g,disabled:p===0,style:{backgroundColor:p>0?"#007acc":"#555",border:"1px solid #007acc",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:p>0?"pointer":"not-allowed",fontSize:"14px",opacity:p>0?1:.6},children:["Export ",d==null?void 0:d.label]})]})]})})},fg=[{id:"overview",title:"Overview",icon:"",description:"All pins with key information",showSearch:!0,showFilters:!0,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}]},{id:"signals",title:"Signals",icon:"",description:"Assigned signal information",showSearch:!0,showFilters:!0,columns:[{key:"signalName",title:"Signal Name",width:140,editable:!0,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"direction",title:"Direction",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>!!(e.signalName&&e.signalName.trim()!==""),sort:(e,t)=>(e.signalName||"").localeCompare(t.signalName||"")},{id:"bankGroups",title:"Bank Stats",icon:"",description:"Dynamic bank groups statistics and analysis",showSearch:!1,showFilters:!1,isCustomComponent:!0,columns:[],filter:()=>!0,sort:()=>0},{id:"banks",title:"Banks",icon:"",description:"Pin organization by I/O banks",showSearch:!0,showFilters:!0,columns:[{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioType",title:"I/O Type",width:80,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>!!(e.bank&&e.bank.trim()!==""),sort:(e,t)=>{const r=parseInt(e.bank||"999"),n=parseInt(t.bank||"999");return r-n}},{id:"differential",title:"Diff Pairs",icon:"",description:"Differential pair management",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"differentialPair",title:"Pair Name",width:100,sortable:!0,customRender:(e,t)=>t.differentialPair?`${t.differentialPair.pair} (${t.differentialPair.type})`:"-"},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>e.differentialPair!==void 0,sort:(e,t)=>{var i,a;const r=((i=e.differentialPair)==null?void 0:i.pair)||"",n=((a=t.differentialPair)==null?void 0:a.pair)||"";return r.localeCompare(n)}},{id:"comments",title:"Comments",icon:"",description:"All pins with user comments",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"signalName",title:"Signal",width:100,sortable:!0},{key:"comment",title:"Comment",width:300,editable:!0},{key:"commentTimestamp",title:"Modified",width:120,render:"datetime",sortable:!0},{key:"commentAuthor",title:"Author",width:80,sortable:!0}],filter:e=>!!(e.comment&&e.comment.trim()!==""),sort:(e,t)=>{var i,a;const r=((i=e.commentTimestamp)==null?void 0:i.getTime())||0;return(((a=t.commentTimestamp)==null?void 0:a.getTime())||0)-r}},{id:"power",title:"Power",icon:"",description:"Power and ground pins",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>e.pinType==="POWER"||e.pinType==="GROUND"||e.direction==="Power"||e.direction==="Ground",sort:(e,t)=>e.pinNumber.localeCompare(t.pinNumber)}],CI=({value:e,onSave:t,options:r,editable:n=!1,placeholder:i="",className:a="",allowCustomValue:s=!1,getDisplayValue:o})=>{const[u,f]=Se.useState(!1),[d,p]=Se.useState(e||""),g=Se.useRef(null),v=()=>{d!==e&&t(d),f(!1)},m=()=>{p(e||""),f(!1)},y=S=>{S.key==="Enter"?(S.preventDefault(),v()):S.key==="Escape"&&(S.preventDefault(),m())};if(Se.useEffect(()=>{u&&g.current&&g.current.focus()},[u]),Se.useEffect(()=>{p(e||"")},[e]),!n){const S=o?o(e):e;return E.jsx("span",{className:`table-cell-readonly ${a}`,children:S||"-"})}if(u)return E.jsxs("select",{ref:g,value:d,onChange:S=>p(S.target.value),onBlur:v,onKeyDown:y,className:`table-cell-select ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"},children:[i&&E.jsx("option",{value:"",disabled:!0,children:i}),r.map(S=>E.jsx("option",{value:S,children:o?o(S):S},S)),s&&d&&!r.includes(d)&&E.jsxs("option",{value:d,children:[d," (Custom)"]})]});const C=o?o(e):e;return E.jsxs("div",{className:`table-cell-selectable ${a}`,onClick:()=>f(!0),title:"Click to select",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"pointer",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:S=>{S.currentTarget.style.borderColor="#555",S.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:S=>{S.currentTarget.style.borderColor="transparent",S.currentTarget.style.backgroundColor="transparent"},children:[E.jsx("span",{children:C||E.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:i})}),E.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:"4px"},children:""})]})},dg=({value:e,onSave:t,editable:r=!1,placeholder:n="",maxLength:i=500,className:a="",type:s="text",options:o=[],allowCustomValue:u=!1,getDisplayValue:f})=>{const[d,p]=Se.useState(!1),[g,v]=Se.useState(e||""),m=Se.useRef(null),y=()=>{g!==e&&t(g),p(!1)},C=()=>{v(e||""),p(!1)},S=w=>{w.key==="Enter"?(w.preventDefault(),y()):w.key==="Escape"&&(w.preventDefault(),C())};return Se.useEffect(()=>{d&&m.current&&(m.current.focus(),m.current.select())},[d]),Se.useEffect(()=>{v(e||"")},[e]),s==="select"?E.jsx(CI,{value:e,onSave:t,options:o,editable:r,placeholder:n,className:a,allowCustomValue:u,getDisplayValue:f}):(Se.useEffect(()=>{v(e||"")},[e]),r?d?E.jsx("input",{ref:m,type:"text",value:g,onChange:w=>v(w.target.value),onBlur:y,onKeyDown:S,placeholder:n,maxLength:i,className:`table-cell-input ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"}}):E.jsx("div",{className:`table-cell-editable ${a}`,onClick:()=>p(!0),title:"Click to edit",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"text",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.borderColor="#555",w.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:w=>{w.currentTarget.style.borderColor="transparent",w.currentTarget.style.backgroundColor="transparent"},children:e||E.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:n})}):E.jsx("span",{className:`table-cell-readonly ${a}`,children:e||"-"}))},TI="#e0e0e0",AI="#ccc",PI="#cccccc",FI="#FFF",NI="#000",RI="#374151",bI="#666",II=[TI,AI,PI,FI,NI,RI,bI],DI=[{min:224,max:255,channels:["r","g","b"]},{min:0,max:48,channels:["r","g","b"]},{min:192,max:208,channels:["r","g","b"]}];function OI(e,t,r){for(const n of DI)if(n.channels.every(a=>{const s=a==="r"?e:a==="g"?t:r;return s>=n.min&&s<=n.max}))return!0;for(const n of II){const i=parseInt(n.slice(1,3),16),a=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);if(Math.sqrt(Math.pow(e-i,2)+Math.pow(t-a,2)+Math.pow(r-s,2))<80)return!0}return!1}function LI(e){const t=[],r=.618033988749895,n=.7,i=.5;for(let a=0;a<e;a++){let s=a*r%1,o=0,u=!1;for(;!u&&o<10;){const f=MI(s,n,i);OI(f.r,f.g,f.b)?(s=(s+.1)%1,o++):(t.push(`#${f.r.toString(16).padStart(2,"0")}${f.g.toString(16).padStart(2,"0")}${f.b.toString(16).padStart(2,"0")}`),u=!0)}u||t.push(`#${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}`)}return t}function MI(e,t,r){let n,i,a;if(t===0)n=i=a=r;else{const s=(f,d,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?f+(d-f)*6*p:p<.5?d:p<.6666666666666666?f+(d-f)*(.6666666666666666-p)*6:f),o=r<.5?r*(1+t):r+t-r*t,u=2*r-o;n=s(u,o,e+1/3),i=s(u,o,e),a=s(u,o,e-1/3)}return{r:Math.round(n*255),g:Math.round(i*255),b:Math.round(a*255)}}const Vc=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#F39C12","#E74C3C","#9B59B6","#3498DB","#1ABC9C","#2ECC71","#F1C40F","#E67E22","#E91E63","#673AB7"];function go(e){if(!e||e==="NA")return"#708090";if(e==="POWER"||e==="VCC")return"#8B4513";if(e==="GROUND"||e==="GND")return"#2C2C2C";const t=parseInt(e);if(!isNaN(t)){if(t<Vc.length)return Vc[t];{const i=LI(t-Vc.length+1);return i[i.length-1]}}let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)&4294967295;const n=Math.abs(r)%Vc.length;return Vc[n]}const A8=(e,t,r)=>{if(t)return"#2d4f75";if(!e)return r?"#2a2a2a":"#1a1a1a";const n=go(e),i=BI(n,.7);return r?jI(i,.2):i},BI=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.max(0,(r>>16)-n),a=Math.max(0,(r>>8&255)-n),s=Math.max(0,(r&255)-n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},jI=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.min(255,(r>>16)+n),a=Math.min(255,(r>>8&255)+n),s=Math.min(255,(r&255)+n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},Gc=48,I3=5,UI=({pins:e,columns:t,selectedRows:r,hoveredRowId:n,sortColumn:i,sortDirection:a,onRowSelection:s,onPinSelect:o,onHover:u,onColumnSort:f,renderCellContent:d})=>{const[p,g]=Se.useState(0),[v,m]=Se.useState(400),y=Se.useRef(null),C=Se.useRef(null),S=Se.useMemo(()=>{const A=Math.floor(p/Gc),F=Math.ceil(v/Gc),N=Math.min(A+F+I3*2,e.length),P=Math.max(0,A-I3);return{start:P,end:N,visibleCount:N-P}},[p,v,e.length]),w=Se.useMemo(()=>e.slice(S.start,S.end),[e,S.start,S.end]),x=Se.useCallback(A=>{const F=A.target;console.log(" Scroll Event:",{scrollTop:F.scrollTop,scrollHeight:F.scrollHeight,clientHeight:F.clientHeight,maxScroll:F.scrollHeight-F.clientHeight}),g(F.scrollTop)},[]);Se.useEffect(()=>{const A=()=>{if(y.current){const N=y.current.getBoundingClientRect();m(N.height)}};A();const F=new ResizeObserver(A);return y.current&&F.observe(y.current),()=>{F.disconnect()}},[]);const T=e.length*Gc;return Se.useEffect(()=>{console.log(" VirtualizedPinList Debug:",{totalPins:e.length,visibleCount:S.visibleCount,visiblePercent:Math.round(S.visibleCount/e.length*100),totalHeight:T,containerHeight:v,scrollTop:p,visibleStart:S.start,visibleEnd:S.end})},[S.visibleCount,e.length,T,v,p,S.start,S.end]),E.jsxs("div",{ref:y,style:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},children:[E.jsx("div",{style:{backgroundColor:"#2a2a2a",borderBottom:"2px solid #444",flexShrink:0,zIndex:10},children:E.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:E.jsx("thead",{children:E.jsxs("tr",{children:[E.jsx("th",{style:{width:"40px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",backgroundColor:"#2a2a2a",color:"#ffffff"},children:E.jsx("input",{type:"checkbox",checked:e.length>0&&r.size===e.length,onChange:A=>{const F=A.target.checked?new Set(e.map(N=>N.id)):new Set;e.forEach(N=>{r.has(N.id)!==F.has(N.id)&&s(N.id,F.has(N.id))})}})}),t.map(A=>{const F=i===A.key,N=A.sortable!==!1;return E.jsx("th",{style:{width:`${A.width}px`,padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a",cursor:N?"pointer":"default",userSelect:"none",position:"relative"},onClick:()=>{N&&f&&f(A.key)},title:N?`Click to sort by ${A.title}`:void 0,children:E.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[E.jsx("span",{children:A.title}),N&&E.jsx("span",{style:{marginLeft:"4px",fontSize:"12px",opacity:F?1:.3,transition:"opacity 0.2s ease"},children:F?a==="asc"?"":"":""})]})},A.key)})]})})})}),E.jsx("div",{ref:C,onScroll:x,style:{flex:1,overflow:"auto",position:"relative",scrollbarWidth:"thin",scrollbarColor:"#555 #2a2a2a"},className:"virtualized-list-scroll",children:E.jsx("div",{style:{height:T,position:"relative"},children:E.jsx("div",{style:{position:"absolute",top:S.start*Gc,left:0,right:0},children:E.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:E.jsx("tbody",{children:w.map(A=>{const F=n===A.id,N=A8(A.bank,r.has(A.id),F);return E.jsxs("tr",{style:{backgroundColor:N,cursor:"pointer",borderBottom:"1px solid #333",color:"#ffffff",height:`${Gc}px`},onClick:()=>o==null?void 0:o(A.id),onMouseEnter:()=>u(A.id),onMouseLeave:()=>u(null),children:[E.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"40px"},children:E.jsx("input",{type:"checkbox",checked:r.has(A.id),onChange:P=>s(A.id,P.target.checked),onClick:P=>P.stopPropagation()})}),t.map(P=>E.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",fontSize:"14px",maxWidth:`${P.width}px`,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:I=>P.editable&&I.stopPropagation(),children:d(A,P)},P.key))]},A.id)})})})})})})]})};class hg{static calculateBankStatistics(t){const r=new Map;t.forEach(p=>{const g=p.bank||"UNASSIGNED";r.has(g)||r.set(g,[]),r.get(g).push(p)});const n=[];let i=0;Array.from(r.entries()).forEach(([p,g])=>{const v=g.filter(F=>{var N;return F.isAssigned||!!((N=F.signalName)!=null&&N.trim())}),m=g.filter(F=>{var N;return!F.isAssigned&&!((N=F.signalName)!=null&&N.trim())});i+=v.length;const y={};g.forEach(F=>{const N=F.pinType||"UNKNOWN";y[N]=(y[N]||0)+1});const C={};g.forEach(F=>{const N=F.voltage||"UNSPECIFIED";C[N]=(C[N]||0)+1});const S={};g.forEach(F=>{const N=F.direction||"UNSPECIFIED";S[N]=(S[N]||0)+1});const w=g.filter(F=>{var N,P;return F.differentialPair||((N=F.pinName)==null?void 0:N.includes("_P"))||((P=F.pinName)==null?void 0:P.includes("_N"))}).length/2,x=new Map;v.forEach(F=>{if(F.signalName){const N=this.inferSignalType(F.signalName);x.set(N,(x.get(N)||0)+1)}});const T=Array.from(x.entries()).filter(([,F])=>F>=2).sort((F,N)=>N[1]-F[1]).slice(0,3).map(([F])=>F),A=g.length>0?v.length/g.length*100:0;n.push({bankId:p,totalPins:g.length,assignedPins:v.length,unassignedPins:m.length,utilizationRate:A,pinsByType:y,pinsByVoltage:C,pinsByDirection:S,differentialPairs:Math.floor(w),majorSignalTypes:T})}),n.sort((p,g)=>{if(p.bankId==="UNASSIGNED")return 1;if(g.bankId==="UNASSIGNED")return-1;const v=parseInt(p.bankId),m=parseInt(g.bankId);return!isNaN(v)&&!isNaN(m)?v-m:p.bankId.localeCompare(g.bankId)});const a=t.length,s=a>0?i/a*100:0,o=n.filter(p=>p.bankId!=="UNASSIGNED").map(p=>({id:p.bankId,rate:p.utilizationRate})),u=o.length>0?o.reduce((p,g)=>g.rate>p.rate?g:p):{id:"N/A",rate:0},f=o.length>0?o.reduce((p,g)=>g.rate<p.rate?g:p):{id:"N/A",rate:0},d=Array.from(new Set(t.map(p=>p.pinType).filter(Boolean))).sort();return{totalBanks:r.size,totalPins:a,overallUtilization:s,bankStats:n,mostUtilizedBank:u.id,leastUtilizedBank:f.id,bankTypes:d}}static inferSignalType(t){const r=t.toUpperCase();return r.includes("CLK")?"CLOCK":r.includes("RST")||r.includes("RESET")?"RESET":r.includes("PWR")||r.includes("VCC")||r.includes("POWER")?"POWER":r.includes("GND")||r.includes("GROUND")?"GROUND":r.includes("DATA")||r.includes("D[")?"DATA":r.includes("ADDR")||r.includes("A[")?"ADDRESS":r.includes("CS")||r.includes("CE")||r.includes("EN")?"CONTROL":r.includes("LED")?"LED":r.includes("BTN")||r.includes("SW")?"USER_INPUT":r.includes("UART")||r.includes("TX")||r.includes("RX")?"UART":r.includes("SPI")||r.includes("I2C")?"SERIAL":r.includes("USB")?"USB":r.includes("ETH")||r.includes("RMII")||r.includes("RGMII")?"ETHERNET":r.includes("DDR")||r.includes("SDRAM")?"MEMORY":r.includes("HDMI")||r.includes("LVDS")?"DISPLAY":r.includes("_P")||r.includes("_N")?"DIFFERENTIAL":"GENERAL_IO"}static exportBankStatisticsCSV(t){const r=["Bank ID","Total Pins","Assigned Pins","Unassigned Pins","Utilization (%)","Main Pin Types","Main Voltages","Differential Pairs","Major Signal Types"],n=t.bankStats.map(i=>[i.bankId,i.totalPins.toString(),i.assignedPins.toString(),i.unassignedPins.toString(),i.utilizationRate.toFixed(1),Object.entries(i.pinsByType).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),Object.entries(i.pinsByVoltage).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),i.differentialPairs.toString(),i.majorSignalTypes.join("; ")]);return[r.join(","),...n.map(i=>i.map(a=>`"${a}"`).join(","))].join(`
`)}static generateRecommendations(t){const r=[];t.overallUtilization>90?r.push(" Overall utilization is very high (>90%). Consider using a larger package or optimizing pin assignments."):t.overallUtilization<30&&r.push(" Overall utilization is low (<30%). A smaller package might be more cost-effective.");const n=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED").map(a=>a.utilizationRate);if(n.length>1){const a=Math.max(...n),s=Math.min(...n),o=a-s;o>50&&r.push(` Bank utilization is unbalanced (${o.toFixed(1)}% variance). Consider redistributing signals.`)}const i=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED"&&a.assignedPins===0);return i.length>0&&r.push(` ${i.length} banks are completely unused: ${i.map(a=>a.bankId).join(", ")}`),r}}const zI=({pins:e})=>{const[t,r]=Se.useState(null),[n,i]=Se.useState("bankId"),[a,s]=Se.useState("asc"),{visibleBanks:o,toggleBankVisibility:u,showAllBanks:f}=Yi(),d=Se.useMemo(()=>hg.calculateBankStatistics(e),[e]),p=Se.useMemo(()=>{const A=[...d.bankStats];return A.sort((F,N)=>{let P=0;switch(n){case"bankId":if(F.bankId==="UNASSIGNED")P=1;else if(N.bankId==="UNASSIGNED")P=-1;else{const I=parseInt(F.bankId),b=parseInt(N.bankId);!isNaN(I)&&!isNaN(b)?P=I-b:P=F.bankId.localeCompare(N.bankId)}break;case"utilization":P=F.utilizationRate-N.utilizationRate;break;case"totalPins":P=F.totalPins-N.totalPins;break}return a==="asc"?P:-P}),A},[d.bankStats,n,a]),g=A=>{n===A?s(a==="asc"?"desc":"asc"):(i(A),s("asc"))},v=()=>{const A=hg.exportBankStatisticsCSV(d),F=new Blob([A],{type:"text/csv"}),N=URL.createObjectURL(F),P=document.createElement("a");P.href=N,P.download=`bank-statistics-${new Date().toISOString().slice(0,10)}.csv`,P.click(),URL.revokeObjectURL(N)},m=Se.useMemo(()=>hg.generateRecommendations(d),[d]),y=A=>n!==A?"":a==="asc"?"":"",C=A=>o.size===0?!0:o.has(A),S=A=>{console.log(` Bank ${A} clicked! Current visibility:`,C(A)),alert(`Bank ${A} clicked!`),u(A)},w=()=>{console.log(" Show all banks clicked"),alert("Show all banks clicked!"),f()},x=A=>{if(A==="UNASSIGNED")return{backgroundColor:"#6b7280",color:"white"};const F=go(A),N=C(A);return{backgroundColor:N?`${F}20`:`${F}05`,borderLeft:`4px solid ${F}`,color:N?"#1f2937":"#9ca3af",opacity:N?1:.5}},T=A=>`${A.toFixed(1)}%`;return E.jsxs("div",{className:"bank-groups-panel p-4 space-y-4",children:[E.jsxs("div",{className:"flex justify-between items-center",children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Groups Statistics"}),E.jsx("button",{onClick:v,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:" Export CSV"})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[E.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Banks"}),E.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.totalBanks})]}),E.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Pins"}),E.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.totalPins})]}),E.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overall Utilization"}),E.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T(d.overallUtilization)})]}),E.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[E.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Most Utilized"}),E.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["Bank ",d.mostUtilizedBank]})]})]}),m.length>0&&E.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Recommendations"}),E.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:m.map((A,F)=>E.jsxs("li",{children:[" ",A]},F))})]}),E.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-red-800 mb-2",children:" Debug Test Buttons"}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:()=>alert("Simple button works!"),className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Test Simple Click"}),E.jsx("button",{onClick:w,className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Test Show All"}),E.jsx("button",{onClick:()=>S("TEST"),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Bank Click"})]})]}),E.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[E.jsxs("div",{className:"p-4 border-b",children:[E.jsxs("div",{className:"flex justify-between items-center",children:[E.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Bank Details"}),E.jsx("div",{className:"flex gap-2",children:E.jsx("button",{onClick:w,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",title:"Show all banks",children:" Show All"})})]}),E.jsxs("div",{className:"flex justify-between items-center",children:[E.jsx("p",{className:"text-sm text-gray-600 mt-1",children:" Click on any bank row to toggle its visibility in the pin list"}),E.jsxs("div",{className:"text-xs text-gray-400",children:["Visible Banks: ",o.size===0?"All":Array.from(o).join(", ")]})]})]}),E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full",children:[E.jsx("thead",{className:"bg-gray-50",children:E.jsxs("tr",{children:[E.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("bankId"),children:["Bank ID ",y("bankId")]}),E.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("totalPins"),children:["Total Pins ",y("totalPins")]}),E.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),E.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("utilization"),children:["Utilization ",y("utilization")]}),E.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Main Types"}),E.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diff Pairs"}),E.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),E.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(A=>E.jsxs(kr.Fragment,{children:[E.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200",style:x(A.bankId),onClick:()=>S(A.bankId),title:`Click to ${C(A.bankId)?"hide":"show"} Bank ${A.bankId} pins`,children:[E.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:E.jsxs("div",{className:"flex items-center",children:[E.jsxs("div",{className:"flex items-center mr-2",children:[E.jsx("span",{className:"text-lg mr-1",children:C(A.bankId)?"":""}),E.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A.bankId==="UNASSIGNED"?"#6b7280":go(A.bankId)}})]}),E.jsx("span",{className:"text-sm font-medium",children:A.bankId==="UNASSIGNED"?"Unassigned":`Bank ${A.bankId}`})]})}),E.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.totalPins}),E.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[E.jsx("span",{className:"text-green-600 font-medium",children:A.assignedPins}),E.jsxs("span",{className:"text-gray-400",children:["/",A.unassignedPins]})]}),E.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:E.jsxs("div",{className:"flex items-center",children:[E.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:E.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,A.utilizationRate)}%`}})}),E.jsx("span",{className:"text-sm text-gray-700",children:T(A.utilizationRate)})]})}),E.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:Object.entries(A.pinsByType).sort((F,N)=>N[1]-F[1]).slice(0,2).map(([F,N])=>`${F}(${N})`).join(", ")}),E.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.differentialPairs>0?A.differentialPairs:"-"}),E.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:E.jsx("button",{onClick:F=>{F.stopPropagation(),r(t===A.bankId?null:A.bankId)},className:"text-blue-600 hover:text-blue-900 font-medium",children:t===A.bankId?"Hide":"Details"})})]}),t===A.bankId&&E.jsx("tr",{children:E.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[E.jsxs("div",{children:[E.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Pin Types"}),E.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByType).map(([F,N])=>E.jsxs("div",{className:"flex justify-between text-sm",children:[E.jsx("span",{className:"text-gray-600",children:F}),E.jsx("span",{className:"font-medium",children:N})]},F))})]}),E.jsxs("div",{children:[E.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Voltages"}),E.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByVoltage).map(([F,N])=>E.jsxs("div",{className:"flex justify-between text-sm",children:[E.jsx("span",{className:"text-gray-600",children:F}),E.jsx("span",{className:"font-medium",children:N})]},F))})]}),E.jsxs("div",{children:[E.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Major Signal Types"}),E.jsx("div",{className:"space-y-1",children:A.majorSignalTypes.length>0?A.majorSignalTypes.map(F=>E.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:F},F)):E.jsx("span",{className:"text-gray-500 text-sm",children:"No major signal types"})})]})]})})})]},A.bankId))})]})})]})]})},VI=({onPinSelect:e})=>{const{pins:t,filteredPins:r,listView:n,visibleBanks:i,setActiveTab:a,setSearchQuery:s,setCommentFilter:o,updatePin:u,updateListViewState:f,bulkUpdateComments:d,toggleBankVisibility:p}=Yi(),[g,v]=Se.useState(""),[m,y]=Se.useState(!1),[C,S]=Se.useState(null),w=Se.useMemo(()=>fg.find(b=>b.id===n.activeTab)||fg[0],[n.activeTab]),x=(b,O)=>{var L,K;switch(O){case"differentialPair":return b.differentialPair?`${b.differentialPair.pair}_${b.differentialPair.type}`:"";case"commentTimestamp":return((L=b.commentTimestamp)==null?void 0:L.getTime())||0;case"ioStandard":return((K=b.attributes)==null?void 0:K.IO_Standard)||b.ioType||"AUTO";default:return b[O]||""}},T=Se.useMemo(()=>{let b=r;if(w.filter&&(b=b.filter(w.filter)),n.searchQuery.trim()){const O=n.searchQuery.toLowerCase();b=b.filter(L=>L.pinNumber.toLowerCase().includes(O)||L.pinName.toLowerCase().includes(O)||(L.signalName||"").toLowerCase().includes(O)||(L.comment||"").toLowerCase().includes(O))}switch(n.commentFilter){case"with-comments":b=b.filter(O=>O.comment&&O.comment.trim()!=="");break;case"without-comments":b=b.filter(O=>!O.comment||O.comment.trim()==="");break}return n.sortColumn?b=[...b].sort((O,L)=>{const K=x(O,n.sortColumn),ie=x(L,n.sortColumn);let re=0;return K<ie?re=-1:K>ie&&(re=1),n.sortDirection==="desc"?-re:re}):w.sort&&(b=[...b].sort(w.sort)),b},[r,w,n.searchQuery,n.commentFilter,n.sortColumn,n.sortDirection]),A=(b,O)=>{const L=x(b,O.key);if(O.customRender)return O.customRender(L,b);if(O.render==="datetime"&&b.commentTimestamp)return b.commentTimestamp.toLocaleDateString()+" "+b.commentTimestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(O.render==="boolean")return L?"":"";if(O.editable){if(O.key==="voltage")return E.jsx(dg,{value:String(L),onSave:K=>F(b.id,O.key,K),editable:!0,placeholder:"Select voltage...",type:"select",options:[...eu],allowCustomValue:!0});if(O.key==="ioStandard"||O.key==="ioType"){const K=b.voltage?Wd(b.voltage):[...Hd];return E.jsx(dg,{value:String(L),onSave:ie=>F(b.id,O.key,ie),editable:!0,placeholder:"Select I/O standard...",type:"select",options:K,allowCustomValue:!0,getDisplayValue:ie=>ie==="AUTO"?`Auto (${Fo(b.voltage||"3.3V")})`:ie})}return E.jsx(dg,{value:String(L),onSave:K=>F(b.id,O.key,K),editable:!0,placeholder:`Enter ${O.title.toLowerCase()}...`,maxLength:O.key==="comment"?500:100})}return String(L)||"-"},F=(b,O,L)=>{var re;const K=t.find(ke=>ke.id===b);if(!K)return;const ie={};if(O==="comment")ie.comment=L,ie.commentTimestamp=new Date,ie.commentAuthor="current_user";else if(O==="voltage"){ie.voltage=L;const ke=((re=K.attributes)==null?void 0:re.IO_Standard)||K.ioType||"AUTO";if(ke==="AUTO"||!Wd(L).includes(ke)){const we=Fo(L);ie.attributes={...K.attributes,IO_Standard:we},ie.ioType=we}}else O==="ioStandard"||O==="ioType"?(ie.attributes={...K.attributes,IO_Standard:L},ie.ioType=L):ie[O]=L;u(b,ie)},N=(b,O)=>{const L=new Set(n.selectedRows);O?L.add(b):L.delete(b),f({selectedRows:L})},P=()=>{g.trim()&&n.selectedRows.size>0&&(Array.from(n.selectedRows).forEach(O=>{u(O,{comment:g,commentTimestamp:new Date,commentAuthor:"current_user"})}),v(""),y(!1))},I=b=>{const O=n.sortColumn===b&&n.sortDirection==="asc"?"desc":"asc";f({sortColumn:b,sortDirection:O})};return E.jsxs("div",{className:"pin-list-tabs",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[!1,E.jsx("div",{className:"tab-header",style:{display:"flex",borderBottom:"1px solid #444",backgroundColor:"#2a2a2a"},children:fg.map(b=>E.jsxs("button",{className:`tab ${n.activeTab===b.id?"active":""}`,onClick:()=>a(b.id),title:b.description,style:{padding:"12px 16px",border:"none",background:n.activeTab===b.id?"#333":"transparent",borderBottom:n.activeTab===b.id?"2px solid #007acc":"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:n.activeTab===b.id?"600":"normal",color:n.activeTab===b.id?"#007acc":"#cccccc"},children:[E.jsx("span",{children:b.icon}),E.jsx("span",{children:b.title})]},b.id))}),!w.isCustomComponent&&E.jsxs("div",{className:"controls",style:{padding:"16px",display:"flex",gap:"16px",alignItems:"center",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444"},children:[w.showSearch&&E.jsx("div",{style:{flex:1,maxWidth:"300px"},children:E.jsx("input",{type:"text",placeholder:"Search pins, signals, or comments...",value:n.searchQuery,onChange:b=>s(b.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"}})}),E.jsx("div",{children:E.jsxs("select",{value:n.commentFilter,onChange:b=>o(b.target.value),style:{padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[E.jsx("option",{value:"all",children:"All Pins"}),E.jsx("option",{value:"with-comments",children:"With Comments"}),E.jsx("option",{value:"without-comments",children:"Without Comments"})]})}),E.jsxs("div",{style:{color:"#cccccc",fontSize:"14px"},children:[T.length," pins"]}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[E.jsx("span",{style:{color:"#cccccc",fontSize:"12px"},children:"BANKs:"}),E.jsx("button",{onClick:()=>{const b=Array.from(new Set(t.map(O=>O.bank).filter(Boolean)));i.size===0?b.forEach(O=>p(O)):b.forEach(O=>{i.has(O)||p(O)})},style:{padding:"2px 8px",borderRadius:"3px",backgroundColor:i.size===0?"#007acc":"#444444",border:"1px solid #555",cursor:"pointer",fontSize:"10px",color:i.size===0?"#ffffff":"#cccccc",fontWeight:"bold"},title:i.size===0?"Hide All Banks":"Show All Banks",children:i.size===0?"ALL":"SHOW ALL"}),Array.from(new Set(t.map(b=>b.bank).filter(Boolean))).sort((b,O)=>{const L=parseInt(b),K=parseInt(O);return isNaN(L)||isNaN(K)?b.localeCompare(O):L-K}).map(b=>{const O=i.size===0||i.has(b);return E.jsxs("button",{onClick:()=>p(b),style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"3px",backgroundColor:O?A8(b,!1,!1):"#444444",border:O?"1px solid #555":"1px solid #666",cursor:"pointer",opacity:O?1:.5,transition:"opacity 0.2s ease, background-color 0.2s ease"},title:O?`Hide Bank ${b}`:`Show Bank ${b}`,children:[E.jsx("span",{style:{fontSize:"11px",color:O?"#ffffff":"#999",fontWeight:O?"normal":"bold"},children:b}),!O&&E.jsx("span",{style:{fontSize:"8px",color:"#888"},children:""})]},b)})]}),n.selectedRows.size>0&&E.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:[E.jsxs("span",{style:{fontSize:"14px",color:"#cccccc"},children:[n.selectedRows.size," selected"]}),E.jsx("button",{onClick:()=>y(!m),style:{padding:"6px 12px",border:"1px solid #007acc",borderRadius:"4px",backgroundColor:m?"#005a9e":"#007acc",color:"white",fontSize:"12px",cursor:"pointer"},children:m?"Close Bulk Edit":"Bulk Edit"}),E.jsx("button",{onClick:()=>d(Array.from(n.selectedRows),""),style:{padding:"6px 12px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Comments"}),E.jsx("button",{onClick:()=>{f({selectedRows:new Set})},style:{padding:"6px 12px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#6c757d",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Selection"})]})]}),!w.isCustomComponent&&m&&E.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",borderBottom:"1px solid #444"},children:[E.jsx("div",{style:{marginBottom:"12px"},children:E.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#ffffff",fontSize:"14px"},children:["Bulk Edit (",n.selectedRows.size," pins selected)"]})}),E.jsxs("div",{style:{marginBottom:"16px"},children:[E.jsx("label",{style:{display:"block",marginBottom:"4px",color:"#cccccc",fontSize:"12px"},children:"Comment"}),E.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[E.jsx("input",{type:"text",placeholder:"Enter comment for selected pins...",value:g,onChange:b=>v(b.target.value),onKeyDown:b=>b.key==="Enter"&&P(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),E.jsx("button",{onClick:P,disabled:!g.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:g.trim()?"#28a745":"#666",color:"white",fontSize:"12px",cursor:g.trim()?"pointer":"not-allowed"},children:"Apply Comment"})]})]}),E.jsxs("div",{style:{marginBottom:"16px"},children:[E.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#cccccc",fontSize:"12px"},children:"I/O Settings (leave empty to skip)"}),E.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px"},children:[E.jsxs("div",{children:[E.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"Direction"}),E.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:b=>{b.target.value&&Array.from(n.selectedRows).forEach(L=>{u(L,{direction:b.target.value})})},children:[E.jsx("option",{value:"",children:"-- Select Direction --"}),E.jsx("option",{value:"Input",children:"Input"}),E.jsx("option",{value:"Output",children:"Output"}),E.jsx("option",{value:"InOut",children:"InOut"}),E.jsx("option",{value:"Clock",children:"Clock"}),E.jsx("option",{value:"Reset",children:"Reset"})]})]}),E.jsxs("div",{children:[E.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"Voltage"}),E.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:b=>{b.target.value&&Array.from(n.selectedRows).forEach(L=>{u(L,{voltage:b.target.value})})},children:[E.jsx("option",{value:"",children:"-- Select Voltage --"}),eu.map(b=>E.jsx("option",{value:b,children:b},b))]})]}),E.jsxs("div",{children:[E.jsx("label",{style:{display:"block",marginBottom:"2px",color:"#999",fontSize:"10px"},children:"I/O Standard"}),E.jsxs("select",{style:{width:"100%",padding:"4px 8px",border:"1px solid #555",borderRadius:"3px",backgroundColor:"#333",color:"#ffffff",fontSize:"11px"},onChange:b=>{b.target.value&&Array.from(n.selectedRows).forEach(L=>{u(L,{attributes:{IO_Standard:b.target.value},ioType:b.target.value})})},children:[E.jsx("option",{value:"",children:"-- Select Standard --"}),E.jsx("option",{value:"AUTO",children:"AUTO"}),Hd.filter(b=>b!=="AUTO").map(b=>E.jsx("option",{value:b,children:b},b))]})]})]})]}),E.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:E.jsx("button",{onClick:()=>y(!1),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#333",color:"#cccccc",fontSize:"12px",cursor:"pointer"},children:"Close"})})]}),E.jsx("div",{style:{flex:1,minHeight:"400px",overflow:"hidden",display:"flex",flexDirection:"column"},children:w.isCustomComponent?w.id==="bankGroups"?E.jsx(zI,{pins:t}):E.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:["Custom component not implemented for ",w.id]}):T.length>0?E.jsx(UI,{pins:T,columns:w.columns,selectedRows:n.selectedRows,hoveredRowId:C,sortColumn:n.sortColumn,sortDirection:n.sortDirection,onRowSelection:N,onPinSelect:e,onHover:S,onColumnSort:I,renderCellContent:A}):E.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"No pins match the current filters"})})]})};var P8={exports:{}},kh={},$d={},gt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof h4<"u"?h4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return e.Konva.angleDeg?i*t:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var i;return(i=e.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(i){e.glob.Konva=i}};const n=i=>{e.Konva[i.prototype.getClassName()]=i};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(gt);var or={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=gt;class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const A=this.m;return{x:A[0]*T.x+A[2]*T.y+A[4],y:A[1]*T.x+A[3]*T.y+A[5]}}translate(T,A){return this.m[4]+=this.m[0]*T+this.m[2]*A,this.m[5]+=this.m[1]*T+this.m[3]*A,this}scale(T,A){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=A,this.m[3]*=A,this}rotate(T){const A=Math.cos(T),F=Math.sin(T),N=this.m[0]*A+this.m[2]*F,P=this.m[1]*A+this.m[3]*F,I=this.m[0]*-F+this.m[2]*A,b=this.m[1]*-F+this.m[3]*A;return this.m[0]=N,this.m[1]=P,this.m[2]=I,this.m[3]=b,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,A){const F=this.m[0]+this.m[2]*A,N=this.m[1]+this.m[3]*A,P=this.m[2]+this.m[0]*T,I=this.m[3]+this.m[1]*T;return this.m[0]=F,this.m[1]=N,this.m[2]=P,this.m[3]=I,this}multiply(T){const A=this.m[0]*T.m[0]+this.m[2]*T.m[1],F=this.m[1]*T.m[0]+this.m[3]*T.m[1],N=this.m[0]*T.m[2]+this.m[2]*T.m[3],P=this.m[1]*T.m[2]+this.m[3]*T.m[3],I=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],b=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=A,this.m[1]=F,this.m[2]=N,this.m[3]=P,this.m[4]=I,this.m[5]=b,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*T,F=-this.m[1]*T,N=-this.m[2]*T,P=this.m[0]*T,I=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),b=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=F,this.m[2]=N,this.m[3]=P,this.m[4]=I,this.m[5]=b,this}getMatrix(){return this.m}decompose(){const T=this.m[0],A=this.m[1],F=this.m[2],N=this.m[3],P=this.m[4],I=this.m[5],b=T*N-A*F,O={x:P,y:I,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||A!=0){const L=Math.sqrt(T*T+A*A);O.rotation=A>0?Math.acos(T/L):-Math.acos(T/L),O.scaleX=L,O.scaleY=b/L,O.skewX=(T*F+A*N)/b,O.skewY=0}else if(F!=0||N!=0){const L=Math.sqrt(F*F+N*N);O.rotation=Math.PI/2-(N>0?Math.acos(-F/L):-Math.acos(F/L)),O.scaleX=b/L,O.scaleY=L,O.skewX=0,O.skewY=(T*F+A*N)/b}return O.rotation=e.Util._getRotation(O.rotation),O}}e.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,u=180/Math.PI,f="#",d="",p="0",g="Konva warning: ",v="Konva error: ",m="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},C=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(x){setTimeout(x,60)};e.Util={_isElement(x){return!!(x&&x.nodeType==1)},_isFunction(x){return!!(x&&x.constructor&&x.call&&x.apply)},_isPlainObject(x){return!!x&&x.constructor===Object},_isArray(x){return Object.prototype.toString.call(x)===n},_isNumber(x){return Object.prototype.toString.call(x)===i&&!isNaN(x)&&isFinite(x)},_isString(x){return Object.prototype.toString.call(x)===a},_isBoolean(x){return Object.prototype.toString.call(x)===s},isObject(x){return x instanceof Object},isValidSelector(x){if(typeof x!="string")return!1;const T=x[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(x){return x===0||x>0?1:-1},requestAnimFrame(x){S.push(x),S.length===1&&w(function(){const T=S;S=[],T.forEach(function(A){A()})})},createCanvasElement(){const x=document.createElement("canvas");try{x.style=x.style||{}}catch{}return x},createImageElement(){return document.createElement("img")},_isInDocument(x){for(;x=x.parentNode;)if(x==document)return!0;return!1},_urlToImage(x,T){const A=e.Util.createImageElement();A.onload=function(){T(A)},A.src=x},_rgbToHex(x,T,A){return((1<<24)+(x<<16)+(T<<8)+A).toString(16).slice(1)},_hexToRgb(x){x=x.replace(f,d);const T=parseInt(x,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let x=(Math.random()*16777215<<0).toString(16);for(;x.length<6;)x=p+x;return f+x},getRGB(x){let T;return x in y?(T=y[x],{r:T[0],g:T[1],b:T[2]}):x[0]===f?this._hexToRgb(x.substring(1)):x.substr(0,4)===m?(T=C.exec(x.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(x){return x=x||"black",e.Util._namedColorToRBA(x)||e.Util._hex3ColorToRGBA(x)||e.Util._hex4ColorToRGBA(x)||e.Util._hex6ColorToRGBA(x)||e.Util._hex8ColorToRGBA(x)||e.Util._rgbColorToRGBA(x)||e.Util._rgbaColorToRGBA(x)||e.Util._hslColorToRGBA(x)},_namedColorToRBA(x){const T=y[x.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(x){if(x.indexOf("rgb(")===0){x=x.match(/rgb\(([^)]+)\)/)[1];const T=x.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(x){if(x.indexOf("rgba(")===0){x=x.match(/rgba\(([^)]+)\)/)[1];const T=x.split(/ *, */).map((A,F)=>A.slice(-1)==="%"?F===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(x){if(x[0]==="#"&&x.length===9)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:parseInt(x.slice(7,9),16)/255}},_hex6ColorToRGBA(x){if(x[0]==="#"&&x.length===7)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:1}},_hex4ColorToRGBA(x){if(x[0]==="#"&&x.length===5)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:parseInt(x[4]+x[4],16)/255}},_hex3ColorToRGBA(x){if(x[0]==="#"&&x.length===4)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:1}},_hslColorToRGBA(x){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(x)){const[T,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(x),F=Number(A[0])/360,N=Number(A[1])/100,P=Number(A[2])/100;let I,b,O;if(N===0)return O=P*255,{r:Math.round(O),g:Math.round(O),b:Math.round(O),a:1};P<.5?I=P*(1+N):I=P+N-P*N;const L=2*P-I,K=[0,0,0];for(let ie=0;ie<3;ie++)b=F+1/3*-(ie-1),b<0&&b++,b>1&&b--,6*b<1?O=L+(I-L)*6*b:2*b<1?O=I:3*b<2?O=L+(I-L)*(2/3-b)*6:O=L,K[ie]=O*255;return{r:Math.round(K[0]),g:Math.round(K[1]),b:Math.round(K[2]),a:1}}},haveIntersection(x,T){return!(T.x>x.x+x.width||T.x+T.width<x.x||T.y>x.y+x.height||T.y+T.height<x.y)},cloneObject(x){const T={};for(const A in x)this._isPlainObject(x[A])?T[A]=this.cloneObject(x[A]):this._isArray(x[A])?T[A]=this.cloneArray(x[A]):T[A]=x[A];return T},cloneArray(x){return x.slice(0)},degToRad(x){return x*o},radToDeg(x){return x*u},_degToRad(x){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(x)},_radToDeg(x){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(x)},_getRotation(x){return t.Konva.angleDeg?e.Util.radToDeg(x):x},_capitalize(x){return x.charAt(0).toUpperCase()+x.slice(1)},throw(x){throw new Error(v+x)},error(x){console.error(v+x)},warn(x){t.Konva.showWarnings&&console.warn(g+x)},each(x,T){for(const A in x)T(A,x[A])},_inRange(x,T,A){return T<=x&&x<A},_getProjectionToSegment(x,T,A,F,N,P){let I,b,O;const L=(x-A)*(x-A)+(T-F)*(T-F);if(L==0)I=x,b=T,O=(N-A)*(N-A)+(P-F)*(P-F);else{const K=((N-x)*(A-x)+(P-T)*(F-T))/L;K<0?(I=x,b=T,O=(x-N)*(x-N)+(T-P)*(T-P)):K>1?(I=A,b=F,O=(A-N)*(A-N)+(F-P)*(F-P)):(I=x+K*(A-x),b=T+K*(F-T),O=(I-N)*(I-N)+(b-P)*(b-P))}return[I,b,O]},_getProjectionToLine(x,T,A){const F=e.Util.cloneObject(x);let N=Number.MAX_VALUE;return T.forEach(function(P,I){if(!A&&I===T.length-1)return;const b=T[(I+1)%T.length],O=e.Util._getProjectionToSegment(P.x,P.y,b.x,b.y,x.x,x.y),L=O[0],K=O[1],ie=O[2];ie<N&&(F.x=L,F.y=K,N=ie)}),F},_prepareArrayForTween(x,T,A){const F=[],N=[];if(x.length>T.length){const I=T;T=x,x=I}for(let I=0;I<x.length;I+=2)F.push({x:x[I],y:x[I+1]});for(let I=0;I<T.length;I+=2)N.push({x:T[I],y:T[I+1]});const P=[];return N.forEach(function(I){const b=e.Util._getProjectionToLine(I,F,A);P.push(b.x),P.push(b.y)}),P},_prepareToStringify(x){let T;x.visitedByCircularReferenceRemoval=!0;for(const A in x)if(x.hasOwnProperty(A)&&x[A]&&typeof x[A]=="object"){if(T=Object.getOwnPropertyDescriptor(x,A),x[A].visitedByCircularReferenceRemoval||e.Util._isElement(x[A]))if(T.configurable)delete x[A];else return null;else if(e.Util._prepareToStringify(x[A])===null)if(T.configurable)delete x[A];else return null}return delete x.visitedByCircularReferenceRemoval,x},_assign(x,T){for(const A in T)x[A]=T[A];return x},_getFirstPointerId(x){return x.touches?x.changedTouches[0].identifier:x.pointerId||999},releaseCanvas(...x){t.Konva.releaseCanvasOnDestroy&&x.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(x,T,A,F){let N=0,P=0,I=0,b=0;typeof F=="number"?N=P=I=b=Math.min(F,T/2,A/2):(N=Math.min(F[0]||0,T/2,A/2),P=Math.min(F[1]||0,T/2,A/2),b=Math.min(F[2]||0,T/2,A/2),I=Math.min(F[3]||0,T/2,A/2)),x.moveTo(N,0),x.lineTo(T-P,0),x.arc(T-P,P,P,Math.PI*3/2,0,!1),x.lineTo(T,A-b),x.arc(T-b,A-b,b,0,Math.PI/2,!1),x.lineTo(I,A),x.arc(I,A-I,I,Math.PI/2,Math.PI,!1),x.lineTo(0,N),x.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}})(or);var tr={},qi={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.HitContext=Ua.SceneContext=Ua.Context=void 0;const F8=or,GI=gt;function HI(e){const t=[],r=e.length,n=F8.Util;for(let i=0;i<r;i++){let a=e[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),t.push(a)}return t}const D3=",",WI="(",$I=")",XI="([",KI="])",YI=";",QI="()",qI="=",O3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],JI=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],ZI=100;class Eh{constructor(t){this.canvas=t,GI.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,r){let n=this.traceArr,i=n.length,a="",s,o,u,f;for(s=0;s<i;s++)o=n[s],u=o.method,u?(f=o.args,a+=u,t?a+=QI:F8.Util._isArray(f[0])?a+=XI+f.join(D3)+KI:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=WI+f.join(D3)+$I)):(a+=o.property,t||(a+=qI+o.val)),a+=YI;return a}clearTrace(){this.traceArr=[]}_trace(t){let r=this.traceArr,n;r.push(t),n=r.length,n>=ZI&&r.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const r=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(t){const r=t.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(t){const r=t.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(t){const r=t.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(t,r){this._context[t]=r}arc(t,r,n,i,a,s){this._context.arc(t,r,n,i,a,s)}arcTo(t,r,n,i,a){this._context.arcTo(t,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,r,n,i,a,s){this._context.bezierCurveTo(t,r,n,i,a,s)}clearRect(t,r,n,i){this._context.clearRect(t,r,n,i)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,r){const n=arguments;if(n.length===2)return this._context.createImageData(t,r);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,r,n,i){return this._context.createLinearGradient(t,r,n,i)}createPattern(t,r){return this._context.createPattern(t,r)}createRadialGradient(t,r,n,i,a,s){return this._context.createRadialGradient(t,r,n,i,a,s)}drawImage(t,r,n,i,a,s,o,u,f){const d=arguments,p=this._context;d.length===3?p.drawImage(t,r,n):d.length===5?p.drawImage(t,r,n,i,a):d.length===9&&p.drawImage(t,r,n,i,a,s,o,u,f)}ellipse(t,r,n,i,a,s,o,u){this._context.ellipse(t,r,n,i,a,s,o,u)}isPointInPath(t,r,n,i){return n?this._context.isPointInPath(n,t,r,i):this._context.isPointInPath(t,r,i)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,r,n,i){this._context.fillRect(t,r,n,i)}strokeRect(t,r,n,i){this._context.strokeRect(t,r,n,i)}fillText(t,r,n,i){i?this._context.fillText(t,r,n,i):this._context.fillText(t,r,n)}measureText(t){return this._context.measureText(t)}getImageData(t,r,n,i){return this._context.getImageData(t,r,n,i)}lineTo(t,r){this._context.lineTo(t,r)}moveTo(t,r){this._context.moveTo(t,r)}rect(t,r,n,i){this._context.rect(t,r,n,i)}roundRect(t,r,n,i,a){this._context.roundRect(t,r,n,i,a)}putImageData(t,r,n){this._context.putImageData(t,r,n)}quadraticCurveTo(t,r,n,i){this._context.quadraticCurveTo(t,r,n,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,r){this._context.scale(t,r)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,r,n,i,a,s){this._context.setTransform(t,r,n,i,a,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,r,n,i){this._context.strokeText(t,r,n,i)}transform(t,r,n,i,a,s){this._context.transform(t,r,n,i,a,s)}translate(t,r){this._context.translate(t,r)}_enableTrace(){let t=this,r=O3.length,n=this.setAttr,i,a;const s=function(o){let u=t[o],f;t[o]=function(){return a=HI(Array.prototype.slice.call(arguments,0)),f=u.apply(t,arguments),t._trace({method:o,args:a}),f}};for(i=0;i<r;i++)s(O3[i]);t.setAttr=function(){n.apply(t,arguments);const o=arguments[0];let u=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:o,val:u})}}_applyGlobalCompositeOperation(t){const r=t.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ua.Context=Eh;JI.forEach(function(e){Object.defineProperty(Eh.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});class eD extends Eh{constructor(t,{willReadFrequently:r=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(t){const r=t.fill();this.setAttr("fillStyle",r),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const r=t._getLinearGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fillRadialGradient(t){const r=t._getRadialGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fill(t){const r=t.fill(),n=t.getFillPriority();if(r&&n==="color"){this._fillColor(t);return}const i=t.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(t);return}const a=t.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(t);return}const s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}r?this._fillColor(t):i?this._fillPattern(t):a?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const r=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(t){const r=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),r&&t.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var r,n,i;const a=(r=t.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=t.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=u.x*f,p=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(p))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*p)}}Ua.SceneContext=eD;class tD extends Eh{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),i=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}Ua.HitContext=tD;Object.defineProperty(qi,"__esModule",{value:!0});qi.HitCanvas=qi.SceneCanvas=qi.Canvas=void 0;const Xd=or,N8=Ua,R8=gt;let zf;function rD(){if(zf)return zf;const e=Xd.Util.createCanvasElement(),t=e.getContext("2d");return zf=function(){const r=R8.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return r/n}(),Xd.Util.releaseCanvas(e),zf}class gx{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||R8.Konva.pixelRatio||rD();this.pixelRatio=n,this._canvas=Xd.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const r=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,r){this.setWidth(t||0),this.setHeight(r||0)}toDataURL(t,r){try{return this._canvas.toDataURL(t,r)}catch{try{return this._canvas.toDataURL()}catch(i){return Xd.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}qi.Canvas=gx;class nD extends gx{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new N8.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}qi.SceneCanvas=nD;class iD extends gx{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new N8.HitContext(this),this.setSize(t.width,t.height)}}qi.HitCanvas=iD;var Ch={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=gt,r=or;e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];e.DD._dragElements.forEach((a,s)=>{const{node:o}=a,u=o.getStage();u.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=u._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];e.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(Ch);var yt={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.RGBComponent=aD;at.alphaComponent=sD;at.getNumberValidator=oD;at.getNumberOrArrayOfNumbersValidator=lD;at.getNumberOrAutoValidator=cD;at.getStringValidator=uD;at.getStringOrGradientValidator=fD;at.getFunctionValidator=dD;at.getNumberArrayValidator=hD;at.getBooleanValidator=pD;at.getComponentValidator=gD;const Ya=gt,fr=or;function Qa(e){return fr.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||fr.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function aD(e){return e>255?255:e<0?0:Math.round(e)}function sD(e){return e>1?1:e<1e-4?1e-4:e}function oD(){if(Ya.Konva.isUnminified)return function(e,t){return fr.Util._isNumber(e)||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function lD(e){if(Ya.Konva.isUnminified)return function(t,r){let n=fr.Util._isNumber(t),i=fr.Util._isArray(t)&&t.length==e;return!n&&!i&&fr.Util.warn(Qa(t)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function cD(){if(Ya.Konva.isUnminified)return function(e,t){return fr.Util._isNumber(e)||e==="auto"||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function uD(){if(Ya.Konva.isUnminified)return function(e,t){return fr.Util._isString(e)||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function fD(){if(Ya.Konva.isUnminified)return function(e,t){const r=fr.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return r||n||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function dD(){if(Ya.Konva.isUnminified)return function(e,t){return fr.Util._isFunction(e)||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function hD(){if(Ya.Konva.isUnminified)return function(e,t){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&e instanceof r||(fr.Util._isArray(e)?e.forEach(function(n){fr.Util._isNumber(n)||fr.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function pD(){if(Ya.Konva.isUnminified)return function(e,t){return e===!0||e===!1||fr.Util.warn(Qa(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function gD(e){if(Ya.Konva.isUnminified)return function(t,r){return t==null||fr.Util.isObject(t)||fr.Util.warn(Qa(t)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+e),t}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=or,r=at,n="get",i="set";e.Factory={addGetterSetter(a,s,o,u,f){e.Factory.addGetter(a,s,o),e.Factory.addSetter(a,s,u,f),e.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const u=n+t.Util._capitalize(s);a.prototype[u]=a.prototype[u]||function(){const f=this.attrs[s];return f===void 0?o:f}},addSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]||e.Factory.overWriteSetter(a,s,o,u)},overWriteSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,s)),this._setAttr(s,d),u&&u.call(this),this}},addComponentsGetterSetter(a,s,o,u,f){const d=o.length,p=t.Util._capitalize,g=n+p(s),v=i+p(s);a.prototype[g]=function(){const y={};for(let C=0;C<d;C++){const S=o[C];y[S]=this.getAttr(s+p(S))}return y};const m=(0,r.getComponentValidator)(o);a.prototype[v]=function(y){const C=this.attrs[s];u&&(y=u.call(this,y,s)),m&&m.call(this,y,s);for(const S in y)y.hasOwnProperty(S)&&this._setAttr(s+p(S),y[S]);return y||o.forEach(S=>{this._setAttr(s+p(S),void 0)}),this._fireChangeEvent(s,C,y),f&&f.call(this),this},e.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=t.Util._capitalize(s),u=i+o,f=n+o;a.prototype[s]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,o,u){t.Util.error("Adding deprecated "+s);const f=n+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){t.Util.error(d);const p=this.attrs[s];return p===void 0?o:p},e.Factory.addSetter(a,s,u,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){t.Util.each(s,function(o,u){const f=a.prototype[u],d=n+t.Util._capitalize(o),p=i+t.Util._capitalize(o);function g(){f.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(yt);Object.defineProperty(tr,"__esModule",{value:!0});tr.Node=void 0;const fl=qi,xi=Ch,gu=yt,us=gt,wt=or,xr=at,id="absoluteOpacity",Vf="allEventListeners",Fa="absoluteTransform",L3="absoluteScale",ao="canvas",mD="Change",xD="children",vD="konva",Om="listening",yD="mouseenter",_D="mouseleave",SD="pointerenter",wD="pointerleave",kD="touchenter",ED="touchleave",M3="set",B3="Shape",ad=" ",j3="stage",fs="transform",CD="Stage",Lm="visible",TD=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(ad);let AD=1;class ot{constructor(t){this._id=AD++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===fs||t===Fa)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,r){let n=this._cache.get(t);return(n===void 0||(t===fs||t===Fa)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(t,n)),n}_calculate(t,r,n){if(!this._attachedDepsListeners.get(t)){const i=r.map(a=>a+"Change.konva").join(ad);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(ao)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Fa&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ao)){const{scene:t,filter:r,hit:n,buffer:i}=this._cache.get(ao);wt.Util.releaseCanvas(t,r,n,i),this._cache.delete(ao)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const r=t||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,u=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,p=r.hitCanvasPixelRatio||1;if(!i||!a){wt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const g=Math.abs(Math.round(n.x)-o)>.5?1:0,v=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+g,a+=f*2+v,o-=f,u-=f;const m=new fl.SceneCanvas({pixelRatio:s,width:i,height:a}),y=new fl.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),C=new fl.HitCanvas({pixelRatio:p,width:i,height:a}),S=m.getContext(),w=C.getContext(),x=new fl.SceneCanvas({width:m.width/m.pixelRatio+Math.abs(o),height:m.height/m.pixelRatio+Math.abs(u),pixelRatio:m.pixelRatio}),T=x.getContext();return C.isCache=!0,m.isCache=!0,this._cache.delete(ao),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(m.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),S.save(),w.save(),T.save(),S.translate(-o,-u),w.translate(-o,-u),T.translate(-o,-u),x.x=o,x.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(id),this._clearSelfAndDescendantCache(L3),this.drawScene(m,this,x),this.drawHit(C,this),this._isUnderCache=!1,S.restore(),w.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,i,a),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(ao,{scene:m,filter:y,hit:C,buffer:x,x:o,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(ao)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,r){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const u=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=u.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();t.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()}_drawCachedHitCanvas(t){const r=this._getCanvasCache(),n=r.hit;t.save(),t.translate(r.x,r.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,u,f;if(t){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<s;u++){if(f=t[u],typeof f!="function"){wt.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,o),a.putImageData(o,0,0)}}catch(p){wt.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(t,r){if(this._cache&&this._cache.delete(Vf),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(ad);for(let i=0;i<n.length;i++){const s=n[i].split("."),o=s[0],u=s[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:u,handler:r})}return this}off(t,r){let n=(t||"").split(ad),i=n.length,a,s,o,u,f,d;if(this._cache&&this._cache.delete(Vf),!t)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],u=o.split("."),f=u[0],d=u[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(t){const r={target:this,type:t.type,evt:t};return this.fire(t.type,r),this}addEventListener(t,r){return this.on(t,function(n){r.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,r,n){const i=this;this.on(t,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=wt.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),xi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Fa),this._clearSelfAndDescendantCache(id),this._clearSelfAndDescendantCache(L3),this._clearSelfAndDescendantCache(j3),this._clearSelfAndDescendantCache(Lm),this._clearSelfAndDescendantCache(Om)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const r="get"+wt.Util._capitalize(t);return wt.Util._isFunction(this[r])?this[r]():this.attrs[t]}getAncestors(){let t=this.getParent(),r=[];for(;t;)r.push(t),t=t.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let r,n;if(!t)return this;for(r in t)r!==xD&&(n=M3+wt.Util._capitalize(r),wt.Util._isFunction(this[n])?this[n](t[r]):this._setAttr(r,t[r]))}),this}isListening(){return this._getCache(Om,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Lm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,r=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let i=!1;xi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!us.Konva.hitOnDragEnabled&&(i||us.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),r=this,n=0,i,a,s,o;function u(d){for(i=[],a=d.length,s=0;s<a;s++)o=d[s],n++,o.nodeType!==B3&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=t&&u(i)}const f=this.getStage();return r.nodeType!==CD&&f&&u(f.getChildren()),n}getDepth(){let t=0,r=this.parent;for(;r;)t++,r=r.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(fs),this._clearSelfAndDescendantCache(Fa)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const r=t.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(t){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!t&&(t=!0);const i=this.getAbsoluteTransform(t).getMatrix(),a=new wt.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(t){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(fs);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:t.x,y:t.y}),this._clearCache(fs),this._clearSelfAndDescendantCache(Fa),this}_setTransform(t){let r;for(r in t)this.attrs[r]=t[r]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let r=t.x,n=t.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(t,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return wt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return wt.Util.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return wt.Util.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return wt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return wt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&wt.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(id,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(t*=r.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in t)n=t[r],s=wt.Util.isObject(n)&&!wt.Util._isPlainObject(n)&&!wt.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete t[r],a=i?i.call(this):null,t[r]=n,a!==n&&(o.attrs[r]=n));return wt.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,r,n){const i=[];r&&this._isMatch(t)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent}return i}isAncestorOf(t){return!1}findAncestor(t,r,n){return this.findAncestors(t,r,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let r=t.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],wt.Util.isValidSelector(a)||(wt.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),wt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),wt.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(j3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,r={},n){return r.target=r.target||this,n?this._fireAndBubble(t,r):this._fire(t,r),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Fa,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let r;if(t)return r=new wt.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),r;{r=this._cache.get(Fa)||new wt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(t){let r=this;for(;r;)r._isUnderCache&&(t=r),r=r.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(fs,this._getTransform)}_getTransform(){var t,r;const n=this._cache.get(fs)||new wt.Transform;n.reset();const i=this.x(),a=this.y(),s=us.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,p=this.attrs.offsetX||0,g=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(o!==1||u!==1)&&n.scale(o,u),(p!==0||g!==0)&&n.translate(-1*p,-1*g),n.dirty=!1,n}clone(t){let r=wt.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in t)r[n]=t[n];const u=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(vD)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(o));return u}_toKonvaCanvas(t){t=t||{};const r=this.getClientRect(),n=this.getStage(),i=t.x!==void 0?t.x:Math.floor(r.x),a=t.y!==void 0?t.y:Math.floor(r.y),s=t.pixelRatio||1,o=new fl.SceneCanvas({width:t.width||Math.ceil(r.width)||(n?n.width():0),height:t.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),u=o.getContext(),f=new fl.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||a)&&u.translate(-1*i,-1*a),this.drawScene(o,void 0,f),u.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const r=t.mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(r,n);return t.callback&&t.callback(i),i}toImage(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,wt.Util._urlToImage(this.toDataURL(t),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob(a=>{r(a),i==null||i(a)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(i){n(i)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():us.Konva.dragDistance}_off(t,r,n){let i=this.eventListeners[t],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,r,n){this._fire(t+mD,{oldVal:r,newVal:n})}addName(t){if(!this.hasName(t)){const r=this.name(),n=r?r+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const r=(this.name()||"").split(/\s/g),n=r.indexOf(t);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(t,r){const n=this[M3+wt.Util._capitalize(t)];return wt.Util._isFunction(n)?n.call(this,r):this._setAttr(t,r),this}_requestDraw(){if(us.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,r){const n=this.attrs[t];n===r&&!wt.Util.isObject(r)||(r==null?delete this.attrs[t]:this.attrs[t]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,r),this._requestDraw())}_setComponentAttr(t,r,n){let i;n!==void 0&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][r]=n,this._fireChangeEvent(t,i,n))}_fireAndBubble(t,r,n){r&&this.nodeType===B3&&(r.target=this);const i=[yD,_D,SD,wD,kD,ED];if(!(i.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,r);const s=i.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,r,n):this._fireAndBubble.call(this.parent,t,r))}}_getProtoListeners(t){var r,n,i;const a=(r=this._cache.get(Vf))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[t];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const u=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[t])!==null&&i!==void 0?i:[];s.push(...u),o=Object.getPrototypeOf(o)}a[t]=s,this._cache.set(Vf,a)}return s}_fire(t,r){r=r||{},r.currentTarget=this,r.type=t;const n=this._getProtoListeners(t);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[t];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const r=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;xi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(t,r=!0){xi.DD._dragElements.has(this._id)||this._createDragElement(t);const n=xi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},r)}_setDragPosition(t,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,t);s?i=s:wt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(t){const r=xi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),xi.DD._endDragBefore(t),xi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=xi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||us.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let i=!1;xi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=xi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&xi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-t.x,y:-t.y,width:r.width()+2*t.x,height:r.height()+2*t.y};return wt.Util.haveIntersection(n,this.getClientRect())}static create(t,r){return wt.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,r)}static _createNode(t,r){let n=ot.prototype.getClassName.call(t),i=t.children,a,s,o;r&&(t.attrs.container=r),us.Konva[n]||(wt.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=us.Konva[n];if(a=new u(t.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(ot._createNode(i[o]));return a}}tr.Node=ot;ot.prototype.nodeType="Node";ot.prototype._attrsAffectingSize=[];ot.prototype.eventListeners={};ot.prototype.on.call(ot.prototype,TD,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(fs),this._clearSelfAndDescendantCache(Fa)});ot.prototype.on.call(ot.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Lm)});ot.prototype.on.call(ot.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Om)});ot.prototype.on.call(ot.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(id)});const Wt=gu.Factory.addGetterSetter;Wt(ot,"zIndex");Wt(ot,"absolutePosition");Wt(ot,"position");Wt(ot,"x",0,(0,xr.getNumberValidator)());Wt(ot,"y",0,(0,xr.getNumberValidator)());Wt(ot,"globalCompositeOperation","source-over",(0,xr.getStringValidator)());Wt(ot,"opacity",1,(0,xr.getNumberValidator)());Wt(ot,"name","",(0,xr.getStringValidator)());Wt(ot,"id","",(0,xr.getStringValidator)());Wt(ot,"rotation",0,(0,xr.getNumberValidator)());gu.Factory.addComponentsGetterSetter(ot,"scale",["x","y"]);Wt(ot,"scaleX",1,(0,xr.getNumberValidator)());Wt(ot,"scaleY",1,(0,xr.getNumberValidator)());gu.Factory.addComponentsGetterSetter(ot,"skew",["x","y"]);Wt(ot,"skewX",0,(0,xr.getNumberValidator)());Wt(ot,"skewY",0,(0,xr.getNumberValidator)());gu.Factory.addComponentsGetterSetter(ot,"offset",["x","y"]);Wt(ot,"offsetX",0,(0,xr.getNumberValidator)());Wt(ot,"offsetY",0,(0,xr.getNumberValidator)());Wt(ot,"dragDistance",void 0,(0,xr.getNumberValidator)());Wt(ot,"width",0,(0,xr.getNumberValidator)());Wt(ot,"height",0,(0,xr.getNumberValidator)());Wt(ot,"listening",!0,(0,xr.getBooleanValidator)());Wt(ot,"preventDefault",!0,(0,xr.getBooleanValidator)());Wt(ot,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Wt(ot,"visible",!0,(0,xr.getBooleanValidator)());Wt(ot,"transformsEnabled","all",(0,xr.getStringValidator)());Wt(ot,"size");Wt(ot,"dragBoundFunc");Wt(ot,"draggable",!1,(0,xr.getBooleanValidator)());gu.Factory.backCompat(ot,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.Container=void 0;const oc=yt,pg=tr,Th=at;class jo extends pg.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){const r=this.children||[];return t?r.filter(t):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const r=this._generalFind(t,!0);return r.length>0?r[0]:void 0}_generalFind(t,r){const n=[];return this._descendants(i=>{const a=i._isMatch(t);return a&&n.push(i),!!(a&&r)}),n}_descendants(t){let r=!1;const n=this.getChildren();for(const i of n){if(r=t(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(t),r))return!0}return!1}toObject(){const t=pg.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(r=>{t.children.push(r.toObject())}),t}isAncestorOf(t){let r=t.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(t){const r=pg.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(t){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&r.push(n)}),r}_clearSelfAndDescendantCache(t){var r;super._clearSelfAndDescendantCache(t),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),u=o&&o.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(t,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const u=this.getAbsoluteTransform(r).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(t,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),d=typeof o=="number"&&typeof u=="number"||f,p=n===this;if(d){s.save();const v=this.getAbsoluteTransform(n);let m=v.getMatrix();s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s.beginPath();let y;if(f)y=f.call(this,s,this);else{const C=this.clipX(),S=this.clipY();s.rect(C||0,S||0,o,u)}s.clip.apply(s,y),m=v.copy().invert().getMatrix(),s.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const g=!p&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";g&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(v){v[t](r,n,i)}),g&&s.restore(),d&&s.restore()}getClientRect(t={}){var r;const n=t.skipTransform,i=t.relativeTo;let a,s,o,u,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(v){if(!v.visible())return;const m=v.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});m.width===0&&m.height===0||(a===void 0?(a=m.x,s=m.y,o=m.x+m.width,u=m.y+m.height):(a=Math.min(a,m.x),s=Math.min(s,m.y),o=Math.max(o,m.x+m.width),u=Math.max(u,m.y+m.height)))});const p=this.find("Shape");let g=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){g=!0;break}return g&&a!==void 0?f={x:a,y:s,width:o-a,height:u-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}Bo.Container=jo;oc.Factory.addComponentsGetterSetter(jo,"clip",["x","y","width","height"]);oc.Factory.addGetterSetter(jo,"clipX",void 0,(0,Th.getNumberValidator)());oc.Factory.addGetterSetter(jo,"clipY",void 0,(0,Th.getNumberValidator)());oc.Factory.addGetterSetter(jo,"clipWidth",void 0,(0,Th.getNumberValidator)());oc.Factory.addGetterSetter(jo,"clipHeight",void 0,(0,Th.getNumberValidator)());oc.Factory.addGetterSetter(jo,"clipFunc");var b8={},zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.getCapturedShape=FD;zs.createEvent=mx;zs.hasPointerCapture=ND;zs.setPointerCapture=RD;zs.releaseCapture=D8;const PD=gt,tu=new Map,I8=PD.Konva._global.PointerEvent!==void 0;function FD(e){return tu.get(e)}function mx(e){return{evt:e,pointerId:e.pointerId}}function ND(e,t){return tu.get(e)===t}function RD(e,t){D8(e),t.getStage()&&(tu.set(e,t),I8&&t._fire("gotpointercapture",mx(new PointerEvent("gotpointercapture"))))}function D8(e,t){const r=tu.get(e);if(!r)return;const n=r.getStage();n&&n.content,tu.delete(e),I8&&r._fire("lostpointercapture",mx(new PointerEvent("lostpointercapture")))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=or,r=yt,n=Bo,i=gt,a=qi,s=Ch,o=gt,u=zs,f="Stage",d="string",p="px",g="mouseout",v="mouseleave",m="mouseover",y="mouseenter",C="mousemove",S="mousedown",w="mouseup",x="pointermove",T="pointerdown",A="pointerup",F="pointercancel",N="lostpointercapture",P="pointerout",I="pointerleave",b="pointerover",O="pointerenter",L="contextmenu",K="touchstart",ie="touchend",re="touchmove",ke="touchcancel",we="wheel",oe=5,X=[[y,"_pointerenter"],[S,"_pointerdown"],[C,"_pointermove"],[w,"_pointerup"],[v,"_pointerleave"],[K,"_pointerdown"],[re,"_pointermove"],[ie,"_pointerup"],[ke,"_pointercancel"],[m,"_pointerover"],[we,"_wheel"],[L,"_contextmenu"],[T,"_pointerdown"],[x,"_pointermove"],[A,"_pointerup"],[F,"_pointercancel"],[I,"_pointerleave"],[N,"_lostpointercapture"]],he={mouse:{[P]:g,[I]:v,[b]:m,[O]:y,[x]:C,[T]:S,[A]:w,[F]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[P]:"touchout",[I]:"touchleave",[b]:"touchover",[O]:"touchenter",[x]:re,[T]:K,[A]:ie,[F]:ke,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[P]:P,[I]:I,[b]:b,[O]:O,[x]:x,[T]:T,[A]:A,[F]:F,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},_e=ue=>ue.indexOf("pointer")>=0?"pointer":ue.indexOf("touch")>=0?"touch":"mouse",M=ue=>{const z=_e(ue);if(z==="pointer")return i.Konva.pointerEventsEnabled&&he.pointer;if(z==="touch")return he.touch;if(z==="mouse")return he.mouse};function J(ue={}){return(ue.clipFunc||ue.clipWidth||ue.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ue}const Q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class Y extends n.Container{constructor(z){super(J(z)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{J(this.attrs)}),this._checkVisibility()}_validateAdd(z){const te=z.getType()==="Layer",de=z.getType()==="FastLayer";te||de||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const z=this.visible()?"":"none";this.content.style.display=z}setContainer(z){if(typeof z===d){let te;if(z.charAt(0)==="."){const de=z.slice(1);z=document.getElementsByClassName(de)[0]}else z.charAt(0)!=="#"?te=z:te=z.slice(1),z=document.getElementById(te);if(!z)throw"Can not find container in document with id "+te}return this._setAttr("container",z),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),z.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const z=this.children,te=z.length;for(let de=0;de<te;de++)z[de].clear();return this}clone(z){return z||(z={}),z.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,z)}destroy(){super.destroy();const z=this.content;z&&t.Util._isInDocument(z)&&this.container().removeChild(z);const te=e.stages.indexOf(this);return te>-1&&e.stages.splice(te,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const z=this._pointerPositions[0]||this._changedPointerPositions[0];return z?{x:z.x,y:z.y}:(t.Util.warn(Q),null)}_getPointerById(z){return this._pointerPositions.find(te=>te.id===z)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(z){z=z||{},z.x=z.x||0,z.y=z.y||0,z.width=z.width||this.width(),z.height=z.height||this.height();const te=new a.SceneCanvas({width:z.width,height:z.height,pixelRatio:z.pixelRatio||1}),de=te.getContext()._context,xe=this.children;return(z.x||z.y)&&de.translate(-1*z.x,-1*z.y),xe.forEach(function(Me){if(!Me.isVisible())return;const G=Me._toKonvaCanvas(z);de.drawImage(G._canvas,z.x,z.y,G.getWidth()/G.getPixelRatio(),G.getHeight()/G.getPixelRatio())}),te}getIntersection(z){if(!z)return null;const te=this.children,de=te.length,xe=de-1;for(let Me=xe;Me>=0;Me--){const G=te[Me].getIntersection(z);if(G)return G}return null}_resizeDOM(){const z=this.width(),te=this.height();this.content&&(this.content.style.width=z+p,this.content.style.height=te+p),this.bufferCanvas.setSize(z,te),this.bufferHitCanvas.setSize(z,te),this.children.forEach(de=>{de.setSize({width:z,height:te}),de.draw()})}add(z,...te){if(arguments.length>1){for(let xe=0;xe<arguments.length;xe++)this.add(arguments[xe]);return this}super.add(z);const de=this.children.length;return de>oe&&t.Util.warn("The stage has "+de+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),z.setSize({width:this.width(),height:this.height()}),z.draw(),i.Konva.isBrowser&&this.content.appendChild(z.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(z){return u.hasPointerCapture(z,this)}setPointerCapture(z){u.setPointerCapture(z,this)}releaseCapture(z){u.releaseCapture(z,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([z,te])=>{this.content.addEventListener(z,de=>{this[te](de)},{passive:!1})})}_pointerenter(z){this.setPointersPositions(z);const te=M(z.type);te&&this._fire(te.pointerenter,{evt:z,target:this,currentTarget:this})}_pointerover(z){this.setPointersPositions(z);const te=M(z.type);te&&this._fire(te.pointerover,{evt:z,target:this,currentTarget:this})}_getTargetShape(z){let te=this[z+"targetShape"];return te&&!te.getStage()&&(te=null),te}_pointerleave(z){const te=M(z.type),de=_e(z.type);if(!te)return;this.setPointersPositions(z);const xe=this._getTargetShape(de),Me=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;xe&&Me?(xe._fireAndBubble(te.pointerout,{evt:z}),xe._fireAndBubble(te.pointerleave,{evt:z}),this._fire(te.pointerleave,{evt:z,target:this,currentTarget:this}),this[de+"targetShape"]=null):Me&&(this._fire(te.pointerleave,{evt:z,target:this,currentTarget:this}),this._fire(te.pointerout,{evt:z,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(z){const te=M(z.type),de=_e(z.type);if(!te)return;this.setPointersPositions(z);let xe=!1;this._changedPointerPositions.forEach(Me=>{const G=this.getIntersection(Me);if(s.DD.justDragged=!1,i.Konva["_"+de+"ListenClick"]=!0,!G||!G.isListening()){this[de+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&G.setPointerCapture(Me.id),this[de+"ClickStartShape"]=G,G._fireAndBubble(te.pointerdown,{evt:z,pointerId:Me.id}),xe=!0;const tt=z.type.indexOf("touch")>=0;G.preventDefault()&&z.cancelable&&tt&&z.preventDefault()}),xe||this._fire(te.pointerdown,{evt:z,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(z){const te=M(z.type),de=_e(z.type);if(!te||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&z.cancelable&&z.preventDefault(),this.setPointersPositions(z),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Me={};let G=!1;const tt=this._getTargetShape(de);this._changedPointerPositions.forEach(nt=>{const Xe=u.getCapturedShape(nt.id)||this.getIntersection(nt),Ze=nt.id,Ie={evt:z,pointerId:Ze},Ct=tt!==Xe;if(Ct&&tt&&(tt._fireAndBubble(te.pointerout,{...Ie},Xe),tt._fireAndBubble(te.pointerleave,{...Ie},Xe)),Xe){if(Me[Xe._id])return;Me[Xe._id]=!0}Xe&&Xe.isListening()?(G=!0,Ct&&(Xe._fireAndBubble(te.pointerover,{...Ie},tt),Xe._fireAndBubble(te.pointerenter,{...Ie},tt),this[de+"targetShape"]=Xe),Xe._fireAndBubble(te.pointermove,{...Ie})):tt&&(this._fire(te.pointerover,{evt:z,target:this,currentTarget:this,pointerId:Ze}),this[de+"targetShape"]=null)}),G||this._fire(te.pointermove,{evt:z,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(z){const te=M(z.type),de=_e(z.type);if(!te)return;this.setPointersPositions(z);const xe=this[de+"ClickStartShape"],Me=this[de+"ClickEndShape"],G={};let tt=!1;this._changedPointerPositions.forEach(nt=>{const Xe=u.getCapturedShape(nt.id)||this.getIntersection(nt);if(Xe){if(Xe.releaseCapture(nt.id),G[Xe._id])return;G[Xe._id]=!0}const Ze=nt.id,Ie={evt:z,pointerId:Ze};let Ct=!1;i.Konva["_"+de+"InDblClickWindow"]?(Ct=!0,clearTimeout(this[de+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+de+"InDblClickWindow"]=!0,clearTimeout(this[de+"DblTimeout"])),this[de+"DblTimeout"]=setTimeout(function(){i.Konva["_"+de+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Xe&&Xe.isListening()?(tt=!0,this[de+"ClickEndShape"]=Xe,Xe._fireAndBubble(te.pointerup,{...Ie}),i.Konva["_"+de+"ListenClick"]&&xe&&xe===Xe&&(Xe._fireAndBubble(te.pointerclick,{...Ie}),Ct&&Me&&Me===Xe&&Xe._fireAndBubble(te.pointerdblclick,{...Ie}))):(this[de+"ClickEndShape"]=null,i.Konva["_"+de+"ListenClick"]&&this._fire(te.pointerclick,{evt:z,target:this,currentTarget:this,pointerId:Ze}),Ct&&this._fire(te.pointerdblclick,{evt:z,target:this,currentTarget:this,pointerId:Ze}))}),tt||this._fire(te.pointerup,{evt:z,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+de+"ListenClick"]=!1,z.cancelable&&de!=="touch"&&de!=="pointer"&&z.preventDefault()}_contextmenu(z){this.setPointersPositions(z);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(L,{evt:z}):this._fire(L,{evt:z,target:this,currentTarget:this})}_wheel(z){this.setPointersPositions(z);const te=this.getIntersection(this.getPointerPosition());te&&te.isListening()?te._fireAndBubble(we,{evt:z}):this._fire(we,{evt:z,target:this,currentTarget:this})}_pointercancel(z){this.setPointersPositions(z);const te=u.getCapturedShape(z.pointerId)||this.getIntersection(this.getPointerPosition());te&&te._fireAndBubble(A,u.createEvent(z)),u.releaseCapture(z.pointerId)}_lostpointercapture(z){u.releaseCapture(z.pointerId)}setPointersPositions(z){const te=this._getContentPosition();let de=null,xe=null;z=z||window.event,z.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(z.touches,Me=>{this._pointerPositions.push({id:Me.identifier,x:(Me.clientX-te.left)/te.scaleX,y:(Me.clientY-te.top)/te.scaleY})}),Array.prototype.forEach.call(z.changedTouches||z.touches,Me=>{this._changedPointerPositions.push({id:Me.identifier,x:(Me.clientX-te.left)/te.scaleX,y:(Me.clientY-te.top)/te.scaleY})})):(de=(z.clientX-te.left)/te.scaleX,xe=(z.clientY-te.top)/te.scaleY,this.pointerPos={x:de,y:xe},this._pointerPositions=[{x:de,y:xe,id:t.Util._getFirstPointerId(z)}],this._changedPointerPositions=[{x:de,y:xe,id:t.Util._getFirstPointerId(z)}])}_setPointerPosition(z){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(z)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const z=this.content.getBoundingClientRect();return{top:z.top,left:z.left,scaleX:z.width/this.content.clientWidth||1,scaleY:z.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const z=this.container();if(!z)throw"Stage has no container. A container is required.";z.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),z.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(z){z.batchDraw()}),this}}e.Stage=Y,Y.prototype.nodeType=f,(0,o._registerNode)(Y),r.Factory.addGetterSetter(Y,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(ue=>{ue.batchDraw()})})})(b8);var mu={},Dr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=gt,r=or,n=yt,i=tr,a=at,s=gt,o=zs,u="hasShadow",f="shadowRGBA",d="patternImage",p="linearGradient",g="radialGradient";let v;function m(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}e.shapes={};function y(I){const b=this.attrs.fillRule;b?I.fill(b):I.fill()}function C(I){I.stroke()}function S(I){const b=this.attrs.fillRule;b?I.fill(b):I.fill()}function w(I){I.stroke()}function x(){this._clearCache(u)}function T(){this._clearCache(f)}function A(){this._clearCache(d)}function F(){this._clearCache(p)}function N(){this._clearCache(g)}class P extends i.Node{constructor(b){super(b);let O;for(;O=r.Util.getRandomColor(),!(O&&!(O in e.shapes)););this.colorKey=O,e.shapes[O]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const O=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(O&&O.setTransform){const L=new r.Transform;L.translate(this.fillPatternX(),this.fillPatternY()),L.rotate(t.Konva.getAngle(this.fillPatternRotation())),L.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),L.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const K=L.getMatrix(),ie=typeof DOMMatrix>"u"?{a:K[0],b:K[1],c:K[2],d:K[3],e:K[4],f:K[5]}:new DOMMatrix(K);O.setTransform(ie)}return O}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const b=this.fillLinearGradientColorStops();if(b){const O=m(),L=this.fillLinearGradientStartPoint(),K=this.fillLinearGradientEndPoint(),ie=O.createLinearGradient(L.x,L.y,K.x,K.y);for(let re=0;re<b.length;re+=2)ie.addColorStop(b[re],b[re+1]);return ie}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const b=this.fillRadialGradientColorStops();if(b){const O=m(),L=this.fillRadialGradientStartPoint(),K=this.fillRadialGradientEndPoint(),ie=O.createRadialGradient(L.x,L.y,this.fillRadialGradientStartRadius(),K.x,K.y,this.fillRadialGradientEndRadius());for(let re=0;re<b.length;re+=2)ie.addColorStop(b[re],b[re+1]);return ie}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const b=r.Util.colorToRGBA(this.shadowColor());if(b)return"rgba("+b.r+","+b.g+","+b.b+","+b.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const b=this.hitStrokeWidth();return b==="auto"?this.hasStroke():this.strokeEnabled()&&!!b}intersects(b){const O=this.getStage();if(!O)return!1;const L=O.bufferHitCanvas;return L.getContext().clear(),this.drawHit(L,void 0,!0),L.context.getImageData(Math.round(b.x),Math.round(b.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(b){var O;if(!((O=this.attrs.perfectDrawEnabled)!==null&&O!==void 0?O:!0))return!1;const K=b||this.hasFill(),ie=this.hasStroke(),re=this.getAbsoluteOpacity()!==1;if(K&&ie&&re)return!0;const ke=this.hasShadow(),we=this.shadowForStrokeEnabled();return!!(K&&ie&&ke&&we)}setStrokeHitEnabled(b){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),b?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const b=this.size();return{x:this._centroid?-b.width/2:0,y:this._centroid?-b.height/2:0,width:b.width,height:b.height}}getClientRect(b={}){let O=!1,L=this.getParent();for(;L;){if(L.isCached()){O=!0;break}L=L.getParent()}const K=b.skipTransform,ie=b.relativeTo||O&&this.getStage()||void 0,re=this.getSelfRect(),we=!b.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,oe=re.width+we,X=re.height+we,he=!b.skipShadow&&this.hasShadow(),_e=he?this.shadowOffsetX():0,M=he?this.shadowOffsetY():0,J=oe+Math.abs(_e),Q=X+Math.abs(M),Y=he&&this.shadowBlur()||0,ue=J+Y*2,z=Q+Y*2,te={width:ue,height:z,x:-(we/2+Y)+Math.min(_e,0)+re.x,y:-(we/2+Y)+Math.min(M,0)+re.y};return K?te:this._transformedRect(te,ie)}drawScene(b,O,L){const K=this.getLayer(),ie=b||K.getCanvas(),re=ie.getContext(),ke=this._getCanvasCache(),we=this.getSceneFunc(),oe=this.hasShadow();let X;const he=!1,_e=O===this;if(!this.isVisible()&&!_e)return this;if(ke){re.save();const M=this.getAbsoluteTransform(O).getMatrix();return re.transform(M[0],M[1],M[2],M[3],M[4],M[5]),this._drawCachedSceneCanvas(re),re.restore(),this}if(!we)return this;if(re.save(),this._useBufferCanvas()&&!he){X=this.getStage();const M=L||X.bufferCanvas,J=M.getContext();J.clear(),J.save(),J._applyLineJoin(this);const Q=this.getAbsoluteTransform(O).getMatrix();J.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]),we.call(this,J,this),J.restore();const Y=M.pixelRatio;oe&&re._applyShadow(this),re._applyOpacity(this),re._applyGlobalCompositeOperation(this),re.drawImage(M._canvas,M.x||0,M.y||0,M.width/Y,M.height/Y)}else{if(re._applyLineJoin(this),!_e){const M=this.getAbsoluteTransform(O).getMatrix();re.transform(M[0],M[1],M[2],M[3],M[4],M[5]),re._applyOpacity(this),re._applyGlobalCompositeOperation(this)}oe&&re._applyShadow(this),we.call(this,re,this)}return re.restore(),this}drawHit(b,O,L=!1){if(!this.shouldDrawHit(O,L))return this;const K=this.getLayer(),ie=b||K.hitCanvas,re=ie&&ie.getContext(),ke=this.hitFunc()||this.sceneFunc(),we=this._getCanvasCache(),oe=we&&we.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),oe){re.save();const he=this.getAbsoluteTransform(O).getMatrix();return re.transform(he[0],he[1],he[2],he[3],he[4],he[5]),this._drawCachedHitCanvas(re),re.restore(),this}if(!ke)return this;if(re.save(),re._applyLineJoin(this),!(this===O)){const he=this.getAbsoluteTransform(O).getMatrix();re.transform(he[0],he[1],he[2],he[3],he[4],he[5])}return ke.call(this,re,this),re.restore(),this}drawHitFromCache(b=0){const O=this._getCanvasCache(),L=this._getCachedSceneCanvas(),K=O.hit,ie=K.getContext(),re=K.getWidth(),ke=K.getHeight();ie.clear(),ie.drawImage(L._canvas,0,0,re,ke);try{const we=ie.getImageData(0,0,re,ke),oe=we.data,X=oe.length,he=r.Util._hexToRgb(this.colorKey);for(let _e=0;_e<X;_e+=4)oe[_e+3]>b?(oe[_e]=he.r,oe[_e+1]=he.g,oe[_e+2]=he.b,oe[_e+3]=255):oe[_e+3]=0;ie.putImageData(we,0,0)}catch(we){r.Util.error("Unable to draw hit graph from cached scene canvas. "+we.message)}return this}hasPointerCapture(b){return o.hasPointerCapture(b,this)}setPointerCapture(b){o.setPointerCapture(b,this)}releaseCapture(b){o.releaseCapture(b,this)}}e.Shape=P,P.prototype._fillFunc=y,P.prototype._strokeFunc=C,P.prototype._fillFuncHit=S,P.prototype._strokeFuncHit=w,P.prototype._centroid=!1,P.prototype.nodeType="Shape",(0,s._registerNode)(P),P.prototype.eventListeners={},P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",F),P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),n.Factory.addGetterSetter(P,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(P,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(P,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(P,"lineJoin"),n.Factory.addGetterSetter(P,"lineCap"),n.Factory.addGetterSetter(P,"sceneFunc"),n.Factory.addGetterSetter(P,"hitFunc"),n.Factory.addGetterSetter(P,"dash"),n.Factory.addGetterSetter(P,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(P,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(P,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternImage"),n.Factory.addGetterSetter(P,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(P,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(P,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(P,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(P,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(P,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(P,"fillEnabled",!0),n.Factory.addGetterSetter(P,"strokeEnabled",!0),n.Factory.addGetterSetter(P,"shadowEnabled",!0),n.Factory.addGetterSetter(P,"dashEnabled",!0),n.Factory.addGetterSetter(P,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(P,"fillPriority","color"),n.Factory.addComponentsGetterSetter(P,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(P,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(P,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(P,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(P,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(P,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(P,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(P,"fillPatternRotation",0),n.Factory.addGetterSetter(P,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(P,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Dr);Object.defineProperty(mu,"__esModule",{value:!0});mu.Layer=void 0;const Pa=or,gg=Bo,dl=tr,xx=yt,U3=qi,bD=at,ID=Dr,DD=gt,OD="#",LD="beforeDraw",MD="draw",O8=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],BD=O8.length;let lc=class extends gg.Container{constructor(t){super(t),this.canvas=new U3.SceneCanvas,this.hitCanvas=new U3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),t<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[t+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){dl.Node.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!dl.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(dl.Node.prototype.moveDown.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(dl.Node.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return dl.Node.prototype.remove.call(this),t&&t.parentNode&&Pa.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:r}){return this.canvas.setSize(t,r),this.hitCanvas.setSize(t,r),this._setSmoothEnabled(),this}_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&Pa.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),dl.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Pa.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Pa.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Pa.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<BD;i++){const a=O8[i],s=this._getIntersection({x:t.x+a.x*r,y:t.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(t){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*r),Math.round(t.y*r),1,1).data,i=n[3];if(i===255){const a=Pa.Util._rgbToHex(n[0],n[1],n[2]),s=ID.shapes[OD+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(LD,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),gg.Container.prototype.drawScene.call(this,a,r,n),this._fire(MD,{node:this}),this}drawHit(t,r){const n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),gg.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Pa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Pa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Pa.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};mu.Layer=lc;lc.prototype.nodeType="Layer";(0,DD._registerNode)(lc);xx.Factory.addGetterSetter(lc,"imageSmoothingEnabled",!0);xx.Factory.addGetterSetter(lc,"clearBeforeDraw",!0);xx.Factory.addGetterSetter(lc,"hitGraphEnabled",!0,(0,bD.getBooleanValidator)());var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.FastLayer=void 0;const jD=or,UD=mu,zD=gt;class vx extends UD.Layer{constructor(t){super(t),this.listening(!1),jD.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Ah.FastLayer=vx;vx.prototype.nodeType="FastLayer";(0,zD._registerNode)(vx);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Group=void 0;const VD=or,GD=Bo,HD=gt;let yx=class extends GD.Container{_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&VD.Util.throw("You may only add groups and shapes to groups.")}};cc.Group=yx;yx.prototype.nodeType="Group";(0,HD._registerNode)(yx);var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.Animation=void 0;const mg=gt,z3=or,xg=function(){return mg.glob.performance&&mg.glob.performance.now?function(){return mg.glob.performance.now()}:function(){return new Date().getTime()}}();class ha{constructor(t,r){this.id=ha.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:xg(),frameRate:0},this.func=t,this.setLayers(r)}setLayers(t){let r=[];return t&&(r=Array.isArray(t)?t:[t]),this.layers=r,this}getLayers(){return this.layers}addLayer(t){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const r=ha.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=xg(),ha._addAnimation(this),this}stop(){return ha._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const r=t.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const t={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(xg());const o=a.length;let u;if(s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<o;f++){const d=a[f];d._id!==void 0&&(t[d._id]=d)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=ha;t.animations.length?(t._runFrames(),z3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,z3.Util.requestAnimFrame(this._animationLoop))}}uc.Animation=ha;ha.animations=[];ha.animIdCounter=0;ha.animRunning=!1;var L8={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=or,r=uc,n=tr,i=gt,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,u=3,f=["fill","stroke","shadowColor"];let d=0;class p{constructor(m,y,C,S,w,x,T){this.prop=m,this.propFunc=y,this.begin=S,this._pos=S,this.duration=x,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=C,this._change=w-this.begin,this.pause()}fire(m){const y=this[m];y&&y()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===o?this.setTime(m):this.state===u&&this.setTime(this.duration-m)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(m){const y=this,C=m.node,S=C._id,w=m.easing||e.Easings.Linear,x=!!m.yoyo;let T,A;typeof m.duration>"u"?T=.3:m.duration===0?T=.001:T=m.duration,this.node=C,this._id=d++;const F=C.getLayer()||(C instanceof i.Konva.Stage?C.getLayers():null);F||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){y.tween.onEnterFrame()},F),this.tween=new p(A,function(N){y._tweenFunc(N)},w,0,1,T*1e3,x),this._addListeners(),g.attrs[S]||(g.attrs[S]={}),g.attrs[S][this._id]||(g.attrs[S][this._id]={}),g.tweens[S]||(g.tweens[S]={});for(A in m)a[A]===void 0&&this._addAttr(A,m[A]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,y){const C=this.node,S=C._id;let w,x,T,A,F;const N=g.tweens[S][m];N&&delete g.attrs[S][N][m];let P=C.getAttr(m);if(t.Util._isArray(y))if(w=[],x=Math.max(y.length,P.length),m==="points"&&y.length!==P.length&&(y.length>P.length?(A=P,P=t.Util._prepareArrayForTween(P,y,C.closed())):(T=y,y=t.Util._prepareArrayForTween(y,P,C.closed()))),m.indexOf("fill")===0)for(let I=0;I<x;I++)if(I%2===0)w.push(y[I]-P[I]);else{const b=t.Util.colorToRGBA(P[I]);F=t.Util.colorToRGBA(y[I]),P[I]=b,w.push({r:F.r-b.r,g:F.g-b.g,b:F.b-b.b,a:F.a-b.a})}else for(let I=0;I<x;I++)w.push(y[I]-P[I]);else f.indexOf(m)!==-1?(P=t.Util.colorToRGBA(P),F=t.Util.colorToRGBA(y),w={r:F.r-P.r,g:F.g-P.g,b:F.b-P.b,a:F.a-P.a}):w=y-P;g.attrs[S][this._id][m]={start:P,diff:w,end:y,trueEnd:T,trueStart:A},g.tweens[S][m]=this._id}_tweenFunc(m){const y=this.node,C=g.attrs[y._id][this._id];let S,w,x,T,A,F,N,P;for(S in C){if(w=C[S],x=w.start,T=w.diff,P=w.end,t.Util._isArray(x))if(A=[],N=Math.max(x.length,P.length),S.indexOf("fill")===0)for(F=0;F<N;F++)F%2===0?A.push((x[F]||0)+T[F]*m):A.push("rgba("+Math.round(x[F].r+T[F].r*m)+","+Math.round(x[F].g+T[F].g*m)+","+Math.round(x[F].b+T[F].b*m)+","+(x[F].a+T[F].a*m)+")");else for(F=0;F<N;F++)A.push((x[F]||0)+T[F]*m);else f.indexOf(S)!==-1?A="rgba("+Math.round(x.r+T.r*m)+","+Math.round(x.g+T.g*m)+","+Math.round(x.b+T.b*m)+","+(x.a+T.a*m)+")":A=x+T*m;y.setAttr(S,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,y=g.attrs[m._id][this._id];y.points&&y.points.trueEnd&&m.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,y=g.attrs[m._id][this._id];y.points&&y.points.trueStart&&m.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,y=this._id,C=g.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const S in C)delete g.tweens[m][S];delete g.attrs[m][y],g.tweens[m]&&(Object.keys(g.tweens[m]).length===0&&delete g.tweens[m],Object.keys(g.attrs[m]).length===0&&delete g.attrs[m])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(v){const m=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),m&&m()},new g(v).play()},e.Easings={BackEaseIn(v,m,y,C){return y*(v/=C)*v*((1.70158+1)*v-1.70158)+m},BackEaseOut(v,m,y,C){return y*((v=v/C-1)*v*((1.70158+1)*v+1.70158)+1)+m},BackEaseInOut(v,m,y,C){let S=1.70158;return(v/=C/2)<1?y/2*(v*v*(((S*=1.525)+1)*v-S))+m:y/2*((v-=2)*v*(((S*=1.525)+1)*v+S)+2)+m},ElasticEaseIn(v,m,y,C,S,w){let x=0;return v===0?m:(v/=C)===1?m+y:(w||(w=C*.3),!S||S<Math.abs(y)?(S=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/S),-(S*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w))+m)},ElasticEaseOut(v,m,y,C,S,w){let x=0;return v===0?m:(v/=C)===1?m+y:(w||(w=C*.3),!S||S<Math.abs(y)?(S=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/S),S*Math.pow(2,-10*v)*Math.sin((v*C-x)*(2*Math.PI)/w)+y+m)},ElasticEaseInOut(v,m,y,C,S,w){let x=0;return v===0?m:(v/=C/2)===2?m+y:(w||(w=C*(.3*1.5)),!S||S<Math.abs(y)?(S=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/S),v<1?-.5*(S*Math.pow(2,10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w))+m:S*Math.pow(2,-10*(v-=1))*Math.sin((v*C-x)*(2*Math.PI)/w)*.5+y+m)},BounceEaseOut(v,m,y,C){return(v/=C)<1/2.75?y*(7.5625*v*v)+m:v<2/2.75?y*(7.5625*(v-=1.5/2.75)*v+.75)+m:v<2.5/2.75?y*(7.5625*(v-=2.25/2.75)*v+.9375)+m:y*(7.5625*(v-=2.625/2.75)*v+.984375)+m},BounceEaseIn(v,m,y,C){return y-e.Easings.BounceEaseOut(C-v,0,y,C)+m},BounceEaseInOut(v,m,y,C){return v<C/2?e.Easings.BounceEaseIn(v*2,0,y,C)*.5+m:e.Easings.BounceEaseOut(v*2-C,0,y,C)*.5+y*.5+m},EaseIn(v,m,y,C){return y*(v/=C)*v+m},EaseOut(v,m,y,C){return-y*(v/=C)*(v-2)+m},EaseInOut(v,m,y,C){return(v/=C/2)<1?y/2*v*v+m:-y/2*(--v*(v-2)-1)+m},StrongEaseIn(v,m,y,C){return y*(v/=C)*v*v*v*v+m},StrongEaseOut(v,m,y,C){return y*((v=v/C-1)*v*v*v*v+1)+m},StrongEaseInOut(v,m,y,C){return(v/=C/2)<1?y/2*v*v*v*v*v+m:y/2*((v-=2)*v*v*v*v+2)+m},Linear(v,m,y,C){return y*v/C+m}}})(L8);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=gt,r=or,n=tr,i=Bo,a=b8,s=mu,o=Ah,u=cc,f=Ch,d=Dr,p=uc,g=L8,v=Ua,m=qi;e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:u.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:v.Context,Canvas:m.Canvas}),e.default=e.Konva})($d);var Ph={};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.Arc=void 0;const Fh=yt,WD=Dr,V3=gt,Nh=at,$D=gt;class qa extends WD.Shape{_sceneFunc(t){const r=V3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,r,n),t.arc(0,0,this.innerRadius(),r,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=V3.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?t:r),d=s*r,p=o*(o>0?t:r),g=u*(u>0?r:t);return{x:f,y:n?-1*g:p,width:d-f,height:g-p}}}Ph.Arc=qa;qa.prototype._centroid=!0;qa.prototype.className="Arc";qa.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,$D._registerNode)(qa);Fh.Factory.addGetterSetter(qa,"innerRadius",0,(0,Nh.getNumberValidator)());Fh.Factory.addGetterSetter(qa,"outerRadius",0,(0,Nh.getNumberValidator)());Fh.Factory.addGetterSetter(qa,"angle",0,(0,Nh.getNumberValidator)());Fh.Factory.addGetterSetter(qa,"clockwise",!1,(0,Nh.getBooleanValidator)());var Rh={},xu={};Object.defineProperty(xu,"__esModule",{value:!0});xu.Line=void 0;const bh=yt,XD=gt,KD=Dr,M8=at;function Mm(e,t,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*o/(o+u),d=s*u/(o+u),p=r-f*(i-e),g=n-f*(a-t),v=r+d*(i-e),m=n+d*(a-t);return[p,g,v,m]}function G3(e,t){const r=e.length,n=[];for(let i=2;i<r-2;i+=2){const a=Mm(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(e[i]),n.push(e[i+1]),n.push(a[2]),n.push(a[3]))}return n}let Vs=class extends KD.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let o=0;if(t.beginPath(),t.moveTo(r[0],r[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(o=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);o<f-2;)t.bezierCurveTo(u[o++],u[o++],u[o++],u[o++],u[o++],u[o++]);a||t.quadraticCurveTo(u[f-2],u[f-1],r[n-2],r[n-1])}else if(s)for(o=2;o<n;)t.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)t.lineTo(r[o],r[o+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():G3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),r=t.length,n=this.tension(),i=Mm(t[r-2],t[r-1],t[0],t[1],t[2],t[3],n),a=Mm(t[r-4],t[r-3],t[r-2],t[r-1],t[0],t[1],n),s=G3(t,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],t[r-2],t[r-1],a[2],a[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};xu.Line=Vs;Vs.prototype.className="Line";Vs.prototype._attrsAffectingSize=["points","bezier","tension"];(0,XD._registerNode)(Vs);bh.Factory.addGetterSetter(Vs,"closed",!1);bh.Factory.addGetterSetter(Vs,"bezier",!1);bh.Factory.addGetterSetter(Vs,"tension",0,(0,M8.getNumberValidator)());bh.Factory.addGetterSetter(Vs,"points",[],(0,M8.getNumberArrayValidator)());var fc={},B8={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,o,u)=>{let f,d;const g=u/2;f=0;for(let v=0;v<20;v++)d=g*e.tValues[20][v]+g,f+=e.cValues[20][v]*n(s,o,d);return g*f};e.getCubicArcLength=t;const r=(s,o,u)=>{u===void 0&&(u=1);const f=s[0]-2*s[1]+s[2],d=o[0]-2*o[1]+o[2],p=2*s[1]-2*s[0],g=2*o[1]-2*o[0],v=4*(f*f+d*d),m=4*(f*p+d*g),y=p*p+g*g;if(v===0)return u*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const C=m/(2*v),S=y/v,w=u+C,x=S-C*C,T=w*w+x>0?Math.sqrt(w*w+x):0,A=C*C+x>0?Math.sqrt(C*C+x):0,F=C+Math.sqrt(C*C+x)!==0?x*Math.log(Math.abs((w+T)/(C+A))):0;return Math.sqrt(v)/2*(w*T-C*A+F)};e.getQuadraticArcLength=r;function n(s,o,u){const f=i(1,u,s),d=i(1,u,o),p=f*f+d*d;return Math.sqrt(p)}const i=(s,o,u)=>{const f=u.length-1;let d,p;if(f===0)return 0;if(s===0){p=0;for(let g=0;g<=f;g++)p+=e.binomialCoefficients[f][g]*Math.pow(1-o,f-g)*Math.pow(o,g)*u[g];return p}else{d=new Array(f);for(let g=0;g<f;g++)d[g]=f*(u[g+1]-u[g]);return i(s-1,o,d)}},a=(s,o,u)=>{let f=1,d=s/o,p=(s-u(d))/o,g=0;for(;f>.001;){const v=u(d+p),m=Math.abs(s-v)/o;if(m<f)f=m,d+=p;else{const y=u(d-p),C=Math.abs(s-y)/o;C<f?(f=C,d-=p):p/=2}if(g++,g>500)break}return d};e.t2length=a})(B8);Object.defineProperty(fc,"__esModule",{value:!0});fc.Path=void 0;const YD=yt,QD=gt,qD=Dr,hl=B8;class Pr extends qD.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Pr.parsePathData(this.data()),this.pathLength=Pr.getPathLength(this.dataArray)}_sceneFunc(t){const r=this.dataArray;t.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const o=s[0],u=s[1],f=s[2],d=s[3],p=s[4],g=s[5],v=s[6],m=s[7],y=f>d?f:d,C=f>d?1:f/d,S=f>d?d/f:1;t.translate(o,u),t.rotate(v),t.scale(C,S),t.arc(0,0,y,p,p+g,1-m),t.scale(1/C,1/S),t.rotate(-v),t.translate(-o,-u);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],d=u.points[5],p=u.points[4]+d;let g=Math.PI/180;if(Math.abs(f-p)<g&&(g=Math.abs(f-p)),d<0)for(let v=f-g;v>p;v-=g){const m=Pr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}else for(let v=f+g;v<p;v+=g){const m=Pr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const d=Pr.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(d.x,d.y)}else t=t.concat(u.points)});let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return Pr.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}static getPathLength(t){let r=0;for(let n=0;n<t.length;++n)r+=t[n].pathLength;return r}static getPointAtLengthOfDataArray(t,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&t>r[i].pathLength;)t-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],o=s.points;switch(s.command){case"L":return Pr.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Pr.getPointOnCubicBezier((0,hl.t2length)(t,Pr.getPathLength(r),y=>(0,hl.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Pr.getPointOnQuadraticBezier((0,hl.t2length)(t,Pr.getPathLength(r),y=>(0,hl.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":const u=o[0],f=o[1],d=o[2],p=o[3],g=o[5],v=o[6];let m=o[4];return m+=g*t/s.pathLength,Pr.getPointOnEllipticalArc(u,f,d,p,m,v)}return null}static getPointOnLine(t,r,n,i,a,s,o){s=s??r,o=o??n;const u=this.getLineLength(r,n,i,a);if(u<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?t:-t)};const f=(a-n)/(i-r),d=Math.sqrt(t*t/(1+f*f))*(i<r?-1:1),p=f*d;if(Math.abs(o-n-f*(s-r))<1e-10)return{x:s+d,y:o+p};const g=((s-r)*(i-r)+(o-n)*(a-n))/(u*u),v=r+g*(i-r),m=n+g*(a-n),y=this.getLineLength(s,o,v,m),C=Math.sqrt(t*t-y*y),S=Math.sqrt(C*C/(1+f*f))*(i<r?-1:1),w=f*S;return{x:v+S,y:m+w}}static getPointOnCubicBezier(t,r,n,i,a,s,o,u,f){function d(C){return C*C*C}function p(C){return 3*C*C*(1-C)}function g(C){return 3*C*(1-C)*(1-C)}function v(C){return(1-C)*(1-C)*(1-C)}const m=u*d(t)+s*p(t)+i*g(t)+r*v(t),y=f*d(t)+o*p(t)+a*g(t)+n*v(t);return{x:m,y}}static getPointOnQuadraticBezier(t,r,n,i,a,s,o){function u(v){return v*v}function f(v){return 2*v*(1-v)}function d(v){return(1-v)*(1-v)}const p=s*u(t)+i*f(t)+r*d(t),g=o*u(t)+a*f(t)+n*d(t);return{x:p,y:g}}static getPointOnEllipticalArc(t,r,n,i,a,s){const o=Math.cos(s),u=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(f.x*o-f.y*u),y:r+(f.x*u+f.y*o)}}static parsePathData(t){if(!t)return[];let r=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let p=0;p<n.length;p++)r=r.replace(new RegExp(n[p],"g"),"|"+n[p]);const i=r.split("|"),a=[],s=[];let o=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let p=1;p<i.length;p++){let g=i[p],v=g.charAt(0);for(g=g.slice(1),s.length=0;d=f.exec(g);)s.push(d[0]);const m=[];for(let y=0,C=s.length;y<C;y++){if(s[y]==="00"){m.push(0,0);continue}const S=parseFloat(s[y]);isNaN(S)?m.push(0):m.push(S)}for(;m.length>0&&!isNaN(m[0]);){let y="",C=[];const S=o,w=u;let x,T,A,F,N,P,I,b,O,L;switch(v){case"l":o+=m.shift(),u+=m.shift(),y="L",C.push(o,u);break;case"L":o=m.shift(),u=m.shift(),C.push(o,u);break;case"m":const K=m.shift(),ie=m.shift();if(o+=K,u+=ie,y="M",a.length>2&&a[a.length-1].command==="z"){for(let re=a.length-2;re>=0;re--)if(a[re].command==="M"){o=a[re].points[0]+K,u=a[re].points[1]+ie;break}}C.push(o,u),v="l";break;case"M":o=m.shift(),u=m.shift(),y="M",C.push(o,u),v="L";break;case"h":o+=m.shift(),y="L",C.push(o,u);break;case"H":o=m.shift(),y="L",C.push(o,u);break;case"v":u+=m.shift(),y="L",C.push(o,u);break;case"V":u=m.shift(),y="L",C.push(o,u);break;case"C":C.push(m.shift(),m.shift(),m.shift(),m.shift()),o=m.shift(),u=m.shift(),C.push(o,u);break;case"c":C.push(o+m.shift(),u+m.shift(),o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="C",C.push(o,u);break;case"S":T=o,A=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),A=u+(u-x.points[3])),C.push(T,A,m.shift(),m.shift()),o=m.shift(),u=m.shift(),y="C",C.push(o,u);break;case"s":T=o,A=u,x=a[a.length-1],x.command==="C"&&(T=o+(o-x.points[2]),A=u+(u-x.points[3])),C.push(T,A,o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="C",C.push(o,u);break;case"Q":C.push(m.shift(),m.shift()),o=m.shift(),u=m.shift(),C.push(o,u);break;case"q":C.push(o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="Q",C.push(o,u);break;case"T":T=o,A=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),A=u+(u-x.points[1])),o=m.shift(),u=m.shift(),y="Q",C.push(T,A,o,u);break;case"t":T=o,A=u,x=a[a.length-1],x.command==="Q"&&(T=o+(o-x.points[0]),A=u+(u-x.points[1])),o+=m.shift(),u+=m.shift(),y="Q",C.push(T,A,o,u);break;case"A":F=m.shift(),N=m.shift(),P=m.shift(),I=m.shift(),b=m.shift(),O=o,L=u,o=m.shift(),u=m.shift(),y="A",C=this.convertEndpointToCenterParameterization(O,L,o,u,I,b,F,N,P);break;case"a":F=m.shift(),N=m.shift(),P=m.shift(),I=m.shift(),b=m.shift(),O=o,L=u,o+=m.shift(),u+=m.shift(),y="A",C=this.convertEndpointToCenterParameterization(O,L,o,u,I,b,F,N,P);break}a.push({command:y||v,points:C,start:{x:S,y:w},pathLength:this.calcLength(S,w,y||v,C)})}(v==="z"||v==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,r,n,i){let a,s,o,u;const f=Pr;switch(n){case"L":return f.getLineLength(t,r,i[0],i[1]);case"C":return(0,hl.getCubicArcLength)([t,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,hl.getQuadraticArcLength)([t,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],p=i[5],g=i[4]+p;let v=Math.PI/180;if(Math.abs(d-g)<v&&(v=Math.abs(d-g)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),p<0)for(u=d-v;u>g;u-=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=d+v;u<g;u+=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],g,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(t,r,n,i,a,s,o,u,f){const d=f*(Math.PI/180),p=Math.cos(d)*(t-n)/2+Math.sin(d)*(r-i)/2,g=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(r-i)/2,v=p*p/(o*o)+g*g/(u*u);v>1&&(o*=Math.sqrt(v),u*=Math.sqrt(v));let m=Math.sqrt((o*o*(u*u)-o*o*(g*g)-u*u*(p*p))/(o*o*(g*g)+u*u*(p*p)));a===s&&(m*=-1),isNaN(m)&&(m=0);const y=m*o*g/u,C=m*-u*p/o,S=(t+n)/2+Math.cos(d)*y-Math.sin(d)*C,w=(r+i)/2+Math.sin(d)*y+Math.cos(d)*C,x=function(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])},T=function(b,O){return(b[0]*O[0]+b[1]*O[1])/(x(b)*x(O))},A=function(b,O){return(b[0]*O[1]<b[1]*O[0]?-1:1)*Math.acos(T(b,O))},F=A([1,0],[(p-y)/o,(g-C)/u]),N=[(p-y)/o,(g-C)/u],P=[(-1*p-y)/o,(-1*g-C)/u];let I=A(N,P);return T(N,P)<=-1&&(I=Math.PI),T(N,P)>=1&&(I=0),s===0&&I>0&&(I=I-2*Math.PI),s===1&&I<0&&(I=I+2*Math.PI),[S,w,o,u,F,I,d,s]}}fc.Path=Pr;Pr.prototype.className="Path";Pr.prototype._attrsAffectingSize=["data"];(0,QD._registerNode)(Pr);YD.Factory.addGetterSetter(Pr,"data");Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Arrow=void 0;const Ih=yt,JD=xu,j8=at,ZD=gt,H3=fc;class Uo extends JD.Line{_sceneFunc(t){super._sceneFunc(t);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let u,f;if(a){const g=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],v=H3.Path.calcLength(i[i.length-4],i[i.length-3],"C",g),m=H3.Path.getPointOnQuadraticBezier(Math.min(1,1-s/v),g[0],g[1],g[2],g[3],g[4],g[5]);u=n[o-2]-m.x,f=n[o-1]-m.y}else u=n[o-2]-n[o-4],f=n[o-1]-n[o-3];const d=(Math.atan2(f,u)+r)%r,p=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[o-2],n[o-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),a?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-u)+r)%r),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),r=this.pointerWidth()/2;return{x:t.x,y:t.y-r,width:t.width,height:t.height+r*2}}}Rh.Arrow=Uo;Uo.prototype.className="Arrow";(0,ZD._registerNode)(Uo);Ih.Factory.addGetterSetter(Uo,"pointerLength",10,(0,j8.getNumberValidator)());Ih.Factory.addGetterSetter(Uo,"pointerWidth",10,(0,j8.getNumberValidator)());Ih.Factory.addGetterSetter(Uo,"pointerAtBeginning",!1);Ih.Factory.addGetterSetter(Uo,"pointerAtEnding",!0);var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});Dh.Circle=void 0;const eO=yt,tO=Dr,rO=at,nO=gt;let dc=class extends tO.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Dh.Circle=dc;dc.prototype._centroid=!0;dc.prototype.className="Circle";dc.prototype._attrsAffectingSize=["radius"];(0,nO._registerNode)(dc);eO.Factory.addGetterSetter(dc,"radius",0,(0,rO.getNumberValidator)());var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.Ellipse=void 0;const _x=yt,iO=Dr,U8=at,aO=gt;class Gs extends iO.Shape{_sceneFunc(t){const r=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),r!==n&&t.scale(1,n/r),t.arc(0,0,r,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Oh.Ellipse=Gs;Gs.prototype.className="Ellipse";Gs.prototype._centroid=!0;Gs.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,aO._registerNode)(Gs);_x.Factory.addComponentsGetterSetter(Gs,"radius",["x","y"]);_x.Factory.addGetterSetter(Gs,"radiusX",0,(0,U8.getNumberValidator)());_x.Factory.addGetterSetter(Gs,"radiusY",0,(0,U8.getNumberValidator)());var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.Image=void 0;const vg=or,zo=yt,sO=Dr,oO=gt,vu=at;class Ni extends sO.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),r=this.hasShadow();return t&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,u=this.attrs.cropHeight;o&&u?s=[a,this.cropX(),this.cropY(),o,u,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?vg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){const r=this.width(),n=this.height(),i=this.cornerRadius();t.beginPath(),i?vg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,r;return(t=this.attrs.width)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var t,r;return(t=this.attrs.height)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(t,r,n=null){const i=vg.Util.createImageElement();i.onload=function(){const a=new Ni({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=t}}Lh.Image=Ni;Ni.prototype.className="Image";(0,oO._registerNode)(Ni);zo.Factory.addGetterSetter(Ni,"cornerRadius",0,(0,vu.getNumberOrArrayOfNumbersValidator)(4));zo.Factory.addGetterSetter(Ni,"image");zo.Factory.addComponentsGetterSetter(Ni,"crop",["x","y","width","height"]);zo.Factory.addGetterSetter(Ni,"cropX",0,(0,vu.getNumberValidator)());zo.Factory.addGetterSetter(Ni,"cropY",0,(0,vu.getNumberValidator)());zo.Factory.addGetterSetter(Ni,"cropWidth",0,(0,vu.getNumberValidator)());zo.Factory.addGetterSetter(Ni,"cropHeight",0,(0,vu.getNumberValidator)());var Jl={};Object.defineProperty(Jl,"__esModule",{value:!0});Jl.Tag=Jl.Label=void 0;const Mh=yt,lO=Dr,cO=cc,Sx=at,z8=gt,V8=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],uO="Change.konva",fO="none",Bm="up",jm="right",Um="down",zm="left",dO=V8.length;class wx extends cO.Group{constructor(t){super(t),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let r=this,n;const i=function(){r._sync()};for(n=0;n<dO;n++)t.on(V8[n]+uO,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),r=this.getTag(),n,i,a,s,o,u,f;if(t&&r){switch(n=t.width(),i=t.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),o=0,u=0,a){case Bm:o=n/2,u=-1*f;break;case jm:o=n+s,u=i/2;break;case Um:o=n/2,u=i+f;break;case zm:o=-1*s,u=i/2;break}r.setAttrs({x:-1*o,y:-1*u,width:n,height:i}),t.setAttrs({x:-1*o,y:-1*u})}}}Jl.Label=wx;wx.prototype.className="Label";(0,z8._registerNode)(wx);class Vo extends lO.Shape{_sceneFunc(t){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let u=0,f=0,d=0,p=0;typeof o=="number"?u=f=d=p=Math.min(o,r/2,n/2):(u=Math.min(o[0]||0,r/2,n/2),f=Math.min(o[1]||0,r/2,n/2),p=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),t.beginPath(),t.moveTo(u,0),i===Bm&&(t.lineTo((r-a)/2,0),t.lineTo(r/2,-1*s),t.lineTo((r+a)/2,0)),t.lineTo(r-f,0),t.arc(r-f,f,f,Math.PI*3/2,0,!1),i===jm&&(t.lineTo(r,(n-s)/2),t.lineTo(r+a,n/2),t.lineTo(r,(n+s)/2)),t.lineTo(r,n-p),t.arc(r-p,n-p,p,0,Math.PI/2,!1),i===Um&&(t.lineTo((r+a)/2,n),t.lineTo(r/2,n+s),t.lineTo((r-a)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===zm&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===Bm?(r-=i,o+=i):a===Um?o+=i:a===zm?(t-=n*1.5,s+=n):a===jm&&(s+=n*1.5),{x:t,y:r,width:s,height:o}}}Jl.Tag=Vo;Vo.prototype.className="Tag";(0,z8._registerNode)(Vo);Mh.Factory.addGetterSetter(Vo,"pointerDirection",fO);Mh.Factory.addGetterSetter(Vo,"pointerWidth",0,(0,Sx.getNumberValidator)());Mh.Factory.addGetterSetter(Vo,"pointerHeight",0,(0,Sx.getNumberValidator)());Mh.Factory.addGetterSetter(Vo,"cornerRadius",0,(0,Sx.getNumberOrArrayOfNumbersValidator)(4));var yu={};Object.defineProperty(yu,"__esModule",{value:!0});yu.Rect=void 0;const hO=yt,pO=Dr,gO=gt,mO=or,xO=at;let Bh=class extends pO.Shape{_sceneFunc(t){const r=this.cornerRadius(),n=this.width(),i=this.height();t.beginPath(),r?mO.Util.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}};yu.Rect=Bh;Bh.prototype.className="Rect";(0,gO._registerNode)(Bh);hO.Factory.addGetterSetter(Bh,"cornerRadius",0,(0,xO.getNumberOrArrayOfNumbersValidator)(4));var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.RegularPolygon=void 0;const G8=yt,vO=Dr,H8=at,yO=gt;class Go extends vO.Shape{_sceneFunc(t){const r=this._getPoints();t.beginPath(),t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<t;i++)n.push({x:r*Math.sin(i*2*Math.PI/t),y:-1*r*Math.cos(i*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let r=t[0].x,n=t[0].y,i=t[0].x,a=t[0].y;return t.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}jh.RegularPolygon=Go;Go.prototype.className="RegularPolygon";Go.prototype._centroid=!0;Go.prototype._attrsAffectingSize=["radius"];(0,yO._registerNode)(Go);G8.Factory.addGetterSetter(Go,"radius",0,(0,H8.getNumberValidator)());G8.Factory.addGetterSetter(Go,"sides",0,(0,H8.getNumberValidator)());var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.Ring=void 0;const W8=yt,_O=Dr,$8=at,SO=gt,W3=Math.PI*2;class Ho extends _O.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,W3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),W3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Uh.Ring=Ho;Ho.prototype.className="Ring";Ho.prototype._centroid=!0;Ho.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,SO._registerNode)(Ho);W8.Factory.addGetterSetter(Ho,"innerRadius",0,(0,$8.getNumberValidator)());W8.Factory.addGetterSetter(Ho,"outerRadius",0,(0,$8.getNumberValidator)());var zh={};Object.defineProperty(zh,"__esModule",{value:!0});zh.Sprite=void 0;const Wo=yt,wO=Dr,kO=uc,X8=at,EO=gt;class ya extends wO.Shape{constructor(t){super(t),this._updated=!0,this.anim=new kO.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],u=a[i+1],f=a[i+2],d=a[i+3],p=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,d),t.closePath(),t.fillStrokeShape(this)),p)if(s){const g=s[r],v=n*2;t.drawImage(p,o,u,f,d,g[v+0],g[v+1],f,d)}else t.drawImage(p,o,u,f,d,0,0,f,d)}_hitFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],u=a[i+3];if(t.beginPath(),s){const f=s[r],d=n*2;t.rect(f[d+0],f[d+1],o,u)}else t.rect(0,0,o,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}}zh.Sprite=ya;ya.prototype.className="Sprite";(0,EO._registerNode)(ya);Wo.Factory.addGetterSetter(ya,"animation");Wo.Factory.addGetterSetter(ya,"animations");Wo.Factory.addGetterSetter(ya,"frameOffsets");Wo.Factory.addGetterSetter(ya,"image");Wo.Factory.addGetterSetter(ya,"frameIndex",0,(0,X8.getNumberValidator)());Wo.Factory.addGetterSetter(ya,"frameRate",17,(0,X8.getNumberValidator)());Wo.Factory.backCompat(ya,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});Vh.Star=void 0;const kx=yt,CO=Dr,Ex=at,TO=gt;class Hs extends CO.Shape{_sceneFunc(t){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),u=-1*s*Math.cos(a*Math.PI/i);t.lineTo(o,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Vh.Star=Hs;Hs.prototype.className="Star";Hs.prototype._centroid=!0;Hs.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,TO._registerNode)(Hs);kx.Factory.addGetterSetter(Hs,"numPoints",5,(0,Ex.getNumberValidator)());kx.Factory.addGetterSetter(Hs,"innerRadius",0,(0,Ex.getNumberValidator)());kx.Factory.addGetterSetter(Hs,"outerRadius",0,(0,Ex.getNumberValidator)());var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.Text=void 0;hc.stringToArray=lo;const Vm=or,wn=yt,AO=Dr,yg=gt,Ws=at,PO=gt;function lo(e){return[...e].reduce((t,r,n,i)=>{if(/\p{Emoji}/u.test(r)){const a=i[n+1];a&&/\p{Emoji_Modifier}|\u200D/u.test(a)?(t.push(r+a),i[n+1]=""):t.push(r)}else/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?t.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?t[t.length-1]+=r:r&&t.push(r);return t},[])}const pl="auto",FO="center",K8="inherit",Hc="justify",NO="Change.konva",RO="2d",$3="-",Y8="left",bO="text",IO="Text",DO="top",OO="bottom",X3="middle",Q8="normal",LO="px ",Gf=" ",MO="right",K3="rtl",BO="word",jO="char",Y3="none",_g="",q8=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],UO=q8.length;function zO(e){return e.split(",").map(t=>{t=t.trim();const r=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return r&&!n&&(t=`"${t}"`),t}).join(", ")}let Hf;function Sg(){return Hf||(Hf=Vm.Util.createCanvasElement().getContext(RO),Hf)}function VO(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function GO(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function HO(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}let hr=class extends AO.Shape{constructor(t){super(HO(t)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<UO;r++)this.on(q8[r]+NO,this._setTextData);this._setTextData()}_sceneFunc(t){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),u=this.direction(),f=0,d=this.align(),p=this.getWidth(),g=this.letterSpacing(),v=this.fill(),m=this.textDecoration(),y=m.indexOf("underline")!==-1,C=m.indexOf("line-through")!==-1,S;u=u===K8?t.direction:u;let w=s/2,x=X3;if(yg.Konva._fixTextRendering){const T=this.measureSize("M");x="alphabetic",w=(T.fontBoundingBoxAscent-T.fontBoundingBoxDescent)/2+s/2}for(u===K3&&t.setAttr("direction",u),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",Y8),o===X3?f=(this.getHeight()-n*s-i*2)/2:o===OO&&(f=this.getHeight()-n*s-i*2),t.translate(i,f+i),S=0;S<n;S++){let T=0,A=0;const F=r[S],N=F.text,P=F.width,I=F.lastInParagraph;if(t.save(),d===MO?T+=p-P-i*2:d===FO&&(T+=(p-P-i*2)/2),y){t.save(),t.beginPath();const b=yg.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),O=T,L=w+A+b;t.moveTo(O,L);const K=d===Hc&&!I?p-i*2:P;t.lineTo(O+Math.round(K),L),t.lineWidth=a/15;const ie=this._getLinearGradient();t.strokeStyle=ie||v,t.stroke(),t.restore()}if(C){t.save(),t.beginPath();const b=yg.Konva._fixTextRendering?-Math.round(a/4):0;t.moveTo(T,w+A+b);const O=d===Hc&&!I?p-i*2:P;t.lineTo(T+Math.round(O),w+A+b),t.lineWidth=a/15;const L=this._getLinearGradient();t.strokeStyle=L||v,t.stroke(),t.restore()}if(u!==K3&&(g!==0||d===Hc)){const b=N.split(" ").length-1,O=lo(N);for(let L=0;L<O.length;L++){const K=O[L];K===" "&&!I&&d===Hc&&(T+=(p-i*2-P)/b),this._partialTextX=T,this._partialTextY=w+A,this._partialText=K,t.fillStrokeShape(this),T+=this.measureSize(K).width+g}}else g!==0&&t.setAttr("letterSpacing",`${g}px`),this._partialTextX=T,this._partialTextY=w+A,this._partialText=N,t.fillStrokeShape(this);t.restore(),n>1&&(w+=s)}}_hitFunc(t){const r=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const r=Vm.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(bO,r),this}getWidth(){return this.attrs.width===pl||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===pl||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Vm.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var r,n,i,a,s,o,u,f,d,p,g;let v=Sg(),m=this.fontSize(),y;v.save(),v.font=this._getContextFont(),y=v.measureText(t),v.restore();const C=m/100;return{actualBoundingBoxAscent:(r=y.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*C,actualBoundingBoxDescent:(n=y.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=y.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*C,actualBoundingBoxRight:(a=y.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*C,alphabeticBaseline:(s=y.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=y.emHeightAscent)!==null&&o!==void 0?o:100*C,emHeightDescent:(u=y.emHeightDescent)!==null&&u!==void 0?u:-20*C,fontBoundingBoxAscent:(f=y.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*C,fontBoundingBoxDescent:(d=y.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*C,hangingBaseline:(p=y.hangingBaseline)!==null&&p!==void 0?p:72.80000305175781*C,ideographicBaseline:(g=y.ideographicBaseline)!==null&&g!==void 0?g:-21*C,width:y.width,height:m}}_getContextFont(){return this.fontStyle()+Gf+this.fontVariant()+Gf+(this.fontSize()+LO)+zO(this.fontFamily())}_addTextLine(t){this.align()===Hc&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const r=this.letterSpacing(),n=t.length;return Sg().measureText(t).width+r*n}_setTextData(){let t=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==pl&&a!==void 0,u=s!==pl&&s!==void 0,f=this.padding(),d=a-f*2,p=s-f*2,g=0,v=this.wrap(),m=v!==Y3,y=v!==jO&&m,C=this.ellipsis();this.textArr=[],Sg().font=this._getContextFont();const S=C?this._getTextWidth(_g):0;for(let w=0,x=t.length;w<x;++w){let T=t[w],A=this._getTextWidth(T);if(o&&A>d)for(;T.length>0;){let F=0,N=lo(T).length,P="",I=0;for(;F<N;){const b=F+N>>>1,O=lo(T),L=O.slice(0,b+1).join(""),K=this._getTextWidth(L);(C&&u&&g+i>p?K+S:K)<=d?(F=b+1,P=L,I=K):N=b}if(P){if(y){const L=lo(T),K=lo(P),ie=L[K.length],re=ie===Gf||ie===$3;let ke;if(re&&I<=d)ke=K.length;else{const we=K.lastIndexOf(Gf),oe=K.lastIndexOf($3);ke=Math.max(we,oe)+1}ke>0&&(F=ke,P=L.slice(0,F).join(""),I=this._getTextWidth(P))}if(P=P.trimRight(),this._addTextLine(P),n=Math.max(n,I),g+=i,this._shouldHandleEllipsis(g)){this._tryToAddEllipsisToLastLine();break}if(T=lo(T).slice(F).join("").trimLeft(),T.length>0&&(A=this._getTextWidth(T),A<=d)){this._addTextLine(T),g+=i,n=Math.max(n,A);break}}else break}else this._addTextLine(T),g+=i,n=Math.max(n,A),this._shouldHandleEllipsis(g)&&w<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&g+i>p)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(t){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==pl&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==Y3)||a&&t+n>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,r=t!==pl&&t!==void 0,n=this.padding(),i=t-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+_g)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+_g))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return t&&r?!0:super._useBufferCanvas()}};hc.Text=hr;hr.prototype._fillFunc=VO;hr.prototype._strokeFunc=GO;hr.prototype.className=IO;hr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,PO._registerNode)(hr);wn.Factory.overWriteSetter(hr,"width",(0,Ws.getNumberOrAutoValidator)());wn.Factory.overWriteSetter(hr,"height",(0,Ws.getNumberOrAutoValidator)());wn.Factory.addGetterSetter(hr,"direction",K8);wn.Factory.addGetterSetter(hr,"fontFamily","Arial");wn.Factory.addGetterSetter(hr,"fontSize",12,(0,Ws.getNumberValidator)());wn.Factory.addGetterSetter(hr,"fontStyle",Q8);wn.Factory.addGetterSetter(hr,"fontVariant",Q8);wn.Factory.addGetterSetter(hr,"padding",0,(0,Ws.getNumberValidator)());wn.Factory.addGetterSetter(hr,"align",Y8);wn.Factory.addGetterSetter(hr,"verticalAlign",DO);wn.Factory.addGetterSetter(hr,"lineHeight",1,(0,Ws.getNumberValidator)());wn.Factory.addGetterSetter(hr,"wrap",BO);wn.Factory.addGetterSetter(hr,"ellipsis",!1,(0,Ws.getBooleanValidator)());wn.Factory.addGetterSetter(hr,"letterSpacing",0,(0,Ws.getNumberValidator)());wn.Factory.addGetterSetter(hr,"text","",(0,Ws.getStringValidator)());wn.Factory.addGetterSetter(hr,"textDecoration","");var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.TextPath=void 0;const wg=or,Zi=yt,WO=Dr,Wc=fc,kg=hc,J8=at,$O=gt,XO="",Z8="normal";function ew(e){e.fillText(this.partialText,0,0)}function tw(e){e.strokeText(this.partialText,0,0)}class Or extends WO.Shape{constructor(t){super(t),this.dummyCanvas=wg.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Wc.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const r=this.pathLength;return t-1>r?null:Wc.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Wc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&t.beginPath();for(let s=0;s<a.length;s++){t.save();const o=a[s].p0;t.translate(o.x,o.y),t.rotate(a[s].rotation),this.partialText=a[s].text,t.fillStrokeShape(this),r==="underline"&&(s===0&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}r==="underline"&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return wg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return kg.Text.prototype.setText.call(this,t)}_getContextFont(){return kg.Text.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const u=(0,kg.stringToArray)(this.text());let f=o;for(let d=0;d<u.length;d++){const p=this._getPointAtLength(f);if(!p)return;let g=this._getTextSize(u[d]).width+n;if(u[d]===" "&&i==="justify"){const w=this.text().split(" ").length-1;g+=(this.pathLength-s)/w}const v=this._getPointAtLength(f+g);if(!v)return;const m=Wc.Path.getLineLength(p.x,p.y,v.x,v.y);let y=0;if(a)try{y=a(u[d-1],u[d])*this.fontSize()}catch{y=0}p.x+=y,v.x+=y,this.textWidth+=y;const C=Wc.Path.getPointOnLine(y+m/2,p.x,p.y,v.x,v.y),S=Math.atan2(v.y-p.y,v.x-p.x);this.glyphInfo.push({transposeX:C.x,transposeY:C.y,text:u[d],rotation:S,p0:p,p1:v}),f+=g}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(f){t.push(f.p0.x),t.push(f.p0.y),t.push(f.p1.x),t.push(f.p1.y)});let r=t[0]||0,n=t[0]||0,i=t[1]||0,a=t[1]||0,s,o;for(let f=0;f<t.length/2;f++)s=t[f*2],o=t[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const u=this.fontSize();return{x:r-u/2,y:i-u/2,width:n-r+u,height:a-i+u}}destroy(){return wg.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Gh.TextPath=Or;Or.prototype._fillFunc=ew;Or.prototype._strokeFunc=tw;Or.prototype._fillFuncHit=ew;Or.prototype._strokeFuncHit=tw;Or.prototype.className="TextPath";Or.prototype._attrsAffectingSize=["text","fontSize","data"];(0,$O._registerNode)(Or);Zi.Factory.addGetterSetter(Or,"data");Zi.Factory.addGetterSetter(Or,"fontFamily","Arial");Zi.Factory.addGetterSetter(Or,"fontSize",12,(0,J8.getNumberValidator)());Zi.Factory.addGetterSetter(Or,"fontStyle",Z8);Zi.Factory.addGetterSetter(Or,"align","left");Zi.Factory.addGetterSetter(Or,"letterSpacing",0,(0,J8.getNumberValidator)());Zi.Factory.addGetterSetter(Or,"textBaseline","middle");Zi.Factory.addGetterSetter(Or,"fontVariant",Z8);Zi.Factory.addGetterSetter(Or,"text",XO);Zi.Factory.addGetterSetter(Or,"textDecoration","");Zi.Factory.addGetterSetter(Or,"kerningFunc",void 0);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Transformer=void 0;const zt=or,Ot=yt,Q3=tr,KO=Dr,YO=yu,q3=cc,Ui=gt,$s=at,QO=gt,rw="tr-konva",qO=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${rw}`).join(" "),J3="nodesRect",JO=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],ZO={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},eL="ontouchstart"in Ui.Konva._global;function tL(e,t,r){if(e==="rotater")return r;t+=zt.Util.degToRad(ZO[e]||0);const n=(zt.Util.radToDeg(t)%360+360)%360;return zt.Util._inRange(n,315+22.5,360)||zt.Util._inRange(n,0,22.5)?"ns-resize":zt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":zt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":zt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":zt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":zt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":zt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":zt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(zt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Kd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Z3=1e8;function rL(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function nw(e,t,r){const n=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),i=r.y+(e.x-r.x)*Math.sin(t)+(e.y-r.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:n,y:i}}function nL(e,t){const r=rL(e);return nw(e,t,r)}function iL(e,t,r){let n=t;for(let i=0;i<e.length;i++){const a=Ui.Konva.getAngle(e[i]),s=Math.abs(a-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let Gm=0;class Et extends q3.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(qO,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return zt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return rw+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const r=t.filter(i=>i.isAncestorOf(this)?(zt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=r,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on(JO.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let r;t.on(`dragstart.${this._getEventNamespace()}`,n=>{r=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=t.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const u=o.getAbsolutePosition();o.setAbsolutePosition({x:u.x+a,y:u.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(J3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(J3,this.__getNodeRect)}__getNodeShape(t,r=this.rotation(),n){const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),o=i.x*a.x-t.offsetX()*a.x,u=i.y*a.y-t.offsetY()*a.y,f=(Ui.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+o*Math.cos(f)+u*Math.sin(-f),y:s.y+u*Math.cos(f)+o*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return nw(d,-Ui.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Z3,y:-Z3,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),p=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],g=f.getAbsoluteTransform();p.forEach(function(v){const m=g.point(v);r.push(m)})});const n=new zt.Transform;n.rotate(-Ui.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),n.invert();const u=n.point({x:i,y:a});return{x:u.x,y:u.y,width:s-i,height:o-a,rotation:Ui.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Kd.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const r=new YO.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:eL?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=Ui.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=tL(t,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const t=new KO.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*zt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",r=>{r.cancelBubble=!0}),t.on("dragmove",r=>{r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},Gm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:t.evt,target:u})})}_handleMouseMove(t){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let u={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,t)),a.setAbsolutePosition(u);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const w=this._getNodeRect();r=a.x()-w.width/2,n=-a.y()+w.height/2;let x=Math.atan2(-n,r)+Math.PI/2;w.height<0&&(x-=Math.PI);const A=Ui.Konva.getAngle(this.rotation())+x,F=Ui.Konva.getAngle(this.rotationSnapTolerance()),P=iL(this.rotationSnaps(),A,F)-w.rotation,I=nL(w,P);this._fitNodesInto(I,t);return}const p=this.shiftBehavior();let g;p==="inverted"?g=this.keepRatio()&&!t.shiftKey:p==="none"?g=this.keepRatio():g=this.keepRatio()||t.shiftKey;let v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-left").x()>w.x?-1:1,T=this.findOne(".top-left").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-left").x(w.x-r),this.findOne(".top-left").y(w.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-right").x()<w.x?-1:1,T=this.findOne(".top-right").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".top-right").x(w.x+r),this.findOne(".top-right").y(w.y-n)}var m=a.position();this.findOne(".top-left").y(m.y),this.findOne(".bottom-right").x(m.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(a.y()-w.y,2));const x=w.x<a.x()?-1:1,T=a.y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,a.x(w.x-r),a.y(w.y+n)}m=a.position(),this.findOne(".top-left").x(m.x),this.findOne(".bottom-right").y(m.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(a.y()-w.y,2));const x=this.findOne(".bottom-right").x()<w.x?-1:1,T=this.findOne(".bottom-right").y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*T,this.findOne(".bottom-right").x(w.x+r),this.findOne(".bottom-right").y(w.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(v=this.centeredScaling()||t.altKey,v){const w=this.findOne(".top-left"),x=this.findOne(".bottom-right"),T=w.x(),A=w.y(),F=this.getWidth()-x.x(),N=this.getHeight()-x.y();x.move({x:-T,y:-A}),w.move({x:F,y:N})}const y=this.findOne(".top-left").getAbsolutePosition();r=y.x,n=y.y;const C=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:C,height:S,rotation:Ui.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Gm--,this._fire("transformend",{evt:t,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:t,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,r){const n=this._getNodeRect(),i=1;if(zt.Util._inRange(t.width,-this.padding()*2-i,i)){this.update();return}if(zt.Util._inRange(t.height,-this.padding()*2-i,i)){this.update();return}const a=new zt.Transform;if(a.rotate(Ui.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const g=a.point({x:-this.padding()*2,y:0});t.x+=g.x,t.y+=g.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const g=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const g=a.point({x:0,y:-this.padding()*2});t.x+=g.x,t.y+=g.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const g=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const g=this.boundBoxFunc()(n,t);g?t=g:zt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new zt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const u=new zt.Transform,f=t.width/s,d=t.height/s;this.flipEnabled()===!1?(u.translate(t.x,t.y),u.rotate(t.rotation),u.translate(t.width<0?t.width:0,t.height<0?t.height:0),u.scale(Math.abs(f),Math.abs(d))):(u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(f,d));const p=u.multiply(o.invert());this._nodes.forEach(g=>{var v;const m=g.getParent().getAbsoluteTransform(),y=g.getTransform().copy();y.translate(g.offsetX(),g.offsetY());const C=new zt.Transform;C.multiply(m.copy().invert()).multiply(p).multiply(m).multiply(y);const S=C.decompose();g.setAttrs(S),(v=g.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(zt.Util._getRotation(t.rotation)),this._nodes.forEach(g=>{this._fire("transform",{evt:r,target:g}),g._fire("transform",{evt:r,target:g})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,r){this.findOne(t).setAttrs(r)}update(){var t;const r=this._getNodeRect();this.rotation(zt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(p=>{p.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+o,offsetY:u/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-o,offsetY:u/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*zt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(p=>{d(p)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),q3.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q3.Node.prototype.toObject.call(this)}clone(t){return Q3.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Hh.Transformer=Et;Et.isTransforming=()=>Gm>0;function aL(e){return e instanceof Array||zt.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Kd.indexOf(t)===-1&&zt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Kd.join(", "))}),e||[]}Et.prototype.className="Transformer";(0,QO._registerNode)(Et);Ot.Factory.addGetterSetter(Et,"enabledAnchors",Kd,aL);Ot.Factory.addGetterSetter(Et,"flipEnabled",!0,(0,$s.getBooleanValidator)());Ot.Factory.addGetterSetter(Et,"resizeEnabled",!0);Ot.Factory.addGetterSetter(Et,"anchorSize",10,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"rotateEnabled",!0);Ot.Factory.addGetterSetter(Et,"rotateLineVisible",!0);Ot.Factory.addGetterSetter(Et,"rotationSnaps",[]);Ot.Factory.addGetterSetter(Et,"rotateAnchorOffset",50,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"rotateAnchorCursor","crosshair");Ot.Factory.addGetterSetter(Et,"rotationSnapTolerance",5,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"borderEnabled",!0);Ot.Factory.addGetterSetter(Et,"anchorStroke","rgb(0, 161, 255)");Ot.Factory.addGetterSetter(Et,"anchorStrokeWidth",1,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"anchorFill","white");Ot.Factory.addGetterSetter(Et,"anchorCornerRadius",0,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"borderStroke","rgb(0, 161, 255)");Ot.Factory.addGetterSetter(Et,"borderStrokeWidth",1,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"borderDash");Ot.Factory.addGetterSetter(Et,"keepRatio",!0);Ot.Factory.addGetterSetter(Et,"shiftBehavior","default");Ot.Factory.addGetterSetter(Et,"centeredScaling",!1);Ot.Factory.addGetterSetter(Et,"ignoreStroke",!1);Ot.Factory.addGetterSetter(Et,"padding",0,(0,$s.getNumberValidator)());Ot.Factory.addGetterSetter(Et,"nodes");Ot.Factory.addGetterSetter(Et,"node");Ot.Factory.addGetterSetter(Et,"boundBoxFunc");Ot.Factory.addGetterSetter(Et,"anchorDragBoundFunc");Ot.Factory.addGetterSetter(Et,"anchorStyleFunc");Ot.Factory.addGetterSetter(Et,"shouldOverdrawWholeArea",!1);Ot.Factory.addGetterSetter(Et,"useSingleNodeRotation",!0);Ot.Factory.backCompat(Et,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Wedge=void 0;const $h=yt,sL=Dr,oL=gt,iw=at,lL=gt;class Ja extends sL.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,oL.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Wh.Wedge=Ja;Ja.prototype.className="Wedge";Ja.prototype._centroid=!0;Ja.prototype._attrsAffectingSize=["radius"];(0,lL._registerNode)(Ja);$h.Factory.addGetterSetter(Ja,"radius",0,(0,iw.getNumberValidator)());$h.Factory.addGetterSetter(Ja,"angle",0,(0,iw.getNumberValidator)());$h.Factory.addGetterSetter(Ja,"clockwise",!1);$h.Factory.backCompat(Ja,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});Xh.Blur=void 0;const e5=yt,cL=tr,uL=at;function t5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const fL=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],dL=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function hL(e,t){const r=e.data,n=e.width,i=e.height;let a,s,o,u,f,d,p,g,v,m,y,C,S,w,x,T,A,F,N,P;const I=t+t+1,b=n-1,O=i-1,L=t+1,K=L*(L+1)/2,ie=new t5,re=fL[t],ke=dL[t];let we=null,oe=ie,X=null,he=null;for(let _e=1;_e<I;_e++)oe=oe.next=new t5,_e===L&&(we=oe);oe.next=ie,o=s=0;for(let _e=0;_e<i;_e++){C=S=w=x=u=f=d=p=0,g=L*(T=r[s]),v=L*(A=r[s+1]),m=L*(F=r[s+2]),y=L*(N=r[s+3]),u+=K*T,f+=K*A,d+=K*F,p+=K*N,oe=ie;for(let M=0;M<L;M++)oe.r=T,oe.g=A,oe.b=F,oe.a=N,oe=oe.next;for(let M=1;M<L;M++)a=s+((b<M?b:M)<<2),u+=(oe.r=T=r[a])*(P=L-M),f+=(oe.g=A=r[a+1])*P,d+=(oe.b=F=r[a+2])*P,p+=(oe.a=N=r[a+3])*P,C+=T,S+=A,w+=F,x+=N,oe=oe.next;X=ie,he=we;for(let M=0;M<n;M++)r[s+3]=N=p*re>>ke,N!==0?(N=255/N,r[s]=(u*re>>ke)*N,r[s+1]=(f*re>>ke)*N,r[s+2]=(d*re>>ke)*N):r[s]=r[s+1]=r[s+2]=0,u-=g,f-=v,d-=m,p-=y,g-=X.r,v-=X.g,m-=X.b,y-=X.a,a=o+((a=M+t+1)<b?a:b)<<2,C+=X.r=r[a],S+=X.g=r[a+1],w+=X.b=r[a+2],x+=X.a=r[a+3],u+=C,f+=S,d+=w,p+=x,X=X.next,g+=T=he.r,v+=A=he.g,m+=F=he.b,y+=N=he.a,C-=T,S-=A,w-=F,x-=N,he=he.next,s+=4;o+=n}for(let _e=0;_e<n;_e++){S=w=x=C=f=d=p=u=0,s=_e<<2,g=L*(T=r[s]),v=L*(A=r[s+1]),m=L*(F=r[s+2]),y=L*(N=r[s+3]),u+=K*T,f+=K*A,d+=K*F,p+=K*N,oe=ie;for(let J=0;J<L;J++)oe.r=T,oe.g=A,oe.b=F,oe.a=N,oe=oe.next;let M=n;for(let J=1;J<=t;J++)s=M+_e<<2,u+=(oe.r=T=r[s])*(P=L-J),f+=(oe.g=A=r[s+1])*P,d+=(oe.b=F=r[s+2])*P,p+=(oe.a=N=r[s+3])*P,C+=T,S+=A,w+=F,x+=N,oe=oe.next,J<O&&(M+=n);s=_e,X=ie,he=we;for(let J=0;J<i;J++)a=s<<2,r[a+3]=N=p*re>>ke,N>0?(N=255/N,r[a]=(u*re>>ke)*N,r[a+1]=(f*re>>ke)*N,r[a+2]=(d*re>>ke)*N):r[a]=r[a+1]=r[a+2]=0,u-=g,f-=v,d-=m,p-=y,g-=X.r,v-=X.g,m-=X.b,y-=X.a,a=_e+((a=J+L)<O?a:O)*n<<2,u+=C+=X.r=r[a],f+=S+=X.g=r[a+1],d+=w+=X.b=r[a+2],p+=x+=X.a=r[a+3],X=X.next,g+=T=he.r,v+=A=he.g,m+=F=he.b,y+=N=he.a,C-=T,S-=A,w-=F,x-=N,he=he.next,s+=n}}const pL=function(t){const r=Math.round(this.blurRadius());r>0&&hL(t,r)};Xh.Blur=pL;e5.Factory.addGetterSetter(cL.Node,"blurRadius",0,(0,uL.getNumberValidator)(),e5.Factory.afterSetFilter);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Brighten=void 0;const r5=yt,gL=tr,mL=at,xL=function(e){const t=this.brightness()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=t,r[i+1]+=t,r[i+2]+=t};Kh.Brighten=xL;r5.Factory.addGetterSetter(gL.Node,"brightness",0,(0,mL.getNumberValidator)(),r5.Factory.afterSetFilter);var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Contrast=void 0;const n5=yt,vL=tr,yL=at,_L=function(e){const t=Math.pow((this.contrast()+100)/100,2),r=e.data,n=r.length;let i=150,a=150,s=150;for(let o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};Yh.Contrast=_L;n5.Factory.addGetterSetter(vL.Node,"contrast",0,(0,yL.getNumberValidator)(),n5.Factory.afterSetFilter);var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.Emboss=void 0;const Ls=yt,qh=tr,SL=or,aw=at,wL=function(e){const t=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=e.data,s=e.width,o=e.height,u=s*4;let f=0,d=0,p=o;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:SL.Util.error("Unknown emboss direction: "+n)}do{const g=(p-1)*u;let v=f;p+v<1&&(v=0),p+v>o&&(v=0);const m=(p-1+v)*s*4;let y=s;do{const C=g+(y-1)*4;let S=d;y+S<1&&(S=0),y+S>s&&(S=0);const w=m+(y-1+S)*4,x=a[C]-a[w],T=a[C+1]-a[w+1],A=a[C+2]-a[w+2];let F=x;const N=F>0?F:-F,P=T>0?T:-T,I=A>0?A:-A;if(P>N&&(F=T),I>N&&(F=A),F*=t,i){const b=a[C]+F,O=a[C+1]+F,L=a[C+2]+F;a[C]=b>255?255:b<0?0:b,a[C+1]=O>255?255:O<0?0:O,a[C+2]=L>255?255:L<0?0:L}else{let b=r-F;b<0?b=0:b>255&&(b=255),a[C]=a[C+1]=a[C+2]=b}}while(--y)}while(--p)};Qh.Emboss=wL;Ls.Factory.addGetterSetter(qh.Node,"embossStrength",.5,(0,aw.getNumberValidator)(),Ls.Factory.afterSetFilter);Ls.Factory.addGetterSetter(qh.Node,"embossWhiteLevel",.5,(0,aw.getNumberValidator)(),Ls.Factory.afterSetFilter);Ls.Factory.addGetterSetter(qh.Node,"embossDirection","top-left",void 0,Ls.Factory.afterSetFilter);Ls.Factory.addGetterSetter(qh.Node,"embossBlend",!1,void 0,Ls.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Enhance=void 0;const i5=yt,kL=tr,EL=at;function Eg(e,t,r,n,i){const a=r-t,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let o=(e-t)/a;return o=s*o+n,o}const CL=function(e){const t=e.data,r=t.length;let n=t[0],i=n,a,s=t[1],o=s,u,f=t[2],d=f,p;const g=this.enhance();if(g===0)return;for(let x=0;x<r;x+=4)a=t[x+0],a<n?n=a:a>i&&(i=a),u=t[x+1],u<s?s=u:u>o&&(o=u),p=t[x+2],p<f?f=p:p>d&&(d=p);i===n&&(i=255,n=0),o===s&&(o=255,s=0),d===f&&(d=255,f=0);let v,m,y,C,S,w;if(g>0)v=i+g*(255-i),m=n-g*(n-0),y=o+g*(255-o),C=s-g*(s-0),S=d+g*(255-d),w=f-g*(f-0);else{const x=(i+n)*.5;v=i+g*(i-x),m=n+g*(n-x);const T=(o+s)*.5;y=o+g*(o-T),C=s+g*(s-T);const A=(d+f)*.5;S=d+g*(d-A),w=f+g*(f-A)}for(let x=0;x<r;x+=4)t[x+0]=Eg(t[x+0],n,i,m,v),t[x+1]=Eg(t[x+1],s,o,C,y),t[x+2]=Eg(t[x+2],f,d,w,S)};Jh.Enhance=CL;i5.Factory.addGetterSetter(kL.Node,"enhance",0,(0,EL.getNumberValidator)(),i5.Factory.afterSetFilter);var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.Grayscale=void 0;const TL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=i,t[n+1]=i,t[n+2]=i}};Zh.Grayscale=TL;var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.HSL=void 0;const Zl=yt,Cx=tr,Tx=at;Zl.Factory.addGetterSetter(Cx.Node,"hue",0,(0,Tx.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Cx.Node,"saturation",0,(0,Tx.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Cx.Node,"luminance",0,(0,Tx.getNumberValidator)(),Zl.Factory.afterSetFilter);const AL=function(e){const t=e.data,r=t.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*o+.167*u,d=.587*n-.587*o+.33*u,p=.114*n-.114*o-.497*u,g=.299*n-.299*o-.328*u,v=.587*n+.413*o+.035*u,m=.114*n-.114*o+.293*u,y=.299*n-.3*o+1.25*u,C=.587*n-.586*o-1.05*u,S=.114*n+.886*o-.2*u;let w,x,T,A;for(let F=0;F<r;F+=4)w=t[F+0],x=t[F+1],T=t[F+2],A=t[F+3],t[F+0]=f*w+d*x+p*T+s,t[F+1]=g*w+v*x+m*T+s,t[F+2]=y*w+C*x+S*T+s,t[F+3]=A};e1.HSL=AL;var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.HSV=void 0;const ec=yt,Ax=tr,Px=at,PL=function(e){const t=e.data,r=t.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*s+.167*o,f=.587*n-.587*s+.33*o,d=.114*n-.114*s-.497*o,p=.299*n-.299*s-.328*o,g=.587*n+.413*s+.035*o,v=.114*n-.114*s+.293*o,m=.299*n-.3*s+1.25*o,y=.587*n-.586*s-1.05*o,C=.114*n+.886*s-.2*o;for(let S=0;S<r;S+=4){const w=t[S+0],x=t[S+1],T=t[S+2],A=t[S+3];t[S+0]=u*w+f*x+d*T,t[S+1]=p*w+g*x+v*T,t[S+2]=m*w+y*x+C*T,t[S+3]=A}};t1.HSV=PL;ec.Factory.addGetterSetter(Ax.Node,"hue",0,(0,Px.getNumberValidator)(),ec.Factory.afterSetFilter);ec.Factory.addGetterSetter(Ax.Node,"saturation",0,(0,Px.getNumberValidator)(),ec.Factory.afterSetFilter);ec.Factory.addGetterSetter(Ax.Node,"value",0,(0,Px.getNumberValidator)(),ec.Factory.afterSetFilter);var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Invert=void 0;const FL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};r1.Invert=FL;var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Kaleidoscope=void 0;const Yd=yt,sw=tr,a5=or,ow=at,NL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,y=360/m*Math.PI/180;for(let C=0;C<m;C+=1){const S=Math.sin(C*y),w=Math.cos(C*y);for(let x=0;x<v;x+=1){d=Math.floor(o+f*x/v*w),p=Math.floor(u+f*x/v*S);let T=(p*a+d)*4;const A=n[T+0],F=n[T+1],N=n[T+2],P=n[T+3];T=(C+x*a)*4,i[T+0]=A,i[T+1]=F,i[T+2]=N,i[T+3]=P}}},RL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,y=r.polarRotation||0;let C,S;for(d=0;d<a;d+=1)for(p=0;p<s;p+=1){const w=d-o,x=p-u,T=Math.sqrt(w*w+x*x)*v/f;let A=(Math.atan2(x,w)*180/Math.PI+360+y)%360;A=A*m/360,C=Math.floor(A),S=Math.floor(T);let F=(S*a+C)*4;const N=n[F+0],P=n[F+1],I=n[F+2],b=n[F+3];F=(p*a+d)*4,i[F+0]=N,i[F+1]=P,i[F+2]=I,i[F+3]=b}},bL=function(e){const t=e.width,r=e.height;let n,i,a,s,o,u,f,d,p,g,v=Math.round(this.kaleidoscopePower());const m=Math.round(this.kaleidoscopeAngle()),y=Math.floor(t*(m%360)/360);if(v<1)return;const C=a5.Util.createCanvasElement();C.width=t,C.height=r;const S=C.getContext("2d").getImageData(0,0,t,r);a5.Util.releaseCanvas(C),NL(e,S,{polarCenterX:t/2,polarCenterY:r/2});let w=t/Math.pow(2,v);for(;w<=8;)w=w*2,v-=1;w=Math.ceil(w);let x=w,T=0,A=x,F=1;for(y+w>t&&(T=x,A=0,F=-1),i=0;i<r;i+=1)for(n=T;n!==A;n+=F)a=Math.round(n+y)%t,p=(t*i+a)*4,o=S.data[p+0],u=S.data[p+1],f=S.data[p+2],d=S.data[p+3],g=(t*i+n)*4,S.data[g+0]=o,S.data[g+1]=u,S.data[g+2]=f,S.data[g+3]=d;for(i=0;i<r;i+=1)for(x=Math.floor(w),s=0;s<v;s+=1){for(n=0;n<x+1;n+=1)p=(t*i+n)*4,o=S.data[p+0],u=S.data[p+1],f=S.data[p+2],d=S.data[p+3],g=(t*i+x*2-n-1)*4,S.data[g+0]=o,S.data[g+1]=u,S.data[g+2]=f,S.data[g+3]=d;x*=2}RL(S,e,{polarRotation:0})};n1.Kaleidoscope=bL;Yd.Factory.addGetterSetter(sw.Node,"kaleidoscopePower",2,(0,ow.getNumberValidator)(),Yd.Factory.afterSetFilter);Yd.Factory.addGetterSetter(sw.Node,"kaleidoscopeAngle",0,(0,ow.getNumberValidator)(),Yd.Factory.afterSetFilter);var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.Mask=void 0;const s5=yt,IL=tr,DL=at;function Wf(e,t,r){let n=(r*e.width+t)*4;const i=[];return i.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),i}function $c(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function OL(e){const t=[0,0,0];for(let r=0;r<e.length;r++)t[0]+=e[r][0],t[1]+=e[r][1],t[2]+=e[r][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function LL(e,t){const r=Wf(e,0,0),n=Wf(e,e.width-1,0),i=Wf(e,0,e.height-1),a=Wf(e,e.width-1,e.height-1),s=t||10;if($c(r,n)<s&&$c(n,a)<s&&$c(a,i)<s&&$c(i,r)<s){const o=OL([n,r,a,i]),u=[];for(let f=0;f<e.width*e.height;f++){const d=$c(o,[e.data[f*4],e.data[f*4+1],e.data[f*4+2]]);u[f]=d<s?0:255}return u}}function ML(e,t){for(let r=0;r<e.width*e.height;r++)e.data[4*r+3]=t[r]}function BL(e,t,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,C=n[p*i+g];d+=e[y]*C}}s[f]=d===255*8?255:0}return s}function jL(e,t,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,C=n[p*i+g];d+=e[y]*C}}s[f]=d>=255*4?255:0}return s}function UL(e,t,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,C=n[p*i+g];d+=e[y]*C}}s[f]=d}return s}const zL=function(e){const t=this.threshold();let r=LL(e,t);return r&&(r=BL(r,e.width,e.height),r=jL(r,e.width,e.height),r=UL(r,e.width,e.height),ML(e,r)),e};i1.Mask=zL;s5.Factory.addGetterSetter(IL.Node,"threshold",0,(0,DL.getNumberValidator)(),s5.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.Noise=void 0;const o5=yt,VL=tr,GL=at,HL=function(e){const t=this.noise()*255,r=e.data,n=r.length,i=t/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};a1.Noise=HL;o5.Factory.addGetterSetter(VL.Node,"noise",.2,(0,GL.getNumberValidator)(),o5.Factory.afterSetFilter);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.Pixelate=void 0;const l5=yt,WL=or,$L=tr,XL=at,KL=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,n=e.height,i=Math.ceil(r/t),a=Math.ceil(n/t),s=e.data;if(t<=0){WL.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let u=0;u<a;u+=1){let f=0,d=0,p=0,g=0;const v=o*t,m=v+t,y=u*t,C=y+t;let S=0;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=y;x<C;x+=1){if(x>=n)continue;const T=(r*x+w)*4;f+=s[T+0],d+=s[T+1],p+=s[T+2],g+=s[T+3],S+=1}f=f/S,d=d/S,p=p/S,g=g/S;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=y;x<C;x+=1){if(x>=n)continue;const T=(r*x+w)*4;s[T+0]=f,s[T+1]=d,s[T+2]=p,s[T+3]=g}}};s1.Pixelate=KL;l5.Factory.addGetterSetter($L.Node,"pixelSize",8,(0,XL.getNumberValidator)(),l5.Factory.afterSetFilter);var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.Posterize=void 0;const c5=yt,YL=tr,QL=at,qL=function(e){const t=Math.round(this.levels()*254)+1,r=e.data,n=r.length,i=255/t;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};o1.Posterize=qL;c5.Factory.addGetterSetter(YL.Node,"levels",.5,(0,QL.getNumberValidator)(),c5.Factory.afterSetFilter);var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.RGB=void 0;const Qd=yt,Fx=tr,JL=at,ZL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const o=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=o*n,t[s+1]=o*i,t[s+2]=o*a,t[s+3]=t[s+3]}};l1.RGB=ZL;Qd.Factory.addGetterSetter(Fx.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Qd.Factory.addGetterSetter(Fx.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});Qd.Factory.addGetterSetter(Fx.Node,"blue",0,JL.RGBComponent,Qd.Factory.afterSetFilter);var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.RGBA=void 0;const ru=yt,u1=tr,eM=at,tM=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const u=1-s;t[o]=n*s+t[o]*u,t[o+1]=i*s+t[o+1]*u,t[o+2]=a*s+t[o+2]*u}};c1.RGBA=tM;ru.Factory.addGetterSetter(u1.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});ru.Factory.addGetterSetter(u1.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});ru.Factory.addGetterSetter(u1.Node,"blue",0,eM.RGBComponent,ru.Factory.afterSetFilter);ru.Factory.addGetterSetter(u1.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var f1={};Object.defineProperty(f1,"__esModule",{value:!0});f1.Sepia=void 0;const rM=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=t[n+0],a=t[n+1],s=t[n+2];t[n+0]=Math.min(255,i*.393+a*.769+s*.189),t[n+1]=Math.min(255,i*.349+a*.686+s*.168),t[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};f1.Sepia=rM;var d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.Solarize=void 0;const nM=function(e){const t=e.data,r=e.width,n=e.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const u=s+(o-1)*4;let f=t[u],d=t[u+1],p=t[u+2];f>127&&(f=255-f),d>127&&(d=255-d),p>127&&(p=255-p),t[u]=f,t[u+1]=d,t[u+2]=p}while(--o)}while(--a)};d1.Solarize=nM;var h1={};Object.defineProperty(h1,"__esModule",{value:!0});h1.Threshold=void 0;const u5=yt,iM=tr,aM=at,sM=function(e){const t=this.threshold()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<t?0:255};h1.Threshold=sM;u5.Factory.addGetterSetter(iM.Node,"threshold",.5,(0,aM.getNumberValidator)(),u5.Factory.afterSetFilter);Object.defineProperty(kh,"__esModule",{value:!0});kh.Konva=void 0;const f5=$d,oM=Ph,lM=Rh,cM=Dh,uM=Oh,fM=Lh,d5=Jl,dM=xu,hM=fc,pM=yu,gM=jh,mM=Uh,xM=zh,vM=Vh,yM=hc,_M=Gh,SM=Hh,wM=Wh,kM=Xh,EM=Kh,CM=Yh,TM=Qh,AM=Jh,PM=Zh,FM=e1,NM=t1,RM=r1,bM=n1,IM=i1,DM=a1,OM=s1,LM=o1,MM=l1,BM=c1,jM=f1,UM=d1,zM=h1;kh.Konva=f5.Konva.Util._assign(f5.Konva,{Arc:oM.Arc,Arrow:lM.Arrow,Circle:cM.Circle,Ellipse:uM.Ellipse,Image:fM.Image,Label:d5.Label,Tag:d5.Tag,Line:dM.Line,Path:hM.Path,Rect:pM.Rect,RegularPolygon:gM.RegularPolygon,Ring:mM.Ring,Sprite:xM.Sprite,Star:vM.Star,Text:yM.Text,TextPath:_M.TextPath,Transformer:SM.Transformer,Wedge:wM.Wedge,Filters:{Blur:kM.Blur,Brighten:EM.Brighten,Contrast:CM.Contrast,Emboss:TM.Emboss,Enhance:AM.Enhance,Grayscale:PM.Grayscale,HSL:FM.HSL,HSV:NM.HSV,Invert:RM.Invert,Kaleidoscope:bM.Kaleidoscope,Mask:IM.Mask,Noise:DM.Noise,Pixelate:OM.Pixelate,Posterize:LM.Posterize,RGB:MM.RGB,RGBA:BM.RGBA,Sepia:jM.Sepia,Solarize:UM.Solarize,Threshold:zM.Threshold}});var VM=P8.exports;Object.defineProperty(VM,"__esModule",{value:!0});const GM=kh;P8.exports=GM.Konva;var Hm={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=$d;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=$d;e.exports=n.Konva})(Hm,Hm.exports);var HM=Hm.exports;const nu=qd(HM);var lw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WM=function(t){var r={},n=Se,i=s0,a=Object.assign;function s(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),m=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),A=Symbol.iterator;function F(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}function N(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case g:return"Profiler";case p:return"StrictMode";case C:return"Suspense";case S:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case m:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case y:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case w:return c=l.displayName||null,c!==null?c:N(l.type)||"Memo";case x:c=l._payload,l=l._init;try{return N(l(c))}catch{}}return null}function P(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(c);case 8:return c===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function I(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function b(l){if(I(l)!==l)throw Error(s(188))}function O(l){var c=l.alternate;if(!c){if(c=I(l),c===null)throw Error(s(188));return c!==l?null:l}for(var h=l,_=c;;){var k=h.return;if(k===null)break;var R=k.alternate;if(R===null){if(_=k.return,_!==null){h=_;continue}break}if(k.child===R.child){for(R=k.child;R;){if(R===h)return b(k),l;if(R===_)return b(k),c;R=R.sibling}throw Error(s(188))}if(h.return!==_.return)h=k,_=R;else{for(var j=!1,Z=k.child;Z;){if(Z===h){j=!0,h=k,_=R;break}if(Z===_){j=!0,_=k,h=R;break}Z=Z.sibling}if(!j){for(Z=R.child;Z;){if(Z===h){j=!0,h=R,_=k;break}if(Z===_){j=!0,_=R,h=k;break}Z=Z.sibling}if(!j)throw Error(s(189))}}if(h.alternate!==_)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?l:c}function L(l){return l=O(l),l!==null?K(l):null}function K(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=K(l);if(c!==null)return c;l=l.sibling}return null}function ie(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=ie(l);if(c!==null)return c}l=l.sibling}return null}var re=Array.isArray,ke=t.getPublicInstance,we=t.getRootHostContext,oe=t.getChildHostContext,X=t.prepareForCommit,he=t.resetAfterCommit,_e=t.createInstance,M=t.appendInitialChild,J=t.finalizeInitialChildren,Q=t.prepareUpdate,Y=t.shouldSetTextContent,ue=t.createTextInstance,z=t.scheduleTimeout,te=t.cancelTimeout,de=t.noTimeout,xe=t.isPrimaryRenderer,Me=t.supportsMutation,G=t.supportsPersistence,tt=t.supportsHydration,nt=t.getInstanceFromNode,Xe=t.preparePortalMount,Ze=t.getCurrentEventPriority,Ie=t.detachDeletedInstance,Ct=t.supportsMicrotasks,Lr=t.scheduleMicrotask,me=t.supportsTestSelectors,pe=t.findFiberRoot,Te=t.getBoundingRect,Ae=t.getTextContent,Pe=t.isHiddenSubtree,De=t.matchAccessibilityRole,Ve=t.setFocusIfFocusable,ve=t.setupIntersectionObserver,q=t.appendChild,Ee=t.appendChildToContainer,Fe=t.commitTextUpdate,Ce=t.commitMount,Qe=t.commitUpdate,et=t.insertBefore,lt=t.insertInContainerBefore,Ye=t.removeChild,xt=t.removeChildFromContainer,si=t.resetTextContent,be=t.hideInstance,qe=t.hideTextInstance,Ge=t.unhideInstance,Je=t.unhideTextInstance,ut=t.clearContainer,Pt=t.cloneInstance,Dt=t.createContainerChildSet,kn=t.appendChildToContainerChildSet,tn=t.finalizeContainerChildren,mt=t.replaceContainerChildren,rn=t.cloneHiddenInstance,lr=t.cloneHiddenTextInstance,Xo=t.canHydrateInstance,Ko=t.canHydrateTextInstance,pc=t.canHydrateSuspenseInstance,_u=t.isSuspenseInstancePending,gc=t.isSuspenseInstanceFallback,g1=t.getSuspenseInstanceFallbackErrorDetails,D=t.registerSuspenseInstanceRetry,V=t.getNextHydratableSibling,B=t.getFirstHydratableChild,U=t.getFirstHydratableChildWithinContainer,H=t.getFirstHydratableChildWithinSuspenseInstance,W=t.hydrateInstance,ae=t.hydrateTextInstance,ye=t.hydrateSuspenseInstance,ne=t.getNextHydratableInstanceAfterSuspenseInstance,se=t.commitHydratedContainer,le=t.commitHydratedSuspenseInstance,Ne=t.clearSuspenseBoundary,Be=t.clearSuspenseBoundaryFromContainer,He=t.shouldDeleteUnhydratedTailInstances,Oe=t.didNotMatchHydratedContainerTextInstance,je=t.didNotMatchHydratedTextInstance,st;function Mt(l){if(st===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);st=c&&c[1]||""}return`
`+st+l}var Vt=!1;function vr(l,c){if(!l||Vt)return"";Vt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Le){var _=Le}Reflect.construct(l,[],c)}else{try{c.call()}catch(Le){_=Le}l.call(c.prototype)}else{try{throw Error()}catch(Le){_=Le}l()}}catch(Le){if(Le&&_&&typeof Le.stack=="string"){for(var k=Le.stack.split(`
`),R=_.stack.split(`
`),j=k.length-1,Z=R.length-1;1<=j&&0<=Z&&k[j]!==R[Z];)Z--;for(;1<=j&&0<=Z;j--,Z--)if(k[j]!==R[Z]){if(j!==1||Z!==1)do if(j--,Z--,0>Z||k[j]!==R[Z]){var fe=`
`+k[j].replace(" at new "," at ");return l.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",l.displayName)),fe}while(1<=j&&0<=Z);break}}}finally{Vt=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?Mt(l):""}var Ks=Object.prototype.hasOwnProperty,_a=[],oi=-1;function nn(l){return{current:l}}function Bt(l){0>oi||(l.current=_a[oi],_a[oi]=null,oi--)}function St(l,c){oi++,_a[oi]=l.current,l.current=c}var Za={},an=nn(Za),On=nn(!1),Ys=Za;function Yo(l,c){var h=l.type.contextTypes;if(!h)return Za;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var k={},R;for(R in h)k[R]=c[R];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=k),k}function Ln(l){return l=l.childContextTypes,l!=null}function Su(){Bt(On),Bt(an)}function bx(l,c,h){if(an.current!==Za)throw Error(s(168));St(an,c),St(On,h)}function Ix(l,c,h){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return h;_=_.getChildContext();for(var k in _)if(!(k in c))throw Error(s(108,P(l)||"Unknown",k));return a({},h,_)}function wu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Za,Ys=an.current,St(an,l),St(On,On.current),!0}function Dx(l,c,h){var _=l.stateNode;if(!_)throw Error(s(169));h?(l=Ix(l,c,Ys),_.__reactInternalMemoizedMergedChildContext=l,Bt(On),Bt(an),St(an,l)):Bt(On),St(On,h)}var Ri=Math.clz32?Math.clz32:vw,mw=Math.log,xw=Math.LN2;function vw(l){return l>>>=0,l===0?32:31-(mw(l)/xw|0)|0}var ku=64,Eu=4194304;function mc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Cu(l,c){var h=l.pendingLanes;if(h===0)return 0;var _=0,k=l.suspendedLanes,R=l.pingedLanes,j=h&268435455;if(j!==0){var Z=j&~k;Z!==0?_=mc(Z):(R&=j,R!==0&&(_=mc(R)))}else j=h&~k,j!==0?_=mc(j):R!==0&&(_=mc(R));if(_===0)return 0;if(c!==0&&c!==_&&!(c&k)&&(k=_&-_,R=c&-c,k>=R||k===16&&(R&4194240)!==0))return c;if(_&4&&(_|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)h=31-Ri(c),k=1<<h,_|=l[h],c&=~k;return _}function yw(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _w(l,c){for(var h=l.suspendedLanes,_=l.pingedLanes,k=l.expirationTimes,R=l.pendingLanes;0<R;){var j=31-Ri(R),Z=1<<j,fe=k[j];fe===-1?(!(Z&h)||Z&_)&&(k[j]=yw(Z,c)):fe<=c&&(l.expiredLanes|=Z),R&=~Z}}function m1(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Ox(){var l=ku;return ku<<=1,!(ku&4194240)&&(ku=64),l}function x1(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function xc(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Ri(c),l[c]=h}function Sw(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<h;){var k=31-Ri(h),R=1<<k;c[k]=0,_[k]=-1,l[k]=-1,h&=~R}}function v1(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var _=31-Ri(h),k=1<<_;k&c|l[_]&c&&(l[_]|=c),h&=~k}}var Rt=0;function Lx(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var y1=i.unstable_scheduleCallback,Mx=i.unstable_cancelCallback,ww=i.unstable_shouldYield,kw=i.unstable_requestPaint,Mr=i.unstable_now,_1=i.unstable_ImmediatePriority,Ew=i.unstable_UserBlockingPriority,S1=i.unstable_NormalPriority,Cw=i.unstable_IdlePriority,Tu=null,ea=null;function Tw(l){if(ea&&typeof ea.onCommitFiberRoot=="function")try{ea.onCommitFiberRoot(Tu,l,void 0,(l.current.flags&128)===128)}catch{}}function Aw(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var bi=typeof Object.is=="function"?Object.is:Aw,Sa=null,Au=!1,w1=!1;function Bx(l){Sa===null?Sa=[l]:Sa.push(l)}function Pw(l){Au=!0,Bx(l)}function ta(){if(!w1&&Sa!==null){w1=!0;var l=0,c=Rt;try{var h=Sa;for(Rt=1;l<h.length;l++){var _=h[l];do _=_(!0);while(_!==null)}Sa=null,Au=!1}catch(k){throw Sa!==null&&(Sa=Sa.slice(l+1)),y1(_1,ta),k}finally{Rt=c,w1=!1}}return null}var Qo=[],qo=0,Pu=null,Fu=0,li=[],ci=0,Qs=null,wa=1,ka="";function qs(l,c){Qo[qo++]=Fu,Qo[qo++]=Pu,Pu=l,Fu=c}function jx(l,c,h){li[ci++]=wa,li[ci++]=ka,li[ci++]=Qs,Qs=l;var _=wa;l=ka;var k=32-Ri(_)-1;_&=~(1<<k),h+=1;var R=32-Ri(c)+k;if(30<R){var j=k-k%5;R=(_&(1<<j)-1).toString(32),_>>=j,k-=j,wa=1<<32-Ri(c)+k|h<<k|_,ka=R+l}else wa=1<<R|h<<k|_,ka=l}function k1(l){l.return!==null&&(qs(l,1),jx(l,1,0))}function E1(l){for(;l===Pu;)Pu=Qo[--qo],Qo[qo]=null,Fu=Qo[--qo],Qo[qo]=null;for(;l===Qs;)Qs=li[--ci],li[ci]=null,ka=li[--ci],li[ci]=null,wa=li[--ci],li[ci]=null}var Kn=null,ui=null,qt=!1,vc=!1,Ii=null;function Ux(l,c){var h=gi(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function zx(l,c){switch(l.tag){case 5:return c=Xo(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Kn=l,ui=B(c),!0):!1;case 6:return c=Ko(c,l.pendingProps),c!==null?(l.stateNode=c,Kn=l,ui=null,!0):!1;case 13:if(c=pc(c),c!==null){var h=Qs!==null?{id:wa,overflow:ka}:null;return l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=gi(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Kn=l,ui=null,!0}return!1;default:return!1}}function C1(l){return(l.mode&1)!==0&&(l.flags&128)===0}function T1(l){if(qt){var c=ui;if(c){var h=c;if(!zx(l,c)){if(C1(l))throw Error(s(418));c=V(h);var _=Kn;c&&zx(l,c)?Ux(_,h):(l.flags=l.flags&-4097|2,qt=!1,Kn=l)}}else{if(C1(l))throw Error(s(418));l.flags=l.flags&-4097|2,qt=!1,Kn=l}}}function Vx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Kn=l}function Nu(l){if(!tt||l!==Kn)return!1;if(!qt)return Vx(l),qt=!0,!1;if(l.tag!==3&&(l.tag!==5||He(l.type)&&!Y(l.type,l.memoizedProps))){var c=ui;if(c){if(C1(l))throw Gx(),Error(s(418));for(;c;)Ux(l,c),c=V(c)}}if(Vx(l),l.tag===13){if(!tt)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));ui=ne(l)}else ui=Kn?V(l.stateNode):null;return!0}function Gx(){for(var l=ui;l;)l=V(l)}function Jo(){tt&&(ui=Kn=null,vc=qt=!1)}function A1(l){Ii===null?Ii=[l]:Ii.push(l)}var Fw=o.ReactCurrentBatchConfig;function Ru(l,c){if(bi(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),_=Object.keys(c);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var k=h[_];if(!Ks.call(c,k)||!bi(l[k],c[k]))return!1}return!0}function Nw(l){switch(l.tag){case 5:return Mt(l.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return l=vr(l.type,!1),l;case 11:return l=vr(l.type.render,!1),l;case 1:return l=vr(l.type,!0),l;default:return""}}function yc(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var _=h.stateNode}if(!_)throw Error(s(147,l));var k=_,R=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===R?c.ref:(c=function(j){var Z=k.refs;j===null?delete Z[R]:Z[R]=j},c._stringRef=R,c)}if(typeof l!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,l))}return l}function bu(l,c){throw l=Object.prototype.toString.call(c),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Hx(l){var c=l._init;return c(l._payload)}function Wx(l){function c(ce,ee){if(l){var ge=ce.deletions;ge===null?(ce.deletions=[ee],ce.flags|=16):ge.push(ee)}}function h(ce,ee){if(!l)return null;for(;ee!==null;)c(ce,ee),ee=ee.sibling;return null}function _(ce,ee){for(ce=new Map;ee!==null;)ee.key!==null?ce.set(ee.key,ee):ce.set(ee.index,ee),ee=ee.sibling;return ce}function k(ce,ee){return ce=ss(ce,ee),ce.index=0,ce.sibling=null,ce}function R(ce,ee,ge){return ce.index=ge,l?(ge=ce.alternate,ge!==null?(ge=ge.index,ge<ee?(ce.flags|=2,ee):ge):(ce.flags|=2,ee)):(ce.flags|=1048576,ee)}function j(ce){return l&&ce.alternate===null&&(ce.flags|=2),ce}function Z(ce,ee,ge,ze){return ee===null||ee.tag!==6?(ee=wp(ge,ce.mode,ze),ee.return=ce,ee):(ee=k(ee,ge),ee.return=ce,ee)}function fe(ce,ee,ge,ze){var rt=ge.type;return rt===d?Ke(ce,ee,ge.props.children,ze,ge.key):ee!==null&&(ee.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===x&&Hx(rt)===ee.type)?(ze=k(ee,ge.props),ze.ref=yc(ce,ee,ge),ze.return=ce,ze):(ze=uf(ge.type,ge.key,ge.props,null,ce.mode,ze),ze.ref=yc(ce,ee,ge),ze.return=ce,ze)}function Le(ce,ee,ge,ze){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ge.containerInfo||ee.stateNode.implementation!==ge.implementation?(ee=kp(ge,ce.mode,ze),ee.return=ce,ee):(ee=k(ee,ge.children||[]),ee.return=ce,ee)}function Ke(ce,ee,ge,ze,rt){return ee===null||ee.tag!==7?(ee=io(ge,ce.mode,ze,rt),ee.return=ce,ee):(ee=k(ee,ge),ee.return=ce,ee)}function ft(ce,ee,ge){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=wp(""+ee,ce.mode,ge),ee.return=ce,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case u:return ge=uf(ee.type,ee.key,ee.props,null,ce.mode,ge),ge.ref=yc(ce,null,ee),ge.return=ce,ge;case f:return ee=kp(ee,ce.mode,ge),ee.return=ce,ee;case x:var ze=ee._init;return ft(ce,ze(ee._payload),ge)}if(re(ee)||F(ee))return ee=io(ee,ce.mode,ge,null),ee.return=ce,ee;bu(ce,ee)}return null}function Ue(ce,ee,ge,ze){var rt=ee!==null?ee.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return rt!==null?null:Z(ce,ee,""+ge,ze);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:return ge.key===rt?fe(ce,ee,ge,ze):null;case f:return ge.key===rt?Le(ce,ee,ge,ze):null;case x:return rt=ge._init,Ue(ce,ee,rt(ge._payload),ze)}if(re(ge)||F(ge))return rt!==null?null:Ke(ce,ee,ge,ze,null);bu(ce,ge)}return null}function Kt(ce,ee,ge,ze,rt){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ce=ce.get(ge)||null,Z(ee,ce,""+ze,rt);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case u:return ce=ce.get(ze.key===null?ge:ze.key)||null,fe(ee,ce,ze,rt);case f:return ce=ce.get(ze.key===null?ge:ze.key)||null,Le(ee,ce,ze,rt);case x:var pt=ze._init;return Kt(ce,ee,ge,pt(ze._payload),rt)}if(re(ze)||F(ze))return ce=ce.get(ge)||null,Ke(ee,ce,ze,rt,null);bu(ee,ze)}return null}function Gt(ce,ee,ge,ze){for(var rt=null,pt=null,dt=ee,bt=ee=0,Ur=null;dt!==null&&bt<ge.length;bt++){dt.index>bt?(Ur=dt,dt=null):Ur=dt.sibling;var It=Ue(ce,dt,ge[bt],ze);if(It===null){dt===null&&(dt=Ur);break}l&&dt&&It.alternate===null&&c(ce,dt),ee=R(It,ee,bt),pt===null?rt=It:pt.sibling=It,pt=It,dt=Ur}if(bt===ge.length)return h(ce,dt),qt&&qs(ce,bt),rt;if(dt===null){for(;bt<ge.length;bt++)dt=ft(ce,ge[bt],ze),dt!==null&&(ee=R(dt,ee,bt),pt===null?rt=dt:pt.sibling=dt,pt=dt);return qt&&qs(ce,bt),rt}for(dt=_(ce,dt);bt<ge.length;bt++)Ur=Kt(dt,ce,bt,ge[bt],ze),Ur!==null&&(l&&Ur.alternate!==null&&dt.delete(Ur.key===null?bt:Ur.key),ee=R(Ur,ee,bt),pt===null?rt=Ur:pt.sibling=Ur,pt=Ur);return l&&dt.forEach(function(os){return c(ce,os)}),qt&&qs(ce,bt),rt}function Un(ce,ee,ge,ze){var rt=F(ge);if(typeof rt!="function")throw Error(s(150));if(ge=rt.call(ge),ge==null)throw Error(s(151));for(var pt=rt=null,dt=ee,bt=ee=0,Ur=null,It=ge.next();dt!==null&&!It.done;bt++,It=ge.next()){dt.index>bt?(Ur=dt,dt=null):Ur=dt.sibling;var os=Ue(ce,dt,It.value,ze);if(os===null){dt===null&&(dt=Ur);break}l&&dt&&os.alternate===null&&c(ce,dt),ee=R(os,ee,bt),pt===null?rt=os:pt.sibling=os,pt=os,dt=Ur}if(It.done)return h(ce,dt),qt&&qs(ce,bt),rt;if(dt===null){for(;!It.done;bt++,It=ge.next())It=ft(ce,It.value,ze),It!==null&&(ee=R(It,ee,bt),pt===null?rt=It:pt.sibling=It,pt=It);return qt&&qs(ce,bt),rt}for(dt=_(ce,dt);!It.done;bt++,It=ge.next())It=Kt(dt,ce,bt,It.value,ze),It!==null&&(l&&It.alternate!==null&&dt.delete(It.key===null?bt:It.key),ee=R(It,ee,bt),pt===null?rt=It:pt.sibling=It,pt=It);return l&&dt.forEach(function(sk){return c(ce,sk)}),qt&&qs(ce,bt),rt}function Aa(ce,ee,ge,ze){if(typeof ge=="object"&&ge!==null&&ge.type===d&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:e:{for(var rt=ge.key,pt=ee;pt!==null;){if(pt.key===rt){if(rt=ge.type,rt===d){if(pt.tag===7){h(ce,pt.sibling),ee=k(pt,ge.props.children),ee.return=ce,ce=ee;break e}}else if(pt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===x&&Hx(rt)===pt.type){h(ce,pt.sibling),ee=k(pt,ge.props),ee.ref=yc(ce,pt,ge),ee.return=ce,ce=ee;break e}h(ce,pt);break}else c(ce,pt);pt=pt.sibling}ge.type===d?(ee=io(ge.props.children,ce.mode,ze,ge.key),ee.return=ce,ce=ee):(ze=uf(ge.type,ge.key,ge.props,null,ce.mode,ze),ze.ref=yc(ce,ee,ge),ze.return=ce,ce=ze)}return j(ce);case f:e:{for(pt=ge.key;ee!==null;){if(ee.key===pt)if(ee.tag===4&&ee.stateNode.containerInfo===ge.containerInfo&&ee.stateNode.implementation===ge.implementation){h(ce,ee.sibling),ee=k(ee,ge.children||[]),ee.return=ce,ce=ee;break e}else{h(ce,ee);break}else c(ce,ee);ee=ee.sibling}ee=kp(ge,ce.mode,ze),ee.return=ce,ce=ee}return j(ce);case x:return pt=ge._init,Aa(ce,ee,pt(ge._payload),ze)}if(re(ge))return Gt(ce,ee,ge,ze);if(F(ge))return Un(ce,ee,ge,ze);bu(ce,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ee!==null&&ee.tag===6?(h(ce,ee.sibling),ee=k(ee,ge),ee.return=ce,ce=ee):(h(ce,ee),ee=wp(ge,ce.mode,ze),ee.return=ce,ce=ee),j(ce)):h(ce,ee)}return Aa}var Zo=Wx(!0),$x=Wx(!1),Iu=nn(null),Du=null,el=null,P1=null;function F1(){P1=el=Du=null}function Xx(l,c,h){xe?(St(Iu,c._currentValue),c._currentValue=h):(St(Iu,c._currentValue2),c._currentValue2=h)}function N1(l){var c=Iu.current;Bt(Iu),xe?l._currentValue=c:l._currentValue2=c}function R1(l,c,h){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===h)break;l=l.return}}function tl(l,c){Du=l,P1=el=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(Mn=!0),l.firstContext=null)}function fi(l){var c=xe?l._currentValue:l._currentValue2;if(P1!==l)if(l={context:l,memoizedValue:c,next:null},el===null){if(Du===null)throw Error(s(308));el=l,Du.dependencies={lanes:0,firstContext:l}}else el=el.next=l;return c}var Js=null;function b1(l){Js===null?Js=[l]:Js.push(l)}function Kx(l,c,h,_){var k=c.interleaved;return k===null?(h.next=h,b1(c)):(h.next=k.next,k.next=h),c.interleaved=h,ra(l,_)}function ra(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var es=!1;function I1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ea(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function ts(l,c,h){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,vt&2){var k=_.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),_.pending=c,ra(l,h)}return k=_.interleaved,k===null?(c.next=c,b1(_)):(c.next=k.next,k.next=c),_.interleaved=c,ra(l,h)}function Ou(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,v1(l,h)}}function Qx(l,c){var h=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var k=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var j={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};R===null?k=R=j:R=R.next=j,h=h.next}while(h!==null);R===null?k=R=c:R=R.next=c}else k=R=c;h={baseState:_.baseState,firstBaseUpdate:k,lastBaseUpdate:R,shared:_.shared,effects:_.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function Lu(l,c,h,_){var k=l.updateQueue;es=!1;var R=k.firstBaseUpdate,j=k.lastBaseUpdate,Z=k.shared.pending;if(Z!==null){k.shared.pending=null;var fe=Z,Le=fe.next;fe.next=null,j===null?R=Le:j.next=Le,j=fe;var Ke=l.alternate;Ke!==null&&(Ke=Ke.updateQueue,Z=Ke.lastBaseUpdate,Z!==j&&(Z===null?Ke.firstBaseUpdate=Le:Z.next=Le,Ke.lastBaseUpdate=fe))}if(R!==null){var ft=k.baseState;j=0,Ke=Le=fe=null,Z=R;do{var Ue=Z.lane,Kt=Z.eventTime;if((_&Ue)===Ue){Ke!==null&&(Ke=Ke.next={eventTime:Kt,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var Gt=l,Un=Z;switch(Ue=c,Kt=h,Un.tag){case 1:if(Gt=Un.payload,typeof Gt=="function"){ft=Gt.call(Kt,ft,Ue);break e}ft=Gt;break e;case 3:Gt.flags=Gt.flags&-65537|128;case 0:if(Gt=Un.payload,Ue=typeof Gt=="function"?Gt.call(Kt,ft,Ue):Gt,Ue==null)break e;ft=a({},ft,Ue);break e;case 2:es=!0}}Z.callback!==null&&Z.lane!==0&&(l.flags|=64,Ue=k.effects,Ue===null?k.effects=[Z]:Ue.push(Z))}else Kt={eventTime:Kt,lane:Ue,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ke===null?(Le=Ke=Kt,fe=ft):Ke=Ke.next=Kt,j|=Ue;if(Z=Z.next,Z===null){if(Z=k.shared.pending,Z===null)break;Ue=Z,Z=Ue.next,Ue.next=null,k.lastBaseUpdate=Ue,k.shared.pending=null}}while(1);if(Ke===null&&(fe=ft),k.baseState=fe,k.firstBaseUpdate=Le,k.lastBaseUpdate=Ke,c=k.shared.interleaved,c!==null){k=c;do j|=k.lane,k=k.next;while(k!==c)}else R===null&&(k.shared.lanes=0);eo|=j,l.lanes=j,l.memoizedState=ft}}function qx(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],k=_.callback;if(k!==null){if(_.callback=null,_=h,typeof k!="function")throw Error(s(191,k));k.call(_)}}}var _c={},di=nn(_c),Sc=nn(_c),rl=nn(_c);function na(l){if(l===_c)throw Error(s(174));return l}function D1(l,c){St(rl,c),St(Sc,l),St(di,_c),l=we(c),Bt(di),St(di,l)}function nl(){Bt(di),Bt(Sc),Bt(rl)}function Jx(l){var c=na(rl.current),h=na(di.current);c=oe(h,l.type,c),h!==c&&(St(Sc,l),St(di,c))}function O1(l){Sc.current===l&&(Bt(di),Bt(Sc))}var rr=nn(0);function Mu(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||_u(h)||gc(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var L1=[];function M1(){for(var l=0;l<L1.length;l++){var c=L1[l];xe?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}L1.length=0}var Bu=o.ReactCurrentDispatcher,B1=o.ReactCurrentBatchConfig,Zs=0,nr=null,Cr=null,Br=null,ju=!1,wc=!1,kc=0,Rw=0;function sn(){throw Error(s(321))}function j1(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!bi(l[h],c[h]))return!1;return!0}function U1(l,c,h,_,k,R){if(Zs=R,nr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Bu.current=l===null||l.memoizedState===null?Ow:Lw,l=h(_,k),wc){R=0;do{if(wc=!1,kc=0,25<=R)throw Error(s(301));R+=1,Br=Cr=null,c.updateQueue=null,Bu.current=Mw,l=h(_,k)}while(wc)}if(Bu.current=Vu,c=Cr!==null&&Cr.next!==null,Zs=0,Br=Cr=nr=null,ju=!1,c)throw Error(s(300));return l}function z1(){var l=kc!==0;return kc=0,l}function ia(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?nr.memoizedState=Br=l:Br=Br.next=l,Br}function hi(){if(Cr===null){var l=nr.alternate;l=l!==null?l.memoizedState:null}else l=Cr.next;var c=Br===null?nr.memoizedState:Br.next;if(c!==null)Br=c,Cr=l;else{if(l===null)throw Error(s(310));Cr=l,l={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Br===null?nr.memoizedState=Br=l:Br=Br.next=l}return Br}function Ec(l,c){return typeof c=="function"?c(l):c}function V1(l){var c=hi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=Cr,k=_.baseQueue,R=h.pending;if(R!==null){if(k!==null){var j=k.next;k.next=R.next,R.next=j}_.baseQueue=k=R,h.pending=null}if(k!==null){R=k.next,_=_.baseState;var Z=j=null,fe=null,Le=R;do{var Ke=Le.lane;if((Zs&Ke)===Ke)fe!==null&&(fe=fe.next={lane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),_=Le.hasEagerState?Le.eagerState:l(_,Le.action);else{var ft={lane:Ke,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null};fe===null?(Z=fe=ft,j=_):fe=fe.next=ft,nr.lanes|=Ke,eo|=Ke}Le=Le.next}while(Le!==null&&Le!==R);fe===null?j=_:fe.next=Z,bi(_,c.memoizedState)||(Mn=!0),c.memoizedState=_,c.baseState=j,c.baseQueue=fe,h.lastRenderedState=_}if(l=h.interleaved,l!==null){k=l;do R=k.lane,nr.lanes|=R,eo|=R,k=k.next;while(k!==l)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function G1(l){var c=hi(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=h.dispatch,k=h.pending,R=c.memoizedState;if(k!==null){h.pending=null;var j=k=k.next;do R=l(R,j.action),j=j.next;while(j!==k);bi(R,c.memoizedState)||(Mn=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),h.lastRenderedState=R}return[R,_]}function Zx(){}function ev(l,c){var h=nr,_=hi(),k=c(),R=!bi(_.memoizedState,k);if(R&&(_.memoizedState=k,Mn=!0),_=_.queue,H1(nv.bind(null,h,_,l),[l]),_.getSnapshot!==c||R||Br!==null&&Br.memoizedState.tag&1){if(h.flags|=2048,Cc(9,rv.bind(null,h,_,k,c),void 0,null),jr===null)throw Error(s(349));Zs&30||tv(h,c,k)}return k}function tv(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function rv(l,c,h,_){c.value=h,c.getSnapshot=_,iv(c)&&av(l)}function nv(l,c,h){return h(function(){iv(c)&&av(l)})}function iv(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!bi(l,h)}catch{return!0}}function av(l){var c=ra(l,1);c!==null&&pi(c,l,1,-1)}function sv(l){var c=ia();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ec,lastRenderedState:l},c.queue=l,l=l.dispatch=Dw.bind(null,nr,l),[c.memoizedState,l]}function Cc(l,c,h,_){return l={tag:l,create:c,destroy:h,deps:_,next:null},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(_=h.next,h.next=l,l.next=_,c.lastEffect=l)),l}function ov(){return hi().memoizedState}function Uu(l,c,h,_){var k=ia();nr.flags|=l,k.memoizedState=Cc(1|c,h,void 0,_===void 0?null:_)}function zu(l,c,h,_){var k=hi();_=_===void 0?null:_;var R=void 0;if(Cr!==null){var j=Cr.memoizedState;if(R=j.destroy,_!==null&&j1(_,j.deps)){k.memoizedState=Cc(c,h,R,_);return}}nr.flags|=l,k.memoizedState=Cc(1|c,h,R,_)}function lv(l,c){return Uu(8390656,8,l,c)}function H1(l,c){return zu(2048,8,l,c)}function cv(l,c){return zu(4,2,l,c)}function uv(l,c){return zu(4,4,l,c)}function fv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function dv(l,c,h){return h=h!=null?h.concat([l]):null,zu(4,4,fv.bind(null,c,l),h)}function W1(){}function hv(l,c){var h=hi();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&j1(c,_[1])?_[0]:(h.memoizedState=[l,c],l)}function pv(l,c){var h=hi();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&j1(c,_[1])?_[0]:(l=l(),h.memoizedState=[l,c],l)}function gv(l,c,h){return Zs&21?(bi(h,c)||(h=Ox(),nr.lanes|=h,eo|=h,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,Mn=!0),l.memoizedState=h)}function bw(l,c){var h=Rt;Rt=h!==0&&4>h?h:4,l(!0);var _=B1.transition;B1.transition={};try{l(!1),c()}finally{Rt=h,B1.transition=_}}function mv(){return hi().memoizedState}function Iw(l,c,h){var _=is(l);if(h={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null},xv(l))vv(c,h);else if(h=Kx(l,c,h,_),h!==null){var k=cn();pi(h,l,_,k),yv(h,c,_)}}function Dw(l,c,h){var _=is(l),k={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null};if(xv(l))vv(c,k);else{var R=l.alternate;if(l.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var j=c.lastRenderedState,Z=R(j,h);if(k.hasEagerState=!0,k.eagerState=Z,bi(Z,j)){var fe=c.interleaved;fe===null?(k.next=k,b1(c)):(k.next=fe.next,fe.next=k),c.interleaved=k;return}}catch{}finally{}h=Kx(l,c,k,_),h!==null&&(k=cn(),pi(h,l,_,k),yv(h,c,_))}}function xv(l){var c=l.alternate;return l===nr||c!==null&&c===nr}function vv(l,c){wc=ju=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function yv(l,c,h){if(h&4194240){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,v1(l,h)}}var Vu={readContext:fi,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},Ow={readContext:fi,useCallback:function(l,c){return ia().memoizedState=[l,c===void 0?null:c],l},useContext:fi,useEffect:lv,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,Uu(4194308,4,fv.bind(null,c,l),h)},useLayoutEffect:function(l,c){return Uu(4194308,4,l,c)},useInsertionEffect:function(l,c){return Uu(4,2,l,c)},useMemo:function(l,c){var h=ia();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var _=ia();return c=h!==void 0?h(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=Iw.bind(null,nr,l),[_.memoizedState,l]},useRef:function(l){var c=ia();return l={current:l},c.memoizedState=l},useState:sv,useDebugValue:W1,useDeferredValue:function(l){return ia().memoizedState=l},useTransition:function(){var l=sv(!1),c=l[0];return l=bw.bind(null,l[1]),ia().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var _=nr,k=ia();if(qt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=c(),jr===null)throw Error(s(349));Zs&30||tv(_,c,h)}k.memoizedState=h;var R={value:h,getSnapshot:c};return k.queue=R,lv(nv.bind(null,_,R,l),[l]),_.flags|=2048,Cc(9,rv.bind(null,_,R,h,c),void 0,null),h},useId:function(){var l=ia(),c=jr.identifierPrefix;if(qt){var h=ka,_=wa;h=(_&~(1<<32-Ri(_)-1)).toString(32)+h,c=":"+c+"R"+h,h=kc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=Rw++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},Lw={readContext:fi,useCallback:hv,useContext:fi,useEffect:H1,useImperativeHandle:dv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:pv,useReducer:V1,useRef:ov,useState:function(){return V1(Ec)},useDebugValue:W1,useDeferredValue:function(l){var c=hi();return gv(c,Cr.memoizedState,l)},useTransition:function(){var l=V1(Ec)[0],c=hi().memoizedState;return[l,c]},useMutableSource:Zx,useSyncExternalStore:ev,useId:mv,unstable_isNewReconciler:!1},Mw={readContext:fi,useCallback:hv,useContext:fi,useEffect:H1,useImperativeHandle:dv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:pv,useReducer:G1,useRef:ov,useState:function(){return G1(Ec)},useDebugValue:W1,useDeferredValue:function(l){var c=hi();return Cr===null?c.memoizedState=l:gv(c,Cr.memoizedState,l)},useTransition:function(){var l=G1(Ec)[0],c=hi().memoizedState;return[l,c]},useMutableSource:Zx,useSyncExternalStore:ev,useId:mv,unstable_isNewReconciler:!1};function Di(l,c){if(l&&l.defaultProps){c=a({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function $1(l,c,h,_){c=l.memoizedState,h=h(_,c),h=h==null?c:a({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var Gu={isMounted:function(l){return(l=l._reactInternals)?I(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var _=cn(),k=is(l),R=Ea(_,k);R.payload=c,h!=null&&(R.callback=h),c=ts(l,R,k),c!==null&&(pi(c,l,k,_),Ou(c,l,k))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var _=cn(),k=is(l),R=Ea(_,k);R.tag=1,R.payload=c,h!=null&&(R.callback=h),c=ts(l,R,k),c!==null&&(pi(c,l,k,_),Ou(c,l,k))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=cn(),_=is(l),k=Ea(h,_);k.tag=2,c!=null&&(k.callback=c),c=ts(l,k,_),c!==null&&(pi(c,l,_,h),Ou(c,l,_))}};function _v(l,c,h,_,k,R,j){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,R,j):c.prototype&&c.prototype.isPureReactComponent?!Ru(h,_)||!Ru(k,R):!0}function Sv(l,c,h){var _=!1,k=Za,R=c.contextType;return typeof R=="object"&&R!==null?R=fi(R):(k=Ln(c)?Ys:an.current,_=c.contextTypes,R=(_=_!=null)?Yo(l,k):Za),c=new c(h,R),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Gu,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=k,l.__reactInternalMemoizedMaskedChildContext=R),c}function wv(l,c,h,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,_),c.state!==l&&Gu.enqueueReplaceState(c,c.state,null)}function X1(l,c,h,_){var k=l.stateNode;k.props=h,k.state=l.memoizedState,k.refs={},I1(l);var R=c.contextType;typeof R=="object"&&R!==null?k.context=fi(R):(R=Ln(c)?Ys:an.current,k.context=Yo(l,R)),k.state=l.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&($1(l,c,R,h),k.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&Gu.enqueueReplaceState(k,k.state,null),Lu(l,h,k,_),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308)}function il(l,c){try{var h="",_=c;do h+=Nw(_),_=_.return;while(_);var k=h}catch(R){k=`
Error generating stack: `+R.message+`
`+R.stack}return{value:l,source:c,stack:k,digest:null}}function K1(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function Y1(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var Bw=typeof WeakMap=="function"?WeakMap:Map;function kv(l,c,h){h=Ea(-1,h),h.tag=3,h.payload={element:null};var _=c.value;return h.callback=function(){nf||(nf=!0,gp=_),Y1(l,c)},h}function Ev(l,c,h){h=Ea(-1,h),h.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var k=c.value;h.payload=function(){return _(k)},h.callback=function(){Y1(l,c)}}var R=l.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(h.callback=function(){Y1(l,c),typeof _!="function"&&(rs===null?rs=new Set([this]):rs.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})}),h}function Cv(l,c,h){var _=l.pingCache;if(_===null){_=l.pingCache=new Bw;var k=new Set;_.set(c,k)}else k=_.get(c),k===void 0&&(k=new Set,_.set(c,k));k.has(h)||(k.add(h),l=Jw.bind(null,l,c,h),c.then(l,l))}function Tv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Av(l,c,h,_,k){return l.mode&1?(l.flags|=65536,l.lanes=k,l):(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Ea(-1,1),c.tag=2,ts(h,c,1))),h.lanes|=1),l)}var jw=o.ReactCurrentOwner,Mn=!1;function En(l,c,h,_){c.child=l===null?$x(c,null,h,_):Zo(c,l.child,h,_)}function Pv(l,c,h,_,k){h=h.render;var R=c.ref;return tl(c,k),_=U1(l,c,h,_,R,k),h=z1(),l!==null&&!Mn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Ca(l,c,k)):(qt&&h&&k1(c),c.flags|=1,En(l,c,_,k),c.child)}function Fv(l,c,h,_,k){if(l===null){var R=h.type;return typeof R=="function"&&!Sp(R)&&R.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=R,Nv(l,c,R,_,k)):(l=uf(h.type,null,_,c,c.mode,k),l.ref=c.ref,l.return=c,c.child=l)}if(R=l.child,!(l.lanes&k)){var j=R.memoizedProps;if(h=h.compare,h=h!==null?h:Ru,h(j,_)&&l.ref===c.ref)return Ca(l,c,k)}return c.flags|=1,l=ss(R,_),l.ref=c.ref,l.return=c,c.child=l}function Nv(l,c,h,_,k){if(l!==null){var R=l.memoizedProps;if(Ru(R,_)&&l.ref===c.ref)if(Mn=!1,c.pendingProps=_=R,(l.lanes&k)!==0)l.flags&131072&&(Mn=!0);else return c.lanes=l.lanes,Ca(l,c,k)}return Q1(l,c,h,_,k)}function Rv(l,c,h){var _=c.pendingProps,k=_.children,R=l!==null?l.memoizedState:null;if(_.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(sl,Yn),Yn|=h;else{if(!(h&1073741824))return l=R!==null?R.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,St(sl,Yn),Yn|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=R!==null?R.baseLanes:h,St(sl,Yn),Yn|=_}else R!==null?(_=R.baseLanes|h,c.memoizedState=null):_=h,St(sl,Yn),Yn|=_;return En(l,c,k,h),c.child}function bv(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function Q1(l,c,h,_,k){var R=Ln(h)?Ys:an.current;return R=Yo(c,R),tl(c,k),h=U1(l,c,h,_,R,k),_=z1(),l!==null&&!Mn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Ca(l,c,k)):(qt&&_&&k1(c),c.flags|=1,En(l,c,h,k),c.child)}function Iv(l,c,h,_,k){if(Ln(h)){var R=!0;wu(c)}else R=!1;if(tl(c,k),c.stateNode===null)Wu(l,c),Sv(c,h,_),X1(c,h,_,k),_=!0;else if(l===null){var j=c.stateNode,Z=c.memoizedProps;j.props=Z;var fe=j.context,Le=h.contextType;typeof Le=="object"&&Le!==null?Le=fi(Le):(Le=Ln(h)?Ys:an.current,Le=Yo(c,Le));var Ke=h.getDerivedStateFromProps,ft=typeof Ke=="function"||typeof j.getSnapshotBeforeUpdate=="function";ft||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(Z!==_||fe!==Le)&&wv(c,j,_,Le),es=!1;var Ue=c.memoizedState;j.state=Ue,Lu(c,_,j,k),fe=c.memoizedState,Z!==_||Ue!==fe||On.current||es?(typeof Ke=="function"&&($1(c,h,Ke,_),fe=c.memoizedState),(Z=es||_v(c,h,Z,_,Ue,fe,Le))?(ft||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(c.flags|=4194308)):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=fe),j.props=_,j.state=fe,j.context=Le,_=Z):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{j=c.stateNode,Yx(l,c),Z=c.memoizedProps,Le=c.type===c.elementType?Z:Di(c.type,Z),j.props=Le,ft=c.pendingProps,Ue=j.context,fe=h.contextType,typeof fe=="object"&&fe!==null?fe=fi(fe):(fe=Ln(h)?Ys:an.current,fe=Yo(c,fe));var Kt=h.getDerivedStateFromProps;(Ke=typeof Kt=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(Z!==ft||Ue!==fe)&&wv(c,j,_,fe),es=!1,Ue=c.memoizedState,j.state=Ue,Lu(c,_,j,k);var Gt=c.memoizedState;Z!==ft||Ue!==Gt||On.current||es?(typeof Kt=="function"&&($1(c,h,Kt,_),Gt=c.memoizedState),(Le=es||_v(c,h,Le,_,Ue,Gt,fe)||!1)?(Ke||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(_,Gt,fe),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(_,Gt,fe)),typeof j.componentDidUpdate=="function"&&(c.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof j.componentDidUpdate!="function"||Z===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||Z===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=Gt),j.props=_,j.state=Gt,j.context=fe,_=Le):(typeof j.componentDidUpdate!="function"||Z===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||Z===l.memoizedProps&&Ue===l.memoizedState||(c.flags|=1024),_=!1)}return q1(l,c,h,_,R,k)}function q1(l,c,h,_,k,R){bv(l,c);var j=(c.flags&128)!==0;if(!_&&!j)return k&&Dx(c,h,!1),Ca(l,c,R);_=c.stateNode,jw.current=c;var Z=j&&typeof h.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&j?(c.child=Zo(c,l.child,null,R),c.child=Zo(c,null,Z,R)):En(l,c,Z,R),c.memoizedState=_.state,k&&Dx(c,h,!0),c.child}function Dv(l){var c=l.stateNode;c.pendingContext?bx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&bx(l,c.context,!1),D1(l,c.containerInfo)}function Ov(l,c,h,_,k){return Jo(),A1(k),c.flags|=256,En(l,c,h,_),c.child}var J1={dehydrated:null,treeContext:null,retryLane:0};function Z1(l){return{baseLanes:l,cachePool:null,transitions:null}}function Lv(l,c,h){var _=c.pendingProps,k=rr.current,R=!1,j=(c.flags&128)!==0,Z;if((Z=j)||(Z=l!==null&&l.memoizedState===null?!1:(k&2)!==0),Z?(R=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(k|=1),St(rr,k&1),l===null)return T1(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?gc(l)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(j=_.children,l=_.fallback,R?(_=c.mode,R=c.child,j={mode:"hidden",children:j},!(_&1)&&R!==null?(R.childLanes=0,R.pendingProps=j):R=ff(j,_,0,null),l=io(l,_,h,null),R.return=c,l.return=c,R.sibling=l,c.child=R,c.child.memoizedState=Z1(h),c.memoizedState=J1,l):ep(c,j));if(k=l.memoizedState,k!==null&&(Z=k.dehydrated,Z!==null))return Uw(l,c,j,_,Z,k,h);if(R){R=_.fallback,j=c.mode,k=l.child,Z=k.sibling;var fe={mode:"hidden",children:_.children};return!(j&1)&&c.child!==k?(_=c.child,_.childLanes=0,_.pendingProps=fe,c.deletions=null):(_=ss(k,fe),_.subtreeFlags=k.subtreeFlags&14680064),Z!==null?R=ss(Z,R):(R=io(R,j,h,null),R.flags|=2),R.return=c,_.return=c,_.sibling=R,c.child=_,_=R,R=c.child,j=l.child.memoizedState,j=j===null?Z1(h):{baseLanes:j.baseLanes|h,cachePool:null,transitions:j.transitions},R.memoizedState=j,R.childLanes=l.childLanes&~h,c.memoizedState=J1,_}return R=l.child,l=R.sibling,_=ss(R,{mode:"visible",children:_.children}),!(c.mode&1)&&(_.lanes=h),_.return=c,_.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=_,c.memoizedState=null,_}function ep(l,c){return c=ff({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Hu(l,c,h,_){return _!==null&&A1(_),Zo(c,l.child,null,h),l=ep(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function Uw(l,c,h,_,k,R,j){if(h)return c.flags&256?(c.flags&=-257,_=K1(Error(s(422))),Hu(l,c,j,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(R=_.fallback,k=c.mode,_=ff({mode:"visible",children:_.children},k,0,null),R=io(R,k,j,null),R.flags|=2,_.return=c,R.return=c,_.sibling=R,c.child=_,c.mode&1&&Zo(c,l.child,null,j),c.child.memoizedState=Z1(j),c.memoizedState=J1,R);if(!(c.mode&1))return Hu(l,c,j,null);if(gc(k))return _=g1(k).digest,R=Error(s(419)),_=K1(R,_,void 0),Hu(l,c,j,_);if(h=(j&l.childLanes)!==0,Mn||h){if(_=jr,_!==null){switch(j&-j){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=k&(_.suspendedLanes|j)?0:k,k!==0&&k!==R.retryLane&&(R.retryLane=k,ra(l,k),pi(_,l,k,-1))}return _p(),_=K1(Error(s(421))),Hu(l,c,j,_)}return _u(k)?(c.flags|=128,c.child=l.child,c=Zw.bind(null,l),D(k,c),null):(l=R.treeContext,tt&&(ui=H(k),Kn=c,qt=!0,Ii=null,vc=!1,l!==null&&(li[ci++]=wa,li[ci++]=ka,li[ci++]=Qs,wa=l.id,ka=l.overflow,Qs=c)),c=ep(c,_.children),c.flags|=4096,c)}function Mv(l,c,h){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),R1(l.return,c,h)}function tp(l,c,h,_,k){var R=l.memoizedState;R===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:k}:(R.isBackwards=c,R.rendering=null,R.renderingStartTime=0,R.last=_,R.tail=h,R.tailMode=k)}function Bv(l,c,h){var _=c.pendingProps,k=_.revealOrder,R=_.tail;if(En(l,c,_.children,h),_=rr.current,_&2)_=_&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Mv(l,h,c);else if(l.tag===19)Mv(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(St(rr,_),!(c.mode&1))c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)l=h.alternate,l!==null&&Mu(l)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),tp(c,!1,k,h,R);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(l=k.alternate,l!==null&&Mu(l)===null){c.child=k;break}l=k.sibling,k.sibling=h,h=k,k=l}tp(c,!0,h,null,R);break;case"together":tp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Wu(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Ca(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),eo|=c.lanes,!(h&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(s(153));if(c.child!==null){for(l=c.child,h=ss(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=ss(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function zw(l,c,h){switch(c.tag){case 3:Dv(c),Jo();break;case 5:Jx(c);break;case 1:Ln(c.type)&&wu(c);break;case 4:D1(c,c.stateNode.containerInfo);break;case 10:Xx(c,c.type._context,c.memoizedProps.value);break;case 13:var _=c.memoizedState;if(_!==null)return _.dehydrated!==null?(St(rr,rr.current&1),c.flags|=128,null):h&c.child.childLanes?Lv(l,c,h):(St(rr,rr.current&1),l=Ca(l,c,h),l!==null?l.sibling:null);St(rr,rr.current&1);break;case 19:if(_=(h&c.childLanes)!==0,l.flags&128){if(_)return Bv(l,c,h);c.flags|=128}var k=c.memoizedState;if(k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),St(rr,rr.current),_)break;return null;case 22:case 23:return c.lanes=0,Rv(l,c,h)}return Ca(l,c,h)}function aa(l){l.flags|=4}function jv(l,c){if(l!==null&&l.child===c.child)return!0;if(c.flags&16)return!1;for(l=c.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Tc,Ac,$u,Xu;if(Me)Tc=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)M(l,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Ac=function(){},$u=function(l,c,h,_,k){if(l=l.memoizedProps,l!==_){var R=c.stateNode,j=na(di.current);h=Q(R,h,l,_,k,j),(c.updateQueue=h)&&aa(c)}},Xu=function(l,c,h,_){h!==_&&aa(c)};else if(G){Tc=function(l,c,h,_){for(var k=c.child;k!==null;){if(k.tag===5){var R=k.stateNode;h&&_&&(R=rn(R,k.type,k.memoizedProps,k)),M(l,R)}else if(k.tag===6)R=k.stateNode,h&&_&&(R=lr(R,k.memoizedProps,k)),M(l,R);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)R=k.child,R!==null&&(R.return=k),Tc(l,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===c)break;for(;k.sibling===null;){if(k.return===null||k.return===c)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};var Uv=function(l,c,h,_){for(var k=c.child;k!==null;){if(k.tag===5){var R=k.stateNode;h&&_&&(R=rn(R,k.type,k.memoizedProps,k)),kn(l,R)}else if(k.tag===6)R=k.stateNode,h&&_&&(R=lr(R,k.memoizedProps,k)),kn(l,R);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)R=k.child,R!==null&&(R.return=k),Uv(l,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===c)break;for(;k.sibling===null;){if(k.return===null||k.return===c)return;k=k.return}k.sibling.return=k.return,k=k.sibling}};Ac=function(l,c){var h=c.stateNode;if(!jv(l,c)){l=h.containerInfo;var _=Dt(l);Uv(_,c,!1,!1),h.pendingChildren=_,aa(c),tn(l,_)}},$u=function(l,c,h,_,k){var R=l.stateNode,j=l.memoizedProps;if((l=jv(l,c))&&j===_)c.stateNode=R;else{var Z=c.stateNode,fe=na(di.current),Le=null;j!==_&&(Le=Q(Z,h,j,_,k,fe)),l&&Le===null?c.stateNode=R:(R=Pt(R,Le,h,j,_,c,l,Z),J(R,h,_,k,fe)&&aa(c),c.stateNode=R,l?aa(c):Tc(R,c,!1,!1))}},Xu=function(l,c,h,_){h!==_?(l=na(rl.current),h=na(di.current),c.stateNode=ue(_,l,h,c),aa(c)):c.stateNode=l.stateNode}}else Ac=function(){},$u=function(){},Xu=function(){};function Pc(l,c){if(!qt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function on(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,_=0;if(c)for(var k=l.child;k!==null;)h|=k.lanes|k.childLanes,_|=k.subtreeFlags&14680064,_|=k.flags&14680064,k.return=l,k=k.sibling;else for(k=l.child;k!==null;)h|=k.lanes|k.childLanes,_|=k.subtreeFlags,_|=k.flags,k.return=l,k=k.sibling;return l.subtreeFlags|=_,l.childLanes=h,c}function Vw(l,c,h){var _=c.pendingProps;switch(E1(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(c),null;case 1:return Ln(c.type)&&Su(),on(c),null;case 3:return h=c.stateNode,nl(),Bt(On),Bt(an),M1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(l===null||l.child===null)&&(Nu(c)?aa(c):l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Ii!==null&&(vp(Ii),Ii=null))),Ac(l,c),on(c),null;case 5:O1(c),h=na(rl.current);var k=c.type;if(l!==null&&c.stateNode!=null)$u(l,c,k,_,h),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(s(166));return on(c),null}if(l=na(di.current),Nu(c)){if(!tt)throw Error(s(175));l=W(c.stateNode,c.type,c.memoizedProps,h,l,c,!vc),c.updateQueue=l,l!==null&&aa(c)}else{var R=_e(k,_,h,l,c);Tc(R,c,!1,!1),c.stateNode=R,J(R,k,_,h,l)&&aa(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return on(c),null;case 6:if(l&&c.stateNode!=null)Xu(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(s(166));if(l=na(rl.current),h=na(di.current),Nu(c)){if(!tt)throw Error(s(176));if(l=c.stateNode,h=c.memoizedProps,(_=ae(l,h,c,!vc))&&(k=Kn,k!==null))switch(k.tag){case 3:Oe(k.stateNode.containerInfo,l,h,(k.mode&1)!==0);break;case 5:je(k.type,k.memoizedProps,k.stateNode,l,h,(k.mode&1)!==0)}_&&aa(c)}else c.stateNode=ue(_,l,h,c)}return on(c),null;case 13:if(Bt(rr),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(qt&&ui!==null&&c.mode&1&&!(c.flags&128))Gx(),Jo(),c.flags|=98560,k=!1;else if(k=Nu(c),_!==null&&_.dehydrated!==null){if(l===null){if(!k)throw Error(s(318));if(!tt)throw Error(s(344));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(s(317));ye(k,c)}else Jo(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;on(c),k=!1}else Ii!==null&&(vp(Ii),Ii=null),k=!0;if(!k)return c.flags&65536?c:null}return c.flags&128?(c.lanes=h,c):(h=_!==null,h!==(l!==null&&l.memoizedState!==null)&&h&&(c.child.flags|=8192,c.mode&1&&(l===null||rr.current&1?Tr===0&&(Tr=3):_p())),c.updateQueue!==null&&(c.flags|=4),on(c),null);case 4:return nl(),Ac(l,c),l===null&&Xe(c.stateNode.containerInfo),on(c),null;case 10:return N1(c.type._context),on(c),null;case 17:return Ln(c.type)&&Su(),on(c),null;case 19:if(Bt(rr),k=c.memoizedState,k===null)return on(c),null;if(_=(c.flags&128)!==0,R=k.rendering,R===null)if(_)Pc(k,!1);else{if(Tr!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(R=Mu(l),R!==null){for(c.flags|=128,Pc(k,!1),l=R.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=h,h=c.child;h!==null;)_=h,k=l,_.flags&=14680066,R=_.alternate,R===null?(_.childLanes=0,_.lanes=k,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=R.childLanes,_.lanes=R.lanes,_.child=R.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=R.memoizedProps,_.memoizedState=R.memoizedState,_.updateQueue=R.updateQueue,_.type=R.type,k=R.dependencies,_.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext}),h=h.sibling;return St(rr,rr.current&1|2),c.child}l=l.sibling}k.tail!==null&&Mr()>pp&&(c.flags|=128,_=!0,Pc(k,!1),c.lanes=4194304)}else{if(!_)if(l=Mu(R),l!==null){if(c.flags|=128,_=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Pc(k,!0),k.tail===null&&k.tailMode==="hidden"&&!R.alternate&&!qt)return on(c),null}else 2*Mr()-k.renderingStartTime>pp&&h!==1073741824&&(c.flags|=128,_=!0,Pc(k,!1),c.lanes=4194304);k.isBackwards?(R.sibling=c.child,c.child=R):(l=k.last,l!==null?l.sibling=R:c.child=R,k.last=R)}return k.tail!==null?(c=k.tail,k.rendering=c,k.tail=c.sibling,k.renderingStartTime=Mr(),c.sibling=null,l=rr.current,St(rr,_?l&1|2:l&1),c):(on(c),null);case 22:case 23:return yp(),h=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==h&&(c.flags|=8192),h&&c.mode&1?Yn&1073741824&&(on(c),Me&&c.subtreeFlags&6&&(c.flags|=8192)):on(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function Gw(l,c){switch(E1(c),c.tag){case 1:return Ln(c.type)&&Su(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return nl(),Bt(On),Bt(an),M1(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return O1(c),null;case 13:if(Bt(rr),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Jo()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Bt(rr),null;case 4:return nl(),null;case 10:return N1(c.type._context),null;case 22:case 23:return yp(),null;case 24:return null;default:return null}}var Ku=!1,ln=!1,Hw=typeof WeakSet=="function"?WeakSet:Set,We=null;function al(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(_){Jt(l,c,_)}else h.current=null}function rp(l,c,h){try{h()}catch(_){Jt(l,c,_)}}var zv=!1;function Ww(l,c){for(X(l.containerInfo),We=c;We!==null;)if(l=We,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,We=c;else for(;We!==null;){l=We;try{var h=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var _=h.memoizedProps,k=h.memoizedState,R=l.stateNode,j=R.getSnapshotBeforeUpdate(l.elementType===l.type?_:Di(l.type,_),k);R.__reactInternalSnapshotBeforeUpdate=j}break;case 3:Me&&ut(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(Z){Jt(l,l.return,Z)}if(c=l.sibling,c!==null){c.return=l.return,We=c;break}We=l.return}return h=zv,zv=!1,h}function Fc(l,c,h){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var k=_=_.next;do{if((k.tag&l)===l){var R=k.destroy;k.destroy=void 0,R!==void 0&&rp(c,h,R)}k=k.next}while(k!==_)}}function Yu(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var _=h.create;h.destroy=_()}h=h.next}while(h!==c)}}function np(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=ke(h);break;default:l=h}typeof c=="function"?c(l):c.current=l}}function Vv(l){var c=l.alternate;c!==null&&(l.alternate=null,Vv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Ie(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Gv(l){return l.tag===5||l.tag===3||l.tag===4}function Hv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Gv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function ip(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?lt(h,l,c):Ee(h,l);else if(_!==4&&(l=l.child,l!==null))for(ip(l,c,h),l=l.sibling;l!==null;)ip(l,c,h),l=l.sibling}function ap(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?et(h,l,c):q(h,l);else if(_!==4&&(l=l.child,l!==null))for(ap(l,c,h),l=l.sibling;l!==null;)ap(l,c,h),l=l.sibling}var Xr=null,Oi=!1;function sa(l,c,h){for(h=h.child;h!==null;)sp(l,c,h),h=h.sibling}function sp(l,c,h){if(ea&&typeof ea.onCommitFiberUnmount=="function")try{ea.onCommitFiberUnmount(Tu,h)}catch{}switch(h.tag){case 5:ln||al(h,c);case 6:if(Me){var _=Xr,k=Oi;Xr=null,sa(l,c,h),Xr=_,Oi=k,Xr!==null&&(Oi?xt(Xr,h.stateNode):Ye(Xr,h.stateNode))}else sa(l,c,h);break;case 18:Me&&Xr!==null&&(Oi?Be(Xr,h.stateNode):Ne(Xr,h.stateNode));break;case 4:Me?(_=Xr,k=Oi,Xr=h.stateNode.containerInfo,Oi=!0,sa(l,c,h),Xr=_,Oi=k):(G&&(_=h.stateNode.containerInfo,k=Dt(_),mt(_,k)),sa(l,c,h));break;case 0:case 11:case 14:case 15:if(!ln&&(_=h.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){k=_=_.next;do{var R=k,j=R.destroy;R=R.tag,j!==void 0&&(R&2||R&4)&&rp(h,c,j),k=k.next}while(k!==_)}sa(l,c,h);break;case 1:if(!ln&&(al(h,c),_=h.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=h.memoizedProps,_.state=h.memoizedState,_.componentWillUnmount()}catch(Z){Jt(h,c,Z)}sa(l,c,h);break;case 21:sa(l,c,h);break;case 22:h.mode&1?(ln=(_=ln)||h.memoizedState!==null,sa(l,c,h),ln=_):sa(l,c,h);break;default:sa(l,c,h)}}function Wv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new Hw),c.forEach(function(_){var k=ek.bind(null,l,_);h.has(_)||(h.add(_),_.then(k,k))})}}function Li(l,c){var h=c.deletions;if(h!==null)for(var _=0;_<h.length;_++){var k=h[_];try{var R=l,j=c;if(Me){var Z=j;e:for(;Z!==null;){switch(Z.tag){case 5:Xr=Z.stateNode,Oi=!1;break e;case 3:Xr=Z.stateNode.containerInfo,Oi=!0;break e;case 4:Xr=Z.stateNode.containerInfo,Oi=!0;break e}Z=Z.return}if(Xr===null)throw Error(s(160));sp(R,j,k),Xr=null,Oi=!1}else sp(R,j,k);var fe=k.alternate;fe!==null&&(fe.return=null),k.return=null}catch(Le){Jt(k,c,Le)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)$v(c,l),c=c.sibling}function $v(l,c){var h=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Li(c,l),oa(l),_&4){try{Fc(3,l,l.return),Yu(3,l)}catch(Ue){Jt(l,l.return,Ue)}try{Fc(5,l,l.return)}catch(Ue){Jt(l,l.return,Ue)}}break;case 1:Li(c,l),oa(l),_&512&&h!==null&&al(h,h.return);break;case 5:if(Li(c,l),oa(l),_&512&&h!==null&&al(h,h.return),Me){if(l.flags&32){var k=l.stateNode;try{si(k)}catch(Ue){Jt(l,l.return,Ue)}}if(_&4&&(k=l.stateNode,k!=null)){var R=l.memoizedProps;if(h=h!==null?h.memoizedProps:R,_=l.type,c=l.updateQueue,l.updateQueue=null,c!==null)try{Qe(k,c,_,h,R,l)}catch(Ue){Jt(l,l.return,Ue)}}}break;case 6:if(Li(c,l),oa(l),_&4&&Me){if(l.stateNode===null)throw Error(s(162));k=l.stateNode,R=l.memoizedProps,h=h!==null?h.memoizedProps:R;try{Fe(k,h,R)}catch(Ue){Jt(l,l.return,Ue)}}break;case 3:if(Li(c,l),oa(l),_&4){if(Me&&tt&&h!==null&&h.memoizedState.isDehydrated)try{se(c.containerInfo)}catch(Ue){Jt(l,l.return,Ue)}if(G){k=c.containerInfo,R=c.pendingChildren;try{mt(k,R)}catch(Ue){Jt(l,l.return,Ue)}}}break;case 4:if(Li(c,l),oa(l),_&4&&G){R=l.stateNode,k=R.containerInfo,R=R.pendingChildren;try{mt(k,R)}catch(Ue){Jt(l,l.return,Ue)}}break;case 13:Li(c,l),oa(l),k=l.child,k.flags&8192&&(R=k.memoizedState!==null,k.stateNode.isHidden=R,!R||k.alternate!==null&&k.alternate.memoizedState!==null||(hp=Mr())),_&4&&Wv(l);break;case 22:var j=h!==null&&h.memoizedState!==null;if(l.mode&1?(ln=(h=ln)||j,Li(c,l),ln=h):Li(c,l),oa(l),_&8192){if(h=l.memoizedState!==null,(l.stateNode.isHidden=h)&&!j&&l.mode&1)for(We=l,_=l.child;_!==null;){for(c=We=_;We!==null;){j=We;var Z=j.child;switch(j.tag){case 0:case 11:case 14:case 15:Fc(4,j,j.return);break;case 1:al(j,j.return);var fe=j.stateNode;if(typeof fe.componentWillUnmount=="function"){var Le=j,Ke=j.return;try{var ft=Le;fe.props=ft.memoizedProps,fe.state=ft.memoizedState,fe.componentWillUnmount()}catch(Ue){Jt(Le,Ke,Ue)}}break;case 5:al(j,j.return);break;case 22:if(j.memoizedState!==null){Yv(c);continue}}Z!==null?(Z.return=j,We=Z):Yv(c)}_=_.sibling}if(Me){e:if(_=null,Me)for(c=l;;){if(c.tag===5){if(_===null){_=c;try{k=c.stateNode,h?be(k):Ge(c.stateNode,c.memoizedProps)}catch(Ue){Jt(l,l.return,Ue)}}}else if(c.tag===6){if(_===null)try{R=c.stateNode,h?qe(R):Je(R,c.memoizedProps)}catch(Ue){Jt(l,l.return,Ue)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;_===c&&(_=null),c=c.return}_===c&&(_=null),c.sibling.return=c.return,c=c.sibling}}}break;case 19:Li(c,l),oa(l),_&4&&Wv(l);break;case 21:break;default:Li(c,l),oa(l)}}function oa(l){var c=l.flags;if(c&2){try{if(Me){e:{for(var h=l.return;h!==null;){if(Gv(h)){var _=h;break e}h=h.return}throw Error(s(160))}switch(_.tag){case 5:var k=_.stateNode;_.flags&32&&(si(k),_.flags&=-33);var R=Hv(l);ap(l,R,k);break;case 3:case 4:var j=_.stateNode.containerInfo,Z=Hv(l);ip(l,Z,j);break;default:throw Error(s(161))}}}catch(fe){Jt(l,l.return,fe)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function $w(l,c,h){We=l,Xv(l)}function Xv(l,c,h){for(var _=(l.mode&1)!==0;We!==null;){var k=We,R=k.child;if(k.tag===22&&_){var j=k.memoizedState!==null||Ku;if(!j){var Z=k.alternate,fe=Z!==null&&Z.memoizedState!==null||ln;Z=Ku;var Le=ln;if(Ku=j,(ln=fe)&&!Le)for(We=k;We!==null;)j=We,fe=j.child,j.tag===22&&j.memoizedState!==null?Qv(k):fe!==null?(fe.return=j,We=fe):Qv(k);for(;R!==null;)We=R,Xv(R),R=R.sibling;We=k,Ku=Z,ln=Le}Kv(l)}else k.subtreeFlags&8772&&R!==null?(R.return=k,We=R):Kv(l)}}function Kv(l){for(;We!==null;){var c=We;if(c.flags&8772){var h=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:ln||Yu(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!ln)if(h===null)_.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:Di(c.type,h.memoizedProps);_.componentDidUpdate(k,h.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var R=c.updateQueue;R!==null&&qx(c,R,_);break;case 3:var j=c.updateQueue;if(j!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=ke(c.child.stateNode);break;case 1:h=c.child.stateNode}qx(c,j,h)}break;case 5:var Z=c.stateNode;h===null&&c.flags&4&&Ce(Z,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(tt&&c.memoizedState===null){var fe=c.alternate;if(fe!==null){var Le=fe.memoizedState;if(Le!==null){var Ke=Le.dehydrated;Ke!==null&&le(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}ln||c.flags&512&&np(c)}catch(ft){Jt(c,c.return,ft)}}if(c===l){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function Yv(l){for(;We!==null;){var c=We;if(c===l){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function Qv(l){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Yu(4,c)}catch(fe){Jt(c,h,fe)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var k=c.return;try{_.componentDidMount()}catch(fe){Jt(c,k,fe)}}var R=c.return;try{np(c)}catch(fe){Jt(c,R,fe)}break;case 5:var j=c.return;try{np(c)}catch(fe){Jt(c,j,fe)}}}catch(fe){Jt(c,c.return,fe)}if(c===l){We=null;break}var Z=c.sibling;if(Z!==null){Z.return=c.return,We=Z;break}We=c.return}}var Qu=0,qu=1,Ju=2,Zu=3,ef=4;if(typeof Symbol=="function"&&Symbol.for){var Nc=Symbol.for;Qu=Nc("selector.component"),qu=Nc("selector.has_pseudo_class"),Ju=Nc("selector.role"),Zu=Nc("selector.test_id"),ef=Nc("selector.text")}function op(l){var c=nt(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(s(364));return c}if(l=pe(l),l===null)throw Error(s(362));return l.stateNode.current}function lp(l,c){switch(c.$$typeof){case Qu:if(l.type===c.value)return!0;break;case qu:e:{c=c.value,l=[l,0];for(var h=0;h<l.length;){var _=l[h++],k=l[h++],R=c[k];if(_.tag!==5||!Pe(_)){for(;R!=null&&lp(_,R);)k++,R=c[k];if(k===c.length){c=!0;break e}else for(_=_.child;_!==null;)l.push(_,k),_=_.sibling}}c=!1}return c;case Ju:if(l.tag===5&&De(l.stateNode,c.value))return!0;break;case ef:if((l.tag===5||l.tag===6)&&(l=Ae(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case Zu:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function cp(l){switch(l.$$typeof){case Qu:return"<"+(N(l.value)||"Unknown")+">";case qu:return":has("+(cp(l)||"")+")";case Ju:return'[role="'+l.value+'"]';case ef:return'"'+l.value+'"';case Zu:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function qv(l,c){var h=[];l=[l,0];for(var _=0;_<l.length;){var k=l[_++],R=l[_++],j=c[R];if(k.tag!==5||!Pe(k)){for(;j!=null&&lp(k,j);)R++,j=c[R];if(R===c.length)h.push(k);else for(k=k.child;k!==null;)l.push(k,R),k=k.sibling}}return h}function up(l,c){if(!me)throw Error(s(363));l=op(l),l=qv(l,c),c=[],l=Array.from(l);for(var h=0;h<l.length;){var _=l[h++];if(_.tag===5)Pe(_)||c.push(_.stateNode);else for(_=_.child;_!==null;)l.push(_),_=_.sibling}return c}var Xw=Math.ceil,tf=o.ReactCurrentDispatcher,fp=o.ReactCurrentOwner,pr=o.ReactCurrentBatchConfig,vt=0,jr=null,yr=null,Kr=0,Yn=0,sl=nn(0),Tr=0,Rc=null,eo=0,rf=0,dp=0,bc=null,Bn=null,hp=0,pp=1/0,Ta=null;function ol(){pp=Mr()+500}var nf=!1,gp=null,rs=null,af=!1,ns=null,sf=0,Ic=0,mp=null,of=-1,lf=0;function cn(){return vt&6?Mr():of!==-1?of:of=Mr()}function is(l){return l.mode&1?vt&2&&Kr!==0?Kr&-Kr:Fw.transition!==null?(lf===0&&(lf=Ox()),lf):(l=Rt,l!==0?l:Ze()):1}function pi(l,c,h,_){if(50<Ic)throw Ic=0,mp=null,Error(s(185));xc(l,h,_),(!(vt&2)||l!==jr)&&(l===jr&&(!(vt&2)&&(rf|=h),Tr===4&&as(l,Kr)),jn(l,_),h===1&&vt===0&&!(c.mode&1)&&(ol(),Au&&ta()))}function jn(l,c){var h=l.callbackNode;_w(l,c);var _=Cu(l,l===jr?Kr:0);if(_===0)h!==null&&Mx(h),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(h!=null&&Mx(h),c===1)l.tag===0?Pw(Zv.bind(null,l)):Bx(Zv.bind(null,l)),Ct?Lr(function(){!(vt&6)&&ta()}):y1(_1,ta),h=null;else{switch(Lx(_)){case 1:h=_1;break;case 4:h=Ew;break;case 16:h=S1;break;case 536870912:h=Cw;break;default:h=S1}h=l4(h,Jv.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function Jv(l,c){if(of=-1,lf=0,vt&6)throw Error(s(327));var h=l.callbackNode;if(no()&&l.callbackNode!==h)return null;var _=Cu(l,l===jr?Kr:0);if(_===0)return null;if(_&30||_&l.expiredLanes||c)c=cf(l,_);else{c=_;var k=vt;vt|=2;var R=r4();(jr!==l||Kr!==c)&&(Ta=null,ol(),to(l,c));do try{Qw();break}catch(Z){t4(l,Z)}while(1);F1(),tf.current=R,vt=k,yr!==null?c=0:(jr=null,Kr=0,c=Tr)}if(c!==0){if(c===2&&(k=m1(l),k!==0&&(_=k,c=xp(l,k))),c===1)throw h=Rc,to(l,0),as(l,_),jn(l,Mr()),h;if(c===6)as(l,_);else{if(k=l.current.alternate,!(_&30)&&!Kw(k)&&(c=cf(l,_),c===2&&(R=m1(l),R!==0&&(_=R,c=xp(l,R))),c===1))throw h=Rc,to(l,0),as(l,_),jn(l,Mr()),h;switch(l.finishedWork=k,l.finishedLanes=_,c){case 0:case 1:throw Error(s(345));case 2:ro(l,Bn,Ta);break;case 3:if(as(l,_),(_&130023424)===_&&(c=hp+500-Mr(),10<c)){if(Cu(l,0)!==0)break;if(k=l.suspendedLanes,(k&_)!==_){cn(),l.pingedLanes|=l.suspendedLanes&k;break}l.timeoutHandle=z(ro.bind(null,l,Bn,Ta),c);break}ro(l,Bn,Ta);break;case 4:if(as(l,_),(_&4194240)===_)break;for(c=l.eventTimes,k=-1;0<_;){var j=31-Ri(_);R=1<<j,j=c[j],j>k&&(k=j),_&=~R}if(_=k,_=Mr()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*Xw(_/1960))-_,10<_){l.timeoutHandle=z(ro.bind(null,l,Bn,Ta),_);break}ro(l,Bn,Ta);break;case 5:ro(l,Bn,Ta);break;default:throw Error(s(329))}}}return jn(l,Mr()),l.callbackNode===h?Jv.bind(null,l):null}function xp(l,c){var h=bc;return l.current.memoizedState.isDehydrated&&(to(l,c).flags|=256),l=cf(l,c),l!==2&&(c=Bn,Bn=h,c!==null&&vp(c)),l}function vp(l){Bn===null?Bn=l:Bn.push.apply(Bn,l)}function Kw(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var _=0;_<h.length;_++){var k=h[_],R=k.getSnapshot;k=k.value;try{if(!bi(R(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function as(l,c){for(c&=~dp,c&=~rf,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-Ri(c),_=1<<h;l[h]=-1,c&=~_}}function Zv(l){if(vt&6)throw Error(s(327));no();var c=Cu(l,0);if(!(c&1))return jn(l,Mr()),null;var h=cf(l,c);if(l.tag!==0&&h===2){var _=m1(l);_!==0&&(c=_,h=xp(l,_))}if(h===1)throw h=Rc,to(l,0),as(l,c),jn(l,Mr()),h;if(h===6)throw Error(s(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,ro(l,Bn,Ta),jn(l,Mr()),null}function e4(l){ns!==null&&ns.tag===0&&!(vt&6)&&no();var c=vt;vt|=1;var h=pr.transition,_=Rt;try{if(pr.transition=null,Rt=1,l)return l()}finally{Rt=_,pr.transition=h,vt=c,!(vt&6)&&ta()}}function yp(){Yn=sl.current,Bt(sl)}function to(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==de&&(l.timeoutHandle=de,te(h)),yr!==null)for(h=yr.return;h!==null;){var _=h;switch(E1(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Su();break;case 3:nl(),Bt(On),Bt(an),M1();break;case 5:O1(_);break;case 4:nl();break;case 13:Bt(rr);break;case 19:Bt(rr);break;case 10:N1(_.type._context);break;case 22:case 23:yp()}h=h.return}if(jr=l,yr=l=ss(l.current,null),Kr=Yn=c,Tr=0,Rc=null,dp=rf=eo=0,Bn=bc=null,Js!==null){for(c=0;c<Js.length;c++)if(h=Js[c],_=h.interleaved,_!==null){h.interleaved=null;var k=_.next,R=h.pending;if(R!==null){var j=R.next;R.next=k,_.next=j}h.pending=_}Js=null}return l}function t4(l,c){do{var h=yr;try{if(F1(),Bu.current=Vu,ju){for(var _=nr.memoizedState;_!==null;){var k=_.queue;k!==null&&(k.pending=null),_=_.next}ju=!1}if(Zs=0,Br=Cr=nr=null,wc=!1,kc=0,fp.current=null,h===null||h.return===null){Tr=1,Rc=c,yr=null;break}e:{var R=l,j=h.return,Z=h,fe=c;if(c=Kr,Z.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Le=fe,Ke=Z,ft=Ke.tag;if(!(Ke.mode&1)&&(ft===0||ft===11||ft===15)){var Ue=Ke.alternate;Ue?(Ke.updateQueue=Ue.updateQueue,Ke.memoizedState=Ue.memoizedState,Ke.lanes=Ue.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var Kt=Tv(j);if(Kt!==null){Kt.flags&=-257,Av(Kt,j,Z,R,c),Kt.mode&1&&Cv(R,Le,c),c=Kt,fe=Le;var Gt=c.updateQueue;if(Gt===null){var Un=new Set;Un.add(fe),c.updateQueue=Un}else Gt.add(fe);break e}else{if(!(c&1)){Cv(R,Le,c),_p();break e}fe=Error(s(426))}}else if(qt&&Z.mode&1){var Aa=Tv(j);if(Aa!==null){!(Aa.flags&65536)&&(Aa.flags|=256),Av(Aa,j,Z,R,c),A1(il(fe,Z));break e}}R=fe=il(fe,Z),Tr!==4&&(Tr=2),bc===null?bc=[R]:bc.push(R),R=j;do{switch(R.tag){case 3:R.flags|=65536,c&=-c,R.lanes|=c;var ce=kv(R,fe,c);Qx(R,ce);break e;case 1:Z=fe;var ee=R.type,ge=R.stateNode;if(!(R.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(rs===null||!rs.has(ge)))){R.flags|=65536,c&=-c,R.lanes|=c;var ze=Ev(R,Z,c);Qx(R,ze);break e}}R=R.return}while(R!==null)}i4(h)}catch(rt){c=rt,yr===h&&h!==null&&(yr=h=h.return);continue}break}while(1)}function r4(){var l=tf.current;return tf.current=Vu,l===null?Vu:l}function _p(){(Tr===0||Tr===3||Tr===2)&&(Tr=4),jr===null||!(eo&268435455)&&!(rf&268435455)||as(jr,Kr)}function cf(l,c){var h=vt;vt|=2;var _=r4();(jr!==l||Kr!==c)&&(Ta=null,to(l,c));do try{Yw();break}catch(k){t4(l,k)}while(1);if(F1(),vt=h,tf.current=_,yr!==null)throw Error(s(261));return jr=null,Kr=0,Tr}function Yw(){for(;yr!==null;)n4(yr)}function Qw(){for(;yr!==null&&!ww();)n4(yr)}function n4(l){var c=o4(l.alternate,l,Yn);l.memoizedProps=l.pendingProps,c===null?i4(l):yr=c,fp.current=null}function i4(l){var c=l;do{var h=c.alternate;if(l=c.return,c.flags&32768){if(h=Gw(h,c),h!==null){h.flags&=32767,yr=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Tr=6,yr=null;return}}else if(h=Vw(h,c,Yn),h!==null){yr=h;return}if(c=c.sibling,c!==null){yr=c;return}yr=c=l}while(c!==null);Tr===0&&(Tr=5)}function ro(l,c,h){var _=Rt,k=pr.transition;try{pr.transition=null,Rt=1,qw(l,c,h,_)}finally{pr.transition=k,Rt=_}return null}function qw(l,c,h,_){do no();while(ns!==null);if(vt&6)throw Error(s(327));h=l.finishedWork;var k=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(s(177));l.callbackNode=null,l.callbackPriority=0;var R=h.lanes|h.childLanes;if(Sw(l,R),l===jr&&(yr=jr=null,Kr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||af||(af=!0,l4(S1,function(){return no(),null})),R=(h.flags&15990)!==0,h.subtreeFlags&15990||R){R=pr.transition,pr.transition=null;var j=Rt;Rt=1;var Z=vt;vt|=4,fp.current=null,Ww(l,h),$v(h,l),he(l.containerInfo),l.current=h,$w(h),kw(),vt=Z,Rt=j,pr.transition=R}else l.current=h;if(af&&(af=!1,ns=l,sf=k),R=l.pendingLanes,R===0&&(rs=null),Tw(h.stateNode),jn(l,Mr()),c!==null)for(_=l.onRecoverableError,h=0;h<c.length;h++)k=c[h],_(k.value,{componentStack:k.stack,digest:k.digest});if(nf)throw nf=!1,l=gp,gp=null,l;return sf&1&&l.tag!==0&&no(),R=l.pendingLanes,R&1?l===mp?Ic++:(Ic=0,mp=l):Ic=0,ta(),null}function no(){if(ns!==null){var l=Lx(sf),c=pr.transition,h=Rt;try{if(pr.transition=null,Rt=16>l?16:l,ns===null)var _=!1;else{if(l=ns,ns=null,sf=0,vt&6)throw Error(s(331));var k=vt;for(vt|=4,We=l.current;We!==null;){var R=We,j=R.child;if(We.flags&16){var Z=R.deletions;if(Z!==null){for(var fe=0;fe<Z.length;fe++){var Le=Z[fe];for(We=Le;We!==null;){var Ke=We;switch(Ke.tag){case 0:case 11:case 15:Fc(8,Ke,R)}var ft=Ke.child;if(ft!==null)ft.return=Ke,We=ft;else for(;We!==null;){Ke=We;var Ue=Ke.sibling,Kt=Ke.return;if(Vv(Ke),Ke===Le){We=null;break}if(Ue!==null){Ue.return=Kt,We=Ue;break}We=Kt}}}var Gt=R.alternate;if(Gt!==null){var Un=Gt.child;if(Un!==null){Gt.child=null;do{var Aa=Un.sibling;Un.sibling=null,Un=Aa}while(Un!==null)}}We=R}}if(R.subtreeFlags&2064&&j!==null)j.return=R,We=j;else e:for(;We!==null;){if(R=We,R.flags&2048)switch(R.tag){case 0:case 11:case 15:Fc(9,R,R.return)}var ce=R.sibling;if(ce!==null){ce.return=R.return,We=ce;break e}We=R.return}}var ee=l.current;for(We=ee;We!==null;){j=We;var ge=j.child;if(j.subtreeFlags&2064&&ge!==null)ge.return=j,We=ge;else e:for(j=ee;We!==null;){if(Z=We,Z.flags&2048)try{switch(Z.tag){case 0:case 11:case 15:Yu(9,Z)}}catch(rt){Jt(Z,Z.return,rt)}if(Z===j){We=null;break e}var ze=Z.sibling;if(ze!==null){ze.return=Z.return,We=ze;break e}We=Z.return}}if(vt=k,ta(),ea&&typeof ea.onPostCommitFiberRoot=="function")try{ea.onPostCommitFiberRoot(Tu,l)}catch{}_=!0}return _}finally{Rt=h,pr.transition=c}}return!1}function a4(l,c,h){c=il(h,c),c=kv(l,c,1),l=ts(l,c,1),c=cn(),l!==null&&(xc(l,1,c),jn(l,c))}function Jt(l,c,h){if(l.tag===3)a4(l,l,h);else for(;c!==null;){if(c.tag===3){a4(c,l,h);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(rs===null||!rs.has(_))){l=il(h,l),l=Ev(c,l,1),c=ts(c,l,1),l=cn(),c!==null&&(xc(c,1,l),jn(c,l));break}}c=c.return}}function Jw(l,c,h){var _=l.pingCache;_!==null&&_.delete(c),c=cn(),l.pingedLanes|=l.suspendedLanes&h,jr===l&&(Kr&h)===h&&(Tr===4||Tr===3&&(Kr&130023424)===Kr&&500>Mr()-hp?to(l,0):dp|=h),jn(l,c)}function s4(l,c){c===0&&(l.mode&1?(c=Eu,Eu<<=1,!(Eu&130023424)&&(Eu=4194304)):c=1);var h=cn();l=ra(l,c),l!==null&&(xc(l,c,h),jn(l,h))}function Zw(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),s4(l,h)}function ek(l,c){var h=0;switch(l.tag){case 13:var _=l.stateNode,k=l.memoizedState;k!==null&&(h=k.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(s(314))}_!==null&&_.delete(c),s4(l,h)}var o4;o4=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||On.current)Mn=!0;else{if(!(l.lanes&h)&&!(c.flags&128))return Mn=!1,zw(l,c,h);Mn=!!(l.flags&131072)}else Mn=!1,qt&&c.flags&1048576&&jx(c,Fu,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Wu(l,c),l=c.pendingProps;var k=Yo(c,an.current);tl(c,h),k=U1(null,c,_,l,k,h);var R=z1();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ln(_)?(R=!0,wu(c)):R=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,I1(c),k.updater=Gu,c.stateNode=k,k._reactInternals=c,X1(c,_,l,h),c=q1(null,c,_,!0,R,h)):(c.tag=0,qt&&R&&k1(c),En(null,c,k,h),c=c.child),c;case 16:_=c.elementType;e:{switch(Wu(l,c),l=c.pendingProps,k=_._init,_=k(_._payload),c.type=_,k=c.tag=rk(_),l=Di(_,l),k){case 0:c=Q1(null,c,_,l,h);break e;case 1:c=Iv(null,c,_,l,h);break e;case 11:c=Pv(null,c,_,l,h);break e;case 14:c=Fv(null,c,_,Di(_.type,l),h);break e}throw Error(s(306,_,""))}return c;case 0:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Di(_,k),Q1(l,c,_,k,h);case 1:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Di(_,k),Iv(l,c,_,k,h);case 3:e:{if(Dv(c),l===null)throw Error(s(387));_=c.pendingProps,R=c.memoizedState,k=R.element,Yx(l,c),Lu(c,_,null,h);var j=c.memoizedState;if(_=j.element,tt&&R.isDehydrated)if(R={element:_,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){k=il(Error(s(423)),c),c=Ov(l,c,_,h,k);break e}else if(_!==k){k=il(Error(s(424)),c),c=Ov(l,c,_,h,k);break e}else for(tt&&(ui=U(c.stateNode.containerInfo),Kn=c,qt=!0,Ii=null,vc=!1),h=$x(c,null,_,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Jo(),_===k){c=Ca(l,c,h);break e}En(l,c,_,h)}c=c.child}return c;case 5:return Jx(c),l===null&&T1(c),_=c.type,k=c.pendingProps,R=l!==null?l.memoizedProps:null,j=k.children,Y(_,k)?j=null:R!==null&&Y(_,R)&&(c.flags|=32),bv(l,c),En(l,c,j,h),c.child;case 6:return l===null&&T1(c),null;case 13:return Lv(l,c,h);case 4:return D1(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=Zo(c,null,_,h):En(l,c,_,h),c.child;case 11:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Di(_,k),Pv(l,c,_,k,h);case 7:return En(l,c,c.pendingProps,h),c.child;case 8:return En(l,c,c.pendingProps.children,h),c.child;case 12:return En(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(_=c.type._context,k=c.pendingProps,R=c.memoizedProps,j=k.value,Xx(c,_,j),R!==null)if(bi(R.value,j)){if(R.children===k.children&&!On.current){c=Ca(l,c,h);break e}}else for(R=c.child,R!==null&&(R.return=c);R!==null;){var Z=R.dependencies;if(Z!==null){j=R.child;for(var fe=Z.firstContext;fe!==null;){if(fe.context===_){if(R.tag===1){fe=Ea(-1,h&-h),fe.tag=2;var Le=R.updateQueue;if(Le!==null){Le=Le.shared;var Ke=Le.pending;Ke===null?fe.next=fe:(fe.next=Ke.next,Ke.next=fe),Le.pending=fe}}R.lanes|=h,fe=R.alternate,fe!==null&&(fe.lanes|=h),R1(R.return,h,c),Z.lanes|=h;break}fe=fe.next}}else if(R.tag===10)j=R.type===c.type?null:R.child;else if(R.tag===18){if(j=R.return,j===null)throw Error(s(341));j.lanes|=h,Z=j.alternate,Z!==null&&(Z.lanes|=h),R1(j,h,c),j=R.sibling}else j=R.child;if(j!==null)j.return=R;else for(j=R;j!==null;){if(j===c){j=null;break}if(R=j.sibling,R!==null){R.return=j.return,j=R;break}j=j.return}R=j}En(l,c,k.children,h),c=c.child}return c;case 9:return k=c.type,_=c.pendingProps.children,tl(c,h),k=fi(k),_=_(k),c.flags|=1,En(l,c,_,h),c.child;case 14:return _=c.type,k=Di(_,c.pendingProps),k=Di(_.type,k),Fv(l,c,_,k,h);case 15:return Nv(l,c,c.type,c.pendingProps,h);case 17:return _=c.type,k=c.pendingProps,k=c.elementType===_?k:Di(_,k),Wu(l,c),c.tag=1,Ln(_)?(l=!0,wu(c)):l=!1,tl(c,h),Sv(c,_,k),X1(c,_,k,h),q1(null,c,_,!0,l,h);case 19:return Bv(l,c,h);case 22:return Rv(l,c,h)}throw Error(s(156,c.tag))};function l4(l,c){return y1(l,c)}function tk(l,c,h,_){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(l,c,h,_){return new tk(l,c,h,_)}function Sp(l){return l=l.prototype,!(!l||!l.isReactComponent)}function rk(l){if(typeof l=="function")return Sp(l)?1:0;if(l!=null){if(l=l.$$typeof,l===y)return 11;if(l===w)return 14}return 2}function ss(l,c){var h=l.alternate;return h===null?(h=gi(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function uf(l,c,h,_,k,R){var j=2;if(_=l,typeof l=="function")Sp(l)&&(j=1);else if(typeof l=="string")j=5;else e:switch(l){case d:return io(h.children,k,R,c);case p:j=8,k|=8;break;case g:return l=gi(12,h,c,k|2),l.elementType=g,l.lanes=R,l;case C:return l=gi(13,h,c,k),l.elementType=C,l.lanes=R,l;case S:return l=gi(19,h,c,k),l.elementType=S,l.lanes=R,l;case T:return ff(h,k,R,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:j=10;break e;case m:j=9;break e;case y:j=11;break e;case w:j=14;break e;case x:j=16,_=null;break e}throw Error(s(130,l==null?l:typeof l,""))}return c=gi(j,h,c,k),c.elementType=l,c.type=_,c.lanes=R,c}function io(l,c,h,_){return l=gi(7,l,_,c),l.lanes=h,l}function ff(l,c,h,_){return l=gi(22,l,_,c),l.elementType=T,l.lanes=h,l.stateNode={isHidden:!1},l}function wp(l,c,h){return l=gi(6,l,null,c),l.lanes=h,l}function kp(l,c,h){return c=gi(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function nk(l,c,h,_,k){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=de,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=x1(0),this.expirationTimes=x1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x1(0),this.identifierPrefix=_,this.onRecoverableError=k,tt&&(this.mutableSourceEagerHydrationData=null)}function c4(l,c,h,_,k,R,j,Z,fe){return l=new nk(l,c,h,Z,fe),c===1?(c=1,R===!0&&(c|=8)):c=0,R=gi(3,null,null,c),l.current=R,R.stateNode=l,R.memoizedState={element:_,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},I1(R),l}function u4(l){if(!l)return Za;l=l._reactInternals;e:{if(I(l)!==l||l.tag!==1)throw Error(s(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ln(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(s(171))}if(l.tag===1){var h=l.type;if(Ln(h))return Ix(l,h,c)}return c}function f4(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=L(c),l===null?null:l.stateNode}function d4(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function df(l,c){d4(l,c),(l=l.alternate)&&d4(l,c)}function ik(l){return l=L(l),l===null?null:l.stateNode}function ak(){return null}return r.attemptContinuousHydration=function(l){if(l.tag===13){var c=ra(l,134217728);if(c!==null){var h=cn();pi(c,l,134217728,h)}df(l,134217728)}},r.attemptDiscreteHydration=function(l){if(l.tag===13){var c=ra(l,1);if(c!==null){var h=cn();pi(c,l,1,h)}df(l,1)}},r.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=is(l),h=ra(l,c);if(h!==null){var _=cn();pi(h,l,c,_)}df(l,c)}},r.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=mc(c.pendingLanes);h!==0&&(v1(c,h|1),jn(c,Mr()),!(vt&6)&&(ol(),ta()))}break;case 13:e4(function(){var _=ra(l,1);if(_!==null){var k=cn();pi(_,l,1,k)}}),df(l,1)}},r.batchedUpdates=function(l,c){var h=vt;vt|=1;try{return l(c)}finally{vt=h,vt===0&&(ol(),Au&&ta())}},r.createComponentSelector=function(l){return{$$typeof:Qu,value:l}},r.createContainer=function(l,c,h,_,k,R,j){return c4(l,c,!1,null,h,_,k,R,j)},r.createHasPseudoClassSelector=function(l){return{$$typeof:qu,value:l}},r.createHydrationContainer=function(l,c,h,_,k,R,j,Z,fe){return l=c4(h,_,!0,l,k,R,j,Z,fe),l.context=u4(null),h=l.current,_=cn(),k=is(h),R=Ea(_,k),R.callback=c??null,ts(h,R,k),l.current.lanes=k,xc(l,k,_),jn(l,_),l},r.createPortal=function(l,c,h){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:_==null?null:""+_,children:l,containerInfo:c,implementation:h}},r.createRoleSelector=function(l){return{$$typeof:Ju,value:l}},r.createTestNameSelector=function(l){return{$$typeof:Zu,value:l}},r.createTextSelector=function(l){return{$$typeof:ef,value:l}},r.deferredUpdates=function(l){var c=Rt,h=pr.transition;try{return pr.transition=null,Rt=16,l()}finally{Rt=c,pr.transition=h}},r.discreteUpdates=function(l,c,h,_,k){var R=Rt,j=pr.transition;try{return pr.transition=null,Rt=1,l(c,h,_,k)}finally{Rt=R,pr.transition=j,vt===0&&ol()}},r.findAllNodes=up,r.findBoundingRects=function(l,c){if(!me)throw Error(s(363));c=up(l,c),l=[];for(var h=0;h<c.length;h++)l.push(Te(c[h]));for(c=l.length-1;0<c;c--){h=l[c];for(var _=h.x,k=_+h.width,R=h.y,j=R+h.height,Z=c-1;0<=Z;Z--)if(c!==Z){var fe=l[Z],Le=fe.x,Ke=Le+fe.width,ft=fe.y,Ue=ft+fe.height;if(_>=Le&&R>=ft&&k<=Ke&&j<=Ue){l.splice(c,1);break}else if(_!==Le||h.width!==fe.width||Ue<R||ft>j){if(!(R!==ft||h.height!==fe.height||Ke<_||Le>k)){Le>_&&(fe.width+=Le-_,fe.x=_),Ke<k&&(fe.width=k-Le),l.splice(c,1);break}}else{ft>R&&(fe.height+=ft-R,fe.y=R),Ue<j&&(fe.height=j-ft),l.splice(c,1);break}}}return l},r.findHostInstance=f4,r.findHostInstanceWithNoPortals=function(l){return l=O(l),l=l!==null?ie(l):null,l===null?null:l.stateNode},r.findHostInstanceWithWarning=function(l){return f4(l)},r.flushControlled=function(l){var c=vt;vt|=1;var h=pr.transition,_=Rt;try{pr.transition=null,Rt=1,l()}finally{Rt=_,pr.transition=h,vt=c,vt===0&&(ol(),ta())}},r.flushPassiveEffects=no,r.flushSync=e4,r.focusWithin=function(l,c){if(!me)throw Error(s(363));for(l=op(l),c=qv(l,c),c=Array.from(c),l=0;l<c.length;){var h=c[l++];if(!Pe(h)){if(h.tag===5&&Ve(h.stateNode))return!0;for(h=h.child;h!==null;)c.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Rt},r.getFindAllNodesFailureDescription=function(l,c){if(!me)throw Error(s(363));var h=0,_=[];l=[op(l),0];for(var k=0;k<l.length;){var R=l[k++],j=l[k++],Z=c[j];if((R.tag!==5||!Pe(R))&&(lp(R,Z)&&(_.push(cp(Z)),j++,j>h&&(h=j)),j<c.length))for(R=R.child;R!==null;)l.push(R,j),R=R.sibling}if(h<c.length){for(l=[];h<c.length;h++)l.push(cp(c[h]));return`findAllNodes was able to match part of the selector:
  `+(_.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},r.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return ke(l.child.stateNode);default:return l.child.stateNode}},r.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ik,findFiberByHostInstance:l.findFiberByHostInstance||ak,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Tu=c.inject(l),ea=c}catch{}l=!!c.checkDCE}}return l},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(l,c,h,_){if(!me)throw Error(s(363));l=up(l,c);var k=ve(l,h,_).disconnect;return{disconnect:function(){k()}}},r.registerMutableSourceForHydration=function(l,c){var h=c._getVersion;h=h(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,h]:l.mutableSourceEagerHydrationData.push(c,h)},r.runWithPriority=function(l,c){var h=Rt;try{return Rt=l,c()}finally{Rt=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(l,c,h,_){var k=c.current,R=cn(),j=is(k);return h=u4(h),c.context===null?c.context=h:c.pendingContext=h,c=Ea(R,j),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=ts(k,c,j),l!==null&&(pi(l,k,j,R),Ou(l,k,j)),j},r};lw.exports=WM;var $M=lw.exports;const XM=qd($M);var cw={exports:{}},$o={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */$o.ConcurrentRoot=1;$o.ContinuousEventPriority=4;$o.DefaultEventPriority=16;$o.DiscreteEventPriority=1;$o.IdleEventPriority=536870912;$o.LegacyRoot=0;cw.exports=$o;var uw=cw.exports;const h5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let p5=!1,g5=!1;const Nx=".react-konva-event",KM=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,YM=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,QM={};function p1(e,t,r=QM){if(!p5&&"zIndex"in t&&(console.warn(YM),p5=!0),!g5&&t.draggable){var n=t.x!==void 0||t.y!==void 0,i=t.onDragEnd||t.onDragMove;n&&!i&&(console.warn(KM),g5=!0)}for(var a in r)if(!h5[a]){var s=a.slice(0,2)==="on",o=r[a]!==t[a];if(s&&o){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e.off(u,r[a])}var f=!t.hasOwnProperty(a);f&&e.setAttr(a,void 0)}var d=t._useStrictMode,p={},g=!1;const v={};for(var a in t)if(!h5[a]){var s=a.slice(0,2)==="on",m=r[a]!==t[a];if(s&&m){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t[a]&&(v[u]=t[a])}!s&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,p[a]=t[a])}g&&(e.setAttrs(p),Xs(e));for(var u in v)e.on(u+Nx,v[u])}function Xs(e){if(!gt.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const fw={},qM={};nu.Node.prototype._applyProps=p1;function JM(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Xs(e)}function ZM(e,t,r){let n=nu[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=nu.Group);const i={},a={};for(var s in t){var o=s.slice(0,2)==="on";o?a[s]=t[s]:i[s]=t[s]}const u=new n(i);return p1(u,a),u}function eB(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function tB(e,t,r){return!1}function rB(e){return e}function nB(){return null}function iB(){return null}function aB(e,t,r,n){return qM}function sB(){}function oB(e){}function lB(e,t){return!1}function cB(){return fw}function uB(){return fw}const fB=setTimeout,dB=clearTimeout,hB=-1;function pB(e,t){return!1}const gB=!1,mB=!0,xB=!0;function vB(e,t){t.parent===e?t.moveToTop():e.add(t),Xs(e)}function yB(e,t){t.parent===e?t.moveToTop():e.add(t),Xs(e)}function dw(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Xs(e)}function _B(e,t,r){dw(e,t,r)}function SB(e,t){t.destroy(),t.off(Nx),Xs(e)}function wB(e,t){t.destroy(),t.off(Nx),Xs(e)}function kB(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function EB(e,t,r){}function CB(e,t,r,n,i){p1(e,i,n)}function TB(e){e.hide(),Xs(e)}function AB(e){}function PB(e,t){(t.visible==null||t.visible)&&e.show()}function FB(e,t){}function NB(e){}function RB(){}const bB=()=>uw.DefaultEventPriority,IB=Object.freeze(Object.defineProperty({__proto__:null,appendChild:vB,appendChildToContainer:yB,appendInitialChild:JM,cancelTimeout:dB,clearContainer:NB,commitMount:EB,commitTextUpdate:kB,commitUpdate:CB,createInstance:ZM,createTextInstance:eB,detachDeletedInstance:RB,finalizeInitialChildren:tB,getChildHostContext:uB,getCurrentEventPriority:bB,getPublicInstance:rB,getRootHostContext:cB,hideInstance:TB,hideTextInstance:AB,idlePriority:s0.unstable_IdlePriority,insertBefore:dw,insertInContainerBefore:_B,isPrimaryRenderer:gB,noTimeout:hB,now:s0.unstable_now,prepareForCommit:nB,preparePortalMount:iB,prepareUpdate:aB,removeChild:SB,removeChildFromContainer:wB,resetAfterCommit:sB,resetTextContent:oB,run:s0.unstable_runWithPriority,scheduleTimeout:fB,shouldDeprioritizeSubtree:lB,shouldSetTextContent:pB,supportsMutation:xB,unhideInstance:PB,unhideTextInstance:FB,warnsIfNotActing:mB},Symbol.toStringTag,{value:"Module"}));var DB=Object.defineProperty,OB=Object.defineProperties,LB=Object.getOwnPropertyDescriptors,m5=Object.getOwnPropertySymbols,MB=Object.prototype.hasOwnProperty,BB=Object.prototype.propertyIsEnumerable,x5=(e,t,r)=>t in e?DB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v5=(e,t)=>{for(var r in t||(t={}))MB.call(t,r)&&x5(e,r,t[r]);if(m5)for(var r of m5(t))BB.call(t,r)&&x5(e,r,t[r]);return e},jB=(e,t)=>OB(e,LB(t)),y5,_5;typeof window<"u"&&((y5=window.document)!=null&&y5.createElement||((_5=window.navigator)==null?void 0:_5.product)==="ReactNative")?Se.useLayoutEffect:Se.useEffect;function hw(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const i=hw(n,t,r);if(i)return i;n=t?null:n.sibling}}function pw(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const S5=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=S5;return}return S5.apply(this,arguments)};const Rx=pw(Se.createContext(null));class gw extends Se.Component{render(){return Se.createElement(Rx.Provider,{value:this._reactInternals},this.props.children)}}function UB(){const e=Se.useContext(Rx);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=Se.useId();return Se.useMemo(()=>{for(const n of[e,e==null?void 0:e.alternate]){if(!n)continue;const i=hw(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===t)return!0;s=s.next}});if(i)return i}},[e,t])}function zB(){const e=UB(),[t]=Se.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==Rx&&!t.has(i)&&t.set(i,Se.useContext(pw(i)))}r=r.return}return t}function VB(){const e=zB();return Se.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>Se.createElement(t,null,Se.createElement(r.Provider,jB(v5({},n),{value:e.get(r)}))),t=>Se.createElement(gw,v5({},t))),[e])}function GB(e){const t=kr.useRef({});return kr.useLayoutEffect(()=>{t.current=e}),kr.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const HB=e=>{const t=kr.useRef(),r=kr.useRef(),n=kr.useRef(),i=GB(e),a=VB(),s=o=>{const{forwardedRef:u}=e;u&&(typeof u=="function"?u(o):u.current=o)};return kr.useLayoutEffect(()=>(r.current=new nu.Stage({width:e.width,height:e.height,container:t.current}),s(r.current),n.current=a0.createContainer(r.current,uw.LegacyRoot,!1,null),a0.updateContainer(kr.createElement(a,{},e.children),n.current),()=>{nu.isBrowser&&(s(null),a0.updateContainer(null,n.current,null),r.current.destroy())}),[]),kr.useLayoutEffect(()=>{s(r.current),p1(r.current,e,i),a0.updateContainer(kr.createElement(a,{},e.children),n.current,null)}),kr.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},WB="Layer",Xc="Group",Cn="Rect",Kc="Circle",w5="Line",vi="Text",a0=XM(IB);a0.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:kr.version,rendererPackageName:"react-konva"});const $B=kr.forwardRef((e,t)=>kr.createElement(gw,{},kr.createElement(HB,{...e,forwardedRef:t}))),Yc=[{level:0,threshold:.1,description:"Ultra Low - Package outline only"},{level:1,threshold:.3,description:"Low - Package + major banks"},{level:2,threshold:.7,description:"Medium - + pin circles"},{level:3,threshold:1.5,description:"High - + pin/signal names"},{level:4,threshold:1/0,description:"Ultra High - All details"}];function XB(e){for(let t=0;t<Yc.length;t++)if(e<Yc[t].threshold)return Yc[t].level;return Yc[Yc.length-1].level}function KB(e,t){return e>=t}function YB(e){switch(e){case 0:return 1;case 1:return .8;case 2:return .6;case 3:return .4;case 4:return .2;default:return .5}}function QB(e){switch(e){case 0:return 50;case 1:return 200;case 2:return 500;case 3:return 1e3;case 4:return 5e3;default:return 1e3}}function qB(e,t="pin"){return e>={pin:.7,signal:.7,bank:.3}[t]}function JB(e,t=12){if(e<.5)return 0;const r=t*Math.min(e,2);return Math.max(8,Math.min(r,24))}function ZB(e){return e>=.3}function ej(e){return e>=.7}class Gn{}Gn.getLODLevel=XB;Gn.shouldRenderAtLOD=KB;Gn.getPerformanceMultiplier=YB;Gn.getMaxElements=QB;Gn.shouldRenderText=qB;Gn.getAdaptiveTextSize=JB;Gn.shouldRenderDifferentialPairs=ZB;Gn.shouldRenderPinDetails=ej;class zr{static createVirtualizedPinList(t,r,n){const i=Math.ceil(r/n)+5;return{getVisibleRange:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length);return{startIndex:s,endIndex:o}},getVisiblePins:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length),{startIndex:u,endIndex:f}={startIndex:s,endIndex:o};return t.slice(u,f).map((d,p)=>({pin:d,index:u+p,top:(u+p)*n}))},getTotalHeight:()=>t.length*n}}static createDebouncedSearch(t,r=300){let n,i=[];return{search:a=>new Promise(s=>{if(clearTimeout(n),!a.trim()){s([]);return}n=setTimeout(()=>{i=t(a),s(i)},r)}),getLastResults:()=>i,cancel:()=>{clearTimeout(n)}}}static optimizeCanvasRendering(){return{getLODLevel:t=>t<.3?"ultra-low":t<.6?"low":t<1.2?"medium":t<2.5?"high":"ultra-high",cullPins:(t,r)=>{const i={left:r.x-100,right:r.x+r.width+100,top:r.y-100,bottom:r.y+r.height+100};return t.filter(a=>{const s=a.position.x*r.scale,o=a.position.y*r.scale;return s>=i.left&&s<=i.right&&o>=i.top&&o<=i.bottom})},batchDOMUpdates:t=>{requestAnimationFrame(()=>{t.forEach(r=>r())})}}}static createPinIndexes(t){const r=new Map,n=new Map,i=new Map,a=new Map,s=new Map;return t.forEach(o=>{r.set(o.id,o),n.set(o.pinNumber,o),o.signalName&&(i.has(o.signalName)||i.set(o.signalName,[]),i.get(o.signalName).push(o)),o.bank&&(a.has(o.bank)||a.set(o.bank,[]),a.get(o.bank).push(o)),s.has(o.pinType)||s.set(o.pinType,[]),s.get(o.pinType).push(o)}),{byId:r,byPinNumber:n,bySignalName:i,byBank:a,byPinType:s,findById:o=>r.get(o),findByPinNumber:o=>n.get(o),findBySignalName:o=>i.get(o)||[],findByBank:o=>a.get(o)||[],findByPinType:o=>s.get(o)||[]}}static startRenderMeasurement(t){this.renderMetrics.set(t,performance.now())}static endRenderMeasurement(t){const r=this.renderMetrics.get(t);if(!r)return 0;const n=performance.now()-r;return this.renderMetrics.delete(t),n}static trackFrameRate(){this.frameCount++;const t=performance.now();if(t-this.lastFrameTime>=1e3){const r=this.frameCount/((t-this.lastFrameTime)/1e3);return this.frameCount=0,this.lastFrameTime=t,r}return null}static createSmartFilter(t){return{filter:(r,n)=>{const i=[];for(const a of t){if(n&&i.length>=n)break;let s=!0;for(const o of r)if(!o(a)){s=!1;break}s&&i.push(a)}return i}}}static createPinSearchRanker(){return{rankPins:(t,r)=>{const n=r.toLowerCase(),i=[];return t.forEach(a=>{let s=0;a.pinNumber.toLowerCase()===n?s+=100:a.pinNumber.toLowerCase().startsWith(n)?s+=80:a.pinNumber.toLowerCase().includes(n)&&(s+=40),a.signalName&&a.signalName.toLowerCase().includes(n)&&(s+=60),a.pinName.toLowerCase().includes(n)&&(s+=30),a.bank&&a.bank.toLowerCase().includes(n)&&(s+=20),s>0&&i.push({pin:a,score:s})}),i.sort((a,s)=>s.score-a.score)}}}}zr.renderMetrics=new Map;zr.frameCount=0;zr.lastFrameTime=performance.now();const tj=({fileName:e,viewInfo:t})=>E.jsxs("div",{style:{width:"100%",height:"32px",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0 16px",position:"relative",zIndex:2,color:"#e0e0e0",fontSize:"12px",fontWeight:500,boxSizing:"border-box",borderBottom:"1px solid #333"},children:[E.jsx("span",{style:{transform:"translateY(-2px)"},children:t}),E.jsx("span",{style:{transform:"translateY(-2px)",marginLeft:"360px"},children:e})]}),rj=({package:e,pins:t,selectedPins:r,onPinSelect:n,onPinDoubleClick:i,zoom:a,rotation:s,isTopView:o,onZoomChange:u,resetTrigger:f=0})=>{const{togglePinSelection:d,selectPins:p,visibleBanks:g,toggleBankVisibility:v,showAllBanks:m}=Yi(),y=Se.useRef(null),C=Se.useRef(null),[S,w]=Se.useState({width:window.innerWidth,height:window.innerHeight-32}),[x,T]=Se.useState(null),[A,F]=Se.useState({x:0,y:0,scale:1}),[N,P]=Se.useState(!1),[I,b]=Se.useState({x:0,y:0}),[O,L]=Se.useState(0),[K,ie]=Se.useState({x:0,y:0});console.log(` PackageCanvas: Received ${t.length} pins (filtered)`);const re=Gn.getLODLevel(A.scale),ke=Se.useMemo(()=>{zr.startRenderMeasurement("pin-indexing");const me=zr.createPinIndexes(t);return zr.endRenderMeasurement("pin-indexing"),me},[t]),we=Se.useMemo(()=>{zr.startRenderMeasurement("viewport-culling");const me=S.width,pe=S.height,Te=.2,Ae=me*Te/A.scale,Pe=pe*Te/A.scale,De={x:-A.x/A.scale-me/(2*A.scale)-Ae,y:-A.y/A.scale-pe/(2*A.scale)-Pe,width:me/A.scale+Ae*2,height:pe/A.scale+Pe*2,scale:A.scale},Ve=(ve,q)=>{if(!ve.position)return console.warn(" Pin missing position:",ve.pinName||ve.pinNumber),!1;let{x:Ee,y:Fe}=ve.position;if(s!==0){const Ce=s*Math.PI/180,Qe=Math.cos(Ce),et=Math.sin(Ce),lt=Ee*Qe-Fe*et,Ye=Ee*et+Fe*Qe;Ee=lt,Fe=Ye}return o||(Ee=-Ee),Ee>=q.x&&Ee<=q.x+q.width&&Fe>=q.y&&Fe<=q.y+q.height};if(A.scale>.6){const ve=300/A.scale,q={...De,x:De.x-ve*1.5,y:De.y-ve*3,width:De.width+ve*3,height:De.height+ve*6},Ee=Array.from(r).map(et=>ke.findById(et)).filter(Boolean),Fe=t.filter(et=>Ve(et,q)),Ce=new Map;Fe.forEach(et=>Ce.set(et.id,et)),Ee.forEach(et=>Ce.set(et.id,et));const Qe=Array.from(Ce.values());return console.log(` : ${Qe.length}/${t.length} pins visible (scale: ${A.scale.toFixed(2)})`),console.log(" Extended bounds:",q),zr.endRenderMeasurement("viewport-culling"),Qe}else{if(A.scale<=.2)return zr.endRenderMeasurement("viewport-culling"),t;if(A.scale<=.4){const q=new Map;t.forEach(Ce=>{const Qe=Ce.bank||"NA";q.has(Qe)||q.set(Qe,[]),q.get(Qe).push(Ce)});const Ee=[],Fe=Array.from(r).map(Ce=>ke.findById(Ce)).filter(Boolean);return Ee.push(...Fe),q.forEach(Ce=>{const Qe=Math.max(1,Math.floor(Ce.length*.85)),et=Math.max(1,Math.floor(Ce.length/Qe));for(let lt=0;lt<Ce.length;lt+=et){const Ye=Ce[lt];r.has(Ye.id)||Ee.push(Ye)}}),zr.endRenderMeasurement("viewport-culling"),Ee}else if(A.scale<=.6){const ve=400/A.scale,q={x:De.x-ve*1.5,y:De.y-ve*2.5,width:De.width+ve*3,height:De.height+ve*5},Ee=Array.from(r).map(xt=>ke.findById(xt)).filter(Boolean),Fe=t.filter(xt=>Ve(xt,q)),Ce=t.filter(xt=>!Fe.some(si=>si.id===xt.id)&&!r.has(xt.id)),Qe=Math.max(1,Math.floor(Ce.length/200)),et=Ce.filter((xt,si)=>si%Qe===0),lt=new Map;Ee.forEach(xt=>lt.set(xt.id,xt)),Fe.forEach(xt=>lt.set(xt.id,xt)),et.forEach(xt=>lt.set(xt.id,xt));const Ye=Array.from(lt.values());return zr.endRenderMeasurement("viewport-culling"),Ye}else{const ve=new Map;t.forEach(Fe=>{const Ce=Fe.bank||"NA";ve.has(Ce)||ve.set(Ce,[]),ve.get(Ce).push(Fe)});const q=Math.max(10,Math.floor(800/ve.size)),Ee=[];return ve.forEach(Fe=>{const Ce=Fe.filter(et=>r.has(et.id));Ee.push(...Ce);const Qe=q-Ce.length;if(Qe>0){const et=Fe.filter(Ye=>!r.has(Ye.id)),lt=Math.max(1,Math.floor(et.length/Qe));for(let Ye=0;Ye<et.length&&Ee.length-Ce.length<Qe;Ye+=lt)Ee.push(et[Ye])}}),zr.endRenderMeasurement("viewport-culling"),Ee}}},[t,A,r,S,ke]),oe=200,X=8,he=(me,pe)=>{if(pe.ctrlKey||pe.metaKey)d(me),T(me);else if(pe.shiftKey&&x){const Te=t.findIndex(Pe=>Pe.id===me),Ae=t.findIndex(Pe=>Pe.id===x);if(Te!==-1&&Ae!==-1){const Pe=Math.min(Te,Ae),De=Math.max(Te,Ae),Ve=t.slice(Pe,De+1).map(q=>q.id),ve=new Set(r);Ve.forEach(q=>ve.add(q)),p(Array.from(ve))}}else n(me),T(me)};Se.useEffect(()=>{var Ae,Pe;const me=()=>{var Ve;if((Ve=y.current)==null?void 0:Ve.container()){const q={width:window.innerWidth,height:window.innerHeight-32};w(Ee=>Ee.width!==q.width||Ee.height!==q.height?(console.log(" Canvas size updated for dynamic maximization (excluding header):",q),y.current&&(y.current.width(q.width),y.current.height(q.height),y.current.getLayer().batchDraw()),q):Ee)}},pe=setTimeout(()=>{me()},200),Te=(Pe=(Ae=y.current)==null?void 0:Ae.container())==null?void 0:Pe.parentElement;if(Te){const De=new ResizeObserver(()=>{C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{me()},16)});De.observe(Te);const Ve=()=>{me()};return window.addEventListener("resize",Ve),()=>{clearTimeout(pe),C.current&&clearTimeout(C.current),De.disconnect(),window.removeEventListener("resize",Ve)}}return()=>{clearTimeout(pe)}},[]),Se.useEffect(()=>{if(e&&t.length>0&&S.width>0&&S.height>0){const me=Y();if(me){const{width:pe,height:Te,centerX:Ae,centerY:Pe}=me,De=0,Ve=S.width-De*2,ve=S.height-De*2,q=Ve/pe,Ee=ve/Te,Fe=Math.max(.8,Math.min(q,Ee,2)),Ce={x:S.width/2,y:S.height/2+30},Qe={x:Ce.x-Ae*Fe,y:Ce.y-Pe*Fe,scale:Fe};console.log(" Auto-fit viewport:",Qe,"for package:",pe,"x",Te,"scale:",Fe),F(Qe)}}},[e,t.length,S]);const _e=me=>{var pe;return me.pinType==="GROUND"||me.pinName==="GND"?go("GROUND"):me.pinType==="POWER"||(pe=me.pinName)!=null&&pe.includes("VCC")?go("POWER"):go(me.bank)},M=me=>({IO:"#FFF",CONFIG:"#FFD700",POWER:"#FF4500",GROUND:"#000",MGT:"#9B4AE2",CLOCK:"#FF69B4",ADC:"#00FFFF",SPECIAL:"#FF1493",MIO:"#32CD32",DDR:"#8A2BE2",NC:"#696969",RESERVED:"#999999"})[me.pinType]||"#FFF",J=(me,pe,Te)=>{if(!Ht||typeof Ht.isDifferentialPin!="function"||!Ht.isDifferentialPin(me))return null;const Ae=Ht.findPairPin(me,pe);if(!Ae)return null;const Pe=Te.has(me.id),De=Te.has(Ae.id);return Pe||De?(Ht.getDifferentialPairType(me.pinName)||(me.signalName?Ht.getDifferentialPairType(me.signalName):null))==="positive"?"#FF3333":"#FF9933":null},Q=(me,pe)=>!Ht||typeof Ht.isDifferentialPin!="function"||!Ht.isDifferentialPin(me)?!1:Ht.findPairPin(me,pe)!==null,Y=()=>{if(!e||t.length===0)return{width:600,height:600,centerX:300,centerY:300,minX:0,minY:0,maxX:600,maxY:600};const me=t.map(Ye=>{var xt;return(xt=Ye.gridPosition)==null?void 0:xt.row}).filter(Boolean),pe=t.map(Ye=>{var xt;return(xt=Ye.gridPosition)==null?void 0:xt.col}).filter(Boolean);console.log(` Found rows: ${me.join(", ")}`);const Te=Math.min(...me.map(Ye=>Is(Ye))),Ae=Math.max(...me.map(Ye=>Is(Ye))),Pe=Math.min(...pe),De=Math.max(...pe);console.log(` Row indices - min: ${Te} (${cl(Te)}), max: ${Ae} (${cl(Ae)})`),console.log(` Col indices - min: ${Pe}, max: ${De}`);const ve=88,q=(De-Pe+1)*ve,Ee=(Ae-Te+1)*ve,Fe=0,Ce=q+Fe*2,Qe=Ee+Fe*2,et=(Pe+De-1)*ve/2,lt=(Te+Ae)*ve/2;return{width:Ce,height:Qe,centerX:et,centerY:lt,minX:(Pe-1)*ve,minY:Te*ve,maxX:De*ve,maxY:(Ae+1)*ve,gridSpacing:ve,minRow:Te,maxRow:Ae,minCol:Pe,maxCol:De}},ue=Y();Se.useEffect(()=>{t.length>0&&console.log(" PackageCanvas: Package loaded with",t.length,"pins")},[t.length]);const z=me=>{let{x:pe,y:Te}=me.position;if(s!==0){const ve=s*Math.PI/180,q=Math.cos(ve),Ee=Math.sin(ve),Fe=pe*q-Te*Ee,Ce=pe*Ee+Te*q;pe=Fe,Te=Ce}o||(pe=-pe);const Ae=S.width,Pe=S.height,De=pe*A.scale+A.x+Ae/2,Ve=Te*A.scale+A.y+Pe/2;return{x:De,y:Ve}},te=(me,pe)=>{const Te=Y(),Ae=Te.width*pe,Pe=Te.height*pe,De=S.width,Ve=S.height,ve=De*.5,q=Ve*.8,Ee=-(Ae/2+ve),Fe=Ae/2+ve,Ce=-(Pe/2+q*1.5),Qe=Pe/2+q;return{x:Math.max(Ee,Math.min(Fe,me.x)),y:Math.max(Ce,Math.min(Qe,me.y))}},de=me=>{me.evt.preventDefault();const pe=y.current;if(!pe)return;const Te=pe.getPointerPosition(),Ae=1.05;if(me.evt.ctrlKey){const Pe=A.scale,De=me.evt.deltaY>0?Pe/Ae:Pe*Ae,Ve=Math.max(.1,Math.min(5,De)),ve={x:(Te.x-A.x)/Pe,y:(Te.y-A.y)/Pe},q={x:Te.x-ve.x*Ve,y:Te.y-ve.y*Ve},Ee=te(q,Ve);F({scale:Ve,x:Ee.x,y:Ee.y}),u==null||u(Ve)}else{const Pe=A.y-me.evt.deltaY*.5,De=te({x:A.x,y:Pe},A.scale);F(Ve=>({...Ve,x:De.x,y:De.y}))}},xe=()=>{const me=y.current;if(!me)return;const pe=me.getPointerPosition(),Te=Date.now();L(Te),ie(pe),b(pe),P(!1)},Me=()=>{const me=y.current;if(!me)return;const pe=me.getPointerPosition(),Te=Date.now();if(!N&&O>0){const Ae=Te-O,Pe=Math.sqrt(Math.pow(pe.x-K.x,2)+Math.pow(pe.y-K.y,2));(Ae>oe||Pe>X)&&P(!0)}if(N){const Ae=pe.x-I.x,Pe=pe.y-I.y,De={x:A.x+Ae,y:A.y+Pe},Ve=te(De,A.scale);F(ve=>({...ve,x:Ve.x,y:Ve.y}))}b(pe)},G=()=>{P(!1),L(0)},tt=()=>{P(!1),L(0)},nt=()=>{F({x:0,y:0,scale:1}),u==null||u(1)};Se.useEffect(()=>{Math.abs(a-1)<.001?F({x:0,y:0,scale:1}):F(me=>({...me,scale:a}))},[a,f]),Se.useEffect(()=>{const me=pe=>{(pe.key==="r"||pe.key==="R")&&nt()};return window.addEventListener("keydown",me),()=>window.removeEventListener("keydown",me)},[]);const Xe=(me,pe)=>{const Te=Date.now();if(O>0){const Ae=Te-O,Pe=y.current;if(Pe&&Ae<oe){const De=Pe.getPointerPosition();Math.sqrt(Math.pow(De.x-K.x,2)+Math.pow(De.y-K.y,2))<X&&!N&&(me.cancelBubble=!0,he(pe.id,me.evt))}}},Ze=(me,pe)=>{me.cancelBubble=!0,i(pe.id)},Ie=me=>{const pe=Date.now();if(!N&&O>0){const Te=pe-O,Ae=y.current;if(Ae&&Te<oe){const Pe=Ae.getPointerPosition();Math.sqrt(Math.pow(Pe.x-K.x,2)+Math.pow(Pe.y-K.y,2))<X&&me.target===me.target.getStage()&&n("")}}};if(!e)return E.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"No package loaded. Please import a CSV file."});if(S.width<=0||S.height<=0)return E.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"Loading canvas..."});const Ct=`View: ${o?"TOP":"BOTTOM"} | Rotation: ${s} | Zoom: ${Math.round(a*100)}%`,Lr=e?`${e.device}pkg.csv (${e.packageType})`:"No package loaded";return E.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column"},children:[E.jsx(tj,{fileName:Lr,viewInfo:Ct}),E.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[E.jsx("div",{style:{position:"absolute",top:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Te,minRow:Ae,maxRow:Pe}=ue;if(!me)return null;const De=[];if(s===0||s===180)for(let ve=pe;ve<=Te;ve++){const q=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===ve);if(!q)continue;const Fe={left:z(q).x-10,top:-5};Fe.left>=-50&&Fe.left<=S.width+50&&De.push(E.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ve},`top-col-${ve}`))}else for(let ve=Ae;ve<=Pe;ve++){const q=cl(ve),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===q);if(!Ee)continue;const Ce={left:z(Ee).x-10,top:-5};Ce.left>=-50&&Ce.left<=S.width+50&&De.push(E.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:q},`top-row-${ve}`))}return De})()}),E.jsx("div",{style:{position:"absolute",top:16,right:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Te,minRow:Ae,maxRow:Pe}=ue;if(!me)return null;const De=[];if(s===0||s===180)for(let ve=Ae;ve<=Pe;ve++){const q=cl(ve),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===q);if(!Ee)continue;const Ce={left:-5,top:z(Ee).y-8};Ce.top>=-50&&Ce.top<=S.height+50&&De.push(E.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:q},`right-row-${ve}`))}else for(let ve=pe;ve<=Te;ve++){const q=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===ve);if(!q)continue;const Fe={left:-5,top:z(q).y-8};Fe.top>=-50&&Fe.top<=S.height+50&&De.push(E.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ve},`right-col-${ve}`))}return De})()}),E.jsx("div",{style:{position:"absolute",bottom:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Te,minRow:Ae,maxRow:Pe}=ue;if(!me)return null;const De=[];if(s===0||s===180)for(let ve=pe;ve<=Te;ve++){const q=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===ve);if(!q)continue;const Fe={left:z(q).x-10,top:-5};Fe.left>=-50&&Fe.left<=S.width+50&&De.push(E.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ve},`bottom-col-${ve}`))}else for(let ve=Ae;ve<=Pe;ve++){const q=cl(ve),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===q);if(!Ee)continue;const Ce={left:z(Ee).x-10,top:-5};Ce.left>=-50&&Ce.left<=S.width+50&&De.push(E.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:q},`bottom-row-${ve}`))}return De})()}),E.jsx("div",{style:{position:"absolute",top:16,left:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Te,minRow:Ae,maxRow:Pe}=ue;if(!me)return null;const De=[];if(s===0||s===180)for(let ve=Ae;ve<=Pe;ve++){const q=cl(ve),Ee=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===q);if(!Ee)continue;const Ce={left:-5,top:z(Ee).y-8};Ce.top>=-50&&Ce.top<=S.height+50&&De.push(E.jsx("div",{style:{position:"absolute",...Ce,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:q},`left-row-${ve}`))}else for(let ve=pe;ve<=Te;ve++){const q=t.find(Ce=>Ce.gridPosition&&Ce.gridPosition.col===ve);if(!q)continue;const Fe={left:-5,top:z(q).y-8};Fe.top>=-50&&Fe.top<=S.height+50&&De.push(E.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ve},`left-col-${ve}`))}return De})()}),E.jsx("div",{style:{position:"absolute",top:16,left:16,right:16,bottom:16,overflow:"hidden"},children:E.jsx($B,{ref:me=>{y.current=me},width:window.innerWidth,height:window.innerHeight,x:0,y:0,onClick:Ie,onWheel:de,onMouseDown:xe,onMouseMove:Me,onMouseUp:G,onMouseLeave:tt,style:{cursor:N?"grabbing":"grab"},children:E.jsxs(WB,{children:[(()=>{const{gridSpacing:me,minRow:pe,maxRow:Te,minCol:Ae,maxCol:Pe}=ue;if(!me)return null;const De=(Ce,Qe)=>z({position:{x:Ce,y:Qe}}),Ve=0,ve=De((Ae-1.5)*me-Ve,(pe-.5)*me-Ve),q=De((Pe+.5)*me+Ve,(pe-.5)*me-Ve),Ee=De((Ae-1.5)*me-Ve,(Te+.5)*me+Ve),Fe=De((Pe+.5)*me+Ve,(Te+.5)*me+Ve);return E.jsx(E.Fragment,{children:E.jsx(w5,{points:[ve.x,ve.y,q.x,q.y,Fe.x,Fe.y,Ee.x,Ee.y,ve.x,ve.y],stroke:"#555",strokeWidth:2,dash:[5,5],closed:!0,fill:"rgba(40, 40, 40, 0.3)"})})})(),!1,(()=>{zr.startRenderMeasurement("pin-rendering");const pe=Math.max(20,88*A.scale),Te=A.scale>=.7,Ae=Gn.shouldRenderText(A.scale,"pin"),Pe=Gn.shouldRenderText(A.scale,"signal"),De=Gn.getAdaptiveTextSize(A.scale,12)/12,Ve=we,ve=zr.endRenderMeasurement("pin-rendering");return console.log(` Smart culling: Rendering ${Ve.length}/${t.length} pins (${ve.toFixed(2)}ms)`),Ve.map(q=>{var qe,Ge,Je,ut,Pt,Dt,kn,tn;const Ee=z(q),Fe=r&&r.has?r.has(q.id):!1,Ce=_e(q),Qe=M(q),et=A.scale*10*De,lt=Math.max(8,Math.min(20,et)),Ye=Math.max(6,Math.min(16,A.scale*8*De)),xt=J(q,we,r),si=Q(q,t),be=Te||Fe;return E.jsxs(Xc,{children:[E.jsx(Cn,{x:Ee.x-pe/2,y:Ee.y-pe/2,width:pe,height:pe,fill:Ce,stroke:"#000",strokeWidth:1,cornerRadius:4,onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"}}),xt&&E.jsx(Cn,{x:Ee.x-pe/2-2,y:Ee.y-pe/2-2,width:pe+4,height:pe+4,fill:"transparent",stroke:xt,strokeWidth:2,cornerRadius:6,listening:!1}),E.jsx(Kc,{x:Ee.x,y:Ee.y,radius:Math.max(8,pe*.3),fill:Qe,stroke:"#000",strokeWidth:1,listening:!1}),si&&!xt&&pe>40&&E.jsx(Kc,{x:Ee.x+pe*.3,y:Ee.y-pe*.3,radius:3,fill:"#FF6600",stroke:"#FFF",strokeWidth:1,listening:!1}),xt&&E.jsx(Kc,{x:Ee.x,y:Ee.y,radius:Math.max(10,pe*.4),fill:"transparent",stroke:xt,strokeWidth:3,listening:!1,dash:[5,5]}),E.jsx(Cn,{x:Ee.x-q.pinNumber.length*lt/4-2,y:Ee.y-lt/2-2,width:q.pinNumber.length*lt/2+4,height:lt+4,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:Ee.x,y:Ee.y-lt/2,text:q.pinNumber,fontSize:lt,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"},fontStyle:"bold",offsetX:q.pinNumber.length*lt/4,listening:!1}),q.pinName&&be&&Ae&&pe>50&&E.jsxs(E.Fragment,{children:[E.jsx(Cn,{x:Ee.x-(q.pinName.length>14?17:q.pinName.length)*Ye/4-2,y:Ee.y+lt/2+1,width:(q.pinName.length>14?17:q.pinName.length)*Ye/2+4,height:Ye+4,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3,text:q.pinName.length>14?q.pinName.substring(0,14)+"...":q.pinName,fontSize:Ye,fill:"#E0E0E0",align:"center",onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"},offsetX:(q.pinName.length>14?17:q.pinName.length)*Ye/4,listening:!1})]}),q.signalName&&q.signalName.trim()!==""&&Pe&&E.jsxs(E.Fragment,{children:[E.jsx(Cn,{x:Ee.x-(q.signalName.length>12?15:q.signalName.length)*Ye*.35-6,y:Ee.y+lt/2+3+Ye-1,width:(q.signalName.length>12?15:q.signalName.length)*Ye*.7+12,height:Ye+6,fill:"rgba(255, 215, 0, 0.9)",cornerRadius:3,listening:!1}),E.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+Ye+2,text:q.signalName.length>12?q.signalName.substring(0,12)+"...":q.signalName,fontSize:Ye,fill:"#000",align:"center",onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(q.signalName.length>12?15:q.signalName.length)*Ye/4,listening:!1})]}),!["POWER","GROUND","NC"].includes(q.pinType)&&Pe&&pe>40&&E.jsxs(E.Fragment,{children:[q.direction&&q.direction.trim()!==""&&E.jsxs(E.Fragment,{children:[E.jsx(Cn,{x:Ee.x-q.direction.length*(Ye*.6)/2-4,y:Ee.y+lt/2+3+(q.signalName?Ye*2+6:Ye+4),width:q.direction.length*(Ye*.6)+8,height:Ye+3,fill:"rgba(100, 149, 237, 0.8)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+(q.signalName?Ye*2+8:Ye+6),text:q.direction,fontSize:Ye*.8,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"},fontStyle:"bold",offsetX:q.direction.length*(Ye*.6)/4,listening:!1})]}),(((qe=q.attributes)==null?void 0:qe.IO_Standard)||q.ioType)&&(((Ge=q.attributes)==null?void 0:Ge.IO_Standard)||q.ioType||"").trim()!==""&&E.jsxs(E.Fragment,{children:[E.jsx(Cn,{x:Ee.x-(((Je=q.attributes)==null?void 0:Je.IO_Standard)||q.ioType||"AUTO").length*(Ye*.5)/2-3,y:Ee.y+lt/2+3+(q.signalName?q.direction&&q.direction.trim()!==""?Ye*3+12:Ye*2+6:q.direction&&q.direction.trim()!==""?Ye*2+8:Ye+4),width:(((ut=q.attributes)==null?void 0:ut.IO_Standard)||q.ioType||"AUTO").length*(Ye*.5)+6,height:Ye*.9+2,fill:"rgba(76, 175, 80, 0.8)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:Ee.x,y:Ee.y+lt/2+3+(q.signalName?q.direction&&q.direction.trim()!==""?Ye*3+13:Ye*2+7:q.direction&&q.direction.trim()!==""?Ye*2+9:Ye+5),text:(((Pt=q.attributes)==null?void 0:Pt.IO_Standard)||q.ioType||"AUTO").length>8?(((Dt=q.attributes)==null?void 0:Dt.IO_Standard)||q.ioType||"AUTO").substring(0,8)+"...":((kn=q.attributes)==null?void 0:kn.IO_Standard)||q.ioType||"AUTO",fontSize:Ye*.7,fill:"#FFF",align:"center",onClick:mt=>Xe(mt,q),onDblClick:mt=>Ze(mt,q),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(((tn=q.attributes)==null?void 0:tn.IO_Standard)||q.ioType||"AUTO").length*(Ye*.5)/4,listening:!1})]})]})]},q.id)})})(),Gn.shouldRenderDifferentialPairs(A.scale)&&(()=>{zr.startRenderMeasurement("diff-pair-lines");const me=[],pe=new Set;we.forEach(Ae=>{if(!pe.has(Ae.id)&&Ht&&typeof Ht.isDifferentialPin=="function"&&Ht.isDifferentialPin(Ae)){const Pe=Ht.findPairPin&&Ht.findPairPin(Ae,t),De=Pe&&we.includes(Pe),Ve=r.has(Ae.id)||Pe&&r.has(Pe.id);if(Pe&&!pe.has(Pe.id)&&(De||Ve)){pe.add(Ae.id),pe.add(Pe.id);const ve=z(Ae),q=z(Pe),Ee=J(Ae,we,r),Fe=J(Pe,we,r),Ce=Ee||Fe||"#FF6600",Qe=Math.sqrt(Math.pow(q.x-ve.x,2)+Math.pow(q.y-ve.y,2));if(Qe>50&&me.push(E.jsx(w5,{points:[ve.x,ve.y,q.x,q.y],stroke:Ce,strokeWidth:2,opacity:.6,dash:[8,4],listening:!1},`diff-pair-${Ae.id}-${Pe.id}`)),Qe>100&&A.scale>.4){const et=(ve.x+q.x)/2,lt=(ve.y+q.y)/2,xt=Ht.getDifferentialPairType(Ae.pinName)==="positive"?"+/-":"-/+";me.push(E.jsxs(Xc,{children:[E.jsx(Cn,{x:et-10,y:lt-8,width:20,height:16,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:et,y:lt-6,text:xt,fontSize:10,fill:Ce,align:"center",offsetX:10,listening:!1})]},`diff-label-${Ae.id}-${Pe.id}`))}}}});const Te=zr.endRenderMeasurement("diff-pair-lines");return console.log(` Differential pairs: ${me.length} lines (${Te.toFixed(2)}ms)`),me})(),Gn.shouldRenderAtLOD(re,2)&&(()=>{zr.startRenderMeasurement("bank-boundaries");const me=new Map;we.forEach(ve=>{const q=ve.bank||"NA";me.has(q)||me.set(q,[]),me.get(q).push(ve)});const Te=Math.max(20,88*A.scale),Ae=6,Pe=new Map;Array.from(me.entries()).forEach(([ve,q])=>{if(ve==="NA"||q.length<2)return;const Ee=q.map(Ce=>z(Ce)),Fe={minX:Math.min(...Ee.map(Ce=>Ce.x))-Te/2-Ae,maxX:Math.max(...Ee.map(Ce=>Ce.x))+Te/2+Ae,minY:Math.min(...Ee.map(Ce=>Ce.y))-Te/2-Ae,maxY:Math.max(...Ee.map(Ce=>Ce.y))+Te/2+Ae,bankKey:ve,pins:q};Pe.set(ve,Fe)});const De=Array.from(Pe.entries()).map(([ve,q])=>{const Ee=_e(q.pins[0]);return E.jsx(Cn,{x:q.minX,y:q.minY,width:q.maxX-q.minX,height:q.maxY-q.minY,fill:`${Ee}10`,stroke:"transparent",cornerRadius:6,opacity:.3,listening:!1},`bank-boundary-${ve}`)}),Ve=zr.endRenderMeasurement("bank-boundaries");return console.log(` Bank boundaries: ${Pe.size} boundaries (${Ve.toFixed(2)}ms)`),De})(),(()=>{const pe=Math.max(20,88*A.scale);return t.filter(Te=>r&&r.has?r.has(Te.id):!1).map(Te=>{const Ae=z(Te);return E.jsx(Cn,{x:Ae.x-pe/2-2,y:Ae.y-pe/2-2,width:pe+4,height:pe+4,fill:"transparent",stroke:"#FFD700",strokeWidth:3,cornerRadius:4,onClick:Pe=>Xe(Pe,Te),onDblClick:Pe=>Ze(Pe,Te),style:{cursor:"pointer"}},`highlight-${Te.id}`)})})(),E.jsxs(Xc,{x:10,y:30,children:[(()=>{const me="Bank Groups";return E.jsxs(E.Fragment,{children:[E.jsx(Cn,{x:24,y:-2,width:me.length*6+8,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2,onClick:()=>{console.log(" Bank Groups header clicked - showing all banks!"),m()},onMouseEnter:pe=>{var Ae;const Te=pe.target;Te.fill("rgba(0, 0, 0, 0.9)"),(Ae=Te.getLayer())==null||Ae.batchDraw()},onMouseLeave:pe=>{var Ae;const Te=pe.target;Te.fill("rgba(0, 0, 0, 0.85)"),(Ae=Te.getLayer())==null||Ae.batchDraw()},style:{cursor:"pointer"}}),E.jsx(vi,{x:27,y:0,text:me,fontSize:12,fill:"#4AE24A",onClick:()=>{console.log(" Bank Groups text clicked - showing all banks!"),m()},onMouseEnter:pe=>{var Ae;const Te=pe.target;Te.fill("#fff"),(Ae=Te.getLayer())==null||Ae.batchDraw()},onMouseLeave:pe=>{var Ae;const Te=pe.target;Te.fill("#4AE24A"),(Ae=Te.getLayer())==null||Ae.batchDraw()},style:{cursor:"pointer"}})]})})(),(()=>[...new Set(we.map(pe=>pe.bank).filter(Boolean))].sort((pe,Te)=>{const Ae=parseInt(pe),Pe=parseInt(Te);return Ae-Pe}).map((pe,Te)=>{const Ae=g&&g.size!==void 0?g.size===0||g.has(pe):!0;return E.jsxs(Xc,{y:20+Te*18,x:27,children:[E.jsx(Cn,{x:8,y:-8,width:`Bank ${pe}`.length*6+20,height:16,fill:"rgba(0, 0, 0, 0)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:1,cornerRadius:2,onClick:()=>{console.log(` BANK ${pe} CLICKED!`),console.log("Before: visibleBanks =",Array.from(g)),console.log(`Before: Bank ${pe} is visible =`,g.has(pe)),console.log("Before: Total pins received =",t.length),v(pe)},onMouseEnter:Pe=>{var Ve;const De=Pe.target;De.stroke("rgba(255, 255, 255, 0.3)"),(Ve=De.getLayer())==null||Ve.batchDraw()},onMouseLeave:Pe=>{var Ve;const De=Pe.target;De.stroke("rgba(255, 255, 255, 0.1)"),(Ve=De.getLayer())==null||Ve.batchDraw()},style:{cursor:"pointer"}}),E.jsx(Kc,{x:12,y:2,radius:4,fill:Ae?go(pe):"#444",stroke:Ae?"#000":"#666",strokeWidth:1,listening:!1}),E.jsx(Cn,{x:23,y:-8,width:`Bank ${pe}`.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),E.jsx(vi,{x:25,y:-6,text:`Bank ${pe}`,fontSize:10,fill:Ae?"#ccc":"#666",listening:!1}),E.jsx(vi,{x:10,y:-6,text:Ae?"":"",fontSize:8,listening:!1})]},pe)}))(),E.jsx(Cn,{x:117,y:-2,width:130,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2}),E.jsx(vi,{x:120,y:0,text:"Pin Types (Circle):",fontSize:12,fill:"#ccc"}),(()=>{const me=[...new Set(t.map(Te=>Te.pinType).filter(Boolean))].sort(),pe={IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999",MIO:"#32CD32",DDR:"#8A2BE2"};return me.map((Te,Ae)=>E.jsxs(Xc,{y:20+Ae*18,x:120,children:[E.jsx(Kc,{x:12,y:2,radius:4,fill:pe[Te]||"#666666",stroke:"#000",strokeWidth:1}),E.jsx(vi,{x:25,y:-6,text:Te,fontSize:10,fill:"#999"}),E.jsx(Cn,{x:23,y:-8,width:Te.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2}),E.jsx(vi,{x:25,y:-6,text:Te,fontSize:10,fill:"#ccc"})]},Te))})()]})]})})})]})]})},nj=()=>{const e=Se.useRef(null),[t,r]=Se.useState(!1),[n,i]=Se.useState(""),{package:a,pins:s,selectedPins:o,viewConfig:u,loadProject:f}=Yi(),d=()=>({package:a,pins:s,selectedPins:o,viewConfig:u,listView:{activeTab:"overview"},ui:{sidebarWidth:300,showDifferentialPairs:!1},filters:{},history:{currentIndex:0,actions:[]},projectSettings:{}}),p=(w,x=3e3)=>{i(w),setTimeout(()=>i(""),x)},g=()=>typeof window.vscode<"u",v=async()=>{try{if(r(!0),!a||s.length===0)throw new Error("No project data to save");const w=d(),x=hn.createSaveData(w);if(g())try{const T=window.vscode,A=x.package.device.replace(/[^a-zA-Z0-9]/g,"_"),F=new Date().toISOString().split("T")[0],N=`${A}_project_${F}.fpgaproj`,P=await new Promise((I,b)=>{const O=setTimeout(()=>{window.removeEventListener("message",L),b(new Error("Save dialog timeout"))},3e4),L=ie=>{ie.data.command==="saveDialogResult"&&(clearTimeout(O),window.removeEventListener("message",L),I(ie.data.result))};window.addEventListener("message",L);const K={command:"showSaveDialog",options:{saveLabel:"Save FPGA Project",filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}};try{T.postMessage(K)}catch(ie){console.error("Failed to send message to VS Code:",ie),b(ie)}});if(P){let I;if(typeof P=="string")I=P;else if(P&&typeof P=="object"){const L=P;I=L.fsPath||L.path,!I&&typeof P.toString=="function"&&(I=P.toString())}if(!I)throw new Error("Failed to extract file path from URI");const b=JSON.stringify(x,null,2);if(await new Promise(L=>{const K=ie=>{ie.data.command==="saveFileResult"&&(window.removeEventListener("message",K),L(ie.data.success))};window.addEventListener("message",K),T.postMessage({command:"saveFile",filePath:I,content:b,filename:N})}))p(" Project saved successfully!");else throw new Error("File save operation failed")}else return}catch(T){console.error("VS Code save failed:",T),await hn.saveToFile(x),p(" Project saved successfully!")}else await hn.saveToFile(x),p(" Project saved successfully!")}catch(w){console.error("Save failed:",w),p(` Save failed: ${w}`,5e3)}finally{r(!1)}},m=async w=>{var x;if(console.log(" handleLoad called, isInVSCode:",g()),g())try{r(!0);const T=window.vscode;console.log(" Sending showOpenDialog message to VS Code"),T.postMessage({command:"showOpenDialog",options:{openLabel:"Open FPGA Project",canSelectFiles:!0,canSelectMany:!1,filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}}),console.log(" Message sent to VS Code extension"),setTimeout(()=>{r(!1)},1e3)}catch(T){console.error("VS Code open failed:",T),p(` Open failed: ${T}`,5e3),r(!1)}else{console.log(" Browser environment - using file input");const T=(x=w==null?void 0:w.target.files)==null?void 0:x[0];if(!T)return;try{r(!0);const A=await hn.loadFromFile(T),F=hn.restoreProject(A);f(F),p(` Project loaded: ${A.metadata.description}`),w&&(w.target.value="")}catch(A){console.error("Load failed:",A),p(` Load failed: ${A}`,5e3)}finally{r(!1)}}},y=()=>{try{if(!a||s.length===0)throw new Error("No project data to save");const w=d();hn.quickSave(w),p(" Quick save completed")}catch(w){console.error("Quick save failed:",w),p(` Quick save failed: ${w}`,5e3)}},C=async()=>{try{const w=hn.quickLoad();if(!w){p(" No quick save found");return}const x=hn.restoreProject(w);f(x),p(" Quick save loaded")}catch(w){console.error("Quick load failed:",w),p(` Quick load failed: ${w}`,5e3)}},S=hn.getQuickSaveInfo();return kr.useEffect(()=>{const w=x=>{var T;if(x.ctrlKey||x.metaKey)switch(x.key.toLowerCase()){case"s":x.preventDefault(),a&&s.length>0&&y();break;case"l":x.preventDefault(),S.exists?C():(T=e.current)==null||T.click();break}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[a,s.length,S.exists]),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",position:"relative"},children:[E.jsx("button",{onClick:v,disabled:t||!a||s.length===0,title:"Save Project ()",style:{padding:"6px 8px",backgroundColor:"#00a8ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t||!a||s.length===0?.5:1},children:""}),E.jsx("button",{onClick:()=>{var w;g()?m():(w=e.current)==null||w.click()},disabled:t,title:"Load Project ()",style:{padding:"6px 8px",backgroundColor:"#ffa500",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t?.5:1},children:""}),E.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:m,style:{display:"none"}}),E.jsx("button",{onClick:y,disabled:t||!a||s.length===0,title:"Quick Save (Ctrl+S)",style:{padding:"6px 8px",backgroundColor:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",opacity:t||!a||s.length===0?.5:1},children:""}),n&&E.jsx("div",{style:{position:"absolute",top:"40px",right:"0",padding:"8px 12px",backgroundColor:n.includes("")?"#dc3545":"#28a745",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:n}),!g()&&E.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:m,style:{display:"none"}})]})},ij=({className:e=""})=>{const{canUndo:t,canRedo:r,currentActionDescription:n,nextRedoActionDescription:i,undo:a,redo:s}=Yi(),o=u=>({padding:"6px",backgroundColor:u?"#333":"#222",border:"1px solid #555",borderRadius:"4px",color:u?"#ccc":"#666",cursor:u?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",transition:"background-color 0.2s"});return E.jsxs("div",{className:`flex flex-row items-center ${e}`,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[E.jsx("button",{onClick:a,disabled:!t,title:`Undo${n?`: ${n}`:""} (Ctrl+Z)`,style:{...o(t),borderRadius:"4px 0 0 4px",borderRight:"none"},onMouseEnter:u=>{t&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{t&&(u.currentTarget.style.backgroundColor="#333")},children:E.jsx(aj,{className:"w-3 h-3"})}),E.jsx("button",{onClick:s,disabled:!r,title:`Redo${i?`: ${i}`:""} (Ctrl+Y)`,style:{...o(r),borderRadius:"0 4px 4px 0"},onMouseEnter:u=>{r&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{r&&(u.currentTarget.style.backgroundColor="#333")},children:E.jsx(sj,{className:"w-3 h-3"})})]})},aj=({className:e})=>E.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[E.jsx("path",{d:"M3 7v6h6"}),E.jsx("path",{d:"m21 17a9 9 0 00-9-9 9 9 0 00-6 2.3l-3 3"})]}),sj=({className:e})=>E.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[E.jsx("path",{d:"M21 7v6h-6"}),E.jsx("path",{d:"m3 17a9 9 0 019-9 9 9 0 016 2.3l3 3"})]}),oj=({isOpen:e,onClose:t})=>{if(!e)return null;const r=[{key:"Ctrl+Z",description:"Undo"},{key:"Ctrl+Y",description:"Redo"},{key:"Ctrl+O",description:"Open CSV file"},{key:"Ctrl+S",description:"Save project"},{key:"Ctrl+E",description:"Export XDC file"},{key:"Ctrl+F",description:"Focus search field"},{key:"Click",description:"Select pin"},{key:"Ctrl+Click",description:"Toggle pin selection"},{key:"Shift+Click",description:"Range select pins"},{key:"Ctrl+A",description:"Select all pins"},{key:"Ctrl+D",description:"Deselect all"},{key:"Space",description:"Rotate view 90 degrees"},{key:"F",description:"Toggle top/bottom view"},{key:"R",description:"Reset zoom and pan"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"Escape",description:"Deselect all"},{key:"Delete",description:"Unassign selected pins"}];return E.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:E.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-hidden flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Keyboard Shortcuts"}),E.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-xl",children:""})]}),E.jsx("div",{className:"flex-1 overflow-y-auto",children:E.jsx("div",{className:"space-y-1",children:r.map((n,i)=>E.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-50",children:[E.jsx("span",{className:"text-sm text-gray-600",children:n.description}),E.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-gray-100 rounded border",children:n.key})]},i))})}),E.jsx("div",{className:"mt-4 pt-4 border-t",children:E.jsx("button",{onClick:t,className:"w-full py-2 px-4 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Close"})})]})})},lj=({validationResult:e,onIssueClick:t,onPinHighlight:r,className:n=""})=>{const[i,a]=Se.useState(!0),[s,o]=Se.useState("all"),[u,f]=Se.useState("all"),d=m=>{switch(m){case"pin_conflict":return"Pin Conflict";case"differential_pair":return"Differential Pair";case"bank_constraint":return"Bank Constraint";case"clock_constraint":return"Clock Constraint";default:return m}},p=(e==null?void 0:e.issues.filter(m=>{const y=s==="all"||m.severity===s,C=u==="all"||m.type===u;return y&&C}))||[],g=m=>{t==null||t(m),r==null||r(m.affectedPins)},v=m=>{switch(m){case"error":return"";case"warning":return"";case"info":return""}};return e?E.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[E.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),E.jsx("button",{onClick:()=>a(!i),className:"text-gray-500 hover:text-gray-700",children:i?"":""})]})}),E.jsx("div",{className:"flex-1 overflow-y-auto right-sidebar-scroll",children:i&&E.jsxs("div",{className:"p-4",children:[E.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.summary.errorCount}),E.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.summary.warningCount}),E.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.summary.infoCount}),E.jsx("div",{className:"text-xs text-gray-500",children:"Info"})]})]}),E.jsxs("div",{className:"space-y-2",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Severity"}),E.jsxs("select",{value:s,onChange:m=>o(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsxs("option",{value:"all",children:["All Issues (",e.issues.length,")"]}),E.jsxs("option",{value:"error",children:["Errors (",e.summary.errorCount,")"]}),E.jsxs("option",{value:"warning",children:["Warnings (",e.summary.warningCount,")"]}),E.jsxs("option",{value:"info",children:["Info (",e.summary.infoCount,")"]})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Type"}),E.jsxs("select",{value:u,onChange:m=>f(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"all",children:"All Types"}),Array.from(new Set(e.issues.map(m=>m.type))).map(m=>E.jsx("option",{value:m,children:d(m)},m))]})]})]}),E.jsx("div",{className:"mt-4 space-y-2 max-h-64 overflow-y-auto right-sidebar-scroll",children:p.map((m,y)=>E.jsxs("div",{onClick:()=>g(m),className:`p-3 rounded-lg cursor-pointer transition-colors ${m.severity==="error"?"bg-red-50 border border-red-200 hover:bg-red-100":m.severity==="warning"?"bg-yellow-50 border border-yellow-200 hover:bg-yellow-100":"bg-blue-50 border border-blue-200 hover:bg-blue-100"}`,children:[E.jsxs("div",{className:"flex items-start justify-between mb-1",children:[E.jsx("span",{className:"text-sm",children:v(m.severity)}),E.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded",children:d(m.type)})]}),E.jsx("p",{className:"text-xs mb-2 line-clamp-2",children:m.description}),m.affectedPins.length>0&&E.jsxs("div",{className:"text-xs mb-2",children:[E.jsx("span",{className:"font-medium",children:"Affected pins: "}),E.jsxs("span",{className:"font-mono",children:[m.affectedPins.slice(0,3).join(", "),m.affectedPins.length>3&&` +${m.affectedPins.length-3} more`]})]}),m.suggestion&&E.jsxs("div",{className:"text-xs mt-2 p-2 bg-white bg-opacity-50 rounded",children:[E.jsx("span",{className:"font-medium",children:" Suggestion: "}),m.suggestion]})]},y))})]})}),E.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-3 bg-white",children:E.jsx("div",{className:"text-xs text-gray-500 text-center",children:(e==null?void 0:e.lastChecked)&&E.jsxs(E.Fragment,{children:["Last checked: ",new Date(e.lastChecked).toLocaleTimeString()]})})})]}):E.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[E.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),E.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No validation data available"})]}),E.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"text-4xl mb-2",children:""}),E.jsx("div",{className:"text-sm",children:"Run validation to see results"})]})})]})},cj=({validationResult:e,className:t=""})=>{if(!e)return E.jsx("div",{className:`inline-flex items-center text-gray-400 ${t}`,children:E.jsx("span",{className:"text-sm",children:""})});const{summary:r}=e;return r.errorCount>0?E.jsxs("div",{className:`inline-flex items-center text-red-600 ${t}`,children:[E.jsx("span",{className:"text-sm",children:""}),E.jsx("span",{className:"ml-1 text-xs font-bold",children:r.errorCount})]}):r.warningCount>0?E.jsxs("div",{className:`inline-flex items-center text-yellow-600 ${t}`,children:[E.jsx("span",{className:"text-sm",children:""}),E.jsx("span",{className:"ml-1 text-xs font-bold",children:r.warningCount})]}):E.jsx("div",{className:`inline-flex items-center text-green-600 ${t}`,children:E.jsx("span",{className:"text-sm",children:""})})};class Qc{static assignArrayPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(r.startIndex>r.endIndex)throw new Error("Start index must be less than or equal to end index");const i=[];for(let s=r.startIndex;s<=r.endIndex;s+=r.step){const o=r.padding>0?s.toString().padStart(r.padding,"0"):s.toString(),u=r.indexFormat.replace("{i}",o).replace("{index}",o);i.push(r.baseName+u)}const a=Math.min(t.length,i.length);for(let s=0;s<a;s++){const o=t[s],u=i[s];if(o.pinType&&["POWER","GROUND","NC"].includes(o.pinType)){n.skippedPins++,n.errors.push(`Skipped ${o.pinNumber}: Cannot assign to ${o.pinType} pin`);continue}n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:u}),n.processedPins++}}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static assignDifferentialPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(!r.positiveFormat||!r.negativeFormat)throw new Error("Both positive and negative formats are required");t.length%2!==0&&n.errors.push(`Warning: Odd number of pins (${t.length}). Last pin will be skipped.`);const i=Math.floor(t.length/2);for(let a=0;a<i;a++){const s=t[a*2],o=t[a*2+1],u=s.pinType&&["POWER","GROUND","NC"].includes(s.pinType),f=o.pinType&&["POWER","GROUND","NC"].includes(o.pinType);if(u||f){n.skippedPins+=2,n.errors.push(`Skipped pair ${s.pinNumber}/${o.pinNumber}: Cannot assign to ${s.pinType}/${o.pinType} pins`);continue}let d=r.baseName;if(r.indexFormat&&r.startIndex!==void 0){const v=(r.startIndex||0)+a,m=r.padding&&r.padding>0?v.toString().padStart(r.padding,"0"):v.toString();d=r.indexFormat.replace("{i}",m).replace("{index}",m),d=r.baseName+d}const p=d+r.positiveFormat,g=d+r.negativeFormat;n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:s.signalName,newSignal:p}),n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:g}),n.processedPins+=2}t.length%2!==0&&n.skippedPins++}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static filterPinsByCriteria(t,r){return t.filter(n=>{if(r.pinTypes&&r.pinTypes.length>0&&(!n.pinType||!r.pinTypes.includes(n.pinType))||r.banks&&r.banks.length>0&&(!n.bank||!r.banks.includes(n.bank))||r.voltages&&r.voltages.length>0&&(!n.voltage||!r.voltages.includes(n.voltage)))return!1;if(r.assignmentStatus){const i=n.signalName&&n.signalName.trim()!=="";if(r.assignmentStatus==="assigned"&&!i||r.assignmentStatus==="unassigned"&&i)return!1}if(r.pinNumberPattern)try{if(!new RegExp(r.pinNumberPattern).test(n.pinNumber))return!1}catch{}if(r.gridRange&&n.gridPosition){const{rowStart:i,rowEnd:a,colStart:s,colEnd:o}=r.gridRange;if(i&&n.gridPosition.row<i||a&&n.gridPosition.row>a||s&&n.gridPosition.col<s||o&&n.gridPosition.col>o)return!1}return!0})}static clearSignals(t){const r={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{for(const n of t)n.signalName&&n.signalName.trim()!==""?(r.assignments.push({pinId:n.id,pinNumber:n.pinNumber,oldSignal:n.signalName,newSignal:""}),r.processedPins++):r.skippedPins++}catch(n){r.success=!1,r.errors.push(n instanceof Error?n.message:"Unknown error occurred")}return r}static validateBatchOperation(t,r){const n=[];if(t.length===0)return n.push("No pins selected for batch operation"),n;t.length>1e3&&n.push(`Warning: Large dataset (${t.length} pins). Operation may take some time.`);const i=new Set(t.map(a=>a.pinType).filter(Boolean));return i.size>1&&(i.has("POWER")||i.has("GROUND"))&&n.push("Warning: Selection includes power/ground pins which cannot be assigned signals"),r==="differential"&&(t.length<2&&n.push("At least 2 pins required for differential pair assignment"),new Set(t.map(s=>s.bank).filter(Boolean)).size>1&&n.push("Warning: Differential pairs should typically be in the same bank")),n}static previewBatchOperation(t,r,n){try{let i;return n==="array"?i=this.assignArrayPattern(t,r):i=this.assignDifferentialPattern(t,r),i.assignments.map(a=>({pinNumber:a.pinNumber,currentSignal:a.oldSignal||"",newSignal:a.newSignal}))}catch{return[]}}static setVoltageAndIO(t,r){var i,a;const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.voltage&&!r.ioStandard)throw new Error("At least voltage or I/O standard must be specified");r.voltage&&!eu.includes(r.voltage)&&n.errors.push(`Invalid voltage: ${r.voltage}`),r.ioStandard&&!Hd.includes(r.ioStandard)&&r.ioStandard!=="AUTO"&&n.errors.push(`Invalid I/O standard: ${r.ioStandard}`);for(const s of t){if(!["IO","CLOCK"].includes(s.pinType)&&r.voltage){n.skippedPins++;continue}let o=s.voltage,u=((i=s.attributes)==null?void 0:i.IO_Standard)||s.ioType||"AUTO";if(r.voltage&&(o=r.voltage),r.ioStandard)if(r.ioStandard==="AUTO"||r.autoDetectIO)u=Fo(o||"3.3V");else{if(o&&!wI(o,r.ioStandard)){n.errors.push(`I/O standard ${r.ioStandard} is not compatible with voltage ${o} for pin ${s.pinNumber}`),n.skippedPins++;continue}u=r.ioStandard}else r.autoDetectIO&&o&&(u=Fo(o));n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:`${s.voltage||"Unknown"}V / ${((a=s.attributes)==null?void 0:a.IO_Standard)||s.ioType||"Unknown"}`,newSignal:`${o}V / ${u}`}),n.processedPins++}n.processedPins===0&&n.skippedPins>0&&(n.errors.push("No pins were processed. All pins were skipped."),n.success=!1)}catch(s){n.success=!1,n.errors.push(s instanceof Error?s.message:"Unknown error occurred")}return n}static setPinDirections(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!["Input","Output","InOut","Clock","Reset"].includes(r))throw new Error(`Invalid direction: ${r}`);for(const a of t){if(!["IO","CLOCK"].includes(a.pinType)){n.skippedPins++;continue}const s=a.direction||"Unknown";n.assignments.push({pinId:a.id,pinNumber:a.pinNumber,oldSignal:`Direction: ${s}`,newSignal:`Direction: ${r}`}),n.processedPins++}n.processedPins===0&&(n.errors.push("No I/O pins found to update"),n.success=!1)}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}}const uj=({isVisible:e})=>{const{pins:t,selectedPins:r,assignSignal:n}=Yi(),[i,a]=Se.useState("array"),[s,o]=Se.useState("manual"),[u,f]=Se.useState(!1),[d,p]=Se.useState({baseName:"DATA",startIndex:0,endIndex:31,indexFormat:"[{i}]",padding:0,step:1}),[g,v]=Se.useState({voltage:"3.3V",ioStandard:"AUTO",autoDetectIO:!0,driveStrength:12,slewRate:"FAST"}),[m,y]=Se.useState("Input"),[C,S]=Se.useState({pinTypes:["IO"],assignmentStatus:"unassigned"}),[w,x]=Se.useState(null),T=Se.useMemo(()=>s==="manual"?t.filter(P=>r.has(P.id)):Qc.filterPinsByCriteria(t,C),[t,r,s,C]),A=Se.useMemo(()=>i==="clear"?[]:i==="voltage-io"||i==="direction"?T.length===0?["No pins selected"]:[]:T.length===0?["No pins selected"]:[],[T,i]),F=()=>{let P;switch(i){case"array":P=Qc.assignArrayPattern(T,d);break;case"voltage-io":P=Qc.setVoltageAndIO(T,g);break;case"direction":P=Qc.setPinDirections(T,m);break;case"clear":P=Qc.clearSignals(T);break;default:return}const I={...P,errors:P.errors.filter(b=>!b.includes("Need")&&!b.includes("pins, got")&&!b.includes("Not enough pins")&&!b.includes("pins selected"))};x(I),f(!0)},N=()=>{if(!w)return;const P=`Batch ${i} operation on ${w.processedPins} pins`,I=w.assignments.map(b=>({pinId:b.pinId,oldSignal:b.oldSignal||"",newSignal:b.newSignal}));Ar.recordAction("batch_operation",I,P),w.assignments.forEach(b=>{if(i==="voltage-io"){const{updatePin:O}=Yi.getState();O(b.pinId,{voltage:g.voltage,attributes:{IO_Standard:g.ioStandard==="AUTO"?Fo(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"},ioType:g.ioStandard==="AUTO"?Fo(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"})}else if(i==="direction"){const{updatePin:O}=Yi.getState();O(b.pinId,{direction:m})}else n(b.pinId,b.newSignal)}),f(!1),x(null)};return e?E.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[E.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Batch Operations"}),E.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Assign patterns to multiple pins efficiently"})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),E.jsxs("div",{className:"space-y-2",children:[E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"operationType",value:"array",checked:i==="array",onChange:P=>a(P.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:"Array Pattern (DATA[0], DATA[1], ...)"})]}),E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"operationType",value:"voltage-io",checked:i==="voltage-io",onChange:P=>a(P.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:"Voltage & I/O Standards"})]}),E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"operationType",value:"direction",checked:i==="direction",onChange:P=>a(P.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:"Pin Directions"})]}),E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"operationType",value:"clear",checked:i==="clear",onChange:P=>a(P.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:"Clear Signals"})]})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Selection"}),E.jsxs("div",{className:"space-y-2",children:[E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"selectionMode",value:"manual",checked:s==="manual",onChange:P=>o(P.target.value),className:"mr-2"}),E.jsxs("span",{className:"text-sm",children:["Use Selected Pins (",r.size,")"]})]}),E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"selectionMode",value:"criteria",checked:s==="criteria",onChange:P=>o(P.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:"Auto-select by Criteria"})]})]})]}),s==="criteria"&&E.jsxs("div",{className:"space-y-4 p-3 bg-blue-50 rounded-lg",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Types"}),E.jsx("div",{className:"space-x-4",children:["IO","POWER","GROUND","CLOCK"].map(P=>{var I;return E.jsxs("label",{className:"inline-flex items-center",children:[E.jsx("input",{type:"checkbox",checked:(I=C.pinTypes)==null?void 0:I.includes(P),onChange:b=>{b.target.checked?S(O=>({...O,pinTypes:[...O.pinTypes||[],P]})):S(O=>{var L;return{...O,pinTypes:((L=O.pinTypes)==null?void 0:L.filter(K=>K!==P))||[]}})},className:"mr-1"}),E.jsx("span",{className:"text-xs",children:P})]},P)})})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Status"}),E.jsxs("select",{value:C.assignmentStatus,onChange:P=>S(I=>({...I,assignmentStatus:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"any",children:"Any"}),E.jsx("option",{value:"assigned",children:"Assigned"}),E.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),E.jsxs("div",{className:"text-xs text-gray-600",children:["Matches ",T.length," pins"]})]}),i==="array"&&E.jsxs("div",{className:"space-y-3 p-3 bg-green-50 rounded-lg",children:[E.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Array Pattern Configuration"}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Base Name"}),E.jsx("input",{type:"text",value:d.baseName,onChange:P=>p(I=>({...I,baseName:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"DATA"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Index Format"}),E.jsx("input",{type:"text",value:d.indexFormat,onChange:P=>p(I=>({...I,indexFormat:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"[{i}]"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Index"}),E.jsx("input",{type:"number",value:d.startIndex,onChange:P=>p(I=>({...I,startIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Index"}),E.jsx("input",{type:"number",value:d.endIndex,onChange:P=>p(I=>({...I,endIndex:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Step"}),E.jsx("input",{type:"number",value:d.step,onChange:P=>p(I=>({...I,step:parseInt(P.target.value)||1})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"1"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Padding"}),E.jsx("input",{type:"number",value:d.padding,onChange:P=>p(I=>({...I,padding:parseInt(P.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0"})]})]}),E.jsxs("div",{className:"text-xs text-gray-600",children:["Preview: ",d.baseName,d.indexFormat.replace("{i}",d.startIndex.toString().padStart(d.padding,"0"))]})]}),i==="voltage-io"&&E.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded-lg",children:[E.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Voltage & I/O Standard Configuration"}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voltage Level"}),E.jsxs("select",{value:g.voltage||"",onChange:P=>v(I=>({...I,voltage:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"",children:"Keep current"}),eu.map(P=>E.jsx("option",{value:P,children:P},P))]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"I/O Standard"}),E.jsxs("select",{value:g.ioStandard||"",onChange:P=>v(I=>({...I,ioStandard:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"",children:"Keep current"}),E.jsx("option",{value:"AUTO",children:"AUTO (based on voltage)"}),Hd.map(P=>E.jsx("option",{value:P,children:P},P))]})]})]}),E.jsx("div",{className:"flex items-center space-x-4",children:E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"checkbox",checked:g.autoDetectIO||!1,onChange:P=>v(I=>({...I,autoDetectIO:P.target.checked})),className:"mr-2"}),E.jsx("span",{className:"text-xs",children:"Auto-detect I/O standard"})]})}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Drive Strength (mA)"}),E.jsxs("select",{value:g.driveStrength||"",onChange:P=>v(I=>({...I,driveStrength:parseInt(P.target.value)})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"",children:"Keep current"}),E.jsx("option",{value:"2",children:"2 mA"}),E.jsx("option",{value:"4",children:"4 mA"}),E.jsx("option",{value:"6",children:"6 mA"}),E.jsx("option",{value:"8",children:"8 mA"}),E.jsx("option",{value:"12",children:"12 mA"}),E.jsx("option",{value:"16",children:"16 mA"}),E.jsx("option",{value:"20",children:"20 mA"}),E.jsx("option",{value:"24",children:"24 mA"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Slew Rate"}),E.jsxs("select",{value:g.slewRate||"",onChange:P=>v(I=>({...I,slewRate:P.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[E.jsx("option",{value:"",children:"Keep current"}),E.jsx("option",{value:"SLOW",children:"SLOW"}),E.jsx("option",{value:"FAST",children:"FAST"})]})]})]})]}),i==="direction"&&E.jsxs("div",{className:"space-y-3 p-3 bg-orange-50 rounded-lg",children:[E.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Pin Direction Configuration"}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Direction"}),E.jsx("div",{className:"space-y-2",children:["Input","Output","InOut","Clock","Reset"].map(P=>E.jsxs("label",{className:"flex items-center",children:[E.jsx("input",{type:"radio",name:"direction",value:P,checked:m===P,onChange:I=>y(I.target.value),className:"mr-2"}),E.jsx("span",{className:"text-sm",children:P})]},P))})]})]}),E.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg",children:[E.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Target Summary"}),E.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[E.jsxs("div",{children:["Selected pins: ",T.length]}),E.jsxs("div",{children:["Operation: ",i]}),A.length>0&&E.jsxs("div",{className:"text-red-600",children:[E.jsx("div",{className:"font-medium",children:"Validation Issues:"}),E.jsx("ul",{className:"text-xs mt-1 space-y-1",children:A.map((P,I)=>E.jsxs("li",{children:[" ",P]},I))})]})]})]}),E.jsx("div",{children:E.jsx("button",{onClick:F,disabled:T.length===0||A.length>0,className:"w-full py-3 px-4 bg-blue-500 text-black rounded-lg hover:bg-blue-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-blue-600",children:"Generate Preview"})}),u&&w&&E.jsxs("div",{className:"border rounded-lg bg-white",children:[E.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[E.jsx("h4",{className:"font-medium text-gray-800",children:"Preview Results"}),E.jsx("p",{className:"text-sm text-gray-600 mt-1",children:w.success?`${w.processedPins} pins will be assigned`:"Operation preview failed"})]}),w.errors.length>0&&E.jsxs("div",{className:"p-3 bg-red-50 border-b",children:[E.jsx("h5",{className:"text-sm font-medium text-red-800 mb-1",children:"Errors:"}),E.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:w.errors.map((P,I)=>E.jsxs("li",{children:[" ",P]},I))})]}),w.assignments.length>0&&E.jsxs("div",{className:"p-4",children:[E.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Assignments"}),E.jsx("div",{className:"max-h-48 overflow-y-auto border rounded custom-scrollbar",children:E.jsxs("table",{className:"w-full text-sm",children:[E.jsx("thead",{className:"bg-gray-50 sticky top-0",children:E.jsxs("tr",{children:[E.jsx("th",{className:"px-3 py-2 text-left",children:"Pin"}),E.jsx("th",{className:"px-3 py-2 text-left",children:"Current"}),E.jsx("th",{className:"px-3 py-2 text-left",children:"New"})]})}),E.jsxs("tbody",{children:[w.assignments.slice(0,50).map((P,I)=>E.jsxs("tr",{className:"border-t",children:[E.jsx("td",{className:"px-3 py-2 font-mono",children:P.pinNumber}),E.jsx("td",{className:"px-3 py-2 text-gray-600",children:P.oldSignal||"-"}),E.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:P.newSignal})]},I)),w.assignments.length>50&&E.jsx("tr",{children:E.jsxs("td",{colSpan:3,className:"px-3 py-2 text-center text-gray-500 italic",children:["... and ",w.assignments.length-50," more"]})})]})]})})]})]})]}),u&&w&&E.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),E.jsx("button",{onClick:N,disabled:!w.success||w.processedPins===0,className:"flex-1 py-2 px-4 bg-green-500 text-black rounded-lg hover:bg-green-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-green-600",children:"Execute Operation"})]})})]}):null},jl=class{static initialize(){this.isInitialized||(document.addEventListener("keydown",this.handleKeyDown),this.isInitialized=!0)}static cleanup(){document.removeEventListener("keydown",this.handleKeyDown),this.shortcuts.clear(),this.isInitialized=!1}static registerShortcut(t,r){this.shortcuts.set(t.toLowerCase(),r)}static unregisterShortcut(t){this.shortcuts.delete(t.toLowerCase())}static getKeyString(t){const r=[];return t.ctrlKey&&r.push("ctrl"),t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),t.metaKey&&r.push("meta"),r.push(t.key.toLowerCase()),r.join("+")}static getAvailableShortcuts(){return[{key:"ctrl+o",description:"Open CSV file"},{key:"ctrl+s",description:"Save project"},{key:"ctrl+e",description:"Export XDC"},{key:"ctrl+f",description:"Focus search"},{key:"ctrl+a",description:"Select all pins"},{key:"ctrl+d",description:"Deselect all"},{key:"r",description:"Reset zoom and pan"},{key:"space",description:"Rotate view 90"},{key:"f",description:"Flip top/bottom view"},{key:"ctrl+z",description:"Undo"},{key:"ctrl+y",description:"Redo"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"escape",description:"Clear selection"},{key:"delete",description:"Clear selected pin assignments"},{key:"ctrl+shift+?",description:"Show keyboard shortcuts"}]}};jl.shortcuts=new Map;jl.isInitialized=!1;jl.handleKeyDown=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return;const t=jl.getKeyString(e),r=jl.shortcuts.get(t);r&&(e.preventDefault(),r())};let Ut=jl;const fj=()=>{const{undo:e,redo:t,updateUndoRedoState:r}=Yi();Se.useEffect(()=>{Ar.initialize();const n=()=>{r()};return Ar.addListener(n),Ut.initialize(),Ut.registerShortcut("ctrl+z",()=>{e()}),Ut.registerShortcut("ctrl+y",()=>{t()}),Ut.registerShortcut("ctrl+shift+z",()=>{t()}),r(),()=>{Ar.removeListener(n),Ut.unregisterShortcut("ctrl+z"),Ut.unregisterShortcut("ctrl+y"),Ut.unregisterShortcut("ctrl+shift+z")}},[e,t,r])},dj=()=>{const{clearSelection:e,resetZoom:t,rotatePins:r,flipView:n,setZoom:i,viewConfig:a,pins:s,selectPins:o}=Yi();Se.useEffect(()=>(Ut.registerShortcut("escape",()=>{e()}),Ut.registerShortcut("ctrl+a",()=>{o(s.map(u=>u.id))}),Ut.registerShortcut("ctrl+d",()=>{e()}),Ut.registerShortcut("r",()=>{t()}),Ut.registerShortcut("space",()=>{r(90)}),Ut.registerShortcut("f",()=>{n()}),Ut.registerShortcut("+",()=>{const u=Math.min(a.zoom*1.2,5);i(u)}),Ut.registerShortcut("-",()=>{const u=Math.max(a.zoom/1.2,.1);i(u)}),Ut.registerShortcut("0",()=>{i(1)}),Ut.registerShortcut("ctrl+shift+?",()=>{document.dispatchEvent(new CustomEvent("showKeyboardHelp"))}),()=>{Ut.unregisterShortcut("escape"),Ut.unregisterShortcut("ctrl+a"),Ut.unregisterShortcut("ctrl+d"),Ut.unregisterShortcut("r"),Ut.unregisterShortcut("space"),Ut.unregisterShortcut("f"),Ut.unregisterShortcut("+"),Ut.unregisterShortcut("-"),Ut.unregisterShortcut("0"),Ut.unregisterShortcut("ctrl+shift+?")}),[e,t,r,n,i,a.zoom,s,o])},hj=()=>{fj(),dj(),Se.useEffect(()=>()=>{Ut.cleanup()},[])};class ml{static async validateProjectAsync(t,r){return new Promise(n=>{const i=this.validateProject(t,r);n(i)})}static validateProject(t,r){const n=[];n.push(...this.checkPinConflicts(r)),n.push(...this.checkDifferentialPairs(r)),n.push(...this.checkBankConstraints(r));const i=this.calculateSummary(n);return{issues:n,summary:i,lastChecked:Date.now()}}static checkPinConflicts(t){const r=[],n=new Map;return t.forEach(i=>{if(i.signalName&&i.signalName.trim()!==""){const a=i.signalName.trim();if(i.pinType==="POWER"||i.pinType==="GROUND")return;n.has(a)||n.set(a,[]),n.get(a).push(i)}}),n.forEach((i,a)=>{i.length>1&&r.push({id:`conflict_${a}_${Date.now()}`,type:"pin_conflict",severity:"error",title:"Pin Conflict",description:`Signal "${a}" is assigned to ${i.length} pins.`,affectedPins:i.map(s=>s.id),suggestion:"Each signal should be assigned to only one pin.",autoFixable:!1,timestamp:Date.now()})}),r}static checkDifferentialPairs(t){const r=[],n=new Set;return t.forEach(i=>{if(!Ht.isDifferentialPin(i))return;const a=Ht.getDifferentialPairType(i.pinName)||(i.signalName?Ht.getDifferentialPairType(i.signalName):null);if(!a)return;const s=Ht.findPairPin(i,t),o=Ht.getDifferentialBaseName(i.pinName),u=`${i.id}_${(s==null?void 0:s.id)||"missing"}`;if(!n.has(u))if(n.add(u),!s)r.push({id:`diff_pair_incomplete_${i.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Incomplete differential pair: ${o}`,description:`Pin ${i.pinNumber} (${i.pinName}) has no differential pair partner.`,affectedPins:[i.id],suggestion:`Find and assign the ${a==="positive"?"negative":"positive"} side pin in the same bank.`,autoFixable:!1,timestamp:Date.now()});else{i.bank!==s.bank&&r.push({id:`diff_pair_bank_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"error",title:`Differential pair bank mismatch: ${o}`,description:`Differential pair pins are in different banks. Pin ${i.pinNumber} (Bank ${i.bank}) and Pin ${s.pinNumber} (Bank ${s.bank})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be placed in the same bank.",autoFixable:!1,timestamp:Date.now()}),i.voltage!==s.voltage&&r.push({id:`diff_pair_voltage_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Differential pair voltage mismatch: ${o}`,description:`Differential pair pins have different voltages. Pin ${i.pinNumber} (${i.voltage}) and Pin ${s.pinNumber} (${s.voltage})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be set to the same voltage level.",autoFixable:!1,timestamp:Date.now()});const f=i.signalName&&i.signalName.trim()!=="",d=s.signalName&&s.signalName.trim()!=="";if(f&&d){const p=Ht.getPairPinName(i.signalName);p&&p.toLowerCase()!==s.signalName.toLowerCase()&&r.push({id:`diff_pair_signal_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`: ${o}`,description:`"${i.signalName}"  "${s.signalName}"`,affectedPins:[i.id,s.id],suggestion:`: "${i.signalName}"  "${p}"`,autoFixable:!1,timestamp:Date.now()})}else f&&!d&&r.push({id:`diff_pair_incomplete_signal_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"info",title:`: ${o}`,description:` ${i.pinNumber}  "${i.signalName}"  ${s.pinNumber} `,affectedPins:[i.id,s.id],suggestion:"",autoFixable:!1,timestamp:Date.now()})}}),r}static checkBankConstraints(t){const r=[],n=new Map;return t.forEach(i=>{i.bank&&i.signalName&&i.signalName.trim()!==""&&(n.has(i.bank)||n.set(i.bank,[]),n.get(i.bank).push(i))}),n.forEach((i,a)=>{r.push(...this.checkVCCOConsistency(a,i)),r.push(...this.checkIOStandardCompatibility(a,i)),r.push(...this.checkDifferentialPairBankConstraints(a,i)),r.push(...this.checkSpecialPinConstraints(a,i)),r.push(...this.checkHighSpeedSignalConstraints(a,i))}),r}static getIOStandard(t){var r,n,i;return((r=t.attributes)==null?void 0:r.IO_Standard)||((n=t.attributes)==null?void 0:n.io_standard)||((i=t.attributes)==null?void 0:i.iostandard)}static checkVCCOConsistency(t,r){const n=[],i=new Set(r.map(a=>a.voltage).filter(a=>a&&a!==""&&a!=="0V"));return i.size>1&&n.push({id:`bank-vcco-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`VCCO voltage mismatch in Bank ${t}`,description:`Bank ${t} contains pins with different VCCO voltages: ${Array.from(i).join(", ")}. All pins in a bank must share the same VCCO.`,affectedPins:r.map(a=>a.id),suggestion:"Configure all pins in the same bank to use the same VCCO voltage level.",autoFixable:!1,timestamp:Date.now()}),n}static checkIOStandardCompatibility(t,r){const n=[],i=r.map(o=>this.getIOStandard(o)).filter(o=>o&&o!=="");if(i.length===0)return n;const a=[...new Set(i)];if(a.length<=1)return n;const s=[{group1:["LVCMOS33","LVCMOS25","LVCMOS18","LVCMOS15","LVCMOS12"],group2:["LVDS","LVDS_25","BLVDS_25","MLVDS_25"],reason:"Single-ended and differential standards cannot share the same bank"},{group1:["SSTL135","SSTL125","SSTL15"],group2:["POD12","POD10"],reason:"SSTL and POD standards require different reference voltages"},{group1:["HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18"],group2:["LVCMOS33","LVCMOS25"],reason:"HSTL requires center-tap termination, incompatible with LVCMOS"},{group1:["MIPI_DPHY_DCI"],group2:["LVCMOS18","LVCMOS12"],reason:"MIPI DPHY requires dedicated differential signaling"}];for(const o of s){const u=o.group1.some(d=>a.includes(d)),f=o.group2.some(d=>a.includes(d));if(u&&f){const d=r.filter(p=>o.group1.includes(this.getIOStandard(p)||"")||o.group2.includes(this.getIOStandard(p)||""));n.push({id:`bank-iostd-conflict-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`Incompatible I/O standards in Bank ${t}`,description:`${o.reason}. Found: ${a.join(", ")}`,affectedPins:d.map(p=>p.id),suggestion:"Separate incompatible I/O standards into different banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkDifferentialPairBankConstraints(t,r){const n=[],i=new Map;return r.forEach(a=>{if(!a.signalName)return;const s=this.getDifferentialBaseName(a.signalName);s&&(i.has(s)||i.set(s,[]),i.get(s).push(a))}),i.forEach((a,s)=>{if(a.length===2){const[o,u]=a;o.bank!==u.bank&&n.push({id:`diff-pair-bank-cross-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair crosses bank boundary",description:`Differential pair "${s}" has pins in different banks: ${o.pinNumber} (Bank ${o.bank}) and ${u.pinNumber} (Bank ${u.bank})`,affectedPins:[o.id,u.id],suggestion:"Place both pins of a differential pair in the same bank.",autoFixable:!1,timestamp:Date.now()});const f=this.getIOStandard(o),d=this.getIOStandard(u);f&&d&&f!==d&&n.push({id:`diff-pair-iostd-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair I/O standard mismatch",description:`Differential pair "${s}" has mismatched I/O standards: ${f} vs ${d}`,affectedPins:[o.id,u.id],suggestion:"Use the same I/O standard for both pins in a differential pair.",autoFixable:!1,timestamp:Date.now()})}}),n}static checkSpecialPinConstraints(t,r){const n=[],i=r.filter(s=>{var o,u,f,d,p;return((o=s.pinType)==null?void 0:o.includes("CLOCK"))||((u=s.pinType)==null?void 0:u.includes("GLOBAL"))||((f=s.pinType)==null?void 0:f.includes("CONFIG"))||((d=s.pinName)==null?void 0:d.startsWith("IO_L"))&&((p=s.pinName)==null?void 0:p.includes("CC"))}),a=r.filter(s=>!i.includes(s));if(i.length>0&&a.length>0){const s=i.filter(o=>{var u,f;return((u=o.signalName)==null?void 0:u.toLowerCase().includes("clk"))||((f=o.signalName)==null?void 0:f.toLowerCase().includes("clock"))});if(s.length>0){const o=s.filter(u=>{var f,d,p,g;return((f=u.signalName)==null?void 0:f.includes("100"))||((d=u.signalName)==null?void 0:d.includes("200"))||((p=u.signalName)==null?void 0:p.includes("GHz"))||((g=this.getIOStandard(u))==null?void 0:g.includes("LVDS"))});o.length>0&&a.length>0&&n.push({id:`bank-clock-isolation-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`High-speed clocks mixed with regular I/O in Bank ${t}`,description:"High-speed clock signals may cause noise coupling with regular I/O signals",affectedPins:[...o.map(u=>u.id),...a.slice(0,3).map(u=>u.id)],suggestion:"Consider isolating high-speed clock signals in dedicated banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkHighSpeedSignalConstraints(t,r){const n=[],i=r.filter(s=>{var u,f,d,p;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return o.includes("ddr")||o.includes("pcie")||o.includes("serdes")||o.includes("mgt")||o.includes("lvds")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVDS"))||((d=this.getIOStandard(s))==null?void 0:d.includes("SSTL"))||((p=this.getIOStandard(s))==null?void 0:p.includes("POD"))}),a=r.filter(s=>{var u,f;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return(o.includes("gpio")||o.includes("led")||o.includes("button")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVCMOS")))&&!i.includes(s)});return i.length>0&&a.length>0&&n.push({id:`bank-speed-mix-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`Mixed signal speeds in Bank ${t}`,description:`Bank ${t} contains both high-speed (${i.length}) and low-speed (${a.length}) signals`,affectedPins:[...i.slice(0,2).map(s=>s.id),...a.slice(0,2).map(s=>s.id)],suggestion:"Consider grouping signals by speed to minimize noise coupling.",autoFixable:!1,timestamp:Date.now()}),n}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);if(r.endsWith("p")&&!r.endsWith("_p")||r.endsWith("n")&&!r.endsWith("_n")){const n=r.charAt(r.length-2);if(/[\d_-]/.test(n))return t.slice(0,-1)}return null}static calculateSummary(t){const r={totalIssues:t.length,errorCount:0,warningCount:0,infoCount:0};return t.forEach(n=>{switch(n.severity){case"error":r.errorCount++;break;case"warning":r.warningCount++;break;case"info":r.infoCount++;break}}),r}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static getIssuesForPin(t,r){return r.filter(n=>n.affectedPins.includes(t))}static getIssuesByType(t,r){return r.filter(n=>n.type===t)}static getIssuesBySeverity(t,r){return r.filter(n=>n.severity===t)}}ml.listeners=new Set;const pj=(e,t,r={})=>{const{enabled:n=!0,debounceMs:i=1e3,backgroundCheck:a=!0}=r,[s,o]=Se.useState(null),[u,f]=Se.useState(!1),d=Se.useRef(null),p=Se.useRef(""),g=Se.useCallback(async()=>{if(!n||!e||t.length===0)return;const w=JSON.stringify({packageId:e.id,pinsData:t.map(x=>({id:x.id,signalName:x.signalName,bank:x.bank,voltage:x.voltage,pinName:x.pinName}))});if(w!==p.current)if(p.current=w,a){f(!0);try{const x=await ml.validateProjectAsync(e,t);o(x)}catch(x){console.error("Validation error:",x)}finally{f(!1)}}else{const x=ml.validateProject(e,t);o(x)}},[e,t,n,a]),v=Se.useCallback(()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{g()},i)},[g,i]);Se.useEffect(()=>(n&&v(),()=>{d.current&&clearTimeout(d.current)}),[t,e,n,v]);const m=Se.useCallback(()=>{p.current="",g()},[g]),y=Se.useCallback(w=>s?ml.getIssuesForPin(w,s.issues):[],[s]),C=Se.useCallback(w=>s?ml.getIssuesByType(w,s.issues):[],[s]),S=Se.useCallback(w=>s?ml.getIssuesBySeverity(w,s.issues):[],[s]);return{validationResult:s,isValidating:u,manualValidate:m,getIssuesForPin:y,getIssuesByType:C,getIssuesBySeverity:S,hasErrors:s?s.summary.errorCount>0:!1,hasWarnings:s?s.summary.warningCount>0:!1,hasIssues:s?s.summary.totalIssues>0:!1,errorCount:(s==null?void 0:s.summary.errorCount)||0,warningCount:(s==null?void 0:s.summary.warningCount)||0,totalIssues:(s==null?void 0:s.summary.totalIssues)||0}},gj=`# Xilinx XC7A12T Package Data
# Copyright (C) 2024 Sample Data
Pin,Pin Name,Memory Byte Group,Bank,VCCAUX Group,Super Logic Region,I/O Type,No-Connect
A1,IO_L1P_T0_D00_MOSI_14,0,14,NA,X0Y0,HR,FALSE
A2,IO_L1N_T0_D01_DIN_14,0,14,NA,X0Y0,HR,FALSE
B1,VCCINT,NA,NA,NA,NA,POWER,FALSE
B2,GND,NA,NA,NA,NA,GROUND,FALSE
C1,IO_L2P_T0_D02_14,0,14,NA,X0Y0,HR,FALSE
C2,IO_L2N_T0_D03_14,0,14,NA,X0Y0,HR,FALSE
D1,CONFIG_DONE,NA,NA,NA,NA,CONFIG,FALSE
D2,MGTPRXP1_216,NA,216,NA,NA,GTP,FALSE`,mj=()=>{const e=new Blob([gj],{type:"text/csv"});return new File([e],"sample-fpga-pins.csv",{type:"text/csv"})},xj=()=>{const e=Se.useRef(null),[t,r]=Se.useState(!1),[n,i]=Se.useState(null),[a,s]=Se.useState(!1),[o,u]=Se.useState(!1),[f,d]=Se.useState("validation"),[p,g]=Se.useState(!1),[v,m]=Se.useState(!1),[y,C]=Se.useState(!1),[S,w]=Se.useState(!1),[x,T]=Se.useState(320),[A,F]=Se.useState(280),[N,P]=Se.useState(null);hj(),Se.useEffect(()=>{const be=qe=>{qe.key==="F11"&&(qe.preventDefault(),xe())};return document.addEventListener("keydown",be),()=>{document.removeEventListener("keydown",be)}},[v,y,S]),Se.useEffect(()=>{const be=()=>{u(!0)};return document.addEventListener("showKeyboardHelp",be),()=>{document.removeEventListener("showKeyboardHelp",be)}},[]),Se.useEffect(()=>{if(typeof window.acquireVsCodeApi<"u"&&!window.vscode)try{const be=window.acquireVsCodeApi();window.vscode=be}catch(be){console.error("Failed to initialize VS Code API:",be)}},[]),Se.useEffect(()=>{const be=qe=>{p&&(qe.target.closest("[data-export-menu]")||g(!1))};return document.addEventListener("click",be),()=>{document.removeEventListener("click",be)}},[p]);const{pins:I,filteredPins:b,selectedPins:O,package:L,filters:K,viewConfig:ie,listView:re,loadPackage:ke,selectPin:we,assignSignal:oe,updatePin:X,updateFilters:he,setError:_e,setLoading:M,setRotation:J,toggleView:Q,setZoom:Y,resetZoom:ue,setSortField:z,setSortOrder:te,setViewMode:de}=Yi(),xe=()=>{m(!v),v?(C(!1),w(!1)):(C(!0),w(!0),setTimeout(()=>{ue()},100))},Me=be=>qe=>{qe.preventDefault(),P(be)},G=be=>{if(!N)return;const qe=window.innerWidth;if(N==="left"){const Ge=Math.max(200,Math.min(500,be.clientX));T(Ge)}else if(N==="right"){const Ge=Math.max(200,Math.min(500,qe-be.clientX));F(Ge)}},tt=()=>{P(null)};Se.useEffect(()=>(document.addEventListener("mousemove",G),document.addEventListener("mouseup",tt),()=>{document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",tt)}),[N]),Se.useEffect(()=>{const be=qe=>{const Ge=qe.data;switch(Ge.command||Ge.type){case"update":try{if(Ge.text&&Ge.filePath){const Je=JSON.parse(Ge.text);if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)ke(ut.packageData),_e(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid file format: missing package or pins data")}else console.warn(" Update message missing text or filePath")}catch(Je){console.error("Failed to parse .fpgaproj file:",Je),_e(`Failed to load .fpgaproj file: ${Je}`)}break;case"loadFileContent":try{if(Ge.error)throw new Error(Ge.error);if(Ge.content&&Ge.filePath){const Je=JSON.parse(Ge.content);if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)ke(ut.packageData),_e(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid file format: missing package or pins data")}}catch(Je){console.error("Failed to load file content:",Je),_e(`Failed to load file: ${Je}`)}break;case"loadProject":try{if(Ge.projectData){const Je=Ge.projectData;if(Je.package&&Je.pins){const ut=hn.restoreProject(Je);if(ut.packageData)ke(ut.packageData),_e(null);else throw new Error("Failed to restore package data from save file")}else throw new Error("Invalid project data format")}}catch(Je){console.error("Failed to load project from VS Code:",Je),_e(`Failed to load project: ${Je}`)}break;case"loadSampleData":(async()=>{try{const Je=mj();r(!0),M(!0),_e(null);const ut=await Uf.parseCSVFile(Je);if(ut.success){const Pt=Uf.createPackageFromPins(ut.pins,Je.name);ke(Pt),ut.warnings.length>0&&console.warn("Sample data import warnings:",ut.warnings)}else _e(`Failed to load sample data: ${ut.errors.join(", ")}`)}catch(Je){console.error("Failed to load sample data from VS Code:",Je),_e(`Failed to load sample data: ${Je}`)}finally{r(!1),M(!1)}})();break}};return typeof window.vscode<"u"?(window.addEventListener("message",be),setTimeout(()=>{window.vscode.postMessage({command:"webviewReady"})},500),()=>{window.removeEventListener("message",be)}):()=>{}},[ke,_e]);const{validationResult:nt,isValidating:Xe,hasErrors:Ze,hasWarnings:Ie,errorCount:Ct,warningCount:Lr}=pj(L,I,{enabled:!0,debounceMs:1e3,backgroundCheck:!0}),me=()=>{var be;(be=e.current)==null||be.click()},pe=async be=>{var Ge;const qe=(Ge=be.target.files)==null?void 0:Ge[0];if(qe){r(!0),M(!0),_e(null);try{const Je=await Uf.parseCSVFile(qe);if(Je.success){const ut=Uf.createPackageFromPins(Je.pins,qe.name);ke(ut),Je.warnings.length>0&&console.warn("Import warnings:",Je.warnings)}else _e(`Failed to import file: ${Je.errors.join(", ")}`)}catch(Je){console.error(" :",Je),_e(`Error reading file: ${Je.message}`)}finally{r(!1),M(!1),e.current&&(e.current.value="")}}},Te=be=>{he({searchText:be.target.value})},Ae=be=>{const qe=K.pinTypes,Ge=qe.includes(be)?qe.filter(Je=>Je!==be):[...qe,be];he({pinTypes:Ge})},Pe=()=>{const be=I.length,qe=I.filter(Je=>Je.isAssigned).length,Ge=be-qe;return{total:be,assigned:qe,unassigned:Ge}},De=()=>{J(ie.rotation+90)},Ve=()=>{Y(Math.min(3,ie.zoom+.1))},ve=()=>{Y(Math.max(.2,ie.zoom-.1))},q=be=>{const qe=I.find(Ge=>Ge.id===be);if(qe){const Ge=prompt("Enter signal name:",qe.signalName);Ge!==null&&oe(be,Ge)}},Ee=be=>{we(be),i(be||null)},Fe=be=>{we(be)},Ce=()=>{const be=typeof window.vscode<"u",qe=typeof window.acquireVsCodeApi<"u",Ge=window.location.protocol.includes("vscode-resource")||window.location.protocol.includes("vscode-webview")||window.navigator.userAgent.includes("Electron");return be||qe||Ge},Qe=async(be,qe,Ge,Je)=>{if(!Ce())return!1;try{let ut=window.vscode;if(!ut&&typeof window.acquireVsCodeApi<"u"&&(ut=window.acquireVsCodeApi(),window.vscode=ut),!ut||typeof ut.postMessage!="function")return!1;const Pt=await new Promise((Dt,kn)=>{const tn=setTimeout(()=>{window.removeEventListener("message",mt),kn(new Error("Save dialog timeout"))},3e4),mt=lr=>{lr.data.command==="saveDialogResult"&&(clearTimeout(tn),window.removeEventListener("message",mt),Dt(lr.data.result))};window.addEventListener("message",mt);const rn={command:"showSaveDialog",options:{saveLabel:Je,filters:Ge}};try{ut.postMessage(rn)}catch(lr){console.error("Failed to send message:",lr),kn(lr)}});if(Pt){let Dt;if(typeof Pt=="string")Dt=Pt;else if(Pt&&typeof Pt=="object"){const tn=Pt;Dt=tn.fsPath||tn.path,!Dt&&typeof Pt.toString=="function"&&(Dt=Pt.toString())}return!Dt||Dt==="undefined"||Dt==="[object Object]"?(console.error("Failed to extract valid file path from URI"),!1):await new Promise(tn=>{const mt=rn=>{rn.data.command==="saveFileResult"&&(window.removeEventListener("message",mt),tn(rn.data.success))};window.addEventListener("message",mt),ut.postMessage({command:"saveFile",filePath:Dt,content:be,filename:qe})})}}catch(ut){console.error("VS Code save failed:",ut)}return!1},et=async be=>{const qe=b.length>0?b:I;if(qe.length===0)return;let Ge,Je,ut,Pt,Dt;be==="xdc"?(Ge=Ra.exportToXDC(qe,L),Je=`${(L==null?void 0:L.device)||"fpga"}_pins.xdc`,ut="text/plain",Pt={"XDC Files":["xdc"],"All Files":["*"]},Dt="Export XDC Constraints"):(Ge=Ra.exportToSDC(qe,L),Je=`${(L==null?void 0:L.device)||"fpga"}_pins.sdc`,ut="text/plain",Pt={"SDC Files":["sdc"],"All Files":["*"]},Dt="Export SDC Constraints"),await Qe(Ge,Je,Pt,Dt)||Ra.downloadFile(Ge,Je,ut)},lt=async()=>{const be=b.length>0?b:I;if(be.length===0)return;const qe=Ra.exportToCSV(be),Ge=`${(L==null?void 0:L.device)||"fpga"}_pins.csv`;await Qe(qe,Ge,{"CSV Files":["csv"],"All Files":["*"]},"Export Pin Data to CSV")||Ra.downloadFile(qe,Ge,"text/csv")},Ye=async()=>{const be=b.length>0?b:I;if(be.length===0)return;const qe=Ra.exportReport(be,L),Ge=`${(L==null?void 0:L.device)||"fpga"}_report.txt`;await Qe(qe,Ge,{"Text Files":["txt"],"All Files":["*"]},"Export Pin Assignment Report")||Ra.downloadFile(qe,Ge,"text/plain")},xt=Pe(),{sortedPinsForList:si}=kr.useMemo(()=>{const be=[...b];return be.sort((qe,Ge)=>{var tn,mt;const Je=n&&qe.id===n,ut=n&&Ge.id===n;if(Je&&!ut)return-1;if(!Je&&ut)return 1;if(n&&!Je&&!ut){const rn=b.find(lr=>lr.id===n);if(rn){const lr=Ht.findPairPin(rn,b),Xo=(lr==null?void 0:lr.id)===qe.id,Ko=(lr==null?void 0:lr.id)===Ge.id;if(Xo&&!Ko)return-1;if(!Xo&&Ko)return 1}}let Pt,Dt;switch(K.sortField){case"pinNumber":Pt=qe.pinNumber,Dt=Ge.pinNumber;break;case"pinName":Pt=qe.pinName,Dt=Ge.pinName;break;case"signalName":Pt=qe.signalName||"",Dt=Ge.signalName||"";break;case"pinType":Pt=qe.pinType,Dt=Ge.pinType;break;case"bank":Pt=qe.bank||"",Dt=Ge.bank||"";break;case"grid":if(qe.gridPosition&&Ge.gridPosition){const rn=H6(qe.gridPosition.row,Ge.gridPosition.row);if(rn!==0)return K.sortOrder==="asc"?rn:-rn;const lr=qe.gridPosition.col-Ge.gridPosition.col;return K.sortOrder==="asc"?lr:-lr}Pt=((tn=qe.gridPosition)==null?void 0:tn.row)||"",Dt=((mt=Ge.gridPosition)==null?void 0:mt.row)||"";break;default:Pt=qe.pinNumber,Dt=Ge.pinNumber}const kn=Pt.localeCompare(Dt,void 0,{numeric:!0,sensitivity:"base"});return K.sortOrder==="asc"?kn:-kn}),{sortedPinsForList:be}},[b,K.sortField,K.sortOrder,n,I]);return E.jsxs("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',display:"flex",flexDirection:"column"},children:[E.jsxs("header",{style:{height:"36px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",flexShrink:0,minHeight:"36px"},children:[E.jsx("h1",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#4A90E2"},children:"FPGA Pin Planner"}),E.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"12px",alignItems:"center"},children:[E.jsx("button",{onClick:xe,style:{padding:"6px 12px",backgroundColor:v?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px",color:v?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},title:v?"Restore Normal View (F11)":"Maximize Viewer (F11)",children:v?" Restore":" Maximize"}),E.jsx("input",{ref:e,type:"file",accept:".csv,.txt,.xlsx,.xls",onChange:pe,style:{display:"none"}}),E.jsx("button",{onClick:me,disabled:t,style:{padding:"8px 16px",backgroundColor:t?"#666":"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:t?"not-allowed":"pointer",fontSize:"14px"},children:t?" Loading...":" Open Pin File"}),E.jsxs("div",{style:{position:"relative"},"data-export-menu":!0,children:[E.jsxs("button",{onClick:()=>g(!p),disabled:b.length===0&&I.length===0,style:{padding:"8px 16px",backgroundColor:b.length>0||I.length>0?"#4A90E2":"#666",border:"none",borderRadius:"4px",color:"white",cursor:b.length>0||I.length>0?"pointer":"not-allowed",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},title:"Export Pin Data",children:[" Export ",p?"":""]}),p&&(b.length>0||I.length>0)&&E.jsxs("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",zIndex:1e3,minWidth:"160px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[E.jsx("button",{onClick:()=>{s(!0),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:be=>be.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:be=>be.currentTarget.style.backgroundColor="transparent",children:" Constraints (XDC/SDC)"}),E.jsx("button",{onClick:()=>{lt(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:be=>be.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:be=>be.currentTarget.style.backgroundColor="transparent",children:" CSV Data"}),E.jsx("button",{onClick:()=>{Ye(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px"},onMouseEnter:be=>be.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:be=>be.currentTarget.style.backgroundColor="transparent",children:" Report"})]})]})]})]}),E.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0,height:"100%"},children:[!y&&E.jsxs("aside",{style:{width:`${x}px`,backgroundColor:"#252525",borderRight:"1px solid #444",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%",minWidth:"200px",maxWidth:"500px"},children:[E.jsx("div",{onMouseDown:Me("left"),style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:N==="left"?"#007acc":"transparent"},title:"Drag to resize panel"}),E.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #444"},children:[E.jsx("input",{type:"text",placeholder:"Search pins...",value:K.searchText,onChange:Te,style:{width:"100%",padding:"8px 12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),E.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",alignItems:"center"},children:[E.jsx("span",{style:{fontSize:"12px",color:"#999"},children:"Sort:"}),E.jsxs("select",{value:K.sortField,onChange:be=>z(be.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",fontSize:"12px",cursor:"pointer"},children:[E.jsx("option",{value:"pinNumber",children:"Pin Number"}),E.jsx("option",{value:"pinName",children:"Pin Name"}),E.jsx("option",{value:"signalName",children:"Signal Name"}),E.jsx("option",{value:"pinType",children:"Pin Type"}),E.jsx("option",{value:"bank",children:"Bank"}),E.jsx("option",{value:"grid",children:"Grid Position"})]}),E.jsx("button",{onClick:()=>te(K.sortOrder==="asc"?"desc":"asc"),style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px"},title:`Sort ${K.sortOrder==="asc"?"Descending":"Ascending"}`,children:K.sortOrder==="asc"?"":""})]}),E.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",flexWrap:"wrap"},children:[E.jsxs("button",{onClick:()=>he({pinTypes:[]}),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:K.pinTypes.length===0?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["All (",I.length,")"]}),E.jsxs("button",{onClick:()=>Ae("IO"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:K.pinTypes.includes("IO")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["I/O (",I.filter(be=>be.pinType==="IO").length,")"]}),E.jsxs("button",{onClick:()=>Ae("POWER"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:K.pinTypes.includes("POWER")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["Power (",I.filter(be=>be.pinType==="POWER").length,")"]})]})]}),E.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:I.length===0?E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px"},children:"No package loaded"}),E.jsxs("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:["Debug: pins=",I.length,", package=",(L==null?void 0:L.name)||"null"]}),E.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"14px"},children:[E.jsx("div",{style:{marginBottom:"12px"},children:""}),E.jsx("div",{children:"Load a CSV file to start"})]})]}):E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px",display:"flex",justifyContent:"space-between"},children:[E.jsx("span",{children:(L==null?void 0:L.name)||"Package"}),E.jsxs("span",{children:["Showing ",b.length," of ",I.length]})]}),E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:si.map(be=>{const qe=n?I.find(ut=>ut.id===n):null,Ge=qe?Ht.findPairPin(qe,I):null,Je=(Ge==null?void 0:Ge.id)===be.id;return E.jsx(kI,{pin:be,isSelected:O.has(be.id),onSelect:Fe,onAssignSignal:oe,onUpdatePin:X,isPairPin:!1,isDifferentialPairPartner:Je},be.id)})})]})})]}),E.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0,minHeight:0},children:[E.jsxs("div",{className:"toolbar-scrollbar",style:{height:"32px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 12px",gap:"8px",overflowX:"auto",overflowY:"hidden",flexShrink:0,minHeight:"32px"},children:[E.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[E.jsx("button",{onClick:()=>de("grid"),style:{padding:"4px 8px",backgroundColor:re.viewMode==="grid"?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px 0 0 4px",color:re.viewMode==="grid"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"Grid View",children:" Grid"}),E.jsx("button",{onClick:()=>de("list"),style:{padding:"4px 8px",backgroundColor:re.viewMode==="list"?"#007acc":"#333",border:"1px solid #555",borderRadius:"0 4px 4px 0",color:re.viewMode==="list"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"List View",children:" List"})]}),E.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),E.jsx("button",{onClick:De,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Rotate 90"}),E.jsx("button",{onClick:Q,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Flip View"}),E.jsx("div",{style:{flexShrink:0},children:E.jsx(nj,{})}),E.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),E.jsx("div",{style:{flexShrink:0},children:E.jsx(ij,{})}),E.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),E.jsxs("button",{onClick:()=>d(f==="validation"?null:"validation"),style:{padding:"6px 12px",backgroundColor:f==="validation"?"#4a5568":Ze?"#dc2626":Ie?"#d97706":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:`Validation: ${Ct} errors, ${Lr} warnings (click for details)`,children:[E.jsx(cj,{validationResult:nt}),E.jsx("span",{children:"Validation"}),Xe&&E.jsx("span",{className:"animate-spin",children:""})]}),E.jsxs("button",{onClick:()=>d(f==="batch"?null:"batch"),style:{padding:"6px 12px",backgroundColor:f==="batch"?"#4a5568":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:"Batch Operations - Assign patterns to multiple pins",children:[E.jsx("span",{children:""}),E.jsx("span",{children:"Batch Ops"})]}),E.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),E.jsx("button",{onClick:()=>u(!0),style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},title:"Keyboard Shortcuts (Ctrl+Shift+?)",children:" Shortcuts"}),E.jsx("div",{style:{flex:1,minWidth:"20px"}}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0,backgroundColor:"#2a2a2a",padding:"0 8px",borderRadius:"4px"},children:[E.jsx("span",{style:{fontSize:"12px",color:"#999",whiteSpace:"nowrap"},children:"Zoom:"}),E.jsx("button",{onClick:ve,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"-"}),E.jsxs("button",{onClick:ue,style:{padding:"4px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",minWidth:"50px",whiteSpace:"nowrap"},title:"Reset zoom to 100%",children:[Math.round(ie.zoom*100),"%"]}),E.jsx("button",{onClick:Ve,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"+"})]})]}),E.jsxs("div",{style:{flex:1,minWidth:"0",backgroundColor:"#1a1a1a",overflow:"hidden",display:"flex",flexShrink:1,width:"100%",minHeight:0,height:"100%"},children:[E.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minWidth:0,width:"100%",minHeight:0,height:"100%"},children:re.viewMode==="grid"?E.jsx(rj,{package:L,pins:b,selectedPins:O,onPinSelect:Ee,onPinDoubleClick:q,zoom:ie.zoom,rotation:ie.rotation,isTopView:ie.isTopView,onZoomChange:Y}):E.jsx("div",{style:{height:"100%",backgroundColor:"#1a1a1a",overflow:"hidden",width:"100%",minHeight:0},children:E.jsx(VI,{onPinSelect:Fe})})}),!y&&f&&E.jsxs("div",{style:{width:`${A}px`,minWidth:"200px",maxWidth:"500px",borderLeft:"1px solid #555",backgroundColor:"#1e1e1e",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minHeight:0,position:"relative"},children:[E.jsx("div",{onMouseDown:Me("right"),style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:N==="right"?"#007acc":"transparent"},title:"Drag to resize panel"}),f==="validation"&&E.jsx("div",{style:{height:"100%",overflow:"hidden"},className:"custom-scrollbar",children:E.jsx(lj,{validationResult:nt,onIssueClick:be=>{be.affectedPins&&be.affectedPins.length>0}})}),f==="batch"&&E.jsx("div",{style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:E.jsx(uj,{isVisible:!0})})]})]})]})]}),!S&&E.jsxs("footer",{style:{height:"16px",backgroundColor:"#2a2a2a",borderTop:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",fontSize:"10px",color:"#999",flexShrink:0},children:[E.jsx("span",{children:"Ready"}),E.jsx("div",{style:{marginLeft:"auto"},children:E.jsxs("span",{children:["Pins: ",xt.total," | Assigned: ",xt.assigned," | Unassigned: ",xt.unassigned]})})]}),E.jsx(EI,{isOpen:a,onClose:()=>s(!1),onExport:et,pins:I,currentPackage:L}),E.jsx(oj,{isOpen:o,onClose:()=>u(!1)})]})};Cg.createRoot(document.getElementById("root")).render(E.jsx(kr.StrictMode,{children:E.jsx(xj,{})}));
