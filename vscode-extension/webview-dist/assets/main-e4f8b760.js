(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var d4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k5={exports:{}},Kd={},E5={exports:{}},xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=Symbol.for("react.element"),ok=Symbol.for("react.portal"),lk=Symbol.for("react.fragment"),ck=Symbol.for("react.strict_mode"),uk=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),dk=Symbol.for("react.context"),hk=Symbol.for("react.forward_ref"),pk=Symbol.for("react.suspense"),gk=Symbol.for("react.memo"),mk=Symbol.for("react.lazy"),h4=Symbol.iterator;function xk(e){return e===null||typeof e!="object"?null:(e=h4&&e[h4]||e["@@iterator"],typeof e=="function"?e:null)}var C5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T5=Object.assign,A5={};function ec(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}ec.prototype.isReactComponent={};ec.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ec.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function P5(){}P5.prototype=ec.prototype;function Vm(e,t,r){this.props=e,this.context=t,this.refs=A5,this.updater=r||C5}var Gm=Vm.prototype=new P5;Gm.constructor=Vm;T5(Gm,ec.prototype);Gm.isPureReactComponent=!0;var p4=Array.isArray,F5=Object.prototype.hasOwnProperty,Hm={current:null},N5={key:!0,ref:!0,__self:!0,__source:!0};function R5(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)F5.call(t,n)&&!N5.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),f=0;f<o;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:nu,type:e,key:a,ref:s,props:i,_owner:Hm.current}}function vk(e,t){return{$$typeof:nu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wm(e){return typeof e=="object"&&e!==null&&e.$$typeof===nu}function yk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var g4=/\/+/g;function wp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yk(""+e.key):t.toString(36)}function Hf(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case nu:case ok:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+wp(s,0):n,p4(i)?(r="",e!=null&&(r=e.replace(g4,"$&/")+"/"),Hf(i,t,r,"",function(f){return f})):i!=null&&(Wm(i)&&(i=vk(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(g4,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",p4(e))for(var o=0;o<e.length;o++){a=e[o];var u=n+wp(a,o);s+=Hf(a,t,r,u,i)}else if(u=xk(e),typeof u=="function")for(e=u.call(e),o=0;!(a=e.next()).done;)a=a.value,u=n+wp(a,o++),s+=Hf(a,t,r,u,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function df(e,t,r){if(e==null)return e;var n=[],i=0;return Hf(e,n,"","",function(a){return t.call(r,a,i++)}),n}function _k(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pn={current:null},Wf={transition:null},wk={ReactCurrentDispatcher:Pn,ReactCurrentBatchConfig:Wf,ReactCurrentOwner:Hm};function I5(){throw Error("act(...) is not supported in production builds of React.")}xt.Children={map:df,forEach:function(e,t,r){df(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return df(e,function(){t++}),t},toArray:function(e){return df(e,function(t){return t})||[]},only:function(e){if(!Wm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};xt.Component=ec;xt.Fragment=lk;xt.Profiler=uk;xt.PureComponent=Vm;xt.StrictMode=ck;xt.Suspense=pk;xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wk;xt.act=I5;xt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=T5({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Hm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)F5.call(t,u)&&!N5.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var f=0;f<u;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:nu,type:e.type,key:i,ref:a,props:n,_owner:s}};xt.createContext=function(e){return e={$$typeof:dk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fk,_context:e},e.Consumer=e};xt.createElement=R5;xt.createFactory=function(e){var t=R5.bind(null,e);return t.type=e,t};xt.createRef=function(){return{current:null}};xt.forwardRef=function(e){return{$$typeof:hk,render:e}};xt.isValidElement=Wm;xt.lazy=function(e){return{$$typeof:mk,_payload:{_status:-1,_result:e},_init:_k}};xt.memo=function(e,t){return{$$typeof:gk,type:e,compare:t===void 0?null:t}};xt.startTransition=function(e){var t=Wf.transition;Wf.transition={};try{e()}finally{Wf.transition=t}};xt.unstable_act=I5;xt.useCallback=function(e,t){return Pn.current.useCallback(e,t)};xt.useContext=function(e){return Pn.current.useContext(e)};xt.useDebugValue=function(){};xt.useDeferredValue=function(e){return Pn.current.useDeferredValue(e)};xt.useEffect=function(e,t){return Pn.current.useEffect(e,t)};xt.useId=function(){return Pn.current.useId()};xt.useImperativeHandle=function(e,t,r){return Pn.current.useImperativeHandle(e,t,r)};xt.useInsertionEffect=function(e,t){return Pn.current.useInsertionEffect(e,t)};xt.useLayoutEffect=function(e,t){return Pn.current.useLayoutEffect(e,t)};xt.useMemo=function(e,t){return Pn.current.useMemo(e,t)};xt.useReducer=function(e,t,r){return Pn.current.useReducer(e,t,r)};xt.useRef=function(e){return Pn.current.useRef(e)};xt.useState=function(e){return Pn.current.useState(e)};xt.useSyncExternalStore=function(e,t,r){return Pn.current.useSyncExternalStore(e,t,r)};xt.useTransition=function(){return Pn.current.useTransition()};xt.version="18.3.1";E5.exports=xt;var _e=E5.exports;const Sr=Xd(_e);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk=_e,kk=Symbol.for("react.element"),Ek=Symbol.for("react.fragment"),Ck=Object.prototype.hasOwnProperty,Tk=Sk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ak={key:!0,ref:!0,__self:!0,__source:!0};function D5(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Ck.call(t,n)&&!Ak.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:kk,type:e,key:a,ref:s,props:i,_owner:Tk.current}}Kd.Fragment=Ek;Kd.jsx=D5;Kd.jsxs=D5;k5.exports=Kd;var T=k5.exports,Sg={},b5={exports:{}},ni={},O5={exports:{}},L5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,X){var ce=se.length;se.push(X);e:for(;0<ce;){var Se=ce-1>>>1,L=se[Se];if(0<i(L,X))se[Se]=X,se[ce]=L,ce=Se;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var X=se[0],ce=se.pop();if(ce!==X){se[0]=ce;e:for(var Se=0,L=se.length,q=L>>>1;Se<q;){var Y=2*(Se+1)-1,K=se[Y],ue=Y+1,z=se[ue];if(0>i(K,ce))ue<L&&0>i(z,K)?(se[Se]=z,se[ue]=ce,Se=ue):(se[Se]=K,se[Y]=ce,Se=Y);else if(ue<L&&0>i(z,ce))se[Se]=z,se[ue]=ce,Se=ue;else break e}}return X}function i(se,X){var ce=se.sortIndex-X.sortIndex;return ce!==0?ce:se.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var u=[],f=[],d=1,p=null,g=3,v=!1,m=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(se){for(var X=r(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=se)n(f),X.sortIndex=X.expirationTime,t(u,X);else break;X=r(f)}}function C(se){if(y=!1,x(se),!m)if(r(u)!==null)m=!0,Ee(A);else{var X=r(f);X!==null&&we(C,X.startTime-se)}}function A(se,X){m=!1,y&&(y=!1,k(F),F=-1),v=!0;var ce=g;try{for(x(X),p=r(u);p!==null&&(!(p.expirationTime>X)||se&&!U());){var Se=p.callback;if(typeof Se=="function"){p.callback=null,g=p.priorityLevel;var L=Se(p.expirationTime<=X);X=e.unstable_now(),typeof L=="function"?p.callback=L:p===r(u)&&n(u),x(X)}else n(u);p=r(u)}if(p!==null)var q=!0;else{var Y=r(f);Y!==null&&we(C,Y.startTime-X),q=!1}return q}finally{p=null,g=ce,v=!1}}var P=!1,N=null,F=-1,I=5,D=-1;function U(){return!(e.unstable_now()-D<I)}function O(){if(N!==null){var se=e.unstable_now();D=se;var X=!0;try{X=N(!0,se)}finally{X?Q():(P=!1,N=null)}}else P=!1}var Q;if(typeof w=="function")Q=function(){w(O)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,te=he.port2;he.port1.onmessage=O,Q=function(){te.postMessage(null)}}else Q=function(){E(O,0)};function Ee(se){N=se,P||(P=!0,Q())}function we(se,X){F=E(function(){se(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){m||v||(m=!0,Ee(A))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(se){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var ce=g;g=X;try{return se()}finally{g=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,X){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ce=g;g=se;try{return X()}finally{g=ce}},e.unstable_scheduleCallback=function(se,X,ce){var Se=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Se+ce:Se):ce=Se,se){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=ce+L,se={id:d++,callback:X,priorityLevel:se,startTime:ce,expirationTime:L,sortIndex:-1},ce>Se?(se.sortIndex=ce,t(f,se),r(u)===null&&se===r(f)&&(y?(k(F),F=-1):y=!0,we(C,ce-Se))):(se.sortIndex=L,t(u,se),m||v||(m=!0,Ee(A))),se},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(se){var X=g;return function(){var ce=g;g=X;try{return se.apply(this,arguments)}finally{g=ce}}}})(L5);O5.exports=L5;var s0=O5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pk=_e,ei=s0;function Ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M5=new Set,C0={};function Fo(e,t){Bl(e,t),Bl(e+"Capture",t)}function Bl(e,t){for(C0[e]=t,e=0;e<t.length;e++)M5.add(t[e])}var ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kg=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m4={},x4={};function Nk(e){return kg.call(x4,e)?!0:kg.call(m4,e)?!1:Fk.test(e)?x4[e]=!0:(m4[e]=!0,!1)}function Rk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ik(e,t,r,n){if(t===null||typeof t>"u"||Rk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fn(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var en={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){en[e]=new Fn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];en[t]=new Fn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){en[e]=new Fn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){en[e]=new Fn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){en[e]=new Fn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){en[e]=new Fn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){en[e]=new Fn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){en[e]=new Fn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){en[e]=new Fn(e,5,!1,e.toLowerCase(),null,!1,!1)});var $m=/[\-:]([a-z])/g;function Xm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($m,Xm);en[t]=new Fn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($m,Xm);en[t]=new Fn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($m,Xm);en[t]=new Fn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){en[e]=new Fn(e,1,!1,e.toLowerCase(),null,!1,!1)});en.xlinkHref=new Fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){en[e]=new Fn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Km(e,t,r,n){var i=en.hasOwnProperty(t)?en[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ik(t,r,i,n)&&(r=null),n||i===null?Nk(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var $a=Pk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hf=Symbol.for("react.element"),gl=Symbol.for("react.portal"),ml=Symbol.for("react.fragment"),Ym=Symbol.for("react.strict_mode"),Eg=Symbol.for("react.profiler"),B5=Symbol.for("react.provider"),U5=Symbol.for("react.context"),Qm=Symbol.for("react.forward_ref"),Cg=Symbol.for("react.suspense"),Tg=Symbol.for("react.suspense_list"),qm=Symbol.for("react.memo"),fs=Symbol.for("react.lazy"),j5=Symbol.for("react.offscreen"),v4=Symbol.iterator;function Dc(e){return e===null||typeof e!="object"?null:(e=v4&&e[v4]||e["@@iterator"],typeof e=="function"?e:null)}var sr=Object.assign,Sp;function qc(e){if(Sp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Sp=t&&t[1]||""}return`
`+Sp+e}var kp=!1;function Ep(e,t){if(!e||kp)return"";kp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=o);break}}}finally{kp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qc(e):""}function Dk(e){switch(e.tag){case 5:return qc(e.type);case 16:return qc("Lazy");case 13:return qc("Suspense");case 19:return qc("SuspenseList");case 0:case 2:case 15:return e=Ep(e.type,!1),e;case 11:return e=Ep(e.type.render,!1),e;case 1:return e=Ep(e.type,!0),e;default:return""}}function Ag(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ml:return"Fragment";case gl:return"Portal";case Eg:return"Profiler";case Ym:return"StrictMode";case Cg:return"Suspense";case Tg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case U5:return(e.displayName||"Context")+".Consumer";case B5:return(e._context.displayName||"Context")+".Provider";case Qm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qm:return t=e.displayName||null,t!==null?t:Ag(e.type)||"Memo";case fs:t=e._payload,e=e._init;try{return Ag(e(t))}catch{}}return null}function bk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ag(t);case 8:return t===Ym?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function z5(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ok(e){var t=z5(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pf(e){e._valueTracker||(e._valueTracker=Ok(e))}function V5(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=z5(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function id(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pg(e,t){var r=t.checked;return sr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function y4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ns(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function G5(e,t){t=t.checked,t!=null&&Km(e,"checked",t,!1)}function Fg(e,t){G5(e,t);var r=Ns(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ng(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ng(e,t.type,Ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ng(e,t,r){(t!=="number"||id(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jc=Array.isArray;function Pl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ns(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return sr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function w4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ie(92));if(Jc(r)){if(1<r.length)throw Error(Ie(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ns(r)}}function H5(e,t){var r=Ns(t.value),n=Ns(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function S4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W5(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ig(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W5(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gf,$5=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gf=gf||document.createElement("div"),gf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function T0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var o0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lk=["Webkit","ms","Moz","O"];Object.keys(o0).forEach(function(e){Lk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),o0[t]=o0[e]})});function X5(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||o0.hasOwnProperty(e)&&o0[e]?(""+t).trim():t+"px"}function K5(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=X5(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Mk=sr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dg(e,t){if(t){if(Mk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ie(62))}}function bg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Og=null;function Jm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Lg=null,Fl=null,Nl=null;function k4(e){if(e=su(e)){if(typeof Lg!="function")throw Error(Ie(280));var t=e.stateNode;t&&(t=Zd(t),Lg(e.stateNode,e.type,t))}}function Y5(e){Fl?Nl?Nl.push(e):Nl=[e]:Fl=e}function Q5(){if(Fl){var e=Fl,t=Nl;if(Nl=Fl=null,k4(e),t)for(e=0;e<t.length;e++)k4(t[e])}}function q5(e,t){return e(t)}function J5(){}var Cp=!1;function Z5(e,t,r){if(Cp)return e(t,r);Cp=!0;try{return q5(e,t,r)}finally{Cp=!1,(Fl!==null||Nl!==null)&&(J5(),Q5())}}function A0(e,t){var r=e.stateNode;if(r===null)return null;var n=Zd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ie(231,t,typeof r));return r}var Mg=!1;if(ja)try{var bc={};Object.defineProperty(bc,"passive",{get:function(){Mg=!0}}),window.addEventListener("test",bc,bc),window.removeEventListener("test",bc,bc)}catch{Mg=!1}function Bk(e,t,r,n,i,a,s,o,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(d){this.onError(d)}}var l0=!1,ad=null,sd=!1,Bg=null,Uk={onError:function(e){l0=!0,ad=e}};function jk(e,t,r,n,i,a,s,o,u){l0=!1,ad=null,Bk.apply(Uk,arguments)}function zk(e,t,r,n,i,a,s,o,u){if(jk.apply(this,arguments),l0){if(l0){var f=ad;l0=!1,ad=null}else throw Error(Ie(198));sd||(sd=!0,Bg=f)}}function No(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function e_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function E4(e){if(No(e)!==e)throw Error(Ie(188))}function Vk(e){var t=e.alternate;if(!t){if(t=No(e),t===null)throw Error(Ie(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return E4(i),e;if(a===n)return E4(i),t;a=a.sibling}throw Error(Ie(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Ie(189))}}if(r.alternate!==n)throw Error(Ie(190))}if(r.tag!==3)throw Error(Ie(188));return r.stateNode.current===r?e:t}function t_(e){return e=Vk(e),e!==null?r_(e):null}function r_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=r_(e);if(t!==null)return t;e=e.sibling}return null}var n_=ei.unstable_scheduleCallback,C4=ei.unstable_cancelCallback,Gk=ei.unstable_shouldYield,Hk=ei.unstable_requestPaint,gr=ei.unstable_now,Wk=ei.unstable_getCurrentPriorityLevel,Zm=ei.unstable_ImmediatePriority,i_=ei.unstable_UserBlockingPriority,od=ei.unstable_NormalPriority,$k=ei.unstable_LowPriority,a_=ei.unstable_IdlePriority,Yd=null,ha=null;function Xk(e){if(ha&&typeof ha.onCommitFiberRoot=="function")try{ha.onCommitFiberRoot(Yd,e,void 0,(e.current.flags&128)===128)}catch{}}var Wi=Math.clz32?Math.clz32:Qk,Kk=Math.log,Yk=Math.LN2;function Qk(e){return e>>>=0,e===0?32:31-(Kk(e)/Yk|0)|0}var mf=64,xf=4194304;function Zc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ld(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=Zc(o):(a&=s,a!==0&&(n=Zc(a)))}else s=r&~i,s!==0?n=Zc(s):a!==0&&(n=Zc(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Wi(t),i=1<<r,n|=e[r],t&=~i;return n}function qk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jk(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-Wi(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=qk(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}function Ug(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function s_(){var e=mf;return mf<<=1,!(mf&4194240)&&(mf=64),e}function Tp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function iu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wi(t),e[t]=r}function Zk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Wi(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function e2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Wi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Bt=0;function o_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var l_,t2,c_,u_,f_,jg=!1,vf=[],ws=null,Ss=null,ks=null,P0=new Map,F0=new Map,hs=[],e9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T4(e,t){switch(e){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":Ss=null;break;case"mouseover":case"mouseout":ks=null;break;case"pointerover":case"pointerout":P0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":F0.delete(t.pointerId)}}function Oc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=su(t),t!==null&&t2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function t9(e,t,r,n,i){switch(t){case"focusin":return ws=Oc(ws,e,t,r,n,i),!0;case"dragenter":return Ss=Oc(Ss,e,t,r,n,i),!0;case"mouseover":return ks=Oc(ks,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return P0.set(a,Oc(P0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,F0.set(a,Oc(F0.get(a)||null,e,t,r,n,i)),!0}return!1}function d_(e){var t=uo(e.target);if(t!==null){var r=No(t);if(r!==null){if(t=r.tag,t===13){if(t=e_(r),t!==null){e.blockedOn=t,f_(e.priority,function(){c_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $f(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=zg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Og=n,r.target.dispatchEvent(n),Og=null}else return t=su(r),t!==null&&t2(t),e.blockedOn=r,!1;t.shift()}return!0}function A4(e,t,r){$f(e)&&r.delete(t)}function r9(){jg=!1,ws!==null&&$f(ws)&&(ws=null),Ss!==null&&$f(Ss)&&(Ss=null),ks!==null&&$f(ks)&&(ks=null),P0.forEach(A4),F0.forEach(A4)}function Lc(e,t){e.blockedOn===t&&(e.blockedOn=null,jg||(jg=!0,ei.unstable_scheduleCallback(ei.unstable_NormalPriority,r9)))}function N0(e){function t(i){return Lc(i,e)}if(0<vf.length){Lc(vf[0],e);for(var r=1;r<vf.length;r++){var n=vf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ws!==null&&Lc(ws,e),Ss!==null&&Lc(Ss,e),ks!==null&&Lc(ks,e),P0.forEach(t),F0.forEach(t),r=0;r<hs.length;r++)n=hs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<hs.length&&(r=hs[0],r.blockedOn===null);)d_(r),r.blockedOn===null&&hs.shift()}var Rl=$a.ReactCurrentBatchConfig,cd=!0;function n9(e,t,r,n){var i=Bt,a=Rl.transition;Rl.transition=null;try{Bt=1,r2(e,t,r,n)}finally{Bt=i,Rl.transition=a}}function i9(e,t,r,n){var i=Bt,a=Rl.transition;Rl.transition=null;try{Bt=4,r2(e,t,r,n)}finally{Bt=i,Rl.transition=a}}function r2(e,t,r,n){if(cd){var i=zg(e,t,r,n);if(i===null)Lp(e,t,n,ud,r),T4(e,n);else if(t9(i,e,t,r,n))n.stopPropagation();else if(T4(e,n),t&4&&-1<e9.indexOf(e)){for(;i!==null;){var a=su(i);if(a!==null&&l_(a),a=zg(e,t,r,n),a===null&&Lp(e,t,n,ud,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Lp(e,t,n,null,r)}}var ud=null;function zg(e,t,r,n){if(ud=null,e=Jm(n),e=uo(e),e!==null)if(t=No(e),t===null)e=null;else if(r=t.tag,r===13){if(e=e_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ud=e,null}function h_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wk()){case Zm:return 1;case i_:return 4;case od:case $k:return 16;case a_:return 536870912;default:return 16}default:return 16}}var xs=null,n2=null,Xf=null;function p_(){if(Xf)return Xf;var e,t=n2,r=t.length,n,i="value"in xs?xs.value:xs.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return Xf=i.slice(e,1<n?1-n:void 0)}function Kf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function yf(){return!0}function P4(){return!1}function ii(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?yf:P4,this.isPropagationStopped=P4,this}return sr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=yf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=yf)},persist:function(){},isPersistent:yf}),t}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i2=ii(tc),au=sr({},tc,{view:0,detail:0}),a9=ii(au),Ap,Pp,Mc,Qd=sr({},au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mc&&(Mc&&e.type==="mousemove"?(Ap=e.screenX-Mc.screenX,Pp=e.screenY-Mc.screenY):Pp=Ap=0,Mc=e),Ap)},movementY:function(e){return"movementY"in e?e.movementY:Pp}}),F4=ii(Qd),s9=sr({},Qd,{dataTransfer:0}),o9=ii(s9),l9=sr({},au,{relatedTarget:0}),Fp=ii(l9),c9=sr({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),u9=ii(c9),f9=sr({},tc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),d9=ii(f9),h9=sr({},tc,{data:0}),N4=ii(h9),p9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x9(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=m9[e])?!!t[e]:!1}function a2(){return x9}var v9=sr({},au,{key:function(e){if(e.key){var t=p9[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Kf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a2,charCode:function(e){return e.type==="keypress"?Kf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),y9=ii(v9),_9=sr({},Qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R4=ii(_9),w9=sr({},au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a2}),S9=ii(w9),k9=sr({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),E9=ii(k9),C9=sr({},Qd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),T9=ii(C9),A9=[9,13,27,32],s2=ja&&"CompositionEvent"in window,c0=null;ja&&"documentMode"in document&&(c0=document.documentMode);var P9=ja&&"TextEvent"in window&&!c0,g_=ja&&(!s2||c0&&8<c0&&11>=c0),I4=String.fromCharCode(32),D4=!1;function m_(e,t){switch(e){case"keyup":return A9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function x_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xl=!1;function F9(e,t){switch(e){case"compositionend":return x_(t);case"keypress":return t.which!==32?null:(D4=!0,I4);case"textInput":return e=t.data,e===I4&&D4?null:e;default:return null}}function N9(e,t){if(xl)return e==="compositionend"||!s2&&m_(e,t)?(e=p_(),Xf=n2=xs=null,xl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return g_&&t.locale!=="ko"?null:t.data;default:return null}}var R9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!R9[e.type]:t==="textarea"}function v_(e,t,r,n){Y5(n),t=fd(t,"onChange"),0<t.length&&(r=new i2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var u0=null,R0=null;function I9(e){F_(e,0)}function qd(e){var t=_l(e);if(V5(t))return e}function D9(e,t){if(e==="change")return t}var y_=!1;if(ja){var Np;if(ja){var Rp="oninput"in document;if(!Rp){var O4=document.createElement("div");O4.setAttribute("oninput","return;"),Rp=typeof O4.oninput=="function"}Np=Rp}else Np=!1;y_=Np&&(!document.documentMode||9<document.documentMode)}function L4(){u0&&(u0.detachEvent("onpropertychange",__),R0=u0=null)}function __(e){if(e.propertyName==="value"&&qd(R0)){var t=[];v_(t,R0,e,Jm(e)),Z5(I9,t)}}function b9(e,t,r){e==="focusin"?(L4(),u0=t,R0=r,u0.attachEvent("onpropertychange",__)):e==="focusout"&&L4()}function O9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qd(R0)}function L9(e,t){if(e==="click")return qd(t)}function M9(e,t){if(e==="input"||e==="change")return qd(t)}function B9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qi=typeof Object.is=="function"?Object.is:B9;function I0(e,t){if(Qi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!kg.call(t,i)||!Qi(e[i],t[i]))return!1}return!0}function M4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function B4(e,t){var r=M4(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=M4(r)}}function w_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?w_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function S_(){for(var e=window,t=id();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=id(e.document)}return t}function o2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function U9(e){var t=S_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&w_(r.ownerDocument.documentElement,r)){if(n!==null&&o2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=B4(r,a);var s=B4(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var j9=ja&&"documentMode"in document&&11>=document.documentMode,vl=null,Vg=null,f0=null,Gg=!1;function U4(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gg||vl==null||vl!==id(n)||(n=vl,"selectionStart"in n&&o2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),f0&&I0(f0,n)||(f0=n,n=fd(Vg,"onSelect"),0<n.length&&(t=new i2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vl)))}function _f(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var yl={animationend:_f("Animation","AnimationEnd"),animationiteration:_f("Animation","AnimationIteration"),animationstart:_f("Animation","AnimationStart"),transitionend:_f("Transition","TransitionEnd")},Ip={},k_={};ja&&(k_=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function Jd(e){if(Ip[e])return Ip[e];if(!yl[e])return e;var t=yl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in k_)return Ip[e]=t[r];return e}var E_=Jd("animationend"),C_=Jd("animationiteration"),T_=Jd("animationstart"),A_=Jd("transitionend"),P_=new Map,j4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ls(e,t){P_.set(e,t),Fo(t,[e])}for(var Dp=0;Dp<j4.length;Dp++){var bp=j4[Dp],z9=bp.toLowerCase(),V9=bp[0].toUpperCase()+bp.slice(1);Ls(z9,"on"+V9)}Ls(E_,"onAnimationEnd");Ls(C_,"onAnimationIteration");Ls(T_,"onAnimationStart");Ls("dblclick","onDoubleClick");Ls("focusin","onFocus");Ls("focusout","onBlur");Ls(A_,"onTransitionEnd");Bl("onMouseEnter",["mouseout","mouseover"]);Bl("onMouseLeave",["mouseout","mouseover"]);Bl("onPointerEnter",["pointerout","pointerover"]);Bl("onPointerLeave",["pointerout","pointerover"]);Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var e0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G9=new Set("cancel close invalid load scroll toggle".split(" ").concat(e0));function z4(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zk(n,t,void 0,e),e.currentTarget=null}function F_(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,f=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;z4(i,o,f),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,f=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;z4(i,o,f),a=u}}}if(sd)throw e=Bg,sd=!1,Bg=null,e}function Kt(e,t){var r=t[Kg];r===void 0&&(r=t[Kg]=new Set);var n=e+"__bubble";r.has(n)||(N_(t,e,2,!1),r.add(n))}function Op(e,t,r){var n=0;t&&(n|=4),N_(r,e,n,t)}var wf="_reactListening"+Math.random().toString(36).slice(2);function D0(e){if(!e[wf]){e[wf]=!0,M5.forEach(function(r){r!=="selectionchange"&&(G9.has(r)||Op(r,!1,e),Op(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[wf]||(t[wf]=!0,Op("selectionchange",!1,t))}}function N_(e,t,r,n){switch(h_(t)){case 1:var i=n9;break;case 4:i=i9;break;default:i=r2}r=i.bind(null,t,r,e),i=void 0,!Mg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Lp(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=uo(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}Z5(function(){var f=a,d=Jm(r),p=[];e:{var g=P_.get(e);if(g!==void 0){var v=i2,m=e;switch(e){case"keypress":if(Kf(r)===0)break e;case"keydown":case"keyup":v=y9;break;case"focusin":m="focus",v=Fp;break;case"focusout":m="blur",v=Fp;break;case"beforeblur":case"afterblur":v=Fp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=F4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=o9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=S9;break;case E_:case C_:case T_:v=u9;break;case A_:v=E9;break;case"scroll":v=a9;break;case"wheel":v=T9;break;case"copy":case"cut":case"paste":v=d9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=R4}var y=(t&4)!==0,E=!y&&e==="scroll",k=y?g!==null?g+"Capture":null:g;y=[];for(var w=f,x;w!==null;){x=w;var C=x.stateNode;if(x.tag===5&&C!==null&&(x=C,k!==null&&(C=A0(w,k),C!=null&&y.push(b0(w,C,x)))),E)break;w=w.return}0<y.length&&(g=new v(g,m,null,r,d),p.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&r!==Og&&(m=r.relatedTarget||r.fromElement)&&(uo(m)||m[za]))break e;if((v||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,v?(m=r.relatedTarget||r.toElement,v=f,m=m?uo(m):null,m!==null&&(E=No(m),m!==E||m.tag!==5&&m.tag!==6)&&(m=null)):(v=null,m=f),v!==m)){if(y=F4,C="onMouseLeave",k="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(y=R4,C="onPointerLeave",k="onPointerEnter",w="pointer"),E=v==null?g:_l(v),x=m==null?g:_l(m),g=new y(C,w+"leave",v,r,d),g.target=E,g.relatedTarget=x,C=null,uo(d)===f&&(y=new y(k,w+"enter",m,r,d),y.target=x,y.relatedTarget=E,C=y),E=C,v&&m)t:{for(y=v,k=m,w=0,x=y;x;x=sl(x))w++;for(x=0,C=k;C;C=sl(C))x++;for(;0<w-x;)y=sl(y),w--;for(;0<x-w;)k=sl(k),x--;for(;w--;){if(y===k||k!==null&&y===k.alternate)break t;y=sl(y),k=sl(k)}y=null}else y=null;v!==null&&V4(p,g,v,y,!1),m!==null&&E!==null&&V4(p,E,m,y,!0)}}e:{if(g=f?_l(f):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var A=D9;else if(b4(g))if(y_)A=M9;else{A=O9;var P=b9}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(A=L9);if(A&&(A=A(e,f))){v_(p,A,r,d);break e}P&&P(e,g,f),e==="focusout"&&(P=g._wrapperState)&&P.controlled&&g.type==="number"&&Ng(g,"number",g.value)}switch(P=f?_l(f):window,e){case"focusin":(b4(P)||P.contentEditable==="true")&&(vl=P,Vg=f,f0=null);break;case"focusout":f0=Vg=vl=null;break;case"mousedown":Gg=!0;break;case"contextmenu":case"mouseup":case"dragend":Gg=!1,U4(p,r,d);break;case"selectionchange":if(j9)break;case"keydown":case"keyup":U4(p,r,d)}var N;if(s2)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else xl?m_(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(g_&&r.locale!=="ko"&&(xl||F!=="onCompositionStart"?F==="onCompositionEnd"&&xl&&(N=p_()):(xs=d,n2="value"in xs?xs.value:xs.textContent,xl=!0)),P=fd(f,F),0<P.length&&(F=new N4(F,e,null,r,d),p.push({event:F,listeners:P}),N?F.data=N:(N=x_(r),N!==null&&(F.data=N)))),(N=P9?F9(e,r):N9(e,r))&&(f=fd(f,"onBeforeInput"),0<f.length&&(d=new N4("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:f}),d.data=N))}F_(p,t)})}function b0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function fd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=A0(e,r),a!=null&&n.unshift(b0(e,a,i)),a=A0(e,t),a!=null&&n.push(b0(e,a,i))),e=e.return}return n}function sl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V4(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,f=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&f!==null&&(o=f,i?(u=A0(r,a),u!=null&&s.unshift(b0(r,u,o))):i||(u=A0(r,a),u!=null&&s.push(b0(r,u,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var H9=/\r\n?/g,W9=/\u0000|\uFFFD/g;function G4(e){return(typeof e=="string"?e:""+e).replace(H9,`
`).replace(W9,"")}function Sf(e,t,r){if(t=G4(t),G4(e)!==t&&r)throw Error(Ie(425))}function dd(){}var Hg=null,Wg=null;function $g(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xg=typeof setTimeout=="function"?setTimeout:void 0,$9=typeof clearTimeout=="function"?clearTimeout:void 0,H4=typeof Promise=="function"?Promise:void 0,X9=typeof queueMicrotask=="function"?queueMicrotask:typeof H4<"u"?function(e){return H4.resolve(null).then(e).catch(K9)}:Xg;function K9(e){setTimeout(function(){throw e})}function Mp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),N0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);N0(t)}function Es(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function W4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var rc=Math.random().toString(36).slice(2),fa="__reactFiber$"+rc,O0="__reactProps$"+rc,za="__reactContainer$"+rc,Kg="__reactEvents$"+rc,Y9="__reactListeners$"+rc,Q9="__reactHandles$"+rc;function uo(e){var t=e[fa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[za]||r[fa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=W4(e);e!==null;){if(r=e[fa])return r;e=W4(e)}return t}e=r,r=e.parentNode}return null}function su(e){return e=e[fa]||e[za],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _l(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ie(33))}function Zd(e){return e[O0]||null}var Yg=[],wl=-1;function Ms(e){return{current:e}}function Yt(e){0>wl||(e.current=Yg[wl],Yg[wl]=null,wl--)}function Wt(e,t){wl++,Yg[wl]=e.current,e.current=t}var Rs={},mn=Ms(Rs),zn=Ms(!1),_o=Rs;function Ul(e,t){var r=e.type.contextTypes;if(!r)return Rs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vn(e){return e=e.childContextTypes,e!=null}function hd(){Yt(zn),Yt(mn)}function $4(e,t,r){if(mn.current!==Rs)throw Error(Ie(168));Wt(mn,t),Wt(zn,r)}function R_(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ie(108,bk(e)||"Unknown",i));return sr({},r,n)}function pd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rs,_o=mn.current,Wt(mn,e),Wt(zn,zn.current),!0}function X4(e,t,r){var n=e.stateNode;if(!n)throw Error(Ie(169));r?(e=R_(e,t,_o),n.__reactInternalMemoizedMergedChildContext=e,Yt(zn),Yt(mn),Wt(mn,e)):Yt(zn),Wt(zn,r)}var Ra=null,eh=!1,Bp=!1;function I_(e){Ra===null?Ra=[e]:Ra.push(e)}function q9(e){eh=!0,I_(e)}function Bs(){if(!Bp&&Ra!==null){Bp=!0;var e=0,t=Bt;try{var r=Ra;for(Bt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ra=null,eh=!1}catch(i){throw Ra!==null&&(Ra=Ra.slice(e+1)),n_(Zm,Bs),i}finally{Bt=t,Bp=!1}}return null}var Sl=[],kl=0,gd=null,md=0,yi=[],_i=0,wo=null,Da=1,ba="";function so(e,t){Sl[kl++]=md,Sl[kl++]=gd,gd=e,md=t}function D_(e,t,r){yi[_i++]=Da,yi[_i++]=ba,yi[_i++]=wo,wo=e;var n=Da;e=ba;var i=32-Wi(n)-1;n&=~(1<<i),r+=1;var a=32-Wi(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Da=1<<32-Wi(t)+i|r<<i|n,ba=a+e}else Da=1<<a|r<<i|n,ba=e}function l2(e){e.return!==null&&(so(e,1),D_(e,1,0))}function c2(e){for(;e===gd;)gd=Sl[--kl],Sl[kl]=null,md=Sl[--kl],Sl[kl]=null;for(;e===wo;)wo=yi[--_i],yi[_i]=null,ba=yi[--_i],yi[_i]=null,Da=yi[--_i],yi[_i]=null}var Zn=null,Jn=null,er=!1,zi=null;function b_(e,t){var r=Si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function K4(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=Es(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zn=e,Jn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wo!==null?{id:Da,overflow:ba}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Zn=e,Jn=null,!0):!1;default:return!1}}function Qg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qg(e){if(er){var t=Jn;if(t){var r=t;if(!K4(e,t)){if(Qg(e))throw Error(Ie(418));t=Es(r.nextSibling);var n=Zn;t&&K4(e,t)?b_(n,r):(e.flags=e.flags&-4097|2,er=!1,Zn=e)}}else{if(Qg(e))throw Error(Ie(418));e.flags=e.flags&-4097|2,er=!1,Zn=e}}}function Y4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zn=e}function kf(e){if(e!==Zn)return!1;if(!er)return Y4(e),er=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!$g(e.type,e.memoizedProps)),t&&(t=Jn)){if(Qg(e))throw O_(),Error(Ie(418));for(;t;)b_(e,t),t=Es(t.nextSibling)}if(Y4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Jn=Es(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Jn=null}}else Jn=Zn?Es(e.stateNode.nextSibling):null;return!0}function O_(){for(var e=Jn;e;)e=Es(e.nextSibling)}function jl(){Jn=Zn=null,er=!1}function u2(e){zi===null?zi=[e]:zi.push(e)}var J9=$a.ReactCurrentBatchConfig;function Bc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ie(309));var n=r.stateNode}if(!n)throw Error(Ie(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ie(284));if(!r._owner)throw Error(Ie(290,e))}return e}function Ef(e,t){throw e=Object.prototype.toString.call(t),Error(Ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Q4(e){var t=e._init;return t(e._payload)}function L_(e){function t(k,w){if(e){var x=k.deletions;x===null?(k.deletions=[w],k.flags|=16):x.push(w)}}function r(k,w){if(!e)return null;for(;w!==null;)t(k,w),w=w.sibling;return null}function n(k,w){for(k=new Map;w!==null;)w.key!==null?k.set(w.key,w):k.set(w.index,w),w=w.sibling;return k}function i(k,w){return k=Ps(k,w),k.index=0,k.sibling=null,k}function a(k,w,x){return k.index=x,e?(x=k.alternate,x!==null?(x=x.index,x<w?(k.flags|=2,w):x):(k.flags|=2,w)):(k.flags|=1048576,w)}function s(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,w,x,C){return w===null||w.tag!==6?(w=Wp(x,k.mode,C),w.return=k,w):(w=i(w,x),w.return=k,w)}function u(k,w,x,C){var A=x.type;return A===ml?d(k,w,x.props.children,C,x.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===fs&&Q4(A)===w.type)?(C=i(w,x.props),C.ref=Bc(k,w,x),C.return=k,C):(C=td(x.type,x.key,x.props,null,k.mode,C),C.ref=Bc(k,w,x),C.return=k,C)}function f(k,w,x,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=$p(x,k.mode,C),w.return=k,w):(w=i(w,x.children||[]),w.return=k,w)}function d(k,w,x,C,A){return w===null||w.tag!==7?(w=xo(x,k.mode,C,A),w.return=k,w):(w=i(w,x),w.return=k,w)}function p(k,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Wp(""+w,k.mode,x),w.return=k,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case hf:return x=td(w.type,w.key,w.props,null,k.mode,x),x.ref=Bc(k,null,w),x.return=k,x;case gl:return w=$p(w,k.mode,x),w.return=k,w;case fs:var C=w._init;return p(k,C(w._payload),x)}if(Jc(w)||Dc(w))return w=xo(w,k.mode,x,null),w.return=k,w;Ef(k,w)}return null}function g(k,w,x,C){var A=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return A!==null?null:o(k,w,""+x,C);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case hf:return x.key===A?u(k,w,x,C):null;case gl:return x.key===A?f(k,w,x,C):null;case fs:return A=x._init,g(k,w,A(x._payload),C)}if(Jc(x)||Dc(x))return A!==null?null:d(k,w,x,C,null);Ef(k,x)}return null}function v(k,w,x,C,A){if(typeof C=="string"&&C!==""||typeof C=="number")return k=k.get(x)||null,o(w,k,""+C,A);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case hf:return k=k.get(C.key===null?x:C.key)||null,u(w,k,C,A);case gl:return k=k.get(C.key===null?x:C.key)||null,f(w,k,C,A);case fs:var P=C._init;return v(k,w,x,P(C._payload),A)}if(Jc(C)||Dc(C))return k=k.get(x)||null,d(w,k,C,A,null);Ef(w,C)}return null}function m(k,w,x,C){for(var A=null,P=null,N=w,F=w=0,I=null;N!==null&&F<x.length;F++){N.index>F?(I=N,N=null):I=N.sibling;var D=g(k,N,x[F],C);if(D===null){N===null&&(N=I);break}e&&N&&D.alternate===null&&t(k,N),w=a(D,w,F),P===null?A=D:P.sibling=D,P=D,N=I}if(F===x.length)return r(k,N),er&&so(k,F),A;if(N===null){for(;F<x.length;F++)N=p(k,x[F],C),N!==null&&(w=a(N,w,F),P===null?A=N:P.sibling=N,P=N);return er&&so(k,F),A}for(N=n(k,N);F<x.length;F++)I=v(N,k,F,x[F],C),I!==null&&(e&&I.alternate!==null&&N.delete(I.key===null?F:I.key),w=a(I,w,F),P===null?A=I:P.sibling=I,P=I);return e&&N.forEach(function(U){return t(k,U)}),er&&so(k,F),A}function y(k,w,x,C){var A=Dc(x);if(typeof A!="function")throw Error(Ie(150));if(x=A.call(x),x==null)throw Error(Ie(151));for(var P=A=null,N=w,F=w=0,I=null,D=x.next();N!==null&&!D.done;F++,D=x.next()){N.index>F?(I=N,N=null):I=N.sibling;var U=g(k,N,D.value,C);if(U===null){N===null&&(N=I);break}e&&N&&U.alternate===null&&t(k,N),w=a(U,w,F),P===null?A=U:P.sibling=U,P=U,N=I}if(D.done)return r(k,N),er&&so(k,F),A;if(N===null){for(;!D.done;F++,D=x.next())D=p(k,D.value,C),D!==null&&(w=a(D,w,F),P===null?A=D:P.sibling=D,P=D);return er&&so(k,F),A}for(N=n(k,N);!D.done;F++,D=x.next())D=v(N,k,F,D.value,C),D!==null&&(e&&D.alternate!==null&&N.delete(D.key===null?F:D.key),w=a(D,w,F),P===null?A=D:P.sibling=D,P=D);return e&&N.forEach(function(O){return t(k,O)}),er&&so(k,F),A}function E(k,w,x,C){if(typeof x=="object"&&x!==null&&x.type===ml&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case hf:e:{for(var A=x.key,P=w;P!==null;){if(P.key===A){if(A=x.type,A===ml){if(P.tag===7){r(k,P.sibling),w=i(P,x.props.children),w.return=k,k=w;break e}}else if(P.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===fs&&Q4(A)===P.type){r(k,P.sibling),w=i(P,x.props),w.ref=Bc(k,P,x),w.return=k,k=w;break e}r(k,P);break}else t(k,P);P=P.sibling}x.type===ml?(w=xo(x.props.children,k.mode,C,x.key),w.return=k,k=w):(C=td(x.type,x.key,x.props,null,k.mode,C),C.ref=Bc(k,w,x),C.return=k,k=C)}return s(k);case gl:e:{for(P=x.key;w!==null;){if(w.key===P)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(k,w.sibling),w=i(w,x.children||[]),w.return=k,k=w;break e}else{r(k,w);break}else t(k,w);w=w.sibling}w=$p(x,k.mode,C),w.return=k,k=w}return s(k);case fs:return P=x._init,E(k,w,P(x._payload),C)}if(Jc(x))return m(k,w,x,C);if(Dc(x))return y(k,w,x,C);Ef(k,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(k,w.sibling),w=i(w,x),w.return=k,k=w):(r(k,w),w=Wp(x,k.mode,C),w.return=k,k=w),s(k)):r(k,w)}return E}var zl=L_(!0),M_=L_(!1),xd=Ms(null),vd=null,El=null,f2=null;function d2(){f2=El=vd=null}function h2(e){var t=xd.current;Yt(xd),e._currentValue=t}function Jg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Il(e,t){vd=e,f2=El=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(jn=!0),e.firstContext=null)}function Ei(e){var t=e._currentValue;if(f2!==e)if(e={context:e,memoizedValue:t,next:null},El===null){if(vd===null)throw Error(Ie(308));El=e,vd.dependencies={lanes:0,firstContext:e}}else El=El.next=e;return t}var fo=null;function p2(e){fo===null?fo=[e]:fo.push(e)}function B_(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,p2(t)):(r.next=i.next,i.next=r),t.interleaved=r,Va(e,n)}function Va(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ds=!1;function g2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U_(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function La(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Pt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Va(e,r)}return i=n.interleaved,i===null?(t.next=t,p2(n)):(t.next=i.next,i.next=t),n.interleaved=t,Va(e,r)}function Yf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e2(e,r)}}function q4(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function yd(e,t,r,n){var i=e.updateQueue;ds=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,f=u.next;u.next=null,s===null?a=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=f:o.next=f,d.lastBaseUpdate=u))}if(a!==null){var p=i.baseState;s=0,d=f=u=null,o=a;do{var g=o.lane,v=o.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,y=o;switch(g=t,v=r,y.tag){case 1:if(m=y.payload,typeof m=="function"){p=m.call(v,p,g);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,g=typeof m=="function"?m.call(v,p,g):m,g==null)break e;p=sr({},p,g);break e;case 2:ds=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[o]:g.push(o))}else v={eventTime:v,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(f=d=v,u=p):d=d.next=v,s|=g;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;g=o,o=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ko|=s,e.lanes=s,e.memoizedState=p}}function J4(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ie(191,i));i.call(n)}}}var ou={},pa=Ms(ou),L0=Ms(ou),M0=Ms(ou);function ho(e){if(e===ou)throw Error(Ie(174));return e}function m2(e,t){switch(Wt(M0,t),Wt(L0,e),Wt(pa,ou),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ig(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ig(t,e)}Yt(pa),Wt(pa,t)}function Vl(){Yt(pa),Yt(L0),Yt(M0)}function j_(e){ho(M0.current);var t=ho(pa.current),r=Ig(t,e.type);t!==r&&(Wt(L0,e),Wt(pa,r))}function x2(e){L0.current===e&&(Yt(pa),Yt(L0))}var ir=Ms(0);function _d(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Up=[];function v2(){for(var e=0;e<Up.length;e++)Up[e]._workInProgressVersionPrimary=null;Up.length=0}var Qf=$a.ReactCurrentDispatcher,jp=$a.ReactCurrentBatchConfig,So=0,ar=null,Fr=null,Gr=null,wd=!1,d0=!1,B0=0,Z9=0;function ln(){throw Error(Ie(321))}function y2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qi(e[r],t[r]))return!1;return!0}function _2(e,t,r,n,i,a){if(So=a,ar=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qf.current=e===null||e.memoizedState===null?nE:iE,e=r(n,i),d0){a=0;do{if(d0=!1,B0=0,25<=a)throw Error(Ie(301));a+=1,Gr=Fr=null,t.updateQueue=null,Qf.current=aE,e=r(n,i)}while(d0)}if(Qf.current=Sd,t=Fr!==null&&Fr.next!==null,So=0,Gr=Fr=ar=null,wd=!1,t)throw Error(Ie(300));return e}function w2(){var e=B0!==0;return B0=0,e}function ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?ar.memoizedState=Gr=e:Gr=Gr.next=e,Gr}function Ci(){if(Fr===null){var e=ar.alternate;e=e!==null?e.memoizedState:null}else e=Fr.next;var t=Gr===null?ar.memoizedState:Gr.next;if(t!==null)Gr=t,Fr=e;else{if(e===null)throw Error(Ie(310));Fr=e,e={memoizedState:Fr.memoizedState,baseState:Fr.baseState,baseQueue:Fr.baseQueue,queue:Fr.queue,next:null},Gr===null?ar.memoizedState=Gr=e:Gr=Gr.next=e}return Gr}function U0(e,t){return typeof t=="function"?t(e):t}function zp(e){var t=Ci(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=Fr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,f=a;do{var d=f.lane;if((So&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(o=u=p,s=n):u=u.next=p,ar.lanes|=d,ko|=d}f=f.next}while(f!==null&&f!==a);u===null?s=n:u.next=o,Qi(n,t.memoizedState)||(jn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,ar.lanes|=a,ko|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vp(e){var t=Ci(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Qi(a,t.memoizedState)||(jn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function z_(){}function V_(e,t){var r=ar,n=Ci(),i=t(),a=!Qi(n.memoizedState,i);if(a&&(n.memoizedState=i,jn=!0),n=n.queue,S2(W_.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Gr!==null&&Gr.memoizedState.tag&1){if(r.flags|=2048,j0(9,H_.bind(null,r,n,i,t),void 0,null),Hr===null)throw Error(Ie(349));So&30||G_(r,t,i)}return i}function G_(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function H_(e,t,r,n){t.value=r,t.getSnapshot=n,$_(t)&&X_(e)}function W_(e,t,r){return r(function(){$_(t)&&X_(e)})}function $_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qi(e,r)}catch{return!0}}function X_(e){var t=Va(e,1);t!==null&&$i(t,e,1,-1)}function Z4(e){var t=ua();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:U0,lastRenderedState:e},t.queue=e,e=e.dispatch=rE.bind(null,ar,e),[t.memoizedState,e]}function j0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ar.updateQueue,t===null?(t={lastEffect:null,stores:null},ar.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function K_(){return Ci().memoizedState}function qf(e,t,r,n){var i=ua();ar.flags|=e,i.memoizedState=j0(1|t,r,void 0,n===void 0?null:n)}function th(e,t,r,n){var i=Ci();n=n===void 0?null:n;var a=void 0;if(Fr!==null){var s=Fr.memoizedState;if(a=s.destroy,n!==null&&y2(n,s.deps)){i.memoizedState=j0(t,r,a,n);return}}ar.flags|=e,i.memoizedState=j0(1|t,r,a,n)}function ey(e,t){return qf(8390656,8,e,t)}function S2(e,t){return th(2048,8,e,t)}function Y_(e,t){return th(4,2,e,t)}function Q_(e,t){return th(4,4,e,t)}function q_(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function J_(e,t,r){return r=r!=null?r.concat([e]):null,th(4,4,q_.bind(null,t,e),r)}function k2(){}function Z_(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function e6(e,t){var r=Ci();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function t6(e,t,r){return So&21?(Qi(r,t)||(r=s_(),ar.lanes|=r,ko|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,jn=!0),e.memoizedState=r)}function eE(e,t){var r=Bt;Bt=r!==0&&4>r?r:4,e(!0);var n=jp.transition;jp.transition={};try{e(!1),t()}finally{Bt=r,jp.transition=n}}function r6(){return Ci().memoizedState}function tE(e,t,r){var n=As(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},n6(e))i6(t,r);else if(r=B_(e,t,r,n),r!==null){var i=Cn();$i(r,e,n,i),a6(r,t,n)}}function rE(e,t,r){var n=As(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(n6(e))i6(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Qi(o,s)){var u=t.interleaved;u===null?(i.next=i,p2(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=B_(e,t,i,n),r!==null&&(i=Cn(),$i(r,e,n,i),a6(r,t,n))}}function n6(e){var t=e.alternate;return e===ar||t!==null&&t===ar}function i6(e,t){d0=wd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function a6(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e2(e,r)}}var Sd={readContext:Ei,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useInsertionEffect:ln,useLayoutEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useMutableSource:ln,useSyncExternalStore:ln,useId:ln,unstable_isNewReconciler:!1},nE={readContext:Ei,useCallback:function(e,t){return ua().memoizedState=[e,t===void 0?null:t],e},useContext:Ei,useEffect:ey,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,qf(4194308,4,q_.bind(null,t,e),r)},useLayoutEffect:function(e,t){return qf(4194308,4,e,t)},useInsertionEffect:function(e,t){return qf(4,2,e,t)},useMemo:function(e,t){var r=ua();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ua();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tE.bind(null,ar,e),[n.memoizedState,e]},useRef:function(e){var t=ua();return e={current:e},t.memoizedState=e},useState:Z4,useDebugValue:k2,useDeferredValue:function(e){return ua().memoizedState=e},useTransition:function(){var e=Z4(!1),t=e[0];return e=eE.bind(null,e[1]),ua().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ar,i=ua();if(er){if(r===void 0)throw Error(Ie(407));r=r()}else{if(r=t(),Hr===null)throw Error(Ie(349));So&30||G_(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,ey(W_.bind(null,n,a,e),[e]),n.flags|=2048,j0(9,H_.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ua(),t=Hr.identifierPrefix;if(er){var r=ba,n=Da;r=(n&~(1<<32-Wi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=B0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Z9++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iE={readContext:Ei,useCallback:Z_,useContext:Ei,useEffect:S2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:zp,useRef:K_,useState:function(){return zp(U0)},useDebugValue:k2,useDeferredValue:function(e){var t=Ci();return t6(t,Fr.memoizedState,e)},useTransition:function(){var e=zp(U0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1},aE={readContext:Ei,useCallback:Z_,useContext:Ei,useEffect:S2,useImperativeHandle:J_,useInsertionEffect:Y_,useLayoutEffect:Q_,useMemo:e6,useReducer:Vp,useRef:K_,useState:function(){return Vp(U0)},useDebugValue:k2,useDeferredValue:function(e){var t=Ci();return Fr===null?t.memoizedState=e:t6(t,Fr.memoizedState,e)},useTransition:function(){var e=Vp(U0)[0],t=Ci().memoizedState;return[e,t]},useMutableSource:z_,useSyncExternalStore:V_,useId:r6,unstable_isNewReconciler:!1};function Ui(e,t){if(e&&e.defaultProps){t=sr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Zg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:sr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var rh={isMounted:function(e){return(e=e._reactInternals)?No(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Cn(),i=As(e),a=La(n,i);a.payload=t,r!=null&&(a.callback=r),t=Cs(e,a,i),t!==null&&($i(t,e,i,n),Yf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Cn(),i=As(e),a=La(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Cs(e,a,i),t!==null&&($i(t,e,i,n),Yf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Cn(),n=As(e),i=La(r,n);i.tag=2,t!=null&&(i.callback=t),t=Cs(e,i,n),t!==null&&($i(t,e,n,r),Yf(t,e,n))}};function ty(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!I0(r,n)||!I0(i,a):!0}function s6(e,t,r){var n=!1,i=Rs,a=t.contextType;return typeof a=="object"&&a!==null?a=Ei(a):(i=Vn(t)?_o:mn.current,n=t.contextTypes,a=(n=n!=null)?Ul(e,i):Rs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=rh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ry(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&rh.enqueueReplaceState(t,t.state,null)}function em(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},g2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Ei(a):(a=Vn(t)?_o:mn.current,i.context=Ul(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Zg(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&rh.enqueueReplaceState(i,i.state,null),yd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Gl(e,t){try{var r="",n=t;do r+=Dk(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Gp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function tm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sE=typeof WeakMap=="function"?WeakMap:Map;function o6(e,t,r){r=La(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ed||(Ed=!0,fm=n),tm(e,t)},r}function l6(e,t,r){r=La(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){tm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){tm(e,t),typeof n!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function ny(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sE;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_E.bind(null,e,t,r),t.then(e,e))}function iy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ay(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=La(-1,1),t.tag=2,Cs(r,t,1))),r.lanes|=1),e)}var oE=$a.ReactCurrentOwner,jn=!1;function wn(e,t,r,n){t.child=e===null?M_(t,null,r,n):zl(t,e.child,r,n)}function sy(e,t,r,n,i){r=r.render;var a=t.ref;return Il(t,i),n=_2(e,t,r,n,a,i),r=w2(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i)):(er&&r&&l2(t),t.flags|=1,wn(e,t,n,i),t.child)}function oy(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!R2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,c6(e,t,a,n,i)):(e=td(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:I0,r(s,n)&&e.ref===t.ref)return Ga(e,t,i)}return t.flags|=1,e=Ps(a,n),e.ref=t.ref,e.return=t,t.child=e}function c6(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(I0(a,n)&&e.ref===t.ref)if(jn=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(jn=!0);else return t.lanes=e.lanes,Ga(e,t,i)}return rm(e,t,r,n,i)}function u6(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wt(Tl,Yn),Yn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Wt(Tl,Yn),Yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Wt(Tl,Yn),Yn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Wt(Tl,Yn),Yn|=n;return wn(e,t,i,r),t.child}function f6(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function rm(e,t,r,n,i){var a=Vn(r)?_o:mn.current;return a=Ul(t,a),Il(t,i),r=_2(e,t,r,n,a,i),n=w2(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ga(e,t,i)):(er&&n&&l2(t),t.flags|=1,wn(e,t,r,i),t.child)}function ly(e,t,r,n,i){if(Vn(r)){var a=!0;pd(t)}else a=!1;if(Il(t,i),t.stateNode===null)Jf(e,t),s6(t,r,n),em(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,f=r.contextType;typeof f=="object"&&f!==null?f=Ei(f):(f=Vn(r)?_o:mn.current,f=Ul(t,f));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==f)&&ry(t,s,n,f),ds=!1;var g=t.memoizedState;s.state=g,yd(t,n,s,i),u=t.memoizedState,o!==n||g!==u||zn.current||ds?(typeof d=="function"&&(Zg(t,r,d,n),u=t.memoizedState),(o=ds||ty(t,r,o,n,g,u,f))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=f,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,U_(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:Ui(t.type,o),s.props=f,p=t.pendingProps,g=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=Ei(u):(u=Vn(r)?_o:mn.current,u=Ul(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==p||g!==u)&&ry(t,s,n,u),ds=!1,g=t.memoizedState,s.state=g,yd(t,n,s,i);var m=t.memoizedState;o!==p||g!==m||zn.current||ds?(typeof v=="function"&&(Zg(t,r,v,n),m=t.memoizedState),(f=ds||ty(t,r,f,n,g,m,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=u,n=f):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return nm(e,t,r,n,a,i)}function nm(e,t,r,n,i,a){f6(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&X4(t,r,!1),Ga(e,t,a);n=t.stateNode,oE.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=zl(t,e.child,null,a),t.child=zl(t,null,o,a)):wn(e,t,o,a),t.memoizedState=n.state,i&&X4(t,r,!0),t.child}function d6(e){var t=e.stateNode;t.pendingContext?$4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$4(e,t.context,!1),m2(e,t.containerInfo)}function cy(e,t,r,n,i){return jl(),u2(i),t.flags|=256,wn(e,t,r,n),t.child}var im={dehydrated:null,treeContext:null,retryLane:0};function am(e){return{baseLanes:e,cachePool:null,transitions:null}}function h6(e,t,r){var n=t.pendingProps,i=ir.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Wt(ir,i&1),e===null)return qg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=ah(s,n,0,null),e=xo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=am(r),t.memoizedState=im,e):E2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lE(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ps(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Ps(o,a):(a=xo(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?am(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=im,n}return a=e.child,e=a.sibling,n=Ps(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function E2(e,t){return t=ah({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cf(e,t,r,n){return n!==null&&u2(n),zl(t,e.child,null,r),e=E2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lE(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=Gp(Error(Ie(422))),Cf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=ah({mode:"visible",children:n.children},i,0,null),a=xo(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&zl(t,e.child,null,s),t.child.memoizedState=am(s),t.memoizedState=im,a);if(!(t.mode&1))return Cf(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Ie(419)),n=Gp(a,n,void 0),Cf(e,t,s,n)}if(o=(s&e.childLanes)!==0,jn||o){if(n=Hr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Va(e,i),$i(n,e,i,-1))}return N2(),n=Gp(Error(Ie(421))),Cf(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=wE.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Jn=Es(i.nextSibling),Zn=t,er=!0,zi=null,e!==null&&(yi[_i++]=Da,yi[_i++]=ba,yi[_i++]=wo,Da=e.id,ba=e.overflow,wo=t),t=E2(t,n.children),t.flags|=4096,t)}function uy(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Jg(e.return,t,r)}function Hp(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function p6(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wn(e,t,n.children,r),n=ir.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uy(e,r,t);else if(e.tag===19)uy(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Wt(ir,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&_d(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Hp(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&_d(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Hp(t,!0,r,null,a);break;case"together":Hp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ko|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ie(153));if(t.child!==null){for(e=t.child,r=Ps(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ps(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cE(e,t,r){switch(t.tag){case 3:d6(t),jl();break;case 5:j_(t);break;case 1:Vn(t.type)&&pd(t);break;case 4:m2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Wt(xd,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Wt(ir,ir.current&1),t.flags|=128,null):r&t.child.childLanes?h6(e,t,r):(Wt(ir,ir.current&1),e=Ga(e,t,r),e!==null?e.sibling:null);Wt(ir,ir.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return p6(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Wt(ir,ir.current),n)break;return null;case 22:case 23:return t.lanes=0,u6(e,t,r)}return Ga(e,t,r)}var g6,sm,m6,x6;g6=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};sm=function(){};m6=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ho(pa.current);var a=null;switch(r){case"input":i=Pg(e,i),n=Pg(e,n),a=[];break;case"select":i=sr({},i,{value:void 0}),n=sr({},n,{value:void 0}),a=[];break;case"textarea":i=Rg(e,i),n=Rg(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=dd)}Dg(r,n);var s;r=null;for(f in i)if(!n.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var o=i[f];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(C0.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var u=n[f];if(o=i!=null?i[f]:void 0,n.hasOwnProperty(f)&&u!==o&&(u!=null||o!=null))if(f==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(C0.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Kt("scroll",e),a||o===u||(a=[])):(a=a||[]).push(f,u))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};x6=function(e,t,r,n){r!==n&&(t.flags|=4)};function Uc(e,t){if(!er)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uE(e,t,r){var n=t.pendingProps;switch(c2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return Vn(t.type)&&hd(),cn(t),null;case 3:return n=t.stateNode,Vl(),Yt(zn),Yt(mn),v2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(kf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zi!==null&&(pm(zi),zi=null))),sm(e,t),cn(t),null;case 5:x2(t);var i=ho(M0.current);if(r=t.type,e!==null&&t.stateNode!=null)m6(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ie(166));return cn(t),null}if(e=ho(pa.current),kf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[fa]=t,n[O0]=a,e=(t.mode&1)!==0,r){case"dialog":Kt("cancel",n),Kt("close",n);break;case"iframe":case"object":case"embed":Kt("load",n);break;case"video":case"audio":for(i=0;i<e0.length;i++)Kt(e0[i],n);break;case"source":Kt("error",n);break;case"img":case"image":case"link":Kt("error",n),Kt("load",n);break;case"details":Kt("toggle",n);break;case"input":y4(n,a),Kt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Kt("invalid",n);break;case"textarea":w4(n,a),Kt("invalid",n)}Dg(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Sf(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Sf(n.textContent,o,e),i=["children",""+o]):C0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Kt("scroll",n)}switch(r){case"input":pf(n),_4(n,a,!0);break;case"textarea":pf(n),S4(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=dd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W5(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[fa]=t,e[O0]=n,g6(e,t,!1,!1),t.stateNode=e;e:{switch(s=bg(r,n),r){case"dialog":Kt("cancel",e),Kt("close",e),i=n;break;case"iframe":case"object":case"embed":Kt("load",e),i=n;break;case"video":case"audio":for(i=0;i<e0.length;i++)Kt(e0[i],e);i=n;break;case"source":Kt("error",e),i=n;break;case"img":case"image":case"link":Kt("error",e),Kt("load",e),i=n;break;case"details":Kt("toggle",e),i=n;break;case"input":y4(e,n),i=Pg(e,n),Kt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=sr({},n,{value:void 0}),Kt("invalid",e);break;case"textarea":w4(e,n),i=Rg(e,n),Kt("invalid",e);break;default:i=n}Dg(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?K5(e,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$5(e,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&T0(e,u):typeof u=="number"&&T0(e,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(C0.hasOwnProperty(a)?u!=null&&a==="onScroll"&&Kt("scroll",e):u!=null&&Km(e,a,u,s))}switch(r){case"input":pf(e),_4(e,n,!1);break;case"textarea":pf(e),S4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ns(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Pl(e,!!n.multiple,a,!1):n.defaultValue!=null&&Pl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=dd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cn(t),null;case 6:if(e&&t.stateNode!=null)x6(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ie(166));if(r=ho(M0.current),ho(pa.current),kf(t)){if(n=t.stateNode,r=t.memoizedProps,n[fa]=t,(a=n.nodeValue!==r)&&(e=Zn,e!==null))switch(e.tag){case 3:Sf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Sf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[fa]=t,t.stateNode=n}return cn(t),null;case 13:if(Yt(ir),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(er&&Jn!==null&&t.mode&1&&!(t.flags&128))O_(),jl(),t.flags|=98560,a=!1;else if(a=kf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ie(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ie(317));a[fa]=t}else jl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cn(t),a=!1}else zi!==null&&(pm(zi),zi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ir.current&1?Nr===0&&(Nr=3):N2())),t.updateQueue!==null&&(t.flags|=4),cn(t),null);case 4:return Vl(),sm(e,t),e===null&&D0(t.stateNode.containerInfo),cn(t),null;case 10:return h2(t.type._context),cn(t),null;case 17:return Vn(t.type)&&hd(),cn(t),null;case 19:if(Yt(ir),a=t.memoizedState,a===null)return cn(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)Uc(a,!1);else{if(Nr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=_d(e),s!==null){for(t.flags|=128,Uc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Wt(ir,ir.current&1|2),t.child}e=e.sibling}a.tail!==null&&gr()>Hl&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304)}else{if(!n)if(e=_d(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!er)return cn(t),null}else 2*gr()-a.renderingStartTime>Hl&&r!==1073741824&&(t.flags|=128,n=!0,Uc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=gr(),t.sibling=null,r=ir.current,Wt(ir,n?r&1|2:r&1),t):(cn(t),null);case 22:case 23:return F2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yn&1073741824&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),null;case 24:return null;case 25:return null}throw Error(Ie(156,t.tag))}function fE(e,t){switch(c2(t),t.tag){case 1:return Vn(t.type)&&hd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Vl(),Yt(zn),Yt(mn),v2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x2(t),null;case 13:if(Yt(ir),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ie(340));jl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Yt(ir),null;case 4:return Vl(),null;case 10:return h2(t.type._context),null;case 22:case 23:return F2(),null;case 24:return null;default:return null}}var Tf=!1,dn=!1,dE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Cl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){lr(e,t,n)}else r.current=null}function om(e,t,r){try{r()}catch(n){lr(e,t,n)}}var fy=!1;function hE(e,t){if(Hg=cd,e=S_(),o2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,f=0,d=0,p=e,g=null;t:for(;;){for(var v;p!==r||i!==0&&p.nodeType!==3||(o=s+i),p!==a||n!==0&&p.nodeType!==3||(u=s+n),p.nodeType===3&&(s+=p.nodeValue.length),(v=p.firstChild)!==null;)g=p,p=v;for(;;){if(p===e)break t;if(g===r&&++f===i&&(o=s),g===a&&++d===n&&(u=s),(v=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=v}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Wg={focusedElem:e,selectionRange:r},cd=!1,$e=t;$e!==null;)if(t=$e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$e=e;else for(;$e!==null;){t=$e;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,E=m.memoizedState,k=t.stateNode,w=k.getSnapshotBeforeUpdate(t.elementType===t.type?y:Ui(t.type,y),E);k.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(C){lr(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,$e=e;break}$e=t.return}return m=fy,fy=!1,m}function h0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&om(t,r,a)}i=i.next}while(i!==n)}}function nh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function lm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function v6(e){var t=e.alternate;t!==null&&(e.alternate=null,v6(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fa],delete t[O0],delete t[Kg],delete t[Y9],delete t[Q9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function y6(e){return e.tag===5||e.tag===3||e.tag===4}function dy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||y6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=dd));else if(n!==4&&(e=e.child,e!==null))for(cm(e,t,r),e=e.sibling;e!==null;)cm(e,t,r),e=e.sibling}function um(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(um(e,t,r),e=e.sibling;e!==null;)um(e,t,r),e=e.sibling}var Yr=null,ji=!1;function os(e,t,r){for(r=r.child;r!==null;)_6(e,t,r),r=r.sibling}function _6(e,t,r){if(ha&&typeof ha.onCommitFiberUnmount=="function")try{ha.onCommitFiberUnmount(Yd,r)}catch{}switch(r.tag){case 5:dn||Cl(r,t);case 6:var n=Yr,i=ji;Yr=null,os(e,t,r),Yr=n,ji=i,Yr!==null&&(ji?(e=Yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yr.removeChild(r.stateNode));break;case 18:Yr!==null&&(ji?(e=Yr,r=r.stateNode,e.nodeType===8?Mp(e.parentNode,r):e.nodeType===1&&Mp(e,r),N0(e)):Mp(Yr,r.stateNode));break;case 4:n=Yr,i=ji,Yr=r.stateNode.containerInfo,ji=!0,os(e,t,r),Yr=n,ji=i;break;case 0:case 11:case 14:case 15:if(!dn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&om(r,t,s),i=i.next}while(i!==n)}os(e,t,r);break;case 1:if(!dn&&(Cl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){lr(r,t,o)}os(e,t,r);break;case 21:os(e,t,r);break;case 22:r.mode&1?(dn=(n=dn)||r.memoizedState!==null,os(e,t,r),dn=n):os(e,t,r);break;default:os(e,t,r)}}function hy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dE),t.forEach(function(n){var i=SE.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Oi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yr=o.stateNode,ji=!1;break e;case 3:Yr=o.stateNode.containerInfo,ji=!0;break e;case 4:Yr=o.stateNode.containerInfo,ji=!0;break e}o=o.return}if(Yr===null)throw Error(Ie(160));_6(a,s,i),Yr=null,ji=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){lr(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)w6(t,e),t=t.sibling}function w6(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Oi(t,e),sa(e),n&4){try{h0(3,e,e.return),nh(3,e)}catch(y){lr(e,e.return,y)}try{h0(5,e,e.return)}catch(y){lr(e,e.return,y)}}break;case 1:Oi(t,e),sa(e),n&512&&r!==null&&Cl(r,r.return);break;case 5:if(Oi(t,e),sa(e),n&512&&r!==null&&Cl(r,r.return),e.flags&32){var i=e.stateNode;try{T0(i,"")}catch(y){lr(e,e.return,y)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&G5(i,a),bg(o,s);var f=bg(o,a);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];d==="style"?K5(i,p):d==="dangerouslySetInnerHTML"?$5(i,p):d==="children"?T0(i,p):Km(i,d,p,f)}switch(o){case"input":Fg(i,a);break;case"textarea":H5(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Pl(i,!!a.multiple,v,!1):g!==!!a.multiple&&(a.defaultValue!=null?Pl(i,!!a.multiple,a.defaultValue,!0):Pl(i,!!a.multiple,a.multiple?[]:"",!1))}i[O0]=a}catch(y){lr(e,e.return,y)}}break;case 6:if(Oi(t,e),sa(e),n&4){if(e.stateNode===null)throw Error(Ie(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(y){lr(e,e.return,y)}}break;case 3:if(Oi(t,e),sa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{N0(t.containerInfo)}catch(y){lr(e,e.return,y)}break;case 4:Oi(t,e),sa(e);break;case 13:Oi(t,e),sa(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(A2=gr())),n&4&&hy(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(dn=(f=dn)||d,Oi(t,e),dn=f):Oi(t,e),sa(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for($e=e,d=e.child;d!==null;){for(p=$e=d;$e!==null;){switch(g=$e,v=g.child,g.tag){case 0:case 11:case 14:case 15:h0(4,g,g.return);break;case 1:Cl(g,g.return);var m=g.stateNode;if(typeof m.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(y){lr(n,r,y)}}break;case 5:Cl(g,g.return);break;case 22:if(g.memoizedState!==null){gy(p);continue}}v!==null?(v.return=g,$e=v):gy(p)}d=d.sibling}e:for(d=null,p=e;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,f?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,u=p.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=X5("display",s))}catch(y){lr(e,e.return,y)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(y){lr(e,e.return,y)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Oi(t,e),sa(e),n&4&&hy(e);break;case 21:break;default:Oi(t,e),sa(e)}}function sa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(y6(r)){var n=r;break e}r=r.return}throw Error(Ie(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(T0(i,""),n.flags&=-33);var a=dy(e);um(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=dy(e);cm(e,o,s);break;default:throw Error(Ie(161))}}catch(u){lr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pE(e,t,r){$e=e,S6(e)}function S6(e,t,r){for(var n=(e.mode&1)!==0;$e!==null;){var i=$e,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Tf;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||dn;o=Tf;var f=dn;if(Tf=s,(dn=u)&&!f)for($e=i;$e!==null;)s=$e,u=s.child,s.tag===22&&s.memoizedState!==null?my(i):u!==null?(u.return=s,$e=u):my(i);for(;a!==null;)$e=a,S6(a),a=a.sibling;$e=i,Tf=o,dn=f}py(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,$e=a):py(e)}}function py(e){for(;$e!==null;){var t=$e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dn||nh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ui(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&J4(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}J4(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&N0(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}dn||t.flags&512&&lm(t)}catch(g){lr(t,t.return,g)}}if(t===e){$e=null;break}if(r=t.sibling,r!==null){r.return=t.return,$e=r;break}$e=t.return}}function gy(e){for(;$e!==null;){var t=$e;if(t===e){$e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,$e=r;break}$e=t.return}}function my(e){for(;$e!==null;){var t=$e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nh(4,t)}catch(u){lr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){lr(t,i,u)}}var a=t.return;try{lm(t)}catch(u){lr(t,a,u)}break;case 5:var s=t.return;try{lm(t)}catch(u){lr(t,s,u)}}}catch(u){lr(t,t.return,u)}if(t===e){$e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,$e=o;break}$e=t.return}}var gE=Math.ceil,kd=$a.ReactCurrentDispatcher,C2=$a.ReactCurrentOwner,ki=$a.ReactCurrentBatchConfig,Pt=0,Hr=null,kr=null,qr=0,Yn=0,Tl=Ms(0),Nr=0,z0=null,ko=0,ih=0,T2=0,p0=null,Bn=null,A2=0,Hl=1/0,Fa=null,Ed=!1,fm=null,Ts=null,Af=!1,vs=null,Cd=0,g0=0,dm=null,Zf=-1,ed=0;function Cn(){return Pt&6?gr():Zf!==-1?Zf:Zf=gr()}function As(e){return e.mode&1?Pt&2&&qr!==0?qr&-qr:J9.transition!==null?(ed===0&&(ed=s_()),ed):(e=Bt,e!==0||(e=window.event,e=e===void 0?16:h_(e.type)),e):1}function $i(e,t,r,n){if(50<g0)throw g0=0,dm=null,Error(Ie(185));iu(e,r,n),(!(Pt&2)||e!==Hr)&&(e===Hr&&(!(Pt&2)&&(ih|=r),Nr===4&&ps(e,qr)),Gn(e,n),r===1&&Pt===0&&!(t.mode&1)&&(Hl=gr()+500,eh&&Bs()))}function Gn(e,t){var r=e.callbackNode;Jk(e,t);var n=ld(e,e===Hr?qr:0);if(n===0)r!==null&&C4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&C4(r),t===1)e.tag===0?q9(xy.bind(null,e)):I_(xy.bind(null,e)),X9(function(){!(Pt&6)&&Bs()}),r=null;else{switch(o_(n)){case 1:r=Zm;break;case 4:r=i_;break;case 16:r=od;break;case 536870912:r=a_;break;default:r=od}r=N6(r,k6.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function k6(e,t){if(Zf=-1,ed=0,Pt&6)throw Error(Ie(327));var r=e.callbackNode;if(Dl()&&e.callbackNode!==r)return null;var n=ld(e,e===Hr?qr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Td(e,n);else{t=n;var i=Pt;Pt|=2;var a=C6();(Hr!==e||qr!==t)&&(Fa=null,Hl=gr()+500,mo(e,t));do try{vE();break}catch(o){E6(e,o)}while(1);d2(),kd.current=a,Pt=i,kr!==null?t=0:(Hr=null,qr=0,t=Nr)}if(t!==0){if(t===2&&(i=Ug(e),i!==0&&(n=i,t=hm(e,i))),t===1)throw r=z0,mo(e,0),ps(e,n),Gn(e,gr()),r;if(t===6)ps(e,n);else{if(i=e.current.alternate,!(n&30)&&!mE(i)&&(t=Td(e,n),t===2&&(a=Ug(e),a!==0&&(n=a,t=hm(e,a))),t===1))throw r=z0,mo(e,0),ps(e,n),Gn(e,gr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ie(345));case 2:oo(e,Bn,Fa);break;case 3:if(ps(e,n),(n&130023424)===n&&(t=A2+500-gr(),10<t)){if(ld(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Cn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xg(oo.bind(null,e,Bn,Fa),t);break}oo(e,Bn,Fa);break;case 4:if(ps(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-Wi(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=gr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gE(n/1960))-n,10<n){e.timeoutHandle=Xg(oo.bind(null,e,Bn,Fa),n);break}oo(e,Bn,Fa);break;case 5:oo(e,Bn,Fa);break;default:throw Error(Ie(329))}}}return Gn(e,gr()),e.callbackNode===r?k6.bind(null,e):null}function hm(e,t){var r=p0;return e.current.memoizedState.isDehydrated&&(mo(e,t).flags|=256),e=Td(e,t),e!==2&&(t=Bn,Bn=r,t!==null&&pm(t)),e}function pm(e){Bn===null?Bn=e:Bn.push.apply(Bn,e)}function mE(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Qi(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ps(e,t){for(t&=~T2,t&=~ih,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Wi(t),n=1<<r;e[r]=-1,t&=~n}}function xy(e){if(Pt&6)throw Error(Ie(327));Dl();var t=ld(e,0);if(!(t&1))return Gn(e,gr()),null;var r=Td(e,t);if(e.tag!==0&&r===2){var n=Ug(e);n!==0&&(t=n,r=hm(e,n))}if(r===1)throw r=z0,mo(e,0),ps(e,t),Gn(e,gr()),r;if(r===6)throw Error(Ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,oo(e,Bn,Fa),Gn(e,gr()),null}function P2(e,t){var r=Pt;Pt|=1;try{return e(t)}finally{Pt=r,Pt===0&&(Hl=gr()+500,eh&&Bs())}}function Eo(e){vs!==null&&vs.tag===0&&!(Pt&6)&&Dl();var t=Pt;Pt|=1;var r=ki.transition,n=Bt;try{if(ki.transition=null,Bt=1,e)return e()}finally{Bt=n,ki.transition=r,Pt=t,!(Pt&6)&&Bs()}}function F2(){Yn=Tl.current,Yt(Tl)}function mo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$9(r)),kr!==null)for(r=kr.return;r!==null;){var n=r;switch(c2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hd();break;case 3:Vl(),Yt(zn),Yt(mn),v2();break;case 5:x2(n);break;case 4:Vl();break;case 13:Yt(ir);break;case 19:Yt(ir);break;case 10:h2(n.type._context);break;case 22:case 23:F2()}r=r.return}if(Hr=e,kr=e=Ps(e.current,null),qr=Yn=t,Nr=0,z0=null,T2=ih=ko=0,Bn=p0=null,fo!==null){for(t=0;t<fo.length;t++)if(r=fo[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}fo=null}return e}function E6(e,t){do{var r=kr;try{if(d2(),Qf.current=Sd,wd){for(var n=ar.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}wd=!1}if(So=0,Gr=Fr=ar=null,d0=!1,B0=0,C2.current=null,r===null||r.return===null){Nr=1,z0=t,kr=null;break}e:{var a=e,s=r.return,o=r,u=t;if(t=qr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=o,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=iy(s);if(v!==null){v.flags&=-257,ay(v,s,o,a,t),v.mode&1&&ny(a,f,t),t=v,u=f;var m=t.updateQueue;if(m===null){var y=new Set;y.add(u),t.updateQueue=y}else m.add(u);break e}else{if(!(t&1)){ny(a,f,t),N2();break e}u=Error(Ie(426))}}else if(er&&o.mode&1){var E=iy(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),ay(E,s,o,a,t),u2(Gl(u,o));break e}}a=u=Gl(u,o),Nr!==4&&(Nr=2),p0===null?p0=[a]:p0.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=o6(a,u,t);q4(a,k);break e;case 1:o=u;var w=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ts===null||!Ts.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=l6(a,o,t);q4(a,C);break e}}a=a.return}while(a!==null)}A6(r)}catch(A){t=A,kr===r&&r!==null&&(kr=r=r.return);continue}break}while(1)}function C6(){var e=kd.current;return kd.current=Sd,e===null?Sd:e}function N2(){(Nr===0||Nr===3||Nr===2)&&(Nr=4),Hr===null||!(ko&268435455)&&!(ih&268435455)||ps(Hr,qr)}function Td(e,t){var r=Pt;Pt|=2;var n=C6();(Hr!==e||qr!==t)&&(Fa=null,mo(e,t));do try{xE();break}catch(i){E6(e,i)}while(1);if(d2(),Pt=r,kd.current=n,kr!==null)throw Error(Ie(261));return Hr=null,qr=0,Nr}function xE(){for(;kr!==null;)T6(kr)}function vE(){for(;kr!==null&&!Gk();)T6(kr)}function T6(e){var t=F6(e.alternate,e,Yn);e.memoizedProps=e.pendingProps,t===null?A6(e):kr=t,C2.current=null}function A6(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fE(r,t),r!==null){r.flags&=32767,kr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Nr=6,kr=null;return}}else if(r=uE(r,t,Yn),r!==null){kr=r;return}if(t=t.sibling,t!==null){kr=t;return}kr=t=e}while(t!==null);Nr===0&&(Nr=5)}function oo(e,t,r){var n=Bt,i=ki.transition;try{ki.transition=null,Bt=1,yE(e,t,r,n)}finally{ki.transition=i,Bt=n}return null}function yE(e,t,r,n){do Dl();while(vs!==null);if(Pt&6)throw Error(Ie(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ie(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Zk(e,a),e===Hr&&(kr=Hr=null,qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Af||(Af=!0,N6(od,function(){return Dl(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ki.transition,ki.transition=null;var s=Bt;Bt=1;var o=Pt;Pt|=4,C2.current=null,hE(e,r),w6(r,e),U9(Wg),cd=!!Hg,Wg=Hg=null,e.current=r,pE(r),Hk(),Pt=o,Bt=s,ki.transition=a}else e.current=r;if(Af&&(Af=!1,vs=e,Cd=i),a=e.pendingLanes,a===0&&(Ts=null),Xk(r.stateNode),Gn(e,gr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ed)throw Ed=!1,e=fm,fm=null,e;return Cd&1&&e.tag!==0&&Dl(),a=e.pendingLanes,a&1?e===dm?g0++:(g0=0,dm=e):g0=0,Bs(),null}function Dl(){if(vs!==null){var e=o_(Cd),t=ki.transition,r=Bt;try{if(ki.transition=null,Bt=16>e?16:e,vs===null)var n=!1;else{if(e=vs,vs=null,Cd=0,Pt&6)throw Error(Ie(331));var i=Pt;for(Pt|=4,$e=e.current;$e!==null;){var a=$e,s=a.child;if($e.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var f=o[u];for($e=f;$e!==null;){var d=$e;switch(d.tag){case 0:case 11:case 15:h0(8,d,a)}var p=d.child;if(p!==null)p.return=d,$e=p;else for(;$e!==null;){d=$e;var g=d.sibling,v=d.return;if(v6(d),d===f){$e=null;break}if(g!==null){g.return=v,$e=g;break}$e=v}}}var m=a.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}$e=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,$e=s;else e:for(;$e!==null;){if(a=$e,a.flags&2048)switch(a.tag){case 0:case 11:case 15:h0(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,$e=k;break e}$e=a.return}}var w=e.current;for($e=w;$e!==null;){s=$e;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,$e=x;else e:for(s=w;$e!==null;){if(o=$e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:nh(9,o)}}catch(A){lr(o,o.return,A)}if(o===s){$e=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,$e=C;break e}$e=o.return}}if(Pt=i,Bs(),ha&&typeof ha.onPostCommitFiberRoot=="function")try{ha.onPostCommitFiberRoot(Yd,e)}catch{}n=!0}return n}finally{Bt=r,ki.transition=t}}return!1}function vy(e,t,r){t=Gl(r,t),t=o6(e,t,1),e=Cs(e,t,1),t=Cn(),e!==null&&(iu(e,1,t),Gn(e,t))}function lr(e,t,r){if(e.tag===3)vy(e,e,r);else for(;t!==null;){if(t.tag===3){vy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ts===null||!Ts.has(n))){e=Gl(r,e),e=l6(t,e,1),t=Cs(t,e,1),e=Cn(),t!==null&&(iu(t,1,e),Gn(t,e));break}}t=t.return}}function _E(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Cn(),e.pingedLanes|=e.suspendedLanes&r,Hr===e&&(qr&r)===r&&(Nr===4||Nr===3&&(qr&130023424)===qr&&500>gr()-A2?mo(e,0):T2|=r),Gn(e,t)}function P6(e,t){t===0&&(e.mode&1?(t=xf,xf<<=1,!(xf&130023424)&&(xf=4194304)):t=1);var r=Cn();e=Va(e,t),e!==null&&(iu(e,t,r),Gn(e,r))}function wE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),P6(e,r)}function SE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ie(314))}n!==null&&n.delete(t),P6(e,r)}var F6;F6=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||zn.current)jn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return jn=!1,cE(e,t,r);jn=!!(e.flags&131072)}else jn=!1,er&&t.flags&1048576&&D_(t,md,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Jf(e,t),e=t.pendingProps;var i=Ul(t,mn.current);Il(t,r),i=_2(null,t,n,e,i,r);var a=w2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vn(n)?(a=!0,pd(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,g2(t),i.updater=rh,t.stateNode=i,i._reactInternals=t,em(t,n,e,r),t=nm(null,t,n,!0,a,r)):(t.tag=0,er&&a&&l2(t),wn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Jf(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=EE(n),e=Ui(n,e),i){case 0:t=rm(null,t,n,e,r);break e;case 1:t=ly(null,t,n,e,r);break e;case 11:t=sy(null,t,n,e,r);break e;case 14:t=oy(null,t,n,Ui(n.type,e),r);break e}throw Error(Ie(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ui(n,i),rm(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ui(n,i),ly(e,t,n,i,r);case 3:e:{if(d6(t),e===null)throw Error(Ie(387));n=t.pendingProps,a=t.memoizedState,i=a.element,U_(e,t),yd(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Gl(Error(Ie(423)),t),t=cy(e,t,n,r,i);break e}else if(n!==i){i=Gl(Error(Ie(424)),t),t=cy(e,t,n,r,i);break e}else for(Jn=Es(t.stateNode.containerInfo.firstChild),Zn=t,er=!0,zi=null,r=M_(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jl(),n===i){t=Ga(e,t,r);break e}wn(e,t,n,r)}t=t.child}return t;case 5:return j_(t),e===null&&qg(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,$g(n,i)?s=null:a!==null&&$g(n,a)&&(t.flags|=32),f6(e,t),wn(e,t,s,r),t.child;case 6:return e===null&&qg(t),null;case 13:return h6(e,t,r);case 4:return m2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=zl(t,null,n,r):wn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ui(n,i),sy(e,t,n,i,r);case 7:return wn(e,t,t.pendingProps,r),t.child;case 8:return wn(e,t,t.pendingProps.children,r),t.child;case 12:return wn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Wt(xd,n._currentValue),n._currentValue=s,a!==null)if(Qi(a.value,s)){if(a.children===i.children&&!zn.current){t=Ga(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=La(-1,r&-r),u.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),Jg(a.return,r,t),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Ie(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Jg(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}wn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Il(t,r),i=Ei(i),n=n(i),t.flags|=1,wn(e,t,n,r),t.child;case 14:return n=t.type,i=Ui(n,t.pendingProps),i=Ui(n.type,i),oy(e,t,n,i,r);case 15:return c6(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ui(n,i),Jf(e,t),t.tag=1,Vn(n)?(e=!0,pd(t)):e=!1,Il(t,r),s6(t,n,i),em(t,n,i,r),nm(null,t,n,!0,e,r);case 19:return p6(e,t,r);case 22:return u6(e,t,r)}throw Error(Ie(156,t.tag))};function N6(e,t){return n_(e,t)}function kE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,r,n){return new kE(e,t,r,n)}function R2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function EE(e){if(typeof e=="function")return R2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qm)return 11;if(e===qm)return 14}return 2}function Ps(e,t){var r=e.alternate;return r===null?(r=Si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function td(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")R2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ml:return xo(r.children,i,a,t);case Ym:s=8,i|=8;break;case Eg:return e=Si(12,r,t,i|2),e.elementType=Eg,e.lanes=a,e;case Cg:return e=Si(13,r,t,i),e.elementType=Cg,e.lanes=a,e;case Tg:return e=Si(19,r,t,i),e.elementType=Tg,e.lanes=a,e;case j5:return ah(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B5:s=10;break e;case U5:s=9;break e;case Qm:s=11;break e;case qm:s=14;break e;case fs:s=16,n=null;break e}throw Error(Ie(130,e==null?e:typeof e,""))}return t=Si(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function xo(e,t,r,n){return e=Si(7,e,n,t),e.lanes=r,e}function ah(e,t,r,n){return e=Si(22,e,n,t),e.elementType=j5,e.lanes=r,e.stateNode={isHidden:!1},e}function Wp(e,t,r){return e=Si(6,e,null,t),e.lanes=r,e}function $p(e,t,r){return t=Si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function CE(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tp(0),this.expirationTimes=Tp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,a,s,o,u){return e=new CE(e,t,r,o,u),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Si(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},g2(a),e}function TE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function R6(e){if(!e)return Rs;e=e._reactInternals;e:{if(No(e)!==e||e.tag!==1)throw Error(Ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ie(171))}if(e.tag===1){var r=e.type;if(Vn(r))return R_(e,r,t)}return t}function I6(e,t,r,n,i,a,s,o,u){return e=I2(r,n,!0,e,i,a,s,o,u),e.context=R6(null),r=e.current,n=Cn(),i=As(r),a=La(n,i),a.callback=t??null,Cs(r,a,i),e.current.lanes=i,iu(e,i,n),Gn(e,n),e}function sh(e,t,r,n){var i=t.current,a=Cn(),s=As(i);return r=R6(r),t.context===null?t.context=r:t.pendingContext=r,t=La(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Cs(i,t,s),e!==null&&($i(e,i,s,a),Yf(e,i,s)),s}function Ad(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function D2(e,t){yy(e,t),(e=e.alternate)&&yy(e,t)}function AE(){return null}var D6=typeof reportError=="function"?reportError:function(e){console.error(e)};function b2(e){this._internalRoot=e}oh.prototype.render=b2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ie(409));sh(e,t,null,null)};oh.prototype.unmount=b2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Eo(function(){sh(null,e,null,null)}),t[za]=null}};function oh(e){this._internalRoot=e}oh.prototype.unstable_scheduleHydration=function(e){if(e){var t=u_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<hs.length&&t!==0&&t<hs[r].priority;r++);hs.splice(r,0,e),r===0&&d_(e)}};function O2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function lh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _y(){}function PE(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var f=Ad(s);a.call(f)}}var s=I6(t,n,e,0,null,!1,!1,"",_y);return e._reactRootContainer=s,e[za]=s.current,D0(e.nodeType===8?e.parentNode:e),Eo(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var f=Ad(u);o.call(f)}}var u=I2(e,0,!1,null,null,!1,!1,"",_y);return e._reactRootContainer=u,e[za]=u.current,D0(e.nodeType===8?e.parentNode:e),Eo(function(){sh(t,u,r,n)}),u}function ch(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=Ad(s);o.call(u)}}sh(t,s,e,i)}else s=PE(r,t,e,i,n);return Ad(s)}l_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zc(t.pendingLanes);r!==0&&(e2(t,r|1),Gn(t,gr()),!(Pt&6)&&(Hl=gr()+500,Bs()))}break;case 13:Eo(function(){var n=Va(e,1);if(n!==null){var i=Cn();$i(n,e,1,i)}}),D2(e,1)}};t2=function(e){if(e.tag===13){var t=Va(e,134217728);if(t!==null){var r=Cn();$i(t,e,134217728,r)}D2(e,134217728)}};c_=function(e){if(e.tag===13){var t=As(e),r=Va(e,t);if(r!==null){var n=Cn();$i(r,e,t,n)}D2(e,t)}};u_=function(){return Bt};f_=function(e,t){var r=Bt;try{return Bt=e,t()}finally{Bt=r}};Lg=function(e,t,r){switch(t){case"input":if(Fg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Zd(n);if(!i)throw Error(Ie(90));V5(n),Fg(n,i)}}}break;case"textarea":H5(e,r);break;case"select":t=r.value,t!=null&&Pl(e,!!r.multiple,t,!1)}};q5=P2;J5=Eo;var FE={usingClientEntryPoint:!1,Events:[su,_l,Zd,Y5,Q5,P2]},jc={findFiberByHostInstance:uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NE={bundleType:jc.bundleType,version:jc.version,rendererPackageName:jc.rendererPackageName,rendererConfig:jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=t_(e),e===null?null:e.stateNode},findFiberByHostInstance:jc.findFiberByHostInstance||AE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{Yd=Pf.inject(NE),ha=Pf}catch{}}ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;ni.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O2(t))throw Error(Ie(200));return TE(e,t,null,r)};ni.createRoot=function(e,t){if(!O2(e))throw Error(Ie(299));var r=!1,n="",i=D6;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[za]=t.current,D0(e.nodeType===8?e.parentNode:e),new b2(t)};ni.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ie(188)):(e=Object.keys(e).join(","),Error(Ie(268,e)));return e=t_(t),e=e===null?null:e.stateNode,e};ni.flushSync=function(e){return Eo(e)};ni.hydrate=function(e,t,r){if(!lh(t))throw Error(Ie(200));return ch(null,e,t,!0,r)};ni.hydrateRoot=function(e,t,r){if(!O2(e))throw Error(Ie(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=D6;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=I6(t,null,e,1,r??null,i,!1,a,s),e[za]=t.current,D0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new oh(t)};ni.render=function(e,t,r){if(!lh(t))throw Error(Ie(200));return ch(null,e,t,!1,r)};ni.unmountComponentAtNode=function(e){if(!lh(e))throw Error(Ie(40));return e._reactRootContainer?(Eo(function(){ch(null,null,e,!1,function(){e._reactRootContainer=null,e[za]=null})}),!0):!1};ni.unstable_batchedUpdates=P2;ni.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!lh(r))throw Error(Ie(200));if(e==null||e._reactInternals===void 0)throw Error(Ie(38));return ch(e,t,r,!1,n)};ni.version="18.3.1-next-f1338f8080-20240426";function b6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b6)}catch(e){console.error(e)}}b6(),b5.exports=ni;var RE=b5.exports,wy=RE;Sg.createRoot=wy.createRoot,Sg.hydrateRoot=wy.hydrateRoot;const Sy=e=>{let t;const r=new Set,n=(d,p)=>{const g=typeof d=="function"?d(t):d;if(!Object.is(g,t)){const v=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(m=>m(t,v))}},i=()=>t,u={setState:n,getState:i,getInitialState:()=>f,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{r.clear()}},f=t=e(n,i,u);return u},IE=e=>e?Sy(e):Sy;var O6={exports:{}},L6={},M6={exports:{}},B6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wl=_e;function DE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var bE=typeof Object.is=="function"?Object.is:DE,OE=Wl.useState,LE=Wl.useEffect,ME=Wl.useLayoutEffect,BE=Wl.useDebugValue;function UE(e,t){var r=t(),n=OE({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return ME(function(){i.value=r,i.getSnapshot=t,Xp(i)&&a({inst:i})},[e,r,t]),LE(function(){return Xp(i)&&a({inst:i}),e(function(){Xp(i)&&a({inst:i})})},[e]),BE(r),r}function Xp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!bE(e,r)}catch{return!0}}function jE(e,t){return t()}var zE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?jE:UE;B6.useSyncExternalStore=Wl.useSyncExternalStore!==void 0?Wl.useSyncExternalStore:zE;M6.exports=B6;var VE=M6.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uh=_e,GE=VE;function HE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var WE=typeof Object.is=="function"?Object.is:HE,$E=GE.useSyncExternalStore,XE=uh.useRef,KE=uh.useEffect,YE=uh.useMemo,QE=uh.useDebugValue;L6.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=XE(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=YE(function(){function u(v){if(!f){if(f=!0,d=v,v=n(v),i!==void 0&&s.hasValue){var m=s.value;if(i(m,v))return p=m}return p=v}if(m=p,WE(d,v))return m;var y=n(v);return i!==void 0&&i(m,y)?(d=v,m):(d=v,p=y)}var f=!1,d,p,g=r===void 0?null:r;return[function(){return u(t())},g===null?void 0:function(){return u(g())}]},[t,r,n,i]);var o=$E(e,a[0],a[1]);return KE(function(){s.hasValue=!0,s.value=o},[o]),QE(o),o};O6.exports=L6;var qE=O6.exports;const JE=Xd(qE),{useDebugValue:ZE}=Sr,{useSyncExternalStoreWithSelector:eC}=JE;const tC=e=>e;function rC(e,t=tC,r){const n=eC(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return ZE(n),n}const ky=e=>{const t=typeof e=="function"?IE(e):e,r=(n,i)=>rC(t,n,i);return Object.assign(r,t),r},nC=e=>e?ky(e):ky;var U6=Symbol.for("immer-nothing"),Ey=Symbol.for("immer-draftable"),bt=Symbol.for("immer-state");function wi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var $l=Object.getPrototypeOf;function Xl(e){return!!e&&!!e[bt]}function Ha(e){var t;return e?j6(e)||Array.isArray(e)||!!e[Ey]||!!((t=e.constructor)!=null&&t[Ey])||dh(e)||hh(e):!1}var iC=Object.prototype.constructor.toString();function j6(e){if(!e||typeof e!="object")return!1;const t=$l(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===iC}function V0(e,t){fh(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function fh(e){const t=e[bt];return t?t.type_:Array.isArray(e)?1:dh(e)?2:hh(e)?3:0}function gm(e,t){return fh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function z6(e,t,r){const n=fh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function aC(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function dh(e){return e instanceof Map}function hh(e){return e instanceof Set}function zr(e){return e.copy_||e.base_}function mm(e,t){if(dh(e))return new Map(e);if(hh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=j6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[bt];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create($l(e),n)}else{const n=$l(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function L2(e,t=!1){return ph(e)||Xl(e)||!Ha(e)||(fh(e)>1&&(e.set=e.add=e.clear=e.delete=sC),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>L2(n,!0))),e}function sC(){wi(2)}function ph(e){return Object.isFrozen(e)}var xm={};function Co(e){const t=xm[e];return t||wi(0,e),t}function oC(e,t){xm[e]||(xm[e]=t)}var G0;function Pd(){return G0}function lC(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Cy(e,t){t&&(Co("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function vm(e){ym(e),e.drafts_.forEach(cC),e.drafts_=null}function ym(e){e===G0&&(G0=e.parent_)}function Ty(e){return G0=lC(G0,e)}function cC(e){const t=e[bt];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ay(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[bt].modified_&&(vm(t),wi(4)),Ha(e)&&(e=Fd(t,e),t.parent_||Nd(t,e)),t.patches_&&Co("Patches").generateReplacementPatches_(r[bt].base_,e,t.patches_,t.inversePatches_)):e=Fd(t,r,[]),vm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==U6?e:void 0}function Fd(e,t,r){if(ph(t))return t;const n=t[bt];if(!n)return V0(t,(i,a)=>Py(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Nd(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),V0(a,(o,u)=>Py(e,n,i,o,u,r,s)),Nd(e,i,!1),r&&e.patches_&&Co("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Py(e,t,r,n,i,a,s){if(Xl(i)){const o=a&&t&&t.type_!==3&&!gm(t.assigned_,n)?a.concat(n):void 0,u=Fd(e,i,o);if(z6(r,n,u),Xl(u))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Ha(i)&&!ph(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Fd(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Nd(e,i)}}function Nd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&L2(t,r)}function uC(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Pd(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=M2;r&&(i=[n],a=H0);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var M2={get(e,t){if(t===bt)return e;const r=zr(e);if(!gm(r,t))return fC(e,r,t);const n=r[t];return e.finalized_||!Ha(n)?n:n===Kp(e.base_,t)?(Yp(e),e.copy_[t]=W0(n,e)):n},has(e,t){return t in zr(e)},ownKeys(e){return Reflect.ownKeys(zr(e))},set(e,t,r){const n=V6(zr(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Kp(zr(e),t),a=i==null?void 0:i[bt];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(aC(r,i)&&(r!==void 0||gm(e.base_,t)))return!0;Yp(e),Ia(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Kp(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Yp(e),Ia(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=zr(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){wi(11)},getPrototypeOf(e){return $l(e.base_)},setPrototypeOf(){wi(12)}},H0={};V0(M2,(e,t)=>{H0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});H0.deleteProperty=function(e,t){return H0.set.call(this,e,t,void 0)};H0.set=function(e,t,r){return M2.set.call(this,e[0],t,r,e[0])};function Kp(e,t){const r=e[bt];return(r?zr(r):e)[t]}function fC(e,t,r){var i;const n=V6(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function V6(e,t){if(!(t in e))return;let r=$l(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=$l(r)}}function Ia(e){e.modified_||(e.modified_=!0,e.parent_&&Ia(e.parent_))}function Yp(e){e.copy_||(e.copy_=mm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dC=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(u=a,...f){return s.produce(u,d=>r.call(this,d,...f))}}typeof r!="function"&&wi(6),n!==void 0&&typeof n!="function"&&wi(7);let i;if(Ha(t)){const a=Ty(this),s=W0(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?vm(a):ym(a)}return Cy(a,n),Ay(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===U6&&(i=void 0),this.autoFreeze_&&L2(i,!0),n){const a=[],s=[];Co("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else wi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,u=>t(u,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ha(e)||wi(8),Xl(e)&&(e=hC(e));const t=Ty(this),r=W0(e,void 0);return r[bt].isManual_=!0,ym(t),r}finishDraft(e,t){const r=e&&e[bt];(!r||!r.isManual_)&&wi(9);const{scope_:n}=r;return Cy(n,t),Ay(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=Co("Patches").applyPatches_;return Xl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function W0(e,t){const r=dh(e)?Co("MapSet").proxyMap_(e,t):hh(e)?Co("MapSet").proxySet_(e,t):uC(e,t);return(t?t.scope_:Pd()).drafts_.push(r),r}function hC(e){return Xl(e)||wi(10,e),G6(e)}function G6(e){if(!Ha(e)||ph(e))return e;const t=e[bt];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=mm(e,t.scope_.immer_.useStrictShallowCopy_)}else r=mm(e,!0);return V0(r,(n,i)=>{z6(r,n,G6(i))}),t&&(t.finalized_=!1),r}function pC(){class e extends Map{constructor(u,f){super(),this[bt]={type_:2,parent_:f,scope_:f?f.scope_:Pd(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:u,draft_:this,isManual_:!1,revoked_:!1}}get size(){return zr(this[bt]).size}has(u){return zr(this[bt]).has(u)}set(u,f){const d=this[bt];return s(d),(!zr(d).has(u)||zr(d).get(u)!==f)&&(r(d),Ia(d),d.assigned_.set(u,!0),d.copy_.set(u,f),d.assigned_.set(u,!0)),this}delete(u){if(!this.has(u))return!1;const f=this[bt];return s(f),r(f),Ia(f),f.base_.has(u)?f.assigned_.set(u,!1):f.assigned_.delete(u),f.copy_.delete(u),!0}clear(){const u=this[bt];s(u),zr(u).size&&(r(u),Ia(u),u.assigned_=new Map,V0(u.base_,f=>{u.assigned_.set(f,!1)}),u.copy_.clear())}forEach(u,f){const d=this[bt];zr(d).forEach((p,g,v)=>{u.call(f,this.get(g),g,this)})}get(u){const f=this[bt];s(f);const d=zr(f).get(u);if(f.finalized_||!Ha(d)||d!==f.base_.get(u))return d;const p=W0(d,f);return r(f),f.copy_.set(u,p),p}keys(){return zr(this[bt]).keys()}values(){const u=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const f=u.next();return f.done?f:{done:!1,value:this.get(f.value)}}}}entries(){const u=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const f=u.next();if(f.done)return f;const d=this.get(f.value);return{done:!1,value:[f.value,d]}}}}[Symbol.iterator](){return this.entries()}}function t(o,u){return new e(o,u)}function r(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class n extends Set{constructor(u,f){super(),this[bt]={type_:3,parent_:f,scope_:f?f.scope_:Pd(),modified_:!1,finalized_:!1,copy_:void 0,base_:u,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return zr(this[bt]).size}has(u){const f=this[bt];return s(f),f.copy_?!!(f.copy_.has(u)||f.drafts_.has(u)&&f.copy_.has(f.drafts_.get(u))):f.base_.has(u)}add(u){const f=this[bt];return s(f),this.has(u)||(a(f),Ia(f),f.copy_.add(u)),this}delete(u){if(!this.has(u))return!1;const f=this[bt];return s(f),a(f),Ia(f),f.copy_.delete(u)||(f.drafts_.has(u)?f.copy_.delete(f.drafts_.get(u)):!1)}clear(){const u=this[bt];s(u),zr(u).size&&(a(u),Ia(u),u.copy_.clear())}values(){const u=this[bt];return s(u),a(u),u.copy_.values()}entries(){const u=this[bt];return s(u),a(u),u.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(u,f){const d=this.values();let p=d.next();for(;!p.done;)u.call(f,p.value,p.value,this),p=d.next()}}function i(o,u){return new n(o,u)}function a(o){o.copy_||(o.copy_=new Set,o.base_.forEach(u=>{if(Ha(u)){const f=W0(u,o);o.drafts_.set(u,f),o.copy_.add(f)}else o.copy_.add(u)}))}function s(o){o.revoked_&&wi(3,JSON.stringify(zr(o)))}oC("MapSet",{proxyMap_:t,proxySet_:i})}var ti=new dC,gC=ti.produce;ti.produceWithPatches.bind(ti);ti.setAutoFreeze.bind(ti);ti.setUseStrictShallowCopy.bind(ti);ti.applyPatches.bind(ti);ti.createDraft.bind(ti);ti.finishDraft.bind(ti);const mC=e=>(t,r,n)=>(n.setState=(i,a,...s)=>{const o=typeof i=="function"?gC(i):i;return t(o,a,...s)},e(n.setState,r,n)),xC=mC;class Tr{static initialize(t=50){this.state.maxHistorySize=t}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static notifyListeners(){this.listeners.forEach(t=>t())}static recordAction(t,r,n){const i={id:crypto.randomUUID(),type:t,timestamp:new Date,data:JSON.parse(JSON.stringify(r)),description:n};return this.state.history=this.state.history.slice(0,this.state.currentIndex+1),this.state.history.push(i),this.state.currentIndex++,this.state.history.length>this.state.maxHistorySize&&(this.state.history.shift(),this.state.currentIndex--),this.notifyListeners(),i.id}static canUndo(){return this.state.currentIndex>=0}static canRedo(){return this.state.currentIndex<this.state.history.length-1}static undo(){if(!this.canUndo())return null;const t=this.state.history[this.state.currentIndex];return this.state.currentIndex--,this.notifyListeners(),t}static redo(){if(!this.canRedo())return null;this.state.currentIndex++;const t=this.state.history[this.state.currentIndex];return this.notifyListeners(),t}static getHistory(){return[...this.state.history]}static getCurrentIndex(){return this.state.currentIndex}static clear(){this.state.history=[],this.state.currentIndex=-1,this.notifyListeners()}static createPinAssignmentAction(t,r,n){return{type:"PIN_ASSIGNMENT",data:{pinId:t,oldSignal:r,newSignal:n}}}static createBulkAssignmentAction(t){return{type:"BULK_ASSIGNMENT",data:{assignments:t}}}static createSelectionAction(t,r){return{type:"SELECTION_CHANGE",data:{oldSelection:Array.from(t),newSelection:Array.from(r)}}}static createViewChangeAction(t,r){return{type:"VIEW_CHANGE",data:{oldView:t,newView:r}}}static getActionDescription(t){switch(t.type){case"PIN_ASSIGNMENT":{const{pinId:r,newSignal:n}=t.data;return n?`Assigned "${n}" to pin ${r}`:`Cleared assignment from pin ${r}`}case"BULK_ASSIGNMENT":return`Bulk assignment to ${t.data.assignments.length} pins`;case"SELECTION_CHANGE":return`Selected ${t.data.newSelection.length} pin(s)`;case"VIEW_CHANGE":return"Changed view settings";default:return t.description||`Unknown action: ${t.type}`}}}Tr.state={history:[],currentIndex:-1,maxHistorySize:50};Tr.listeners=new Set;function Is(e){if(e.length===1)return e.charCodeAt(0)-65;if(e.length===2){const t=e.charCodeAt(0)-65,r=e.charCodeAt(1)-65;return 26+t*26+r}return 0}function ol(e){if(e<0)return console.warn(` Invalid index ${e}, defaulting to 'A'`),"A";if(e<26)return String.fromCharCode(65+e);{const t=e-26,r=Math.floor(t/26),n=t%26;return String.fromCharCode(65+r)+String.fromCharCode(65+n)}}function H6(e,t){const r=Is(e),n=Is(t);return r-n}pC();const Qp={rotation:0,isTopView:!0,zoom:1,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},Ff={pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"grid",sortOrder:"asc"},vC={activeTab:"overview",viewMode:"grid",searchQuery:"",selectedRows:new Set,sortColumn:void 0,sortDirection:"asc",commentFilter:"all"},Xi=nC()(xC((e,t)=>({currentProject:null,package:null,pins:[],filteredPins:[],selectedPins:new Set,visibleBanks:new Set,viewConfig:Qp,listView:vC,pinColorMode:"bank",filters:Ff,isLoading:!1,error:null,recentFiles:[],canUndo:!1,canRedo:!1,currentActionDescription:null,nextRedoActionDescription:null,loadProject:r=>{e(n=>{n.currentProject=r,n.package=r.packageData,n.pins=r.pinAssignments,n.viewConfig=r.viewConfig,n.filters=r.filters}),t().applyFilters()},createNewProject:(r,n)=>e(i=>{const a={id:crypto.randomUUID(),name:r,description:"",created:new Date,modified:new Date,projectInfo:{device:n.device,package:n.packageType,speedGrade:"-1",temperature:"C"},packageData:n,pinAssignments:n.pins,viewConfig:Qp,filters:Ff};i.currentProject=a,i.package=n,i.pins=n.pins,i.filteredPins=n.pins,i.viewConfig=Qp,i.filters=Ff;const s=new Set;n.pins.forEach(o=>{const u=o.bank||"NA";s.add(u)}),i.visibleBanks=s,console.log(" : newProject -  visibleBanks:",Array.from(s)),t().applyFilters()}),saveProject:()=>e(r=>{r.currentProject&&(r.currentProject.modified=new Date,r.currentProject.pinAssignments=r.pins,r.currentProject.viewConfig=r.viewConfig,r.currentProject.filters=r.filters)}),loadPackage:r=>e(n=>{var a;console.log(" : loadPackage",r),n.package=r,n.pins=r.pins,n.filteredPins=r.pins,n.selectedPins.clear();const i=new Set;r.pins.forEach(s=>{const o=s.bank||"NA";i.add(o)}),n.visibleBanks=i,console.log(" :  visibleBanks:",Array.from(i)),console.log(" :",{packageName:(a=n.package)==null?void 0:a.name,pinsCount:n.pins.length,filteredPinsCount:n.filteredPins.length})}),updatePin:(r,n)=>e(i=>{const a=i.pins.find(s=>s.id===r);a&&(Object.assign(a,n),n.signalName!==void 0&&(a.isAssigned=n.signalName!==""))}),updatePins:r=>e(n=>{r.forEach((i,a)=>{const s=n.pins.find(o=>o.id===a);s&&(Object.assign(s,i),i.signalName!==void 0&&(s.isAssigned=i.signalName!==""))})}),assignSignal:(r,n)=>{const a=t().pins.find(u=>u.id===r);if(!a)return;const s=a.signalName,o=Tr.createPinAssignmentAction(r,s,n);Tr.recordAction(o.type,o.data,n?` "${n}"  ${r} `:` ${r} `),e(u=>{const f=u.pins.find(d=>d.id===r);f&&(f.signalName=n,f.isAssigned=n!=="")}),t().applyFilters(),t().updateUndoRedoState()},clearSignal:r=>{const i=t().pins.find(o=>o.id===r);if(!i||!i.signalName)return;const a=i.signalName,s=Tr.createPinAssignmentAction(r,a,"");Tr.recordAction(s.type,s.data,` ${r} `),e(o=>{const u=o.pins.find(f=>f.id===r);u&&(u.signalName="",u.isAssigned=!1)}),t().applyFilters(),t().updateUndoRedoState()},selectPin:r=>e(n=>{n.selectedPins.clear(),n.selectedPins.add(r)}),selectPins:r=>e(n=>{n.selectedPins.clear(),r.forEach(i=>n.selectedPins.add(i))}),clearSelection:()=>e(r=>{r.selectedPins.clear()}),togglePinSelection:r=>e(n=>{n.selectedPins.has(r)?n.selectedPins.delete(r):n.selectedPins.add(r)}),setRotation:r=>e(n=>{n.viewConfig.rotation=r%360}),toggleView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setZoom:r=>e(n=>{n.viewConfig.zoom=Math.max(.1,Math.min(5,r))}),resetZoom:()=>e(r=>{r.viewConfig.zoom=1}),updateViewConfig:r=>e(n=>{Object.assign(n.viewConfig,r)}),updateFilters:r=>e(n=>{Object.assign(n.filters,r);let i=[...n.pins];if(n.filters.pinTypes.length>0&&(i=i.filter(a=>n.filters.pinTypes.includes(a.pinType))),n.filters.banks.length>0&&(i=i.filter(a=>a.bank&&n.filters.banks.includes(a.bank))),n.filters.searchText){const a=n.filters.searchText.toLowerCase();i=i.filter(s=>s.pinNumber.toLowerCase().includes(a)||s.pinName.toLowerCase().includes(a)||s.signalName.toLowerCase().includes(a))}n.filters.voltageFilter.length>0&&(i=i.filter(a=>n.filters.voltageFilter.includes(a.voltage))),n.filters.assignmentStatus!=="all"&&(i=i.filter(a=>n.filters.assignmentStatus==="assigned"?a.isAssigned:!a.isAssigned)),n.filters.showOnlyDifferentialPairs&&(i=i.filter(a=>a.differentialPair)),i.sort((a,s)=>{var d,p;let o,u;switch(n.filters.sortField){case"pinNumber":o=a.pinNumber,u=s.pinNumber;break;case"pinName":o=a.pinName,u=s.pinName;break;case"signalName":o=a.signalName,u=s.signalName;break;case"pinType":o=a.pinType,u=s.pinType;break;case"bank":o=a.bank||"",u=s.bank||"";break;case"grid":if(a.gridPosition&&s.gridPosition){const g=H6(a.gridPosition.row,s.gridPosition.row);if(g!==0)return n.filters.sortOrder==="asc"?g:-g;const v=a.gridPosition.col-s.gridPosition.col;return n.filters.sortOrder==="asc"?v:-v}o=((d=a.gridPosition)==null?void 0:d.row)||"",u=((p=s.gridPosition)==null?void 0:p.row)||"";break;default:o=a.pinNumber,u=s.pinNumber}const f=o.localeCompare(u,void 0,{numeric:!0,sensitivity:"base"});return n.filters.sortOrder==="asc"?f:-f}),n.filteredPins=i}),clearFilters:()=>e(r=>{r.filters={...Ff},r.filteredPins=r.pins}),applyFilters:()=>e(r=>{let n=[...r.pins];if(console.log(" applyFilters: visibleBanks =",Array.from(r.visibleBanks)),console.log(" applyFilters: pins before bank filter =",n.length),r.visibleBanks.size>0){const i=n.length;n=n.filter(a=>{const s=a.bank||"UNASSIGNED";return r.visibleBanks.has(s)}),console.log(` applyFilters: filtered from ${i} to ${n.length} pins`)}else console.log(" applyFilters: visibleBanks is empty, showing all pins");if(r.filters.pinTypes.length>0&&(n=n.filter(i=>r.filters.pinTypes.includes(i.pinType))),r.filters.banks.length>0&&(n=n.filter(i=>i.bank&&r.filters.banks.includes(i.bank))),r.filters.searchText){const i=r.filters.searchText.toLowerCase();n=n.filter(a=>a.pinNumber.toLowerCase().includes(i)||a.pinName.toLowerCase().includes(i)||a.signalName.toLowerCase().includes(i))}r.filters.voltageFilter.length>0&&(n=n.filter(i=>r.filters.voltageFilter.includes(i.voltage))),r.filters.assignmentStatus!=="all"&&(n=n.filter(i=>r.filters.assignmentStatus==="assigned"?i.isAssigned:!i.isAssigned)),r.filters.showOnlyDifferentialPairs&&(n=n.filter(i=>i.differentialPair)),n.sort((i,a)=>{let s,o;switch(r.filters.sortField){case"pinNumber":s=i.pinNumber,o=a.pinNumber;break;case"pinName":s=i.pinName,o=a.pinName;break;case"signalName":s=i.signalName||"",o=a.signalName||"";break;case"pinType":s=i.pinType,o=a.pinType;break;case"bank":s=i.bank||"",o=a.bank||"";break;default:s=i.pinNumber,o=a.pinNumber}const u=s.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"});return r.filters.sortOrder==="asc"?u:-u}),r.filteredPins=n}),setSortField:r=>e(n=>{n.filters.sortField=r,t().applyFilters()}),setSortOrder:r=>e(n=>{n.filters.sortOrder=r,t().applyFilters()}),toggleBankVisibility:r=>{e(n=>{console.log(` toggleBankVisibility called for Bank ${r}`),console.log(" Before: visibleBanks =",Array.from(n.visibleBanks)),n.visibleBanks.has(r)?(n.visibleBanks.delete(r),console.log(` Removed Bank ${r} from visibleBanks`)):(n.visibleBanks.add(r),console.log(` Added Bank ${r} to visibleBanks`)),console.log(" After: visibleBanks =",Array.from(n.visibleBanks))}),console.log(" Calling applyFilters after state update..."),t().applyFilters()},setBankVisibility:(r,n)=>{e(i=>{n?i.visibleBanks.add(r):i.visibleBanks.delete(r)}),t().applyFilters()},showAllBanks:()=>{e(r=>{console.log(" showAllBanks: clearing visibleBanks"),r.visibleBanks.clear()}),t().applyFilters()},assignDifferentialPair:(r,n,i)=>e(a=>{const s=a.pins.find(u=>u.id===r),o=a.pins.find(u=>u.id===n);s&&o&&(s.signalName=`${i}_P`,s.isAssigned=!0,s.differentialPair={pair:n,type:"positive"},o.signalName=`${i}_N`,o.isAssigned=!0,o.differentialPair={pair:r,type:"negative"})}),clearDifferentialPair:r=>e(n=>{const i=n.pins.find(a=>a.id===r);if(i&&i.differentialPair){const a=n.pins.find(s=>s.id===i.differentialPair.pair);i.differentialPair=void 0,i.signalName="",i.isAssigned=!1,a&&(a.differentialPair=void 0,a.signalName="",a.isAssigned=!1)}}),rotatePins:r=>e(n=>{n.viewConfig.rotation=(n.viewConfig.rotation+r)%360}),flipView:()=>e(r=>{r.viewConfig.isTopView=!r.viewConfig.isTopView}),setLoading:r=>e(n=>{n.isLoading=r}),setError:r=>e(n=>{n.error=r}),setViewMode:r=>e(n=>{n.listView.viewMode=r}),setActiveTab:r=>e(n=>{n.listView.activeTab=r}),setSearchQuery:r=>e(n=>{n.listView.searchQuery=r}),setCommentFilter:r=>e(n=>{n.listView.commentFilter=r}),updateListViewState:r=>e(n=>{Object.assign(n.listView,r)}),bulkUpdateComments:(r,n)=>e(i=>{const a=new Date;r.forEach(s=>{const o=i.pins.find(u=>u.id===s);o&&(o.comment=n,o.commentTimestamp=a,o.commentAuthor="current_user")}),i.listView.selectedRows.clear()}),setPinColorMode:r=>e(n=>{n.pinColorMode=r}),addRecentFile:r=>e(n=>{const i=n.recentFiles.filter(a=>a!==r);n.recentFiles=[r,...i].slice(0,10)}),undo:()=>{const r=Tr.undo();r&&(t().handleUndoRedoAction(r,"undo"),t().updateUndoRedoState())},redo:()=>{const r=Tr.redo();r&&(t().handleUndoRedoAction(r,"redo"),t().updateUndoRedoState())},updateUndoRedoState:()=>e(r=>{r.canUndo=Tr.canUndo(),r.canRedo=Tr.canRedo();const n=Tr.getHistory(),i=Tr.getCurrentIndex();i>=0&&i<n.length?r.currentActionDescription=Tr.getActionDescription(n[i]):r.currentActionDescription=null,i+1<n.length?r.nextRedoActionDescription=Tr.getActionDescription(n[i+1]):r.nextRedoActionDescription=null}),clearHistory:()=>{Tr.clear(),t().updateUndoRedoState()},handleUndoRedoAction:(r,n)=>{const{type:i,data:a}=r;switch(i){case"PIN_ASSIGNMENT":{const{pinId:s,oldSignal:o,newSignal:u}=a,f=n==="undo"?o:u;e(d=>{const p=d.pins.find(g=>g.id===s);p&&(p.signalName=f||"",p.isAssigned=!!f)}),t().applyFilters();break}case"BULK_ASSIGNMENT":{const{assignments:s}=a;e(o=>{s.forEach(({pinId:u,oldSignal:f,newSignal:d})=>{const p=o.pins.find(g=>g.id===u);if(p){const g=n==="undo"?f:d;p.signalName=g||"",p.isAssigned=!!g}})}),t().applyFilters();break}case"SELECTION_CHANGE":{const{oldSelection:s,newSelection:o}=a,u=n==="undo"?s:o;e(f=>{f.selectedPins=new Set(u)});break}case"VIEW_CHANGE":{const{oldView:s,newView:o}=a,u=n==="undo"?s:o;e(f=>{Object.assign(f.viewConfig,u)});break}default:console.warn(`Unhandled undo/redo action type: ${i}`);break}}})));/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var W6=1252,yC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},U2=function(e){yC.indexOf(e)!=-1&&(W6=B2[0]=e)};function _C(){U2(1252)}var Gi=function(e){U2(e)};function $6(){Gi(1200),_C()}function Fy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function wC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function X6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var t0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?wC(e.slice(2)):t==254&&r==255?X6(e.slice(2)):t==65279?e.slice(1):e},Nf=function(t){return String.fromCharCode(t)},Ny=function(t){return String.fromCharCode(t)},gs,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ry(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,i=e.charCodeAt(f++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),t+=ys.charAt(a)+ys.charAt(s)+ys.charAt(o)+ys.charAt(u);return t}function ri(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=ys.indexOf(e.charAt(f++)),s=ys.indexOf(e.charAt(f++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=ys.indexOf(e.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),u=ys.indexOf(e.charAt(f++)),i=(o&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ro=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ds(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Iy(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Vi=function(t){return wt?Ro(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Io(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function j2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return j2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ms=wt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ro(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function SC(e){for(var t=[],r=0,n=e.length+250,i=Ds(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ds(65535),n=65530)}return t.push(i.slice(0,r)),ms(t)}var Tn=/\u0000/g,r0=/[\u0001-\u0006]/g;function bl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Hi(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}function z2(e,t){var r=""+e;return r.length>=t?r:cr(" ",t-r.length)+r}function Rd(e,t){var r=""+e;return r.length>=t?r:r+cr(" ",t-r.length)}function kC(e,t){var r=""+Math.round(e);return r.length>=t?r:cr("0",t-r.length)+r}function EC(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}var Dy=Math.pow(2,32);function ll(e,t){if(e>Dy||e<-Dy)return kC(e,t);var r=Math.round(e);return EC(r,t)}function Id(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var by=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CC(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Oy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},TC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dd(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),o=p*s+a,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),a=s,s=o,u=f,f=d;if(d>t&&(f>t?(d=u,o=a):(d=f,o=s)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function po(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=IC(u,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var K6=new Date(1899,11,31,0,0,0),AC=K6.getTime(),PC=new Date(1900,2,1,0,0,0);function Y6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=PC&&(r+=24*60*60*1e3),(r-(AC+(e.getTimezoneOffset()-K6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function V2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FC(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NC(e){var t=e<0?12:11,r=V2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function RC(e){var t=V2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NC(e):t===10?r=e.toFixed(10).substr(0,12):r=RC(e),V2(FC(r.toUpperCase()))}function To(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ti(14,Y6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function IC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function DC(e,t,r,n){var i="",a=0,s=0,o=r.y,u,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:u=o%100,f=2;break;default:u=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return qp[r.m-1][1];case 5:return qp[r.m-1][0];default:return qp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return by[r.q][0];default:return by[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Hi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Hi(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=o,f=1;break}var d=f>0?Hi(u,f):"";return d}function _s(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Q6=/%/g;function bC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ma(e,n,r*Math.pow(10,2*i))+cr("%",i)}function OC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ma(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function q6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J6=/# (\?+)( ?)\/( ?)(\d+)/;function LC(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?cr(" ",e[1].length+1+e[4].length):z2(s,e[1].length)+e[2]+"/"+e[3]+Hi(o,e[4].length))}function MC(e,t,r){return r+(t===0?"":""+t)+cr(" ",e[1].length+2+e[4].length)}var Z6=/^#*0*\.([0#]+)/,e8=/\).*[0#]/,t8=/\(###\) ###\\?-####/;function Sn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ly(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function My(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function BC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function UC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(e8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xi("n",n,r):"("+xi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return OC(e,t,r);if(t.indexOf("%")!==-1)return bC(e,t,r);if(t.indexOf("E")!==-1)return q6(t,r);if(t.charCodeAt(0)===36)return"$"+xi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ll(u,t.length);if(t.match(/^[#?]+$/))return i=ll(r,0),i==="0"&&(i=""),i.length>t.length?i:Sn(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return LC(a,u,f);if(t.match(/^#+0+$/))return f+ll(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=Ly(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])).replace(/\.(\d*)$/,function(m,y){return"."+y+cr("0",Sn(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+Ly(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+_s(ll(u,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xi(e,t,-r):_s(""+(Math.floor(r)+BC(r,a[1].length)))+"."+Hi(My(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return xi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(xi(e,t.replace(/[\\-]/g,""),r)),s=0,bl(bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(t8))return i=xi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Dd(u,Math.pow(10,s)-1,!1),i=""+f,d=Ma("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Rd(o[2],s),d.length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Dd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?z2(o[1],s)+a[2]+"/"+a[3]+Rd(o[2],s):cr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ll(r,0),t.length<=i.length?i:Sn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return Sn(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=My(r,a[1].length),r<0?"-"+xi(e,t,-r):_s(UC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Hi(0,3-m.length):"")+m})+"."+Hi(s,a[1].length);switch(t){case"###,##0.00":return xi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=_s(ll(u,0));return v!=="0"?f+v:"";case"###,###.00":return xi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ma(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function zC(e,t,r){var n=t.replace(Q6,""),i=t.length-n.length;return Ma(e,n,r*Math.pow(10,2*i))+cr("%",i)}function r8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+r8(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,f,d){return u+f+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ca(e,t,r){if(e.charCodeAt(0)===40&&!t.match(e8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ca("n",n,r):"("+ca("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jC(e,t,r);if(t.indexOf("%")!==-1)return zC(e,t,r);if(t.indexOf("E")!==-1)return r8(t,r);if(t.charCodeAt(0)===36)return"$"+ca(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Hi(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Sn(t.substr(0,t.length-i.length))+i;if(a=t.match(J6))return MC(a,u,f);if(t.match(/^#+0+$/))return f+Hi(u,t.length-t.indexOf("0"));if(a=t.match(Z6))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])),i=i.replace(/\.(\d*)$/,function(m,y){return"."+y+cr("0",Sn(a[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+_s(""+u);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ca(e,t,-r):_s(""+r)+"."+cr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ca(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bl(ca(e,t.replace(/[\\-]/g,""),r)),s=0,bl(bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match(t8))return i=ca(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=Dd(u,Math.pow(10,s)-1,!1),i=""+f,d=Ma("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Rd(o[2],s),d.length<a[4].length&&(d=Sn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=Dd(u,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?z2(o[1],s)+a[2]+"/"+a[3]+Rd(o[2],s):cr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Sn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=t.indexOf(".")-s,g=t.length-i.length-p;return Sn(t.substr(0,p)+i+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ca(e,t,-r):_s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Hi(0,3-m.length):"")+m})+"."+Hi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=_s(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return ca(e,t.slice(0,t.lastIndexOf(".")),r)+Sn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ma(e,t,r){return(r|0)===r?ca(e,t,r):xi(e,t,r)}function VC(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var n8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Id(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(n8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function GC(e,t,r,n){for(var i=[],a="",s=0,o="",u="t",f,d,p,g="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Id(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(p=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(p);i[i.length]={t:"t",v:a},++s;break;case"\\":var v=e.charAt(++s),m=v==="("||v===")"?v:"t";i[i.length]={t:m,v},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=po(t,r,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=po(t,r),f==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),i[i.length]={t:o,v:a},u=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=po(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,g="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",s+=5,g="h"):(y.t="t",++s),f==null&&y.t==="T")return"";i[i.length]=y,u=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(n8)){if(f==null&&(f=po(t,r),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",nc(e)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},u=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var E=0,k=0,w;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=g,u="h",E<1&&(E=1);break;case"s":(w=i[s].v.match(/\.0+$/))&&(k=Math.max(k,w[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[s].v.match(/[Hh]/)&&(E=1),E<2&&i[s].v.match(/[Mm]/)&&(E=2),E<3&&i[s].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var x="",C;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=DC(i[s].t.charCodeAt(0),i[s].v,f,k),i[s].t="t";break;case"n":case"?":for(C=s+1;i[C]!=null&&((o=i[C].t)==="?"||o==="D"||(o===" "||o==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[s].v+=i[C].v,i[C]={v:"",t:";"},++C;x+=i[s].v,s=C-1;break;case"G":i[s].t="t",i[s].v=To(t,r);break}var A="",P,N;if(x.length>0){x.charCodeAt(0)==40?(P=t<0&&x.charCodeAt(0)===45?-t:t,N=Ma("n",x,P)):(P=t<0&&n>1?-t:t,N=Ma("n",x,P),P<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),C=N.length-1;var F=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){F=s;break}var I=i.length;if(F===i.length&&N.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(C>=i[s].v.length-1?(C-=i[s].v.length,i[s].v=N.substr(C+1,i[s].v.length)):C<0?i[s].v="":(i[s].v=N.substr(0,C+1),C=-1),i[s].t="t",I=s);C>=0&&I<i.length&&(i[I].v=N.substr(0,C+1)+i[I].v)}else if(F!==i.length&&N.indexOf("E")===-1){for(C=N.indexOf(".")-1,s=F;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===F?i[s].v.indexOf(".")-1:i[s].v.length-1,A=i[s].v.substr(d+1);d>=0;--d)C>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(A=N.charAt(C--)+A);i[s].v=A,i[s].t="t",I=s}for(C>=0&&I<i.length&&(i[I].v=N.substr(0,C+1)+i[I].v),C=N.indexOf(".")+1,s=F;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==F)){for(d=i[s].v.indexOf(".")>-1&&s===F?i[s].v.indexOf(".")+1:0,A=i[s].v.substr(0,d);d<i[s].v.length;++d)C<N.length&&(A+=N.charAt(C++));i[s].v=A,i[s].t="t",I=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(P=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Ma(i[s].t,i[s].v,P),i[s].t="t");var D="";for(s=0;s!==i.length;++s)i[s]!=null&&(D+=i[s].v);return D}var By=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function HC(e,t){var r=VC(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(By),o=r[1].match(By);return Uy(t,s)?[n,r[0]]:Uy(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Ti(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[e],n==null&&(n=r.table&&r.table[Oy[e]]||ft[Oy[e]]),n==null&&(n=TC[e]||"General");break}if(Id(n,0))return To(t,r);t instanceof Date&&(t=Y6(t,r.date1904));var i=HC(n,t);if(Id(i[1]))return To(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return GC(i[1],t,r,i[0])}function vo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ft[r]==null){t<0&&(t=r);continue}if(ft[r]==e){t=r;break}}t<0&&(t=391)}return ft[t]=e,t}function i8(){ft=CC()}var WC={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $C(e){var t=typeof e=="number"?ft[e]:e;return t=t.replace(a8,"(\\d+)"),new RegExp("^"+t+"$")}function XC(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,u=-1;(t.match(a8)||[]).forEach(function(p,g){var v=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":a=v;break;case"h":s=v;break;case"s":u=v;break;case"m":s>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&o==-1&&u==-1?f:n==-1&&i==-1&&a==-1?d:f+"T"+d}var KC=function(){var e={};e.version="1.2.0";function t(){for(var N=0,F=new Array(256),I=0;I!=256;++I)N=I,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,F[I]=N;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(N){var F=0,I=0,D=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)U[D]=N[D];for(D=0;D!=256;++D)for(I=N[D],F=256+D;F<4096;F+=256)I=U[F]=I>>>8^N[I&255];var O=[];for(D=1;D!=16;++D)O[D-1]=typeof Int32Array<"u"?U.subarray(D*256,D*256+256):U.slice(D*256,D*256+256);return O}var i=n(r),a=i[0],s=i[1],o=i[2],u=i[3],f=i[4],d=i[5],p=i[6],g=i[7],v=i[8],m=i[9],y=i[10],E=i[11],k=i[12],w=i[13],x=i[14];function C(N,F){for(var I=F^-1,D=0,U=N.length;D<U;)I=I>>>8^r[(I^N.charCodeAt(D++))&255];return~I}function A(N,F){for(var I=F^-1,D=N.length-15,U=0;U<D;)I=x[N[U++]^I&255]^w[N[U++]^I>>8&255]^k[N[U++]^I>>16&255]^E[N[U++]^I>>>24]^y[N[U++]]^m[N[U++]]^v[N[U++]]^g[N[U++]]^p[N[U++]]^d[N[U++]]^f[N[U++]]^u[N[U++]]^o[N[U++]]^s[N[U++]]^a[N[U++]]^r[N[U++]];for(D+=15;U<D;)I=I>>>8^r[(I^N[U++])&255];return~I}function P(N,F){for(var I=F^-1,D=0,U=N.length,O=0,Q=0;D<U;)O=N.charCodeAt(D++),O<128?I=I>>>8^r[(I^O)&255]:O<2048?(I=I>>>8^r[(I^(192|O>>6&31))&255],I=I>>>8^r[(I^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,Q=N.charCodeAt(D++)&1023,I=I>>>8^r[(I^(240|O>>8&7))&255],I=I>>>8^r[(I^(128|O>>2&63))&255],I=I>>>8^r[(I^(128|Q>>6&15|(O&3)<<4))&255],I=I>>>8^r[(I^(128|Q&63))&255]):(I=I>>>8^r[(I^(224|O>>12&15))&255],I=I>>>8^r[(I^(128|O>>6&63))&255],I=I>>>8^r[(I^(128|O&63))&255]);return~I}return e.table=r,e.bstr=C,e.buf=A,e.str=P,e}(),Ct=function(){var t={};t.version="1.2.1";function r(b,V){for(var M=b.split("/"),j=V.split("/"),H=0,W=0,ne=Math.min(M.length,j.length);H<ne;++H){if(W=M[H].length-j[H].length)return W;if(M[H]!=j[H])return M[H]<j[H]?-1:1}return M.length-j.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var V=b.lastIndexOf("/");return V===-1?b:b.slice(0,V+1)}function i(b){if(b.charAt(b.length-1)=="/")return i(b.slice(0,-1));var V=b.lastIndexOf("/");return V===-1?b:b.slice(V+1)}function a(b,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,b.write_shift(2,M);var j=V.getFullYear()-1980;j=j<<4|V.getMonth()+1,j=j<<5|V.getDate(),b.write_shift(2,j)}function s(b){var V=b.read_shift(2)&65535,M=b.read_shift(2)&65535,j=new Date,H=M&31;M>>>=5;var W=M&15;M>>>=4,j.setMilliseconds(0),j.setFullYear(M+1980),j.setMonth(W-1),j.setDate(H);var ne=V&31;V>>>=5;var ve=V&63;return V>>>=6,j.setHours(V),j.setMinutes(ve),j.setSeconds(ne<<1),j}function o(b){Qr(b,0);for(var V={},M=0;b.l<=b.length-4;){var j=b.read_shift(2),H=b.read_shift(2),W=b.l+H,ne={};switch(j){case 21589:M=b.read_shift(1),M&1&&(ne.mtime=b.read_shift(4)),H>5&&(M&2&&(ne.atime=b.read_shift(4)),M&4&&(ne.ctime=b.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}b.l=W,V[j]=ne}return V}var u;function f(){return u||(u={})}function d(b,V){if(b[0]==80&&b[1]==75)return at(b,V);if((b[0]|32)==109&&(b[1]|32)==105)return Xs(b,V);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var M=3,j=512,H=0,W=0,ne=0,ve=0,re=0,ae=[],oe=b.slice(0,512);Qr(oe,0);var Re=p(oe);switch(M=Re[0],M){case 3:j=512;break;case 4:j=4096;break;case 0:if(Re[1]==0)return at(b,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}j!==512&&(oe=b.slice(0,j),Qr(oe,28));var Be=b.slice(0,j);g(oe,M);var He=oe.read_shift(4,"i");if(M===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);oe.l+=4,ne=oe.read_shift(4,"i"),oe.l+=4,oe.chk("00100000","Mini Stream Cutoff Size: "),ve=oe.read_shift(4,"i"),H=oe.read_shift(4,"i"),re=oe.read_shift(4,"i"),W=oe.read_shift(4,"i");for(var Oe=-1,je=0;je<109&&(Oe=oe.read_shift(4,"i"),!(Oe<0));++je)ae[je]=Oe;var it=v(b,j);E(re,W,it,j,ae);var Lt=w(it,ne,ae,j);Lt[ne].name="!Directory",H>0&&ve!==Q&&(Lt[ve].name="!MiniFAT"),Lt[ae[0]].name="!FAT",Lt.fat_addrs=ae,Lt.ssz=j;var zt={},xr=[],Ks=[],ya=[];x(ne,Lt,it,xr,H,zt,Ks,ve),m(Ks,ya,xr),xr.shift();var si={FileIndex:Ks,FullPaths:ya};return V&&V.raw&&(si.raw={header:Be,sectors:it}),si}function p(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(he,"Header Signature: "),b.l+=16;var V=b.read_shift(2,"u");return[b.read_shift(2,"u"),V]}function g(b,V){var M=9;switch(b.l+=2,M=b.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function v(b,V){for(var M=Math.ceil(b.length/V)-1,j=[],H=1;H<M;++H)j[H-1]=b.slice(H*V,(H+1)*V);return j[M-1]=b.slice(M*V),j}function m(b,V,M){for(var j=0,H=0,W=0,ne=0,ve=0,re=M.length,ae=[],oe=[];j<re;++j)ae[j]=oe[j]=j,V[j]=M[j];for(;ve<oe.length;++ve)j=oe[ve],H=b[j].L,W=b[j].R,ne=b[j].C,ae[j]===j&&(H!==-1&&ae[H]!==H&&(ae[j]=ae[H]),W!==-1&&ae[W]!==W&&(ae[j]=ae[W])),ne!==-1&&(ae[ne]=j),H!==-1&&j!=ae[j]&&(ae[H]=ae[j],oe.lastIndexOf(H)<ve&&oe.push(H)),W!==-1&&j!=ae[j]&&(ae[W]=ae[j],oe.lastIndexOf(W)<ve&&oe.push(W));for(j=1;j<re;++j)ae[j]===j&&(W!==-1&&ae[W]!==W?ae[j]=ae[W]:H!==-1&&ae[H]!==H&&(ae[j]=ae[H]));for(j=1;j<re;++j)if(b[j].type!==0){if(ve=j,ve!=ae[ve])do ve=ae[ve],V[j]=V[ve]+"/"+V[j];while(ve!==0&&ae[ve]!==-1&&ve!=ae[ve]);ae[j]=-1}for(V[0]+="/",j=1;j<re;++j)b[j].type!==2&&(V[j]+="/")}function y(b,V,M){for(var j=b.start,H=b.size,W=[],ne=j;M&&H>0&&ne>=0;)W.push(V.slice(ne*O,ne*O+O)),H-=O,ne=co(M,ne*4);return W.length===0?Pr(0):ms(W).slice(0,b.size)}function E(b,V,M,j,H){var W=Q;if(b===Q){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var ne=M[b],ve=(j>>>2)-1;if(!ne)return;for(var re=0;re<ve&&(W=co(ne,re*4))!==Q;++re)H.push(W);E(co(ne,j-4),V-1,M,j,H)}}function k(b,V,M,j,H){var W=[],ne=[];H||(H=[]);var ve=j-1,re=0,ae=0;for(re=V;re>=0;){H[re]=!0,W[W.length]=re,ne.push(b[re]);var oe=M[Math.floor(re*4/j)];if(ae=re*4&ve,j<4+ae)throw new Error("FAT boundary crossed: "+re+" 4 "+j);if(!b[oe])break;re=co(b[oe],ae)}return{nodes:W,data:Yy([ne])}}function w(b,V,M,j){var H=b.length,W=[],ne=[],ve=[],re=[],ae=j-1,oe=0,Re=0,Be=0,He=0;for(oe=0;oe<H;++oe)if(ve=[],Be=oe+V,Be>=H&&(Be-=H),!ne[Be]){re=[];var Oe=[];for(Re=Be;Re>=0;){Oe[Re]=!0,ne[Re]=!0,ve[ve.length]=Re,re.push(b[Re]);var je=M[Math.floor(Re*4/j)];if(He=Re*4&ae,j<4+He)throw new Error("FAT boundary crossed: "+Re+" 4 "+j);if(!b[je]||(Re=co(b[je],He),Oe[Re]))break}W[Be]={nodes:ve,data:Yy([re])}}return W}function x(b,V,M,j,H,W,ne,ve){for(var re=0,ae=j.length?2:0,oe=V[b].data,Re=0,Be=0,He;Re<oe.length;Re+=128){var Oe=oe.slice(Re,Re+128);Qr(Oe,64),Be=Oe.read_shift(2),He=X2(Oe,0,Be-ae),j.push(He);var je={name:He,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},it=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);it!==0&&(je.ct=C(Oe,Oe.l-8));var Lt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Lt!==0&&(je.mt=C(Oe,Oe.l-8)),je.start=Oe.read_shift(4,"i"),je.size=Oe.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=Q,je.name=""),je.type===5?(re=je.start,H>0&&re!==Q&&(V[re].name="!StreamData")):je.size>=4096?(je.storage="fat",V[je.start]===void 0&&(V[je.start]=k(M,je.start,V.fat_addrs,V.ssz)),V[je.start].name=je.name,je.content=V[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:re!==Q&&je.start!==Q&&V[re]&&(je.content=y(je,V[re].data,(V[ve]||{}).data))),je.content&&Qr(je.content,0),W[He]=je,ne.push(je)}}function C(b,V){return new Date((Qn(b,V+4)/1e7*Math.pow(2,32)+Qn(b,V)/1e7-11644473600)*1e3)}function A(b,V){return f(),d(u.readFileSync(b),V)}function P(b,V){var M=V&&V.type;switch(M||wt&&Buffer.isBuffer(b)&&(M="buffer"),M||"base64"){case"file":return A(b,V);case"base64":return d(Vi(ri(b)),V);case"binary":return d(Vi(b),V)}return d(b,V)}function N(b,V){var M=V||{},j=M.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=j+"/",b.FileIndex[0]={name:j,type:5}),M.CLSID&&(b.FileIndex[0].clsid=M.CLSID),F(b)}function F(b){var V="Sh33tJ5";if(!Ct.find(b,"/"+V)){var M=Pr(4);M[0]=55,M[1]=M[3]=50,M[2]=54,b.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+V),I(b)}}function I(b,V){N(b);for(var M=!1,j=!1,H=b.FullPaths.length-1;H>=0;--H){var W=b.FileIndex[H];switch(W.type){case 0:j?M=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(W.R*W.L*W.C)&&(M=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var ne=new Date(1987,1,19),ve=0,re=Object.create?Object.create(null):{},ae=[];for(H=0;H<b.FullPaths.length;++H)re[b.FullPaths[H]]=!0,b.FileIndex[H].type!==0&&ae.push([b.FullPaths[H],b.FileIndex[H]]);for(H=0;H<ae.length;++H){var oe=n(ae[H][0]);j=re[oe],j||(ae.push([oe,{name:i(oe).replace("/",""),type:1,clsid:Ee,ct:ne,mt:ne,content:null}]),re[oe]=!0)}for(ae.sort(function(He,Oe){return r(He[0],Oe[0])}),b.FullPaths=[],b.FileIndex=[],H=0;H<ae.length;++H)b.FullPaths[H]=ae[H][0],b.FileIndex[H]=ae[H][1];for(H=0;H<ae.length;++H){var Re=b.FileIndex[H],Be=b.FullPaths[H];if(Re.name=i(Be).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||Ee,H===0)Re.C=ae.length>1?1:-1,Re.size=0,Re.type=5;else if(Be.slice(-1)=="/"){for(ve=H+1;ve<ae.length&&n(b.FullPaths[ve])!=Be;++ve);for(Re.C=ve>=ae.length?-1:ve,ve=H+1;ve<ae.length&&n(b.FullPaths[ve])!=n(Be);++ve);Re.R=ve>=ae.length?-1:ve,Re.type=1}else n(b.FullPaths[H+1]||"")==n(Be)&&(Re.R=H+1),Re.type=2}}}function D(b,V){var M=V||{};if(M.fileType=="mad")return $o(b,M);switch(I(b),M.fileType){case"zip":return Ot(b,M)}var j=function(He){for(var Oe=0,je=0,it=0;it<He.FileIndex.length;++it){var Lt=He.FileIndex[it];if(Lt.content){var zt=Lt.content.length;zt>0&&(zt<4096?Oe+=zt+63>>6:je+=zt+511>>9)}}for(var xr=He.FullPaths.length+3>>2,Ks=Oe+7>>3,ya=Oe+127>>7,si=Ks+je+xr+ya,tn=si+127>>7,Mt=tn<=109?0:Math.ceil((tn-109)/127);si+tn+Mt+127>>7>tn;)Mt=++tn<=109?0:Math.ceil((tn-109)/127);var yt=[1,Mt,tn,ya,xr,je,Oe,0];return He.FileIndex[0].size=Oe<<6,yt[7]=(He.FileIndex[0].start=yt[0]+yt[1]+yt[2]+yt[3]+yt[4]+yt[5])+(yt[6]+7>>3),yt}(b),H=Pr(j[7]<<9),W=0,ne=0;{for(W=0;W<8;++W)H.write_shift(1,te[W]);for(W=0;W<8;++W)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),W=0;W<3;++W)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,j[2]),H.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:Q),H.write_shift(4,j[3]),H.write_shift(-4,j[1]?j[0]-1:Q),H.write_shift(4,j[1]),W=0;W<109;++W)H.write_shift(-4,W<j[2]?j[1]+W:-1)}if(j[1])for(ne=0;ne<j[1];++ne){for(;W<236+ne*127;++W)H.write_shift(-4,W<j[2]?j[1]+W:-1);H.write_shift(-4,ne===j[1]-1?Q:ne+1)}var ve=function(He){for(ne+=He;W<ne-1;++W)H.write_shift(-4,W+1);He&&(++W,H.write_shift(-4,Q))};for(ne=W=0,ne+=j[1];W<ne;++W)H.write_shift(-4,we.DIFSECT);for(ne+=j[2];W<ne;++W)H.write_shift(-4,we.FATSECT);ve(j[3]),ve(j[4]);for(var re=0,ae=0,oe=b.FileIndex[0];re<b.FileIndex.length;++re)oe=b.FileIndex[re],oe.content&&(ae=oe.content.length,!(ae<4096)&&(oe.start=ne,ve(ae+511>>9)));for(ve(j[6]+7>>3);H.l&511;)H.write_shift(-4,we.ENDOFCHAIN);for(ne=W=0,re=0;re<b.FileIndex.length;++re)oe=b.FileIndex[re],oe.content&&(ae=oe.content.length,!(!ae||ae>=4096)&&(oe.start=ne,ve(ae+63>>6)));for(;H.l&511;)H.write_shift(-4,we.ENDOFCHAIN);for(W=0;W<j[4]<<2;++W){var Re=b.FullPaths[W];if(!Re||Re.length===0){for(re=0;re<17;++re)H.write_shift(4,0);for(re=0;re<3;++re)H.write_shift(4,-1);for(re=0;re<12;++re)H.write_shift(4,0);continue}oe=b.FileIndex[W],W===0&&(oe.start=oe.size?oe.start-1:Q);var Be=W===0&&M.root||oe.name;if(ae=2*(Be.length+1),H.write_shift(64,Be,"utf16le"),H.write_shift(2,ae),H.write_shift(1,oe.type),H.write_shift(1,oe.color),H.write_shift(-4,oe.L),H.write_shift(-4,oe.R),H.write_shift(-4,oe.C),oe.clsid)H.write_shift(16,oe.clsid,"hex");else for(re=0;re<4;++re)H.write_shift(4,0);H.write_shift(4,oe.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,oe.start),H.write_shift(4,oe.size),H.write_shift(4,0)}for(W=1;W<b.FileIndex.length;++W)if(oe=b.FileIndex[W],oe.size>=4096)if(H.l=oe.start+1<<9,wt&&Buffer.isBuffer(oe.content))oe.content.copy(H,H.l,0,oe.size),H.l+=oe.size+511&-512;else{for(re=0;re<oe.size;++re)H.write_shift(1,oe.content[re]);for(;re&511;++re)H.write_shift(1,0)}for(W=1;W<b.FileIndex.length;++W)if(oe=b.FileIndex[W],oe.size>0&&oe.size<4096)if(wt&&Buffer.isBuffer(oe.content))oe.content.copy(H,H.l,0,oe.size),H.l+=oe.size+63&-64;else{for(re=0;re<oe.size;++re)H.write_shift(1,oe.content[re]);for(;re&63;++re)H.write_shift(1,0)}if(wt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function U(b,V){var M=b.FullPaths.map(function(re){return re.toUpperCase()}),j=M.map(function(re){var ae=re.split("/");return ae[ae.length-(re.slice(-1)=="/"?2:1)]}),H=!1;V.charCodeAt(0)===47?(H=!0,V=M[0].slice(0,-1)+V):H=V.indexOf("/")!==-1;var W=V.toUpperCase(),ne=H===!0?M.indexOf(W):j.indexOf(W);if(ne!==-1)return b.FileIndex[ne];var ve=!W.match(r0);for(W=W.replace(Tn,""),ve&&(W=W.replace(r0,"!")),ne=0;ne<M.length;++ne)if((ve?M[ne].replace(r0,"!"):M[ne]).replace(Tn,"")==W||(ve?j[ne].replace(r0,"!"):j[ne]).replace(Tn,"")==W)return b.FileIndex[ne];return null}var O=64,Q=-2,he="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(b,V,M){f();var j=D(b,M);u.writeFileSync(V,j)}function X(b){for(var V=new Array(b.length),M=0;M<b.length;++M)V[M]=String.fromCharCode(b[M]);return V.join("")}function ce(b,V){var M=D(b,V);switch(V&&V.type||"buffer"){case"file":return f(),u.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:X(M);case"base64":return Ry(typeof M=="string"?M:X(M));case"buffer":if(wt)return Buffer.isBuffer(M)?M:Ro(M);case"array":return typeof M=="string"?Vi(M):M}return M}var Se;function L(b){try{var V=b.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Se=b;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function q(b,V){if(!Se)return Ye(b,V);var M=Se.InflateRaw,j=new M,H=j._processChunk(b.slice(b.l),j._finishFlushFlag);return b.l+=j.bytesRead,H}function Y(b){return Se?Se.deflateRawSync(b):Fe(b)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(b){var V=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(V>>16|V>>8|V)&255}for(var de=typeof Uint8Array<"u",xe=de?new Uint8Array(256):[],Me=0;Me<256;++Me)xe[Me]=ee(Me);function G(b,V){var M=xe[b&255];return V<=8?M>>>8-V:(M=M<<8|xe[b>>8&255],V<=16?M>>>16-V:(M=M<<8|xe[b>>16&255],M>>>24-V))}function Ze(b,V){var M=V&7,j=V>>>3;return(b[j]|(M<=6?0:b[j+1]<<8))>>>M&3}function nt(b,V){var M=V&7,j=V>>>3;return(b[j]|(M<=5?0:b[j+1]<<8))>>>M&7}function Ke(b,V){var M=V&7,j=V>>>3;return(b[j]|(M<=4?0:b[j+1]<<8))>>>M&15}function qe(b,V){var M=V&7,j=V>>>3;return(b[j]|(M<=3?0:b[j+1]<<8))>>>M&31}function De(b,V){var M=V&7,j=V>>>3;return(b[j]|(M<=1?0:b[j+1]<<8))>>>M&127}function kt(b,V,M){var j=V&7,H=V>>>3,W=(1<<M)-1,ne=b[H]>>>j;return M<8-j||(ne|=b[H+1]<<8-j,M<16-j)||(ne|=b[H+2]<<16-j,M<24-j)||(ne|=b[H+3]<<24-j),ne&W}function Or(b,V,M){var j=V&7,H=V>>>3;return j<=5?b[H]|=(M&7)<<j:(b[H]|=M<<j&255,b[H+1]=(M&7)>>8-j),V+3}function me(b,V,M){var j=V&7,H=V>>>3;return M=(M&1)<<j,b[H]|=M,V+1}function pe(b,V,M){var j=V&7,H=V>>>3;return M<<=j,b[H]|=M&255,M>>>=8,b[H+1]=M,V+8}function Ce(b,V,M){var j=V&7,H=V>>>3;return M<<=j,b[H]|=M&255,M>>>=8,b[H+1]=M&255,b[H+2]=M>>>8,V+16}function Te(b,V){var M=b.length,j=2*M>V?2*M:V+5,H=0;if(M>=V)return b;if(wt){var W=Iy(j);if(b.copy)b.copy(W);else for(;H<b.length;++H)W[H]=b[H];return W}else if(de){var ne=new Uint8Array(j);if(ne.set)ne.set(b);else for(;H<M;++H)ne[H]=b[H];return ne}return b.length=j,b}function Ae(b){for(var V=new Array(b),M=0;M<b;++M)V[M]=0;return V}function be(b,V,M){var j=1,H=0,W=0,ne=0,ve=0,re=b.length,ae=de?new Uint16Array(32):Ae(32);for(W=0;W<32;++W)ae[W]=0;for(W=re;W<M;++W)b[W]=0;re=b.length;var oe=de?new Uint16Array(re):Ae(re);for(W=0;W<re;++W)ae[H=b[W]]++,j<H&&(j=H),oe[W]=0;for(ae[0]=0,W=1;W<=j;++W)ae[W+16]=ve=ve+ae[W-1]<<1;for(W=0;W<re;++W)ve=b[W],ve!=0&&(oe[W]=ae[ve+16]++);var Re=0;for(W=0;W<re;++W)if(Re=b[W],Re!=0)for(ve=G(oe[W],j)>>j-Re,ne=(1<<j+4-Re)-1;ne>=0;--ne)V[ve|ne<<Re]=Re&15|W<<4;return j}var Ge=de?new Uint16Array(512):Ae(512),ye=de?new Uint16Array(32):Ae(32);if(!de){for(var ie=0;ie<512;++ie)Ge[ie]=0;for(ie=0;ie<32;++ie)ye[ie]=0}(function(){for(var b=[],V=0;V<32;V++)b.push(5);be(b,ye,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);be(M,Ge,288)})();var Pe=function(){for(var V=de?new Uint8Array(32768):[],M=0,j=0;M<z.length-1;++M)for(;j<z[M+1];++j)V[j]=M;for(;j<32768;++j)V[j]=29;var H=de?new Uint8Array(259):[];for(M=0,j=0;M<ue.length-1;++M)for(;j<ue[M+1];++j)H[j]=M;function W(ve,re){for(var ae=0;ae<ve.length;){var oe=Math.min(65535,ve.length-ae),Re=ae+oe==ve.length;for(re.write_shift(1,+Re),re.write_shift(2,oe),re.write_shift(2,~oe&65535);oe-- >0;)re[re.l++]=ve[ae++]}return re.l}function ne(ve,re){for(var ae=0,oe=0,Re=de?new Uint16Array(32768):[];oe<ve.length;){var Be=Math.min(65535,ve.length-oe);if(Be<10){for(ae=Or(re,ae,+(oe+Be==ve.length)),ae&7&&(ae+=8-(ae&7)),re.l=ae/8|0,re.write_shift(2,Be),re.write_shift(2,~Be&65535);Be-- >0;)re[re.l++]=ve[oe++];ae=re.l*8;continue}ae=Or(re,ae,+(oe+Be==ve.length)+2);for(var He=0;Be-- >0;){var Oe=ve[oe];He=(He<<5^Oe)&32767;var je=-1,it=0;if((je=Re[He])&&(je|=oe&-32768,je>oe&&(je-=32768),je<oe))for(;ve[je+it]==ve[oe+it]&&it<250;)++it;if(it>2){Oe=H[it],Oe<=22?ae=pe(re,ae,xe[Oe+1]>>1)-1:(pe(re,ae,3),ae+=5,pe(re,ae,xe[Oe-23]>>5),ae+=3);var Lt=Oe<8?0:Oe-4>>2;Lt>0&&(Ce(re,ae,it-ue[Oe]),ae+=Lt),Oe=V[oe-je],ae=pe(re,ae,xe[Oe]>>3),ae-=3;var zt=Oe<4?0:Oe-2>>1;zt>0&&(Ce(re,ae,oe-je-z[Oe]),ae+=zt);for(var xr=0;xr<it;++xr)Re[He]=oe&32767,He=(He<<5^ve[oe])&32767,++oe;Be-=it-1}else Oe<=143?Oe=Oe+48:ae=me(re,ae,1),ae=pe(re,ae,xe[Oe]),Re[He]=oe&32767,++oe}ae=pe(re,ae,0)-1}return re.l=(ae+7)/8|0,re.l}return function(re,ae){return re.length<8?W(re,ae):ne(re,ae)}}();function Fe(b){var V=Pr(50+Math.floor(b.length*1.1)),M=Pe(b,V);return V.slice(0,M)}var ke=de?new Uint16Array(32768):Ae(32768),Qe=de?new Uint16Array(32768):Ae(32768),Je=de?new Uint16Array(128):Ae(128),dt=1,lt=1;function vt(b,V){var M=qe(b,V)+257;V+=5;var j=qe(b,V)+1;V+=5;var H=Ke(b,V)+4;V+=4;for(var W=0,ne=de?new Uint8Array(19):Ae(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ae=de?new Uint8Array(8):Ae(8),oe=de?new Uint8Array(8):Ae(8),Re=ne.length,Be=0;Be<H;++Be)ne[K[Be]]=W=nt(b,V),re<W&&(re=W),ae[W]++,V+=3;var He=0;for(ae[0]=0,Be=1;Be<=re;++Be)oe[Be]=He=He+ae[Be-1]<<1;for(Be=0;Be<Re;++Be)(He=ne[Be])!=0&&(ve[Be]=oe[He]++);var Oe=0;for(Be=0;Be<Re;++Be)if(Oe=ne[Be],Oe!=0){He=xe[ve[Be]]>>8-Oe;for(var je=(1<<7-Oe)-1;je>=0;--je)Je[He|je<<Oe]=Oe&7|Be<<3}var it=[];for(re=1;it.length<M+j;)switch(He=Je[De(b,V)],V+=He&7,He>>>=3){case 16:for(W=3+Ze(b,V),V+=2,He=it[it.length-1];W-- >0;)it.push(He);break;case 17:for(W=3+nt(b,V),V+=3;W-- >0;)it.push(0);break;case 18:for(W=11+De(b,V),V+=7;W-- >0;)it.push(0);break;default:it.push(He),re<He&&(re=He);break}var Lt=it.slice(0,M),zt=it.slice(M);for(Be=M;Be<286;++Be)Lt[Be]=0;for(Be=j;Be<30;++Be)zt[Be]=0;return dt=be(Lt,ke,286),lt=be(zt,Qe,30),V}function Ne(b,V){if(b[0]==3&&!(b[1]&3))return[Ds(V),2];for(var M=0,j=0,H=Iy(V||1<<18),W=0,ne=H.length>>>0,ve=0,re=0;!(j&1);){if(j=nt(b,M),M+=3,j>>>1)j>>1==1?(ve=9,re=5):(M=vt(b,M),ve=dt,re=lt);else{M&7&&(M+=8-(M&7));var ae=b[M>>>3]|b[(M>>>3)+1]<<8;if(M+=32,ae>0)for(!V&&ne<W+ae&&(H=Te(H,W+ae),ne=H.length);ae-- >0;)H[W++]=b[M>>>3],M+=8;continue}for(;;){!V&&ne<W+32767&&(H=Te(H,W+32767),ne=H.length);var oe=kt(b,M,ve),Re=j>>>1==1?Ge[oe]:ke[oe];if(M+=Re&15,Re>>>=4,!(Re>>>8&255))H[W++]=Re;else{if(Re==256)break;Re-=257;var Be=Re<8?0:Re-4>>2;Be>5&&(Be=0);var He=W+ue[Re];Be>0&&(He+=kt(b,M,Be),M+=Be),oe=kt(b,M,re),Re=j>>>1==1?ye[oe]:Qe[oe],M+=Re&15,Re>>>=4;var Oe=Re<4?0:Re-2>>1,je=z[Re];for(Oe>0&&(je+=kt(b,M,Oe),M+=Oe),!V&&ne<He&&(H=Te(H,He+100),ne=H.length);W<He;)H[W]=H[W-je],++W}}}return V?[H,M+7>>>3]:[H.slice(0,W),M+7>>>3]}function Ye(b,V){var M=b.slice(b.l||0),j=Ne(M,V);return b.l+=j[1],j[0]}function Ue(b,V){if(b)typeof console<"u"&&console.error(V);else throw new Error(V)}function at(b,V){var M=b;Qr(M,0);var j=[],H=[],W={FileIndex:j,FullPaths:H};N(W,{root:V.root});for(var ne=M.length-4;(M[ne]!=80||M[ne+1]!=75||M[ne+2]!=5||M[ne+3]!=6)&&ne>=0;)--ne;M.l=ne+4,M.l+=4;var ve=M.read_shift(2);M.l+=6;var re=M.read_shift(4);for(M.l=re,ne=0;ne<ve;++ne){M.l+=20;var ae=M.read_shift(4),oe=M.read_shift(4),Re=M.read_shift(2),Be=M.read_shift(2),He=M.read_shift(2);M.l+=8;var Oe=M.read_shift(4),je=o(M.slice(M.l+Re,M.l+Re+Be));M.l+=Re+Be+He;var it=M.l;M.l=Oe+4,At(M,ae,oe,W,je),M.l=it}return W}function At(b,V,M,j,H){b.l+=2;var W=b.read_shift(2),ne=b.read_shift(2),ve=s(b);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var re=b.read_shift(4),ae=b.read_shift(4),oe=b.read_shift(4),Re=b.read_shift(2),Be=b.read_shift(2),He="",Oe=0;Oe<Re;++Oe)He+=String.fromCharCode(b[b.l++]);if(Be){var je=o(b.slice(b.l,b.l+Be));(je[21589]||{}).mt&&(ve=je[21589].mt),((H||{})[21589]||{}).mt&&(ve=H[21589].mt)}b.l+=Be;var it=b.slice(b.l,b.l+ae);switch(ne){case 8:it=q(b,oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Lt=!1;W&8&&(re=b.read_shift(4),re==134695760&&(re=b.read_shift(4),Lt=!0),ae=b.read_shift(4),oe=b.read_shift(4)),ae!=V&&Ue(Lt,"Bad compressed size: "+V+" != "+ae),oe!=M&&Ue(Lt,"Bad uncompressed size: "+M+" != "+oe),hc(j,He,it,{unsafe:!0,mt:ve})}function Ot(b,V){var M=V||{},j=[],H=[],W=Pr(1),ne=M.compression?8:0,ve=0,re=0,ae=0,oe=0,Re=0,Be=b.FullPaths[0],He=Be,Oe=b.FileIndex[0],je=[],it=0;for(re=1;re<b.FullPaths.length;++re)if(He=b.FullPaths[re].slice(Be.length),Oe=b.FileIndex[re],!(!Oe.size||!Oe.content||He=="Sh33tJ5")){var Lt=oe,zt=Pr(He.length);for(ae=0;ae<He.length;++ae)zt.write_shift(1,He.charCodeAt(ae)&127);zt=zt.slice(0,zt.l),je[Re]=KC.buf(Oe.content,0);var xr=Oe.content;ne==8&&(xr=Y(xr)),W=Pr(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ve),W.write_shift(2,ne),Oe.mt?a(W,Oe.mt):W.write_shift(4,0),W.write_shift(-4,je[Re]),W.write_shift(4,xr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,zt.length),W.write_shift(2,0),oe+=W.length,j.push(W),oe+=zt.length,j.push(zt),oe+=xr.length,j.push(xr),W=Pr(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ve),W.write_shift(2,ne),W.write_shift(4,0),W.write_shift(-4,je[Re]),W.write_shift(4,xr.length),W.write_shift(4,Oe.content.length),W.write_shift(2,zt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Lt),it+=W.l,H.push(W),it+=zt.length,H.push(zt),++Re}return W=Pr(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Re),W.write_shift(2,Re),W.write_shift(4,it),W.write_shift(4,oe),W.write_shift(2,0),ms([ms(j),ms(H),W])}var Et={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ai(b,V){if(b.ctype)return b.ctype;var M=b.name||"",j=M.match(/\.([^\.]+)$/);return j&&Et[j[1]]||V&&(j=(M=V).match(/[\.\\]([^\.\\])+$/),j&&Et[j[1]])?Et[j[1]]:"application/octet-stream"}function Nn(b){for(var V=Ry(b),M=[],j=0;j<V.length;j+=76)M.push(V.slice(j,j+76));return M.join(`\r
`)+`\r
`}function Hn(b){var V=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var oe=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(oe.length==1?"0"+oe:oe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],j=V.split(`\r
`),H=0;H<j.length;++H){var W=j[H];if(W.length==0){M.push("");continue}for(var ne=0;ne<W.length;){var ve=76,re=W.slice(ne,ne+ve);re.charAt(ve-1)=="="?ve--:re.charAt(ve-2)=="="?ve-=2:re.charAt(ve-3)=="="&&(ve-=3),re=W.slice(ne,ne+ve),ne+=ve,ne<W.length&&(re+="="),M.push(re)}}return M.join(`\r
`)}function $r(b){for(var V=[],M=0;M<b.length;++M){for(var j=b[M];M<=b.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+b[++M];V.push(j)}for(var H=0;H<V.length;++H)V[H]=V[H].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Vi(V.join(`\r
`))}function Qt(b,V,M){for(var j="",H="",W="",ne,ve=0;ve<10;++ve){var re=V[ve];if(!re||re.match(/^\s*$/))break;var ae=re.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":j=ae[2].trim();break;case"content-type":W=ae[2].trim();break;case"content-transfer-encoding":H=ae[2].trim();break}}switch(++ve,H.toLowerCase()){case"base64":ne=Vi(ri(V.slice(ve).join("")));break;case"quoted-printable":ne=$r(V.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var oe=hc(b,j.slice(M.length),ne,{unsafe:!0});W&&(oe.ctype=W)}function Xs(b,V){if(X(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",j=(wt&&Buffer.isBuffer(b)?b.toString("binary"):X(b)).split(`\r
`),H=0,W="";for(H=0;H<j.length;++H)if(W=j[H],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),M||(M=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),W.slice(0,M.length)!=M););var ne=(j[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var ve="--"+(ne[1]||""),re=[],ae=[],oe={FileIndex:re,FullPaths:ae};N(oe);var Re,Be=0;for(H=0;H<j.length;++H){var He=j[H];He!==ve&&He!==ve+"--"||(Be++&&Qt(oe,j.slice(Re,H),M),Re=H)}return oe}function $o(b,V){var M=V||{},j=M.boundary||"SheetJS";j="------="+j;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],W=b.FullPaths[0],ne=W,ve=b.FileIndex[0],re=1;re<b.FullPaths.length;++re)if(ne=b.FullPaths[re].slice(W.length),ve=b.FileIndex[re],!(!ve.size||!ve.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var ae=ve.content,oe=wt&&Buffer.isBuffer(ae)?ae.toString("binary"):X(ae),Re=0,Be=Math.min(1024,oe.length),He=0,Oe=0;Oe<=Be;++Oe)(He=oe.charCodeAt(Oe))>=32&&He<128&&++Re;var je=Re>=Be*4/5;H.push(j),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ne),H.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),H.push("Content-Type: "+ai(ve,ne)),H.push(""),H.push(je?Hn(oe):Nn(oe))}return H.push(j+`--\r
`),H.join(`\r
`)}function f1(b){var V={};return N(V,b),V}function hc(b,V,M,j){var H=j&&j.unsafe;H||N(b);var W=!H&&Ct.find(b,V);if(!W){var ne=b.FullPaths[0];V.slice(0,ne.length)==ne?ne=V:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+V).replace("//","/")),W={name:i(V),type:2},b.FileIndex.push(W),b.FullPaths.push(ne),H||Ct.utils.cfb_gc(b)}return W.content=M,W.size=M?M.length:0,j&&(j.CLSID&&(W.clsid=j.CLSID),j.mt&&(W.mt=j.mt),j.ct&&(W.ct=j.ct)),W}function yu(b,V){N(b);var M=Ct.find(b,V);if(M){for(var j=0;j<b.FileIndex.length;++j)if(b.FileIndex[j]==M)return b.FileIndex.splice(j,1),b.FullPaths.splice(j,1),!0}return!1}function pc(b,V,M){N(b);var j=Ct.find(b,V);if(j){for(var H=0;H<b.FileIndex.length;++H)if(b.FileIndex[H]==j)return b.FileIndex[H].name=i(M),b.FullPaths[H]=M,!0}return!1}function d1(b){I(b,!0)}return t.find=U,t.read=P,t.parse=d,t.write=ce,t.writeFile=se,t.utils={cfb_new:f1,cfb_add:hc,cfb_del:yu,cfb_mov:pc,cfb_gc:d1,ReadShift:m0,CheckField:P8,prep_blob:Qr,bconcat:ms,use_zlib:L,_deflateRaw:Fe,_inflateRaw:Ye,consts:we},t}();function YC(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ga(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function G2(e){for(var t=[],r=ga(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var bd=new Date(1899,11,30,0,0,0);function An(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=bd.getTime()+(e.getTimezoneOffset()-bd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var s8=new Date,QC=bd.getTime()+(s8.getTimezoneOffset()-bd.getTimezoneOffset())*6e4,jy=s8.getTimezoneOffset();function gh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+QC),t.getTimezoneOffset()!==jy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-jy)*6e4),t}function qC(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var zy=new Date("2017-02-19T19:06:09.000Z"),o8=isNaN(zy.getFullYear())?new Date("2/19/17"):zy,JC=o8.getFullYear()==2017;function Wr(e,t){var r=new Date(e);if(JC)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(o8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ao(e,t){if(wt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return i0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return i0(X6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return i0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return i0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Jr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Jr(e[r]));return t}function cr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ki(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var ZC=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&ZC.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var e7=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function l8(e){return e?e.content&&e.type?Ao(e.content,!0):e.data?t0(e.data):e.asNodeBuffer&&wt?t0(e.asNodeBuffer().toString("binary")):e.asBinary?t0(e.asBinary()):e._data&&e._data.getContent?t0(Ao(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function c8(e){if(!e)return null;if(e.data)return Fy(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Fy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function t7(e){return e&&e.name.slice(-4)===".bin"?c8(e):l8(e)}function vi(e,t){for(var r=e.FullPaths||ga(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function H2(e,t){var r=vi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _r(e,t,r){if(!r)return t7(H2(e,t));if(!t)return null;try{return _r(e,t)}catch{return null}}function qn(e,t,r){if(!r)return l8(H2(e,t));if(!t)return null;try{return qn(e,t)}catch{return null}}function u8(e,t,r){if(!r)return c8(H2(e,t));if(!t)return null;try{return u8(e,t)}catch{return null}}function Vy(e){for(var t=e.FullPaths||ga(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function r7(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return wt?n=Ro(r):n=SC(r),Ct.utils.cfb_add(e,t,n)}Ct.utils.cfb_add(e,t,r)}else e.file(t,r)}function f8(e,t){switch(t.type){case"base64":return Ct.read(e,{type:"base64"});case"binary":return Ct.read(e,{type:"binary"});case"buffer":case"array":return Ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function n0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var d8=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,n7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,i7=/<[^>]*>/g,vn=d8.match(Gy)?Gy:i7,a7=/<\w*:/,s7=/<(\/?)\w+:/;function tt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(n7),o=0,u="",f=0,d="",p="",g=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(d=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(i=p.charCodeAt(a+1))==34||i==39?1:0,u=p.slice(a+1+g,p.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,r||(n[d.toLowerCase()]=u);else{var v=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[v]&&d.slice(o-3,o)=="ext")continue;n[v]=u,r||(n[v.toLowerCase()]=u)}}return n}function ma(e){return e.replace(s7,"<$1")}var h8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o7=G2(h8),Ft=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,u){return h8[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,u){return String.fromCharCode(parseInt(u,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),l7=/[&<>'"]/g,c7=/[\u0000-\u001f]/g;function W2(e){var t=e+"";return t.replace(l7,function(r){return o7[r]}).replace(/\n/g,"<br/>").replace(c7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Hy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jp(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Wy(e){var t=Ds(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function $y(e){return Ro(e,"binary").toString("utf8")}var Rf="foo bar baz",$t=wt&&($y(Rf)==Jp(Rf)&&$y||Wy(Rf)==Jp(Rf)&&Wy)||Jp,i0=wt?function(e){return Ro(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},X0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),p8=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),u7=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),f7=/<\/?(?:vt:)?variant>/g,d7=/<(?:vt:)([^>]*)>([\s\S]*)</;function Xy(e,t){var r=tt(e),n=e.match(u7(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(f7,"").match(d7);s&&i.push({v:$t(s[2]),t:s[1]})}),i}var h7=/(^\s|\s$|\n)/;function p7(e){return ga(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function g7(e,t,r){return"<"+e+(r!=null?p7(r):"")+(t!=null?(t.match(h7)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $2(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return $t(Io(j2(e)));throw new Error("Bad input format: expected Buffer or string")}var K0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,m7={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},x7=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function v7(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function y7(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Ky=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Yy=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ro(t)})):Ky(e)}:Ky,Qy=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Oa(e,i)));return n.join("").replace(Tn,"")},X2=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Tn,""):Qy(e,t,r)}:Qy,qy=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},g8=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qy(e,t,r)}:qy,Jy=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(hl(e,i)));return n.join("")},lu=wt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Jy(t,r,n)}:Jy,m8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},x8=m8,v8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},y8=v8,_8=function(e,t){var r=2*Qn(e,t);return r>0?lu(e,t+4,t+4+r-1):""},w8=_8,S8=function(t,r){var n=Qn(t,r);return n>0?X2(t,r+4,r+4+n):""},k8=S8,E8=function(e,t){var r=Qn(e,t);return r>0?lu(e,t+4,t+4+r):""},C8=E8,T8=function(e,t){return v7(e,t)},Od=T8,A8=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};wt&&(x8=function(t,r){if(!Buffer.isBuffer(t))return m8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},y8=function(t,r){if(!Buffer.isBuffer(t))return v8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},w8=function(t,r){if(!Buffer.isBuffer(t))return _8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},k8=function(t,r){if(!Buffer.isBuffer(t))return S8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},C8=function(t,r){if(!Buffer.isBuffer(t))return E8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Od=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):T8(t,r)},A8=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var hl=function(e,t){return e[t]},Oa=function(e,t){return e[t+1]*256+e[t]},_7=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},co=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},w7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function m0(e,t){var r="",n,i,a=[],s,o,u,f;switch(t){case"dbcs":if(f=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Oa(this,f)),f+=2;e*=2;break;case"utf8":r=lu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=X2(this,this.l,this.l+e);break;case"wstr":return m0.call(this,e,"dbcs");case"lpstr-ansi":r=x8(this,this.l),e=4+Qn(this,this.l);break;case"lpstr-cp":r=y8(this,this.l),e=4+Qn(this,this.l);break;case"lpwstr":r=w8(this,this.l),e=4+2*Qn(this,this.l);break;case"lpp4":e=4+Qn(this,this.l),r=k8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qn(this,this.l),r=C8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=hl(this,this.l+e++))!==0;)a.push(Nf(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=Oa(this,this.l+e))!==0;)a.push(Nf(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nf(Oa(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hl(this,f),this.l=f+1,o=m0.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Nf(hl(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=hl(this,this.l),this.l++,n;case 2:return n=(t==="i"?_7:Oa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?co:w7)(this,this.l),this.l+=4,n):(i=Qn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Od(this,this.l):i=Od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=g8(this,this.l,e);break}}return this.l+=e,r}var S7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},k7=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},E7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function C7(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)E7(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,S7(this,t,this.l);break;case 8:if(n=8,r==="f"){y7(this,t,this.l);break}case 16:break;case-4:n=4,k7(this,t,this.l);break}return this.l+=n,this}function P8(e,t){var r=g8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Qr(e,t){e.l=t,e.read_shift=m0,e.chk=P8,e.write_shift=C7}function xn(e,t){e.l+=t}function Pr(e){var t=Ds(e);return Qr(t,0),t}function Xa(e,t,r){if(e){var n,i,a;Qr(e,e.l||0);for(var s=e.length,o=0,u=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=zd[o]||zd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;u=e.l+a;var d=f.f&&f.f(e,a,r);if(e.l=u,t(d,f,o))return}}}function _m(){var e=[],t=wt?256:2048,r=function(f){var d=Pr(f);return Qr(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,t)))},s=function(){return i(),ms(e)},o=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function x0(e,t,r){var n=Jr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Zy(e,t,r){var n=Jr(e);return n.s=x0(n.s,t.s,r),n.e=x0(n.e,t.s,r),n}function v0(e,t){if(e.cRel&&e.c<0)for(e=Jr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ot(e);return!e.cRel&&e.cRel!=null&&(r=P7(r)),!e.rRel&&e.rRel!=null&&(r=T7(r)),r}function Zp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rr(e.s.c)+":"+(e.e.cRel?"":"$")+Rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zr(e.s.r)+":"+(e.e.rRel?"":"$")+Zr(e.e.r):v0(e.s,t.biff)+":"+v0(e.e,t.biff)}function K2(e){return parseInt(A7(e),10)-1}function Zr(e){return""+(e+1)}function T7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function A7(e){return e.replace(/\$(\d+)$/,"$1")}function Y2(e){for(var t=F7(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function P7(e){return e.replace(/^([A-Z])/,"$$$1")}function F7(e){return e.replace(/^\$([A-Z])/,"$1")}function N7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function En(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ot(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ic(e){var t=e.indexOf(":");return t==-1?{s:En(e),e:En(e)}:{s:En(e.slice(0,t)),e:En(e.slice(t+1))}}function Tt(e,t){return typeof t>"u"||typeof t=="number"?Tt(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof t!="string"&&(t=ot(t)),e==t?e:e+":"+t)}function fr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function e3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ti(e.z,r?An(t):t)}catch{}try{return e.w=Ti((e.XF||{}).numFmtId||(r?14:0),r?An(t):t)}catch{return""+t}}function Wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Oo[e.v]||e.v:t==null?e3(e,e.v):e3(e,t))}function Us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function F8(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?En(n.origin):n.origin;s=u.r,o=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=fr(a["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var v={v:t[p][g]},m=s+p,y=o+g;if(f.s.r>m&&(f.s.r=m),f.s.c>y&&(f.s.c=y),f.e.r<m&&(f.e.r=m),f.e.c<y&&(f.e.c=y),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))v=t[p][g];else if(Array.isArray(v.v)&&(v.f=t[p][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ft[14],n.cellDates?(v.t="d",v.w=Ti(v.z,An(v.v))):(v.t="n",v.v=An(v.v),v.w=Ti(v.z,v.v))):v.t="s";if(i)a[m]||(a[m]=[]),a[m][y]&&a[m][y].z&&(v.z=a[m][y].z),a[m][y]=v;else{var E=ot({c:y,r:m});a[E]&&a[E].z&&(v.z=a[E].z),a[E]=v}}}return f.s.c<1e7&&(a["!ref"]=Tt(f)),a}function ac(e,t){return F8(null,e,t)}function R7(e){return e.read_shift(4,"i")}function gn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function I7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Q2(e,t){var r=e.l,n=e.read_shift(1),i=gn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),u=0;u!=o;++u)a.push(I7(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var D7=Q2;function Ai(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Do(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var b7=gn;function q2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var O7=gn,wm=q2;function J2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Od([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):co(t,0)>>2;return r?i/100:i}function N8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var bo=N8;function hn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function L7(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var f=yo[i];f&&(t.rgb=Q0(f));break;case 2:t.rgb=Q0([s,o,u]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function M7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function R8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function B7(e){return R8(e,1)}function U7(e){return R8(e,2)}var Z2=2,Mn=3,If=11,t3=12,Ld=19,Df=64,j7=65,z7=71,V7=4108,G7=4126,Vr=80,I8=81,H7=[Vr,I8],W7={1:{n:"CodePage",t:Z2},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Mn},5:{n:"LineCount",t:Mn},6:{n:"ParagraphCount",t:Mn},7:{n:"SlideCount",t:Mn},8:{n:"NoteCount",t:Mn},9:{n:"HiddenCount",t:Mn},10:{n:"MultimediaClipCount",t:Mn},11:{n:"ScaleCrop",t:If},12:{n:"HeadingPairs",t:V7},13:{n:"TitlesOfParts",t:G7},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:If},17:{n:"CharacterCount",t:Mn},19:{n:"SharedDoc",t:If},22:{n:"HyperlinksChanged",t:If},23:{n:"AppVersion",t:Mn,p:"version"},24:{n:"DigSig",t:j7},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:Ld},2147483651:{n:"Behavior",t:Ld},1919054434:{}},$7={1:{n:"CodePage",t:Z2},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:Df},11:{n:"LastPrinted",t:Df},12:{n:"CreatedDate",t:Df},13:{n:"ModifiedDate",t:Df},14:{n:"PageCount",t:Mn},15:{n:"WordCount",t:Mn},16:{n:"CharCount",t:Mn},17:{n:"Thumbnail",t:z7},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Mn},255:{},2147483648:{n:"Locale",t:Ld},2147483651:{n:"Behavior",t:Ld},1919054434:{}},r3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},X7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function K7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Y7=K7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yo=Jr(Y7),Oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},n3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Q7(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function q7(e){var t=Q7();if(!e||!e.match)return t;var r={};if((e.match(vn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(a7,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[n3[i.ContentType]]!==void 0&&t[n3[i.ContentType]].push(i.PartName);break}}),t.xmlns!==m7.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Al={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function y0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(vn)||[]).forEach(function(i){var a=tt(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:n0(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}var J7="application/vnd.oasis.opendocument.spreadsheet";function Z7(e,t){for(var r=$2(e),n,i;n=K0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==J7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var _0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],eT=function(){for(var e=new Array(_0.length),t=0;t<_0.length;++t){var r=_0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function b8(e){var t={};e=$t(e);for(var r=0;r<_0.length;++r){var n=_0[r],i=e.match(eT[r]);i!=null&&i.length>0&&(t[n[1]]=Ft(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Wr(t[n[1]]))}return t}var tT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function O8(e,t,r,n){var i=[];if(typeof e=="string")i=Xy(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(d){return{v:d}}));var s=typeof t=="string"?Xy(t,n).map(function(d){return d.v}):t,o=0,u=0;if(s.length>0)for(var f=0;f!==i.length;f+=2){switch(u=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=s.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=s.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=s.slice(o,o+u);break}o+=u}}function rT(e,t,r){var n={};return t||(t={}),e=$t(e),tT.forEach(function(i){var a=(e.match(X0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Ft(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&O8(n.HeadingPairs,n.TitlesOfParts,t,r),t}var nT=/<[^>]+>[^<]*/g;function iT(e,t){var r={},n="",i=e.match(nT);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=tt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ft(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var u=s.split(">"),f=u[0].slice(4),d=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Ft(d);break;case"bool":r[n]=Zt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Wr(d);break;case"cy":case"error":r[n]=Ft(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,u)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var aT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eg;function sT(e,t,r){eg||(eg=G2(aT)),t=eg[t]||t,e[t]=r}function ex(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function L8(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function M8(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function B8(e,t,r){return t===31?M8(e):L8(e,t,r)}function km(e,t,r){return B8(e,t,r===!1?0:4)}function oT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return B8(e,t,0)}function lT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Tn,""),e.l-i&2&&(e.l+=2)}return r}function cT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Tn,"");return r}function uT(e){var t=e.l,r=Md(e,I8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Md(e,Mn);return[r,n]}function fT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(uT(e));return r}function i3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Tn,"").replace(r0,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function U8(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function dT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Md(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==t3&&n!==t&&H7.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===t3?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return L8(e,n,4).replace(Tn,"");case 31:return M8(e);case 64:return ex(e);case 65:return U8(e);case 71:return dT(e);case 80:return km(e,n,!a.raw).replace(Tn,"");case 81:return oT(e,n).replace(Tn,"");case 4108:return fT(e);case 4126:case 4127:return n==4127?lT(e):cT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function a3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,u=-1,f={};for(s=0;s!=i;++s){var d=e.read_shift(4),p=e.read_shift(4);a[s]=[d,p+r]}a.sort(function(w,x){return w[1]-x[1]});var g={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var v=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],v=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(v=!1,e.l=a[s][1]),v)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[a[s][0]];if(g[m.n]=Md(e,m.t,{raw:!0}),m.p==="version"&&(g[m.n]=String(g[m.n]>>16)+"."+("0000"+String(g[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(g[m.n]){case 0:g[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gi(o=g[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[m.n])}}else if(a[s][0]===1){if(o=g.CodePage=Md(e,Z2),Gi(o),u!==-1){var y=e.l;e.l=a[u][1],f=i3(e,o),e.l=y}}else if(a[s][0]===0){if(o===0){u=s,e.l=a[s+1][1];continue}f=i3(e,o)}else{var E=f[a[s][0]],k;switch(e[e.l]){case 65:e.l+=4,k=U8(e);break;case 30:e.l+=4,k=km(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=km(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=pr(e,4);break;case 64:e.l+=4,k=Wr(ex(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[E]=k}}return e.l=r+n,g}function s3(e,t,r){var n=e.content;if(!n)return{};Qr(n,0);var i,a,s,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),d=n.read_shift(16);if(d!==Ct.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),u=n.read_shift(4));var p=a3(n,t),g={SystemIdentifier:f};for(var v in p)g[v]=p[v];if(g.FMTID=a,i===1)return g;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var m;try{m=a3(n,null)}catch{}for(v in m)g[v]=m[v];return g.FMTID=[a,s],g}function ls(e,t){return e.read_shift(t),null}function hT(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function pr(e,t){return e.read_shift(t)===1}function wr(e){return e.read_shift(2,"u")}function j8(e,t){return hT(e,t,wr)}function pT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function cu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function gT(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,u={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*s),n&&(e.l+=o),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Po(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function uu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Po(e,n,r)}function Lo(e,t,r){if(r.biff>5)return uu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mT(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function xT(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Tn,"");return n&&(e.l+=24),i}function vT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Tn,"");return r+s}function yT(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xT(e);case"0303000000000000c000000000000046":return vT(e);default:throw new Error("Unsupported Moniker "+r)}}function bf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Tn,""):"";return r}function _T(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,u,f="",d,p;i&16&&(a=bf(e,r-e.l)),i&128&&(s=bf(e,r-e.l)),(i&257)===257&&(o=bf(e,r-e.l)),(i&257)===1&&(u=yT(e,r-e.l)),i&8&&(f=bf(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(p=ex(e)),e.l=r;var g=s||o||u||"";g&&f&&(g+="#"+f),g||(g="#"+f),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return d&&(v.guid=d),p&&(v.time=p),a&&(v.Tooltip=a),v}function z8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function V8(e,t){var r=z8(e);return r[3]=0,r}function xa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function wT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ST(e,t,r){return t===0?"":Lo(e,t,r)}function kT(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function G8(e){var t=e.read_shift(2),r=J2(e);return[t,r]}function ET(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=cu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function mh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function H8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var CT=H8;function W8(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function TT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function AT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function un(e){e.l+=2,e.l+=e.read_shift(2)}var PT={0:un,4:un,5:un,6:un,7:AT,8:un,9:un,10:un,11:un,12:un,13:TT,14:un,15:un,16:un,17:un,18:un,19:un,20:un,21:W8};function FT(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(PT[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Of(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function NT(e,t){return t===0||e.read_shift(2),1200}function RT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Lo(e,0,r);return e.read_shift(t+n-e.l),i}function IT(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function DT(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=cu(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function bT(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(gT(e));return a.Count=n,a.Unique=i,a}function OT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function LT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function MT(e){var t=wT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function BT(e){return e.read_shift(2),e.read_shift(4)}function o3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function UT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:u,TabRatio:f}}function jT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zT(){}function VT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=cu(e,0,r),n}function GT(e){var t=xa(e);return t.isst=e.read_shift(4),t}function HT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=xa(e);r.biff==2&&e.l++;var a=uu(e,n-e.l,r);return i.val=a,i}function WT(e,t,r){var n=e.read_shift(2),i=Lo(e,0,r);return[n,i]}var $T=Lo;function l3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:u}}}function XT(e){var t=e.read_shift(2),r=e.read_shift(2),n=G8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(G8(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function YT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function QT(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(2);return i.patternType=X7[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function qT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=QT(e,t,n.fStyle,r),n}function JT(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function c3(e,t,r){var n=xa(e);(r.biff==2||t==9)&&++e.l;var i=pT(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function ZT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xa(e),i=hn(e);return n.val=i,n}var u3=ST;function eA(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=Po(e,a),o=[];n>e.l;)o.push(uu(e));return[a,i,s,o]}function f3(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=ET(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var tA=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function d3(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Po(e,s,r);i&32&&(f=tA[f.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var p=n==e.l||o===0||!(d>0)?[]:LN(e,d,r,o);return{chKey:a,Name:f,itab:u,rgce:p}}function $8(e,t,r){if(r.biff<8)return rA(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(kT(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function rA(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=cu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function nA(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Po(e,n,r),s=Po(e,i,r);return[a,s]}function iA(e,t,r){var n=H8(e);e.l++;var i=e.read_shift(1);return t-=8,[MN(e,t,r),i,n]}function h3(e,t,r){var n=CT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,bN(e,t,r)]}function aA(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function sA(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=Lo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function oA(e,t,r){return sA(e,t,r)}function lA(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(mh(e));return r}function cA(e,t,r){if(r&&r.biff<8)return fA(e,t,r);var n=W8(e),i=FT(e,t-22,n[1]);return{cmo:n,ft:i}}var uA={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function fA(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((uA[n]||xn)(e,t,r)),{cmo:[i,n,a],ft:s}}function dA(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=mT(e,6,r);var o=e.read_shift(2);e.read_shift(2),wr(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var d=e[e.l],p=Po(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function hA(e,t){var r=mh(e);e.l+=16;var n=_T(e,t-24);return[r,n]}function pA(e,t){e.read_shift(2);var r=mh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Tn,""),[r,n]}function gA(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=r3[r]||r,r=e.read_shift(2),t[1]=r3[r]||r,t}function mA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(V8(e));return r}function xA(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(V8(e));return r}function vA(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function X8(e,t,r){if(!r.cellStyles)return xn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:i,e:a,w:s,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function yA(e,t){var r={};return t<32||(e.l+=16,r.header=hn(e),r.footer=hn(e),e.l+=2),r}function _A(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var wA=xa,SA=j8,kA=uu;function EA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function CA(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xa(e);++e.l;var i=Lo(e,t-7,r);return n.t="str",n.val=i,n}function TA(e){var t=xa(e);++e.l;var r=hn(e);return t.t="n",t.val=r,t}function AA(e){var t=xa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function PA(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function FA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function NA(e,t,r){var n=e.l+t,i=xa(e),a=e.read_shift(2),s=Po(e,a,r);return e.l=n,i.t="str",i.val=s,i}var RA=[2,3,48,49,131,139,140,245],p3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=G2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var f=[],d=Ds(1);switch(u.type){case"base64":d=Vi(ri(o));break;case"binary":d=Vi(o);break;case"buffer":case"array":d=o;break}Qr(d,0);var p=d.read_shift(1),g=!!(p&136),v=!1,m=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,E=521;p==2&&(y=d.read_shift(2)),d.l+=3,p!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(E=d.read_shift(2));var k=d.read_shift(2),w=u.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var x=[],C={},A=Math.min(d.length,p==2?521:E-10-(v?264:0)),P=m?32:11;d.l<A&&d[d.l]!=13;)switch(C={},C.name=gs.utils.decode(w,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,C.type=String.fromCharCode(d.read_shift(1)),p!=2&&!m&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),p==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&x.push(C),p!=2&&(d.l+=m?13:14),C.type){case"B":(!v||C.len!=8)&&u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var N=0,F=0;for(f[0]=[],F=0;F!=x.length;++F)f[0][F]=x[F].name;for(;y-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,f[++N]=[],F=0,F=0;F!=x.length;++F){var I=d.slice(d.l,d.l+x[F].len);d.l+=x[F].len,Qr(I,0);var D=gs.utils.decode(w,I);switch(x[F].type){case"C":D.trim().length&&(f[N][F]=D.replace(/\s+$/,""));break;case"D":D.length===8?f[N][F]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):f[N][F]=D;break;case"F":f[N][F]=parseFloat(D.trim());break;case"+":case"I":f[N][F]=m?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":f[N][F]=!0;break;case"N":case"F":f[N][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][F]="##MEMO##"+(m?parseInt(D.trim(),10):I.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(f[N][F]=+D||0);break;case"@":f[N][F]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[N][F]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[N][F]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][F]=-I.read_shift(-8,"f");break;case"B":if(v&&x[F].len==8){f[N][F]=I.read_shift(8,"f");break}case"G":case"P":I.l+=x[F].len;break;case"0":if(x[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[F].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=x,f}function n(o,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=ac(r(o,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(o,u){try{return Us(n(o,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,u){var f=u||{};if(+f.codepage>=0&&Gi(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=_m(),p=Nm(o,{header:1,raw:!0,cellDates:!0}),g=p[0],v=p.slice(1),m=o["!cols"]||[],y=0,E=0,k=0,w=1;for(y=0;y<g.length;++y){if(((m[y]||{}).DBF||{}).name){g[y]=m[y].DBF.name,++k;continue}if(g[y]!=null){if(++k,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(E=0;E<1024;++E)if(g.indexOf(g[y]+"_"+E)==-1){g[y]+="_"+E;break}}}}var x=fr(o["!ref"]),C=[],A=[],P=[];for(y=0;y<=x.e.c-x.s.c;++y){var N="",F="",I=0,D=[];for(E=0;E<v.length;++E)v[E][y]!=null&&D.push(v[E][y]);if(D.length==0||g[y]==null){C[y]="?";continue}for(E=0;E<D.length;++E){switch(typeof D[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=D[E]instanceof Date?"D":"C";break;default:F="C"}I=Math.max(I,String(D[E]).length),N=N&&N!=F?"C":F}I>250&&(I=250),F=((m[y]||{}).DBF||{}).type,F=="C"&&m[y].DBF.len>I&&(I=m[y].DBF.len),N=="B"&&F=="N"&&(N="N",P[y]=m[y].DBF.dec,I=m[y].DBF.len),A[y]=N=="C"||F=="N"?I:a[N]||0,w+=A[y],C[y]=N}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,v.length),U.write_shift(2,296+32*k),U.write_shift(2,w),y=0;y<4;++y)U.write_shift(4,0);for(U.write_shift(4,0|(+t[W6]||3)<<8),y=0,E=0;y<g.length;++y)if(g[y]!=null){var O=d.next(32),Q=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,Q,"sbcs"),O.write_shift(1,C[y]=="?"?"C":C[y],"sbcs"),O.write_shift(4,E),O.write_shift(1,A[y]||a[C[y]]||0),O.write_shift(1,P[y]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),E+=A[y]||a[C[y]]||0}var he=d.next(264);for(he.write_shift(4,13),y=0;y<65;++y)he.write_shift(4,0);for(y=0;y<v.length;++y){var te=d.next(w);for(te.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(C[E]){case"L":te.write_shift(1,v[y][E]==null?63:v[y][E]?84:70);break;case"B":te.write_shift(8,v[y][E]||0,"f");break;case"N":var Ee="0";for(typeof v[y][E]=="number"&&(Ee=v[y][E].toFixed(P[E]||0)),k=0;k<A[E]-Ee.length;++k)te.write_shift(1,32);te.write_shift(1,Ee,"sbcs");break;case"D":v[y][E]?(te.write_shift(4,("0000"+v[y][E].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(v[y][E].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+v[y][E].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var we=String(v[y][E]!=null?v[y][E]:"").slice(0,A[E]);for(te.write_shift(1,we,"sbcs"),k=0;k<A[E]-we.length;++k)te.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),IA=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ga(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,v){var m=e[v];return typeof m=="number"?Ny(m):m},n=function(g,v,m){var y=v.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return y==59?g:Ny(y)};e["|"]=254;function i(g,v){switch(v.type){case"base64":return a(ri(g),v);case"binary":return a(g,v);case"buffer":return a(wt&&Buffer.isBuffer(g)?g.toString("binary"):Io(g),v);case"array":return a(Ao(g),v)}throw new Error("Unrecognized type "+v.type)}function a(g,v){var m=g.split(/[\n\r]+/),y=-1,E=-1,k=0,w=0,x=[],C=[],A=null,P={},N=[],F=[],I=[],D=0,U;for(+v.codepage>=0&&Gi(+v.codepage);k!==m.length;++k){D=0;var O=m[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=O.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),he=Q[0],te;if(O.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&C.push(O.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,we=!1,se=!1,X=!1,ce=-1,Se=-1;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"A":break;case"X":E=parseInt(Q[w].slice(1))-1,we=!0;break;case"Y":for(y=parseInt(Q[w].slice(1))-1,we||(E=0),U=x.length;U<=y;++U)x[U]=[];break;case"K":te=Q[w].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(Ki(te))?isNaN(Kl(te).getDate())||(te=Wr(te)):(te=Ki(te),A!==null&&nc(A)&&(te=gh(te))),Ee=!0;break;case"E":X=!0;var L=Ol(Q[w].slice(1),{r:y,c:E});x[y][E]=[x[y][E],L];break;case"S":se=!0,x[y][E]=[x[y][E],"S5S"];break;case"G":break;case"R":ce=parseInt(Q[w].slice(1))-1;break;case"C":Se=parseInt(Q[w].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+O)}if(Ee&&(x[y][E]&&x[y][E].length==2?x[y][E][0]=te:x[y][E]=te,A=null),se){if(X)throw new Error("SYLK shared formula cannot have own formula");var q=ce>-1&&x[ce][Se];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");x[y][E][1]=nw(q[1],{r:y-ce,c:E-Se})}break;case"F":var Y=0;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"X":E=parseInt(Q[w].slice(1))-1,++Y;break;case"Y":for(y=parseInt(Q[w].slice(1))-1,U=x.length;U<=y;++U)x[U]=[];break;case"M":D=parseInt(Q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=C[parseInt(Q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=Q[w].slice(1).split(" "),U=parseInt(I[0],10);U<=parseInt(I[1],10);++U)D=parseInt(I[2],10),F[U-1]=D===0?{hidden:!0}:{wch:D},Yl(F[U-1]);break;case"C":E=parseInt(Q[w].slice(1))-1,F[E]||(F[E]={});break;case"R":y=parseInt(Q[w].slice(1))-1,N[y]||(N[y]={}),D>0?(N[y].hpt=D,N[y].hpx=q0(D)):D===0&&(N[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+O)}Y<1&&(A=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+O)}}return N.length>0&&(P["!rows"]=N),F.length>0&&(P["!cols"]=F),v&&v.sheetRows&&(x=x.slice(0,v.sheetRows)),[x,P]}function s(g,v){var m=i(g,v),y=m[0],E=m[1],k=ac(y,v);return ga(E).forEach(function(w){k[w]=E[w]}),k}function o(g,v){return Us(s(g,v),v)}function u(g,v,m,y){var E="C;Y"+(m+1)+";X"+(y+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+vF(g.f,{r:m,c:y}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(g,v){v.forEach(function(m,y){var E="F;W"+(y+1)+" "+(y+1)+" ";m.hidden?E+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ud(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=jd(m.wpx)),typeof m.wch=="number"&&(E+=Math.round(m.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function d(g,v){v.forEach(function(m,y){var E="F;";m.hidden?E+="M0;":m.hpt?E+="M"+20*m.hpt+";":m.hpx&&(E+="M"+20*ew(m.hpx)+";"),E.length>2&&g.push(E+"R"+(y+1))})}function p(g,v){var m=["ID;PWXL;N;E"],y=[],E=fr(g["!ref"]),k,w=Array.isArray(g),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),g["!cols"]&&f(m,g["!cols"]),g["!rows"]&&d(m,g["!rows"]),m.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var C=E.s.r;C<=E.e.r;++C)for(var A=E.s.c;A<=E.e.c;++A){var P=ot({r:C,c:A});k=w?(g[C]||[])[A]:g[P],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,g,C,A))}return m.join(x)+x+y.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),DA=function(){function e(a,s){switch(s.type){case"base64":return t(ri(a),s);case"binary":return t(a,s);case"buffer":return t(wt&&Buffer.isBuffer(a)?a.toString("binary"):Io(a),s);case"array":return t(Ao(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),u=-1,f=-1,d=0,p=[];d!==o.length;++d){if(o[d].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var g=o[d].trim().split(","),v=g[0],m=g[1];++d;for(var y=o[d]||"";(y.match(/["]/g)||[]).length&1&&d<o.length-1;)y+=`
`+o[++d];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[u][f]=!0:y==="FALSE"?p[u][f]=!1:isNaN(Ki(m))?isNaN(Kl(m).getDate())?p[u][f]=m:p[u][f]=Wr(m):p[u][f]=Ki(m),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(a,s){return ac(e(a,s),s)}function n(a,s){return Us(r(a,s),s)}var i=function(){var a=function(u,f,d,p,g){u.push(f),u.push(d+","+p),u.push('"'+g.replace(/"/g,'""')+'"')},s=function(u,f,d,p){u.push(f+","+d),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],d=fr(u["!ref"]),p,g=Array.isArray(u);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,d.e.r-d.s.r+1,""),a(f,"TUPLES",0,d.e.c-d.s.c+1,""),a(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){s(f,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var y=ot({r:v,c:m});if(p=g?(u[v]||[])[m]:u[y],!p){s(f,1,0,"");continue}switch(p.t){case"n":var E=p.w;!E&&p.v!=null&&(E=p.v),E==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,E,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ti(p.z||ft[14],An(Wr(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var k=`\r
`,w=f.join(k);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),bA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var v=p.split(`
`),m=-1,y=-1,E=0,k=[];E!==v.length;++E){var w=v[E].trim().split(":");if(w[0]==="cell"){var x=En(w[1]);if(k.length<=x.r)for(m=k.length;m<=x.r;++m)k[m]||(k[m]=[]);switch(m=x.r,y=x.c,w[2]){case"t":k[m][y]=e(w[3]);break;case"v":k[m][y]=+w[3];break;case"vtf":var C=w[w.length-1];case"vtc":switch(w[3]){case"nl":k[m][y]=!!+w[4];break;default:k[m][y]=+w[4];break}w[2]=="vtf"&&(k[m][y]=[k[m][y],C])}}}return g&&g.sheetRows&&(k=k.slice(0,g.sheetRows)),k}function n(p,g){return ac(r(p,g),g)}function i(p,g){return Us(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],m,y="",E=ic(p["!ref"]),k=Array.isArray(p),w=E.s.r;w<=E.e.r;++w)for(var x=E.s.c;x<=E.e.c;++x)if(y=ot({r:w,c:x}),m=k?(p[w]||[])[x]:p[y],!(!m||m.v==null||m.t==="z")){switch(v=["cell",y,"t"],m.t){case"s":case"str":v.push(t(m.v));break;case"n":m.f?(v[2]="vtf",v[3]="n",v[4]=m.v,v[5]=t(m.f)):(v[2]="v",v[3]=m.v);break;case"b":v[2]="vt"+(m.f?"f":"c"),v[3]="nl",v[4]=m.v?"1":"0",v[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var C=An(Wr(m.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=m.w||Ti(m.z||ft[14],C);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(p){return[a,s,o,s,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Y0=function(){function e(d,p,g,v,m){m.raw?p[g][v]=d:d===""||(d==="TRUE"?p[g][v]=!0:d==="FALSE"?p[g][v]=!1:isNaN(Ki(d))?isNaN(Kl(d).getDate())?p[g][v]=d:p[g][v]=Wr(d):p[g][v]=Ki(d))}function t(d,p){var g=p||{},v=[];if(!d||d.length===0)return v;for(var m=d.split(/[\r\n]/),y=m.length-1;y>=0&&m[y].length===0;)--y;for(var E=10,k=0,w=0;w<=y;++w)k=m[w].indexOf(" "),k==-1?k=m[w].length:k++,E=Math.max(E,k);for(w=0;w<=y;++w){v[w]=[];var x=0;for(e(m[w].slice(0,E).trim(),v,w,x,g),x=1;x<=(m[w].length-E)/10+1;++x)e(m[w].slice(E+(x-1)*10,E+x*10).trim(),v,w,x,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var p={},g=!1,v=0,m=0;v<d.length;++v)(m=d.charCodeAt(v))==34?g=!g:!g&&m in r&&(p[m]=(p[m]||0)+1);m=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v]);if(!m.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v])}return m.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[m.pop()[1]]||44}function a(d,p){var g=p||{},v="",m=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):g&&g.FS?v=g.FS:v=i(d.slice(0,1024));var E=0,k=0,w=0,x=0,C=0,A=v.charCodeAt(0),P=!1,N=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=g.dateNF!=null?$C(g.dateNF):null;function D(){var U=d.slice(x,C),O={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)O.t="z";else if(g.raw)O.t="s",O.v=U;else if(U.trim().length===0)O.t="s",O.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(O.t="s",O.v=U.slice(2,-1).replace(/""/g,'"')):_F(U)?(O.t="n",O.f=U.slice(1)):(O.t="s",O.v=U);else if(U=="TRUE")O.t="b",O.v=!0;else if(U=="FALSE")O.t="b",O.v=!1;else if(!isNaN(w=Ki(U)))O.t="n",g.cellText!==!1&&(O.w=U),O.v=w;else if(!isNaN(Kl(U).getDate())||I&&U.match(I)){O.z=g.dateNF||ft[14];var Q=0;I&&U.match(I)&&(U=XC(U,g.dateNF,U.match(I)||[]),Q=1),g.cellDates?(O.t="d",O.v=Wr(U,Q)):(O.t="n",O.v=An(Wr(U,Q))),g.cellText!==!1&&(O.w=Ti(O.z,O.v instanceof Date?An(O.v):O.v)),g.cellNF||delete O.z}else O.t="s",O.v=U;if(O.t=="z"||(g.dense?(m[E]||(m[E]=[]),m[E][k]=O):m[ot({c:k,r:E})]=O),x=C+1,F=d.charCodeAt(x),y.e.c<k&&(y.e.c=k),y.e.r<E&&(y.e.r=E),N==A)++k;else if(k=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;C<d.length;++C)switch(N=d.charCodeAt(C)){case 34:F===34&&(P=!P);break;case A:case 10:case 13:if(!P&&D())break e;break}return C-x>0&&D(),m["!ref"]=Tt(y),m}function s(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,p):ac(t(d,p),p)}function o(d,p){var g="",v=p.type=="string"?[0,0,0,0]:lx(d,p);switch(p.type){case"base64":g=ri(d);break;case"binary":g=d;break;case"buffer":p.codepage==65001?g=d.toString("utf8"):p.codepage&&typeof gs<"u"?g=gs.utils.decode(p.codepage,d):g=wt&&Buffer.isBuffer(d)?d.toString("binary"):Io(d);break;case"array":g=Ao(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=$t(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=$t(g):p.type=="binary"&&typeof gs<"u"&&p.codepage&&(g=gs.utils.decode(p.codepage,gs.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?bA.to_sheet(p.type=="string"?g:$t(g),p):s(g,p)}function u(d,p){return Us(o(d,p),p)}function f(d){for(var p=[],g=fr(d["!ref"]),v,m=Array.isArray(d),y=g.s.r;y<=g.e.r;++y){for(var E=[],k=g.s.c;k<=g.e.c;++k){var w=ot({r:y,c:k});if(v=m?(d[y]||[])[k]:d[w],!v||v.v==null){E.push("          ");continue}for(var x=(v.w||(Wa(v),v.w)||"").slice(0,10);x.length<10;)x+=" ";E.push(x+(k===0?" ":""))}p.push(E.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:f}}();function OA(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=IA.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Y0.to_workbook(e,t)}}var w0=function(){function e(L,q,Y){if(L){Qr(L,L.l||0);for(var K=Y.Enum||ce;L.l<L.length;){var ue=L.read_shift(2),z=K[ue]||K[65535],ee=L.read_shift(2),de=L.l+ee,xe=z.f&&z.f(L,ee,Y);if(L.l=de,q(xe,z,ue))return}}}function t(L,q){switch(q.type){case"base64":return r(Vi(ri(L)),q);case"binary":return r(Vi(L),q);case"buffer":case"array":return r(L,q)}throw"Unsupported type "+q.type}function r(L,q){if(!L)return L;var Y=q||{},K=Y.dense?[]:{},ue="Sheet1",z="",ee=0,de={},xe=[],Me=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ze=Y.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)Y.Enum=ce,e(L,function(De,kt,Or){switch(Or){case 0:Y.vers=De,De>=4096&&(Y.qpro=!0);break;case 6:G=De;break;case 204:De&&(z=De);break;case 222:z=De;break;case 15:case 51:Y.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Or==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=Y.dateNF||ft[14],Y.cellDates&&(De[1].t="d",De[1].v=gh(De[1].v))),Y.qpro&&De[3]>ee&&(K["!ref"]=Tt(G),de[ue]=K,xe.push(ue),K=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ee=De[3],ue=z||"Sheet"+(ee+1),z="");var me=Y.dense?(K[De[0].r]||[])[De[0].c]:K[ot(De[0])];if(me){me.t=De[1].t,me.v=De[1].v,De[1].z!=null&&(me.z=De[1].z),De[1].f!=null&&(me.f=De[1].f);break}Y.dense?(K[De[0].r]||(K[De[0].r]=[]),K[De[0].r][De[0].c]=De[1]):K[ot(De[0])]=De[1];break}},Y);else if(L[2]==26||L[2]==14)Y.Enum=Se,L[2]==14&&(Y.qpro=!0,L.l=0),e(L,function(De,kt,Or){switch(Or){case 204:ue=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>ee&&(K["!ref"]=Tt(G),de[ue]=K,xe.push(ue),K=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ee=De[3],ue="Sheet"+(ee+1)),Ze>0&&De[0].r>=Ze)break;Y.dense?(K[De[0].r]||(K[De[0].r]=[]),K[De[0].r][De[0].c]=De[1]):K[ot(De[0])]=De[1],G.e.c<De[0].c&&(G.e.c=De[0].c),G.e.r<De[0].r&&(G.e.r=De[0].r);break;case 27:De[14e3]&&(Me[De[14e3][0]]=De[14e3][1]);break;case 1537:Me[De[0]]=De[1],De[0]==ee&&(ue=De[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(K["!ref"]=Tt(G),de[z||ue]=K,xe.push(z||ue),!Me.length)return{SheetNames:xe,Sheets:de};for(var nt={},Ke=[],qe=0;qe<Me.length;++qe)de[xe[qe]]?(Ke.push(Me[qe]||xe[qe]),nt[Me[qe]]=de[Me[qe]]||de[xe[qe]]):(Ke.push(Me[qe]),nt[Me[qe]]={"!ref":"A1"});return{SheetNames:Ke,Sheets:nt}}function n(L,q){var Y=q||{};if(+Y.codepage>=0&&Gi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var K=_m(),ue=fr(L["!ref"]),z=Array.isArray(L),ee=[];Mi(K,0,a(1030)),Mi(K,6,u(ue));for(var de=Math.min(ue.e.r,8191),xe=ue.s.r;xe<=de;++xe)for(var Me=Zr(xe),G=ue.s.c;G<=ue.e.c;++G){xe===ue.s.r&&(ee[G]=Rr(G));var Ze=ee[G]+Me,nt=z?(L[xe]||[])[G]:L[Ze];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?Mi(K,13,v(xe,G,nt.v)):Mi(K,14,y(xe,G,nt.v));else{var Ke=Wa(nt);Mi(K,15,p(xe,G,Ke.slice(0,239)))}}return Mi(K,1),K.end()}function i(L,q){var Y=q||{};if(+Y.codepage>=0&&Gi(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var K=_m();Mi(K,0,s(L));for(var ue=0,z=0;ue<L.SheetNames.length;++ue)(L.Sheets[L.SheetNames[ue]]||{})["!ref"]&&Mi(K,27,X(L.SheetNames[ue],z++));var ee=0;for(ue=0;ue<L.SheetNames.length;++ue){var de=L.Sheets[L.SheetNames[ue]];if(!(!de||!de["!ref"])){for(var xe=fr(de["!ref"]),Me=Array.isArray(de),G=[],Ze=Math.min(xe.e.r,8191),nt=xe.s.r;nt<=Ze;++nt)for(var Ke=Zr(nt),qe=xe.s.c;qe<=xe.e.c;++qe){nt===xe.s.r&&(G[qe]=Rr(qe));var De=G[qe]+Ke,kt=Me?(de[nt]||[])[qe]:de[De];if(!(!kt||kt.t=="z"))if(kt.t=="n")Mi(K,23,D(nt,qe,ee,kt.v));else{var Or=Wa(kt);Mi(K,22,N(nt,qe,ee,Or.slice(0,239)))}}++ee}}return Mi(K,1),K.end()}function a(L){var q=Pr(2);return q.write_shift(2,L),q}function s(L){var q=Pr(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var Y=0,K=0,ue=0,z=0;z<L.SheetNames.length;++z){var ee=L.SheetNames[z],de=L.Sheets[ee];if(!(!de||!de["!ref"])){++ue;var xe=ic(de["!ref"]);Y<xe.e.r&&(Y=xe.e.r),K<xe.e.c&&(K=xe.e.c)}}return Y>8191&&(Y=8191),q.write_shift(2,Y),q.write_shift(1,ue),q.write_shift(1,K),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(L,q,Y){var K={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&Y.qpro?(K.s.c=L.read_shift(1),L.l++,K.s.r=L.read_shift(2),K.e.c=L.read_shift(1),L.l++,K.e.r=L.read_shift(2),K):(K.s.c=L.read_shift(2),K.s.r=L.read_shift(2),q==12&&Y.qpro&&(L.l+=2),K.e.c=L.read_shift(2),K.e.r=L.read_shift(2),q==12&&Y.qpro&&(L.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function u(L){var q=Pr(8);return q.write_shift(2,L.s.c),q.write_shift(2,L.s.r),q.write_shift(2,L.e.c),q.write_shift(2,L.e.r),q}function f(L,q,Y){var K=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(K[0].c=L.read_shift(1),K[3]=L.read_shift(1),K[0].r=L.read_shift(2),L.l+=2):(K[2]=L.read_shift(1),K[0].c=L.read_shift(2),K[0].r=L.read_shift(2)),K}function d(L,q,Y){var K=L.l+q,ue=f(L,q,Y);if(ue[1].t="s",Y.vers==20768){L.l++;var z=L.read_shift(1);return ue[1].v=L.read_shift(z,"utf8"),ue}return Y.qpro&&L.l++,ue[1].v=L.read_shift(K-L.l,"cstr"),ue}function p(L,q,Y){var K=Pr(7+Y.length);K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(1,39);for(var ue=0;ue<K.length;++ue){var z=Y.charCodeAt(ue);K.write_shift(1,z>=128?95:z)}return K.write_shift(1,0),K}function g(L,q,Y){var K=f(L,q,Y);return K[1].v=L.read_shift(2,"i"),K}function v(L,q,Y){var K=Pr(7);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(2,Y,"i"),K}function m(L,q,Y){var K=f(L,q,Y);return K[1].v=L.read_shift(8,"f"),K}function y(L,q,Y){var K=Pr(13);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,L),K.write_shift(8,Y,"f"),K}function E(L,q,Y){var K=L.l+q,ue=f(L,q,Y);if(ue[1].v=L.read_shift(8,"f"),Y.qpro)L.l=K;else{var z=L.read_shift(2);C(L.slice(L.l,L.l+z),ue),L.l+=z}return ue}function k(L,q,Y){var K=q&32768;return q&=-32769,q=(K?L:0)+(q>=8192?q-16384:q),(K?"":"$")+(Y?Rr(q):Zr(q))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(L,q){Qr(L,0);for(var Y=[],K=0,ue="",z="",ee="",de="";L.l<L.length;){var xe=L[L.l++];switch(xe){case 0:Y.push(L.read_shift(8,"f"));break;case 1:z=k(q[0].c,L.read_shift(2),!0),ue=k(q[0].r,L.read_shift(2),!1),Y.push(z+ue);break;case 2:{var Me=k(q[0].c,L.read_shift(2),!0),G=k(q[0].r,L.read_shift(2),!1);z=k(q[0].c,L.read_shift(2),!0),ue=k(q[0].r,L.read_shift(2),!1),Y.push(Me+G+":"+z+ue)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(L.read_shift(2));break;case 6:{for(var Ze="";xe=L[L.l++];)Ze+=String.fromCharCode(xe);Y.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:de=Y.pop(),ee=Y.pop(),Y.push(["AND","OR"][xe-20]+"("+ee+","+de+")");break;default:if(xe<32&&x[xe])de=Y.pop(),ee=Y.pop(),Y.push(ee+x[xe]+de);else if(w[xe]){if(K=w[xe][1],K==69&&(K=L[L.l++]),K>Y.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+Y.join("|")+"|");return}var nt=Y.slice(-K);Y.length-=K,Y.push(w[xe][0]+"("+nt.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}Y.length==1?q[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function A(L){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=L.read_shift(2),q[3]=L[L.l++],q[0].c=L[L.l++],q}function P(L,q){var Y=A(L);return Y[1].t="s",Y[1].v=L.read_shift(q-4,"cstr"),Y}function N(L,q,Y,K){var ue=Pr(6+K.length);ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,q),ue.write_shift(1,39);for(var z=0;z<K.length;++z){var ee=K.charCodeAt(z);ue.write_shift(1,ee>=128?95:ee)}return ue.write_shift(1,0),ue}function F(L,q){var Y=A(L);Y[1].v=L.read_shift(2);var K=Y[1].v>>1;if(Y[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return Y[1].v=K,Y}function I(L,q){var Y=A(L),K=L.read_shift(4),ue=L.read_shift(4),z=L.read_shift(2);if(z==65535)return K===0&&ue===3221225472?(Y[1].t="e",Y[1].v=15):K===0&&ue===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ee=z&32768;return z=(z&32767)-16446,Y[1].v=(1-ee*2)*(ue*Math.pow(2,z+32)+K*Math.pow(2,z)),Y}function D(L,q,Y,K){var ue=Pr(14);if(ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,q),K==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var z=0,ee=0,de=0,xe=0;return K<0&&(z=1,K=-K),ee=Math.log2(K)|0,K/=Math.pow(2,ee-31),xe=K>>>0,xe&2147483648||(K/=2,++ee,xe=K>>>0),K-=xe,xe|=2147483648,xe>>>=0,K*=Math.pow(2,32),de=K>>>0,ue.write_shift(4,de),ue.write_shift(4,xe),ee+=16383+(z?32768:0),ue.write_shift(2,ee),ue}function U(L,q){var Y=I(L);return L.l+=q-14,Y}function O(L,q){var Y=A(L),K=L.read_shift(4);return Y[1].v=K>>6,Y}function Q(L,q){var Y=A(L),K=L.read_shift(8,"f");return Y[1].v=K,Y}function he(L,q){var Y=Q(L);return L.l+=q-10,Y}function te(L,q){return L[L.l+q-1]==0?L.read_shift(q,"cstr"):""}function Ee(L,q){var Y=L[L.l++];Y>q-1&&(Y=q-1);for(var K="";K.length<Y;)K+=String.fromCharCode(L[L.l++]);return K}function we(L,q,Y){if(!(!Y.qpro||q<21)){var K=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ue=L.read_shift(q-21,"cstr");return[K,ue]}}function se(L,q){for(var Y={},K=L.l+q;L.l<K;){var ue=L.read_shift(2);if(ue==14e3){for(Y[ue]=[0,""],Y[ue][0]=L.read_shift(2);L[L.l];)Y[ue][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return Y}function X(L,q){var Y=Pr(5+L.length);Y.write_shift(2,14e3),Y.write_shift(2,q);for(var K=0;K<L.length;++K){var ue=L.charCodeAt(K);Y[Y.l++]=ue>127?95:ue}return Y[Y.l++]=0,Y}var ce={0:{n:"BOF",f:wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function LA(e){var t={},r=e.match(vn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=B2[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var MA=function(){var e=X0("t"),t=X0("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Ft(s[1])},u=a.match(t);return u&&(o.s=LA(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),BA=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),s.push("</"+u+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),UA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jA=/<(?:\w+:)?r>/,zA=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ft($t(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$t(e),r&&(n.h=W2(n.t))):e.match(jA)&&(n.r=$t(e),n.t=Ft($t((e.replace(zA,"").match(UA)||[]).join("").replace(vn,""))),r&&(n.h=BA(MA(n.r)))),n):{t:""}}var VA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GA=/<(?:\w+:)?(?:si|sstItem)>/g,HA=/<\/(?:\w+:)?(?:si|sstItem)>/;function WA(e,t){var r=[],n="";if(!e)return r;var i=e.match(VA);if(i){n=i[2].replace(GA,"").split(HA);for(var a=0;a!=n.length;++a){var s=tx(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=tt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function $A(e){return[e.read_shift(4),e.read_shift(4)]}function XA(e,t){var r=[],n=!1;return Xa(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function K8(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ba(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function KA(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function YA(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function QA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YA(e));return t}function qA(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function JA(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function ZA(e){var t=JA(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Y8(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Q8(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function eP(e){var t=Ba(e);switch(t.Minor){case 2:return[t.Minor,tP(e)];case 3:return[t.Minor,rP()];case 4:return[t.Minor,nP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function tP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Y8(e,r),i=Q8(e,e.length-e.l);return{t:"Std",h:n,v:i}}function rP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function nP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(vn,function(a){var s=tt(a);switch(ma(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function iP(e,t){var r={},n=r.EncryptionVersionInfo=Ba(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Y8(e,i),t-=i,r.EncryptionVerifier=Q8(e,t),r}function aP(e){var t={},r=t.EncryptionVersionInfo=Ba(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function sP(e){var t=0,r,n=K8(e),i=n.length+1,a,s,o,u,f;for(r=Ds(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,u=t<<1&32767,f=o|u,t=f^s;return t^52811}var q8=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],u=104,f=s.length-1;f>=0;--f)for(var d=s[f],p=0;p!=7;++p)d&64&&(o^=r[u]),d*=2,--u;return o};return function(s){for(var o=K8(s),u=a(o),f=o.length,d=Ds(16),p=0;p!=16;++p)d[p]=0;var g,v,m;for((f&1)===1&&(g=u>>8,d[f]=i(e[0],g),--f,g=u&255,v=o[o.length-1],d[f]=i(v,g));f>0;)--f,g=u>>8,d[f]=i(o[f],g),--f,g=u&255,d[f]=i(o[f],g);for(f=15,m=15-o.length;m>0;)g=u>>8,d[f]=i(e[m],g),--f,--m,g=u&255,d[f]=i(o[f],g),--f,--m;return d}}(),oP=function(e,t,r,n,i){i||(i=t),n||(n=q8(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},lP=function(e){var t=0,r=q8(e);return function(n){var i=oP("",n,t,r);return t=i[1],i[0]}};function cP(e,t,r,n){var i={key:wr(e),verificationBytes:wr(e)};return r.password&&(i.verifier=sP(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=lP(r.password)),i}function uP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=aP(e):n.Data=iP(e,t),n}function fP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?uP(e,t-2,n):cP(e,r.biff>=8?t:t-2,r,n),n}var dP=function(){function e(i,a){switch(a.type){case"base64":return t(ri(i),a);case"binary":return t(i,a);case"buffer":return t(wt&&Buffer.isBuffer(i)?i.toString("binary"):Io(i),a);case"array":return t(Ao(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,v=0,m,y=-1;m=g.exec(d);){switch(m[0]){case"\\cell":var E=d.slice(v,g.lastIndex-m[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var k={v:E,t:"s"};Array.isArray(o)?o[p][y]=k:o[ot({r:p,c:y})]=k}break}v=g.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=Tt(f),o}function r(i,a){return Us(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=fr(i["!ref"]),o,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){a.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var p=ot({r:f,c:d});o=u?(i[f]||[])[d]:i[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Wa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function hP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Q0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function pP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,u=0,f=i+a;switch(u=s/(f>1?2-f:f),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,u,f/2]}function gP(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,s[0]+=i,s[1]+=u;break;case 1:u=i*(2-o),s[0]+=u,s[1]+=i;break;case 2:u=i*(o-2),s[1]+=i,s[2]+=u;break;case 3:u=i*(4-o),s[1]+=u,s[2]+=i;break;case 4:u=i*(o-4),s[2]+=i,s[0]+=u;break;case 5:u=i*(6-o),s[2]+=u,s[0]+=i;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Bd(e,t){if(t===0)return e;var r=pP(hP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Q0(gP(r))}var J8=6,mP=15,xP=1,kn=J8;function Ud(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function jd(e){return Math.floor((e-5)/kn*100+.5)/100}function Em(e){return Math.round((e*kn+5)/kn*256)/256}function tg(e){return Em(jd(Ud(e)))}function rx(e){var t=Math.abs(e-tg(e)),r=kn;if(t>.005)for(kn=xP;kn<mP;++kn)Math.abs(e-tg(e))<=t&&(t=Math.abs(e-tg(e)),r=kn);kn=r}function Yl(e){e.width?(e.wpx=Ud(e.width),e.wch=jd(e.wpx),e.MDW=kn):e.wpx?(e.wch=jd(e.wpx),e.width=Em(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=Em(e.wch),e.wpx=Ud(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var vP=96,Z8=vP;function ew(e){return e*96/Z8}function q0(e){return e*Z8/96}var yP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _P(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(ma(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function wP(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(ma(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function SP(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(vn)||[]).forEach(function(s){var o=tt(s);switch(ma(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=$t(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Zt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Zt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Zt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Zt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Zt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Zt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=B2[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Zt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=yo[i.color.index];i.color.index==81&&(u=yo[1]),u||(u=yo[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Bd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kP(e,t,r){t.NumberFmt=[];for(var n=ga(ft),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ft[n[i]];var a=e[0].match(vn);if(a)for(i=0;i<a.length;++i){var s=tt(a[i]);switch(ma(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ft($t(s.formatCode)),u=parseInt(s.numFmtId,10);if(t.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=o}vo(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Lf=["numFmtId","fillId","fontId","borderId","xfId"],Mf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function EP(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(vn)||[]).forEach(function(a){var s=tt(a),o=0;switch(ma(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<Lf.length;++o)n[Lf[o]]&&(n[Lf[o]]=parseInt(n[Lf[o]],10));for(o=0;o<Mf.length;++o)n[Mf[o]]&&(n[Mf[o]]=Zt(n[Mf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};s.vertical&&(u.vertical=s.vertical),s.horizontal&&(u.horizontal=s.horizontal),s.textRotation!=null&&(u.textRotation=s.textRotation),s.indent&&(u.indent=s.indent),s.wrapText&&(u.wrapText=Zt(s.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var CP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,f){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&kP(p,d,f),(p=o.match(i))&&SP(p,d,u,f),(p=o.match(n))&&wP(p,d,u,f),(p=o.match(a))&&_P(p,d,u,f),(p=o.match(r))&&EP(p,d,f),d}}();function TP(e,t){var r=e.read_shift(2),n=gn(e);return[r,n]}function AP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=M7(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=L7(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gn(e),n}var PP=xn;function FP(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var NP=xn;function RP(e,t,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return Xa(e,function(u,f,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],vo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=Bd(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(d),s=!0;break;case 38:a.pop(),s=!1;break;default:if(f.T>0)a.push(d);else if(f.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var IP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(vn)||[]).forEach(function(i){var a=tt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[IP.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function bP(){}function OP(){}var LP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UP(e,t,r){t.themeElements={};var n;[["clrScheme",LP,DP],["fontScheme",MP,bP],["fmtScheme",BP,OP]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var jP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function tw(e,t){(!e||e.length===0)&&(e=zP());var r,n={};if(!(r=e.match(jP)))throw new Error("themeElements not found in theme");return UP(r[0],n,t),n.raw=e,n}function zP(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[d8];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function VP(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=f8(a,{type:"array"})}catch{return}var o=qn(s,"theme/theme/theme1.xml",!0);if(o)return tw(o,r)}}function GP(e){return e.read_shift(4)}function HP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=WP(e,4);break;case 2:t.xclrValue=z8(e);break;case 3:t.xclrValue=GP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function WP(e,t){return xn(e,t)}function $P(e,t){return xn(e,t)}function XP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=HP(e);break;case 6:n[1]=$P(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function KP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(XP(e,r-e.l));return{ixfe:n,ext:a}}function YP(e,t){t.forEach(function(r){switch(r[0]){}})}function QP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:gn(e)}}function qP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JP(e){return e.l+=4,e.read_shift(4)!=0}function ZP(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return Xa(e,function(u,f,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:a.push(d),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!f.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function eF(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(vn,function(o){var u=tt(o);switch(ma(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function tF(e){var t=[];if(!e)return t;var r=1;return(e.match(vn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function rF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ot(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function nF(e,t,r){var n=[];return Xa(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function iF(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Xa(e,function(o,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function aF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function g3(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=En(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var u=fr(e["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var f=Tt(u);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(d.a==n[p].id){d.a=n[p].name||d.a;break}}a.c.push(d)})}function sF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=tt(o[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=En(u.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&tx(p[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function oF(e,t){var r=[],n=!1,i={},a=0;return e.replace(vn,function(o,u){var f=tt(o);switch(ma(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+o.length;break;case"</text>":i.t=e.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function lF(e,t){var r=[],n=!1;return e.replace(vn,function(a){var s=tt(a);switch(ma(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function cF(e){var t={};t.iauthor=e.read_shift(4);var r=bo(e);return t.rfx=r.s,t.ref=ot(r.s),e.l+=16,t}var uF=gn;function fF(e,t){var r=[],n=[],i={},a=!1;return Xa(e,function(o,u,f){switch(f){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var dF="application/vnd.ms-office.vbaProject";function hF(e){var t=Ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ct.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Ct.write(t)}function pF(){return{"!type":"dialog"}}function gF(){return{"!type":"dialog"}}function mF(){return{"!type":"macro"}}function xF(){return{"!type":"macro"}}var Ol=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,u?f+=t.r:--f,i+(o?"":"$")+Rr(d)+(u?"":"$")+Zr(f)}return function(i,a){return t=a,i.replace(e,r)}}(),rw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vF=function(){return function(t,r){return t.replace(rw,function(n,i,a,s,o,u){var f=Y2(s)-(a?0:r.c),d=K2(u)-(o?0:r.r),p=d==0?"":o?d+1:"["+d+"]",g=f==0?"":a?f+1:"["+f+"]";return i+"R"+p+"C"+g})}}();function nw(e,t){return e.replace(rw,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Rr(Y2(a)+t.c))+(s=="$"?s+o:Zr(K2(o)+t.r))})}function yF(e,t,r){var n=ic(t),i=n.s,a=En(r),s={r:a.r-i.r,c:a.c-i.c};return nw(e,s)}function _F(e){return e.length!=1}function m3(e){return e.replace(/_xlfn\./g,"")}function yr(e){e.l+=1}function bs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function iw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return aw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=bs(e,2),o=bs(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function aw(e){var t=bs(e,2),r=bs(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function wF(e,t,r){if(r.biff<8)return aw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=bs(e,2),s=bs(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function sw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SF(e);var n=e.read_shift(r&&r.biff==12?4:2),i=bs(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function SF(e){var t=bs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function EF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return CF(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function CF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function TF(e,t,r){var n=(e[e.l++]&96)>>5,i=iw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=iw(e,a,r);return[n,i,s]}function PF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FF(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function NF(e,t,r){var n=(e[e.l++]&96)>>5,i=wF(e,t-1,r);return[n,i]}function RF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function x3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function IF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function DF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function LF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function ow(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MF(e){return e.read_shift(2),ow(e)}function BF(e){return e.read_shift(2),ow(e)}function UF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=sw(e,0,r);return[n,i]}function jF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=EF(e,0,r);return[n,i]}function zF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=sw(e,0,r);return[n,i,a]}function VF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[GN[i],uw[i],n]}function GF(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:HF(e);return[i,(a[0]===0?uw:VN)[a[1]]]}function HF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WF(e,t,r){e.l+=r&&r.biff==2?3:4}function $F(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function XF(e){return e.l++,Oo[e.read_shift(1)]}function KF(e){return e.l++,e.read_shift(2)}function YF(e){return e.l++,e.read_shift(1)!==0}function QF(e){return e.l++,hn(e)}function qF(e,t,r){return e.l++,cu(e,t-1,r)}function JF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=pr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Oo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=hn(e);break;case 2:r[1]=Lo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ZF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?bo:mh)(e));return i}function eN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=JF(e,r.biff);return s}function tN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function rN(e,t,r){if(r.biff==5)return nN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function nN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function iN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aN(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function sN(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function oN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var lN=xn,cN=xn,uN=xn;function fu(e,t,r){return e.l+=2,[kF(e)]}function nx(e){return e.l+=6,[]}var fN=fu,dN=nx,hN=nx,pN=fu;function lw(e){return e.l+=2,[wr(e),e.read_shift(2)&1]}var gN=fu,mN=lw,xN=nx,vN=fu,yN=fu,_N=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=_N[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function SN(e){return e.l+=2,[e.read_shift(4)]}function kN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function EN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AN(e){return e.l+=4,[0,0]}var v3={1:{n:"PtgExp",f:$F},2:{n:"PtgTbl",f:uN},3:{n:"PtgAdd",f:yr},4:{n:"PtgSub",f:yr},5:{n:"PtgMul",f:yr},6:{n:"PtgDiv",f:yr},7:{n:"PtgPower",f:yr},8:{n:"PtgConcat",f:yr},9:{n:"PtgLt",f:yr},10:{n:"PtgLe",f:yr},11:{n:"PtgEq",f:yr},12:{n:"PtgGe",f:yr},13:{n:"PtgGt",f:yr},14:{n:"PtgNe",f:yr},15:{n:"PtgIsect",f:yr},16:{n:"PtgUnion",f:yr},17:{n:"PtgRange",f:yr},18:{n:"PtgUplus",f:yr},19:{n:"PtgUminus",f:yr},20:{n:"PtgPercent",f:yr},21:{n:"PtgParen",f:yr},22:{n:"PtgMissArg",f:yr},23:{n:"PtgStr",f:qF},26:{n:"PtgSheet",f:kN},27:{n:"PtgEndSheet",f:EN},28:{n:"PtgErr",f:XF},29:{n:"PtgBool",f:YF},30:{n:"PtgInt",f:KF},31:{n:"PtgNum",f:QF},32:{n:"PtgArray",f:RF},33:{n:"PtgFunc",f:VF},34:{n:"PtgFuncVar",f:GF},35:{n:"PtgName",f:tN},36:{n:"PtgRef",f:UF},37:{n:"PtgArea",f:TF},38:{n:"PtgMemArea",f:iN},39:{n:"PtgMemErr",f:lN},40:{n:"PtgMemNoMem",f:cN},41:{n:"PtgMemFunc",f:aN},42:{n:"PtgRefErr",f:sN},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:jF},45:{n:"PtgAreaN",f:NF},46:{n:"PtgMemAreaN",f:CN},47:{n:"PtgMemNoMemN",f:TN},57:{n:"PtgNameX",f:rN},58:{n:"PtgRef3d",f:zF},59:{n:"PtgArea3d",f:AF},60:{n:"PtgRefErr3d",f:oN},61:{n:"PtgAreaErr3d",f:FF},255:{}},PN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FN={1:{n:"PtgElfLel",f:lw},2:{n:"PtgElfRw",f:vN},3:{n:"PtgElfCol",f:fN},6:{n:"PtgElfRwV",f:yN},7:{n:"PtgElfColV",f:pN},10:{n:"PtgElfRadical",f:gN},11:{n:"PtgElfRadicalS",f:xN},13:{n:"PtgElfColS",f:dN},15:{n:"PtgElfColSV",f:hN},16:{n:"PtgElfRadicalLel",f:mN},25:{n:"PtgList",f:wN},29:{n:"PtgSxName",f:SN},255:{}},NN={0:{n:"PtgAttrNoop",f:AN},1:{n:"PtgAttrSemi",f:LF},2:{n:"PtgAttrIf",f:bF},4:{n:"PtgAttrChoose",f:IF},8:{n:"PtgAttrGoto",f:DF},16:{n:"PtgAttrSum",f:WF},32:{n:"PtgAttrBaxcel",f:x3},33:{n:"PtgAttrBaxcel",f:x3},64:{n:"PtgAttrSpace",f:MF},65:{n:"PtgAttrSpaceSemi",f:BF},128:{n:"PtgAttrIfError",f:OF},255:{}};function du(e,t,r,n){if(n.biff<8)return xn(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=eN(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ZF(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(xn(e,t)),a}function hu(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=v3[a]||v3[PN[a]],(a===24||a===25)&&(i=(a===24?FN:NN)[e[e.l+1]]),!i||!i.f?xn(e,t):s.push([i.n,i.f(e,t,r)]);return s}function RN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var IN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function cw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y3(e,t,r){var n=cw(e,t,r);return n=="#REF"?n:DN(n,r)}function fn(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],u,f,d,p=0,g=0,v,m="";if(!e[0]||!e[0][0])return"";for(var y=-1,E="",k=0,w=e[0].length;k<w;++k){var x=e[0][k];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),f=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:E=cr(" ",e[0][y][1][1]);break;case 1:E=cr("\r",e[0][y][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+E,y=-1}o.push(f+IN[x[0]]+u);break;case"PtgIsect":u=o.pop(),f=o.pop(),o.push(f+" "+u);break;case"PtgUnion":u=o.pop(),f=o.pop(),o.push(f+","+u);break;case"PtgRange":u=o.pop(),f=o.pop(),o.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=x0(x[1][1],s,i),o.push(v0(d,a));break;case"PtgRefN":d=r?x0(x[1][1],r,i):x[1][1],o.push(v0(d,a));break;case"PtgRef3d":p=x[1][1],d=x0(x[1][2],s,i),m=y3(n,p,i),o.push(m+"!"+v0(d,a));break;case"PtgFunc":case"PtgFuncVar":var C=x[1][0],A=x[1][1];C||(C=0),C&=127;var P=C==0?[]:o.slice(-C);o.length-=C,A==="User"&&(A=P.shift()),o.push(A+"("+P.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":v=Zy(x[1][1],r?{s:r}:s,i),o.push(Zp(v,i));break;case"PtgArea":v=Zy(x[1][1],s,i),o.push(Zp(v,i));break;case"PtgArea3d":p=x[1][1],v=x[1][2],m=y3(n,p,i),o.push(m+"!"+Zp(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=x[1][2];var N=(n.names||[])[g-1]||(n[0]||[])[g],F=N?N.Name:"SH33TJSNAME"+String(g);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var I=x[1][1];g=x[1][2];var D;if(i.biff<=5)I<0&&(I=-I),n[I]&&(D=n[I][g]);else{var U="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][g]&&n[I][g].itab>0&&(U=n.SheetNames[n[I][g].itab-1]+"!"):U=n.SheetNames[g-1]+"!"),n[I]&&n[I][g])U+=n[I][g].Name;else if(n[0]&&n[0][g])U+=n[0][g].Name;else{var O=(cw(n,I,i)||"").split(";;");O[g-1]?U=O[g-1]:U+="SH33TJSERRX"}o.push(U);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var Q="(",he=")";if(y>=0){switch(E="",e[0][y][1][0]){case 2:Q=cr(" ",e[0][y][1][1])+Q;break;case 3:Q=cr("\r",e[0][y][1][1])+Q;break;case 4:he=cr(" ",e[0][y][1][1])+he;break;case 5:he=cr("\r",e[0][y][1][1])+he;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(Q+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var Ee=n.sharedf[ot(d)];o.push(fn(Ee,s,te,n,i))}else{var we=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){o.push(fn(f[1],s,te,n,i)),we=!0;break}we||o.push(x[1])}break;case"PtgArray":o.push("{"+RN(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&se.indexOf(e[0][k][0])==-1){x=e[0][y];var X=!0;switch(x[1][0]){case 4:X=!1;case 0:E=cr(" ",x[1][1]);break;case 5:X=!1;case 1:E=cr("\r",x[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((X?E:"")+o.pop()+(X?"":E)),y=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function bN(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],xn(e,t-2)];var o=hu(e,s,r);return t!==s+i&&(a=du(e,t-s-i,o,r)),e.l=n,[o,a]}function ON(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],xn(e,t-2)];var o=hu(e,s,r);return t!==s+i&&(a=du(e,t-s-i,o,r)),e.l=n,[o,a]}function LN(e,t,r,n){var i=e.l+t,a=hu(e,n,r),s;return i!==e.l&&(s=du(e,i-e.l,a,r)),[a,s]}function MN(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=hu(e,a,r);return a==65535?[[],xn(e,t-2)]:(t!==a+2&&(i=du(e,n-a-2,s,r)),[s,i])}function BN(e){var t;if(Oa(e,e.l+6)!==65535)return[hn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function rg(e,t,r){var n=e.l+t,i=xa(e);r.biff==2&&++e.l;var a=BN(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=ON(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function xh(e,t,r){var n=e.read_shift(4),i=hu(e,n,r),a=e.read_shift(4),s=a>0?du(e,a,i,r):null;return[i,s]}var UN=xh,vh=xh,jN=xh,zN=xh,VN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},uw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ng(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var S0={},Ll={};function k0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function fw(e,t,r,n,i,a){try{n.cellNF&&(e.z=ft[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ft[t]==null&&vo(WC[t]||"General",t),e.t==="e")e.w=e.w||Oo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v);else if(e.t==="d"){var s=An(e.v);(s|0)===s?e.w=s.toString(10):e.w=$0(s)}else{if(e.v===void 0)return"";e.w=To(e.v,Ll)}else e.t==="d"?e.w=Ti(t,An(e.v),Ll):e.w=Ti(t,e.v,Ll)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Bd(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Bd(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function HN(e,t){var r=fr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Tt(r))}var WN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,$N=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XN=/<(?:\w:)?hyperlink [^>]*>/mg,KN=/"(\w*:\w*)"/,YN=/<(?:\w:)?col\b[^>]*[\/]?>/g,QN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qN=/<(?:\w:)?pageMargins[^>]*\/>/g,dw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,JN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function eR(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",p=e.match($N);p?(f=e.slice(0,p.index),d=e.slice(p.index+p[0].length)):f=d=e;var g=f.match(dw);g?ix(g[0],o,i,r):(g=f.match(JN))&&tR(g[0],g[1]||"",o,i,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var m=f.slice(v,v+50).match(KN);m&&HN(o,m[1])}var y=f.match(ZN);y&&y[1]&&oR(y[1],i);var E=[];if(t.cellStyles){var k=f.match(YN);k&&iR(E,k)}p&&lR(p[1],o,t,u,a,s);var w=d.match(QN);w&&(o["!autofilter"]=aR(w[0]));var x=[],C=d.match(WN);if(C)for(v=0;v!=C.length;++v)x[v]=fr(C[v].slice(C[v].indexOf('"')+1));var A=d.match(XN);A&&rR(o,A,n);var P=d.match(qN);if(P&&(o["!margins"]=nR(tt(P[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=Tt(u)),t.sheetRows>0&&o["!ref"]){var N=fr(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>u.e.r&&(N.e.r=u.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>u.e.c&&(N.e.c=u.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Tt(N))}return E.length>0&&(o["!cols"]=E),x.length>0&&(o["!merges"]=x),o}function ix(e,t,r,n){var i=tt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ft($t(i.codeName)))}function tR(e,t,r,n,i){ix(e.slice(0,e.indexOf(">")),r,n,i)}function rR(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=tt($t(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Ft(a.location))):(a.Target="#"+Ft(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=fr(a.ref),u=o.s.r;u<=o.e.r;++u)for(var f=o.s.c;f<=o.e.c;++f){var d=ot({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function nR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function iR(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=tt(t[n],!0);i.hidden&&(i.hidden=Zt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,rx(i.width)),Yl(i);a<=s;)e[a++]=Jr(i)}}function aR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var sR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oR(e,t){t.Views||(t.Views=[{}]),(e.match(sR)||[]).forEach(function(r,n){var i=tt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Zt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var lR=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=X0("v"),s=X0("f");return function(u,f,d,p,g,v){for(var m=0,y="",E=[],k=[],w=0,x=0,C=0,A="",P,N,F=0,I=0,D,U,O=0,Q=0,he=Array.isArray(v.CellXf),te,Ee=[],we=[],se=Array.isArray(f),X=[],ce={},Se=!1,L=!!d.sheetStubs,q=u.split(t),Y=0,K=q.length;Y!=K;++Y){y=q[Y].trim();var ue=y.length;if(ue!==0){var z=0;e:for(m=0;m<ue;++m)switch(y[m]){case">":if(y[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(N=tt(y.slice(z,m),!0),F=N.r!=null?parseInt(N.r,10):F+1,I=-1,d.sheetRows&&d.sheetRows<F)continue;ce={},Se=!1,N.ht&&(Se=!0,ce.hpt=parseFloat(N.ht),ce.hpx=q0(ce.hpt)),N.hidden=="1"&&(Se=!0,ce.hidden=!0),N.outlineLevel!=null&&(Se=!0,ce.level=+N.outlineLevel),Se&&(X[F-1]=ce)}break;case"<":z=m;break}if(z>=m)break;if(N=tt(y.slice(z,m),!0),F=N.r!=null?parseInt(N.r,10):F+1,I=-1,!(d.sheetRows&&d.sheetRows<F)){p.s.r>F-1&&(p.s.r=F-1),p.e.r<F-1&&(p.e.r=F-1),d&&d.cellStyles&&(ce={},Se=!1,N.ht&&(Se=!0,ce.hpt=parseFloat(N.ht),ce.hpx=q0(ce.hpt)),N.hidden=="1"&&(Se=!0,ce.hidden=!0),N.outlineLevel!=null&&(Se=!0,ce.level=+N.outlineLevel),Se&&(X[F-1]=ce)),E=y.slice(m).split(e);for(var ee=0;ee!=E.length&&E[ee].trim().charAt(0)=="<";++ee);for(E=E.slice(ee),m=0;m!=E.length;++m)if(y=E[m].trim(),y.length!==0){if(k=y.match(r),w=m,x=0,C=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(w=0,A=k[1],x=0;x!=A.length&&!((C=A.charCodeAt(x)-64)<1||C>26);++x)w=26*w+C;--w,I=w}else++I;for(x=0;x!=y.length&&y.charCodeAt(x)!==62;++x);if(++x,N=tt(y.slice(0,x),!0),N.r||(N.r=ot({r:F-1,c:I})),A=y.slice(x),P={t:""},(k=A.match(a))!=null&&k[1]!==""&&(P.v=Ft(k[1])),d.cellFormula){if((k=A.match(s))!=null&&k[1]!==""){if(P.f=Ft($t(k[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=m3(P.f)),k[0].indexOf('t="array"')>-1)P.F=(A.match(i)||[])[1],P.F.indexOf(":")>-1&&Ee.push([fr(P.F),P.F]);else if(k[0].indexOf('t="shared"')>-1){U=tt(k[0]);var de=Ft($t(k[1]));d.xlfn||(de=m3(de)),we[parseInt(U.si,10)]=[U,de,N.r]}}else(k=A.match(/<f[^>]*\/>/))&&(U=tt(k[0]),we[U.si]&&(P.f=yF(we[U.si][1],we[U.si][2],N.r)));var xe=En(N.r);for(x=0;x<Ee.length;++x)xe.r>=Ee[x][0].s.r&&xe.r<=Ee[x][0].e.r&&xe.c>=Ee[x][0].s.c&&xe.c<=Ee[x][0].e.c&&(P.F=Ee[x][1])}if(N.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(L)P.t="z";else continue;else P.t=N.t||"n";switch(p.s.c>I&&(p.s.c=I),p.e.c<I&&(p.e.c=I),P.t){case"n":if(P.v==""||P.v==null){if(!L)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!L)continue;P.t="z"}else D=S0[parseInt(P.v,10)],P.v=D.t,P.r=D.r,d.cellHTML&&(P.h=D.h);break;case"str":P.t="s",P.v=P.v!=null?$t(P.v):"",d.cellHTML&&(P.h=W2(P.v));break;case"inlineStr":k=A.match(n),P.t="s",k!=null&&(D=tx(k[1]))?(P.v=D.t,d.cellHTML&&(P.h=D.h)):P.v="";break;case"b":P.v=Zt(P.v);break;case"d":d.cellDates?P.v=Wr(P.v,1):(P.v=An(Wr(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=D8[P.v];break}if(O=Q=0,te=null,he&&N.s!==void 0&&(te=v.CellXf[N.s],te!=null&&(te.numFmtId!=null&&(O=te.numFmtId),d.cellStyles&&te.fillId!=null&&(Q=te.fillId))),fw(P,O,Q,d,g,v),d.cellDates&&he&&P.t=="n"&&nc(ft[O])&&(P.t="d",P.v=gh(P.v)),N.cm&&d.xlmeta){var Me=(d.xlmeta.Cell||[])[+N.cm-1];Me&&Me.type=="XLDAPR"&&(P.D=!0)}if(se){var G=En(N.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=P}else f[N.r]=P}}}}X.length>0&&(f["!rows"]=X)}}();function cR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var uR=bo;function fR(){}function dR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=b7(e),r}function hR(e){var t=Ai(e);return[t]}function pR(e){var t=Do(e);return[t]}function gR(e){var t=Ai(e),r=e.read_shift(1);return[t,r,"b"]}function mR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"b"]}function xR(e){var t=Ai(e),r=e.read_shift(1);return[t,r,"e"]}function vR(e){var t=Do(e),r=e.read_shift(1);return[t,r,"e"]}function yR(e){var t=Ai(e),r=e.read_shift(4);return[t,r,"s"]}function _R(e){var t=Do(e),r=e.read_shift(4);return[t,r,"s"]}function wR(e){var t=Ai(e),r=hn(e);return[t,r,"n"]}function hw(e){var t=Do(e),r=hn(e);return[t,r,"n"]}function SR(e){var t=Ai(e),r=J2(e);return[t,r,"n"]}function kR(e){var t=Do(e),r=J2(e);return[t,r,"n"]}function ER(e){var t=Ai(e),r=Q2(e);return[t,r,"is"]}function CR(e){var t=Ai(e),r=gn(e);return[t,r,"str"]}function TR(e){var t=Do(e),r=gn(e);return[t,r,"str"]}function AR(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function PR(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function FR(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var a=hn(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}function NR(e,t,r){var n=e.l+t,i=Ai(e);i.r=r["!row"];var a=gn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=vh(e,n-e.l,r);s[3]=fn(o,null,i,r.supbooks,r)}else e.l=n;return s}var RR=bo;function IR(e,t){var r=e.l+t,n=bo(e),i=q2(e),a=gn(e),s=gn(e),o=gn(e);e.l=r;var u={rfx:n,relId:i,loc:a,display:o};return s&&(u.Tooltip=s),u}function DR(){}function bR(e,t,r){var n=e.l+t,i=N8(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=UN(e,n-e.l,r);s[1]=o}else e.l=n;return s}function OR(e,t,r){var n=e.l+t,i=bo(e),a=[i];if(r.cellFormula){var s=zN(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}var LR=["left","right","top","bottom","header","footer"];function MR(e){var t={};return LR.forEach(function(r){t[r]=hn(e)}),t}function BR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UR(){}function jR(){}function zR(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var u=o.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,v,m,y,E,k,w,x,C,A,P=[];o.biff=12,o["!row"]=0;var N=0,F=!1,I=[],D={},U=o.supbooks||i.supbooks||[[]];if(U.sharedf=D,U.arrayf=I,U.SheetNames=i.SheetNames||i.Sheets.map(function(se){return se.name}),!o.supbooks&&(o.supbooks=U,i.Names))for(var O=0;O<i.Names.length;++O)U[0][O+1]=i.Names[O];var Q=[],he=[],te=!1;zd[16]={n:"BrtShortReal",f:hw};var Ee;if(Xa(e,function(X,ce,Se){if(!g)switch(Se){case 148:f=X;break;case 0:v=X,o.sheetRows&&o.sheetRows<=v.r&&(g=!0),C=Zr(E=v.r),o["!row"]=v.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=q0(X.hpt)),he[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:X[2]},X[2]){case"n":m.v=X[1];break;case"s":x=S0[X[1]],m.v=x.t,m.r=x.r;break;case"b":m.v=!!X[1];break;case"e":m.v=X[1],o.cellText!==!1&&(m.w=Oo[m.v]);break;case"str":m.t="s",m.v=X[1];break;case"is":m.t="s",m.v=X[1].t;break}if((y=s.CellXf[X[0].iStyleRef])&&fw(m,y.numFmtId,null,o,a,s),k=X[0].c==-1?k+1:X[0].c,o.dense?(u[E]||(u[E]=[]),u[E][k]=m):u[Rr(k)+C]=m,o.cellFormula){for(F=!1,N=0;N<I.length;++N){var L=I[N];v.r>=L[0].s.r&&v.r<=L[0].e.r&&k>=L[0].s.c&&k<=L[0].e.c&&(m.F=Tt(L[0]),F=!0)}!F&&X.length>3&&(m.f=X[3])}if(d.s.r>v.r&&(d.s.r=v.r),d.s.c>k&&(d.s.c=k),d.e.r<v.r&&(d.e.r=v.r),d.e.c<k&&(d.e.c=k),o.cellDates&&y&&m.t=="n"&&nc(ft[y.numFmtId])){var q=po(m.v);q&&(m.t="d",m.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}Ee&&(Ee.type=="XLDAPR"&&(m.D=!0),Ee=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;m={t:"z",v:void 0},k=X[0].c==-1?k+1:X[0].c,o.dense?(u[E]||(u[E]=[]),u[E][k]=m):u[Rr(k)+C]=m,d.s.r>v.r&&(d.s.r=v.r),d.s.c>k&&(d.s.c=k),d.e.r<v.r&&(d.e.r=v.r),d.e.c<k&&(d.e.c=k),Ee&&(Ee.type=="XLDAPR"&&(m.D=!0),Ee=void 0);break;case 176:P.push(X);break;case 49:Ee=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var Y=n["!id"][X.relId];for(Y?(X.Target=Y.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=Y):X.relId==""&&(X.Target="#"+X.loc),E=X.rfx.s.r;E<=X.rfx.e.r;++E)for(k=X.rfx.s.c;k<=X.rfx.e.c;++k)o.dense?(u[E]||(u[E]=[]),u[E][k]||(u[E][k]={t:"z",v:void 0}),u[E][k].l=X):(w=ot({c:k,r:E}),u[w]||(u[w]={t:"z",v:void 0}),u[w].l=X);break;case 426:if(!o.cellFormula)break;I.push(X),A=o.dense?u[E][k]:u[Rr(k)+C],A.f=fn(X[1],d,{r:v.r,c:k},U,o),A.F=Tt(X[0]);break;case 427:if(!o.cellFormula)break;D[ot(X[0].s)]=X[1],A=o.dense?u[E][k]:u[Rr(k)+C],A.f=fn(X[1],d,{r:v.r,c:k},U,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)Q[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},te||(te=!0,rx(X.w/256)),Yl(Q[X.e+1]);break;case 161:u["!autofilter"]={ref:Tt(X)};break;case 476:u["!margins"]=X;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),X.name&&(i.Sheets[r].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!ce.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+Se.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=Tt(f||d)),o.sheetRows&&u["!ref"]){var we=fr(u["!ref"]);o.sheetRows<=+we.e.r&&(we.e.r=o.sheetRows-1,we.e.r>d.e.r&&(we.e.r=d.e.r),we.e.r<we.s.r&&(we.s.r=we.e.r),we.e.c>d.e.c&&(we.e.c=d.e.c),we.e.c<we.s.c&&(we.s.c=we.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Tt(we))}return P.length>0&&(u["!merges"]=P),Q.length>0&&(u["!cols"]=Q),he.length>0&&(u["!rows"]=he),u}function VR(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function GR(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,u=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=VR(p);d.s.r=d.s.c=0,d.e.c=o,f=Rr(o),g[0].forEach(function(v,m){s[f+Zr(m)]={t:"n",v,z:g[1]},u=m}),d.e.r<u&&(d.e.r=u),++o}),o>0&&(s["!ref"]=Tt(d)),s}function HR(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(dw);return o&&ix(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function WR(e,t){e.l+=10;var r=gn(e);return{name:r}}function $R(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Xa(e,function(u,f,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var pw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],XR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KR=[],YR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function w3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Zt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function S3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Zt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function gw(e){S3(e.WBProps,pw),S3(e.CalcPr,YR),w3(e.WBView,XR),w3(e.Sheets,KR),Ll.date1904=Zt(e.WBProps.date1904)}var QR="][*?/\\".split("");function qR(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return QR.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var JR=/<\w+:workbook/;function ZR(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(vn,function(u,f){var d=tt(u);switch(ma(d[0])){case"<?xml":break;case"<workbook":u.match(JR)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":pw.forEach(function(p){if(d[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Zt(d[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(d[p[0]],10);break;default:r.WBProps[p[0]]=d[p[0]]}}),d.codeName&&(r.WBProps.CodeName=$t(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ft($t(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=$t(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Zt(d.hidden||"0")&&(a.Hidden=!0),s=f+u.length;break;case"</definedName>":a.Ref=Ft($t(e.slice(s,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),x7.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gw(r),r}function eI(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=wm(e),r.name=gn(e),r}function tI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?gn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=O7(e),s=jN(e,0,r),o=q2(e);e.l=n;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function iI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],zd[16]={n:"BrtFRTArchID$",f:rI},Xa(e,function(u,f,d){switch(d){case 156:s.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=fn(u.Ptg,null,null,s,t),delete t.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,u]):s[0]=[d,u],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(u),s.XTI=s.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),gw(r),r.Names=a,r.supbooks=s,r}function aI(e,t,r){return t.slice(-4)===".bin"?iI(e,r):ZR(e,r)}function sI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?zR(e,n,r,i,a,s,o):eR(e,n,r,i,a,s,o)}function oI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?$R(e,n,r,i,a):HR(e,n,r,i,a)}function lI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?mF():xF()}function cI(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?pF():gF()}function uI(e,t,r,n){return t.slice(-4)===".bin"?RP(e,r,n):CP(e,r,n)}function fI(e,t,r){return tw(e,r)}function dI(e,t,r){return t.slice(-4)===".bin"?XA(e,r):WA(e,r)}function hI(e,t,r){return t.slice(-4)===".bin"?fF(e,r):sF(e,r)}function pI(e,t,r){return t.slice(-4)===".bin"?nF(e):tF(e)}function gI(e,t,r,n){return r.slice(-4)===".bin"?iF(e,t,r,n):void 0}function mI(e,t,r){return t.slice(-4)===".bin"?ZP(e,t,r):eF(e,t,r)}var mw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Li(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(mw),a,s,o,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(xw),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function xI(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(mw),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(xw),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var E0;function vI(e,t){var r=E0[e]||Ft(e);return r==="General"?To(t):Ti(r,t)}function yI(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Zt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Wr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ft(t)]=i}function _I(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Oo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=vI(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=E0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&nc(n)){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function wI(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=yP[n.Pattern]||n.Pattern)}e[t.ID]=t}function SI(e,t,r,n,i,a,s,o,u,f){var d="General",p=n.StyleID,g={};f=f||{};var v=[],m=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);a[p]!==void 0&&(a[p].nf&&(d=a[p].nf),a[p].Interior&&v.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(e);break;case"String":n.t="s",n.r=Hy(Ft(e)),n.v=e.indexOf("<")>-1?Ft(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Wr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ft(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=D8[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Hy(t||e));break}if(_I(n,d,f),f.cellFormula!==!1)if(n.Formula){var y=Ft(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Ol(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ol("RC:RC",i):n.ArrayRange&&(n.F=Ol(n.ArrayRange,i),u.push([fr(n.F),n.F]))}else for(m=0;m<u.length;++m)i.r>=u[m][0].s.r&&i.r<=u[m][0].e.r&&i.c>=u[m][0].s.c&&i.c<=u[m][0].e.c&&(n.F=u[m][1]);f.cellStyles&&(v.forEach(function(E){!g.patternType&&E.patternType&&(g.patternType=E.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kI(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ig(e,t){var r=t||{};i8();var n=t0($2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=$t(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Jr(r);return s.type="string",Y0.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(kt){i.indexOf("<"+kt)>=0&&(a=!0)}),a)return II(n,r);E0={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],f,d={},p=[],g=r.dense?[]:{},v="",m={},y={},E=Li('<Data ss:Type="String">'),k=0,w=0,x=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},P={},N="",F=0,I=[],D={},U={},O=0,Q=[],he=[],te={},Ee=[],we,se=!1,X=[],ce=[],Se={},L=0,q=0,Y={Sheets:[],WBProps:{date1904:!1}},K={};K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";o=K0.exec(n);)switch(o[3]=(ue=o[3]).toLowerCase()){case"data":if(ue=="data"){if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?SI(n.slice(k,o.index),N,E,u[u.length-1][0]=="comment"?te:m,{c:w,r:x},A,Ee[w],y,X,r):(N="",E=Li(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(he.length>0&&(m.c=he),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(g[x]||(g[x]=[]),g[x][w]=m):g[Rr(w)+Zr(x)]=m),m.HRef&&(m.l={Target:Ft(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(L=w+(parseInt(m.MergeAcross,10)|0),q=x+(parseInt(m.MergeDown,10)|0),I.push({s:{c:w,r:x},e:{c:L,r:q}})),!r.sheetStubs)m.MergeAcross?w=L+1:++w;else if(m.MergeAcross||m.MergeDown){for(var z=w;z<=L;++z)for(var ee=x;ee<=q;++ee)(z>w||ee>x)&&(r.dense?(g[ee]||(g[ee]=[]),g[ee][z]={t:"z"}):g[Rr(z)+Zr(ee)]={t:"z"});w=L+1}else++w;else m=xI(o[0]),m.Index&&(w=+m.Index-1),w<C.s.c&&(C.s.c=w),w>C.e.c&&(C.e.c=w),o[0].slice(-2)==="/>"&&++w,he=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<C.s.r&&(C.s.r=x),x>C.e.r&&(C.e.r=x),o[0].slice(-2)==="/>"&&(y=Li(o[0]),y.Index&&(x=+y.Index-1)),w=0,++x):(y=Li(o[0]),y.Index&&(x=+y.Index-1),Se={},(y.AutoFitHeight=="0"||y.Height)&&(Se.hpx=parseInt(y.Height,10),Se.hpt=ew(Se.hpx),ce[x]=Se),y.Hidden=="1"&&(Se.hidden=!0,ce[x]=Se));break;case"worksheet":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(g["!ref"]=Tt(C),r.sheetRows&&r.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=r.sheetRows-1,g["!ref"]=Tt(C))),I.length&&(g["!merges"]=I),Ee.length>0&&(g["!cols"]=Ee),ce.length>0&&(g["!rows"]=ce),d[v]=g}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,u.push([o[3],!1]),f=Li(o[0]),v=Ft(f.Name),g=r.dense?[]:{},I=[],X=[],ce=[],K={name:v,Hidden:0},Y.Sheets.push(K);break;case"table":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),Ee=[],se=!1}break;case"style":o[1]==="/"?wI(A,P,r):P=Li(o[0]);break;case"numberformat":P.nf=Ft(Li(o[0]).Format||"General"),E0[P.nf]&&(P.nf=E0[P.nf]);for(var de=0;de!=392&&ft[de]!=P.nf;++de);if(de==392){for(de=57;de!=392;++de)if(ft[de]==null){vo(P.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(we=Li(o[0]),we.Hidden&&(we.hidden=!0,delete we.Hidden),we.Width&&(we.wpx=parseInt(we.Width,10)),!se&&we.wpx>10){se=!0,kn=J8;for(var xe=0;xe<Ee.length;++xe)Ee[xe]&&Yl(Ee[xe])}se&&Yl(we),Ee[we.Index-1||Ee.length]=we;for(var Me=0;Me<+we.Span;++Me)Ee[Ee.length]=Jr(we);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var G=tt(o[0]),Ze={Name:G.Name,Ref:Ol(G.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Ze.Sheet=Y.Sheets.length-1),Y.Names.push(Ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Li(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sT(D,ue,n.slice(O,o.index)):O=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));kI(te),he.push(te)}else u.push([o[3],!1]),f=Li(o[0]),te={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var nt=Li(o[0]);g["!autofilter"]={ref:Ol(nt.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=u.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return P3(n,r);var Ke=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ke=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ke=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ke=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ke=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(O,o.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else O=o.index+o[0].length;break;case"header":g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(g["!margins"].header=+tt(o[0]).Margin);break;case"footer":g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+tt(o[0]).Margin)||(g["!margins"].footer=+tt(o[0]).Margin);break;case"pagemargins":var qe=tt(o[0]);g["!margins"]||k0(g["!margins"]={},"xlml"),isNaN(+qe.Top)||(g["!margins"].top=+qe.Top),isNaN(+qe.Left)||(g["!margins"].left=+qe.Left),isNaN(+qe.Right)||(g["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(g["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ke=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ke=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ke=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ke=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ke=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ke=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ke=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ke=!1}break;case"smarttags":break;default:Ke=!1;break}if(Ke||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?yI(U,ue,Q,n.slice(O,o.index)):(Q=o,O=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=d),De.SheetNames=p,De.Workbook=Y,De.SSF=Jr(ft),De.Props=D,De.Custprops=U,De}function Cm(e,t){switch(ox(t=t||{}),t.type||"base64"){case"base64":return ig(ri(e),t);case"binary":case"buffer":case"file":return ig(e,t);case"array":return ig(Io(e),t)}}function EI(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=B7(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=U7(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CI=[60,1084,2066,2165,2175];function TI(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var u=Oa(r,r.l),f=Tm[u],d=0;f!=null&&CI.indexOf(u)>-1;)a=Oa(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,f=Tm[u=Oa(r,r.l)];var p=ms(s);Qr(p,0);var g=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(g),g+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,i)}function oa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ft[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Oo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$0(e.v):e.w=To(e.v):e.w=Ti(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&nc(ft[n]||String(n))){var i=po(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bf(e,t,r){return{v:e,ixfe:t,t:r}}function AI(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,u=[],f="",d={},p,g="",v,m,y,E,k={},w=[],x,C,A=[],P=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},I=function(Fe){return Fe<8?yo[Fe]:Fe<64&&P[Fe-8]||yo[Fe]},D=function(Fe,ke,Qe){var Je=ke.XF.data;if(!(!Je||!Je.patternType||!Qe||!Qe.cellStyles)){ke.s={},ke.s.patternType=Je.patternType;var dt;(dt=Q0(I(Je.icvFore)))&&(ke.s.fgColor={rgb:dt}),(dt=Q0(I(Je.icvBack)))&&(ke.s.bgColor={rgb:dt})}},U=function(Fe,ke,Qe){if(!(Se>1)&&!(Qe.sheetRows&&Fe.r>=Qe.sheetRows)){if(Qe.cellStyles&&ke.XF&&ke.XF.data&&D(Fe,ke,Qe),delete ke.ixfe,delete ke.XF,p=Fe,g=ot(Fe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<s.s.r&&(s.s.r=Fe.r),Fe.c<s.s.c&&(s.s.c=Fe.c),Fe.r+1>s.e.r&&(s.e.r=Fe.r+1),Fe.c+1>s.e.c&&(s.e.c=Fe.c+1),Qe.cellFormula&&ke.f){for(var Je=0;Je<w.length;++Je)if(!(w[Je][0].s.c>Fe.c||w[Je][0].s.r>Fe.r)&&!(w[Je][0].e.c<Fe.c||w[Je][0].e.r<Fe.r)){ke.F=Tt(w[Je][0]),(w[Je][0].s.c!=Fe.c||w[Je][0].s.r!=Fe.r)&&delete ke.f,ke.f&&(ke.f=""+fn(w[Je][1],s,Fe,X,O));break}}Qe.dense?(i[Fe.r]||(i[Fe.r]=[]),i[Fe.r][Fe.c]=ke):i[g]=ke}},O={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(O.password=t.password);var Q,he=[],te=[],Ee=[],we=[],se=!1,X=[];X.SheetNames=O.snames,X.sharedf=O.sharedf,X.arrayf=O.arrayf,X.names=[],X.XTI=[];var ce=0,Se=0,L=0,q=[],Y=[],K;O.codepage=1200,Gi(1200);for(var ue=!1;e.l<e.length-1;){var z=e.l,ee=e.read_shift(2);if(ee===0&&ce===10)break;var de=e.l===e.length?0:e.read_shift(2),xe=Tm[ee];if(xe&&xe.f){if(t.bookSheets&&ce===133&&ee!==133)break;if(ce=ee,xe.r===2||xe.r==12){var Me=e.read_shift(2);if(de-=2,!O.enc&&Me!==ee&&((Me&255)<<8|Me>>8)!==ee)throw new Error("rt mismatch: "+Me+"!="+ee);xe.r==12&&(e.l+=10,de-=10)}var G={};if(ee===10?G=xe.f(e,de,O):G=TI(ee,xe,e,de,O),Se==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(ee){case 34:r.opts.Date1904=N.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(e.l=0),O.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=G;break;case 66:var Ze=Number(G);switch(Ze){case 21010:Ze=1200;break;case 32768:Ze=1e4;break;case 32769:Ze=1252;break}Gi(O.codepage=Ze),ue=!0;break;case 317:O.rrtabid=G;break;case 25:O.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:O.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:A.push(G);break;case 430:X.push([G]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:fn(G.rgce,s,null,X,O)},G.itab>0&&(K.Sheet=G.itab-1),X.names.push(K),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Y[G.itab-1]={ref:Tt(G.rgce[0][0][1][2])});break;case 22:O.ExternCount=G;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(G),X.XTI=X.XTI.concat(G);break;case 2196:if(O.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&O.WTF&&console.error("Password verifier: "+G);break;case 133:a[G.pos]=G,O.snames.push(G.name);break;case 10:{if(--Se)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=Tt(s),t.sheetRows&&t.sheetRows<=s.e.r){var nt=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Tt(s),s.e.r=nt}s.e.r++,s.e.c++}he.length>0&&(i["!merges"]=he),te.length>0&&(i["!objects"]=te),Ee.length>0&&(i["!cols"]=Ee),we.length>0&&(i["!rows"]=we),N.Sheets.push(F)}f===""?d=i:n[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),O.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(O.biff=5,ue=!0,Gi(O.codepage=28591)),O.biff==8&&G.BIFFVer==0&&G.dt==16&&(O.biff=2),Se++)break;if(i=t.dense?[]:{},O.biff<8&&!ue&&(ue=!0,Gi(O.codepage=t.codepage||1252)),O.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ke={pos:e.l-de,name:f};a[Ke.pos]=Ke,O.snames.push(f)}else f=(a[z]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),he=[],te=[],O.arrayf=w=[],Ee=[],we=[],se=!1,F={Hidden:(a[z]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[G.r]||[])[G.c]:i[ot({c:G.c,r:G.r})])&&++G.c,x={ixfe:G.ixfe,XF:A[G.ixfe]||{},v:G.val,t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t);break;case 5:case 517:x={ixfe:G.ixfe,XF:A[G.ixfe],v:G.val,t:G.t},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t);break;case 638:x={ixfe:G.ixfe,XF:A[G.ixfe],v:G.rknum,t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t);break;case 189:for(var qe=G.c;qe<=G.C;++qe){var De=G.rkrec[qe-G.c][0];x={ixfe:De,XF:A[De],v:G.rkrec[qe-G.c][1],t:"n"},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:qe,r:G.r},x,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(x=Bf(G.val,G.cell.ixfe,G.tt),x.XF=A[x.ixfe],t.cellFormula){var kt=G.formula;if(kt&&kt[0]&&kt[0][0]&&kt[0][0][0]=="PtgExp"){var Or=kt[0][0][1][0],me=kt[0][0][1][1],pe=ot({r:Or,c:me});k[pe]?x.f=""+fn(G.formula,s,G.cell,X,O):x.F=((t.dense?(i[Or]||[])[me]:i[pe])||{}).F}else x.f=""+fn(G.formula,s,G.cell,X,O)}L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U(G.cell,x,t),o=G}break;case 7:case 519:if(o)o.val=G,x=Bf(G,o.cell.ixfe,"s"),x.XF=A[x.ixfe],t.cellFormula&&(x.f=""+fn(o.formula,s,o.cell,X,O)),L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(G);var Ce=ot(G[0].s);if(v=t.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Ce],t.cellFormula&&v){if(!o||!Ce||!v)break;v.f=""+fn(G[1],s,G[0],X,O),v.F=Tt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;k[ot(o.cell)]=G[0],v=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[ot(o.cell)],(v||{}).f=""+fn(G[0],s,p,X,O)}}break;case 253:x=Bf(u[G.isst].t,G.ixfe,"s"),u[G.isst].h&&(x.h=u[G.isst].h),x.XF=A[x.ixfe],L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:G.ixfe,XF:A[G.ixfe],t:"z"},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t));break;case 190:if(t.sheetStubs)for(var Te=G.c;Te<=G.C;++Te){var Ae=G.ixfe[Te-G.c];x={ixfe:Ae,XF:A[Ae],t:"z"},L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:Te,r:G.r},x,t)}break;case 214:case 516:case 4:x=Bf(G.val,G.ixfe,"s"),x.XF=A[x.ixfe],L>0&&(x.z=q[x.ixfe>>8&63]),oa(x,t,r.opts.Date1904),U({c:G.c,r:G.r},x,t);break;case 0:case 512:Se===1&&(s=G);break;case 252:u=G;break;case 1054:if(O.biff==4){q[L++]=G[1];for(var be=0;be<L+163&&ft[be]!=G[1];++be);be>=163&&vo(G[1],L+163)}else vo(G[1],G[0]);break;case 30:{q[L++]=G;for(var Ge=0;Ge<L+163&&ft[Ge]!=G;++Ge);Ge>=163&&vo(G,L+163)}break;case 229:he=he.concat(G);break;case 93:te[G.cmo[0]]=O.lastobj=G;break;case 438:O.lastobj.TxO=G;break;case 127:O.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[E]||[])[y]:i[ot({c:y,r:E})],v&&(v.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(y=G[0].s.c;y<=G[0].e.c;++y)v=t.dense?(i[E]||[])[y]:i[ot({c:y,r:E})],v&&v.l&&(v.l.Tooltip=G[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;v=t.dense?(i[G[0].r]||[])[G[0].c]:i[ot(G[0])];var ye=te[G[2]];v||(t.dense?(i[G[0].r]||(i[G[0].r]=[]),v=i[G[0].r][G[0].c]={t:"z"}):v=i[ot(G[0])]={t:"z"},s.e.r=Math.max(s.e.r,G[0].r),s.s.r=Math.min(s.s.r,G[0].r),s.e.c=Math.max(s.e.c,G[0].c),s.s.c=Math.min(s.s.c,G[0].c)),v.c||(v.c=[]),m={a:G[1],t:ye.TxO.t},v.c.push(m)}break;case 2173:YP(A[G.ixfe],G.ext);break;case 125:{if(!O.cellStyles)break;for(;G.e>=G.s;)Ee[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},se||(se=!0,rx(G.w/256)),Yl(Ee[G.e+1])}break;case 520:{var ie={};G.level!=null&&(we[G.r]=ie,ie.level=G.level),G.hidden&&(we[G.r]=ie,ie.hidden=!0),G.hpt&&(we[G.r]=ie,ie.hpt=G.hpt,ie.hpx=q0(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||k0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ee]]=G;break;case 161:i["!margins"]||k0(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(N.Views[0].RTL=!0);break;case 146:P=G;break;case 2198:Q=G;break;case 140:C=G;break;case 442:f?F.CodeName=G||F.name:N.WBProps.CodeName=G||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+ee.toString(16)),e.l+=de}return r.SheetNames=ga(a).sort(function(Pe,Fe){return Number(Pe)-Number(Fe)}).map(function(Pe){return a[Pe].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Y.forEach(function(Pe,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Pe}),r.Strings=u,r.SSF=Jr(ft),O.enc&&(r.Encryption=O.enc),Q&&(r.Themes=Q),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),X.names.length>0&&(N.Names=X.names),r.Workbook=N,r}var k3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PI(e,t,r){var n=Ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=s3(n,W7,k3.DSI);for(var a in i)t[a]=i[a]}catch(f){if(r.WTF)throw f}var s=Ct.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=s3(s,$7,k3.SI);for(var u in o)t[u]==null&&(t[u]=o[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(O8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vw(e,t){t||(t={}),ox(t),$6(),t.codepage&&U2(t.codepage);var r,n;if(e.FullPaths){if(Ct.find(e,"/encryption"))throw new Error("File is password-protected");r=Ct.find(e,"!CompObj"),n=Ct.find(e,"/Workbook")||Ct.find(e,"/Book")}else{switch(t.type){case"base64":e=Vi(ri(e));break;case"binary":e=Vi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Qr(e,0),n={content:e}}var i,a;if(r&&EI(r),t.bookProps&&!t.bookSheets)i={};else{var s=wt?"buffer":"array";if(n&&n.content)i=AI(n.content,t);else if((a=Ct.find(e,"PerfectOffice_MAIN"))&&a.content)i=w0.to_workbook(a.content,(t.type=s,t));else if((a=Ct.find(e,"NativeContent_MAIN"))&&a.content)i=w0.to_workbook(a.content,(t.type=s,t));else throw(a=Ct.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=hF(e))}var o={};return e.FullPaths&&PI(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var zd={0:{f:cR},1:{f:hR},2:{f:SR},3:{f:xR},4:{f:gR},5:{f:wR},6:{f:CR},7:{f:yR},8:{f:NR},9:{f:FR},10:{f:AR},11:{f:PR},12:{f:pR},13:{f:kR},14:{f:vR},15:{f:mR},16:{f:hw},17:{f:TR},18:{f:_R},19:{f:Q2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nI},40:{},42:{},43:{f:AP},44:{f:TP},45:{f:PP},46:{f:NP},47:{f:FP},48:{},49:{f:R7},50:{},51:{f:qP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:X8},62:{f:ER},63:{f:rF},64:{f:UR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dR},148:{f:uR,p:16},151:{f:DR},152:{},153:{f:tI},154:{},155:{},156:{f:eI},157:{},158:{},159:{T:1,f:$A},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:RR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:QP},336:{T:-1},337:{f:JP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bR},427:{f:OR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uF},633:{T:1},634:{T:-1},635:{T:1,f:cF},636:{T:-1},637:{f:D7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Tm={6:{f:rg},10:{f:ls},12:{f:wr},13:{f:wr},14:{f:pr},15:{f:pr},16:{f:hn},17:{f:pr},18:{f:pr},19:{f:wr},20:{f:u3},21:{f:u3},23:{f:$8},24:{f:d3},25:{f:pr},26:{},27:{},28:{f:oA},29:{},34:{f:pr},35:{f:f3},38:{f:hn},39:{f:hn},40:{f:hn},41:{f:hn},42:{f:pr},43:{f:pr},47:{f:fP},49:{f:VT},51:{f:wr},60:{},61:{f:UT},64:{f:pr},65:{f:zT},66:{f:wr},77:{},80:{},81:{},82:{},85:{f:wr},89:{},90:{},91:{},92:{f:RT},93:{f:cA},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:X8},128:{f:JT},129:{f:IT},130:{f:wr},131:{f:pr},132:{f:pr},133:{f:DT},134:{},140:{f:gA},141:{f:wr},144:{},146:{f:xA},151:{},152:{},153:{},154:{},155:{},156:{f:wr},157:{},158:{},160:{f:SA},161:{f:yA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KT},190:{f:YT},193:{f:ls},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wr},220:{},221:{f:pr},222:{},224:{f:qT},225:{f:NT},226:{f:ls},227:{},229:{f:lA},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bT},253:{f:GT},255:{f:OT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:j8},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:ls},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eA},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:dA},439:{f:pr},440:{f:hA},441:{},442:{f:uu},443:{},444:{f:wr},445:{},446:{},448:{f:ls},449:{f:BT,r:2},450:{f:ls},512:{f:l3},513:{f:wA},515:{f:ZT},516:{f:HT},517:{f:c3},519:{f:kA},520:{f:LT},523:{},545:{f:h3},549:{f:o3},566:{},574:{f:jT},638:{f:XT},659:{},1048:{},1054:{f:WT},1084:{},1212:{f:iA},2048:{f:pA},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Of},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ls},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vA,r:12},2173:{f:KP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nA,r:12},2197:{},2198:{f:VP,r:12},2199:{},2200:{},2201:{},2202:{f:aA,r:12},2203:{f:ls},2204:{},2205:{},2206:{},2207:{},2211:{f:MT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_A},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mA},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:l3},1:{},2:{f:AA},3:{f:TA},4:{f:CA},5:{f:c3},7:{f:PA},8:{},9:{f:Of},11:{},22:{f:wr},30:{f:$T},31:{},32:{},33:{f:h3},36:{},37:{f:o3},50:{f:FA},62:{},52:{},67:{},68:{f:wr},69:{},86:{},126:{},127:{f:EA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:NA},223:{},234:{},354:{},421:{},518:{f:rg},521:{f:Of},536:{f:d3},547:{f:f3},561:{},579:{},1030:{f:rg},1033:{f:Of},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Mi(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&A8(r)&&e.push(r)}}function E3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,u=e7(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,p=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<u.length;++s){var y=u[s].trim(),E=y.slice(0,3).toLowerCase();if(E=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var k=y.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var w=k[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,C=0;x.charAt(0)=="<"&&(C=x.indexOf(">"))>-1;)x=x.slice(C+1);for(var A=0;A<m.length;++A){var P=m[A];P.s.c==d&&P.s.r<f&&f<=P.e.r&&(d=P.e.c+1,A=-1)}var N=tt(w.slice(0,w.indexOf(">")));g=N.colspan?+N.colspan:1,((p=+N.rowspan)>1||g>1)&&m.push({s:{r:f,c:d},e:{r:f+(p||1)-1,c:d+g-1}});var F=N.t||N["data-t"]||"";if(!x.length){d+=g;continue}if(x=p8(x),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>d&&(v.s.c=d),v.e.c<d&&(v.e.c=d),!x.length){d+=g;continue}var I={t:"s",v:x};r.raw||!x.trim().length||F=="s"||(x==="TRUE"?I={t:"b",v:!0}:x==="FALSE"?I={t:"b",v:!1}:isNaN(Ki(x))?isNaN(Kl(x).getDate())||(I={t:"d",v:Wr(x)},r.cellDates||(I={t:"n",v:An(I.v)}),I.z=r.dateNF||ft[14]):I={t:"n",v:Ki(x)}),r.dense?(n[f]||(n[f]=[]),n[f][d]=I):n[ot({r:f,c:d})]=I,d+=g}}}}return n["!ref"]=Tt(v),m.length&&(n["!merges"]=m),n}function FI(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>s)&&!(i[f].e.r<r||i[f].e.c<s)){if(i[f].s.r<r||i[f].s.c<s){o=-1;break}o=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(o<0)){var d=ot({r,c:s}),p=n.dense?(e[r]||[])[s]:e[d],g=p&&p.v!=null&&(p.h||W2(p.w||(Wa(p),p.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),v.id=(n.id||"sjs")+"-"+d,a.push(g7("td",g,v))}}var m="<tr>";return m+a.join("")+"</tr>"}var NI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RI="</body></html>";function II(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Us(E3(r[0],t),t);var n=cx();return r.forEach(function(i,a){ux(n,E3(i,t),"Sheet"+(a+1))}),n}function DI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bI(e,t){var r=t||{},n=r.header!=null?r.header:NI,i=r.footer!=null?r.footer:RI,a=[n],s=ic(e["!ref"]);r.dense=Array.isArray(e),a.push(DI(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(FI(e,s,o,r));return a.push("</table>"+i),a.join("")}function yw(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?En(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var d=ic(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var p=[],g=0,v=e["!rows"]||(e["!rows"]=[]),m=0,y=0,E=0,k=0,w=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&y<u;++m){var C=o[m];if(C3(C)){if(n.display)continue;v[y]={hidden:!0}}var A=C.children;for(E=k=0;E<A.length;++E){var P=A[E];if(!(n.display&&C3(P))){var N=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):p8(P.innerHTML),F=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<p.length;++g){var I=p[g];I.s.c==k+a&&I.s.r<y+i&&y+i<=I.e.r&&(k=I.e.c+1-a,g=-1)}x=+P.getAttribute("colspan")||1,((w=+P.getAttribute("rowspan")||1)>1||x>1)&&p.push({s:{r:y+i,c:k+a},e:{r:y+i+(w||1)-1,c:k+a+(x||1)-1}});var D={t:"s",v:N},U=P.getAttribute("data-t")||P.getAttribute("t")||"";N!=null&&(N.length==0?D.t=U||"z":n.raw||N.trim().length==0||U=="s"||(N==="TRUE"?D={t:"b",v:!0}:N==="FALSE"?D={t:"b",v:!1}:isNaN(Ki(N))?isNaN(Kl(N).getDate())||(D={t:"d",v:Wr(N)},n.cellDates||(D={t:"n",v:An(D.v)}),D.z=n.dateNF||ft[14]):D={t:"n",v:Ki(N)})),D.z===void 0&&F!=null&&(D.z=F);var O="",Q=P.getElementsByTagName("A");if(Q&&Q.length)for(var he=0;he<Q.length&&!(Q[he].hasAttribute("href")&&(O=Q[he].getAttribute("href"),O.charAt(0)!="#"));++he);O&&O.charAt(0)!="#"&&(D.l={Target:O}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][k+a]=D):e[ot({c:k+a,r:y+i})]=D,f.e.c<k+a&&(f.e.c=k+a),k+=x}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+i),e["!ref"]=Tt(f),y>=u&&(e["!fullref"]=Tt((f.e.r=o.length-m+y-1+i,f))),e}function _w(e,t){var r=t||{},n=r.dense?[]:{};return yw(n,e,t)}function OI(e,t){return Us(_w(e,t),t)}function C3(e){var t="",r=LI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function LI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ft(t.replace(/<[^>]*>/g,""));return[r]}var T3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ww(e,t){var r=t||{},n=$2(e),i=[],a,s,o={name:""},u="",f=0,d,p,g={},v=[],m=r.dense?[]:{},y,E,k={value:""},w="",x=0,C=[],A=-1,P=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,I={},D=[],U={},O=0,Q=0,he=[],te=1,Ee=1,we=[],se={Names:[]},X={},ce=["",""],Se=[],L={},q="",Y=0,K=!1,ue=!1,z=0;for(K0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=K0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=Tt(N):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=Tt(N)),D.length&&(m["!merges"]=D),he.length&&(m["!rows"]=he),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),v.push(d.name),g[d.name]=m,ue=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=tt(y[0],!1),A=P=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=r.dense?[]:{},D=[],he=[],ue=!0);break;case"table-row-group":y[1]==="/"?--F:++F;break;case"table-row":case"":if(y[1]==="/"){A+=te,te=1;break}if(p=tt(y[0],!1),p.?A=p.-1:A==-1&&(A=0),te=+p["number-rows-repeated"]||1,te<10)for(z=0;z<te;++z)F>0&&(he[A+z]={level:F});P=-1;break;case"covered-table-cell":y[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][P]={t:"z"}):m[ot({r:A,c:P})]={t:"z"}),w="",C=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++P,k=tt(y[0],!1),Ee=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=_3(Ft(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=Ft(k["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][P]=E):m[ot({r:A,c:P})]=E),P+=Ee-1;else if(y[1]!=="/"){++P,w="",x=0,C=[],Ee=1;var ee=te?A+te-1:A;if(P>N.e.c&&(N.e.c=P),P<N.s.c&&(N.s.c=P),A<N.s.r&&(N.s.r=A),ee>N.e.r&&(N.e.r=ee),k=tt(y[0],!1),Se=[],L={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ft(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(O=parseInt(k["number-matrix-rows-spanned"],10)||0,Q=parseInt(k["number-matrix-columns-spanned"],10)||0,U={s:{r:A,c:P},e:{r:A+O-1,c:P+Q-1}},E.F=Tt(U),we.push([U,E.F])),k.formula)E.f=_3(k.formula);else for(z=0;z<we.length;++z)A>=we[z][0].s.r&&A<=we[z][0].e.r&&P>=we[z][0].s.c&&P<=we[z][0].e.c&&(E.F=we[z][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(O=parseInt(k["number-rows-spanned"],10)||0,Q=parseInt(k["number-columns-spanned"],10)||0,U={s:{r:A,c:P},e:{r:A+O-1,c:P+Q-1}},D.push(U)),k["number-columns-repeated"]&&(Ee=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Zt(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=Wr(k["date-value"]),r.cellDates||(E.t="n",E.v=An(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=qC(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=gh(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(w=Ft(k["string-value"]),C=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(K=!1,E.t==="s"&&(E.v=w||"",C.length&&(E.R=C),K=x==0),X.Target&&(E.l=X),Se.length>0&&(E.c=Se,Se=[]),w&&r.cellText!==!1&&(E.w=w),K&&(E.t="z",delete E.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var de=0;de<te;++de){if(Ee=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(m[A+de]||(m[A+de]=[]),m[A+de][P]=de==0?E:Jr(E);--Ee>0;)m[A+de][P+Ee]=Jr(E);else for(m[ot({r:A+de,c:P})]=E;--Ee>0;)m[ot({r:A+de,c:P+Ee})]=Jr(E);N.e.c<=P&&(N.e.c=P)}Ee=parseInt(k["number-columns-repeated"]||"1",10),P+=Ee-1,Ee=0,E={},w="",C=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a;L.t=w,C.length&&(L.R=C),L.a=q,Se.push(L)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);q="",Y=0,w="",x=0,C=[];break;case"creator":y[1]==="/"?q=n.slice(Y,y.index):Y=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);w="",x=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[o.name]=u,(a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(u="",o=tt(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(y[0],!1),u+=T3[y[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=tt(y[0],!1),u+=T3[y[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":s=tt(y[0],!1),ce=ng(s["cell-range-address"]);var xe={Name:s.name,Ref:ce[0]+"!"+ce[1]};ue&&(xe.Sheet=v.length),se.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Me=MI(n.slice(x,y.index));w=(w.length>0?w+`
`:"")+Me[0]}else tt(y[0],!1),x=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ce=ng(tt(y[0])["target-range-address"]),g[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=tt(y[0],!1),!X.href)break;X.Target=Ft(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(ce=ng(X.Target.slice(1)),X.Target="#"+ce[0]+"!"+ce[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:g,SheetNames:v,Workbook:se};return r.bookSheets&&delete G.Sheets,G}function A3(e,t){t=t||{},vi(e,"META-INF/manifest.xml")&&Z7(_r(e,"META-INF/manifest.xml"),t);var r=qn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ww($t(r),t);return vi(e,"meta.xml")&&(n.Props=b8(_r(e,"meta.xml"))),n}function P3(e,t){return ww(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ax(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Am(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):$t(Io(e))}function Pm(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function F3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function BI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function J0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ir(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function pn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=J0(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var u=r[0];e[r[0]++]>=128;);o=e.slice(u,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=J0(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:o,type:a};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function sx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function UI(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=J0(e,n),a=pn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:Ir(a[1][0].data),messages:[]};a[2].forEach(function(o){var u=pn(o.data),f=Ir(u[3][0].data);s.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(s.merge=Ir(a[3][0].data)>>>0>0),r.push(s)}return r}function jI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=J0(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var u=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Pm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Pm(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function zI(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jI(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Pm(t)}function VI(e,t,r,n){var i=ax(e),a=i.getUint32(4,!0),s=(n>1?12:8)+F3(a&(n>1?3470:398))*4,o=-1,u=-1,f=NaN,d=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=F3(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(s,!0),s+=4),a&32&&(f=i.getFloat64(s,!0),s+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function GI(e,t,r){var n=ax(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,u=NaN,f=NaN,d=new Date(2001,0,1);i&1&&(u=BI(e,a),a+=16),i&2&&(f=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:d};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function HI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return VI(e,t,r,e[0]);case 5:return GI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fs(e){var t=pn(e);return J0(t[1][0].data)}function N3(e,t){var r=pn(t.data),n=Ir(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=pn(s.data),u=Ir(o[1][0].data)>>>0;switch(n){case 1:a[u]=Am(o[3][0].data);break;case 8:{var f=e[Fs(o[9][0].data)][0],d=pn(f.data),p=e[Fs(d[1][0].data)][0],g=Ir(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=pn(p.data);a[u]=v[3].map(function(m){return Am(m.data)}).join("")}break}}),a}function WI(e,t){var r,n,i,a,s,o,u,f,d,p,g,v,m,y,E=pn(e),k=Ir(E[1][0].data)>>>0,w=Ir(E[2][0].data)>>>0,x=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Ir(E[8][0].data)>0||!1,C,A;if((a=(i=E[7])==null?void 0:i[0])!=null&&a.data&&t!=0)C=(o=(s=E[7])==null?void 0:s[0])==null?void 0:o.data,A=(f=(u=E[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(d=E[4])==null?void 0:d[0])!=null&&p.data&&t!=1)C=(v=(g=E[4])==null?void 0:g[0])==null?void 0:v.data,A=(y=(m=E[3])==null?void 0:m[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=x?4:1,N=ax(C),F=[],I=0;I<C.length/2;++I){var D=N.getUint16(I*2,!0);D<65535&&F.push([I,D])}if(F.length!=w)throw"Expected ".concat(w," cells, found ").concat(F.length);var U=[];for(I=0;I<F.length-1;++I)U[F[I][0]]=A.subarray(F[I][1]*P,F[I+1][1]*P);return F.length>=1&&(U[F[F.length-1][0]]=A.subarray(F[F.length-1][1]*P)),{R:k,cells:U}}function $I(e,t){var r,n=pn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ir(n[7][0].data)>>>0>0?1:0:-1,a=sx(n[5],function(s){return WI(s,i)});return{nrows:Ir(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(u,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=u}),s},[])}}function XI(e,t,r){var n,i=pn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ir(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Ir(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Tt(a);var s=pn(i[4][0].data),o=N3(e,e[Fs(s[4][0].data)][0]),u=(n=s[17])!=null&&n[0]?N3(e,e[Fs(s[17][0].data)][0]):[],f=pn(s[3][0].data),d=0;f[1].forEach(function(p){var g=pn(p.data),v=e[Fs(g[2][0].data)][0],m=Ir(v.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var y=$I(e,v);y.data.forEach(function(E,k){E.forEach(function(w,x){var C=ot({r:d+k,c:x}),A=HI(w,o,u);A&&(r[C]=A)})}),d+=y.nrows})}function KI(e,t){var r=pn(t.data),n={"!ref":"A1"},i=e[Fs(r[2][0].data)],a=Ir(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return XI(e,i[0],n),n}function YI(e,t){var r,n=pn(t.data),i={name:(r=n[1])!=null&&r[0]?Am(n[1][0].data):"",sheets:[]},a=sx(n[2],Fs);return a.forEach(function(s){e[s].forEach(function(o){var u=Ir(o.meta[1][0].data);u==6e3&&i.sheets.push(KI(e,o))})}),i}function QI(e,t){var r=cx(),n=pn(t.data),i=sx(n[1],Fs);if(i.forEach(function(a){e[a].forEach(function(s){var o=Ir(s.meta[1][0].data);if(o==2){var u=YI(e,s);u.sheets.forEach(function(f,d){ux(r,f,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ag(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=zI(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var d;try{d=UI(f)}catch(p){return console.log("## "+(p.message||p))}d.forEach(function(p){a[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ir(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(u){a[u].forEach(function(f){var d=Ir(f.meta[1][0].data)>>>0;if(d==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return QI(a,o)}function qI(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function ox(e){qI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function JI(e){return Al.WS.indexOf(e)>-1?"sheet":e==Al.CS?"chart":e==Al.DS?"dialog":e==Al.MS?"macro":e&&e.length?e:"sheet"}function ZI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,JI(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function eD(e,t,r,n,i,a,s,o,u,f,d,p){try{a[n]=y0(qn(e,r,!0),t);var g=_r(e,t),v;switch(o){case"sheet":v=sI(g,t,i,u,a[n],f,d,p);break;case"chart":if(v=oI(g,t,i,u,a[n],f,d,p),!v||!v["!drawel"])break;var m=n0(v["!drawel"].Target,t),y=Sm(m),E=aF(qn(e,m,!0),y0(qn(e,y,!0),m)),k=n0(E,m),w=Sm(k);v=GR(qn(e,k,!0),k,u,y0(qn(e,w,!0),k),f,v);break;case"macro":v=lI(g,t,i,u,a[n],f,d,p);break;case"dialog":v=cI(g,t,i,u,a[n],f,d,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=v;var x=[];a&&a[n]&&ga(a[n]).forEach(function(C){var A="";if(a[n][C].Type==Al.CMNT){A=n0(a[n][C].Target,t);var P=hI(_r(e,A,!0),A,u);if(!P||!P.length)return;g3(v,P,!1)}a[n][C].Type==Al.TCMNT&&(A=n0(a[n][C].Target,t),x=x.concat(oF(_r(e,A,!0),u)))}),x&&x.length&&g3(v,x,!0,u.people||[])}catch(C){if(u.WTF)throw C}}function gi(e){return e.charAt(0)=="/"?e.slice(1):e}function tD(e,t){if(i8(),t=t||{},ox(t),vi(e,"META-INF/manifest.xml")||vi(e,"objectdata.xml"))return A3(e,t);if(vi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ag<"u"){if(e.FileIndex)return ag(e);var r=Ct.utils.cfb_new();return Vy(e).forEach(function(he){r7(r,he,u8(e,he))}),ag(r)}throw new Error("Unsupported NUMBERS file")}if(!vi(e,"[Content_Types].xml"))throw vi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vy(e),i=q7(qn(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",_r(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!_r(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(S0=[],i.sst)try{S0=dI(_r(e,gi(i.sst)),i.sst,t)}catch(he){if(t.WTF)throw he}t.cellStyles&&i.themes.length&&(u=fI(qn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=uI(_r(e,gi(i.style)),i.style,u,t))}i.links.map(function(he){try{var te=y0(qn(e,Sm(gi(he))),he);return gI(_r(e,gi(he)),te,he,t)}catch{}});var d=aI(_r(e,gi(i.workbooks[0])),i.workbooks[0],t),p={},g="";i.coreprops.length&&(g=_r(e,gi(i.coreprops[0]),!0),g&&(p=b8(g)),i.extprops.length!==0&&(g=_r(e,gi(i.extprops[0]),!0),g&&rT(g,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(g=qn(e,gi(i.custprops[0]),!0),g&&(v=iT(g,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(te){return te.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=v),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var y={};t.bookDeps&&i.calcchain&&(y=pI(_r(e,gi(i.calcchain)),i.calcchain));var E=0,k={},w,x;{var C=d.Sheets;p.Worksheets=C.length,p.SheetNames=[];for(var A=0;A!=C.length;++A)p.SheetNames[A]=C[A].name}var P=a?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");vi(e,F)||(F="xl/_rels/workbook."+P+".rels");var I=y0(qn(e,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=mI(_r(e,gi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=lF(_r(e,gi(i.people[0])),t)),I&&(I=ZI(I,d.Sheets));var D=_r(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=p.Worksheets;++E){var U="sheet";if(I&&I[E]?(w="xl/"+I[E][1].replace(/[\/]?xl\//,""),vi(e,w)||(w=I[E][1]),vi(e,w)||(w=F.replace(/_rels\/.*$/,"")+I[E][1]),U=I[E][2]):(w="xl/worksheets/sheet"+(E+1-D)+"."+P,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(p.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var O=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==E&&(O=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==p.SheetNames[E].toLowerCase()&&(O=1);if(!O)continue e}}eD(e,w,x,p.SheetNames[E],E,k,s,U,t,d,u,f)}return m={Directory:i,Workbook:d,Props:p,Custprops:v,Deps:y,Sheets:s,SheetNames:p.SheetNames,Strings:S0,Styles:f,Themes:u,SSF:Jr(ft)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(he,te){he=he.replace(/^Root Entry[\/]/,""),m.keys.push(he),m.files[he]=e.FileIndex[te]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=_r(e,gi(i.vba[0]),!0):i.defaults&&i.defaults.bin===dF&&(m.vbaraw=_r(e,"xl/vbaProject.bin",!0))),m}function rD(e,t){var r=t||{},n="Workbook",i=Ct.find(e,n);try{if(n="/!DataSpaces/Version",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KA(i.content),n="/!DataSpaces/DataSpaceMap",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=QA(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qA(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ZA(i.content)}catch{}if(n="/EncryptionInfo",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=eP(i.content);if(n="/EncryptedPackage",i=Ct.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function lx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ri(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nD(e,t){return Ct.find(e,"EncryptedPackage")?rD(e,t):vw(e,t)}function iD(e,t){var r,n=e,i=t||{};return i.type||(i.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r=f8(n,i),tD(r,i)}function Sw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cm(e.slice(r),t);default:break e}return Y0.to_workbook(e,t)}function aD(e,t){var r="",n=lx(e,t);switch(t.type){case"base64":r=ri(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ao(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=$t(r)),t.type="binary",Sw(r,t)}function sD(e,t){var r=e;return t.type=="base64"&&(r=ri(r)),r=gs.utils.decode(1200,r.slice(2),"str"),t.type="binary",Sw(r,t)}function oD(e){return e.match(/[^\x00-\x7F]/)?i0(e):e}function sg(e,t,r,n){return n?(r.type="string",Y0.to_workbook(e,r)):Y0.to_workbook(t,r)}function Fm(e,t){$6();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fm(new Uint8Array(e),(r=Jr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ll={},r.dateNF&&(Ll.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=YC(e),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=oD(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Jr(r),r.type="array",Fm(j2(n),r)}switch((i=lx(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return nD(Ct.read(n,r),r);break;case 9:if(i[1]<=8)return vw(n,r);break;case 60:return Cm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return OA(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?iD(n,r):sg(e,n,r,a);case 239:return i[3]===60?Cm(n,r):sg(e,n,r,a);case 255:if(i[1]===254)return sD(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return w0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return w0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return p3.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return dP.to_workbook(n,r);break;case 10:case 13:case 32:return aD(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return RA.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?p3.to_workbook(n,r):sg(e,n,r,a)}function lD(e,t,r,n,i,a,s,o){var u=Zr(r),f=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var m=s?e[r][v]:e[n[v]+u];if(m===void 0||m.t===void 0){if(f===void 0)continue;a[v]!=null&&(g[a[v]]=f);continue}var y=m.v;switch(m.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[v]!=null){if(y==null)if(m.t=="e"&&y===null)g[a[v]]=null;else if(f!==void 0)g[a[v]]=f;else if(d&&y===null)g[a[v]]=null;else continue;else g[a[v]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?y:Wa(m,y,o);y!=null&&(p=!1)}}return{row:g,isempty:p}}function Nm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":u=fr(d);break;case"number":u=fr(e["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var p=Zr(u.s.r),g=[],v=[],m=0,y=0,E=Array.isArray(e),k=u.s.r,w=0,x={};E&&!e[k]&&(e[k]=[]);var C=f.skipHidden&&e["!cols"]||[],A=f.skipHidden&&e["!rows"]||[];for(w=u.s.c;w<=u.e.c;++w)if(!(C[w]||{}).hidden)switch(g[w]=Rr(w),r=E?e[k][w]:e[g[w]+p],n){case 1:a[w]=w-u.s.c;break;case 2:a[w]=g[w];break;case 3:a[w]=f.header[w-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Wa(r,null,f),y=x[s]||0,!y)x[s]=1;else{do o=s+"_"+y++;while(x[o]);x[s]=y,x[o]=1}a[w]=o}for(k=u.s.r+i;k<=u.e.r;++k)if(!(A[k]||{}).hidden){var P=lD(e,u,k,g,n,a,E,f);(P.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[m++]=P.row)}return v.length=m,v}var R3=/"/g;function cD(e,t,r,n,i,a,s,o){for(var u=!0,f=[],d="",p=Zr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=o.dense?(e[r]||[])[g]:e[n[g]+p];if(v==null)d="";else if(v.v!=null){u=!1,d=""+(o.rawNumbers&&v.t=="n"?v.v:Wa(v,null,o));for(var m=0,y=0;m!==d.length;++m)if((y=d.charCodeAt(m))===i||y===a||y===34||o.forceQuotes){d='"'+d.replace(R3,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(u=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(R3,'""')+'"')):d="";f.push(d)}return o.blankrows===!1&&u?null:f.join(s)}function kw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=fr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(g[m]||{}).hidden||(p[m]=Rr(m));for(var y=0,E=i.s.r;E<=i.e.r;++E)(v[E]||{}).hidden||(d=cD(e,i,E,p,s,u,a,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((y++?o:"")+d)));return delete n.dense,r.join("")}function uD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kw(e,t);return r}function fD(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=fr(e["!ref"]),a="",s=[],o,u=[],f=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Rr(o);for(var d=i.s.r;d<=i.e.r;++d)for(a=Zr(d),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=f?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Ew(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?En(n.origin):n.origin;s=u.r,o=u.c}var f,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var p=fr(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),s==-1&&(s=p.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var g=n.header||[],v=0;t.forEach(function(y,E){ga(y).forEach(function(k){(v=g.indexOf(k))==-1&&(g[v=g.length]=k);var w=y[k],x="z",C="",A=ot({c:o+v,r:s+E+i});f=Z0(a,A),w&&typeof w=="object"&&!(w instanceof Date)?a[A]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=An(w)),C=n.dateNF||ft[14]):w===null&&n.nullError&&(x="e",w=0),f?(f.t=x,f.v=w,delete f.w,delete f.R,C&&(f.z=C)):a[A]=f={t:x,v:w},C&&(f.z=C))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var m=Zr(s);if(i)for(v=0;v<g.length;++v)a[Rr(v+o)+m]={t:"s",v:g[v]};return a["!ref"]=Tt(d),a}function dD(e,t){return Ew(null,e,t)}function Z0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=En(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Z0(e,ot(t)):Z0(e,ot({r:t,c:r||0}))}function hD(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function cx(){return{SheetNames:[],Sheets:{}}}function ux(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(qR(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function pD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hD(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function gD(e,t){return e.z=t,e}function Cw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mD(e,t,r){return Cw(e,"#"+t,r)}function xD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vD(e,t,r,n){for(var i=typeof t!="string"?t:fr(t),a=typeof t=="string"?t:Tt(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var u=Z0(e,s,o);u.t="n",u.F=a,delete u.v,s==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var og={encode_col:Rr,encode_row:Zr,encode_cell:ot,encode_range:Tt,decode_col:Y2,decode_row:K2,split_cell:N7,decode_cell:En,decode_range:ic,format_cell:Wa,sheet_add_aoa:F8,sheet_add_json:Ew,sheet_add_dom:yw,aoa_to_sheet:ac,json_to_sheet:dD,table_to_sheet:_w,table_to_book:OI,sheet_to_csv:kw,sheet_to_txt:uD,sheet_to_json:Nm,sheet_to_html:bI,sheet_to_formulae:fD,sheet_to_row_object_array:Nm,sheet_get_cell:Z0,book_new:cx,book_append_sheet:ux,book_set_sheet_visibility:pD,cell_set_number_format:gD,cell_set_hyperlink:Cw,cell_set_internal_link:mD,cell_add_comment:xD,sheet_set_array_formula:vD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fx=class Rm{static async parseCSVFile(t){var r;try{const n=(r=t.name.split(".").pop())==null?void 0:r.toLowerCase();let i;return n==="xlsx"||n==="xls"?i=await this.readXLSXFileContent(t):i=await this.readFileContent(t),this.parseCSVContent(i)}catch(n){return{success:!1,pins:[],warnings:[],errors:[n.message],format:this.getDefaultFormat()}}}static async parseCSVContent(t){console.log(" Starting ultra-fast CSV parsing...");const r=this.tryVersalPatternMatching(t);if(r!==null)return await r;console.log(" About to try Intel/Altera pattern matching...");const n=this.tryIntelAlteraPatternMatching(t);return n!==null?(console.log(" Intel/Altera pattern detected, processing..."),await n):(console.log(" Versal and Intel/Altera patterns not found, using generic approach..."),this.parseCSVContentGeneric(t))}static async parseCSVContentGeneric(t){console.log(" Fallback to generic CSV processing...");const r=t.split(`
`).map(v=>v.trim()).filter(Boolean);console.log(` Processing ${r.length} lines with generic approach`);let n=-1,i=-1;for(let v=0;v<Math.min(1e3,r.length);v++){const m=r[v];if(!m||!m.includes(","))continue;const y=m.toLowerCase();if(y.includes("copyright")||y.includes("license")||y.includes("xilinx")||m.startsWith("#"))continue;const E=this.parseCSVLine(m);if(E.length>=3&&E.some(w=>{const x=w.toLowerCase().trim();return x==="pin"||x==="ball"||x.includes("pin")})){n=v,i=v+1;break}}if(n===-1)return{success:!1,pins:[],warnings:[],errors:["Pin column not found or empty"],format:this.getDefaultFormat()};const a=r[n];console.log(` Found header at line ${n+1}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;for(let v=i;v<r.length;v++){const m=r[v];if(!m||m.replace(/,/g,"").trim()==="")continue;const y=this.parseCSVLine(m);try{const E=this.parsePin(y,o,v+1);E&&(u.push(E),g++)}catch(E){d.length<20&&d.push(`Line ${v+1}: ${E.message}`)}p++,p%1e3===0&&console.log(` Generic processing: ${p} lines, ${g} pins`)}return console.log(` Generic processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static tryVersalPatternMatching(t){console.log(" Trying ultra-fast Versal pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(7e3,r.length);a++){const s=r[a];if(a%1e3===0&&console.log(` Pattern matching line ${a+1}...`),s&&s.toLowerCase().startsWith("pin,pin name,")){n=a,i=a+1,console.log(` Found Versal header at line ${a+1}: ${s.substring(0,100)}`);break}if(s&&s.toLowerCase().startsWith("pin,")&&s.toLowerCase().includes("pin name")&&s.split(",").length>=3){n=a,i=a+1,console.log(` Found Versal header variant at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Versal pattern not found"),null):this.parseCSVWithKnownHeader(r,n,i)}static tryIntelAlteraPatternMatching(t){console.log(" Trying Intel/Altera pattern matching...");const r=t.split(`
`).map(a=>a.trim());console.log(` Total lines: ${r.length}`);let n=-1,i=-1;for(let a=0;a<Math.min(20,r.length);a++){const s=r[a];if(s&&s.toLowerCase().includes("pin name/function")){n=a,i=a+1,console.log(` Found Intel/Altera header at line ${a+1}: ${s.substring(0,100)}`);break}}return n===-1?(console.log(" Intel/Altera pattern not found"),null):this.parseIntelAlteraCSV(r,n,i)}static async parseIntelAlteraCSV(t,r,n){var f,d,p,g,v,m,y,E,k;console.log(" Processing Intel/Altera CSV format...");const i=[],a=[],s=[];let o=0,u=0;for(let w=n;w<t.length;w++){const x=t[w];if(!x||x.replace(/,/g,"").trim()==="")continue;const C=this.parseCSVLine(x);if(C.length>=6){const A=(f=C[0])==null?void 0:f.trim(),P=(d=C[1])==null?void 0:d.trim(),N=(p=C[6])==null?void 0:p.trim(),F=(g=C[7])==null?void 0:g.trim();if(!A||!N||!F)continue;try{const I={row:N,col:parseInt(F,10)||1},D=this.gridToPosition(I),U={id:crypto.randomUUID(),pinNumber:A,pinName:P||A,signalName:((v=C[2])==null?void 0:v.trim())||"",direction:this.parseDirection(C[3]),pinType:this.determinePinType(P||A),voltage:((m=C[4])==null?void 0:m.trim())||"3.3V",packagePin:((y=C[5])==null?void 0:y.trim())||A,position:D,gridPosition:I,isAssigned:!!((E=C[2])!=null&&E.trim()),bank:((k=C[8])==null?void 0:k.trim())||"NA"};i.push(U),o++}catch(I){s.length<20&&s.push(`Line ${w+1}: ${I.message}`)}}u++,u%1e3===0&&console.log(` Intel/Altera processing: ${u} lines, ${o} pins`)}return console.log(` Intel/Altera processing complete: ${o} pins found from ${u} lines`),{success:i.length>0,pins:i,warnings:a,errors:s,format:{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:["Pin","Pin Name","Signal","Direction","Voltage","Package_Pin","Row","Col","Bank","Type"]}}}static async parseCSVWithKnownHeader(t,r,n){console.log(" Fast processing with known header...");const i=t.slice(n).filter(m=>!m||m.trim()===""?!1:m.replace(/,/g,"").trim()!=="");console.log(` Found ${i.length} data lines after header`);const a=t[r];console.log(` Using header line ${r}:`,a);const s=this.detectFormat(a),o=this.getColumnMapping(s,a);console.log(" Format:",s),console.log(" Mapping:",o);const u=[],f=[],d=[];let p=0,g=0;const v=1e3;for(let m=0;m<i.length;m++){const y=i[m];if(!y||y.replace(/,/g,"").trim()==="")continue;const E=this.parseCSVLine(y);try{const k=this.parsePin(E,o,m+n+1);k&&(u.push(k),g++)}catch(k){d.length<20&&d.push(`Line ${m+n+1}: ${k.message}`)}p++,p%v===0&&console.log(` Processed ${p}/${i.length} lines, found ${g} pins`)}return console.log(` Ultra-fast processing complete: ${g} pins found from ${p} lines`),{success:u.length>0,pins:u,warnings:f,errors:d,format:s}}static async readFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;return r((s=a.target)==null?void 0:s.result)},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static async readXLSXFileContent(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=Fm(o,{type:"binary"});console.log(" XLSX Workbook info:",{sheetNames:u.SheetNames,totalSheets:u.SheetNames.length});const f=u.SheetNames[0],d=u.Sheets[f],p=og.decode_range(d["!ref"]||"A1");console.log(" Sheet range:",{sheetName:f,range:d["!ref"],rows:p.e.r-p.s.r+1,cols:p.e.c-p.s.c+1});const g=og.sheet_to_json(d,{header:1,raw:!1});console.log(" Raw data sample (first 15 rows):",g.slice(0,15)),console.log(" Total data rows:",g.length);const v=g.filter(y=>y&&Array.isArray(y)&&y.some(E=>E&&E.toString().trim()));console.log(" Non-empty rows:",v.length);const m=Rm.detectIntelAlteraFormat(g);if(console.log(" Format detection result:",m?"Intel/Altera":"Standard CSV"),m){console.log(" Intel/Altera format detected, using special processing");const y=Rm.processIntelAlteraXLSX(g);r(y)}else{const y=og.sheet_to_csv(d,{strip:!1}),E=y.split(`
`).filter(k=>k.trim());console.log(" CSV conversion result:",{originalRows:p.e.r-p.s.r+1,csvLines:E.length,firstTenLines:E.slice(0,10),linesWithCommas:E.filter(k=>k.includes(",")).length}),r(y)}}catch(o){console.error(" XLSX parsing error:",o),n(new Error(`Failed to parse XLSX file: ${o.message}`))}},i.onerror=()=>n(new Error("Failed to read XLSX file")),i.readAsBinaryString(t)})}static detectFormat(t){const r=this.parseCSVLine(t).map(a=>a.trim());return this.XILINX_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=4?{type:"xilinx",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.XILINX_HEADERS}:this.GENERIC_HEADERS.filter(a=>r.some(s=>s.toLowerCase().includes(a.toLowerCase()))).length>=3?{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}:{type:"generic",hasHeader:!1,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static getColumnMapping(t,r){const n=this.parseCSVLine(r).map(s=>s.trim().toLowerCase());console.log(" Detected headers:",n);const i=s=>{for(const o of s){const u=n.findIndex(f=>f.includes(o.toLowerCase()));if(u!==-1)return console.log(` Found column "${o}" at index ${u}: "${n[u]}"`),u}return-1},a={pin:i(["pin","pin_number","pin number","package pin","package_pin","ball","ball_id"]),pinName:i(["pin name","pin_name","name","ball name","ball_name"]),signalName:i(["signal","signal_name","net","net name","signal name"]),direction:i(["direction","dir","type","i/o type","io_type"]),voltage:i(["voltage","volt","io_standard","io standard","vccio"]),bank:i(["bank","bank_number","bank number","io bank"]),memoryByteGroup:i(["memory byte group","byte_group","mbg","memory_byte_group"]),ioType:i(["i/o type","io_type","type","function","io_standard"])};return console.log(" Column mapping result:",a),a}static parsePin(t,r,n){var f,d,p,g,v,m,y;if(t.length===0||r.pin===-1||!t[r.pin])return null;const i=(f=t[r.pin])==null?void 0:f.trim();if(!i||i==="NA"||i===""||i.length>10||i.toLowerCase().includes("device")||!/^[A-Za-z0-9]+$/.test(i))return null;const a=((d=t[r.pinName])==null?void 0:d.trim())||i,s=this.parseGridPosition(i);if(!s)return null;const o=this.gridToPosition(s),u={id:crypto.randomUUID(),pinNumber:i,pinName:a,signalName:((p=t[r.signalName||-1])==null?void 0:p.trim())||"",direction:this.parseDirection(t[r.direction||-1]),pinType:this.determinePinType(a),voltage:((g=t[r.voltage||-1])==null?void 0:g.trim())||"3.3V",packagePin:i,position:o,gridPosition:s,isAssigned:!1,bank:(v=t[r.bank||-1])==null?void 0:v.trim(),memoryByteGroup:(m=t[r.memoryByteGroup||-1])==null?void 0:m.trim(),ioType:(y=t[r.ioType||-1])==null?void 0:y.trim()};return u.signalName&&(u.isAssigned=!0),u}static parseGridPosition(t){const r=t.match(/^([A-Z]+)(\d+)$/);return r?{row:r[1],col:parseInt(r[2],10)}:null}static gridToPosition(t){const r=Is(t.row),n=88;return{x:Math.round((t.col-1)*n),y:Math.round(r*n)}}static parseDirection(t){if(!t)return"InOut";const r=t.toLowerCase().trim();return r.includes("input")||r.includes("in")?"Input":r.includes("output")||r.includes("out")?"Output":r.includes("inout")||r.includes("bidirectional")?"InOut":r.includes("power")||r.includes("vcc")?"Power":r.includes("ground")||r.includes("gnd")?"Ground":r.includes("clock")||r.includes("clk")?"Clock":r.includes("reset")||r.includes("rst")?"Reset":"InOut"}static determinePinType(t){const r=t.toLowerCase();return r.includes("io_l")||r.includes("io_")||r.startsWith("io")?"IO":r.includes("config")||r.includes("tck")||r.includes("tdi")||r.includes("tdo")||r.includes("tms")||r.includes("done")?"CONFIG":r.includes("vcc")||r.includes("vdd")?"POWER":r.includes("gnd")||r.includes("vss")?"GROUND":r.includes("mgt")||r.includes("gt")?"MGT":r.includes("clk")||r.includes("clock")?"CLOCK":r.includes("adc")||r.includes("dac")?"ADC":r.includes("vref")||r.includes("special")?"SPECIAL":r.includes("nc")||r===""?"NC":r.includes("rsvd")||r.includes("reserved")?"RESERVED":"IO"}static parseCSVLine(t){const r=[];let n="",i=!1;for(let a=0;a<t.length;a++){const s=t[a];s==='"'?i=!i:s===","&&!i?(r.push(n.trim()),n=""):n+=s}return r.push(n.trim()),r}static getDefaultFormat(){return{type:"generic",hasHeader:!0,commentPrefix:"#",delimiter:",",expectedColumns:this.GENERIC_HEADERS}}static createPackageFromPins(t,r="Unknown"){if(t.length===0)return{id:crypto.randomUUID(),name:r,device:"Unknown",packageType:"Unknown",dimensions:{rows:0,cols:0},pins:[],totalPins:0};const n=Math.max(...t.map(a=>Is(a.gridPosition.row)))+1,i=Math.max(...t.map(a=>a.gridPosition.col));return{id:crypto.randomUUID(),name:r,device:r.split("-")[0]||"Unknown",packageType:r.split("-")[1]||"Unknown",dimensions:{rows:n,cols:i},pins:t,totalPins:t.length}}static detectIntelAlteraFormat(t){console.log(" Detecting Intel/Altera format...");for(let r=0;r<Math.min(10,t.length);r++){const n=t[r];if(n&&Array.isArray(n)&&n.length>=4){const i=n.join(",").toLowerCase();if(console.log(`Row ${r}: "${i.substring(0,100)}..."`),i.includes("pin name/function")&&(i.includes("bank number")||i.includes("bank"))&&(i.includes("vref")||i.includes("configuration function")))return console.log(" Intel/Altera format detected!"),!0}}return console.log(" Intel/Altera format not detected"),!1}static processIntelAlteraXLSX(t){console.log(" Processing Intel/Altera XLSX format...");let r=-1,n=-1,i=-1,a=-1;for(let u=0;u<Math.min(10,t.length);u++){const f=t[u];if(f&&Array.isArray(f)&&f.length>=4){const d=f.map(p=>p?p.toString().toLowerCase().trim():"");if(d.some(p=>p.includes("pin name/function"))){r=u;for(let p=0;p<d.length;p++){const g=d[p];p===0&&(g.includes("v")||g.match(/^[a-z]\d+$/)||g.length<=3)?n=p:g.includes("pin name/function")?i=p:(g.includes("bank number")||g.includes("bank"))&&(a=p)}break}}}if(r===-1)return console.warn(" Intel/Altera header not found, fallback to standard processing"),"";console.log(" Intel/Altera format detected:",{headerRowIndex:r,pinNumberCol:n,pinNameCol:i,bankCol:a});const s=[];let o=0;s.push("Pin,Pin Name,Signal,Direction,Voltage,Package_Pin,Row,Col,Bank,Type");for(let u=r+1;u<t.length;u++){const f=t[u];if(!f||!Array.isArray(f)||f.length<4)continue;const d=f[n]?f[n].toString().trim():"",p=f[i]?f[i].toString().trim():"",g=f[a]?f[a].toString().trim():"";if(o<10&&console.log(` Processing pin ${o+1}: Number="${d}", Name="${p}", Bank="${g}"`),!d||d===""||p.toLowerCase().includes("nc")||p.toLowerCase().includes("no connect")){o<10&&console.log(` Skipping NC/empty pin: "${d}" / "${p}"`);continue}if(!d.match(/^[A-Z0-9_]+\d*$/i)){o<10&&console.log(` Skipping invalid pin format: "${d}"`);continue}let v="IO";(p.toLowerCase().includes("power")||p.toLowerCase().includes("vcc")||p.toLowerCase().includes("gnd"))&&(v="POWER");const m=d.match(/^([A-Z])(\d+)$/i),y=m?m[1].toUpperCase():"A",E=m?m[2]:"1",k=[d,p||d,"","","",d,y,E,g||"NA",v].join(",");s.push(k),o++}return console.log(` Intel/Altera processing complete: ${o} pins processed from ${t.length-r-1} data rows`),s.join(`
`)}};fx.XILINX_HEADERS=["Pin","Pin Name","Memory Byte Group","Bank","VCCAUX Group","Super Logic Region","I/O Type","No-Connect"];fx.GENERIC_HEADERS=["Pin","Signal","Direction","Voltage","Package_Pin","Row","Col"];let zc=fx;class Na{static exportToXDC(t,r){const n=t.filter(s=>s.isAssigned&&s.signalName.trim()!==""),i=["# Xilinx Design Constraints (XDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),a=n.map(s=>{const o=[];if(o.push(`set_property PACKAGE_PIN ${s.pinNumber} [get_ports ${s.signalName}]`),s.voltage){const u=s.voltage==="3.3V"?"LVCMOS33":s.voltage==="1.8V"?"LVCMOS18":s.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";o.push(`set_property IOSTANDARD ${u} [get_ports ${s.signalName}]`)}return(s.direction==="Output"||s.direction==="InOut")&&o.push(`set_property DRIVE 12 [get_ports ${s.signalName}]`),o.join(`
`)}).join(`

`);return i+a}static exportToSDC(t,r){const n=t.filter(o=>o.isAssigned&&o.signalName.trim()!==""),i=o=>o.replace(/[^\w_]/g,"_").replace(/^(\d)/,"sig_$1").replace(/_{2,}/g,"_").replace(/^_|_$/g,""),a=["# Synopsys Design Constraints (SDC) File","# Generated by FPGA Pin Planner",`# Date: ${new Date().toLocaleDateString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"#",`# Total pins assigned: ${n.length}`,""].join(`
`),s=n.map(o=>{const u=[],f=i(o.signalName);if(u.push(`set_location_assignment PIN_${o.pinNumber} -to ${f}`),o.voltage){const d=o.voltage==="3.3V"?"LVCMOS33":o.voltage==="1.8V"?"LVCMOS18":o.voltage==="2.5V"?"LVCMOS25":"LVCMOS33";u.push(`set_instance_assignment -name IO_STANDARD "${d}" -to ${f}`)}return(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name CURRENT_STRENGTH_NEW "12mA" -to ${f}`),(o.direction==="Output"||o.direction==="InOut")&&u.push(`set_instance_assignment -name SLEW_RATE 1 -to ${f}`),u.join(`
`)}).join(`

`);return a+s}static exportToCSV(t){const r=["Pin Number","Pin Name","Signal Name","Direction","Pin Type","Voltage","Bank","I/O Type","Is Assigned"],n=t.map(i=>[i.pinNumber,i.pinName,i.signalName||"",i.direction,i.pinType,i.voltage,i.bank||"",i.ioType||"",i.isAssigned?"Yes":"No"]);return[r,...n].map(i=>i.map(a=>`"${a}"`).join(",")).join(`
`)}static exportReport(t,r){const n=t.filter(o=>o.isAssigned),i=t.filter(o=>!o.isAssigned),a=new Map;return t.forEach(o=>{const u=o.bank||"Unknown";a.has(u)||a.set(u,{assigned:0,total:0});const f=a.get(u);f.total++,o.isAssigned&&f.assigned++}),["# FPGA Pin Assignment Report",`# Generated: ${new Date().toLocaleString()}`,`# Device: ${(r==null?void 0:r.device)||"Unknown"}`,`# Package: ${(r==null?void 0:r.packageType)||"Unknown"}`,"","## Summary",`- Total Pins: ${t.length}`,`- Assigned Pins: ${n.length}`,`- Unassigned Pins: ${i.length}`,`- Assignment Rate: ${(n.length/t.length*100).toFixed(1)}%`,"","## Bank Statistics",...Array.from(a.entries()).map(([o,u])=>`- Bank ${o}: ${u.assigned}/${u.total} (${(u.assigned/u.total*100).toFixed(1)}%)`),"","## Assigned Pins",...n.map(o=>`${o.pinNumber.padEnd(8)} | ${o.signalName.padEnd(20)} | Bank ${(o.bank||"N/A").padEnd(3)} | ${o.pinType}`),"","## Pin Type Distribution",...Object.entries(t.reduce((o,u)=>(o[u.pinType]=(o[u.pinType]||0)+1,o),{})).map(([o,u])=>`- ${o}: ${u}`)].join(`
`)}static downloadFile(t,r,n="text/plain"){const i=new Blob([t],{type:n}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}}class Gt{static getDifferentialPairType(t){const r=t.toLowerCase();if(r.endsWith("_p"))return"positive";if(r.endsWith("_n"))return"negative";if(r.endsWith("+"))return"positive";if(r.endsWith("-"))return"negative";if(r.endsWith("p")&&!r.endsWith("_p")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"positive"}if(r.endsWith("n")&&!r.endsWith("_n")){const i=r.charAt(r.length-2);if(/[\d_-]/.test(i))return"negative"}const n=r.match(/^(.+_l\d+)([pn])(_.*)?$/);if(n){const i=n[2];if(i==="p")return"positive";if(i==="n")return"negative"}return null}static getPairPinName(t){const r=t.toLowerCase(),n=t;if(r.endsWith("_p"))return n.slice(0,-2)+"_N";if(r.endsWith("_n"))return n.slice(0,-2)+"_P";if(r.endsWith("+"))return n.slice(0,-1)+"-";if(r.endsWith("-"))return n.slice(0,-1)+"+";if(r.endsWith("p")&&!r.endsWith("_p")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"N"}if(r.endsWith("n")&&!r.endsWith("_n")){const s=r.charAt(r.length-2);if(/[\d_-]/.test(s))return n.slice(0,-1)+"P"}const i=n.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const s=i[1],o=i[2].toUpperCase(),u=i[3]||"";if(o==="P")return s+"N"+u;if(o==="N")return s+"P"+u}const a=r.match(/^(.+?)(\d+)$/);if(a){const s=a[1],o=parseInt(a[2]),u=o%2===0?o+1:o-1;return n.substring(0,s.length)+u}return null}static findPairPin(t,r){const n=this.getPairPinName(t.pinName);if(n){const a=r.find(s=>s.pinName.toLowerCase()===n.toLowerCase()&&s.bank===t.bank);if(a)return a}const i=t.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(i){const a=i[1],o=i[2].toUpperCase()==="P"?"N":"P",u=r.find(f=>{if(f.bank!==t.bank)return!1;const d=f.pinName.match(/^(.+_L\d+)([PN])(_.*)?$/i);if(d){const p=d[1],g=d[2].toUpperCase();return p.toLowerCase()===a.toLowerCase()&&g===o}return!1});if(u)return u}if(t.signalName){const a=this.getPairPinName(t.signalName);if(a){const s=r.find(o=>o.signalName&&o.signalName.toLowerCase()===a.toLowerCase()&&o.bank===t.bank);if(s)return s}}return null}static isDifferentialPin(t){return!!(this.getDifferentialPairType(t.pinName)!==null||t.signalName&&this.getDifferentialPairType(t.signalName)!==null)}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);const n=r.match(/^(.+?)(\d+)$/);return n?t.substring(0,n[1].length):t}static getDifferentialPriority(t){const r=this.getDifferentialPairType(t.pinName),n=t.signalName?this.getDifferentialPairType(t.signalName):null,i=r||n;return i==="positive"?1:i==="negative"?2:3}}const yD=({pin:e,isSelected:t,onSelect:r,onAssignSignal:n,isPairPin:i=!1,isDifferentialPairPartner:a=!1})=>{const s=d=>{n(e.id,d.target.value)},o=d=>({IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999"})[d]||"#666666",u=Gt.getDifferentialPairType(e.pinName)||(e.signalName?Gt.getDifferentialPairType(e.signalName):null),f=Gt.isDifferentialPin(e);return T.jsxs("div",{className:`pin-item ${t?"selected":""}`,onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",padding:"8px 12px",margin:"2px 0",backgroundColor:t?"#444":a?"#3d4852":i?"#2d3748":"#2a2a2a",borderRadius:"4px",cursor:"pointer",border:`2px solid ${t?"#4A90E2":a?"#f59e0b":i?"#9333ea":"transparent"}`,position:"relative"},children:[f&&T.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",fontSize:"10px",color:u==="positive"?"#22c55e":"#ef4444",fontWeight:"bold"},title:`Differential ${u==="positive"?"Positive":"Negative"} Pin`,children:u==="positive"?"+":"-"}),a&&T.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"12px",color:"#f59e0b",fontWeight:"bold"},title:"Differential Pair Partner of Selected Pin",children:""}),i&&!a&&T.jsx("div",{style:{position:"absolute",top:"4px",left:"4px",fontSize:"10px",color:"#9333ea",fontWeight:"bold"},title:"Differential Pair Pin",children:""}),T.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[T.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:o(e.pinType),marginRight:"8px",flexShrink:0}}),T.jsx("div",{style:{minWidth:"60px",fontFamily:"monospace",fontSize:"12px",color:"#ccc"},children:e.pinNumber}),T.jsx("div",{style:{minWidth:"120px",fontSize:"11px",color:"#999",marginRight:"8px",flex:1},children:e.pinName}),T.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:e.isAssigned?"#4AE24A":"#666",marginLeft:"8px",flexShrink:0}})]}),T.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:T.jsx("input",{type:"text",value:e.signalName,onChange:s,placeholder:"Signal name",onClick:d=>d.stopPropagation(),style:{flex:1,padding:"4px 8px",fontSize:"12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff"}})}),e.bank&&T.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"11px",color:"#666"},children:[T.jsx("span",{style:{marginRight:"4px"},children:""}),T.jsxs("span",{children:["Bank ",e.bank]})]})]})},_D=({isOpen:e,onClose:t,onExport:r,pins:n,currentPackage:i})=>{const[a,s]=_e.useState("xdc"),[o,u]=_e.useState(!1);if(!e)return null;const f=[{value:"xdc",label:"XDC (Xilinx)",description:"Xilinx Design Constraints format for Vivado and ISE",icon:"",example:"set_property PACKAGE_PIN A1 [get_ports clk]"},{value:"sdc",label:"SDC (Intel/Altera)",description:"Synopsys Design Constraints format for Quartus",icon:"",example:"set_location_assignment PIN_A1 -to clk"}],d=f.find(m=>m.value===a),p=n.filter(m=>m.isAssigned&&m.signalName.trim()!=="").length,g=()=>{r(a),t()},v=()=>{if(!o)return null;const m=n.filter(y=>y.isAssigned&&y.signalName.trim()!=="").slice(0,3);return a==="xdc"?Na.exportToXDC(m,i):Na.exportToSDC(m,i)};return T.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:T.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"8px",padding:"24px",width:"500px",maxHeight:"80vh",overflow:"auto",color:"white"},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[T.jsx("h3",{style:{margin:0,fontSize:"18px"},children:"Export Constraint File"}),T.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#ccc",fontSize:"20px",cursor:"pointer",padding:"4px"},children:""})]}),T.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#ccc"},children:[p," assigned pins will be exported"]}),T.jsxs("div",{style:{marginBottom:"20px"},children:[T.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"bold"},children:"Choose constraint file format:"}),f.map(m=>T.jsxs("div",{style:{border:`2px solid ${a===m.value?"#007acc":"#444"}`,borderRadius:"6px",padding:"12px",marginBottom:"8px",cursor:"pointer",backgroundColor:a===m.value?"#1a4c80":"#333",transition:"all 0.2s ease"},onClick:()=>s(m.value),children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[T.jsx("span",{style:{fontSize:"16px",marginRight:"8px"},children:m.icon}),T.jsx("span",{style:{fontWeight:"bold",fontSize:"16px"},children:m.label})]}),T.jsx("div",{style:{fontSize:"13px",color:"#ccc",marginBottom:"6px"},children:m.description}),T.jsxs("div",{style:{fontSize:"12px",fontFamily:"monospace",color:"#bbb",backgroundColor:"#1a1a1a",padding:"4px 8px",borderRadius:"3px"},children:["Example: ",m.example]})]},m.value))]}),p>0&&T.jsxs("div",{style:{marginBottom:"20px"},children:[T.jsx("button",{onClick:()=>u(!o),style:{backgroundColor:"#444",border:"1px solid #666",borderRadius:"4px",color:"white",padding:"6px 12px",cursor:"pointer",fontSize:"12px"},children:o?"Hide Preview":"Show Preview"}),o&&T.jsx("div",{style:{marginTop:"8px",backgroundColor:"#1a1a1a",border:"1px solid #444",borderRadius:"4px",padding:"12px",maxHeight:"200px",overflow:"auto"},children:T.jsx("pre",{style:{margin:0,fontSize:"11px",color:"#ddd",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:v()})})]}),T.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[T.jsx("button",{onClick:t,style:{backgroundColor:"#666",border:"1px solid #888",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),T.jsxs("button",{onClick:g,disabled:p===0,style:{backgroundColor:p>0?"#007acc":"#555",border:"1px solid #007acc",borderRadius:"4px",color:"white",padding:"8px 16px",cursor:p>0?"pointer":"not-allowed",fontSize:"14px",opacity:p>0?1:.6},children:["Export ",d==null?void 0:d.label]})]})]})})},lg=[{id:"overview",title:"Overview",icon:"",description:"All pins with key information",showSearch:!0,showFilters:!0,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}]},{id:"signals",title:"Signals",icon:"",description:"Assigned signal information",showSearch:!0,showFilters:!0,columns:[{key:"signalName",title:"Signal Name",width:140,editable:!0,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"direction",title:"Direction",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>!!(e.signalName&&e.signalName.trim()!==""),sort:(e,t)=>(e.signalName||"").localeCompare(t.signalName||"")},{id:"bankGroups",title:"Bank Stats",icon:"",description:"Dynamic bank groups statistics and analysis",showSearch:!1,showFilters:!1,isCustomComponent:!0,columns:[],filter:()=>!0,sort:()=>0},{id:"banks",title:"Banks",icon:"",description:"Pin organization by I/O banks",showSearch:!0,showFilters:!0,columns:[{key:"bank",title:"Bank",width:50,sortable:!0},{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"voltage",title:"Voltage",width:70,editable:!0,sortable:!0},{key:"ioType",title:"I/O Type",width:80,sortable:!0},{key:"ioStandard",title:"I/O Standard",width:100,editable:!0,sortable:!0},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>!!(e.bank&&e.bank.trim()!==""),sort:(e,t)=>{const r=parseInt(e.bank||"999"),n=parseInt(t.bank||"999");return r-n}},{id:"differential",title:"Diff Pairs",icon:"",description:"Differential pair management",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"differentialPair",title:"Pair Name",width:100,sortable:!0,customRender:(e,t)=>t.differentialPair?`${t.differentialPair.pair} (${t.differentialPair.type})`:"-"},{key:"signalName",title:"Signal",width:120,editable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"comment",title:"Comment",width:160,editable:!0}],filter:e=>e.differentialPair!==void 0,sort:(e,t)=>{var i,a;const r=((i=e.differentialPair)==null?void 0:i.pair)||"",n=((a=t.differentialPair)==null?void 0:a.pair)||"";return r.localeCompare(n)}},{id:"comments",title:"Comments",icon:"",description:"All pins with user comments",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"signalName",title:"Signal",width:100,sortable:!0},{key:"comment",title:"Comment",width:300,editable:!0},{key:"commentTimestamp",title:"Modified",width:120,render:"datetime",sortable:!0},{key:"commentAuthor",title:"Author",width:80,sortable:!0}],filter:e=>!!(e.comment&&e.comment.trim()!==""),sort:(e,t)=>{var i,a;const r=((i=e.commentTimestamp)==null?void 0:i.getTime())||0;return(((a=t.commentTimestamp)==null?void 0:a.getTime())||0)-r}},{id:"power",title:"Power",icon:"",description:"Power and ground pins",showSearch:!0,showFilters:!1,columns:[{key:"pinNumber",title:"Pin#",width:60,sortable:!0},{key:"pinName",title:"Pin Name",width:120,sortable:!0},{key:"pinType",title:"Type",width:80,sortable:!0},{key:"voltage",title:"Voltage",width:70,sortable:!0},{key:"bank",title:"Bank",width:50,sortable:!0},{key:"comment",title:"Comment",width:180,editable:!0}],filter:e=>e.pinType==="POWER"||e.pinType==="GROUND"||e.direction==="Power"||e.direction==="Ground",sort:(e,t)=>e.pinNumber.localeCompare(t.pinNumber)}],wD=({value:e,onSave:t,options:r,editable:n=!1,placeholder:i="",className:a="",allowCustomValue:s=!1,getDisplayValue:o})=>{const[u,f]=_e.useState(!1),[d,p]=_e.useState(e||""),g=_e.useRef(null),v=()=>{d!==e&&t(d),f(!1)},m=()=>{p(e||""),f(!1)},y=k=>{k.key==="Enter"?(k.preventDefault(),v()):k.key==="Escape"&&(k.preventDefault(),m())};if(_e.useEffect(()=>{u&&g.current&&g.current.focus()},[u]),_e.useEffect(()=>{p(e||"")},[e]),!n){const k=o?o(e):e;return T.jsx("span",{className:`table-cell-readonly ${a}`,children:k||"-"})}if(u)return T.jsxs("select",{ref:g,value:d,onChange:k=>p(k.target.value),onBlur:v,onKeyDown:y,className:`table-cell-select ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"},children:[i&&T.jsx("option",{value:"",disabled:!0,children:i}),r.map(k=>T.jsx("option",{value:k,children:o?o(k):k},k)),s&&d&&!r.includes(d)&&T.jsxs("option",{value:d,children:[d," (Custom)"]})]});const E=o?o(e):e;return T.jsxs("div",{className:`table-cell-selectable ${a}`,onClick:()=>f(!0),title:"Click to select",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"pointer",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:k=>{k.currentTarget.style.borderColor="#555",k.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:k=>{k.currentTarget.style.borderColor="transparent",k.currentTarget.style.backgroundColor="transparent"},children:[T.jsx("span",{children:E||T.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:i})}),T.jsx("span",{style:{color:"#666",fontSize:"12px",marginLeft:"4px"},children:""})]})},cg=({value:e,onSave:t,editable:r=!1,placeholder:n="",maxLength:i=500,className:a="",type:s="text",options:o=[],allowCustomValue:u=!1,getDisplayValue:f})=>{const[d,p]=_e.useState(!1),[g,v]=_e.useState(e||""),m=_e.useRef(null),y=()=>{g!==e&&t(g),p(!1)},E=()=>{v(e||""),p(!1)},k=w=>{w.key==="Enter"?(w.preventDefault(),y()):w.key==="Escape"&&(w.preventDefault(),E())};return _e.useEffect(()=>{d&&m.current&&(m.current.focus(),m.current.select())},[d]),_e.useEffect(()=>{v(e||"")},[e]),s==="select"?T.jsx(wD,{value:e,onSave:t,options:o,editable:r,placeholder:n,className:a,allowCustomValue:u,getDisplayValue:f}):(_e.useEffect(()=>{v(e||"")},[e]),r?d?T.jsx("input",{ref:m,type:"text",value:g,onChange:w=>v(w.target.value),onBlur:y,onKeyDown:k,placeholder:n,maxLength:i,className:`table-cell-input ${a}`,style:{width:"100%",border:"2px solid #007acc",padding:"4px 8px",fontSize:"inherit",borderRadius:"2px",outline:"none",backgroundColor:"#333",color:"#ffffff"}}):T.jsx("div",{className:`table-cell-editable ${a}`,onClick:()=>p(!0),title:"Click to edit",style:{padding:"4px 8px",border:"1px solid transparent",cursor:"text",minHeight:"20px",borderRadius:"2px",transition:"all 0.2s ease"},onMouseEnter:w=>{w.currentTarget.style.borderColor="#555",w.currentTarget.style.backgroundColor="#2a2a2a"},onMouseLeave:w=>{w.currentTarget.style.borderColor="transparent",w.currentTarget.style.backgroundColor="transparent"},children:e||T.jsx("span",{style:{color:"#888",fontStyle:"italic"},children:n})}):T.jsx("span",{className:`table-cell-readonly ${a}`,children:e||"-"}))},SD="#e0e0e0",kD="#ccc",ED="#cccccc",CD="#FFF",TD="#000",AD="#374151",PD="#666",FD=[SD,kD,ED,CD,TD,AD,PD],ND=[{min:224,max:255,channels:["r","g","b"]},{min:0,max:48,channels:["r","g","b"]},{min:192,max:208,channels:["r","g","b"]}];function RD(e,t,r){for(const n of ND)if(n.channels.every(a=>{const s=a==="r"?e:a==="g"?t:r;return s>=n.min&&s<=n.max}))return!0;for(const n of FD){const i=parseInt(n.slice(1,3),16),a=parseInt(n.slice(3,5),16),s=parseInt(n.slice(5,7),16);if(Math.sqrt(Math.pow(e-i,2)+Math.pow(t-a,2)+Math.pow(r-s,2))<80)return!0}return!1}function ID(e){const t=[],r=.618033988749895,n=.7,i=.5;for(let a=0;a<e;a++){let s=a*r%1,o=0,u=!1;for(;!u&&o<10;){const f=DD(s,n,i);RD(f.r,f.g,f.b)?(s=(s+.1)%1,o++):(t.push(`#${f.r.toString(16).padStart(2,"0")}${f.g.toString(16).padStart(2,"0")}${f.b.toString(16).padStart(2,"0")}`),u=!0)}u||t.push(`#${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}${Math.floor(Math.random()*128+64).toString(16)}`)}return t}function DD(e,t,r){let n,i,a;if(t===0)n=i=a=r;else{const s=(f,d,p)=>(p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?f+(d-f)*6*p:p<.5?d:p<.6666666666666666?f+(d-f)*(.6666666666666666-p)*6:f),o=r<.5?r*(1+t):r+t-r*t,u=2*r-o;n=s(u,o,e+1/3),i=s(u,o,e),a=s(u,o,e-1/3)}return{r:Math.round(n*255),g:Math.round(i*255),b:Math.round(a*255)}}const Vc=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#F39C12","#E74C3C","#9B59B6","#3498DB","#1ABC9C","#2ECC71","#F1C40F","#E67E22","#E91E63","#673AB7"];function go(e){if(!e||e==="NA")return"#708090";if(e==="POWER"||e==="VCC")return"#8B4513";if(e==="GROUND"||e==="GND")return"#2C2C2C";const t=parseInt(e);if(!isNaN(t)){if(t<Vc.length)return Vc[t];{const i=ID(t-Vc.length+1);return i[i.length-1]}}let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)&4294967295;const n=Math.abs(r)%Vc.length;return Vc[n]}const Tw=(e,t,r)=>{if(t)return"#2d4f75";if(!e)return r?"#2a2a2a":"#1a1a1a";const n=go(e),i=bD(n,.7);return r?OD(i,.2):i},bD=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.max(0,(r>>16)-n),a=Math.max(0,(r>>8&255)-n),s=Math.max(0,(r&255)-n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},OD=(e,t)=>{const r=parseInt(e.replace("#",""),16),n=Math.round(2.55*t*100),i=Math.min(255,(r>>16)+n),a=Math.min(255,(r>>8&255)+n),s=Math.min(255,(r&255)+n);return`#${(16777216+(i<<16)+(a<<8)+s).toString(16).slice(1)}`},Gc=48,I3=5,LD=({pins:e,columns:t,selectedRows:r,hoveredRowId:n,onRowSelection:i,onPinSelect:a,onHover:s,renderCellContent:o})=>{const[u,f]=_e.useState(0),[d,p]=_e.useState(400),g=_e.useRef(null),v=_e.useRef(null),m=_e.useMemo(()=>{const w=Math.floor(u/Gc),x=Math.ceil(d/Gc),C=Math.min(w+x+I3*2,e.length),A=Math.max(0,w-I3);return{start:A,end:C,visibleCount:C-A}},[u,d,e.length]),y=_e.useMemo(()=>e.slice(m.start,m.end),[e,m.start,m.end]),E=_e.useCallback(w=>{const x=w.target;console.log(" Scroll Event:",{scrollTop:x.scrollTop,scrollHeight:x.scrollHeight,clientHeight:x.clientHeight,maxScroll:x.scrollHeight-x.clientHeight}),f(x.scrollTop)},[]);_e.useEffect(()=>{const w=()=>{if(g.current){const C=g.current.getBoundingClientRect();p(C.height)}};w();const x=new ResizeObserver(w);return g.current&&x.observe(g.current),()=>{x.disconnect()}},[]);const k=e.length*Gc;return _e.useEffect(()=>{console.log(" VirtualizedPinList Debug:",{totalPins:e.length,visibleCount:m.visibleCount,visiblePercent:Math.round(m.visibleCount/e.length*100),totalHeight:k,containerHeight:d,scrollTop:u,visibleStart:m.start,visibleEnd:m.end})},[m.visibleCount,e.length,k,d,u,m.start,m.end]),T.jsxs("div",{ref:g,style:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},children:[T.jsx("div",{style:{backgroundColor:"#2a2a2a",borderBottom:"2px solid #444",flexShrink:0,zIndex:10},children:T.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:T.jsx("thead",{children:T.jsxs("tr",{children:[T.jsx("th",{style:{width:"40px",padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"center",backgroundColor:"#2a2a2a",color:"#ffffff"},children:T.jsx("input",{type:"checkbox",checked:e.length>0&&r.size===e.length,onChange:w=>{const x=w.target.checked?new Set(e.map(C=>C.id)):new Set;e.forEach(C=>{r.has(C.id)!==x.has(C.id)&&i(C.id,x.has(C.id))})}})}),t.map(w=>T.jsx("th",{style:{width:`${w.width}px`,padding:"12px 8px",borderBottom:"2px solid #444",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#ffffff",backgroundColor:"#2a2a2a"},children:w.title},w.key))]})})})}),T.jsx("div",{ref:v,onScroll:E,style:{flex:1,overflow:"auto",position:"relative",scrollbarWidth:"thin",scrollbarColor:"#555 #2a2a2a"},className:"virtualized-list-scroll",children:T.jsx("div",{style:{height:k,position:"relative"},children:T.jsx("div",{style:{position:"absolute",top:m.start*Gc,left:0,right:0},children:T.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:T.jsx("tbody",{children:y.map(w=>{const x=n===w.id,C=Tw(w.bank,r.has(w.id),x);return T.jsxs("tr",{style:{backgroundColor:C,cursor:"pointer",borderBottom:"1px solid #333",color:"#ffffff",height:`${Gc}px`},onClick:()=>a==null?void 0:a(w.id),onMouseEnter:()=>s(w.id),onMouseLeave:()=>s(null),children:[T.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",textAlign:"center",width:"40px"},children:T.jsx("input",{type:"checkbox",checked:r.has(w.id),onChange:A=>i(w.id,A.target.checked),onClick:A=>A.stopPropagation()})}),t.map(A=>T.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #333",fontSize:"14px",maxWidth:`${A.width}px`,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:P=>A.editable&&P.stopPropagation(),children:o(w,A)},A.key))]},w.id)})})})})})})]})};class ug{static calculateBankStatistics(t){const r=new Map;t.forEach(p=>{const g=p.bank||"UNASSIGNED";r.has(g)||r.set(g,[]),r.get(g).push(p)});const n=[];let i=0;Array.from(r.entries()).forEach(([p,g])=>{const v=g.filter(P=>{var N;return P.isAssigned||!!((N=P.signalName)!=null&&N.trim())}),m=g.filter(P=>{var N;return!P.isAssigned&&!((N=P.signalName)!=null&&N.trim())});i+=v.length;const y={};g.forEach(P=>{const N=P.pinType||"UNKNOWN";y[N]=(y[N]||0)+1});const E={};g.forEach(P=>{const N=P.voltage||"UNSPECIFIED";E[N]=(E[N]||0)+1});const k={};g.forEach(P=>{const N=P.direction||"UNSPECIFIED";k[N]=(k[N]||0)+1});const w=g.filter(P=>{var N,F;return P.differentialPair||((N=P.pinName)==null?void 0:N.includes("_P"))||((F=P.pinName)==null?void 0:F.includes("_N"))}).length/2,x=new Map;v.forEach(P=>{if(P.signalName){const N=this.inferSignalType(P.signalName);x.set(N,(x.get(N)||0)+1)}});const C=Array.from(x.entries()).filter(([,P])=>P>=2).sort((P,N)=>N[1]-P[1]).slice(0,3).map(([P])=>P),A=g.length>0?v.length/g.length*100:0;n.push({bankId:p,totalPins:g.length,assignedPins:v.length,unassignedPins:m.length,utilizationRate:A,pinsByType:y,pinsByVoltage:E,pinsByDirection:k,differentialPairs:Math.floor(w),majorSignalTypes:C})}),n.sort((p,g)=>{if(p.bankId==="UNASSIGNED")return 1;if(g.bankId==="UNASSIGNED")return-1;const v=parseInt(p.bankId),m=parseInt(g.bankId);return!isNaN(v)&&!isNaN(m)?v-m:p.bankId.localeCompare(g.bankId)});const a=t.length,s=a>0?i/a*100:0,o=n.filter(p=>p.bankId!=="UNASSIGNED").map(p=>({id:p.bankId,rate:p.utilizationRate})),u=o.length>0?o.reduce((p,g)=>g.rate>p.rate?g:p):{id:"N/A",rate:0},f=o.length>0?o.reduce((p,g)=>g.rate<p.rate?g:p):{id:"N/A",rate:0},d=Array.from(new Set(t.map(p=>p.pinType).filter(Boolean))).sort();return{totalBanks:r.size,totalPins:a,overallUtilization:s,bankStats:n,mostUtilizedBank:u.id,leastUtilizedBank:f.id,bankTypes:d}}static inferSignalType(t){const r=t.toUpperCase();return r.includes("CLK")?"CLOCK":r.includes("RST")||r.includes("RESET")?"RESET":r.includes("PWR")||r.includes("VCC")||r.includes("POWER")?"POWER":r.includes("GND")||r.includes("GROUND")?"GROUND":r.includes("DATA")||r.includes("D[")?"DATA":r.includes("ADDR")||r.includes("A[")?"ADDRESS":r.includes("CS")||r.includes("CE")||r.includes("EN")?"CONTROL":r.includes("LED")?"LED":r.includes("BTN")||r.includes("SW")?"USER_INPUT":r.includes("UART")||r.includes("TX")||r.includes("RX")?"UART":r.includes("SPI")||r.includes("I2C")?"SERIAL":r.includes("USB")?"USB":r.includes("ETH")||r.includes("RMII")||r.includes("RGMII")?"ETHERNET":r.includes("DDR")||r.includes("SDRAM")?"MEMORY":r.includes("HDMI")||r.includes("LVDS")?"DISPLAY":r.includes("_P")||r.includes("_N")?"DIFFERENTIAL":"GENERAL_IO"}static exportBankStatisticsCSV(t){const r=["Bank ID","Total Pins","Assigned Pins","Unassigned Pins","Utilization (%)","Main Pin Types","Main Voltages","Differential Pairs","Major Signal Types"],n=t.bankStats.map(i=>[i.bankId,i.totalPins.toString(),i.assignedPins.toString(),i.unassignedPins.toString(),i.utilizationRate.toFixed(1),Object.entries(i.pinsByType).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),Object.entries(i.pinsByVoltage).sort((a,s)=>s[1]-a[1]).slice(0,2).map(([a,s])=>`${a}:${s}`).join("; "),i.differentialPairs.toString(),i.majorSignalTypes.join("; ")]);return[r.join(","),...n.map(i=>i.map(a=>`"${a}"`).join(","))].join(`
`)}static generateRecommendations(t){const r=[];t.overallUtilization>90?r.push(" Overall utilization is very high (>90%). Consider using a larger package or optimizing pin assignments."):t.overallUtilization<30&&r.push(" Overall utilization is low (<30%). A smaller package might be more cost-effective.");const n=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED").map(a=>a.utilizationRate);if(n.length>1){const a=Math.max(...n),s=Math.min(...n),o=a-s;o>50&&r.push(` Bank utilization is unbalanced (${o.toFixed(1)}% variance). Consider redistributing signals.`)}const i=t.bankStats.filter(a=>a.bankId!=="UNASSIGNED"&&a.assignedPins===0);return i.length>0&&r.push(` ${i.length} banks are completely unused: ${i.map(a=>a.bankId).join(", ")}`),r}}const MD=({pins:e})=>{const[t,r]=_e.useState(null),[n,i]=_e.useState("bankId"),[a,s]=_e.useState("asc"),{visibleBanks:o,toggleBankVisibility:u,showAllBanks:f}=Xi(),d=_e.useMemo(()=>ug.calculateBankStatistics(e),[e]),p=_e.useMemo(()=>{const A=[...d.bankStats];return A.sort((P,N)=>{let F=0;switch(n){case"bankId":if(P.bankId==="UNASSIGNED")F=1;else if(N.bankId==="UNASSIGNED")F=-1;else{const I=parseInt(P.bankId),D=parseInt(N.bankId);!isNaN(I)&&!isNaN(D)?F=I-D:F=P.bankId.localeCompare(N.bankId)}break;case"utilization":F=P.utilizationRate-N.utilizationRate;break;case"totalPins":F=P.totalPins-N.totalPins;break}return a==="asc"?F:-F}),A},[d.bankStats,n,a]),g=A=>{n===A?s(a==="asc"?"desc":"asc"):(i(A),s("asc"))},v=()=>{const A=ug.exportBankStatisticsCSV(d),P=new Blob([A],{type:"text/csv"}),N=URL.createObjectURL(P),F=document.createElement("a");F.href=N,F.download=`bank-statistics-${new Date().toISOString().slice(0,10)}.csv`,F.click(),URL.revokeObjectURL(N)},m=_e.useMemo(()=>ug.generateRecommendations(d),[d]),y=A=>n!==A?"":a==="asc"?"":"",E=A=>o.size===0?!0:o.has(A),k=A=>{console.log(` Bank ${A} clicked! Current visibility:`,E(A)),alert(`Bank ${A} clicked!`),u(A)},w=()=>{console.log(" Show all banks clicked"),alert("Show all banks clicked!"),f()},x=A=>{if(A==="UNASSIGNED")return{backgroundColor:"#6b7280",color:"white"};const P=go(A),N=E(A);return{backgroundColor:N?`${P}20`:`${P}05`,borderLeft:`4px solid ${P}`,color:N?"#1f2937":"#9ca3af",opacity:N?1:.5}},C=A=>`${A.toFixed(1)}%`;return T.jsxs("div",{className:"bank-groups-panel p-4 space-y-4",children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Groups Statistics"}),T.jsx("button",{onClick:v,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:" Export CSV"})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[T.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Banks"}),T.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.totalBanks})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Pins"}),T.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.totalPins})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Overall Utilization"}),T.jsx("p",{className:"text-2xl font-bold text-purple-600",children:C(d.overallUtilization)})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Most Utilized"}),T.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["Bank ",d.mostUtilizedBank]})]})]}),m.length>0&&T.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[T.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Recommendations"}),T.jsx("ul",{className:"text-sm text-yellow-700 space-y-1",children:m.map((A,P)=>T.jsxs("li",{children:[" ",A]},P))})]}),T.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[T.jsx("h3",{className:"text-sm font-medium text-red-800 mb-2",children:" Debug Test Buttons"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:()=>alert("Simple button works!"),className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Test Simple Click"}),T.jsx("button",{onClick:w,className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Test Show All"}),T.jsx("button",{onClick:()=>k("TEST"),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Test Bank Click"})]})]}),T.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[T.jsxs("div",{className:"p-4 border-b",children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Bank Details"}),T.jsx("div",{className:"flex gap-2",children:T.jsx("button",{onClick:w,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",title:"Show all banks",children:" Show All"})})]}),T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsx("p",{className:"text-sm text-gray-600 mt-1",children:" Click on any bank row to toggle its visibility in the pin list"}),T.jsxs("div",{className:"text-xs text-gray-400",children:["Visible Banks: ",o.size===0?"All":Array.from(o).join(", ")]})]})]}),T.jsx("div",{className:"overflow-x-auto",children:T.jsxs("table",{className:"w-full",children:[T.jsx("thead",{className:"bg-gray-50",children:T.jsxs("tr",{children:[T.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("bankId"),children:["Bank ID ",y("bankId")]}),T.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("totalPins"),children:["Total Pins ",y("totalPins")]}),T.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned"}),T.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>g("utilization"),children:["Utilization ",y("utilization")]}),T.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Main Types"}),T.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diff Pairs"}),T.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),T.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(A=>T.jsxs(Sr.Fragment,{children:[T.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all duration-200",style:x(A.bankId),onClick:()=>k(A.bankId),title:`Click to ${E(A.bankId)?"hide":"show"} Bank ${A.bankId} pins`,children:[T.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:T.jsxs("div",{className:"flex items-center",children:[T.jsxs("div",{className:"flex items-center mr-2",children:[T.jsx("span",{className:"text-lg mr-1",children:E(A.bankId)?"":""}),T.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A.bankId==="UNASSIGNED"?"#6b7280":go(A.bankId)}})]}),T.jsx("span",{className:"text-sm font-medium",children:A.bankId==="UNASSIGNED"?"Unassigned":`Bank ${A.bankId}`})]})}),T.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.totalPins}),T.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:[T.jsx("span",{className:"text-green-600 font-medium",children:A.assignedPins}),T.jsxs("span",{className:"text-gray-400",children:["/",A.unassignedPins]})]}),T.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:T.jsxs("div",{className:"flex items-center",children:[T.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:T.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,A.utilizationRate)}%`}})}),T.jsx("span",{className:"text-sm text-gray-700",children:C(A.utilizationRate)})]})}),T.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:Object.entries(A.pinsByType).sort((P,N)=>N[1]-P[1]).slice(0,2).map(([P,N])=>`${P}(${N})`).join(", ")}),T.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:A.differentialPairs>0?A.differentialPairs:"-"}),T.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:T.jsx("button",{onClick:P=>{P.stopPropagation(),r(t===A.bankId?null:A.bankId)},className:"text-blue-600 hover:text-blue-900 font-medium",children:t===A.bankId?"Hide":"Details"})})]}),t===A.bankId&&T.jsx("tr",{children:T.jsx("td",{colSpan:7,className:"px-4 py-4 bg-gray-50",children:T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[T.jsxs("div",{children:[T.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Pin Types"}),T.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByType).map(([P,N])=>T.jsxs("div",{className:"flex justify-between text-sm",children:[T.jsx("span",{className:"text-gray-600",children:P}),T.jsx("span",{className:"font-medium",children:N})]},P))})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Voltages"}),T.jsx("div",{className:"space-y-1",children:Object.entries(A.pinsByVoltage).map(([P,N])=>T.jsxs("div",{className:"flex justify-between text-sm",children:[T.jsx("span",{className:"text-gray-600",children:P}),T.jsx("span",{className:"font-medium",children:N})]},P))})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Major Signal Types"}),T.jsx("div",{className:"space-y-1",children:A.majorSignalTypes.length>0?A.majorSignalTypes.map(P=>T.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:P},P)):T.jsx("span",{className:"text-gray-500 text-sm",children:"No major signal types"})})]})]})})})]},A.bankId))})]})})]})]})},dx=["1.0V","1.2V","1.5V","1.8V","2.5V","3.3V","5.0V"],hx=["LVCMOS12","LVCMOS15","LVCMOS18","LVCMOS25","LVCMOS33","LVTTL","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25","SSTL135","SSTL15","SSTL18_I","SSTL18_II","POD10","POD12","POD135","HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18","AUTO"],BD={"1.0V":"POD10","1.2V":"LVCMOS12","1.5V":"LVCMOS15","1.8V":"LVCMOS18","2.5V":"LVCMOS25","3.3V":"LVCMOS33","5.0V":"LVTTL"},Aw={"1.0V":["POD10"],"1.2V":["LVCMOS12","POD12","SSTL135"],"1.5V":["LVCMOS15","SSTL15","HSTL_I","HSTL_II"],"1.8V":["LVCMOS18","SSTL18_I","SSTL18_II","HSTL_I_18","HSTL_II_18"],"2.5V":["LVCMOS25","LVDS_25","RSDS_25","BLVDS_25","MINI_LVDS_25"],"3.3V":["LVCMOS33","LVTTL"],"5.0V":["LVTTL"]};function D3(e){return Aw[e]||["LVCMOS33"]}function Ql(e){return BD[e]||"LVCMOS33"}function UD(e,t){return t==="AUTO"?!0:(Aw[e]||[]).includes(t)}const jD=({onPinSelect:e})=>{const{pins:t,listView:r,setActiveTab:n,setSearchQuery:i,setCommentFilter:a,updatePin:s,updateListViewState:o,bulkUpdateComments:u}=Xi(),[f,d]=_e.useState(""),[p,g]=_e.useState(!1),[v,m]=_e.useState(null),y=_e.useMemo(()=>lg.find(P=>P.id===r.activeTab)||lg[0],[r.activeTab]),E=(P,N)=>{var F,I;switch(N){case"differentialPair":return P.differentialPair?`${P.differentialPair.pair}_${P.differentialPair.type}`:"";case"commentTimestamp":return((F=P.commentTimestamp)==null?void 0:F.getTime())||0;case"ioStandard":return((I=P.attributes)==null?void 0:I.IO_Standard)||P.ioType||"AUTO";default:return P[N]||""}},k=_e.useMemo(()=>{let P=t;if(y.filter&&(P=P.filter(y.filter)),r.searchQuery.trim()){const N=r.searchQuery.toLowerCase();P=P.filter(F=>F.pinNumber.toLowerCase().includes(N)||F.pinName.toLowerCase().includes(N)||(F.signalName||"").toLowerCase().includes(N)||(F.comment||"").toLowerCase().includes(N))}switch(r.commentFilter){case"with-comments":P=P.filter(N=>N.comment&&N.comment.trim()!=="");break;case"without-comments":P=P.filter(N=>!N.comment||N.comment.trim()==="");break}return r.sortColumn?P=[...P].sort((N,F)=>{const I=E(N,r.sortColumn),D=E(F,r.sortColumn);let U=0;return I<D?U=-1:I>D&&(U=1),r.sortDirection==="desc"?-U:U}):y.sort&&(P=[...P].sort(y.sort)),P},[t,y,r.searchQuery,r.commentFilter,r.sortColumn,r.sortDirection]),w=(P,N)=>{const F=E(P,N.key);if(N.customRender)return N.customRender(F,P);if(N.render==="datetime"&&P.commentTimestamp)return P.commentTimestamp.toLocaleDateString()+" "+P.commentTimestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(N.render==="boolean")return F?"":"";if(N.editable){if(N.key==="voltage")return T.jsx(cg,{value:String(F),onSave:I=>x(P.id,N.key,I),editable:!0,placeholder:"Select voltage...",type:"select",options:[...dx],allowCustomValue:!0});if(N.key==="ioStandard"||N.key==="ioType"){const I=P.voltage?D3(P.voltage):[...hx];return T.jsx(cg,{value:String(F),onSave:D=>x(P.id,N.key,D),editable:!0,placeholder:"Select I/O standard...",type:"select",options:I,allowCustomValue:!0,getDisplayValue:D=>D==="AUTO"?`Auto (${Ql(P.voltage||"3.3V")})`:D})}return T.jsx(cg,{value:String(F),onSave:I=>x(P.id,N.key,I),editable:!0,placeholder:`Enter ${N.title.toLowerCase()}...`,maxLength:N.key==="comment"?500:100})}return String(F)||"-"},x=(P,N,F)=>{var U;const I=t.find(O=>O.id===P);if(!I)return;const D={};if(N==="comment")D.comment=F,D.commentTimestamp=new Date,D.commentAuthor="current_user";else if(N==="voltage"){D.voltage=F;const O=((U=I.attributes)==null?void 0:U.IO_Standard)||I.ioType||"AUTO";if(O==="AUTO"||!D3(F).includes(O)){const Q=Ql(F);D.attributes={...I.attributes,IO_Standard:Q},D.ioType=Q}}else N==="ioStandard"||N==="ioType"?(D.attributes={...I.attributes,IO_Standard:F},D.ioType=F):D[N]=F;s(P,D)},C=(P,N)=>{const F=new Set(r.selectedRows);N?F.add(P):F.delete(P),o({selectedRows:F})},A=()=>{f.trim()&&r.selectedRows.size>0&&(u(Array.from(r.selectedRows),f),d(""),g(!1))};return T.jsxs("div",{className:"pin-list-tabs",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[!1,T.jsx("div",{className:"tab-header",style:{display:"flex",borderBottom:"1px solid #444",backgroundColor:"#2a2a2a"},children:lg.map(P=>T.jsxs("button",{className:`tab ${r.activeTab===P.id?"active":""}`,onClick:()=>n(P.id),title:P.description,style:{padding:"12px 16px",border:"none",background:r.activeTab===P.id?"#333":"transparent",borderBottom:r.activeTab===P.id?"2px solid #007acc":"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:r.activeTab===P.id?"600":"normal",color:r.activeTab===P.id?"#007acc":"#cccccc"},children:[T.jsx("span",{children:P.icon}),T.jsx("span",{children:P.title})]},P.id))}),!y.isCustomComponent&&T.jsxs("div",{className:"controls",style:{padding:"16px",display:"flex",gap:"16px",alignItems:"center",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444"},children:[y.showSearch&&T.jsx("div",{style:{flex:1,maxWidth:"300px"},children:T.jsx("input",{type:"text",placeholder:"Search pins, signals, or comments...",value:r.searchQuery,onChange:P=>i(P.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"}})}),T.jsx("div",{children:T.jsxs("select",{value:r.commentFilter,onChange:P=>a(P.target.value),style:{padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[T.jsx("option",{value:"all",children:"All Pins"}),T.jsx("option",{value:"with-comments",children:"With Comments"}),T.jsx("option",{value:"without-comments",children:"Without Comments"})]})}),T.jsxs("div",{style:{color:"#cccccc",fontSize:"14px"},children:[k.length," pins"]}),T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[T.jsx("span",{style:{color:"#cccccc",fontSize:"12px"},children:"BANKs:"}),Array.from(new Set(k.map(P=>P.bank).filter(Boolean))).sort((P,N)=>{const F=parseInt(P),I=parseInt(N);return isNaN(F)||isNaN(I)?P.localeCompare(N):F-I}).map(P=>T.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"3px",backgroundColor:Tw(P,!1,!1),border:"1px solid #555"},children:T.jsx("span",{style:{fontSize:"11px",color:"#ffffff"},children:P})},P))]}),r.selectedRows.size>0&&T.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[T.jsxs("span",{style:{fontSize:"14px",color:"#cccccc"},children:[r.selectedRows.size," selected"]}),T.jsx("button",{onClick:()=>g(!p),style:{padding:"6px 12px",border:"1px solid #007acc",borderRadius:"4px",backgroundColor:"#007acc",color:"white",fontSize:"12px",cursor:"pointer"},children:"Bulk Comment"}),T.jsx("button",{onClick:()=>u(Array.from(r.selectedRows),""),style:{padding:"6px 12px",border:"1px solid #dc3545",borderRadius:"4px",backgroundColor:"#dc3545",color:"white",fontSize:"12px",cursor:"pointer"},children:"Clear Comments"})]})]}),!y.isCustomComponent&&p&&T.jsxs("div",{style:{padding:"16px",backgroundColor:"#1a1a1a",borderBottom:"1px solid #444",display:"flex",gap:"8px",alignItems:"center"},children:[T.jsx("input",{type:"text",placeholder:"Enter comment for selected pins...",value:f,onChange:P=>d(P.target.value),onKeyDown:P=>P.key==="Enter"&&A(),style:{flex:1,padding:"8px 12px",border:"1px solid #555",borderRadius:"4px",fontSize:"14px",backgroundColor:"#333",color:"#ffffff"}}),T.jsx("button",{onClick:A,disabled:!f.trim(),style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:f.trim()?"#28a745":"#ccc",color:"white",fontSize:"14px",cursor:f.trim()?"pointer":"not-allowed"},children:"Apply"}),T.jsx("button",{onClick:()=>g(!1),style:{padding:"8px 16px",border:"1px solid #6c757d",borderRadius:"4px",backgroundColor:"#333",color:"#cccccc",fontSize:"14px",cursor:"pointer"},children:"Cancel"})]}),T.jsx("div",{style:{flex:1,minHeight:"400px",overflow:"hidden",display:"flex",flexDirection:"column"},children:y.isCustomComponent?y.id==="bankGroups"?T.jsx(MD,{pins:t}):T.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:["Custom component not implemented for ",y.id]}):k.length>0?T.jsx(LD,{pins:k,columns:y.columns,selectedRows:r.selectedRows,hoveredRowId:v,onRowSelection:C,onPinSelect:e,onHover:m,renderCellContent:w}):T.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"No pins match the current filters"})})]})};var Pw={exports:{}},yh={},Vd={},pt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof d4<"u"?d4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return e.Konva.angleDeg?i*t:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var i;return(i=e.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(i){e.glob.Konva=i}};const n=i=>{e.Konva[i.prototype.getClassName()]=i};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(pt);var or={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=pt;class r{constructor(C=[1,0,0,1,0,0]){this.dirty=!1,this.m=C&&C.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(C){C.m[0]=this.m[0],C.m[1]=this.m[1],C.m[2]=this.m[2],C.m[3]=this.m[3],C.m[4]=this.m[4],C.m[5]=this.m[5]}point(C){const A=this.m;return{x:A[0]*C.x+A[2]*C.y+A[4],y:A[1]*C.x+A[3]*C.y+A[5]}}translate(C,A){return this.m[4]+=this.m[0]*C+this.m[2]*A,this.m[5]+=this.m[1]*C+this.m[3]*A,this}scale(C,A){return this.m[0]*=C,this.m[1]*=C,this.m[2]*=A,this.m[3]*=A,this}rotate(C){const A=Math.cos(C),P=Math.sin(C),N=this.m[0]*A+this.m[2]*P,F=this.m[1]*A+this.m[3]*P,I=this.m[0]*-P+this.m[2]*A,D=this.m[1]*-P+this.m[3]*A;return this.m[0]=N,this.m[1]=F,this.m[2]=I,this.m[3]=D,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(C,A){const P=this.m[0]+this.m[2]*A,N=this.m[1]+this.m[3]*A,F=this.m[2]+this.m[0]*C,I=this.m[3]+this.m[1]*C;return this.m[0]=P,this.m[1]=N,this.m[2]=F,this.m[3]=I,this}multiply(C){const A=this.m[0]*C.m[0]+this.m[2]*C.m[1],P=this.m[1]*C.m[0]+this.m[3]*C.m[1],N=this.m[0]*C.m[2]+this.m[2]*C.m[3],F=this.m[1]*C.m[2]+this.m[3]*C.m[3],I=this.m[0]*C.m[4]+this.m[2]*C.m[5]+this.m[4],D=this.m[1]*C.m[4]+this.m[3]*C.m[5]+this.m[5];return this.m[0]=A,this.m[1]=P,this.m[2]=N,this.m[3]=F,this.m[4]=I,this.m[5]=D,this}invert(){const C=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*C,P=-this.m[1]*C,N=-this.m[2]*C,F=this.m[0]*C,I=C*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),D=C*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=P,this.m[2]=N,this.m[3]=F,this.m[4]=I,this.m[5]=D,this}getMatrix(){return this.m}decompose(){const C=this.m[0],A=this.m[1],P=this.m[2],N=this.m[3],F=this.m[4],I=this.m[5],D=C*N-A*P,U={x:F,y:I,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(C!=0||A!=0){const O=Math.sqrt(C*C+A*A);U.rotation=A>0?Math.acos(C/O):-Math.acos(C/O),U.scaleX=O,U.scaleY=D/O,U.skewX=(C*P+A*N)/D,U.skewY=0}else if(P!=0||N!=0){const O=Math.sqrt(P*P+N*N);U.rotation=Math.PI/2-(N>0?Math.acos(-P/O):-Math.acos(P/O)),U.scaleX=D/O,U.scaleY=O,U.skewX=0,U.skewY=(C*P+A*N)/D}return U.rotation=e.Util._getRotation(U.rotation),U}}e.Transform=r;const n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,u=180/Math.PI,f="#",d="",p="0",g="Konva warning: ",v="Konva error: ",m="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},E=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let k=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(x){setTimeout(x,60)};e.Util={_isElement(x){return!!(x&&x.nodeType==1)},_isFunction(x){return!!(x&&x.constructor&&x.call&&x.apply)},_isPlainObject(x){return!!x&&x.constructor===Object},_isArray(x){return Object.prototype.toString.call(x)===n},_isNumber(x){return Object.prototype.toString.call(x)===i&&!isNaN(x)&&isFinite(x)},_isString(x){return Object.prototype.toString.call(x)===a},_isBoolean(x){return Object.prototype.toString.call(x)===s},isObject(x){return x instanceof Object},isValidSelector(x){if(typeof x!="string")return!1;const C=x[0];return C==="#"||C==="."||C===C.toUpperCase()},_sign(x){return x===0||x>0?1:-1},requestAnimFrame(x){k.push(x),k.length===1&&w(function(){const C=k;k=[],C.forEach(function(A){A()})})},createCanvasElement(){const x=document.createElement("canvas");try{x.style=x.style||{}}catch{}return x},createImageElement(){return document.createElement("img")},_isInDocument(x){for(;x=x.parentNode;)if(x==document)return!0;return!1},_urlToImage(x,C){const A=e.Util.createImageElement();A.onload=function(){C(A)},A.src=x},_rgbToHex(x,C,A){return((1<<24)+(x<<16)+(C<<8)+A).toString(16).slice(1)},_hexToRgb(x){x=x.replace(f,d);const C=parseInt(x,16);return{r:C>>16&255,g:C>>8&255,b:C&255}},getRandomColor(){let x=(Math.random()*16777215<<0).toString(16);for(;x.length<6;)x=p+x;return f+x},getRGB(x){let C;return x in y?(C=y[x],{r:C[0],g:C[1],b:C[2]}):x[0]===f?this._hexToRgb(x.substring(1)):x.substr(0,4)===m?(C=E.exec(x.replace(/ /g,"")),{r:parseInt(C[1],10),g:parseInt(C[2],10),b:parseInt(C[3],10)}):{r:0,g:0,b:0}},colorToRGBA(x){return x=x||"black",e.Util._namedColorToRBA(x)||e.Util._hex3ColorToRGBA(x)||e.Util._hex4ColorToRGBA(x)||e.Util._hex6ColorToRGBA(x)||e.Util._hex8ColorToRGBA(x)||e.Util._rgbColorToRGBA(x)||e.Util._rgbaColorToRGBA(x)||e.Util._hslColorToRGBA(x)},_namedColorToRBA(x){const C=y[x.toLowerCase()];return C?{r:C[0],g:C[1],b:C[2],a:1}:null},_rgbColorToRGBA(x){if(x.indexOf("rgb(")===0){x=x.match(/rgb\(([^)]+)\)/)[1];const C=x.split(/ *, */).map(Number);return{r:C[0],g:C[1],b:C[2],a:1}}},_rgbaColorToRGBA(x){if(x.indexOf("rgba(")===0){x=x.match(/rgba\(([^)]+)\)/)[1];const C=x.split(/ *, */).map((A,P)=>A.slice(-1)==="%"?P===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:C[0],g:C[1],b:C[2],a:C[3]}}},_hex8ColorToRGBA(x){if(x[0]==="#"&&x.length===9)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:parseInt(x.slice(7,9),16)/255}},_hex6ColorToRGBA(x){if(x[0]==="#"&&x.length===7)return{r:parseInt(x.slice(1,3),16),g:parseInt(x.slice(3,5),16),b:parseInt(x.slice(5,7),16),a:1}},_hex4ColorToRGBA(x){if(x[0]==="#"&&x.length===5)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:parseInt(x[4]+x[4],16)/255}},_hex3ColorToRGBA(x){if(x[0]==="#"&&x.length===4)return{r:parseInt(x[1]+x[1],16),g:parseInt(x[2]+x[2],16),b:parseInt(x[3]+x[3],16),a:1}},_hslColorToRGBA(x){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(x)){const[C,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(x),P=Number(A[0])/360,N=Number(A[1])/100,F=Number(A[2])/100;let I,D,U;if(N===0)return U=F*255,{r:Math.round(U),g:Math.round(U),b:Math.round(U),a:1};F<.5?I=F*(1+N):I=F+N-F*N;const O=2*F-I,Q=[0,0,0];for(let he=0;he<3;he++)D=P+1/3*-(he-1),D<0&&D++,D>1&&D--,6*D<1?U=O+(I-O)*6*D:2*D<1?U=I:3*D<2?U=O+(I-O)*(2/3-D)*6:U=O,Q[he]=U*255;return{r:Math.round(Q[0]),g:Math.round(Q[1]),b:Math.round(Q[2]),a:1}}},haveIntersection(x,C){return!(C.x>x.x+x.width||C.x+C.width<x.x||C.y>x.y+x.height||C.y+C.height<x.y)},cloneObject(x){const C={};for(const A in x)this._isPlainObject(x[A])?C[A]=this.cloneObject(x[A]):this._isArray(x[A])?C[A]=this.cloneArray(x[A]):C[A]=x[A];return C},cloneArray(x){return x.slice(0)},degToRad(x){return x*o},radToDeg(x){return x*u},_degToRad(x){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(x)},_radToDeg(x){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(x)},_getRotation(x){return t.Konva.angleDeg?e.Util.radToDeg(x):x},_capitalize(x){return x.charAt(0).toUpperCase()+x.slice(1)},throw(x){throw new Error(v+x)},error(x){console.error(v+x)},warn(x){t.Konva.showWarnings&&console.warn(g+x)},each(x,C){for(const A in x)C(A,x[A])},_inRange(x,C,A){return C<=x&&x<A},_getProjectionToSegment(x,C,A,P,N,F){let I,D,U;const O=(x-A)*(x-A)+(C-P)*(C-P);if(O==0)I=x,D=C,U=(N-A)*(N-A)+(F-P)*(F-P);else{const Q=((N-x)*(A-x)+(F-C)*(P-C))/O;Q<0?(I=x,D=C,U=(x-N)*(x-N)+(C-F)*(C-F)):Q>1?(I=A,D=P,U=(A-N)*(A-N)+(P-F)*(P-F)):(I=x+Q*(A-x),D=C+Q*(P-C),U=(I-N)*(I-N)+(D-F)*(D-F))}return[I,D,U]},_getProjectionToLine(x,C,A){const P=e.Util.cloneObject(x);let N=Number.MAX_VALUE;return C.forEach(function(F,I){if(!A&&I===C.length-1)return;const D=C[(I+1)%C.length],U=e.Util._getProjectionToSegment(F.x,F.y,D.x,D.y,x.x,x.y),O=U[0],Q=U[1],he=U[2];he<N&&(P.x=O,P.y=Q,N=he)}),P},_prepareArrayForTween(x,C,A){const P=[],N=[];if(x.length>C.length){const I=C;C=x,x=I}for(let I=0;I<x.length;I+=2)P.push({x:x[I],y:x[I+1]});for(let I=0;I<C.length;I+=2)N.push({x:C[I],y:C[I+1]});const F=[];return N.forEach(function(I){const D=e.Util._getProjectionToLine(I,P,A);F.push(D.x),F.push(D.y)}),F},_prepareToStringify(x){let C;x.visitedByCircularReferenceRemoval=!0;for(const A in x)if(x.hasOwnProperty(A)&&x[A]&&typeof x[A]=="object"){if(C=Object.getOwnPropertyDescriptor(x,A),x[A].visitedByCircularReferenceRemoval||e.Util._isElement(x[A]))if(C.configurable)delete x[A];else return null;else if(e.Util._prepareToStringify(x[A])===null)if(C.configurable)delete x[A];else return null}return delete x.visitedByCircularReferenceRemoval,x},_assign(x,C){for(const A in C)x[A]=C[A];return x},_getFirstPointerId(x){return x.touches?x.changedTouches[0].identifier:x.pointerId||999},releaseCanvas(...x){t.Konva.releaseCanvasOnDestroy&&x.forEach(C=>{C.width=0,C.height=0})},drawRoundedRectPath(x,C,A,P){let N=0,F=0,I=0,D=0;typeof P=="number"?N=F=I=D=Math.min(P,C/2,A/2):(N=Math.min(P[0]||0,C/2,A/2),F=Math.min(P[1]||0,C/2,A/2),D=Math.min(P[2]||0,C/2,A/2),I=Math.min(P[3]||0,C/2,A/2)),x.moveTo(N,0),x.lineTo(C-F,0),x.arc(C-F,F,F,Math.PI*3/2,0,!1),x.lineTo(C,A-D),x.arc(C-D,A-D,D,0,Math.PI/2,!1),x.lineTo(I,A),x.arc(I,A-I,I,Math.PI/2,Math.PI,!1),x.lineTo(0,N),x.arc(N,N,N,Math.PI,Math.PI*3/2,!1)}}})(or);var tr={},Yi={},Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.HitContext=Ua.SceneContext=Ua.Context=void 0;const Fw=or,zD=pt;function VD(e){const t=[],r=e.length,n=Fw.Util;for(let i=0;i<r;i++){let a=e[i];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),t.push(a)}return t}const b3=",",GD="(",HD=")",WD="([",$D="])",XD=";",KD="()",YD="=",O3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],QD=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],qD=100;class _h{constructor(t){this.canvas=t,zD.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,r){let n=this.traceArr,i=n.length,a="",s,o,u,f;for(s=0;s<i;s++)o=n[s],u=o.method,u?(f=o.args,a+=u,t?a+=KD:Fw.Util._isArray(f[0])?a+=WD+f.join(b3)+$D:(r&&(f=f.map(d=>typeof d=="number"?Math.floor(d):d)),a+=GD+f.join(b3)+HD)):(a+=o.property,t||(a+=YD+o.val)),a+=XD;return a}clearTrace(){this.traceArr=[]}_trace(t){let r=this.traceArr,n;r.push(t),n=r.length,n>=qD&&r.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const r=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(t){const r=t.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(t){const r=t.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(t){const r=t.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(t,r){this._context[t]=r}arc(t,r,n,i,a,s){this._context.arc(t,r,n,i,a,s)}arcTo(t,r,n,i,a){this._context.arcTo(t,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,r,n,i,a,s){this._context.bezierCurveTo(t,r,n,i,a,s)}clearRect(t,r,n,i){this._context.clearRect(t,r,n,i)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,r){const n=arguments;if(n.length===2)return this._context.createImageData(t,r);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,r,n,i){return this._context.createLinearGradient(t,r,n,i)}createPattern(t,r){return this._context.createPattern(t,r)}createRadialGradient(t,r,n,i,a,s){return this._context.createRadialGradient(t,r,n,i,a,s)}drawImage(t,r,n,i,a,s,o,u,f){const d=arguments,p=this._context;d.length===3?p.drawImage(t,r,n):d.length===5?p.drawImage(t,r,n,i,a):d.length===9&&p.drawImage(t,r,n,i,a,s,o,u,f)}ellipse(t,r,n,i,a,s,o,u){this._context.ellipse(t,r,n,i,a,s,o,u)}isPointInPath(t,r,n,i){return n?this._context.isPointInPath(n,t,r,i):this._context.isPointInPath(t,r,i)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,r,n,i){this._context.fillRect(t,r,n,i)}strokeRect(t,r,n,i){this._context.strokeRect(t,r,n,i)}fillText(t,r,n,i){i?this._context.fillText(t,r,n,i):this._context.fillText(t,r,n)}measureText(t){return this._context.measureText(t)}getImageData(t,r,n,i){return this._context.getImageData(t,r,n,i)}lineTo(t,r){this._context.lineTo(t,r)}moveTo(t,r){this._context.moveTo(t,r)}rect(t,r,n,i){this._context.rect(t,r,n,i)}roundRect(t,r,n,i,a){this._context.roundRect(t,r,n,i,a)}putImageData(t,r,n){this._context.putImageData(t,r,n)}quadraticCurveTo(t,r,n,i){this._context.quadraticCurveTo(t,r,n,i)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,r){this._context.scale(t,r)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,r,n,i,a,s){this._context.setTransform(t,r,n,i,a,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,r,n,i){this._context.strokeText(t,r,n,i)}transform(t,r,n,i,a,s){this._context.transform(t,r,n,i,a,s)}translate(t,r){this._context.translate(t,r)}_enableTrace(){let t=this,r=O3.length,n=this.setAttr,i,a;const s=function(o){let u=t[o],f;t[o]=function(){return a=VD(Array.prototype.slice.call(arguments,0)),f=u.apply(t,arguments),t._trace({method:o,args:a}),f}};for(i=0;i<r;i++)s(O3[i]);t.setAttr=function(){n.apply(t,arguments);const o=arguments[0];let u=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:o,val:u})}}_applyGlobalCompositeOperation(t){const r=t.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ua.Context=_h;QD.forEach(function(e){Object.defineProperty(_h.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});class JD extends _h{constructor(t,{willReadFrequently:r=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(t){const r=t.fill();this.setAttr("fillStyle",r),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const r=t._getLinearGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fillRadialGradient(t){const r=t._getRadialGradient();r&&(this.setAttr("fillStyle",r),t._fillFunc(this))}_fill(t){const r=t.fill(),n=t.getFillPriority();if(r&&n==="color"){this._fillColor(t);return}const i=t.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(t);return}const a=t.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(t);return}const s=t.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(t);return}r?this._fillColor(t):i?this._fillPattern(t):a?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const r=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),i=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(t){const r=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),r&&t.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var r,n,i;const a=(r=t.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=t.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=t.getAbsoluteScale(),f=this.canvas.getPixelRatio(),d=u.x*f,p=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(d),Math.abs(p))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*p)}}Ua.SceneContext=JD;class ZD extends _h{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),i=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}Ua.HitContext=ZD;Object.defineProperty(Yi,"__esModule",{value:!0});Yi.HitCanvas=Yi.SceneCanvas=Yi.Canvas=void 0;const Gd=or,Nw=Ua,Rw=pt;let Uf;function eb(){if(Uf)return Uf;const e=Gd.Util.createCanvasElement(),t=e.getContext("2d");return Uf=function(){const r=Rw.Konva._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return r/n}(),Gd.Util.releaseCanvas(e),Uf}class px{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||Rw.Konva.pixelRatio||eb();this.pixelRatio=n,this._canvas=Gd.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const r=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,r){this.setWidth(t||0),this.setHeight(r||0)}toDataURL(t,r){try{return this._canvas.toDataURL(t,r)}catch{try{return this._canvas.toDataURL()}catch(i){return Gd.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Yi.Canvas=px;class tb extends px{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Nw.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Yi.SceneCanvas=tb;class rb extends px{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Nw.HitContext(this),this.setSize(t.width,t.height)}}Yi.HitCanvas=rb;var wh={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=pt,r=or;e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];e.DD._dragElements.forEach((a,s)=>{const{node:o}=a,u=o.getStage();u.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const f=u._changedPointerPositions.find(d=>d.id===a.pointerId);if(f){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(f.x-a.startPointerPos.x),Math.abs(f.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];e.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const f=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(wh);var mt={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.RGBComponent=nb;rt.alphaComponent=ib;rt.getNumberValidator=ab;rt.getNumberOrArrayOfNumbersValidator=sb;rt.getNumberOrAutoValidator=ob;rt.getStringValidator=lb;rt.getStringOrGradientValidator=cb;rt.getFunctionValidator=ub;rt.getNumberArrayValidator=fb;rt.getBooleanValidator=db;rt.getComponentValidator=hb;const Ka=pt,ur=or;function Ya(e){return ur.Util._isString(e)?'"'+e+'"':Object.prototype.toString.call(e)==="[object Number]"||ur.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function nb(e){return e>255?255:e<0?0:Math.round(e)}function ib(e){return e>1?1:e<1e-4?1e-4:e}function ab(){if(Ka.Konva.isUnminified)return function(e,t){return ur.Util._isNumber(e)||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}}function sb(e){if(Ka.Konva.isUnminified)return function(t,r){let n=ur.Util._isNumber(t),i=ur.Util._isArray(t)&&t.length==e;return!n&&!i&&ur.Util.warn(Ya(t)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+e+")"),t}}function ob(){if(Ka.Konva.isUnminified)return function(e,t){return ur.Util._isNumber(e)||e==="auto"||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}}function lb(){if(Ka.Konva.isUnminified)return function(e,t){return ur.Util._isString(e)||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}}function cb(){if(Ka.Konva.isUnminified)return function(e,t){const r=ur.Util._isString(e),n=Object.prototype.toString.call(e)==="[object CanvasGradient]"||e&&e.addColorStop;return r||n||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}}function ub(){if(Ka.Konva.isUnminified)return function(e,t){return ur.Util._isFunction(e)||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}}function fb(){if(Ka.Konva.isUnminified)return function(e,t){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&e instanceof r||(ur.Util._isArray(e)?e.forEach(function(n){ur.Util._isNumber(n)||ur.Util.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}}function db(){if(Ka.Konva.isUnminified)return function(e,t){return e===!0||e===!1||ur.Util.warn(Ya(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}}function hb(e){if(Ka.Konva.isUnminified)return function(t,r){return t==null||ur.Util.isObject(t)||ur.Util.warn(Ya(t)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+e),t}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=or,r=rt,n="get",i="set";e.Factory={addGetterSetter(a,s,o,u,f){e.Factory.addGetter(a,s,o),e.Factory.addSetter(a,s,u,f),e.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const u=n+t.Util._capitalize(s);a.prototype[u]=a.prototype[u]||function(){const f=this.attrs[s];return f===void 0?o:f}},addSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]||e.Factory.overWriteSetter(a,s,o,u)},overWriteSetter(a,s,o,u){const f=i+t.Util._capitalize(s);a.prototype[f]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,s)),this._setAttr(s,d),u&&u.call(this),this}},addComponentsGetterSetter(a,s,o,u,f){const d=o.length,p=t.Util._capitalize,g=n+p(s),v=i+p(s);a.prototype[g]=function(){const y={};for(let E=0;E<d;E++){const k=o[E];y[k]=this.getAttr(s+p(k))}return y};const m=(0,r.getComponentValidator)(o);a.prototype[v]=function(y){const E=this.attrs[s];u&&(y=u.call(this,y,s)),m&&m.call(this,y,s);for(const k in y)y.hasOwnProperty(k)&&this._setAttr(s+p(k),y[k]);return y||o.forEach(k=>{this._setAttr(s+p(k),void 0)}),this._fireChangeEvent(s,E,y),f&&f.call(this),this},e.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=t.Util._capitalize(s),u=i+o,f=n+o;a.prototype[s]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(a,s,o,u){t.Util.error("Adding deprecated "+s);const f=n+t.Util._capitalize(s),d=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[f]=function(){t.Util.error(d);const p=this.attrs[s];return p===void 0?o:p},e.Factory.addSetter(a,s,u,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){t.Util.each(s,function(o,u){const f=a.prototype[u],d=n+t.Util._capitalize(o),p=i+t.Util._capitalize(o);function g(){f.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(mt);Object.defineProperty(tr,"__esModule",{value:!0});tr.Node=void 0;const cl=Yi,mi=wh,pu=mt,cs=pt,_t=or,mr=rt,rd="absoluteOpacity",jf="allEventListeners",Pa="absoluteTransform",L3="absoluteScale",ao="canvas",pb="Change",gb="children",mb="konva",Im="listening",xb="mouseenter",vb="mouseleave",yb="pointerenter",_b="pointerleave",wb="touchenter",Sb="touchleave",M3="set",B3="Shape",nd=" ",U3="stage",us="transform",kb="Stage",Dm="visible",Eb=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(nd);let Cb=1;class st{constructor(t){this._id=Cb++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===us||t===Pa)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,r){let n=this._cache.get(t);return(n===void 0||(t===us||t===Pa)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(t,n)),n}_calculate(t,r,n){if(!this._attachedDepsListeners.get(t)){const i=r.map(a=>a+"Change.konva").join(nd);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(ao)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Pa&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ao)){const{scene:t,filter:r,hit:n,buffer:i}=this._cache.get(ao);_t.Util.releaseCanvas(t,r,n,i),this._cache.delete(ao)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const r=t||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,u=r.y===void 0?Math.floor(n.y):r.y,f=r.offset||0,d=r.drawBorder||!1,p=r.hitCanvasPixelRatio||1;if(!i||!a){_t.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const g=Math.abs(Math.round(n.x)-o)>.5?1:0,v=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+g,a+=f*2+v,o-=f,u-=f;const m=new cl.SceneCanvas({pixelRatio:s,width:i,height:a}),y=new cl.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),E=new cl.HitCanvas({pixelRatio:p,width:i,height:a}),k=m.getContext(),w=E.getContext(),x=new cl.SceneCanvas({width:m.width/m.pixelRatio+Math.abs(o),height:m.height/m.pixelRatio+Math.abs(u),pixelRatio:m.pixelRatio}),C=x.getContext();return E.isCache=!0,m.isCache=!0,this._cache.delete(ao),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(m.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),k.save(),w.save(),C.save(),k.translate(-o,-u),w.translate(-o,-u),C.translate(-o,-u),x.x=o,x.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(rd),this._clearSelfAndDescendantCache(L3),this.drawScene(m,this,x),this.drawHit(E,this),this._isUnderCache=!1,k.restore(),w.restore(),d&&(k.save(),k.beginPath(),k.rect(0,0,i,a),k.closePath(),k.setAttr("strokeStyle","red"),k.setAttr("lineWidth",5),k.stroke(),k.restore()),this._cache.set(ao,{scene:m,filter:y,hit:E,buffer:x,x:o,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(ao)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,r){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const u=this.getAbsoluteTransform(r);return n.forEach(function(f){const d=u.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();t.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/i,n.height/i),t.restore()}_drawCachedHitCanvas(t){const r=this._getCanvasCache(),n=r.hit;t.save(),t.translate(r.x,r.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,u,f;if(t){if(!this._filterUpToDate){const d=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=t.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<s;u++){if(f=t[u],typeof f!="function"){_t.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,o),a.putImageData(o,0,0)}}catch(p){_t.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(t,r){if(this._cache&&this._cache.delete(jf),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(nd);for(let i=0;i<n.length;i++){const s=n[i].split("."),o=s[0],u=s[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:u,handler:r})}return this}off(t,r){let n=(t||"").split(nd),i=n.length,a,s,o,u,f,d;if(this._cache&&this._cache.delete(jf),!t)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],u=o.split("."),f=u[0],d=u[1],f)this.eventListeners[f]&&this._off(f,d,r);else for(s in this.eventListeners)this._off(s,d,r);return this}dispatchEvent(t){const r={target:this,type:t.type,evt:t};return this.fire(t.type,r),this}addEventListener(t,r){return this.on(t,function(n){r.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,r,n){const i=this;this.on(t,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=_t.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),mi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Pa),this._clearSelfAndDescendantCache(rd),this._clearSelfAndDescendantCache(L3),this._clearSelfAndDescendantCache(U3),this._clearSelfAndDescendantCache(Dm),this._clearSelfAndDescendantCache(Im)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const r="get"+_t.Util._capitalize(t);return _t.Util._isFunction(this[r])?this[r]():this.attrs[t]}getAncestors(){let t=this.getParent(),r=[];for(;t;)r.push(t),t=t.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let r,n;if(!t)return this;for(r in t)r!==gb&&(n=M3+_t.Util._capitalize(r),_t.Util._isFunction(this[n])?this[n](t[r]):this._setAttr(r,t[r]))}),this}isListening(){return this._getCache(Im,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(Dm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,r=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let i=!1;mi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!cs.Konva.hitOnDragEnabled&&(i||cs.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),r=this,n=0,i,a,s,o;function u(d){for(i=[],a=d.length,s=0;s<a;s++)o=d[s],n++,o.nodeType!==B3&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=t&&u(i)}const f=this.getStage();return r.nodeType!==kb&&f&&u(f.getChildren()),n}getDepth(){let t=0,r=this.parent;for(;r;)t++,r=r.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(us),this._clearSelfAndDescendantCache(Pa)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const r=t.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(t){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!t&&(t=!0);const i=this.getAbsoluteTransform(t).getMatrix(),a=new _t.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(t){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(us);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:t.x,y:t.y}),this._clearCache(us),this._clearSelfAndDescendantCache(Pa),this}_setTransform(t){let r;for(r in t)this.attrs[r]=t[r]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let r=t.x,n=t.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(t,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)t(n[s])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return _t.Util.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,r=this.parent.getChildren().length;return t<r-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return _t.Util.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return _t.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&_t.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(rd,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(t*=r.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in t)n=t[r],s=_t.Util.isObject(n)&&!_t.Util._isPlainObject(n)&&!_t.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete t[r],a=i?i.call(this):null,t[r]=n,a!==n&&(o.attrs[r]=n));return _t.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,r,n){const i=[];r&&this._isMatch(t)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(t)&&i.push(a),a=a.parent}return i}isAncestorOf(t){return!1}findAncestor(t,r,n){return this.findAncestors(t,r,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let r=t.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],_t.Util.isValidSelector(a)||(_t.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),_t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),_t.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(U3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,r={},n){return r.target=r.target||this,n?this._fireAndBubble(t,r):this._fire(t,r),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Pa,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let r;if(t)return r=new _t.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),r;{r=this._cache.get(Pa)||new _t.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(t){let r=this;for(;r;)r._isUnderCache&&(t=r),r=r.getParent();const i=this.getAbsoluteTransform(t).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(us,this._getTransform)}_getTransform(){var t,r;const n=this._cache.get(us)||new _t.Transform;n.reset();const i=this.x(),a=this.y(),s=cs.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,f=this.attrs.skewX||0,d=this.attrs.skewY||0,p=this.attrs.offsetX||0,g=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(f!==0||d!==0)&&n.skew(f,d),(o!==1||u!==1)&&n.scale(o,u),(p!==0||g!==0)&&n.translate(-1*p,-1*g),n.dirty=!1,n}clone(t){let r=_t.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in t)r[n]=t[n];const u=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(mb)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(o));return u}_toKonvaCanvas(t){t=t||{};const r=this.getClientRect(),n=this.getStage(),i=t.x!==void 0?t.x:Math.floor(r.x),a=t.y!==void 0?t.y:Math.floor(r.y),s=t.pixelRatio||1,o=new cl.SceneCanvas({width:t.width||Math.ceil(r.width)||(n?n.width():0),height:t.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),u=o.getContext(),f=new cl.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||a)&&u.translate(-1*i,-1*a),this.drawScene(o,void 0,f),u.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const r=t.mimeType||null,n=t.quality||null,i=this._toKonvaCanvas(t).toDataURL(r,n);return t.callback&&t.callback(i),i}toImage(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,_t.Util._urlToImage(this.toDataURL(t),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(t){return new Promise((r,n)=>{try{const i=t==null?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob(a=>{r(a),i==null||i(a)},t==null?void 0:t.mimeType,t==null?void 0:t.quality)}catch(i){n(i)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():cs.Konva.dragDistance}_off(t,r,n){let i=this.eventListeners[t],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,r,n){this._fire(t+pb,{oldVal:r,newVal:n})}addName(t){if(!this.hasName(t)){const r=this.name(),n=r?r+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const r=(this.name()||"").split(/\s/g),n=r.indexOf(t);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(t,r){const n=this[M3+_t.Util._capitalize(t)];return _t.Util._isFunction(n)?n.call(this,r):this._setAttr(t,r),this}_requestDraw(){if(cs.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t==null||t.batchDraw()}}_setAttr(t,r){const n=this.attrs[t];n===r&&!_t.Util.isObject(r)||(r==null?delete this.attrs[t]:this.attrs[t]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,r),this._requestDraw())}_setComponentAttr(t,r,n){let i;n!==void 0&&(i=this.attrs[t],i||(this.attrs[t]=this.getAttr(t)),this.attrs[t][r]=n,this._fireChangeEvent(t,i,n))}_fireAndBubble(t,r,n){r&&this.nodeType===B3&&(r.target=this);const i=[xb,vb,yb,_b,wb,Sb];if(!(i.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,r);const s=i.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!s&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,r,n):this._fireAndBubble.call(this.parent,t,r))}}_getProtoListeners(t){var r,n,i;const a=(r=this._cache.get(jf))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[t];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const u=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[t])!==null&&i!==void 0?i:[];s.push(...u),o=Object.getPrototypeOf(o)}a[t]=s,this._cache.set(jf,a)}return s}_fire(t,r){r=r||{},r.currentTarget=this,r.type=t;const n=this._getProtoListeners(t);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const i=this.eventListeners[t];if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const r=t?t.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;mi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(t,r=!0){mi.DD._dragElements.has(this._id)||this._createDragElement(t);const n=mi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},r)}_setDragPosition(t,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,t);s?i=s:_t.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(t){const r=mi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),mi.DD._endDragBefore(t),mi.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=mi.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||cs.Konva.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let i=!1;mi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=mi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&mi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-t.x,y:-t.y,width:r.width()+2*t.x,height:r.height()+2*t.y};return _t.Util.haveIntersection(n,this.getClientRect())}static create(t,r){return _t.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,r)}static _createNode(t,r){let n=st.prototype.getClassName.call(t),i=t.children,a,s,o;r&&(t.attrs.container=r),cs.Konva[n]||(_t.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=cs.Konva[n];if(a=new u(t.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(st._createNode(i[o]));return a}}tr.Node=st;st.prototype.nodeType="Node";st.prototype._attrsAffectingSize=[];st.prototype.eventListeners={};st.prototype.on.call(st.prototype,Eb,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(us),this._clearSelfAndDescendantCache(Pa)});st.prototype.on.call(st.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Dm)});st.prototype.on.call(st.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Im)});st.prototype.on.call(st.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(rd)});const Ht=pu.Factory.addGetterSetter;Ht(st,"zIndex");Ht(st,"absolutePosition");Ht(st,"position");Ht(st,"x",0,(0,mr.getNumberValidator)());Ht(st,"y",0,(0,mr.getNumberValidator)());Ht(st,"globalCompositeOperation","source-over",(0,mr.getStringValidator)());Ht(st,"opacity",1,(0,mr.getNumberValidator)());Ht(st,"name","",(0,mr.getStringValidator)());Ht(st,"id","",(0,mr.getStringValidator)());Ht(st,"rotation",0,(0,mr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(st,"scale",["x","y"]);Ht(st,"scaleX",1,(0,mr.getNumberValidator)());Ht(st,"scaleY",1,(0,mr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(st,"skew",["x","y"]);Ht(st,"skewX",0,(0,mr.getNumberValidator)());Ht(st,"skewY",0,(0,mr.getNumberValidator)());pu.Factory.addComponentsGetterSetter(st,"offset",["x","y"]);Ht(st,"offsetX",0,(0,mr.getNumberValidator)());Ht(st,"offsetY",0,(0,mr.getNumberValidator)());Ht(st,"dragDistance",void 0,(0,mr.getNumberValidator)());Ht(st,"width",0,(0,mr.getNumberValidator)());Ht(st,"height",0,(0,mr.getNumberValidator)());Ht(st,"listening",!0,(0,mr.getBooleanValidator)());Ht(st,"preventDefault",!0,(0,mr.getBooleanValidator)());Ht(st,"filters",void 0,function(e){return this._filterUpToDate=!1,e});Ht(st,"visible",!0,(0,mr.getBooleanValidator)());Ht(st,"transformsEnabled","all",(0,mr.getStringValidator)());Ht(st,"size");Ht(st,"dragBoundFunc");Ht(st,"draggable",!1,(0,mr.getBooleanValidator)());pu.Factory.backCompat(st,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.Container=void 0;const sc=mt,fg=tr,Sh=rt;class Bo extends fg.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){const r=this.children||[];return t?r.filter(t):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const r=t[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const r=this._generalFind(t,!0);return r.length>0?r[0]:void 0}_generalFind(t,r){const n=[];return this._descendants(i=>{const a=i._isMatch(t);return a&&n.push(i),!!(a&&r)}),n}_descendants(t){let r=!1;const n=this.getChildren();for(const i of n){if(r=t(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(t),r))return!0}return!1}toObject(){const t=fg.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(r=>{t.children.push(r.toObject())}),t}isAncestorOf(t){let r=t.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(t){const r=fg.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(t){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&r.push(n)}),r}_clearSelfAndDescendantCache(t){var r;super._clearSelfAndDescendantCache(t),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),u=o&&o.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){s.save();const d=this.getAbsoluteTransform(r).getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(t,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=t||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const u=this.getAbsoluteTransform(r).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(t,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),d=typeof o=="number"&&typeof u=="number"||f,p=n===this;if(d){s.save();const v=this.getAbsoluteTransform(n);let m=v.getMatrix();s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s.beginPath();let y;if(f)y=f.call(this,s,this);else{const E=this.clipX(),k=this.clipY();s.rect(E||0,k||0,o,u)}s.clip.apply(s,y),m=v.copy().invert().getMatrix(),s.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const g=!p&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";g&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(v){v[t](r,n,i)}),g&&s.restore(),d&&s.restore()}getClientRect(t={}){var r;const n=t.skipTransform,i=t.relativeTo;let a,s,o,u,f={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(v){if(!v.visible())return;const m=v.getClientRect({relativeTo:d,skipShadow:t.skipShadow,skipStroke:t.skipStroke});m.width===0&&m.height===0||(a===void 0?(a=m.x,s=m.y,o=m.x+m.width,u=m.y+m.height):(a=Math.min(a,m.x),s=Math.min(s,m.y),o=Math.max(o,m.x+m.width),u=Math.max(u,m.y+m.height)))});const p=this.find("Shape");let g=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){g=!0;break}return g&&a!==void 0?f={x:a,y:s,width:o-a,height:u-s}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}Mo.Container=Bo;sc.Factory.addComponentsGetterSetter(Bo,"clip",["x","y","width","height"]);sc.Factory.addGetterSetter(Bo,"clipX",void 0,(0,Sh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipY",void 0,(0,Sh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipWidth",void 0,(0,Sh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipHeight",void 0,(0,Sh.getNumberValidator)());sc.Factory.addGetterSetter(Bo,"clipFunc");var Iw={},js={};Object.defineProperty(js,"__esModule",{value:!0});js.getCapturedShape=Ab;js.createEvent=gx;js.hasPointerCapture=Pb;js.setPointerCapture=Fb;js.releaseCapture=bw;const Tb=pt,eu=new Map,Dw=Tb.Konva._global.PointerEvent!==void 0;function Ab(e){return eu.get(e)}function gx(e){return{evt:e,pointerId:e.pointerId}}function Pb(e,t){return eu.get(e)===t}function Fb(e,t){bw(e),t.getStage()&&(eu.set(e,t),Dw&&t._fire("gotpointercapture",gx(new PointerEvent("gotpointercapture"))))}function bw(e,t){const r=eu.get(e);if(!r)return;const n=r.getStage();n&&n.content,eu.delete(e),Dw&&r._fire("lostpointercapture",gx(new PointerEvent("lostpointercapture")))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=or,r=mt,n=Mo,i=pt,a=Yi,s=wh,o=pt,u=js,f="Stage",d="string",p="px",g="mouseout",v="mouseleave",m="mouseover",y="mouseenter",E="mousemove",k="mousedown",w="mouseup",x="pointermove",C="pointerdown",A="pointerup",P="pointercancel",N="lostpointercapture",F="pointerout",I="pointerleave",D="pointerover",U="pointerenter",O="contextmenu",Q="touchstart",he="touchend",te="touchmove",Ee="touchcancel",we="wheel",se=5,X=[[y,"_pointerenter"],[k,"_pointerdown"],[E,"_pointermove"],[w,"_pointerup"],[v,"_pointerleave"],[Q,"_pointerdown"],[te,"_pointermove"],[he,"_pointerup"],[Ee,"_pointercancel"],[m,"_pointerover"],[we,"_wheel"],[O,"_contextmenu"],[C,"_pointerdown"],[x,"_pointermove"],[A,"_pointerup"],[P,"_pointercancel"],[I,"_pointerleave"],[N,"_lostpointercapture"]],ce={mouse:{[F]:g,[I]:v,[D]:m,[U]:y,[x]:E,[C]:k,[A]:w,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[F]:"touchout",[I]:"touchleave",[D]:"touchover",[U]:"touchenter",[x]:te,[C]:Q,[A]:he,[P]:Ee,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[F]:F,[I]:I,[D]:D,[U]:U,[x]:x,[C]:C,[A]:A,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Se=ue=>ue.indexOf("pointer")>=0?"pointer":ue.indexOf("touch")>=0?"touch":"mouse",L=ue=>{const z=Se(ue);if(z==="pointer")return i.Konva.pointerEventsEnabled&&ce.pointer;if(z==="touch")return ce.touch;if(z==="mouse")return ce.mouse};function q(ue={}){return(ue.clipFunc||ue.clipWidth||ue.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ue}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class K extends n.Container{constructor(z){super(q(z)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{q(this.attrs)}),this._checkVisibility()}_validateAdd(z){const ee=z.getType()==="Layer",de=z.getType()==="FastLayer";ee||de||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const z=this.visible()?"":"none";this.content.style.display=z}setContainer(z){if(typeof z===d){let ee;if(z.charAt(0)==="."){const de=z.slice(1);z=document.getElementsByClassName(de)[0]}else z.charAt(0)!=="#"?ee=z:ee=z.slice(1),z=document.getElementById(ee);if(!z)throw"Can not find container in document with id "+ee}return this._setAttr("container",z),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),z.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const z=this.children,ee=z.length;for(let de=0;de<ee;de++)z[de].clear();return this}clone(z){return z||(z={}),z.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,z)}destroy(){super.destroy();const z=this.content;z&&t.Util._isInDocument(z)&&this.container().removeChild(z);const ee=e.stages.indexOf(this);return ee>-1&&e.stages.splice(ee,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const z=this._pointerPositions[0]||this._changedPointerPositions[0];return z?{x:z.x,y:z.y}:(t.Util.warn(Y),null)}_getPointerById(z){return this._pointerPositions.find(ee=>ee.id===z)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(z){z=z||{},z.x=z.x||0,z.y=z.y||0,z.width=z.width||this.width(),z.height=z.height||this.height();const ee=new a.SceneCanvas({width:z.width,height:z.height,pixelRatio:z.pixelRatio||1}),de=ee.getContext()._context,xe=this.children;return(z.x||z.y)&&de.translate(-1*z.x,-1*z.y),xe.forEach(function(Me){if(!Me.isVisible())return;const G=Me._toKonvaCanvas(z);de.drawImage(G._canvas,z.x,z.y,G.getWidth()/G.getPixelRatio(),G.getHeight()/G.getPixelRatio())}),ee}getIntersection(z){if(!z)return null;const ee=this.children,de=ee.length,xe=de-1;for(let Me=xe;Me>=0;Me--){const G=ee[Me].getIntersection(z);if(G)return G}return null}_resizeDOM(){const z=this.width(),ee=this.height();this.content&&(this.content.style.width=z+p,this.content.style.height=ee+p),this.bufferCanvas.setSize(z,ee),this.bufferHitCanvas.setSize(z,ee),this.children.forEach(de=>{de.setSize({width:z,height:ee}),de.draw()})}add(z,...ee){if(arguments.length>1){for(let xe=0;xe<arguments.length;xe++)this.add(arguments[xe]);return this}super.add(z);const de=this.children.length;return de>se&&t.Util.warn("The stage has "+de+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),z.setSize({width:this.width(),height:this.height()}),z.draw(),i.Konva.isBrowser&&this.content.appendChild(z.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(z){return u.hasPointerCapture(z,this)}setPointerCapture(z){u.setPointerCapture(z,this)}releaseCapture(z){u.releaseCapture(z,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([z,ee])=>{this.content.addEventListener(z,de=>{this[ee](de)},{passive:!1})})}_pointerenter(z){this.setPointersPositions(z);const ee=L(z.type);ee&&this._fire(ee.pointerenter,{evt:z,target:this,currentTarget:this})}_pointerover(z){this.setPointersPositions(z);const ee=L(z.type);ee&&this._fire(ee.pointerover,{evt:z,target:this,currentTarget:this})}_getTargetShape(z){let ee=this[z+"targetShape"];return ee&&!ee.getStage()&&(ee=null),ee}_pointerleave(z){const ee=L(z.type),de=Se(z.type);if(!ee)return;this.setPointersPositions(z);const xe=this._getTargetShape(de),Me=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;xe&&Me?(xe._fireAndBubble(ee.pointerout,{evt:z}),xe._fireAndBubble(ee.pointerleave,{evt:z}),this._fire(ee.pointerleave,{evt:z,target:this,currentTarget:this}),this[de+"targetShape"]=null):Me&&(this._fire(ee.pointerleave,{evt:z,target:this,currentTarget:this}),this._fire(ee.pointerout,{evt:z,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(z){const ee=L(z.type),de=Se(z.type);if(!ee)return;this.setPointersPositions(z);let xe=!1;this._changedPointerPositions.forEach(Me=>{const G=this.getIntersection(Me);if(s.DD.justDragged=!1,i.Konva["_"+de+"ListenClick"]=!0,!G||!G.isListening()){this[de+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&G.setPointerCapture(Me.id),this[de+"ClickStartShape"]=G,G._fireAndBubble(ee.pointerdown,{evt:z,pointerId:Me.id}),xe=!0;const Ze=z.type.indexOf("touch")>=0;G.preventDefault()&&z.cancelable&&Ze&&z.preventDefault()}),xe||this._fire(ee.pointerdown,{evt:z,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(z){const ee=L(z.type),de=Se(z.type);if(!ee||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&z.cancelable&&z.preventDefault(),this.setPointersPositions(z),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Me={};let G=!1;const Ze=this._getTargetShape(de);this._changedPointerPositions.forEach(nt=>{const Ke=u.getCapturedShape(nt.id)||this.getIntersection(nt),qe=nt.id,De={evt:z,pointerId:qe},kt=Ze!==Ke;if(kt&&Ze&&(Ze._fireAndBubble(ee.pointerout,{...De},Ke),Ze._fireAndBubble(ee.pointerleave,{...De},Ke)),Ke){if(Me[Ke._id])return;Me[Ke._id]=!0}Ke&&Ke.isListening()?(G=!0,kt&&(Ke._fireAndBubble(ee.pointerover,{...De},Ze),Ke._fireAndBubble(ee.pointerenter,{...De},Ze),this[de+"targetShape"]=Ke),Ke._fireAndBubble(ee.pointermove,{...De})):Ze&&(this._fire(ee.pointerover,{evt:z,target:this,currentTarget:this,pointerId:qe}),this[de+"targetShape"]=null)}),G||this._fire(ee.pointermove,{evt:z,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(z){const ee=L(z.type),de=Se(z.type);if(!ee)return;this.setPointersPositions(z);const xe=this[de+"ClickStartShape"],Me=this[de+"ClickEndShape"],G={};let Ze=!1;this._changedPointerPositions.forEach(nt=>{const Ke=u.getCapturedShape(nt.id)||this.getIntersection(nt);if(Ke){if(Ke.releaseCapture(nt.id),G[Ke._id])return;G[Ke._id]=!0}const qe=nt.id,De={evt:z,pointerId:qe};let kt=!1;i.Konva["_"+de+"InDblClickWindow"]?(kt=!0,clearTimeout(this[de+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+de+"InDblClickWindow"]=!0,clearTimeout(this[de+"DblTimeout"])),this[de+"DblTimeout"]=setTimeout(function(){i.Konva["_"+de+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Ke&&Ke.isListening()?(Ze=!0,this[de+"ClickEndShape"]=Ke,Ke._fireAndBubble(ee.pointerup,{...De}),i.Konva["_"+de+"ListenClick"]&&xe&&xe===Ke&&(Ke._fireAndBubble(ee.pointerclick,{...De}),kt&&Me&&Me===Ke&&Ke._fireAndBubble(ee.pointerdblclick,{...De}))):(this[de+"ClickEndShape"]=null,i.Konva["_"+de+"ListenClick"]&&this._fire(ee.pointerclick,{evt:z,target:this,currentTarget:this,pointerId:qe}),kt&&this._fire(ee.pointerdblclick,{evt:z,target:this,currentTarget:this,pointerId:qe}))}),Ze||this._fire(ee.pointerup,{evt:z,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+de+"ListenClick"]=!1,z.cancelable&&de!=="touch"&&de!=="pointer"&&z.preventDefault()}_contextmenu(z){this.setPointersPositions(z);const ee=this.getIntersection(this.getPointerPosition());ee&&ee.isListening()?ee._fireAndBubble(O,{evt:z}):this._fire(O,{evt:z,target:this,currentTarget:this})}_wheel(z){this.setPointersPositions(z);const ee=this.getIntersection(this.getPointerPosition());ee&&ee.isListening()?ee._fireAndBubble(we,{evt:z}):this._fire(we,{evt:z,target:this,currentTarget:this})}_pointercancel(z){this.setPointersPositions(z);const ee=u.getCapturedShape(z.pointerId)||this.getIntersection(this.getPointerPosition());ee&&ee._fireAndBubble(A,u.createEvent(z)),u.releaseCapture(z.pointerId)}_lostpointercapture(z){u.releaseCapture(z.pointerId)}setPointersPositions(z){const ee=this._getContentPosition();let de=null,xe=null;z=z||window.event,z.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(z.touches,Me=>{this._pointerPositions.push({id:Me.identifier,x:(Me.clientX-ee.left)/ee.scaleX,y:(Me.clientY-ee.top)/ee.scaleY})}),Array.prototype.forEach.call(z.changedTouches||z.touches,Me=>{this._changedPointerPositions.push({id:Me.identifier,x:(Me.clientX-ee.left)/ee.scaleX,y:(Me.clientY-ee.top)/ee.scaleY})})):(de=(z.clientX-ee.left)/ee.scaleX,xe=(z.clientY-ee.top)/ee.scaleY,this.pointerPos={x:de,y:xe},this._pointerPositions=[{x:de,y:xe,id:t.Util._getFirstPointerId(z)}],this._changedPointerPositions=[{x:de,y:xe,id:t.Util._getFirstPointerId(z)}])}_setPointerPosition(z){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(z)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const z=this.content.getBoundingClientRect();return{top:z.top,left:z.left,scaleX:z.width/this.content.clientWidth||1,scaleY:z.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const z=this.container();if(!z)throw"Stage has no container. A container is required.";z.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),z.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(z){z.batchDraw()}),this}}e.Stage=K,K.prototype.nodeType=f,(0,o._registerNode)(K),r.Factory.addGetterSetter(K,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(ue=>{ue.batchDraw()})})})(Iw);var gu={},Dr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=pt,r=or,n=mt,i=tr,a=rt,s=pt,o=js,u="hasShadow",f="shadowRGBA",d="patternImage",p="linearGradient",g="radialGradient";let v;function m(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}e.shapes={};function y(I){const D=this.attrs.fillRule;D?I.fill(D):I.fill()}function E(I){I.stroke()}function k(I){const D=this.attrs.fillRule;D?I.fill(D):I.fill()}function w(I){I.stroke()}function x(){this._clearCache(u)}function C(){this._clearCache(f)}function A(){this._clearCache(d)}function P(){this._clearCache(p)}function N(){this._clearCache(g)}class F extends i.Node{constructor(D){super(D);let U;for(;U=r.Util.getRandomColor(),!(U&&!(U in e.shapes)););this.colorKey=U,e.shapes[U]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const U=m().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(U&&U.setTransform){const O=new r.Transform;O.translate(this.fillPatternX(),this.fillPatternY()),O.rotate(t.Konva.getAngle(this.fillPatternRotation())),O.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),O.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Q=O.getMatrix(),he=typeof DOMMatrix>"u"?{a:Q[0],b:Q[1],c:Q[2],d:Q[3],e:Q[4],f:Q[5]}:new DOMMatrix(Q);U.setTransform(he)}return U}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const D=this.fillLinearGradientColorStops();if(D){const U=m(),O=this.fillLinearGradientStartPoint(),Q=this.fillLinearGradientEndPoint(),he=U.createLinearGradient(O.x,O.y,Q.x,Q.y);for(let te=0;te<D.length;te+=2)he.addColorStop(D[te],D[te+1]);return he}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const D=this.fillRadialGradientColorStops();if(D){const U=m(),O=this.fillRadialGradientStartPoint(),Q=this.fillRadialGradientEndPoint(),he=U.createRadialGradient(O.x,O.y,this.fillRadialGradientStartRadius(),Q.x,Q.y,this.fillRadialGradientEndRadius());for(let te=0;te<D.length;te+=2)he.addColorStop(D[te],D[te+1]);return he}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const D=r.Util.colorToRGBA(this.shadowColor());if(D)return"rgba("+D.r+","+D.g+","+D.b+","+D.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const D=this.hitStrokeWidth();return D==="auto"?this.hasStroke():this.strokeEnabled()&&!!D}intersects(D){const U=this.getStage();if(!U)return!1;const O=U.bufferHitCanvas;return O.getContext().clear(),this.drawHit(O,void 0,!0),O.context.getImageData(Math.round(D.x),Math.round(D.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(D){var U;if(!((U=this.attrs.perfectDrawEnabled)!==null&&U!==void 0?U:!0))return!1;const Q=D||this.hasFill(),he=this.hasStroke(),te=this.getAbsoluteOpacity()!==1;if(Q&&he&&te)return!0;const Ee=this.hasShadow(),we=this.shadowForStrokeEnabled();return!!(Q&&he&&Ee&&we)}setStrokeHitEnabled(D){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),D?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const D=this.size();return{x:this._centroid?-D.width/2:0,y:this._centroid?-D.height/2:0,width:D.width,height:D.height}}getClientRect(D={}){let U=!1,O=this.getParent();for(;O;){if(O.isCached()){U=!0;break}O=O.getParent()}const Q=D.skipTransform,he=D.relativeTo||U&&this.getStage()||void 0,te=this.getSelfRect(),we=!D.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,se=te.width+we,X=te.height+we,ce=!D.skipShadow&&this.hasShadow(),Se=ce?this.shadowOffsetX():0,L=ce?this.shadowOffsetY():0,q=se+Math.abs(Se),Y=X+Math.abs(L),K=ce&&this.shadowBlur()||0,ue=q+K*2,z=Y+K*2,ee={width:ue,height:z,x:-(we/2+K)+Math.min(Se,0)+te.x,y:-(we/2+K)+Math.min(L,0)+te.y};return Q?ee:this._transformedRect(ee,he)}drawScene(D,U,O){const Q=this.getLayer(),he=D||Q.getCanvas(),te=he.getContext(),Ee=this._getCanvasCache(),we=this.getSceneFunc(),se=this.hasShadow();let X;const ce=!1,Se=U===this;if(!this.isVisible()&&!Se)return this;if(Ee){te.save();const L=this.getAbsoluteTransform(U).getMatrix();return te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),this._drawCachedSceneCanvas(te),te.restore(),this}if(!we)return this;if(te.save(),this._useBufferCanvas()&&!ce){X=this.getStage();const L=O||X.bufferCanvas,q=L.getContext();q.clear(),q.save(),q._applyLineJoin(this);const Y=this.getAbsoluteTransform(U).getMatrix();q.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),we.call(this,q,this),q.restore();const K=L.pixelRatio;se&&te._applyShadow(this),te._applyOpacity(this),te._applyGlobalCompositeOperation(this),te.drawImage(L._canvas,L.x||0,L.y||0,L.width/K,L.height/K)}else{if(te._applyLineJoin(this),!Se){const L=this.getAbsoluteTransform(U).getMatrix();te.transform(L[0],L[1],L[2],L[3],L[4],L[5]),te._applyOpacity(this),te._applyGlobalCompositeOperation(this)}se&&te._applyShadow(this),we.call(this,te,this)}return te.restore(),this}drawHit(D,U,O=!1){if(!this.shouldDrawHit(U,O))return this;const Q=this.getLayer(),he=D||Q.hitCanvas,te=he&&he.getContext(),Ee=this.hitFunc()||this.sceneFunc(),we=this._getCanvasCache(),se=we&&we.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),se){te.save();const ce=this.getAbsoluteTransform(U).getMatrix();return te.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),this._drawCachedHitCanvas(te),te.restore(),this}if(!Ee)return this;if(te.save(),te._applyLineJoin(this),!(this===U)){const ce=this.getAbsoluteTransform(U).getMatrix();te.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5])}return Ee.call(this,te,this),te.restore(),this}drawHitFromCache(D=0){const U=this._getCanvasCache(),O=this._getCachedSceneCanvas(),Q=U.hit,he=Q.getContext(),te=Q.getWidth(),Ee=Q.getHeight();he.clear(),he.drawImage(O._canvas,0,0,te,Ee);try{const we=he.getImageData(0,0,te,Ee),se=we.data,X=se.length,ce=r.Util._hexToRgb(this.colorKey);for(let Se=0;Se<X;Se+=4)se[Se+3]>D?(se[Se]=ce.r,se[Se+1]=ce.g,se[Se+2]=ce.b,se[Se+3]=255):se[Se+3]=0;he.putImageData(we,0,0)}catch(we){r.Util.error("Unable to draw hit graph from cached scene canvas. "+we.message)}return this}hasPointerCapture(D){return o.hasPointerCapture(D,this)}setPointerCapture(D){o.setPointerCapture(D,this)}releaseCapture(D){o.releaseCapture(D,this)}}e.Shape=F,F.prototype._fillFunc=y,F.prototype._strokeFunc=E,F.prototype._fillFuncHit=k,F.prototype._strokeFuncHit=w,F.prototype._centroid=!1,F.prototype.nodeType="Shape",(0,s._registerNode)(F),F.prototype.eventListeners={},F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",N),n.Factory.addGetterSetter(F,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(F,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(F,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(F,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(F,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(F,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(F,"lineJoin"),n.Factory.addGetterSetter(F,"lineCap"),n.Factory.addGetterSetter(F,"sceneFunc"),n.Factory.addGetterSetter(F,"hitFunc"),n.Factory.addGetterSetter(F,"dash"),n.Factory.addGetterSetter(F,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(F,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(F,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternImage"),n.Factory.addGetterSetter(F,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(F,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(F,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(F,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(F,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(F,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(F,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(F,"fillEnabled",!0),n.Factory.addGetterSetter(F,"strokeEnabled",!0),n.Factory.addGetterSetter(F,"shadowEnabled",!0),n.Factory.addGetterSetter(F,"dashEnabled",!0),n.Factory.addGetterSetter(F,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(F,"fillPriority","color"),n.Factory.addComponentsGetterSetter(F,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(F,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(F,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(F,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(F,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(F,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(F,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(F,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(F,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(F,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(F,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(F,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(F,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(F,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(F,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(F,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(F,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(F,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(F,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(F,"fillPatternRotation",0),n.Factory.addGetterSetter(F,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(F,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Dr);Object.defineProperty(gu,"__esModule",{value:!0});gu.Layer=void 0;const Aa=or,dg=Mo,ul=tr,mx=mt,j3=Yi,Nb=rt,Rb=Dr,Ib=pt,Db="#",bb="beforeDraw",Ob="draw",Ow=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Lb=Ow.length;let oc=class extends dg.Container{constructor(t){super(t),this.canvas=new j3.SceneCanvas,this.hitCanvas=new j3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),t<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[t+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){ul.Node.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!ul.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(ul.Node.prototype.moveDown.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(ul.Node.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const r=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return ul.Node.prototype.remove.call(this),t&&t.parentNode&&Aa.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:r}){return this.canvas.setSize(t,r),this.hitCanvas.setSize(t,r),this._setSmoothEnabled(),this}_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&Aa.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),ul.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Aa.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Aa.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Aa.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<Lb;i++){const a=Ow[i],s=this._getIntersection({x:t.x+a.x*r,y:t.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(t){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*r),Math.round(t.y*r),1,1).data,i=n[3];if(i===255){const a=Aa.Util._rgbToHex(n[0],n[1],n[2]),s=Rb.shapes[Db+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(t,r,n){const i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(bb,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),dg.Container.prototype.drawScene.call(this,a,r,n),this._fire(Ob,{node:this}),this}drawHit(t,r){const n=this.getLayer(),i=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),dg.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Aa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Aa.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return Aa.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};gu.Layer=oc;oc.prototype.nodeType="Layer";(0,Ib._registerNode)(oc);mx.Factory.addGetterSetter(oc,"imageSmoothingEnabled",!0);mx.Factory.addGetterSetter(oc,"clearBeforeDraw",!0);mx.Factory.addGetterSetter(oc,"hitGraphEnabled",!0,(0,Nb.getBooleanValidator)());var kh={};Object.defineProperty(kh,"__esModule",{value:!0});kh.FastLayer=void 0;const Mb=or,Bb=gu,Ub=pt;class xx extends Bb.Layer{constructor(t){super(t),this.listening(!1),Mb.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}kh.FastLayer=xx;xx.prototype.nodeType="FastLayer";(0,Ub._registerNode)(xx);var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.Group=void 0;const jb=or,zb=Mo,Vb=pt;let vx=class extends zb.Container{_validateAdd(t){const r=t.getType();r!=="Group"&&r!=="Shape"&&jb.Util.throw("You may only add groups and shapes to groups.")}};lc.Group=vx;vx.prototype.nodeType="Group";(0,Vb._registerNode)(vx);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.Animation=void 0;const hg=pt,z3=or,pg=function(){return hg.glob.performance&&hg.glob.performance.now?function(){return hg.glob.performance.now()}:function(){return new Date().getTime()}}();class da{constructor(t,r){this.id=da.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:pg(),frameRate:0},this.func=t,this.setLayers(r)}setLayers(t){let r=[];return t&&(r=Array.isArray(t)?t:[t]),this.layers=r,this}getLayers(){return this.layers}addLayer(t){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const r=da.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=pg(),da._addAnimation(this),this}stop(){return da._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const r=t.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const t={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(pg());const o=a.length;let u;if(s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<o;f++){const d=a[f];d._id!==void 0&&(t[d._id]=d)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=da;t.animations.length?(t._runFrames(),z3.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,z3.Util.requestAnimFrame(this._animationLoop))}}cc.Animation=da;da.animations=[];da.animIdCounter=0;da.animRunning=!1;var Lw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=or,r=cc,n=tr,i=pt,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,u=3,f=["fill","stroke","shadowColor"];let d=0;class p{constructor(m,y,E,k,w,x,C){this.prop=m,this.propFunc=y,this.begin=k,this._pos=k,this.duration=x,this._change=0,this.prevPos=0,this.yoyo=C,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=E,this._change=w-this.begin,this.pause()}fire(m){const y=this[m];y&&y()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const m=this.getTimer()-this._startTime;this.state===o?this.setTime(m):this.state===u&&this.setTime(this.duration-m)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(m){const y=this,E=m.node,k=E._id,w=m.easing||e.Easings.Linear,x=!!m.yoyo;let C,A;typeof m.duration>"u"?C=.3:m.duration===0?C=.001:C=m.duration,this.node=E,this._id=d++;const P=E.getLayer()||(E instanceof i.Konva.Stage?E.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){y.tween.onEnterFrame()},P),this.tween=new p(A,function(N){y._tweenFunc(N)},w,0,1,C*1e3,x),this._addListeners(),g.attrs[k]||(g.attrs[k]={}),g.attrs[k][this._id]||(g.attrs[k][this._id]={}),g.tweens[k]||(g.tweens[k]={});for(A in m)a[A]===void 0&&this._addAttr(A,m[A]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,y){const E=this.node,k=E._id;let w,x,C,A,P;const N=g.tweens[k][m];N&&delete g.attrs[k][N][m];let F=E.getAttr(m);if(t.Util._isArray(y))if(w=[],x=Math.max(y.length,F.length),m==="points"&&y.length!==F.length&&(y.length>F.length?(A=F,F=t.Util._prepareArrayForTween(F,y,E.closed())):(C=y,y=t.Util._prepareArrayForTween(y,F,E.closed()))),m.indexOf("fill")===0)for(let I=0;I<x;I++)if(I%2===0)w.push(y[I]-F[I]);else{const D=t.Util.colorToRGBA(F[I]);P=t.Util.colorToRGBA(y[I]),F[I]=D,w.push({r:P.r-D.r,g:P.g-D.g,b:P.b-D.b,a:P.a-D.a})}else for(let I=0;I<x;I++)w.push(y[I]-F[I]);else f.indexOf(m)!==-1?(F=t.Util.colorToRGBA(F),P=t.Util.colorToRGBA(y),w={r:P.r-F.r,g:P.g-F.g,b:P.b-F.b,a:P.a-F.a}):w=y-F;g.attrs[k][this._id][m]={start:F,diff:w,end:y,trueEnd:C,trueStart:A},g.tweens[k][m]=this._id}_tweenFunc(m){const y=this.node,E=g.attrs[y._id][this._id];let k,w,x,C,A,P,N,F;for(k in E){if(w=E[k],x=w.start,C=w.diff,F=w.end,t.Util._isArray(x))if(A=[],N=Math.max(x.length,F.length),k.indexOf("fill")===0)for(P=0;P<N;P++)P%2===0?A.push((x[P]||0)+C[P]*m):A.push("rgba("+Math.round(x[P].r+C[P].r*m)+","+Math.round(x[P].g+C[P].g*m)+","+Math.round(x[P].b+C[P].b*m)+","+(x[P].a+C[P].a*m)+")");else for(P=0;P<N;P++)A.push((x[P]||0)+C[P]*m);else f.indexOf(k)!==-1?A="rgba("+Math.round(x.r+C.r*m)+","+Math.round(x.g+C.g*m)+","+Math.round(x.b+C.b*m)+","+(x.a+C.a*m)+")":A=x+C*m;y.setAttr(k,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const m=this.node,y=g.attrs[m._id][this._id];y.points&&y.points.trueEnd&&m.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const m=this.node,y=g.attrs[m._id][this._id];y.points&&y.points.trueStart&&m.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const m=this.node._id,y=this._id,E=g.tweens[m];this.pause(),this.anim&&this.anim.stop();for(const k in E)delete g.tweens[m][k];delete g.attrs[m][y],g.tweens[m]&&(Object.keys(g.tweens[m]).length===0&&delete g.tweens[m],Object.keys(g.attrs[m]).length===0&&delete g.attrs[m])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(v){const m=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),m&&m()},new g(v).play()},e.Easings={BackEaseIn(v,m,y,E){return y*(v/=E)*v*((1.70158+1)*v-1.70158)+m},BackEaseOut(v,m,y,E){return y*((v=v/E-1)*v*((1.70158+1)*v+1.70158)+1)+m},BackEaseInOut(v,m,y,E){let k=1.70158;return(v/=E/2)<1?y/2*(v*v*(((k*=1.525)+1)*v-k))+m:y/2*((v-=2)*v*(((k*=1.525)+1)*v+k)+2)+m},ElasticEaseIn(v,m,y,E,k,w){let x=0;return v===0?m:(v/=E)===1?m+y:(w||(w=E*.3),!k||k<Math.abs(y)?(k=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/k),-(k*Math.pow(2,10*(v-=1))*Math.sin((v*E-x)*(2*Math.PI)/w))+m)},ElasticEaseOut(v,m,y,E,k,w){let x=0;return v===0?m:(v/=E)===1?m+y:(w||(w=E*.3),!k||k<Math.abs(y)?(k=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/k),k*Math.pow(2,-10*v)*Math.sin((v*E-x)*(2*Math.PI)/w)+y+m)},ElasticEaseInOut(v,m,y,E,k,w){let x=0;return v===0?m:(v/=E/2)===2?m+y:(w||(w=E*(.3*1.5)),!k||k<Math.abs(y)?(k=y,x=w/4):x=w/(2*Math.PI)*Math.asin(y/k),v<1?-.5*(k*Math.pow(2,10*(v-=1))*Math.sin((v*E-x)*(2*Math.PI)/w))+m:k*Math.pow(2,-10*(v-=1))*Math.sin((v*E-x)*(2*Math.PI)/w)*.5+y+m)},BounceEaseOut(v,m,y,E){return(v/=E)<1/2.75?y*(7.5625*v*v)+m:v<2/2.75?y*(7.5625*(v-=1.5/2.75)*v+.75)+m:v<2.5/2.75?y*(7.5625*(v-=2.25/2.75)*v+.9375)+m:y*(7.5625*(v-=2.625/2.75)*v+.984375)+m},BounceEaseIn(v,m,y,E){return y-e.Easings.BounceEaseOut(E-v,0,y,E)+m},BounceEaseInOut(v,m,y,E){return v<E/2?e.Easings.BounceEaseIn(v*2,0,y,E)*.5+m:e.Easings.BounceEaseOut(v*2-E,0,y,E)*.5+y*.5+m},EaseIn(v,m,y,E){return y*(v/=E)*v+m},EaseOut(v,m,y,E){return-y*(v/=E)*(v-2)+m},EaseInOut(v,m,y,E){return(v/=E/2)<1?y/2*v*v+m:-y/2*(--v*(v-2)-1)+m},StrongEaseIn(v,m,y,E){return y*(v/=E)*v*v*v*v+m},StrongEaseOut(v,m,y,E){return y*((v=v/E-1)*v*v*v*v+1)+m},StrongEaseInOut(v,m,y,E){return(v/=E/2)<1?y/2*v*v*v*v*v+m:y/2*((v-=2)*v*v*v*v+2)+m},Linear(v,m,y,E){return y*v/E+m}}})(Lw);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=pt,r=or,n=tr,i=Mo,a=Iw,s=gu,o=kh,u=lc,f=wh,d=Dr,p=cc,g=Lw,v=Ua,m=Yi;e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:u.Group,DD:f.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:v.Context,Canvas:m.Canvas}),e.default=e.Konva})(Vd);var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});Eh.Arc=void 0;const Ch=mt,Gb=Dr,V3=pt,Th=rt,Hb=pt;class Qa extends Gb.Shape{_sceneFunc(t){const r=V3.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,r,n),t.arc(0,0,this.innerRadius(),r,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=V3.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=a*(a>0?t:r),d=s*r,p=o*(o>0?t:r),g=u*(u>0?r:t);return{x:f,y:n?-1*g:p,width:d-f,height:g-p}}}Eh.Arc=Qa;Qa.prototype._centroid=!0;Qa.prototype.className="Arc";Qa.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,Hb._registerNode)(Qa);Ch.Factory.addGetterSetter(Qa,"innerRadius",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"outerRadius",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"angle",0,(0,Th.getNumberValidator)());Ch.Factory.addGetterSetter(Qa,"clockwise",!1,(0,Th.getBooleanValidator)());var Ah={},mu={};Object.defineProperty(mu,"__esModule",{value:!0});mu.Line=void 0;const Ph=mt,Wb=pt,$b=Dr,Mw=rt;function bm(e,t,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-e,2)+Math.pow(n-t,2)),u=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),f=s*o/(o+u),d=s*u/(o+u),p=r-f*(i-e),g=n-f*(a-t),v=r+d*(i-e),m=n+d*(a-t);return[p,g,v,m]}function G3(e,t){const r=e.length,n=[];for(let i=2;i<r-2;i+=2){const a=bm(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(e[i]),n.push(e[i+1]),n.push(a[2]),n.push(a[3]))}return n}let zs=class extends $b.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier();if(!n)return;let o=0;if(t.beginPath(),t.moveTo(r[0],r[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(o=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);o<f-2;)t.bezierCurveTo(u[o++],u[o++],u[o++],u[o++],u[o++],u[o++]);a||t.quadraticCurveTo(u[f-2],u[f-1],r[n-2],r[n-1])}else if(s)for(o=2;o<n;)t.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)t.lineTo(r[o],r[o+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():G3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),r=t.length,n=this.tension(),i=bm(t[r-2],t[r-1],t[0],t[1],t[2],t[3],n),a=bm(t[r-4],t[r-3],t[r-2],t[r-1],t[0],t[1],n),s=G3(t,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],t[r-2],t[r-1],a[2],a[3],i[0],i[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};mu.Line=zs;zs.prototype.className="Line";zs.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Wb._registerNode)(zs);Ph.Factory.addGetterSetter(zs,"closed",!1);Ph.Factory.addGetterSetter(zs,"bezier",!1);Ph.Factory.addGetterSetter(zs,"tension",0,(0,Mw.getNumberValidator)());Ph.Factory.addGetterSetter(zs,"points",[],(0,Mw.getNumberArrayValidator)());var uc={},Bw={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(s,o,u)=>{let f,d;const g=u/2;f=0;for(let v=0;v<20;v++)d=g*e.tValues[20][v]+g,f+=e.cValues[20][v]*n(s,o,d);return g*f};e.getCubicArcLength=t;const r=(s,o,u)=>{u===void 0&&(u=1);const f=s[0]-2*s[1]+s[2],d=o[0]-2*o[1]+o[2],p=2*s[1]-2*s[0],g=2*o[1]-2*o[0],v=4*(f*f+d*d),m=4*(f*p+d*g),y=p*p+g*g;if(v===0)return u*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const E=m/(2*v),k=y/v,w=u+E,x=k-E*E,C=w*w+x>0?Math.sqrt(w*w+x):0,A=E*E+x>0?Math.sqrt(E*E+x):0,P=E+Math.sqrt(E*E+x)!==0?x*Math.log(Math.abs((w+C)/(E+A))):0;return Math.sqrt(v)/2*(w*C-E*A+P)};e.getQuadraticArcLength=r;function n(s,o,u){const f=i(1,u,s),d=i(1,u,o),p=f*f+d*d;return Math.sqrt(p)}const i=(s,o,u)=>{const f=u.length-1;let d,p;if(f===0)return 0;if(s===0){p=0;for(let g=0;g<=f;g++)p+=e.binomialCoefficients[f][g]*Math.pow(1-o,f-g)*Math.pow(o,g)*u[g];return p}else{d=new Array(f);for(let g=0;g<f;g++)d[g]=f*(u[g+1]-u[g]);return i(s-1,o,d)}},a=(s,o,u)=>{let f=1,d=s/o,p=(s-u(d))/o,g=0;for(;f>.001;){const v=u(d+p),m=Math.abs(s-v)/o;if(m<f)f=m,d+=p;else{const y=u(d-p),E=Math.abs(s-y)/o;E<f?(f=E,d-=p):p/=2}if(g++,g>500)break}return d};e.t2length=a})(Bw);Object.defineProperty(uc,"__esModule",{value:!0});uc.Path=void 0;const Xb=mt,Kb=pt,Yb=Dr,fl=Bw;class Ar extends Yb.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ar.parsePathData(this.data()),this.pathLength=Ar.getPathLength(this.dataArray)}_sceneFunc(t){const r=this.dataArray;t.beginPath();let n=!1;for(let i=0;i<r.length;i++){const a=r[i].command,s=r[i].points;switch(a){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":const o=s[0],u=s[1],f=s[2],d=s[3],p=s[4],g=s[5],v=s[6],m=s[7],y=f>d?f:d,E=f>d?1:f/d,k=f>d?d/f:1;t.translate(o,u),t.rotate(v),t.scale(E,k),t.arc(0,0,y,p,p+g,1-m),t.scale(1/E,1/k),t.rotate(-v),t.translate(-o,-u);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],d=u.points[5],p=u.points[4]+d;let g=Math.PI/180;if(Math.abs(f-p)<g&&(g=Math.abs(f-p)),d<0)for(let v=f-g;v>p;v-=g){const m=Ar.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}else for(let v=f+g;v<p;v+=g){const m=Ar.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);t.push(m.x,m.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const d=Ar.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(d.x,d.y)}else t=t.concat(u.points)});let r=t[0],n=t[0],i=t[1],a=t[1],s,o;for(let u=0;u<t.length/2;u++)s=t[u*2],o=t[u*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return Ar.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,r,n,i){return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}static getPathLength(t){let r=0;for(let n=0;n<t.length;++n)r+=t[n].pathLength;return r}static getPointAtLengthOfDataArray(t,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&t>r[i].pathLength;)t-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return r[i].command==="M"?(n=r[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[i].start.x,y:r[i].start.y};const s=r[i],o=s.points;switch(s.command){case"L":return Ar.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Ar.getPointOnCubicBezier((0,fl.t2length)(t,Ar.getPathLength(r),y=>(0,fl.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Ar.getPointOnQuadraticBezier((0,fl.t2length)(t,Ar.getPathLength(r),y=>(0,fl.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":const u=o[0],f=o[1],d=o[2],p=o[3],g=o[5],v=o[6];let m=o[4];return m+=g*t/s.pathLength,Ar.getPointOnEllipticalArc(u,f,d,p,m,v)}return null}static getPointOnLine(t,r,n,i,a,s,o){s=s??r,o=o??n;const u=this.getLineLength(r,n,i,a);if(u<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?t:-t)};const f=(a-n)/(i-r),d=Math.sqrt(t*t/(1+f*f))*(i<r?-1:1),p=f*d;if(Math.abs(o-n-f*(s-r))<1e-10)return{x:s+d,y:o+p};const g=((s-r)*(i-r)+(o-n)*(a-n))/(u*u),v=r+g*(i-r),m=n+g*(a-n),y=this.getLineLength(s,o,v,m),E=Math.sqrt(t*t-y*y),k=Math.sqrt(E*E/(1+f*f))*(i<r?-1:1),w=f*k;return{x:v+k,y:m+w}}static getPointOnCubicBezier(t,r,n,i,a,s,o,u,f){function d(E){return E*E*E}function p(E){return 3*E*E*(1-E)}function g(E){return 3*E*(1-E)*(1-E)}function v(E){return(1-E)*(1-E)*(1-E)}const m=u*d(t)+s*p(t)+i*g(t)+r*v(t),y=f*d(t)+o*p(t)+a*g(t)+n*v(t);return{x:m,y}}static getPointOnQuadraticBezier(t,r,n,i,a,s,o){function u(v){return v*v}function f(v){return 2*v*(1-v)}function d(v){return(1-v)*(1-v)}const p=s*u(t)+i*f(t)+r*d(t),g=o*u(t)+a*f(t)+n*d(t);return{x:p,y:g}}static getPointOnEllipticalArc(t,r,n,i,a,s){const o=Math.cos(s),u=Math.sin(s),f={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:t+(f.x*o-f.y*u),y:r+(f.x*u+f.y*o)}}static parsePathData(t){if(!t)return[];let r=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let p=0;p<n.length;p++)r=r.replace(new RegExp(n[p],"g"),"|"+n[p]);const i=r.split("|"),a=[],s=[];let o=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let p=1;p<i.length;p++){let g=i[p],v=g.charAt(0);for(g=g.slice(1),s.length=0;d=f.exec(g);)s.push(d[0]);const m=[];for(let y=0,E=s.length;y<E;y++){if(s[y]==="00"){m.push(0,0);continue}const k=parseFloat(s[y]);isNaN(k)?m.push(0):m.push(k)}for(;m.length>0&&!isNaN(m[0]);){let y="",E=[];const k=o,w=u;let x,C,A,P,N,F,I,D,U,O;switch(v){case"l":o+=m.shift(),u+=m.shift(),y="L",E.push(o,u);break;case"L":o=m.shift(),u=m.shift(),E.push(o,u);break;case"m":const Q=m.shift(),he=m.shift();if(o+=Q,u+=he,y="M",a.length>2&&a[a.length-1].command==="z"){for(let te=a.length-2;te>=0;te--)if(a[te].command==="M"){o=a[te].points[0]+Q,u=a[te].points[1]+he;break}}E.push(o,u),v="l";break;case"M":o=m.shift(),u=m.shift(),y="M",E.push(o,u),v="L";break;case"h":o+=m.shift(),y="L",E.push(o,u);break;case"H":o=m.shift(),y="L",E.push(o,u);break;case"v":u+=m.shift(),y="L",E.push(o,u);break;case"V":u=m.shift(),y="L",E.push(o,u);break;case"C":E.push(m.shift(),m.shift(),m.shift(),m.shift()),o=m.shift(),u=m.shift(),E.push(o,u);break;case"c":E.push(o+m.shift(),u+m.shift(),o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="C",E.push(o,u);break;case"S":C=o,A=u,x=a[a.length-1],x.command==="C"&&(C=o+(o-x.points[2]),A=u+(u-x.points[3])),E.push(C,A,m.shift(),m.shift()),o=m.shift(),u=m.shift(),y="C",E.push(o,u);break;case"s":C=o,A=u,x=a[a.length-1],x.command==="C"&&(C=o+(o-x.points[2]),A=u+(u-x.points[3])),E.push(C,A,o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="C",E.push(o,u);break;case"Q":E.push(m.shift(),m.shift()),o=m.shift(),u=m.shift(),E.push(o,u);break;case"q":E.push(o+m.shift(),u+m.shift()),o+=m.shift(),u+=m.shift(),y="Q",E.push(o,u);break;case"T":C=o,A=u,x=a[a.length-1],x.command==="Q"&&(C=o+(o-x.points[0]),A=u+(u-x.points[1])),o=m.shift(),u=m.shift(),y="Q",E.push(C,A,o,u);break;case"t":C=o,A=u,x=a[a.length-1],x.command==="Q"&&(C=o+(o-x.points[0]),A=u+(u-x.points[1])),o+=m.shift(),u+=m.shift(),y="Q",E.push(C,A,o,u);break;case"A":P=m.shift(),N=m.shift(),F=m.shift(),I=m.shift(),D=m.shift(),U=o,O=u,o=m.shift(),u=m.shift(),y="A",E=this.convertEndpointToCenterParameterization(U,O,o,u,I,D,P,N,F);break;case"a":P=m.shift(),N=m.shift(),F=m.shift(),I=m.shift(),D=m.shift(),U=o,O=u,o+=m.shift(),u+=m.shift(),y="A",E=this.convertEndpointToCenterParameterization(U,O,o,u,I,D,P,N,F);break}a.push({command:y||v,points:E,start:{x:k,y:w},pathLength:this.calcLength(k,w,y||v,E)})}(v==="z"||v==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,r,n,i){let a,s,o,u;const f=Ar;switch(n){case"L":return f.getLineLength(t,r,i[0],i[1]);case"C":return(0,fl.getCubicArcLength)([t,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,fl.getQuadraticArcLength)([t,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;const d=i[4],p=i[5],g=i[4]+p;let v=Math.PI/180;if(Math.abs(d-g)<v&&(v=Math.abs(d-g)),s=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),p<0)for(u=d-v;u>g;u-=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(u=d+v;u<g;u+=v)o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],g,0),a+=f.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(t,r,n,i,a,s,o,u,f){const d=f*(Math.PI/180),p=Math.cos(d)*(t-n)/2+Math.sin(d)*(r-i)/2,g=-1*Math.sin(d)*(t-n)/2+Math.cos(d)*(r-i)/2,v=p*p/(o*o)+g*g/(u*u);v>1&&(o*=Math.sqrt(v),u*=Math.sqrt(v));let m=Math.sqrt((o*o*(u*u)-o*o*(g*g)-u*u*(p*p))/(o*o*(g*g)+u*u*(p*p)));a===s&&(m*=-1),isNaN(m)&&(m=0);const y=m*o*g/u,E=m*-u*p/o,k=(t+n)/2+Math.cos(d)*y-Math.sin(d)*E,w=(r+i)/2+Math.sin(d)*y+Math.cos(d)*E,x=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},C=function(D,U){return(D[0]*U[0]+D[1]*U[1])/(x(D)*x(U))},A=function(D,U){return(D[0]*U[1]<D[1]*U[0]?-1:1)*Math.acos(C(D,U))},P=A([1,0],[(p-y)/o,(g-E)/u]),N=[(p-y)/o,(g-E)/u],F=[(-1*p-y)/o,(-1*g-E)/u];let I=A(N,F);return C(N,F)<=-1&&(I=Math.PI),C(N,F)>=1&&(I=0),s===0&&I>0&&(I=I-2*Math.PI),s===1&&I<0&&(I=I+2*Math.PI),[k,w,o,u,P,I,d,s]}}uc.Path=Ar;Ar.prototype.className="Path";Ar.prototype._attrsAffectingSize=["data"];(0,Kb._registerNode)(Ar);Xb.Factory.addGetterSetter(Ar,"data");Object.defineProperty(Ah,"__esModule",{value:!0});Ah.Arrow=void 0;const Fh=mt,Qb=mu,Uw=rt,qb=pt,H3=uc;class Uo extends Qb.Line{_sceneFunc(t){super._sceneFunc(t);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let u,f;if(a){const g=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],v=H3.Path.calcLength(i[i.length-4],i[i.length-3],"C",g),m=H3.Path.getPointOnQuadraticBezier(Math.min(1,1-s/v),g[0],g[1],g[2],g[3],g[4],g[5]);u=n[o-2]-m.x,f=n[o-1]-m.y}else u=n[o-2]-n[o-4],f=n[o-1]-n[o-3];const d=(Math.atan2(f,u)+r)%r,p=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[o-2],n[o-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),a?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),t.rotate((Math.atan2(-f,-u)+r)%r),t.moveTo(0,0),t.lineTo(-s,p/2),t.lineTo(-s,-p/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),r=this.pointerWidth()/2;return{x:t.x,y:t.y-r,width:t.width,height:t.height+r*2}}}Ah.Arrow=Uo;Uo.prototype.className="Arrow";(0,qb._registerNode)(Uo);Fh.Factory.addGetterSetter(Uo,"pointerLength",10,(0,Uw.getNumberValidator)());Fh.Factory.addGetterSetter(Uo,"pointerWidth",10,(0,Uw.getNumberValidator)());Fh.Factory.addGetterSetter(Uo,"pointerAtBeginning",!1);Fh.Factory.addGetterSetter(Uo,"pointerAtEnding",!0);var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Circle=void 0;const Jb=mt,Zb=Dr,eO=rt,tO=pt;let fc=class extends Zb.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Nh.Circle=fc;fc.prototype._centroid=!0;fc.prototype.className="Circle";fc.prototype._attrsAffectingSize=["radius"];(0,tO._registerNode)(fc);Jb.Factory.addGetterSetter(fc,"radius",0,(0,eO.getNumberValidator)());var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.Ellipse=void 0;const yx=mt,rO=Dr,jw=rt,nO=pt;class Vs extends rO.Shape{_sceneFunc(t){const r=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),r!==n&&t.scale(1,n/r),t.arc(0,0,r,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Rh.Ellipse=Vs;Vs.prototype.className="Ellipse";Vs.prototype._centroid=!0;Vs.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,nO._registerNode)(Vs);yx.Factory.addComponentsGetterSetter(Vs,"radius",["x","y"]);yx.Factory.addGetterSetter(Vs,"radiusX",0,(0,jw.getNumberValidator)());yx.Factory.addGetterSetter(Vs,"radiusY",0,(0,jw.getNumberValidator)());var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.Image=void 0;const gg=or,jo=mt,iO=Dr,aO=pt,xu=rt;class Pi extends iO.Shape{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),r=this.hasShadow();return t&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,u=this.attrs.cropHeight;o&&u?s=[a,this.cropX(),this.cropY(),o,u,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(t.beginPath(),i?gg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)),a&&(i&&t.clip(),t.drawImage.apply(t,s))}_hitFunc(t){const r=this.width(),n=this.height(),i=this.cornerRadius();t.beginPath(),i?gg.Util.drawRoundedRectPath(t,r,n,i):t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,r;return(t=this.attrs.width)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var t,r;return(t=this.attrs.height)!==null&&t!==void 0?t:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(t,r,n=null){const i=gg.Util.createImageElement();i.onload=function(){const a=new Pi({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=t}}Ih.Image=Pi;Pi.prototype.className="Image";(0,aO._registerNode)(Pi);jo.Factory.addGetterSetter(Pi,"cornerRadius",0,(0,xu.getNumberOrArrayOfNumbersValidator)(4));jo.Factory.addGetterSetter(Pi,"image");jo.Factory.addComponentsGetterSetter(Pi,"crop",["x","y","width","height"]);jo.Factory.addGetterSetter(Pi,"cropX",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Pi,"cropY",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Pi,"cropWidth",0,(0,xu.getNumberValidator)());jo.Factory.addGetterSetter(Pi,"cropHeight",0,(0,xu.getNumberValidator)());var ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.Tag=ql.Label=void 0;const Dh=mt,sO=Dr,oO=lc,_x=rt,zw=pt,Vw=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],lO="Change.konva",cO="none",Om="up",Lm="right",Mm="down",Bm="left",uO=Vw.length;class wx extends oO.Group{constructor(t){super(t),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let r=this,n;const i=function(){r._sync()};for(n=0;n<uO;n++)t.on(Vw[n]+lO,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),r=this.getTag(),n,i,a,s,o,u,f;if(t&&r){switch(n=t.width(),i=t.height(),a=r.pointerDirection(),s=r.pointerWidth(),f=r.pointerHeight(),o=0,u=0,a){case Om:o=n/2,u=-1*f;break;case Lm:o=n+s,u=i/2;break;case Mm:o=n/2,u=i+f;break;case Bm:o=-1*s,u=i/2;break}r.setAttrs({x:-1*o,y:-1*u,width:n,height:i}),t.setAttrs({x:-1*o,y:-1*u})}}}ql.Label=wx;wx.prototype.className="Label";(0,zw._registerNode)(wx);class zo extends sO.Shape{_sceneFunc(t){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let u=0,f=0,d=0,p=0;typeof o=="number"?u=f=d=p=Math.min(o,r/2,n/2):(u=Math.min(o[0]||0,r/2,n/2),f=Math.min(o[1]||0,r/2,n/2),p=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),t.beginPath(),t.moveTo(u,0),i===Om&&(t.lineTo((r-a)/2,0),t.lineTo(r/2,-1*s),t.lineTo((r+a)/2,0)),t.lineTo(r-f,0),t.arc(r-f,f,f,Math.PI*3/2,0,!1),i===Lm&&(t.lineTo(r,(n-s)/2),t.lineTo(r+a,n/2),t.lineTo(r,(n+s)/2)),t.lineTo(r,n-p),t.arc(r-p,n-p,p,0,Math.PI/2,!1),i===Mm&&(t.lineTo((r+a)/2,n),t.lineTo(r/2,n+s),t.lineTo((r-a)/2,n)),t.lineTo(d,n),t.arc(d,n-d,d,Math.PI/2,Math.PI,!1),i===Bm&&(t.lineTo(0,(n+s)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-s)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===Om?(r-=i,o+=i):a===Mm?o+=i:a===Bm?(t-=n*1.5,s+=n):a===Lm&&(s+=n*1.5),{x:t,y:r,width:s,height:o}}}ql.Tag=zo;zo.prototype.className="Tag";(0,zw._registerNode)(zo);Dh.Factory.addGetterSetter(zo,"pointerDirection",cO);Dh.Factory.addGetterSetter(zo,"pointerWidth",0,(0,_x.getNumberValidator)());Dh.Factory.addGetterSetter(zo,"pointerHeight",0,(0,_x.getNumberValidator)());Dh.Factory.addGetterSetter(zo,"cornerRadius",0,(0,_x.getNumberOrArrayOfNumbersValidator)(4));var vu={};Object.defineProperty(vu,"__esModule",{value:!0});vu.Rect=void 0;const fO=mt,dO=Dr,hO=pt,pO=or,gO=rt;let bh=class extends dO.Shape{_sceneFunc(t){const r=this.cornerRadius(),n=this.width(),i=this.height();t.beginPath(),r?pO.Util.drawRoundedRectPath(t,n,i,r):t.rect(0,0,n,i),t.closePath(),t.fillStrokeShape(this)}};vu.Rect=bh;bh.prototype.className="Rect";(0,hO._registerNode)(bh);fO.Factory.addGetterSetter(bh,"cornerRadius",0,(0,gO.getNumberOrArrayOfNumbersValidator)(4));var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.RegularPolygon=void 0;const Gw=mt,mO=Dr,Hw=rt,xO=pt;class Vo extends mO.Shape{_sceneFunc(t){const r=this._getPoints();t.beginPath(),t.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)t.lineTo(r[n].x,r[n].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<t;i++)n.push({x:r*Math.sin(i*2*Math.PI/t),y:-1*r*Math.cos(i*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let r=t[0].x,n=t[0].y,i=t[0].x,a=t[0].y;return t.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Oh.RegularPolygon=Vo;Vo.prototype.className="RegularPolygon";Vo.prototype._centroid=!0;Vo.prototype._attrsAffectingSize=["radius"];(0,xO._registerNode)(Vo);Gw.Factory.addGetterSetter(Vo,"radius",0,(0,Hw.getNumberValidator)());Gw.Factory.addGetterSetter(Vo,"sides",0,(0,Hw.getNumberValidator)());var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.Ring=void 0;const Ww=mt,vO=Dr,$w=rt,yO=pt,W3=Math.PI*2;class Go extends vO.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,W3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),W3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Lh.Ring=Go;Go.prototype.className="Ring";Go.prototype._centroid=!0;Go.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,yO._registerNode)(Go);Ww.Factory.addGetterSetter(Go,"innerRadius",0,(0,$w.getNumberValidator)());Ww.Factory.addGetterSetter(Go,"outerRadius",0,(0,$w.getNumberValidator)());var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.Sprite=void 0;const Ho=mt,_O=Dr,wO=cc,Xw=rt,SO=pt;class va extends _O.Shape{constructor(t){super(t),this._updated=!0,this.anim=new wO.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],u=a[i+1],f=a[i+2],d=a[i+3],p=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,f,d),t.closePath(),t.fillStrokeShape(this)),p)if(s){const g=s[r],v=n*2;t.drawImage(p,o,u,f,d,g[v+0],g[v+1],f,d)}else t.drawImage(p,o,u,f,d,0,0,f,d)}_hitFunc(t){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],u=a[i+3];if(t.beginPath(),s){const f=s[r],d=n*2;t.rect(f[d+0],f[d+1],o,u)}else t.rect(0,0,o,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}}Mh.Sprite=va;va.prototype.className="Sprite";(0,SO._registerNode)(va);Ho.Factory.addGetterSetter(va,"animation");Ho.Factory.addGetterSetter(va,"animations");Ho.Factory.addGetterSetter(va,"frameOffsets");Ho.Factory.addGetterSetter(va,"image");Ho.Factory.addGetterSetter(va,"frameIndex",0,(0,Xw.getNumberValidator)());Ho.Factory.addGetterSetter(va,"frameRate",17,(0,Xw.getNumberValidator)());Ho.Factory.backCompat(va,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Star=void 0;const Sx=mt,kO=Dr,kx=rt,EO=pt;class Gs extends kO.Shape{_sceneFunc(t){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),u=-1*s*Math.cos(a*Math.PI/i);t.lineTo(o,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Bh.Star=Gs;Gs.prototype.className="Star";Gs.prototype._centroid=!0;Gs.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,EO._registerNode)(Gs);Sx.Factory.addGetterSetter(Gs,"numPoints",5,(0,kx.getNumberValidator)());Sx.Factory.addGetterSetter(Gs,"innerRadius",0,(0,kx.getNumberValidator)());Sx.Factory.addGetterSetter(Gs,"outerRadius",0,(0,kx.getNumberValidator)());var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.Text=void 0;dc.stringToArray=lo;const Um=or,yn=mt,CO=Dr,mg=pt,Hs=rt,TO=pt;function lo(e){return[...e].reduce((t,r,n,i)=>{if(/\p{Emoji}/u.test(r)){const a=i[n+1];a&&/\p{Emoji_Modifier}|\u200D/u.test(a)?(t.push(r+a),i[n+1]=""):t.push(r)}else/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?t.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?t[t.length-1]+=r:r&&t.push(r);return t},[])}const dl="auto",AO="center",Kw="inherit",Hc="justify",PO="Change.konva",FO="2d",$3="-",Yw="left",NO="text",RO="Text",IO="top",DO="bottom",X3="middle",Qw="normal",bO="px ",zf=" ",OO="right",K3="rtl",LO="word",MO="char",Y3="none",xg="",qw=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],BO=qw.length;function UO(e){return e.split(",").map(t=>{t=t.trim();const r=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return r&&!n&&(t=`"${t}"`),t}).join(", ")}let Vf;function vg(){return Vf||(Vf=Um.Util.createCanvasElement().getContext(FO),Vf)}function jO(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function zO(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function VO(e){return e=e||{},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||"black"),e}let dr=class extends CO.Shape{constructor(t){super(VO(t)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<BO;r++)this.on(qw[r]+PO,this._setTextData);this._setTextData()}_sceneFunc(t){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),u=this.direction(),f=0,d=this.align(),p=this.getWidth(),g=this.letterSpacing(),v=this.fill(),m=this.textDecoration(),y=m.indexOf("underline")!==-1,E=m.indexOf("line-through")!==-1,k;u=u===Kw?t.direction:u;let w=s/2,x=X3;if(mg.Konva._fixTextRendering){const C=this.measureSize("M");x="alphabetic",w=(C.fontBoundingBoxAscent-C.fontBoundingBoxDescent)/2+s/2}for(u===K3&&t.setAttr("direction",u),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",x),t.setAttr("textAlign",Yw),o===X3?f=(this.getHeight()-n*s-i*2)/2:o===DO&&(f=this.getHeight()-n*s-i*2),t.translate(i,f+i),k=0;k<n;k++){let C=0,A=0;const P=r[k],N=P.text,F=P.width,I=P.lastInParagraph;if(t.save(),d===OO?C+=p-F-i*2:d===AO&&(C+=(p-F-i*2)/2),y){t.save(),t.beginPath();const D=mg.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),U=C,O=w+A+D;t.moveTo(U,O);const Q=d===Hc&&!I?p-i*2:F;t.lineTo(U+Math.round(Q),O),t.lineWidth=a/15;const he=this._getLinearGradient();t.strokeStyle=he||v,t.stroke(),t.restore()}if(E){t.save(),t.beginPath();const D=mg.Konva._fixTextRendering?-Math.round(a/4):0;t.moveTo(C,w+A+D);const U=d===Hc&&!I?p-i*2:F;t.lineTo(C+Math.round(U),w+A+D),t.lineWidth=a/15;const O=this._getLinearGradient();t.strokeStyle=O||v,t.stroke(),t.restore()}if(u!==K3&&(g!==0||d===Hc)){const D=N.split(" ").length-1,U=lo(N);for(let O=0;O<U.length;O++){const Q=U[O];Q===" "&&!I&&d===Hc&&(C+=(p-i*2-F)/D),this._partialTextX=C,this._partialTextY=w+A,this._partialText=Q,t.fillStrokeShape(this),C+=this.measureSize(Q).width+g}}else g!==0&&t.setAttr("letterSpacing",`${g}px`),this._partialTextX=C,this._partialTextY=w+A,this._partialText=N,t.fillStrokeShape(this);t.restore(),n>1&&(w+=s)}}_hitFunc(t){const r=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,r,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const r=Um.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(NO,r),this}getWidth(){return this.attrs.width===dl||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===dl||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Um.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var r,n,i,a,s,o,u,f,d,p,g;let v=vg(),m=this.fontSize(),y;v.save(),v.font=this._getContextFont(),y=v.measureText(t),v.restore();const E=m/100;return{actualBoundingBoxAscent:(r=y.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*E,actualBoundingBoxDescent:(n=y.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=y.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*E,actualBoundingBoxRight:(a=y.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*E,alphabeticBaseline:(s=y.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=y.emHeightAscent)!==null&&o!==void 0?o:100*E,emHeightDescent:(u=y.emHeightDescent)!==null&&u!==void 0?u:-20*E,fontBoundingBoxAscent:(f=y.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*E,fontBoundingBoxDescent:(d=y.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*E,hangingBaseline:(p=y.hangingBaseline)!==null&&p!==void 0?p:72.80000305175781*E,ideographicBaseline:(g=y.ideographicBaseline)!==null&&g!==void 0?g:-21*E,width:y.width,height:m}}_getContextFont(){return this.fontStyle()+zf+this.fontVariant()+zf+(this.fontSize()+bO)+UO(this.fontFamily())}_addTextLine(t){this.align()===Hc&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const r=this.letterSpacing(),n=t.length;return vg().measureText(t).width+r*n}_setTextData(){let t=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==dl&&a!==void 0,u=s!==dl&&s!==void 0,f=this.padding(),d=a-f*2,p=s-f*2,g=0,v=this.wrap(),m=v!==Y3,y=v!==MO&&m,E=this.ellipsis();this.textArr=[],vg().font=this._getContextFont();const k=E?this._getTextWidth(xg):0;for(let w=0,x=t.length;w<x;++w){let C=t[w],A=this._getTextWidth(C);if(o&&A>d)for(;C.length>0;){let P=0,N=lo(C).length,F="",I=0;for(;P<N;){const D=P+N>>>1,U=lo(C),O=U.slice(0,D+1).join(""),Q=this._getTextWidth(O);(E&&u&&g+i>p?Q+k:Q)<=d?(P=D+1,F=O,I=Q):N=D}if(F){if(y){const O=lo(C),Q=lo(F),he=O[Q.length],te=he===zf||he===$3;let Ee;if(te&&I<=d)Ee=Q.length;else{const we=Q.lastIndexOf(zf),se=Q.lastIndexOf($3);Ee=Math.max(we,se)+1}Ee>0&&(P=Ee,F=O.slice(0,P).join(""),I=this._getTextWidth(F))}if(F=F.trimRight(),this._addTextLine(F),n=Math.max(n,I),g+=i,this._shouldHandleEllipsis(g)){this._tryToAddEllipsisToLastLine();break}if(C=lo(C).slice(P).join("").trimLeft(),C.length>0&&(A=this._getTextWidth(C),A<=d)){this._addTextLine(C),g+=i,n=Math.max(n,A);break}}else break}else this._addTextLine(C),g+=i,n=Math.max(n,A),this._shouldHandleEllipsis(g)&&w<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&g+i>p)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(t){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==dl&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==Y3)||a&&t+n>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,r=t!==dl&&t!==void 0,n=this.padding(),i=t-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+xg)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+xg))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return t&&r?!0:super._useBufferCanvas()}};dc.Text=dr;dr.prototype._fillFunc=jO;dr.prototype._strokeFunc=zO;dr.prototype.className=RO;dr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,TO._registerNode)(dr);yn.Factory.overWriteSetter(dr,"width",(0,Hs.getNumberOrAutoValidator)());yn.Factory.overWriteSetter(dr,"height",(0,Hs.getNumberOrAutoValidator)());yn.Factory.addGetterSetter(dr,"direction",Kw);yn.Factory.addGetterSetter(dr,"fontFamily","Arial");yn.Factory.addGetterSetter(dr,"fontSize",12,(0,Hs.getNumberValidator)());yn.Factory.addGetterSetter(dr,"fontStyle",Qw);yn.Factory.addGetterSetter(dr,"fontVariant",Qw);yn.Factory.addGetterSetter(dr,"padding",0,(0,Hs.getNumberValidator)());yn.Factory.addGetterSetter(dr,"align",Yw);yn.Factory.addGetterSetter(dr,"verticalAlign",IO);yn.Factory.addGetterSetter(dr,"lineHeight",1,(0,Hs.getNumberValidator)());yn.Factory.addGetterSetter(dr,"wrap",LO);yn.Factory.addGetterSetter(dr,"ellipsis",!1,(0,Hs.getBooleanValidator)());yn.Factory.addGetterSetter(dr,"letterSpacing",0,(0,Hs.getNumberValidator)());yn.Factory.addGetterSetter(dr,"text","",(0,Hs.getStringValidator)());yn.Factory.addGetterSetter(dr,"textDecoration","");var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});Uh.TextPath=void 0;const yg=or,qi=mt,GO=Dr,Wc=uc,_g=dc,Jw=rt,HO=pt,WO="",Zw="normal";function eS(e){e.fillText(this.partialText,0,0)}function tS(e){e.strokeText(this.partialText,0,0)}class br extends GO.Shape{constructor(t){super(t),this.dummyCanvas=yg.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Wc.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const r=this.pathLength;return t-1>r?null:Wc.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Wc.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&t.beginPath();for(let s=0;s<a.length;s++){t.save();const o=a[s].p0;t.translate(o.x,o.y),t.rotate(a[s].rotation),this.partialText=a[s].text,t.fillStrokeShape(this),r==="underline"&&(s===0&&t.moveTo(0,i/2+1),t.lineTo(i,i/2+1)),t.restore()}r==="underline"&&(t.strokeStyle=n,t.lineWidth=i/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;t.lineTo(i.x,i.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return yg.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return _g.Text.prototype.setText.call(this,t)}_getContextFont(){return _g.Text.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(t);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const u=(0,_g.stringToArray)(this.text());let f=o;for(let d=0;d<u.length;d++){const p=this._getPointAtLength(f);if(!p)return;let g=this._getTextSize(u[d]).width+n;if(u[d]===" "&&i==="justify"){const w=this.text().split(" ").length-1;g+=(this.pathLength-s)/w}const v=this._getPointAtLength(f+g);if(!v)return;const m=Wc.Path.getLineLength(p.x,p.y,v.x,v.y);let y=0;if(a)try{y=a(u[d-1],u[d])*this.fontSize()}catch{y=0}p.x+=y,v.x+=y,this.textWidth+=y;const E=Wc.Path.getPointOnLine(y+m/2,p.x,p.y,v.x,v.y),k=Math.atan2(v.y-p.y,v.x-p.x);this.glyphInfo.push({transposeX:E.x,transposeY:E.y,text:u[d],rotation:k,p0:p,p1:v}),f+=g}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(f){t.push(f.p0.x),t.push(f.p0.y),t.push(f.p1.x),t.push(f.p1.y)});let r=t[0]||0,n=t[0]||0,i=t[1]||0,a=t[1]||0,s,o;for(let f=0;f<t.length/2;f++)s=t[f*2],o=t[f*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const u=this.fontSize();return{x:r-u/2,y:i-u/2,width:n-r+u,height:a-i+u}}destroy(){return yg.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Uh.TextPath=br;br.prototype._fillFunc=eS;br.prototype._strokeFunc=tS;br.prototype._fillFuncHit=eS;br.prototype._strokeFuncHit=tS;br.prototype.className="TextPath";br.prototype._attrsAffectingSize=["text","fontSize","data"];(0,HO._registerNode)(br);qi.Factory.addGetterSetter(br,"data");qi.Factory.addGetterSetter(br,"fontFamily","Arial");qi.Factory.addGetterSetter(br,"fontSize",12,(0,Jw.getNumberValidator)());qi.Factory.addGetterSetter(br,"fontStyle",Zw);qi.Factory.addGetterSetter(br,"align","left");qi.Factory.addGetterSetter(br,"letterSpacing",0,(0,Jw.getNumberValidator)());qi.Factory.addGetterSetter(br,"textBaseline","middle");qi.Factory.addGetterSetter(br,"fontVariant",Zw);qi.Factory.addGetterSetter(br,"text",WO);qi.Factory.addGetterSetter(br,"textDecoration","");qi.Factory.addGetterSetter(br,"kerningFunc",void 0);var jh={};Object.defineProperty(jh,"__esModule",{value:!0});jh.Transformer=void 0;const jt=or,Dt=mt,Q3=tr,$O=Dr,XO=vu,q3=lc,Bi=pt,Ws=rt,KO=pt,rS="tr-konva",YO=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(e=>e+`.${rS}`).join(" "),J3="nodesRect",QO=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],qO={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},JO="ontouchstart"in Bi.Konva._global;function ZO(e,t,r){if(e==="rotater")return r;t+=jt.Util.degToRad(qO[e]||0);const n=(jt.Util.radToDeg(t)%360+360)%360;return jt.Util._inRange(n,315+22.5,360)||jt.Util._inRange(n,0,22.5)?"ns-resize":jt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":jt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":jt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":jt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":jt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":jt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":jt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(jt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Hd=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Z3=1e8;function eL(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function nS(e,t,r){const n=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),i=r.y+(e.x-r.x)*Math.sin(t)+(e.y-r.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:n,y:i}}function tL(e,t){const r=eL(e);return nS(e,t,r)}function rL(e,t,r){let n=t;for(let i=0;i<e.length;i++){const a=Bi.Konva.getAngle(e[i]),s=Math.abs(a-t)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let jm=0;class St extends q3.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(YO,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return jt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return rS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const r=t.filter(i=>i.isAncestorOf(this)?(jt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=r,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a)}i.on(QO.map(s=>s+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let r;t.on(`dragstart.${this._getEventNamespace()}`,n=>{r=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=t.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const u=o.getAbsolutePosition();o.setAbsolutePosition({x:u.x+a,y:u.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(J3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(J3,this.__getNodeRect)}__getNodeShape(t,r=this.rotation(),n){const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),s=t.getAbsolutePosition(n),o=i.x*a.x-t.offsetX()*a.x,u=i.y*a.y-t.offsetY()*a.y,f=(Bi.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:s.x+o*Math.cos(f)+u*Math.sin(-f),y:s.y+u*Math.cos(f)+o*Math.sin(f),width:i.width*a.x,height:i.height*a.y,rotation:f};return nS(d,-Bi.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Z3,y:-Z3,width:0,height:0,rotation:0};const r=[];this.nodes().map(f=>{const d=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),p=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],g=f.getAbsoluteTransform();p.forEach(function(v){const m=g.point(v);r.push(m)})});const n=new jt.Transform;n.rotate(-Bi.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(f){const d=n.point(f);i===void 0&&(i=s=d.x,a=o=d.y),i=Math.min(i,d.x),a=Math.min(a,d.y),s=Math.max(s,d.x),o=Math.max(o,d.y)}),n.invert();const u=n.point({x:i,y:a});return{x:u.x,y:u.y,width:s-i,height:o-a,rotation:Bi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Hd.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const r=new XO.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:JO?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=Bi.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=ZO(t,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const t=new $O.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*jt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",r=>{r.cancelBubble=!0}),t.on("dragmove",r=>{r.cancelBubble=!0}),t.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},jm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:t.evt,target:u})})}_handleMouseMove(t){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(t);const o=s.getPointerPosition();let u={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const f=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,t)),a.setAbsolutePosition(u);const d=a.getAbsolutePosition();if(f.x===d.x&&f.y===d.y)return;if(this._movingAnchorName==="rotater"){const w=this._getNodeRect();r=a.x()-w.width/2,n=-a.y()+w.height/2;let x=Math.atan2(-n,r)+Math.PI/2;w.height<0&&(x-=Math.PI);const A=Bi.Konva.getAngle(this.rotation())+x,P=Bi.Konva.getAngle(this.rotationSnapTolerance()),F=rL(this.rotationSnaps(),A,P)-w.rotation,I=tL(w,F);this._fitNodesInto(I,t);return}const p=this.shiftBehavior();let g;p==="inverted"?g=this.keepRatio()&&!t.shiftKey:p==="none"?g=this.keepRatio():g=this.keepRatio()||t.shiftKey;let v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-left").x()>w.x?-1:1,C=this.findOne(".top-left").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".top-left").x(w.x-r),this.findOne(".top-left").y(w.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(w.y-a.y(),2));const x=this.findOne(".top-right").x()<w.x?-1:1,C=this.findOne(".top-right").y()>w.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".top-right").x(w.x+r),this.findOne(".top-right").y(w.y-n)}var m=a.position();this.findOne(".top-left").y(m.y),this.findOne(".bottom-right").x(m.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(w.x-a.x(),2)+Math.pow(a.y()-w.y,2));const x=w.x<a.x()?-1:1,C=a.y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,a.x(w.x-r),a.y(w.y+n)}m=a.position(),this.findOne(".top-left").x(m.x),this.findOne(".bottom-right").y(m.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(g){const w=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-w.x,2)+Math.pow(a.y()-w.y,2));const x=this.findOne(".bottom-right").x()<w.x?-1:1,C=this.findOne(".bottom-right").y()<w.y?-1:1;r=i*this.cos*x,n=i*this.sin*C,this.findOne(".bottom-right").x(w.x+r),this.findOne(".bottom-right").y(w.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(v=this.centeredScaling()||t.altKey,v){const w=this.findOne(".top-left"),x=this.findOne(".bottom-right"),C=w.x(),A=w.y(),P=this.getWidth()-x.x(),N=this.getHeight()-x.y();x.move({x:-C,y:-A}),w.move({x:P,y:N})}const y=this.findOne(".top-left").getAbsolutePosition();r=y.x,n=y.y;const E=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:E,height:k,rotation:Bi.Konva.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();jm--,this._fire("transformend",{evt:t,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:t,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,r){const n=this._getNodeRect(),i=1;if(jt.Util._inRange(t.width,-this.padding()*2-i,i)){this.update();return}if(jt.Util._inRange(t.height,-this.padding()*2-i,i)){this.update();return}const a=new jt.Transform;if(a.rotate(Bi.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const g=a.point({x:-this.padding()*2,y:0});t.x+=g.x,t.y+=g.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const g=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const g=a.point({x:0,y:-this.padding()*2});t.x+=g.x,t.y+=g.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const g=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const g=this.boundBoxFunc()(n,t);g?t=g:jt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new jt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const u=new jt.Transform,f=t.width/s,d=t.height/s;this.flipEnabled()===!1?(u.translate(t.x,t.y),u.rotate(t.rotation),u.translate(t.width<0?t.width:0,t.height<0?t.height:0),u.scale(Math.abs(f),Math.abs(d))):(u.translate(t.x,t.y),u.rotate(t.rotation),u.scale(f,d));const p=u.multiply(o.invert());this._nodes.forEach(g=>{var v;const m=g.getParent().getAbsoluteTransform(),y=g.getTransform().copy();y.translate(g.offsetX(),g.offsetY());const E=new jt.Transform;E.multiply(m.copy().invert()).multiply(p).multiply(m).multiply(y);const k=E.decompose();g.setAttrs(k),(v=g.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(jt.Util._getRotation(t.rotation)),this._nodes.forEach(g=>{this._fire("transform",{evt:r,target:g}),g._fire("transform",{evt:r,target:g})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,r){this.findOne(t).setAttrs(r)}update(){var t;const r=this._getNodeRect();this.rotation(jt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(p=>{p.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+o,offsetY:u/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-o,offsetY:u/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-o,offsetY:u/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*jt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&f.forEach(p=>{d(p)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),q3.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Q3.Node.prototype.toObject.call(this)}clone(t){return Q3.Node.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}jh.Transformer=St;St.isTransforming=()=>jm>0;function nL(e){return e instanceof Array||jt.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach(function(t){Hd.indexOf(t)===-1&&jt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Hd.join(", "))}),e||[]}St.prototype.className="Transformer";(0,KO._registerNode)(St);Dt.Factory.addGetterSetter(St,"enabledAnchors",Hd,nL);Dt.Factory.addGetterSetter(St,"flipEnabled",!0,(0,Ws.getBooleanValidator)());Dt.Factory.addGetterSetter(St,"resizeEnabled",!0);Dt.Factory.addGetterSetter(St,"anchorSize",10,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"rotateEnabled",!0);Dt.Factory.addGetterSetter(St,"rotateLineVisible",!0);Dt.Factory.addGetterSetter(St,"rotationSnaps",[]);Dt.Factory.addGetterSetter(St,"rotateAnchorOffset",50,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"rotateAnchorCursor","crosshair");Dt.Factory.addGetterSetter(St,"rotationSnapTolerance",5,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"borderEnabled",!0);Dt.Factory.addGetterSetter(St,"anchorStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(St,"anchorStrokeWidth",1,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"anchorFill","white");Dt.Factory.addGetterSetter(St,"anchorCornerRadius",0,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"borderStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(St,"borderStrokeWidth",1,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"borderDash");Dt.Factory.addGetterSetter(St,"keepRatio",!0);Dt.Factory.addGetterSetter(St,"shiftBehavior","default");Dt.Factory.addGetterSetter(St,"centeredScaling",!1);Dt.Factory.addGetterSetter(St,"ignoreStroke",!1);Dt.Factory.addGetterSetter(St,"padding",0,(0,Ws.getNumberValidator)());Dt.Factory.addGetterSetter(St,"nodes");Dt.Factory.addGetterSetter(St,"node");Dt.Factory.addGetterSetter(St,"boundBoxFunc");Dt.Factory.addGetterSetter(St,"anchorDragBoundFunc");Dt.Factory.addGetterSetter(St,"anchorStyleFunc");Dt.Factory.addGetterSetter(St,"shouldOverdrawWholeArea",!1);Dt.Factory.addGetterSetter(St,"useSingleNodeRotation",!0);Dt.Factory.backCompat(St,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});zh.Wedge=void 0;const Vh=mt,iL=Dr,aL=pt,iS=rt,sL=pt;class qa extends iL.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,aL.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}zh.Wedge=qa;qa.prototype.className="Wedge";qa.prototype._centroid=!0;qa.prototype._attrsAffectingSize=["radius"];(0,sL._registerNode)(qa);Vh.Factory.addGetterSetter(qa,"radius",0,(0,iS.getNumberValidator)());Vh.Factory.addGetterSetter(qa,"angle",0,(0,iS.getNumberValidator)());Vh.Factory.addGetterSetter(qa,"clockwise",!1);Vh.Factory.backCompat(qa,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});Gh.Blur=void 0;const e5=mt,oL=tr,lL=rt;function t5(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const cL=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],uL=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function fL(e,t){const r=e.data,n=e.width,i=e.height;let a,s,o,u,f,d,p,g,v,m,y,E,k,w,x,C,A,P,N,F;const I=t+t+1,D=n-1,U=i-1,O=t+1,Q=O*(O+1)/2,he=new t5,te=cL[t],Ee=uL[t];let we=null,se=he,X=null,ce=null;for(let Se=1;Se<I;Se++)se=se.next=new t5,Se===O&&(we=se);se.next=he,o=s=0;for(let Se=0;Se<i;Se++){E=k=w=x=u=f=d=p=0,g=O*(C=r[s]),v=O*(A=r[s+1]),m=O*(P=r[s+2]),y=O*(N=r[s+3]),u+=Q*C,f+=Q*A,d+=Q*P,p+=Q*N,se=he;for(let L=0;L<O;L++)se.r=C,se.g=A,se.b=P,se.a=N,se=se.next;for(let L=1;L<O;L++)a=s+((D<L?D:L)<<2),u+=(se.r=C=r[a])*(F=O-L),f+=(se.g=A=r[a+1])*F,d+=(se.b=P=r[a+2])*F,p+=(se.a=N=r[a+3])*F,E+=C,k+=A,w+=P,x+=N,se=se.next;X=he,ce=we;for(let L=0;L<n;L++)r[s+3]=N=p*te>>Ee,N!==0?(N=255/N,r[s]=(u*te>>Ee)*N,r[s+1]=(f*te>>Ee)*N,r[s+2]=(d*te>>Ee)*N):r[s]=r[s+1]=r[s+2]=0,u-=g,f-=v,d-=m,p-=y,g-=X.r,v-=X.g,m-=X.b,y-=X.a,a=o+((a=L+t+1)<D?a:D)<<2,E+=X.r=r[a],k+=X.g=r[a+1],w+=X.b=r[a+2],x+=X.a=r[a+3],u+=E,f+=k,d+=w,p+=x,X=X.next,g+=C=ce.r,v+=A=ce.g,m+=P=ce.b,y+=N=ce.a,E-=C,k-=A,w-=P,x-=N,ce=ce.next,s+=4;o+=n}for(let Se=0;Se<n;Se++){k=w=x=E=f=d=p=u=0,s=Se<<2,g=O*(C=r[s]),v=O*(A=r[s+1]),m=O*(P=r[s+2]),y=O*(N=r[s+3]),u+=Q*C,f+=Q*A,d+=Q*P,p+=Q*N,se=he;for(let q=0;q<O;q++)se.r=C,se.g=A,se.b=P,se.a=N,se=se.next;let L=n;for(let q=1;q<=t;q++)s=L+Se<<2,u+=(se.r=C=r[s])*(F=O-q),f+=(se.g=A=r[s+1])*F,d+=(se.b=P=r[s+2])*F,p+=(se.a=N=r[s+3])*F,E+=C,k+=A,w+=P,x+=N,se=se.next,q<U&&(L+=n);s=Se,X=he,ce=we;for(let q=0;q<i;q++)a=s<<2,r[a+3]=N=p*te>>Ee,N>0?(N=255/N,r[a]=(u*te>>Ee)*N,r[a+1]=(f*te>>Ee)*N,r[a+2]=(d*te>>Ee)*N):r[a]=r[a+1]=r[a+2]=0,u-=g,f-=v,d-=m,p-=y,g-=X.r,v-=X.g,m-=X.b,y-=X.a,a=Se+((a=q+O)<U?a:U)*n<<2,u+=E+=X.r=r[a],f+=k+=X.g=r[a+1],d+=w+=X.b=r[a+2],p+=x+=X.a=r[a+3],X=X.next,g+=C=ce.r,v+=A=ce.g,m+=P=ce.b,y+=N=ce.a,E-=C,k-=A,w-=P,x-=N,ce=ce.next,s+=n}}const dL=function(t){const r=Math.round(this.blurRadius());r>0&&fL(t,r)};Gh.Blur=dL;e5.Factory.addGetterSetter(oL.Node,"blurRadius",0,(0,lL.getNumberValidator)(),e5.Factory.afterSetFilter);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});Hh.Brighten=void 0;const r5=mt,hL=tr,pL=rt,gL=function(e){const t=this.brightness()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=4)r[i]+=t,r[i+1]+=t,r[i+2]+=t};Hh.Brighten=gL;r5.Factory.addGetterSetter(hL.Node,"brightness",0,(0,pL.getNumberValidator)(),r5.Factory.afterSetFilter);var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});Wh.Contrast=void 0;const n5=mt,mL=tr,xL=rt,vL=function(e){const t=Math.pow((this.contrast()+100)/100,2),r=e.data,n=r.length;let i=150,a=150,s=150;for(let o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};Wh.Contrast=vL;n5.Factory.addGetterSetter(mL.Node,"contrast",0,(0,xL.getNumberValidator)(),n5.Factory.afterSetFilter);var $h={};Object.defineProperty($h,"__esModule",{value:!0});$h.Emboss=void 0;const Os=mt,Xh=tr,yL=or,aS=rt,_L=function(e){const t=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=e.data,s=e.width,o=e.height,u=s*4;let f=0,d=0,p=o;switch(n){case"top-left":f=-1,d=-1;break;case"top":f=-1,d=0;break;case"top-right":f=-1,d=1;break;case"right":f=0,d=1;break;case"bottom-right":f=1,d=1;break;case"bottom":f=1,d=0;break;case"bottom-left":f=1,d=-1;break;case"left":f=0,d=-1;break;default:yL.Util.error("Unknown emboss direction: "+n)}do{const g=(p-1)*u;let v=f;p+v<1&&(v=0),p+v>o&&(v=0);const m=(p-1+v)*s*4;let y=s;do{const E=g+(y-1)*4;let k=d;y+k<1&&(k=0),y+k>s&&(k=0);const w=m+(y-1+k)*4,x=a[E]-a[w],C=a[E+1]-a[w+1],A=a[E+2]-a[w+2];let P=x;const N=P>0?P:-P,F=C>0?C:-C,I=A>0?A:-A;if(F>N&&(P=C),I>N&&(P=A),P*=t,i){const D=a[E]+P,U=a[E+1]+P,O=a[E+2]+P;a[E]=D>255?255:D<0?0:D,a[E+1]=U>255?255:U<0?0:U,a[E+2]=O>255?255:O<0?0:O}else{let D=r-P;D<0?D=0:D>255&&(D=255),a[E]=a[E+1]=a[E+2]=D}}while(--y)}while(--p)};$h.Emboss=_L;Os.Factory.addGetterSetter(Xh.Node,"embossStrength",.5,(0,aS.getNumberValidator)(),Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(Xh.Node,"embossWhiteLevel",.5,(0,aS.getNumberValidator)(),Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(Xh.Node,"embossDirection","top-left",void 0,Os.Factory.afterSetFilter);Os.Factory.addGetterSetter(Xh.Node,"embossBlend",!1,void 0,Os.Factory.afterSetFilter);var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});Kh.Enhance=void 0;const i5=mt,wL=tr,SL=rt;function wg(e,t,r,n,i){const a=r-t,s=i-n;if(a===0)return n+s/2;if(s===0)return n;let o=(e-t)/a;return o=s*o+n,o}const kL=function(e){const t=e.data,r=t.length;let n=t[0],i=n,a,s=t[1],o=s,u,f=t[2],d=f,p;const g=this.enhance();if(g===0)return;for(let x=0;x<r;x+=4)a=t[x+0],a<n?n=a:a>i&&(i=a),u=t[x+1],u<s?s=u:u>o&&(o=u),p=t[x+2],p<f?f=p:p>d&&(d=p);i===n&&(i=255,n=0),o===s&&(o=255,s=0),d===f&&(d=255,f=0);let v,m,y,E,k,w;if(g>0)v=i+g*(255-i),m=n-g*(n-0),y=o+g*(255-o),E=s-g*(s-0),k=d+g*(255-d),w=f-g*(f-0);else{const x=(i+n)*.5;v=i+g*(i-x),m=n+g*(n-x);const C=(o+s)*.5;y=o+g*(o-C),E=s+g*(s-C);const A=(d+f)*.5;k=d+g*(d-A),w=f+g*(f-A)}for(let x=0;x<r;x+=4)t[x+0]=wg(t[x+0],n,i,m,v),t[x+1]=wg(t[x+1],s,o,E,y),t[x+2]=wg(t[x+2],f,d,w,k)};Kh.Enhance=kL;i5.Factory.addGetterSetter(wL.Node,"enhance",0,(0,SL.getNumberValidator)(),i5.Factory.afterSetFilter);var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});Yh.Grayscale=void 0;const EL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=i,t[n+1]=i,t[n+2]=i}};Yh.Grayscale=EL;var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});Qh.HSL=void 0;const Jl=mt,Ex=tr,Cx=rt;Jl.Factory.addGetterSetter(Ex.Node,"hue",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);Jl.Factory.addGetterSetter(Ex.Node,"saturation",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);Jl.Factory.addGetterSetter(Ex.Node,"luminance",0,(0,Cx.getNumberValidator)(),Jl.Factory.afterSetFilter);const CL=function(e){const t=e.data,r=t.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),f=.299*n+.701*o+.167*u,d=.587*n-.587*o+.33*u,p=.114*n-.114*o-.497*u,g=.299*n-.299*o-.328*u,v=.587*n+.413*o+.035*u,m=.114*n-.114*o+.293*u,y=.299*n-.3*o+1.25*u,E=.587*n-.586*o-1.05*u,k=.114*n+.886*o-.2*u;let w,x,C,A;for(let P=0;P<r;P+=4)w=t[P+0],x=t[P+1],C=t[P+2],A=t[P+3],t[P+0]=f*w+d*x+p*C+s,t[P+1]=g*w+v*x+m*C+s,t[P+2]=y*w+E*x+k*C+s,t[P+3]=A};Qh.HSL=CL;var qh={};Object.defineProperty(qh,"__esModule",{value:!0});qh.HSV=void 0;const Zl=mt,Tx=tr,Ax=rt,TL=function(e){const t=e.data,r=t.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*s+.167*o,f=.587*n-.587*s+.33*o,d=.114*n-.114*s-.497*o,p=.299*n-.299*s-.328*o,g=.587*n+.413*s+.035*o,v=.114*n-.114*s+.293*o,m=.299*n-.3*s+1.25*o,y=.587*n-.586*s-1.05*o,E=.114*n+.886*s-.2*o;for(let k=0;k<r;k+=4){const w=t[k+0],x=t[k+1],C=t[k+2],A=t[k+3];t[k+0]=u*w+f*x+d*C,t[k+1]=p*w+g*x+v*C,t[k+2]=m*w+y*x+E*C,t[k+3]=A}};qh.HSV=TL;Zl.Factory.addGetterSetter(Tx.Node,"hue",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Tx.Node,"saturation",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);Zl.Factory.addGetterSetter(Tx.Node,"value",0,(0,Ax.getNumberValidator)(),Zl.Factory.afterSetFilter);var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Invert=void 0;const AL=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]};Jh.Invert=AL;var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});Zh.Kaleidoscope=void 0;const Wd=mt,sS=tr,a5=or,oS=rt,PL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,y=360/m*Math.PI/180;for(let E=0;E<m;E+=1){const k=Math.sin(E*y),w=Math.cos(E*y);for(let x=0;x<v;x+=1){d=Math.floor(o+f*x/v*w),p=Math.floor(u+f*x/v*k);let C=(p*a+d)*4;const A=n[C+0],P=n[C+1],N=n[C+2],F=n[C+3];C=(E+x*a)*4,i[C+0]=A,i[C+1]=P,i[C+2]=N,i[C+3]=F}}},FL=function(e,t,r){const n=e.data,i=t.data,a=e.width,s=e.height,o=r.polarCenterX||a/2,u=r.polarCenterY||s/2;let f=Math.sqrt(o*o+u*u),d=a-o,p=s-u;const g=Math.sqrt(d*d+p*p);f=g>f?g:f;const v=s,m=a,y=r.polarRotation||0;let E,k;for(d=0;d<a;d+=1)for(p=0;p<s;p+=1){const w=d-o,x=p-u,C=Math.sqrt(w*w+x*x)*v/f;let A=(Math.atan2(x,w)*180/Math.PI+360+y)%360;A=A*m/360,E=Math.floor(A),k=Math.floor(C);let P=(k*a+E)*4;const N=n[P+0],F=n[P+1],I=n[P+2],D=n[P+3];P=(p*a+d)*4,i[P+0]=N,i[P+1]=F,i[P+2]=I,i[P+3]=D}},NL=function(e){const t=e.width,r=e.height;let n,i,a,s,o,u,f,d,p,g,v=Math.round(this.kaleidoscopePower());const m=Math.round(this.kaleidoscopeAngle()),y=Math.floor(t*(m%360)/360);if(v<1)return;const E=a5.Util.createCanvasElement();E.width=t,E.height=r;const k=E.getContext("2d").getImageData(0,0,t,r);a5.Util.releaseCanvas(E),PL(e,k,{polarCenterX:t/2,polarCenterY:r/2});let w=t/Math.pow(2,v);for(;w<=8;)w=w*2,v-=1;w=Math.ceil(w);let x=w,C=0,A=x,P=1;for(y+w>t&&(C=x,A=0,P=-1),i=0;i<r;i+=1)for(n=C;n!==A;n+=P)a=Math.round(n+y)%t,p=(t*i+a)*4,o=k.data[p+0],u=k.data[p+1],f=k.data[p+2],d=k.data[p+3],g=(t*i+n)*4,k.data[g+0]=o,k.data[g+1]=u,k.data[g+2]=f,k.data[g+3]=d;for(i=0;i<r;i+=1)for(x=Math.floor(w),s=0;s<v;s+=1){for(n=0;n<x+1;n+=1)p=(t*i+n)*4,o=k.data[p+0],u=k.data[p+1],f=k.data[p+2],d=k.data[p+3],g=(t*i+x*2-n-1)*4,k.data[g+0]=o,k.data[g+1]=u,k.data[g+2]=f,k.data[g+3]=d;x*=2}FL(k,e,{polarRotation:0})};Zh.Kaleidoscope=NL;Wd.Factory.addGetterSetter(sS.Node,"kaleidoscopePower",2,(0,oS.getNumberValidator)(),Wd.Factory.afterSetFilter);Wd.Factory.addGetterSetter(sS.Node,"kaleidoscopeAngle",0,(0,oS.getNumberValidator)(),Wd.Factory.afterSetFilter);var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.Mask=void 0;const s5=mt,RL=tr,IL=rt;function Gf(e,t,r){let n=(r*e.width+t)*4;const i=[];return i.push(e.data[n++],e.data[n++],e.data[n++],e.data[n++]),i}function $c(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function DL(e){const t=[0,0,0];for(let r=0;r<e.length;r++)t[0]+=e[r][0],t[1]+=e[r][1],t[2]+=e[r][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function bL(e,t){const r=Gf(e,0,0),n=Gf(e,e.width-1,0),i=Gf(e,0,e.height-1),a=Gf(e,e.width-1,e.height-1),s=t||10;if($c(r,n)<s&&$c(n,a)<s&&$c(a,i)<s&&$c(i,r)<s){const o=DL([n,r,a,i]),u=[];for(let f=0;f<e.width*e.height;f++){const d=$c(o,[e.data[f*4],e.data[f*4+1],e.data[f*4+2]]);u[f]=d<s?0:255}return u}}function OL(e,t){for(let r=0;r<e.width*e.height;r++)e.data[4*r+3]=t[r]}function LL(e,t,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,E=n[p*i+g];d+=e[y]*E}}s[f]=d===255*8?255:0}return s}function ML(e,t,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,E=n[p*i+g];d+=e[y]*E}}s[f]=d>=255*4?255:0}return s}function BL(e,t,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let u=0;u<t;u++){const f=o*t+u;let d=0;for(let p=0;p<i;p++)for(let g=0;g<i;g++){const v=o+p-a,m=u+g-a;if(v>=0&&v<r&&m>=0&&m<t){const y=v*t+m,E=n[p*i+g];d+=e[y]*E}}s[f]=d}return s}const UL=function(e){const t=this.threshold();let r=bL(e,t);return r&&(r=LL(r,e.width,e.height),r=ML(r,e.width,e.height),r=BL(r,e.width,e.height),OL(e,r)),e};e1.Mask=UL;s5.Factory.addGetterSetter(RL.Node,"threshold",0,(0,IL.getNumberValidator)(),s5.Factory.afterSetFilter);var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.Noise=void 0;const o5=mt,jL=tr,zL=rt,VL=function(e){const t=this.noise()*255,r=e.data,n=r.length,i=t/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};t1.Noise=VL;o5.Factory.addGetterSetter(jL.Node,"noise",.2,(0,zL.getNumberValidator)(),o5.Factory.afterSetFilter);var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Pixelate=void 0;const l5=mt,GL=or,HL=tr,WL=rt,$L=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,n=e.height,i=Math.ceil(r/t),a=Math.ceil(n/t),s=e.data;if(t<=0){GL.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let u=0;u<a;u+=1){let f=0,d=0,p=0,g=0;const v=o*t,m=v+t,y=u*t,E=y+t;let k=0;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=y;x<E;x+=1){if(x>=n)continue;const C=(r*x+w)*4;f+=s[C+0],d+=s[C+1],p+=s[C+2],g+=s[C+3],k+=1}f=f/k,d=d/k,p=p/k,g=g/k;for(let w=v;w<m;w+=1)if(!(w>=r))for(let x=y;x<E;x+=1){if(x>=n)continue;const C=(r*x+w)*4;s[C+0]=f,s[C+1]=d,s[C+2]=p,s[C+3]=g}}};r1.Pixelate=$L;l5.Factory.addGetterSetter(HL.Node,"pixelSize",8,(0,WL.getNumberValidator)(),l5.Factory.afterSetFilter);var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Posterize=void 0;const c5=mt,XL=tr,KL=rt,YL=function(e){const t=Math.round(this.levels()*254)+1,r=e.data,n=r.length,i=255/t;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};n1.Posterize=YL;c5.Factory.addGetterSetter(XL.Node,"levels",.5,(0,KL.getNumberValidator)(),c5.Factory.afterSetFilter);var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.RGB=void 0;const $d=mt,Px=tr,QL=rt,qL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue();for(let s=0;s<r;s+=4){const o=(.34*t[s]+.5*t[s+1]+.16*t[s+2])/255;t[s]=o*n,t[s+1]=o*i,t[s+2]=o*a,t[s+3]=t[s+3]}};i1.RGB=qL;$d.Factory.addGetterSetter(Px.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});$d.Factory.addGetterSetter(Px.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});$d.Factory.addGetterSetter(Px.Node,"blue",0,QL.RGBComponent,$d.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.RGBA=void 0;const tu=mt,s1=tr,JL=rt,ZL=function(e){const t=e.data,r=t.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const u=1-s;t[o]=n*s+t[o]*u,t[o+1]=i*s+t[o+1]*u,t[o+2]=a*s+t[o+2]*u}};a1.RGBA=ZL;tu.Factory.addGetterSetter(s1.Node,"red",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});tu.Factory.addGetterSetter(s1.Node,"green",0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)});tu.Factory.addGetterSetter(s1.Node,"blue",0,JL.RGBComponent,tu.Factory.afterSetFilter);tu.Factory.addGetterSetter(s1.Node,"alpha",1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e});var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.Sepia=void 0;const eM=function(e){const t=e.data,r=t.length;for(let n=0;n<r;n+=4){const i=t[n+0],a=t[n+1],s=t[n+2];t[n+0]=Math.min(255,i*.393+a*.769+s*.189),t[n+1]=Math.min(255,i*.349+a*.686+s*.168),t[n+2]=Math.min(255,i*.272+a*.534+s*.131)}};o1.Sepia=eM;var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.Solarize=void 0;const tM=function(e){const t=e.data,r=e.width,n=e.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const u=s+(o-1)*4;let f=t[u],d=t[u+1],p=t[u+2];f>127&&(f=255-f),d>127&&(d=255-d),p>127&&(p=255-p),t[u]=f,t[u+1]=d,t[u+2]=p}while(--o)}while(--a)};l1.Solarize=tM;var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.Threshold=void 0;const u5=mt,rM=tr,nM=rt,iM=function(e){const t=this.threshold()*255,r=e.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<t?0:255};c1.Threshold=iM;u5.Factory.addGetterSetter(rM.Node,"threshold",.5,(0,nM.getNumberValidator)(),u5.Factory.afterSetFilter);Object.defineProperty(yh,"__esModule",{value:!0});yh.Konva=void 0;const f5=Vd,aM=Eh,sM=Ah,oM=Nh,lM=Rh,cM=Ih,d5=ql,uM=mu,fM=uc,dM=vu,hM=Oh,pM=Lh,gM=Mh,mM=Bh,xM=dc,vM=Uh,yM=jh,_M=zh,wM=Gh,SM=Hh,kM=Wh,EM=$h,CM=Kh,TM=Yh,AM=Qh,PM=qh,FM=Jh,NM=Zh,RM=e1,IM=t1,DM=r1,bM=n1,OM=i1,LM=a1,MM=o1,BM=l1,UM=c1;yh.Konva=f5.Konva.Util._assign(f5.Konva,{Arc:aM.Arc,Arrow:sM.Arrow,Circle:oM.Circle,Ellipse:lM.Ellipse,Image:cM.Image,Label:d5.Label,Tag:d5.Tag,Line:uM.Line,Path:fM.Path,Rect:dM.Rect,RegularPolygon:hM.RegularPolygon,Ring:pM.Ring,Sprite:gM.Sprite,Star:mM.Star,Text:xM.Text,TextPath:vM.TextPath,Transformer:yM.Transformer,Wedge:_M.Wedge,Filters:{Blur:wM.Blur,Brighten:SM.Brighten,Contrast:kM.Contrast,Emboss:EM.Emboss,Enhance:CM.Enhance,Grayscale:TM.Grayscale,HSL:AM.HSL,HSV:PM.HSV,Invert:FM.Invert,Kaleidoscope:NM.Kaleidoscope,Mask:RM.Mask,Noise:IM.Noise,Pixelate:DM.Pixelate,Posterize:bM.Posterize,RGB:OM.RGB,RGBA:LM.RGBA,Sepia:MM.Sepia,Solarize:BM.Solarize,Threshold:UM.Threshold}});var jM=Pw.exports;Object.defineProperty(jM,"__esModule",{value:!0});const zM=yh;Pw.exports=zM.Konva;var zm={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=Vd;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Vd;e.exports=n.Konva})(zm,zm.exports);var VM=zm.exports;const ru=Xd(VM);var lS={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GM=function(t){var r={},n=_e,i=s0,a=Object.assign;function s(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),m=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),A=Symbol.iterator;function P(l){return l===null||typeof l!="object"?null:(l=A&&l[A]||l["@@iterator"],typeof l=="function"?l:null)}function N(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case g:return"Profiler";case p:return"StrictMode";case E:return"Suspense";case k:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case m:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case y:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case w:return c=l.displayName||null,c!==null?c:N(l.type)||"Memo";case x:c=l._payload,l=l._init;try{return N(l(c))}catch{}}return null}function F(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(c);case 8:return c===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function I(l){var c=l,h=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(h=c.return),l=c.return;while(l)}return c.tag===3?h:null}function D(l){if(I(l)!==l)throw Error(s(188))}function U(l){var c=l.alternate;if(!c){if(c=I(l),c===null)throw Error(s(188));return c!==l?null:l}for(var h=l,_=c;;){var S=h.return;if(S===null)break;var R=S.alternate;if(R===null){if(_=S.return,_!==null){h=_;continue}break}if(S.child===R.child){for(R=S.child;R;){if(R===h)return D(S),l;if(R===_)return D(S),c;R=R.sibling}throw Error(s(188))}if(h.return!==_.return)h=S,_=R;else{for(var B=!1,J=S.child;J;){if(J===h){B=!0,h=S,_=R;break}if(J===_){B=!0,_=S,h=R;break}J=J.sibling}if(!B){for(J=R.child;J;){if(J===h){B=!0,h=R,_=S;break}if(J===_){B=!0,_=R,h=S;break}J=J.sibling}if(!B)throw Error(s(189))}}if(h.alternate!==_)throw Error(s(190))}if(h.tag!==3)throw Error(s(188));return h.stateNode.current===h?l:c}function O(l){return l=U(l),l!==null?Q(l):null}function Q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Q(l);if(c!==null)return c;l=l.sibling}return null}function he(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=he(l);if(c!==null)return c}l=l.sibling}return null}var te=Array.isArray,Ee=t.getPublicInstance,we=t.getRootHostContext,se=t.getChildHostContext,X=t.prepareForCommit,ce=t.resetAfterCommit,Se=t.createInstance,L=t.appendInitialChild,q=t.finalizeInitialChildren,Y=t.prepareUpdate,K=t.shouldSetTextContent,ue=t.createTextInstance,z=t.scheduleTimeout,ee=t.cancelTimeout,de=t.noTimeout,xe=t.isPrimaryRenderer,Me=t.supportsMutation,G=t.supportsPersistence,Ze=t.supportsHydration,nt=t.getInstanceFromNode,Ke=t.preparePortalMount,qe=t.getCurrentEventPriority,De=t.detachDeletedInstance,kt=t.supportsMicrotasks,Or=t.scheduleMicrotask,me=t.supportsTestSelectors,pe=t.findFiberRoot,Ce=t.getBoundingRect,Te=t.getTextContent,Ae=t.isHiddenSubtree,be=t.matchAccessibilityRole,Ge=t.setFocusIfFocusable,ye=t.setupIntersectionObserver,ie=t.appendChild,Pe=t.appendChildToContainer,Fe=t.commitTextUpdate,ke=t.commitMount,Qe=t.commitUpdate,Je=t.insertBefore,dt=t.insertInContainerBefore,lt=t.removeChild,vt=t.removeChildFromContainer,Ne=t.resetTextContent,Ye=t.hideInstance,Ue=t.hideTextInstance,at=t.unhideInstance,At=t.unhideTextInstance,Ot=t.clearContainer,Et=t.cloneInstance,ai=t.createContainerChildSet,Nn=t.appendChildToContainerChildSet,Hn=t.finalizeContainerChildren,$r=t.replaceContainerChildren,Qt=t.cloneHiddenInstance,Xs=t.cloneHiddenTextInstance,$o=t.canHydrateInstance,f1=t.canHydrateTextInstance,hc=t.canHydrateSuspenseInstance,yu=t.isSuspenseInstancePending,pc=t.isSuspenseInstanceFallback,d1=t.getSuspenseInstanceFallbackErrorDetails,b=t.registerSuspenseInstanceRetry,V=t.getNextHydratableSibling,M=t.getFirstHydratableChild,j=t.getFirstHydratableChildWithinContainer,H=t.getFirstHydratableChildWithinSuspenseInstance,W=t.hydrateInstance,ne=t.hydrateTextInstance,ve=t.hydrateSuspenseInstance,re=t.getNextHydratableInstanceAfterSuspenseInstance,ae=t.commitHydratedContainer,oe=t.commitHydratedSuspenseInstance,Re=t.clearSuspenseBoundary,Be=t.clearSuspenseBoundaryFromContainer,He=t.shouldDeleteUnhydratedTailInstances,Oe=t.didNotMatchHydratedContainerTextInstance,je=t.didNotMatchHydratedTextInstance,it;function Lt(l){if(it===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);it=c&&c[1]||""}return`
`+it+l}var zt=!1;function xr(l,c){if(!l||zt)return"";zt=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Le){var _=Le}Reflect.construct(l,[],c)}else{try{c.call()}catch(Le){_=Le}l.call(c.prototype)}else{try{throw Error()}catch(Le){_=Le}l()}}catch(Le){if(Le&&_&&typeof Le.stack=="string"){for(var S=Le.stack.split(`
`),R=_.stack.split(`
`),B=S.length-1,J=R.length-1;1<=B&&0<=J&&S[B]!==R[J];)J--;for(;1<=B&&0<=J;B--,J--)if(S[B]!==R[J]){if(B!==1||J!==1)do if(B--,J--,0>J||S[B]!==R[J]){var fe=`
`+S[B].replace(" at new "," at ");return l.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",l.displayName)),fe}while(1<=B&&0<=J);break}}}finally{zt=!1,Error.prepareStackTrace=h}return(l=l?l.displayName||l.name:"")?Lt(l):""}var Ks=Object.prototype.hasOwnProperty,ya=[],si=-1;function tn(l){return{current:l}}function Mt(l){0>si||(l.current=ya[si],ya[si]=null,si--)}function yt(l,c){si++,ya[si]=l.current,l.current=c}var Ja={},rn=tn(Ja),Rn=tn(!1),Ys=Ja;function Xo(l,c){var h=l.type.contextTypes;if(!h)return Ja;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===c)return _.__reactInternalMemoizedMaskedChildContext;var S={},R;for(R in h)S[R]=c[R];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=S),S}function In(l){return l=l.childContextTypes,l!=null}function _u(){Mt(Rn),Mt(rn)}function Rx(l,c,h){if(rn.current!==Ja)throw Error(s(168));yt(rn,c),yt(Rn,h)}function Ix(l,c,h){var _=l.stateNode;if(c=c.childContextTypes,typeof _.getChildContext!="function")return h;_=_.getChildContext();for(var S in _)if(!(S in c))throw Error(s(108,F(l)||"Unknown",S));return a({},h,_)}function wu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Ja,Ys=rn.current,yt(rn,l),yt(Rn,Rn.current),!0}function Dx(l,c,h){var _=l.stateNode;if(!_)throw Error(s(169));h?(l=Ix(l,c,Ys),_.__reactInternalMemoizedMergedChildContext=l,Mt(Rn),Mt(rn),yt(rn,l)):Mt(Rn),yt(Rn,h)}var Fi=Math.clz32?Math.clz32:vS,mS=Math.log,xS=Math.LN2;function vS(l){return l>>>=0,l===0?32:31-(mS(l)/xS|0)|0}var Su=64,ku=4194304;function gc(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Eu(l,c){var h=l.pendingLanes;if(h===0)return 0;var _=0,S=l.suspendedLanes,R=l.pingedLanes,B=h&268435455;if(B!==0){var J=B&~S;J!==0?_=gc(J):(R&=B,R!==0&&(_=gc(R)))}else B=h&~S,B!==0?_=gc(B):R!==0&&(_=gc(R));if(_===0)return 0;if(c!==0&&c!==_&&!(c&S)&&(S=_&-_,R=c&-c,S>=R||S===16&&(R&4194240)!==0))return c;if(_&4&&(_|=h&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=_;0<c;)h=31-Fi(c),S=1<<h,_|=l[h],c&=~S;return _}function yS(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _S(l,c){for(var h=l.suspendedLanes,_=l.pingedLanes,S=l.expirationTimes,R=l.pendingLanes;0<R;){var B=31-Fi(R),J=1<<B,fe=S[B];fe===-1?(!(J&h)||J&_)&&(S[B]=yS(J,c)):fe<=c&&(l.expiredLanes|=J),R&=~J}}function h1(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function bx(){var l=Su;return Su<<=1,!(Su&4194240)&&(Su=64),l}function p1(l){for(var c=[],h=0;31>h;h++)c.push(l);return c}function mc(l,c,h){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Fi(c),l[c]=h}function wS(l,c){var h=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<h;){var S=31-Fi(h),R=1<<S;c[S]=0,_[S]=-1,l[S]=-1,h&=~R}}function g1(l,c){var h=l.entangledLanes|=c;for(l=l.entanglements;h;){var _=31-Fi(h),S=1<<_;S&c|l[_]&c&&(l[_]|=c),h&=~S}}var Nt=0;function Ox(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var m1=i.unstable_scheduleCallback,Lx=i.unstable_cancelCallback,SS=i.unstable_shouldYield,kS=i.unstable_requestPaint,Lr=i.unstable_now,x1=i.unstable_ImmediatePriority,ES=i.unstable_UserBlockingPriority,v1=i.unstable_NormalPriority,CS=i.unstable_IdlePriority,Cu=null,Ji=null;function TS(l){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(Cu,l,void 0,(l.current.flags&128)===128)}catch{}}function AS(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Ni=typeof Object.is=="function"?Object.is:AS,_a=null,Tu=!1,y1=!1;function Mx(l){_a===null?_a=[l]:_a.push(l)}function PS(l){Tu=!0,Mx(l)}function Zi(){if(!y1&&_a!==null){y1=!0;var l=0,c=Nt;try{var h=_a;for(Nt=1;l<h.length;l++){var _=h[l];do _=_(!0);while(_!==null)}_a=null,Tu=!1}catch(S){throw _a!==null&&(_a=_a.slice(l+1)),m1(x1,Zi),S}finally{Nt=c,y1=!1}}return null}var Ko=[],Yo=0,Au=null,Pu=0,oi=[],li=0,Qs=null,wa=1,Sa="";function qs(l,c){Ko[Yo++]=Pu,Ko[Yo++]=Au,Au=l,Pu=c}function Bx(l,c,h){oi[li++]=wa,oi[li++]=Sa,oi[li++]=Qs,Qs=l;var _=wa;l=Sa;var S=32-Fi(_)-1;_&=~(1<<S),h+=1;var R=32-Fi(c)+S;if(30<R){var B=S-S%5;R=(_&(1<<B)-1).toString(32),_>>=B,S-=B,wa=1<<32-Fi(c)+S|h<<S|_,Sa=R+l}else wa=1<<R|h<<S|_,Sa=l}function _1(l){l.return!==null&&(qs(l,1),Bx(l,1,0))}function w1(l){for(;l===Au;)Au=Ko[--Yo],Ko[Yo]=null,Pu=Ko[--Yo],Ko[Yo]=null;for(;l===Qs;)Qs=oi[--li],oi[li]=null,Sa=oi[--li],oi[li]=null,wa=oi[--li],oi[li]=null}var Wn=null,ci=null,qt=!1,xc=!1,Ri=null;function Ux(l,c){var h=pi(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=l,c=l.deletions,c===null?(l.deletions=[h],l.flags|=16):c.push(h)}function jx(l,c){switch(l.tag){case 5:return c=$o(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,ci=M(c),!0):!1;case 6:return c=f1(c,l.pendingProps),c!==null?(l.stateNode=c,Wn=l,ci=null,!0):!1;case 13:if(c=hc(c),c!==null){var h=Qs!==null?{id:wa,overflow:Sa}:null;return l.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=pi(18,null,null,0),h.stateNode=c,h.return=l,l.child=h,Wn=l,ci=null,!0}return!1;default:return!1}}function S1(l){return(l.mode&1)!==0&&(l.flags&128)===0}function k1(l){if(qt){var c=ci;if(c){var h=c;if(!jx(l,c)){if(S1(l))throw Error(s(418));c=V(h);var _=Wn;c&&jx(l,c)?Ux(_,h):(l.flags=l.flags&-4097|2,qt=!1,Wn=l)}}else{if(S1(l))throw Error(s(418));l.flags=l.flags&-4097|2,qt=!1,Wn=l}}}function zx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Wn=l}function Fu(l){if(!Ze||l!==Wn)return!1;if(!qt)return zx(l),qt=!0,!1;if(l.tag!==3&&(l.tag!==5||He(l.type)&&!K(l.type,l.memoizedProps))){var c=ci;if(c){if(S1(l))throw Vx(),Error(s(418));for(;c;)Ux(l,c),c=V(c)}}if(zx(l),l.tag===13){if(!Ze)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));ci=re(l)}else ci=Wn?V(l.stateNode):null;return!0}function Vx(){for(var l=ci;l;)l=V(l)}function Qo(){Ze&&(ci=Wn=null,xc=qt=!1)}function E1(l){Ri===null?Ri=[l]:Ri.push(l)}var FS=o.ReactCurrentBatchConfig;function Nu(l,c){if(Ni(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var h=Object.keys(l),_=Object.keys(c);if(h.length!==_.length)return!1;for(_=0;_<h.length;_++){var S=h[_];if(!Ks.call(c,S)||!Ni(l[S],c[S]))return!1}return!0}function NS(l){switch(l.tag){case 5:return Lt(l.type);case 16:return Lt("Lazy");case 13:return Lt("Suspense");case 19:return Lt("SuspenseList");case 0:case 2:case 15:return l=xr(l.type,!1),l;case 11:return l=xr(l.type.render,!1),l;case 1:return l=xr(l.type,!0),l;default:return""}}function vc(l,c,h){if(l=h.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(s(309));var _=h.stateNode}if(!_)throw Error(s(147,l));var S=_,R=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===R?c.ref:(c=function(B){var J=S.refs;B===null?delete J[R]:J[R]=B},c._stringRef=R,c)}if(typeof l!="string")throw Error(s(284));if(!h._owner)throw Error(s(290,l))}return l}function Ru(l,c){throw l=Object.prototype.toString.call(c),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Gx(l){var c=l._init;return c(l._payload)}function Hx(l){function c(le,Z){if(l){var ge=le.deletions;ge===null?(le.deletions=[Z],le.flags|=16):ge.push(Z)}}function h(le,Z){if(!l)return null;for(;Z!==null;)c(le,Z),Z=Z.sibling;return null}function _(le,Z){for(le=new Map;Z!==null;)Z.key!==null?le.set(Z.key,Z):le.set(Z.index,Z),Z=Z.sibling;return le}function S(le,Z){return le=as(le,Z),le.index=0,le.sibling=null,le}function R(le,Z,ge){return le.index=ge,l?(ge=le.alternate,ge!==null?(ge=ge.index,ge<Z?(le.flags|=2,Z):ge):(le.flags|=2,Z)):(le.flags|=1048576,Z)}function B(le){return l&&le.alternate===null&&(le.flags|=2),le}function J(le,Z,ge,Ve){return Z===null||Z.tag!==6?(Z=yp(ge,le.mode,Ve),Z.return=le,Z):(Z=S(Z,ge),Z.return=le,Z)}function fe(le,Z,ge,Ve){var et=ge.type;return et===d?Xe(le,Z,ge.props.children,Ve,ge.key):Z!==null&&(Z.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===x&&Gx(et)===Z.type)?(Ve=S(Z,ge.props),Ve.ref=vc(le,Z,ge),Ve.return=le,Ve):(Ve=cf(ge.type,ge.key,ge.props,null,le.mode,Ve),Ve.ref=vc(le,Z,ge),Ve.return=le,Ve)}function Le(le,Z,ge,Ve){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==ge.containerInfo||Z.stateNode.implementation!==ge.implementation?(Z=_p(ge,le.mode,Ve),Z.return=le,Z):(Z=S(Z,ge.children||[]),Z.return=le,Z)}function Xe(le,Z,ge,Ve,et){return Z===null||Z.tag!==7?(Z=io(ge,le.mode,Ve,et),Z.return=le,Z):(Z=S(Z,ge),Z.return=le,Z)}function ct(le,Z,ge){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=yp(""+Z,le.mode,ge),Z.return=le,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case u:return ge=cf(Z.type,Z.key,Z.props,null,le.mode,ge),ge.ref=vc(le,null,Z),ge.return=le,ge;case f:return Z=_p(Z,le.mode,ge),Z.return=le,Z;case x:var Ve=Z._init;return ct(le,Ve(Z._payload),ge)}if(te(Z)||P(Z))return Z=io(Z,le.mode,ge,null),Z.return=le,Z;Ru(le,Z)}return null}function ze(le,Z,ge,Ve){var et=Z!==null?Z.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return et!==null?null:J(le,Z,""+ge,Ve);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:return ge.key===et?fe(le,Z,ge,Ve):null;case f:return ge.key===et?Le(le,Z,ge,Ve):null;case x:return et=ge._init,ze(le,Z,et(ge._payload),Ve)}if(te(ge)||P(ge))return et!==null?null:Xe(le,Z,ge,Ve,null);Ru(le,ge)}return null}function Xt(le,Z,ge,Ve,et){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return le=le.get(ge)||null,J(Z,le,""+Ve,et);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case u:return le=le.get(Ve.key===null?ge:Ve.key)||null,fe(Z,le,Ve,et);case f:return le=le.get(Ve.key===null?ge:Ve.key)||null,Le(Z,le,Ve,et);case x:var ht=Ve._init;return Xt(le,Z,ge,ht(Ve._payload),et)}if(te(Ve)||P(Ve))return le=le.get(ge)||null,Xe(Z,le,Ve,et,null);Ru(Z,Ve)}return null}function Vt(le,Z,ge,Ve){for(var et=null,ht=null,ut=Z,Rt=Z=0,Ur=null;ut!==null&&Rt<ge.length;Rt++){ut.index>Rt?(Ur=ut,ut=null):Ur=ut.sibling;var It=ze(le,ut,ge[Rt],Ve);if(It===null){ut===null&&(ut=Ur);break}l&&ut&&It.alternate===null&&c(le,ut),Z=R(It,Z,Rt),ht===null?et=It:ht.sibling=It,ht=It,ut=Ur}if(Rt===ge.length)return h(le,ut),qt&&qs(le,Rt),et;if(ut===null){for(;Rt<ge.length;Rt++)ut=ct(le,ge[Rt],Ve),ut!==null&&(Z=R(ut,Z,Rt),ht===null?et=ut:ht.sibling=ut,ht=ut);return qt&&qs(le,Rt),et}for(ut=_(le,ut);Rt<ge.length;Rt++)Ur=Xt(ut,le,Rt,ge[Rt],Ve),Ur!==null&&(l&&Ur.alternate!==null&&ut.delete(Ur.key===null?Rt:Ur.key),Z=R(Ur,Z,Rt),ht===null?et=Ur:ht.sibling=Ur,ht=Ur);return l&&ut.forEach(function(ss){return c(le,ss)}),qt&&qs(le,Rt),et}function Ln(le,Z,ge,Ve){var et=P(ge);if(typeof et!="function")throw Error(s(150));if(ge=et.call(ge),ge==null)throw Error(s(151));for(var ht=et=null,ut=Z,Rt=Z=0,Ur=null,It=ge.next();ut!==null&&!It.done;Rt++,It=ge.next()){ut.index>Rt?(Ur=ut,ut=null):Ur=ut.sibling;var ss=ze(le,ut,It.value,Ve);if(ss===null){ut===null&&(ut=Ur);break}l&&ut&&ss.alternate===null&&c(le,ut),Z=R(ss,Z,Rt),ht===null?et=ss:ht.sibling=ss,ht=ss,ut=Ur}if(It.done)return h(le,ut),qt&&qs(le,Rt),et;if(ut===null){for(;!It.done;Rt++,It=ge.next())It=ct(le,It.value,Ve),It!==null&&(Z=R(It,Z,Rt),ht===null?et=It:ht.sibling=It,ht=It);return qt&&qs(le,Rt),et}for(ut=_(le,ut);!It.done;Rt++,It=ge.next())It=Xt(ut,le,Rt,It.value,Ve),It!==null&&(l&&It.alternate!==null&&ut.delete(It.key===null?Rt:It.key),Z=R(It,Z,Rt),ht===null?et=It:ht.sibling=It,ht=It);return l&&ut.forEach(function(sk){return c(le,sk)}),qt&&qs(le,Rt),et}function Ta(le,Z,ge,Ve){if(typeof ge=="object"&&ge!==null&&ge.type===d&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:e:{for(var et=ge.key,ht=Z;ht!==null;){if(ht.key===et){if(et=ge.type,et===d){if(ht.tag===7){h(le,ht.sibling),Z=S(ht,ge.props.children),Z.return=le,le=Z;break e}}else if(ht.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===x&&Gx(et)===ht.type){h(le,ht.sibling),Z=S(ht,ge.props),Z.ref=vc(le,ht,ge),Z.return=le,le=Z;break e}h(le,ht);break}else c(le,ht);ht=ht.sibling}ge.type===d?(Z=io(ge.props.children,le.mode,Ve,ge.key),Z.return=le,le=Z):(Ve=cf(ge.type,ge.key,ge.props,null,le.mode,Ve),Ve.ref=vc(le,Z,ge),Ve.return=le,le=Ve)}return B(le);case f:e:{for(ht=ge.key;Z!==null;){if(Z.key===ht)if(Z.tag===4&&Z.stateNode.containerInfo===ge.containerInfo&&Z.stateNode.implementation===ge.implementation){h(le,Z.sibling),Z=S(Z,ge.children||[]),Z.return=le,le=Z;break e}else{h(le,Z);break}else c(le,Z);Z=Z.sibling}Z=_p(ge,le.mode,Ve),Z.return=le,le=Z}return B(le);case x:return ht=ge._init,Ta(le,Z,ht(ge._payload),Ve)}if(te(ge))return Vt(le,Z,ge,Ve);if(P(ge))return Ln(le,Z,ge,Ve);Ru(le,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,Z!==null&&Z.tag===6?(h(le,Z.sibling),Z=S(Z,ge),Z.return=le,le=Z):(h(le,Z),Z=yp(ge,le.mode,Ve),Z.return=le,le=Z),B(le)):h(le,Z)}return Ta}var qo=Hx(!0),Wx=Hx(!1),Iu=tn(null),Du=null,Jo=null,C1=null;function T1(){C1=Jo=Du=null}function $x(l,c,h){xe?(yt(Iu,c._currentValue),c._currentValue=h):(yt(Iu,c._currentValue2),c._currentValue2=h)}function A1(l){var c=Iu.current;Mt(Iu),xe?l._currentValue=c:l._currentValue2=c}function P1(l,c,h){for(;l!==null;){var _=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,_!==null&&(_.childLanes|=c)):_!==null&&(_.childLanes&c)!==c&&(_.childLanes|=c),l===h)break;l=l.return}}function Zo(l,c){Du=l,C1=Jo=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(Dn=!0),l.firstContext=null)}function ui(l){var c=xe?l._currentValue:l._currentValue2;if(C1!==l)if(l={context:l,memoizedValue:c,next:null},Jo===null){if(Du===null)throw Error(s(308));Jo=l,Du.dependencies={lanes:0,firstContext:l}}else Jo=Jo.next=l;return c}var Js=null;function F1(l){Js===null?Js=[l]:Js.push(l)}function Xx(l,c,h,_){var S=c.interleaved;return S===null?(h.next=h,F1(c)):(h.next=S.next,S.next=h),c.interleaved=h,ea(l,_)}function ea(l,c){l.lanes|=c;var h=l.alternate;for(h!==null&&(h.lanes|=c),h=l,l=l.return;l!==null;)l.childLanes|=c,h=l.alternate,h!==null&&(h.childLanes|=c),h=l,l=l.return;return h.tag===3?h.stateNode:null}var Za=!1;function N1(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kx(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function ka(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function es(l,c,h){var _=l.updateQueue;if(_===null)return null;if(_=_.shared,gt&2){var S=_.pending;return S===null?c.next=c:(c.next=S.next,S.next=c),_.pending=c,ea(l,h)}return S=_.interleaved,S===null?(c.next=c,F1(_)):(c.next=S.next,S.next=c),_.interleaved=c,ea(l,h)}function bu(l,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,g1(l,h)}}function Yx(l,c){var h=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,h===_)){var S=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var B={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};R===null?S=R=B:R=R.next=B,h=h.next}while(h!==null);R===null?S=R=c:R=R.next=c}else S=R=c;h={baseState:_.baseState,firstBaseUpdate:S,lastBaseUpdate:R,shared:_.shared,effects:_.effects},l.updateQueue=h;return}l=h.lastBaseUpdate,l===null?h.firstBaseUpdate=c:l.next=c,h.lastBaseUpdate=c}function Ou(l,c,h,_){var S=l.updateQueue;Za=!1;var R=S.firstBaseUpdate,B=S.lastBaseUpdate,J=S.shared.pending;if(J!==null){S.shared.pending=null;var fe=J,Le=fe.next;fe.next=null,B===null?R=Le:B.next=Le,B=fe;var Xe=l.alternate;Xe!==null&&(Xe=Xe.updateQueue,J=Xe.lastBaseUpdate,J!==B&&(J===null?Xe.firstBaseUpdate=Le:J.next=Le,Xe.lastBaseUpdate=fe))}if(R!==null){var ct=S.baseState;B=0,Xe=Le=fe=null,J=R;do{var ze=J.lane,Xt=J.eventTime;if((_&ze)===ze){Xe!==null&&(Xe=Xe.next={eventTime:Xt,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var Vt=l,Ln=J;switch(ze=c,Xt=h,Ln.tag){case 1:if(Vt=Ln.payload,typeof Vt=="function"){ct=Vt.call(Xt,ct,ze);break e}ct=Vt;break e;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Ln.payload,ze=typeof Vt=="function"?Vt.call(Xt,ct,ze):Vt,ze==null)break e;ct=a({},ct,ze);break e;case 2:Za=!0}}J.callback!==null&&J.lane!==0&&(l.flags|=64,ze=S.effects,ze===null?S.effects=[J]:ze.push(J))}else Xt={eventTime:Xt,lane:ze,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Xe===null?(Le=Xe=Xt,fe=ct):Xe=Xe.next=Xt,B|=ze;if(J=J.next,J===null){if(J=S.shared.pending,J===null)break;ze=J,J=ze.next,ze.next=null,S.lastBaseUpdate=ze,S.shared.pending=null}}while(1);if(Xe===null&&(fe=ct),S.baseState=fe,S.firstBaseUpdate=Le,S.lastBaseUpdate=Xe,c=S.shared.interleaved,c!==null){S=c;do B|=S.lane,S=S.next;while(S!==c)}else R===null&&(S.shared.lanes=0);eo|=B,l.lanes=B,l.memoizedState=ct}}function Qx(l,c,h){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var _=l[c],S=_.callback;if(S!==null){if(_.callback=null,_=h,typeof S!="function")throw Error(s(191,S));S.call(_)}}}var yc={},fi=tn(yc),_c=tn(yc),el=tn(yc);function ta(l){if(l===yc)throw Error(s(174));return l}function R1(l,c){yt(el,c),yt(_c,l),yt(fi,yc),l=we(c),Mt(fi),yt(fi,l)}function tl(){Mt(fi),Mt(_c),Mt(el)}function qx(l){var c=ta(el.current),h=ta(fi.current);c=se(h,l.type,c),h!==c&&(yt(_c,l),yt(fi,c))}function I1(l){_c.current===l&&(Mt(fi),Mt(_c))}var rr=tn(0);function Lu(l){for(var c=l;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||yu(h)||pc(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var D1=[];function b1(){for(var l=0;l<D1.length;l++){var c=D1[l];xe?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}D1.length=0}var Mu=o.ReactCurrentDispatcher,O1=o.ReactCurrentBatchConfig,Zs=0,nr=null,Er=null,Mr=null,Bu=!1,wc=!1,Sc=0,RS=0;function nn(){throw Error(s(321))}function L1(l,c){if(c===null)return!1;for(var h=0;h<c.length&&h<l.length;h++)if(!Ni(l[h],c[h]))return!1;return!0}function M1(l,c,h,_,S,R){if(Zs=R,nr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Mu.current=l===null||l.memoizedState===null?OS:LS,l=h(_,S),wc){R=0;do{if(wc=!1,Sc=0,25<=R)throw Error(s(301));R+=1,Mr=Er=null,c.updateQueue=null,Mu.current=MS,l=h(_,S)}while(wc)}if(Mu.current=zu,c=Er!==null&&Er.next!==null,Zs=0,Mr=Er=nr=null,Bu=!1,c)throw Error(s(300));return l}function B1(){var l=Sc!==0;return Sc=0,l}function ra(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?nr.memoizedState=Mr=l:Mr=Mr.next=l,Mr}function di(){if(Er===null){var l=nr.alternate;l=l!==null?l.memoizedState:null}else l=Er.next;var c=Mr===null?nr.memoizedState:Mr.next;if(c!==null)Mr=c,Er=l;else{if(l===null)throw Error(s(310));Er=l,l={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Mr===null?nr.memoizedState=Mr=l:Mr=Mr.next=l}return Mr}function kc(l,c){return typeof c=="function"?c(l):c}function U1(l){var c=di(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=Er,S=_.baseQueue,R=h.pending;if(R!==null){if(S!==null){var B=S.next;S.next=R.next,R.next=B}_.baseQueue=S=R,h.pending=null}if(S!==null){R=S.next,_=_.baseState;var J=B=null,fe=null,Le=R;do{var Xe=Le.lane;if((Zs&Xe)===Xe)fe!==null&&(fe=fe.next={lane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),_=Le.hasEagerState?Le.eagerState:l(_,Le.action);else{var ct={lane:Xe,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null};fe===null?(J=fe=ct,B=_):fe=fe.next=ct,nr.lanes|=Xe,eo|=Xe}Le=Le.next}while(Le!==null&&Le!==R);fe===null?B=_:fe.next=J,Ni(_,c.memoizedState)||(Dn=!0),c.memoizedState=_,c.baseState=B,c.baseQueue=fe,h.lastRenderedState=_}if(l=h.interleaved,l!==null){S=l;do R=S.lane,nr.lanes|=R,eo|=R,S=S.next;while(S!==l)}else S===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function j1(l){var c=di(),h=c.queue;if(h===null)throw Error(s(311));h.lastRenderedReducer=l;var _=h.dispatch,S=h.pending,R=c.memoizedState;if(S!==null){h.pending=null;var B=S=S.next;do R=l(R,B.action),B=B.next;while(B!==S);Ni(R,c.memoizedState)||(Dn=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),h.lastRenderedState=R}return[R,_]}function Jx(){}function Zx(l,c){var h=nr,_=di(),S=c(),R=!Ni(_.memoizedState,S);if(R&&(_.memoizedState=S,Dn=!0),_=_.queue,z1(rv.bind(null,h,_,l),[l]),_.getSnapshot!==c||R||Mr!==null&&Mr.memoizedState.tag&1){if(h.flags|=2048,Ec(9,tv.bind(null,h,_,S,c),void 0,null),Br===null)throw Error(s(349));Zs&30||ev(h,c,S)}return S}function ev(l,c,h){l.flags|=16384,l={getSnapshot:c,value:h},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.stores=[l]):(h=c.stores,h===null?c.stores=[l]:h.push(l))}function tv(l,c,h,_){c.value=h,c.getSnapshot=_,nv(c)&&iv(l)}function rv(l,c,h){return h(function(){nv(c)&&iv(l)})}function nv(l){var c=l.getSnapshot;l=l.value;try{var h=c();return!Ni(l,h)}catch{return!0}}function iv(l){var c=ea(l,1);c!==null&&hi(c,l,1,-1)}function av(l){var c=ra();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kc,lastRenderedState:l},c.queue=l,l=l.dispatch=bS.bind(null,nr,l),[c.memoizedState,l]}function Ec(l,c,h,_){return l={tag:l,create:c,destroy:h,deps:_,next:null},c=nr.updateQueue,c===null?(c={lastEffect:null,stores:null},nr.updateQueue=c,c.lastEffect=l.next=l):(h=c.lastEffect,h===null?c.lastEffect=l.next=l:(_=h.next,h.next=l,l.next=_,c.lastEffect=l)),l}function sv(){return di().memoizedState}function Uu(l,c,h,_){var S=ra();nr.flags|=l,S.memoizedState=Ec(1|c,h,void 0,_===void 0?null:_)}function ju(l,c,h,_){var S=di();_=_===void 0?null:_;var R=void 0;if(Er!==null){var B=Er.memoizedState;if(R=B.destroy,_!==null&&L1(_,B.deps)){S.memoizedState=Ec(c,h,R,_);return}}nr.flags|=l,S.memoizedState=Ec(1|c,h,R,_)}function ov(l,c){return Uu(8390656,8,l,c)}function z1(l,c){return ju(2048,8,l,c)}function lv(l,c){return ju(4,2,l,c)}function cv(l,c){return ju(4,4,l,c)}function uv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function fv(l,c,h){return h=h!=null?h.concat([l]):null,ju(4,4,uv.bind(null,c,l),h)}function V1(){}function dv(l,c){var h=di();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&L1(c,_[1])?_[0]:(h.memoizedState=[l,c],l)}function hv(l,c){var h=di();c=c===void 0?null:c;var _=h.memoizedState;return _!==null&&c!==null&&L1(c,_[1])?_[0]:(l=l(),h.memoizedState=[l,c],l)}function pv(l,c,h){return Zs&21?(Ni(h,c)||(h=bx(),nr.lanes|=h,eo|=h,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,Dn=!0),l.memoizedState=h)}function IS(l,c){var h=Nt;Nt=h!==0&&4>h?h:4,l(!0);var _=O1.transition;O1.transition={};try{l(!1),c()}finally{Nt=h,O1.transition=_}}function gv(){return di().memoizedState}function DS(l,c,h){var _=ns(l);if(h={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null},mv(l))xv(c,h);else if(h=Xx(l,c,h,_),h!==null){var S=on();hi(h,l,_,S),vv(h,c,_)}}function bS(l,c,h){var _=ns(l),S={lane:_,action:h,hasEagerState:!1,eagerState:null,next:null};if(mv(l))xv(c,S);else{var R=l.alternate;if(l.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var B=c.lastRenderedState,J=R(B,h);if(S.hasEagerState=!0,S.eagerState=J,Ni(J,B)){var fe=c.interleaved;fe===null?(S.next=S,F1(c)):(S.next=fe.next,fe.next=S),c.interleaved=S;return}}catch{}finally{}h=Xx(l,c,S,_),h!==null&&(S=on(),hi(h,l,_,S),vv(h,c,_))}}function mv(l){var c=l.alternate;return l===nr||c!==null&&c===nr}function xv(l,c){wc=Bu=!0;var h=l.pending;h===null?c.next=c:(c.next=h.next,h.next=c),l.pending=c}function vv(l,c,h){if(h&4194240){var _=c.lanes;_&=l.pendingLanes,h|=_,c.lanes=h,g1(l,h)}}var zu={readContext:ui,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},OS={readContext:ui,useCallback:function(l,c){return ra().memoizedState=[l,c===void 0?null:c],l},useContext:ui,useEffect:ov,useImperativeHandle:function(l,c,h){return h=h!=null?h.concat([l]):null,Uu(4194308,4,uv.bind(null,c,l),h)},useLayoutEffect:function(l,c){return Uu(4194308,4,l,c)},useInsertionEffect:function(l,c){return Uu(4,2,l,c)},useMemo:function(l,c){var h=ra();return c=c===void 0?null:c,l=l(),h.memoizedState=[l,c],l},useReducer:function(l,c,h){var _=ra();return c=h!==void 0?h(c):c,_.memoizedState=_.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},_.queue=l,l=l.dispatch=DS.bind(null,nr,l),[_.memoizedState,l]},useRef:function(l){var c=ra();return l={current:l},c.memoizedState=l},useState:av,useDebugValue:V1,useDeferredValue:function(l){return ra().memoizedState=l},useTransition:function(){var l=av(!1),c=l[0];return l=IS.bind(null,l[1]),ra().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,h){var _=nr,S=ra();if(qt){if(h===void 0)throw Error(s(407));h=h()}else{if(h=c(),Br===null)throw Error(s(349));Zs&30||ev(_,c,h)}S.memoizedState=h;var R={value:h,getSnapshot:c};return S.queue=R,ov(rv.bind(null,_,R,l),[l]),_.flags|=2048,Ec(9,tv.bind(null,_,R,h,c),void 0,null),h},useId:function(){var l=ra(),c=Br.identifierPrefix;if(qt){var h=Sa,_=wa;h=(_&~(1<<32-Fi(_)-1)).toString(32)+h,c=":"+c+"R"+h,h=Sc++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=RS++,c=":"+c+"r"+h.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},LS={readContext:ui,useCallback:dv,useContext:ui,useEffect:z1,useImperativeHandle:fv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:hv,useReducer:U1,useRef:sv,useState:function(){return U1(kc)},useDebugValue:V1,useDeferredValue:function(l){var c=di();return pv(c,Er.memoizedState,l)},useTransition:function(){var l=U1(kc)[0],c=di().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:gv,unstable_isNewReconciler:!1},MS={readContext:ui,useCallback:dv,useContext:ui,useEffect:z1,useImperativeHandle:fv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:hv,useReducer:j1,useRef:sv,useState:function(){return j1(kc)},useDebugValue:V1,useDeferredValue:function(l){var c=di();return Er===null?c.memoizedState=l:pv(c,Er.memoizedState,l)},useTransition:function(){var l=j1(kc)[0],c=di().memoizedState;return[l,c]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:gv,unstable_isNewReconciler:!1};function Ii(l,c){if(l&&l.defaultProps){c=a({},c),l=l.defaultProps;for(var h in l)c[h]===void 0&&(c[h]=l[h]);return c}return c}function G1(l,c,h,_){c=l.memoizedState,h=h(_,c),h=h==null?c:a({},c,h),l.memoizedState=h,l.lanes===0&&(l.updateQueue.baseState=h)}var Vu={isMounted:function(l){return(l=l._reactInternals)?I(l)===l:!1},enqueueSetState:function(l,c,h){l=l._reactInternals;var _=on(),S=ns(l),R=ka(_,S);R.payload=c,h!=null&&(R.callback=h),c=es(l,R,S),c!==null&&(hi(c,l,S,_),bu(c,l,S))},enqueueReplaceState:function(l,c,h){l=l._reactInternals;var _=on(),S=ns(l),R=ka(_,S);R.tag=1,R.payload=c,h!=null&&(R.callback=h),c=es(l,R,S),c!==null&&(hi(c,l,S,_),bu(c,l,S))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var h=on(),_=ns(l),S=ka(h,_);S.tag=2,c!=null&&(S.callback=c),c=es(l,S,_),c!==null&&(hi(c,l,_,h),bu(c,l,_))}};function yv(l,c,h,_,S,R,B){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,R,B):c.prototype&&c.prototype.isPureReactComponent?!Nu(h,_)||!Nu(S,R):!0}function _v(l,c,h){var _=!1,S=Ja,R=c.contextType;return typeof R=="object"&&R!==null?R=ui(R):(S=In(c)?Ys:rn.current,_=c.contextTypes,R=(_=_!=null)?Xo(l,S):Ja),c=new c(h,R),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Vu,l.stateNode=c,c._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=S,l.__reactInternalMemoizedMaskedChildContext=R),c}function wv(l,c,h,_){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,_),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,_),c.state!==l&&Vu.enqueueReplaceState(c,c.state,null)}function H1(l,c,h,_){var S=l.stateNode;S.props=h,S.state=l.memoizedState,S.refs={},N1(l);var R=c.contextType;typeof R=="object"&&R!==null?S.context=ui(R):(R=In(c)?Ys:rn.current,S.context=Xo(l,R)),S.state=l.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(G1(l,c,R,h),S.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(c=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),c!==S.state&&Vu.enqueueReplaceState(S,S.state,null),Ou(l,h,S,_),S.state=l.memoizedState),typeof S.componentDidMount=="function"&&(l.flags|=4194308)}function rl(l,c){try{var h="",_=c;do h+=NS(_),_=_.return;while(_);var S=h}catch(R){S=`
Error generating stack: `+R.message+`
`+R.stack}return{value:l,source:c,stack:S,digest:null}}function W1(l,c,h){return{value:l,source:null,stack:h??null,digest:c??null}}function $1(l,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var BS=typeof WeakMap=="function"?WeakMap:Map;function Sv(l,c,h){h=ka(-1,h),h.tag=3,h.payload={element:null};var _=c.value;return h.callback=function(){rf||(rf=!0,dp=_),$1(l,c)},h}function kv(l,c,h){h=ka(-1,h),h.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var S=c.value;h.payload=function(){return _(S)},h.callback=function(){$1(l,c)}}var R=l.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(h.callback=function(){$1(l,c),typeof _!="function"&&(ts===null?ts=new Set([this]):ts.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})}),h}function Ev(l,c,h){var _=l.pingCache;if(_===null){_=l.pingCache=new BS;var S=new Set;_.set(c,S)}else S=_.get(c),S===void 0&&(S=new Set,_.set(c,S));S.has(h)||(S.add(h),l=JS.bind(null,l,c,h),c.then(l,l))}function Cv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Tv(l,c,h,_,S){return l.mode&1?(l.flags|=65536,l.lanes=S,l):(l===c?l.flags|=65536:(l.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=ka(-1,1),c.tag=2,es(h,c,1))),h.lanes|=1),l)}var US=o.ReactCurrentOwner,Dn=!1;function _n(l,c,h,_){c.child=l===null?Wx(c,null,h,_):qo(c,l.child,h,_)}function Av(l,c,h,_,S){h=h.render;var R=c.ref;return Zo(c,S),_=M1(l,c,h,_,R,S),h=B1(),l!==null&&!Dn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~S,Ea(l,c,S)):(qt&&h&&_1(c),c.flags|=1,_n(l,c,_,S),c.child)}function Pv(l,c,h,_,S){if(l===null){var R=h.type;return typeof R=="function"&&!vp(R)&&R.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=R,Fv(l,c,R,_,S)):(l=cf(h.type,null,_,c,c.mode,S),l.ref=c.ref,l.return=c,c.child=l)}if(R=l.child,!(l.lanes&S)){var B=R.memoizedProps;if(h=h.compare,h=h!==null?h:Nu,h(B,_)&&l.ref===c.ref)return Ea(l,c,S)}return c.flags|=1,l=as(R,_),l.ref=c.ref,l.return=c,c.child=l}function Fv(l,c,h,_,S){if(l!==null){var R=l.memoizedProps;if(Nu(R,_)&&l.ref===c.ref)if(Dn=!1,c.pendingProps=_=R,(l.lanes&S)!==0)l.flags&131072&&(Dn=!0);else return c.lanes=l.lanes,Ea(l,c,S)}return X1(l,c,h,_,S)}function Nv(l,c,h){var _=c.pendingProps,S=_.children,R=l!==null?l.memoizedState:null;if(_.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(il,$n),$n|=h;else{if(!(h&1073741824))return l=R!==null?R.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,yt(il,$n),$n|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=R!==null?R.baseLanes:h,yt(il,$n),$n|=_}else R!==null?(_=R.baseLanes|h,c.memoizedState=null):_=h,yt(il,$n),$n|=_;return _n(l,c,S,h),c.child}function Rv(l,c){var h=c.ref;(l===null&&h!==null||l!==null&&l.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function X1(l,c,h,_,S){var R=In(h)?Ys:rn.current;return R=Xo(c,R),Zo(c,S),h=M1(l,c,h,_,R,S),_=B1(),l!==null&&!Dn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~S,Ea(l,c,S)):(qt&&_&&_1(c),c.flags|=1,_n(l,c,h,S),c.child)}function Iv(l,c,h,_,S){if(In(h)){var R=!0;wu(c)}else R=!1;if(Zo(c,S),c.stateNode===null)Hu(l,c),_v(c,h,_),H1(c,h,_,S),_=!0;else if(l===null){var B=c.stateNode,J=c.memoizedProps;B.props=J;var fe=B.context,Le=h.contextType;typeof Le=="object"&&Le!==null?Le=ui(Le):(Le=In(h)?Ys:rn.current,Le=Xo(c,Le));var Xe=h.getDerivedStateFromProps,ct=typeof Xe=="function"||typeof B.getSnapshotBeforeUpdate=="function";ct||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(J!==_||fe!==Le)&&wv(c,B,_,Le),Za=!1;var ze=c.memoizedState;B.state=ze,Ou(c,_,B,S),fe=c.memoizedState,J!==_||ze!==fe||Rn.current||Za?(typeof Xe=="function"&&(G1(c,h,Xe,_),fe=c.memoizedState),(J=Za||yv(c,h,J,_,ze,fe,Le))?(ct||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(c.flags|=4194308)):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=_,c.memoizedState=fe),B.props=_,B.state=fe,B.context=Le,_=J):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),_=!1)}else{B=c.stateNode,Kx(l,c),J=c.memoizedProps,Le=c.type===c.elementType?J:Ii(c.type,J),B.props=Le,ct=c.pendingProps,ze=B.context,fe=h.contextType,typeof fe=="object"&&fe!==null?fe=ui(fe):(fe=In(h)?Ys:rn.current,fe=Xo(c,fe));var Xt=h.getDerivedStateFromProps;(Xe=typeof Xt=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(J!==ct||ze!==fe)&&wv(c,B,_,fe),Za=!1,ze=c.memoizedState,B.state=ze,Ou(c,_,B,S);var Vt=c.memoizedState;J!==ct||ze!==Vt||Rn.current||Za?(typeof Xt=="function"&&(G1(c,h,Xt,_),Vt=c.memoizedState),(Le=Za||yv(c,h,Le,_,ze,Vt,fe)||!1)?(Xe||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(_,Vt,fe),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(_,Vt,fe)),typeof B.componentDidUpdate=="function"&&(c.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof B.componentDidUpdate!="function"||J===l.memoizedProps&&ze===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&ze===l.memoizedState||(c.flags|=1024),c.memoizedProps=_,c.memoizedState=Vt),B.props=_,B.state=Vt,B.context=fe,_=Le):(typeof B.componentDidUpdate!="function"||J===l.memoizedProps&&ze===l.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&ze===l.memoizedState||(c.flags|=1024),_=!1)}return K1(l,c,h,_,R,S)}function K1(l,c,h,_,S,R){Rv(l,c);var B=(c.flags&128)!==0;if(!_&&!B)return S&&Dx(c,h,!1),Ea(l,c,R);_=c.stateNode,US.current=c;var J=B&&typeof h.getDerivedStateFromError!="function"?null:_.render();return c.flags|=1,l!==null&&B?(c.child=qo(c,l.child,null,R),c.child=qo(c,null,J,R)):_n(l,c,J,R),c.memoizedState=_.state,S&&Dx(c,h,!0),c.child}function Dv(l){var c=l.stateNode;c.pendingContext?Rx(l,c.pendingContext,c.pendingContext!==c.context):c.context&&Rx(l,c.context,!1),R1(l,c.containerInfo)}function bv(l,c,h,_,S){return Qo(),E1(S),c.flags|=256,_n(l,c,h,_),c.child}var Y1={dehydrated:null,treeContext:null,retryLane:0};function Q1(l){return{baseLanes:l,cachePool:null,transitions:null}}function Ov(l,c,h){var _=c.pendingProps,S=rr.current,R=!1,B=(c.flags&128)!==0,J;if((J=B)||(J=l!==null&&l.memoizedState===null?!1:(S&2)!==0),J?(R=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(S|=1),yt(rr,S&1),l===null)return k1(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?pc(l)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(B=_.children,l=_.fallback,R?(_=c.mode,R=c.child,B={mode:"hidden",children:B},!(_&1)&&R!==null?(R.childLanes=0,R.pendingProps=B):R=uf(B,_,0,null),l=io(l,_,h,null),R.return=c,l.return=c,R.sibling=l,c.child=R,c.child.memoizedState=Q1(h),c.memoizedState=Y1,l):q1(c,B));if(S=l.memoizedState,S!==null&&(J=S.dehydrated,J!==null))return jS(l,c,B,_,J,S,h);if(R){R=_.fallback,B=c.mode,S=l.child,J=S.sibling;var fe={mode:"hidden",children:_.children};return!(B&1)&&c.child!==S?(_=c.child,_.childLanes=0,_.pendingProps=fe,c.deletions=null):(_=as(S,fe),_.subtreeFlags=S.subtreeFlags&14680064),J!==null?R=as(J,R):(R=io(R,B,h,null),R.flags|=2),R.return=c,_.return=c,_.sibling=R,c.child=_,_=R,R=c.child,B=l.child.memoizedState,B=B===null?Q1(h):{baseLanes:B.baseLanes|h,cachePool:null,transitions:B.transitions},R.memoizedState=B,R.childLanes=l.childLanes&~h,c.memoizedState=Y1,_}return R=l.child,l=R.sibling,_=as(R,{mode:"visible",children:_.children}),!(c.mode&1)&&(_.lanes=h),_.return=c,_.sibling=null,l!==null&&(h=c.deletions,h===null?(c.deletions=[l],c.flags|=16):h.push(l)),c.child=_,c.memoizedState=null,_}function q1(l,c){return c=uf({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Gu(l,c,h,_){return _!==null&&E1(_),qo(c,l.child,null,h),l=q1(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function jS(l,c,h,_,S,R,B){if(h)return c.flags&256?(c.flags&=-257,_=W1(Error(s(422))),Gu(l,c,B,_)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(R=_.fallback,S=c.mode,_=uf({mode:"visible",children:_.children},S,0,null),R=io(R,S,B,null),R.flags|=2,_.return=c,R.return=c,_.sibling=R,c.child=_,c.mode&1&&qo(c,l.child,null,B),c.child.memoizedState=Q1(B),c.memoizedState=Y1,R);if(!(c.mode&1))return Gu(l,c,B,null);if(pc(S))return _=d1(S).digest,R=Error(s(419)),_=W1(R,_,void 0),Gu(l,c,B,_);if(h=(B&l.childLanes)!==0,Dn||h){if(_=Br,_!==null){switch(B&-B){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=S&(_.suspendedLanes|B)?0:S,S!==0&&S!==R.retryLane&&(R.retryLane=S,ea(l,S),hi(_,l,S,-1))}return xp(),_=W1(Error(s(421))),Gu(l,c,B,_)}return yu(S)?(c.flags|=128,c.child=l.child,c=ZS.bind(null,l),b(S,c),null):(l=R.treeContext,Ze&&(ci=H(S),Wn=c,qt=!0,Ri=null,xc=!1,l!==null&&(oi[li++]=wa,oi[li++]=Sa,oi[li++]=Qs,wa=l.id,Sa=l.overflow,Qs=c)),c=q1(c,_.children),c.flags|=4096,c)}function Lv(l,c,h){l.lanes|=c;var _=l.alternate;_!==null&&(_.lanes|=c),P1(l.return,c,h)}function J1(l,c,h,_,S){var R=l.memoizedState;R===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:_,tail:h,tailMode:S}:(R.isBackwards=c,R.rendering=null,R.renderingStartTime=0,R.last=_,R.tail=h,R.tailMode=S)}function Mv(l,c,h){var _=c.pendingProps,S=_.revealOrder,R=_.tail;if(_n(l,c,_.children,h),_=rr.current,_&2)_=_&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Lv(l,h,c);else if(l.tag===19)Lv(l,h,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(yt(rr,_),!(c.mode&1))c.memoizedState=null;else switch(S){case"forwards":for(h=c.child,S=null;h!==null;)l=h.alternate,l!==null&&Lu(l)===null&&(S=h),h=h.sibling;h=S,h===null?(S=c.child,c.child=null):(S=h.sibling,h.sibling=null),J1(c,!1,S,h,R);break;case"backwards":for(h=null,S=c.child,c.child=null;S!==null;){if(l=S.alternate,l!==null&&Lu(l)===null){c.child=S;break}l=S.sibling,S.sibling=h,h=S,S=l}J1(c,!0,h,null,R);break;case"together":J1(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Hu(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Ea(l,c,h){if(l!==null&&(c.dependencies=l.dependencies),eo|=c.lanes,!(h&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(s(153));if(c.child!==null){for(l=c.child,h=as(l,l.pendingProps),c.child=h,h.return=c;l.sibling!==null;)l=l.sibling,h=h.sibling=as(l,l.pendingProps),h.return=c;h.sibling=null}return c.child}function zS(l,c,h){switch(c.tag){case 3:Dv(c),Qo();break;case 5:qx(c);break;case 1:In(c.type)&&wu(c);break;case 4:R1(c,c.stateNode.containerInfo);break;case 10:$x(c,c.type._context,c.memoizedProps.value);break;case 13:var _=c.memoizedState;if(_!==null)return _.dehydrated!==null?(yt(rr,rr.current&1),c.flags|=128,null):h&c.child.childLanes?Ov(l,c,h):(yt(rr,rr.current&1),l=Ea(l,c,h),l!==null?l.sibling:null);yt(rr,rr.current&1);break;case 19:if(_=(h&c.childLanes)!==0,l.flags&128){if(_)return Mv(l,c,h);c.flags|=128}var S=c.memoizedState;if(S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),yt(rr,rr.current),_)break;return null;case 22:case 23:return c.lanes=0,Nv(l,c,h)}return Ea(l,c,h)}function na(l){l.flags|=4}function Bv(l,c){if(l!==null&&l.child===c.child)return!0;if(c.flags&16)return!1;for(l=c.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Cc,Tc,Wu,$u;if(Me)Cc=function(l,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)L(l,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Tc=function(){},Wu=function(l,c,h,_,S){if(l=l.memoizedProps,l!==_){var R=c.stateNode,B=ta(fi.current);h=Y(R,h,l,_,S,B),(c.updateQueue=h)&&na(c)}},$u=function(l,c,h,_){h!==_&&na(c)};else if(G){Cc=function(l,c,h,_){for(var S=c.child;S!==null;){if(S.tag===5){var R=S.stateNode;h&&_&&(R=Qt(R,S.type,S.memoizedProps,S)),L(l,R)}else if(S.tag===6)R=S.stateNode,h&&_&&(R=Xs(R,S.memoizedProps,S)),L(l,R);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)R=S.child,R!==null&&(R.return=S),Cc(l,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===c)break;for(;S.sibling===null;){if(S.return===null||S.return===c)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};var Uv=function(l,c,h,_){for(var S=c.child;S!==null;){if(S.tag===5){var R=S.stateNode;h&&_&&(R=Qt(R,S.type,S.memoizedProps,S)),Nn(l,R)}else if(S.tag===6)R=S.stateNode,h&&_&&(R=Xs(R,S.memoizedProps,S)),Nn(l,R);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)R=S.child,R!==null&&(R.return=S),Uv(l,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===c)break;for(;S.sibling===null;){if(S.return===null||S.return===c)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};Tc=function(l,c){var h=c.stateNode;if(!Bv(l,c)){l=h.containerInfo;var _=ai(l);Uv(_,c,!1,!1),h.pendingChildren=_,na(c),Hn(l,_)}},Wu=function(l,c,h,_,S){var R=l.stateNode,B=l.memoizedProps;if((l=Bv(l,c))&&B===_)c.stateNode=R;else{var J=c.stateNode,fe=ta(fi.current),Le=null;B!==_&&(Le=Y(J,h,B,_,S,fe)),l&&Le===null?c.stateNode=R:(R=Et(R,Le,h,B,_,c,l,J),q(R,h,_,S,fe)&&na(c),c.stateNode=R,l?na(c):Cc(R,c,!1,!1))}},$u=function(l,c,h,_){h!==_?(l=ta(el.current),h=ta(fi.current),c.stateNode=ue(_,l,h,c),na(c)):c.stateNode=l.stateNode}}else Tc=function(){},Wu=function(){},$u=function(){};function Ac(l,c){if(!qt)switch(l.tailMode){case"hidden":c=l.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l.tail=null:h.sibling=null;break;case"collapsed":h=l.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function an(l){var c=l.alternate!==null&&l.alternate.child===l.child,h=0,_=0;if(c)for(var S=l.child;S!==null;)h|=S.lanes|S.childLanes,_|=S.subtreeFlags&14680064,_|=S.flags&14680064,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)h|=S.lanes|S.childLanes,_|=S.subtreeFlags,_|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=_,l.childLanes=h,c}function VS(l,c,h){var _=c.pendingProps;switch(w1(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(c),null;case 1:return In(c.type)&&_u(),an(c),null;case 3:return h=c.stateNode,tl(),Mt(Rn),Mt(rn),b1(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(l===null||l.child===null)&&(Fu(c)?na(c):l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Ri!==null&&(gp(Ri),Ri=null))),Tc(l,c),an(c),null;case 5:I1(c),h=ta(el.current);var S=c.type;if(l!==null&&c.stateNode!=null)Wu(l,c,S,_,h),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!_){if(c.stateNode===null)throw Error(s(166));return an(c),null}if(l=ta(fi.current),Fu(c)){if(!Ze)throw Error(s(175));l=W(c.stateNode,c.type,c.memoizedProps,h,l,c,!xc),c.updateQueue=l,l!==null&&na(c)}else{var R=Se(S,_,h,l,c);Cc(R,c,!1,!1),c.stateNode=R,q(R,S,_,h,l)&&na(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return an(c),null;case 6:if(l&&c.stateNode!=null)$u(l,c,l.memoizedProps,_);else{if(typeof _!="string"&&c.stateNode===null)throw Error(s(166));if(l=ta(el.current),h=ta(fi.current),Fu(c)){if(!Ze)throw Error(s(176));if(l=c.stateNode,h=c.memoizedProps,(_=ne(l,h,c,!xc))&&(S=Wn,S!==null))switch(S.tag){case 3:Oe(S.stateNode.containerInfo,l,h,(S.mode&1)!==0);break;case 5:je(S.type,S.memoizedProps,S.stateNode,l,h,(S.mode&1)!==0)}_&&na(c)}else c.stateNode=ue(_,l,h,c)}return an(c),null;case 13:if(Mt(rr),_=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(qt&&ci!==null&&c.mode&1&&!(c.flags&128))Vx(),Qo(),c.flags|=98560,S=!1;else if(S=Fu(c),_!==null&&_.dehydrated!==null){if(l===null){if(!S)throw Error(s(318));if(!Ze)throw Error(s(344));if(S=c.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(s(317));ve(S,c)}else Qo(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;an(c),S=!1}else Ri!==null&&(gp(Ri),Ri=null),S=!0;if(!S)return c.flags&65536?c:null}return c.flags&128?(c.lanes=h,c):(h=_!==null,h!==(l!==null&&l.memoizedState!==null)&&h&&(c.child.flags|=8192,c.mode&1&&(l===null||rr.current&1?Cr===0&&(Cr=3):xp())),c.updateQueue!==null&&(c.flags|=4),an(c),null);case 4:return tl(),Tc(l,c),l===null&&Ke(c.stateNode.containerInfo),an(c),null;case 10:return A1(c.type._context),an(c),null;case 17:return In(c.type)&&_u(),an(c),null;case 19:if(Mt(rr),S=c.memoizedState,S===null)return an(c),null;if(_=(c.flags&128)!==0,R=S.rendering,R===null)if(_)Ac(S,!1);else{if(Cr!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(R=Lu(l),R!==null){for(c.flags|=128,Ac(S,!1),l=R.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=h,h=c.child;h!==null;)_=h,S=l,_.flags&=14680066,R=_.alternate,R===null?(_.childLanes=0,_.lanes=S,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=R.childLanes,_.lanes=R.lanes,_.child=R.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=R.memoizedProps,_.memoizedState=R.memoizedState,_.updateQueue=R.updateQueue,_.type=R.type,S=R.dependencies,_.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext}),h=h.sibling;return yt(rr,rr.current&1|2),c.child}l=l.sibling}S.tail!==null&&Lr()>fp&&(c.flags|=128,_=!0,Ac(S,!1),c.lanes=4194304)}else{if(!_)if(l=Lu(R),l!==null){if(c.flags|=128,_=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Ac(S,!0),S.tail===null&&S.tailMode==="hidden"&&!R.alternate&&!qt)return an(c),null}else 2*Lr()-S.renderingStartTime>fp&&h!==1073741824&&(c.flags|=128,_=!0,Ac(S,!1),c.lanes=4194304);S.isBackwards?(R.sibling=c.child,c.child=R):(l=S.last,l!==null?l.sibling=R:c.child=R,S.last=R)}return S.tail!==null?(c=S.tail,S.rendering=c,S.tail=c.sibling,S.renderingStartTime=Lr(),c.sibling=null,l=rr.current,yt(rr,_?l&1|2:l&1),c):(an(c),null);case 22:case 23:return mp(),h=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==h&&(c.flags|=8192),h&&c.mode&1?$n&1073741824&&(an(c),Me&&c.subtreeFlags&6&&(c.flags|=8192)):an(c),null;case 24:return null;case 25:return null}throw Error(s(156,c.tag))}function GS(l,c){switch(w1(c),c.tag){case 1:return In(c.type)&&_u(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return tl(),Mt(Rn),Mt(rn),b1(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return I1(c),null;case 13:if(Mt(rr),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Qo()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Mt(rr),null;case 4:return tl(),null;case 10:return A1(c.type._context),null;case 22:case 23:return mp(),null;case 24:return null;default:return null}}var Xu=!1,sn=!1,HS=typeof WeakSet=="function"?WeakSet:Set,We=null;function nl(l,c){var h=l.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(_){Jt(l,c,_)}else h.current=null}function Z1(l,c,h){try{h()}catch(_){Jt(l,c,_)}}var jv=!1;function WS(l,c){for(X(l.containerInfo),We=c;We!==null;)if(l=We,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,We=c;else for(;We!==null;){l=We;try{var h=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var _=h.memoizedProps,S=h.memoizedState,R=l.stateNode,B=R.getSnapshotBeforeUpdate(l.elementType===l.type?_:Ii(l.type,_),S);R.__reactInternalSnapshotBeforeUpdate=B}break;case 3:Me&&Ot(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(J){Jt(l,l.return,J)}if(c=l.sibling,c!==null){c.return=l.return,We=c;break}We=l.return}return h=jv,jv=!1,h}function Pc(l,c,h){var _=c.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var S=_=_.next;do{if((S.tag&l)===l){var R=S.destroy;S.destroy=void 0,R!==void 0&&Z1(c,h,R)}S=S.next}while(S!==_)}}function Ku(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&l)===l){var _=h.create;h.destroy=_()}h=h.next}while(h!==c)}}function ep(l){var c=l.ref;if(c!==null){var h=l.stateNode;switch(l.tag){case 5:l=Ee(h);break;default:l=h}typeof c=="function"?c(l):c.current=l}}function zv(l){var c=l.alternate;c!==null&&(l.alternate=null,zv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&De(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Vv(l){return l.tag===5||l.tag===3||l.tag===4}function Gv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Vv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function tp(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?dt(h,l,c):Pe(h,l);else if(_!==4&&(l=l.child,l!==null))for(tp(l,c,h),l=l.sibling;l!==null;)tp(l,c,h),l=l.sibling}function rp(l,c,h){var _=l.tag;if(_===5||_===6)l=l.stateNode,c?Je(h,l,c):ie(h,l);else if(_!==4&&(l=l.child,l!==null))for(rp(l,c,h),l=l.sibling;l!==null;)rp(l,c,h),l=l.sibling}var Xr=null,Di=!1;function ia(l,c,h){for(h=h.child;h!==null;)np(l,c,h),h=h.sibling}function np(l,c,h){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(Cu,h)}catch{}switch(h.tag){case 5:sn||nl(h,c);case 6:if(Me){var _=Xr,S=Di;Xr=null,ia(l,c,h),Xr=_,Di=S,Xr!==null&&(Di?vt(Xr,h.stateNode):lt(Xr,h.stateNode))}else ia(l,c,h);break;case 18:Me&&Xr!==null&&(Di?Be(Xr,h.stateNode):Re(Xr,h.stateNode));break;case 4:Me?(_=Xr,S=Di,Xr=h.stateNode.containerInfo,Di=!0,ia(l,c,h),Xr=_,Di=S):(G&&(_=h.stateNode.containerInfo,S=ai(_),$r(_,S)),ia(l,c,h));break;case 0:case 11:case 14:case 15:if(!sn&&(_=h.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){S=_=_.next;do{var R=S,B=R.destroy;R=R.tag,B!==void 0&&(R&2||R&4)&&Z1(h,c,B),S=S.next}while(S!==_)}ia(l,c,h);break;case 1:if(!sn&&(nl(h,c),_=h.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=h.memoizedProps,_.state=h.memoizedState,_.componentWillUnmount()}catch(J){Jt(h,c,J)}ia(l,c,h);break;case 21:ia(l,c,h);break;case 22:h.mode&1?(sn=(_=sn)||h.memoizedState!==null,ia(l,c,h),sn=_):ia(l,c,h);break;default:ia(l,c,h)}}function Hv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var h=l.stateNode;h===null&&(h=l.stateNode=new HS),c.forEach(function(_){var S=ek.bind(null,l,_);h.has(_)||(h.add(_),_.then(S,S))})}}function bi(l,c){var h=c.deletions;if(h!==null)for(var _=0;_<h.length;_++){var S=h[_];try{var R=l,B=c;if(Me){var J=B;e:for(;J!==null;){switch(J.tag){case 5:Xr=J.stateNode,Di=!1;break e;case 3:Xr=J.stateNode.containerInfo,Di=!0;break e;case 4:Xr=J.stateNode.containerInfo,Di=!0;break e}J=J.return}if(Xr===null)throw Error(s(160));np(R,B,S),Xr=null,Di=!1}else np(R,B,S);var fe=S.alternate;fe!==null&&(fe.return=null),S.return=null}catch(Le){Jt(S,c,Le)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Wv(c,l),c=c.sibling}function Wv(l,c){var h=l.alternate,_=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(bi(c,l),aa(l),_&4){try{Pc(3,l,l.return),Ku(3,l)}catch(ze){Jt(l,l.return,ze)}try{Pc(5,l,l.return)}catch(ze){Jt(l,l.return,ze)}}break;case 1:bi(c,l),aa(l),_&512&&h!==null&&nl(h,h.return);break;case 5:if(bi(c,l),aa(l),_&512&&h!==null&&nl(h,h.return),Me){if(l.flags&32){var S=l.stateNode;try{Ne(S)}catch(ze){Jt(l,l.return,ze)}}if(_&4&&(S=l.stateNode,S!=null)){var R=l.memoizedProps;if(h=h!==null?h.memoizedProps:R,_=l.type,c=l.updateQueue,l.updateQueue=null,c!==null)try{Qe(S,c,_,h,R,l)}catch(ze){Jt(l,l.return,ze)}}}break;case 6:if(bi(c,l),aa(l),_&4&&Me){if(l.stateNode===null)throw Error(s(162));S=l.stateNode,R=l.memoizedProps,h=h!==null?h.memoizedProps:R;try{Fe(S,h,R)}catch(ze){Jt(l,l.return,ze)}}break;case 3:if(bi(c,l),aa(l),_&4){if(Me&&Ze&&h!==null&&h.memoizedState.isDehydrated)try{ae(c.containerInfo)}catch(ze){Jt(l,l.return,ze)}if(G){S=c.containerInfo,R=c.pendingChildren;try{$r(S,R)}catch(ze){Jt(l,l.return,ze)}}}break;case 4:if(bi(c,l),aa(l),_&4&&G){R=l.stateNode,S=R.containerInfo,R=R.pendingChildren;try{$r(S,R)}catch(ze){Jt(l,l.return,ze)}}break;case 13:bi(c,l),aa(l),S=l.child,S.flags&8192&&(R=S.memoizedState!==null,S.stateNode.isHidden=R,!R||S.alternate!==null&&S.alternate.memoizedState!==null||(up=Lr())),_&4&&Hv(l);break;case 22:var B=h!==null&&h.memoizedState!==null;if(l.mode&1?(sn=(h=sn)||B,bi(c,l),sn=h):bi(c,l),aa(l),_&8192){if(h=l.memoizedState!==null,(l.stateNode.isHidden=h)&&!B&&l.mode&1)for(We=l,_=l.child;_!==null;){for(c=We=_;We!==null;){B=We;var J=B.child;switch(B.tag){case 0:case 11:case 14:case 15:Pc(4,B,B.return);break;case 1:nl(B,B.return);var fe=B.stateNode;if(typeof fe.componentWillUnmount=="function"){var Le=B,Xe=B.return;try{var ct=Le;fe.props=ct.memoizedProps,fe.state=ct.memoizedState,fe.componentWillUnmount()}catch(ze){Jt(Le,Xe,ze)}}break;case 5:nl(B,B.return);break;case 22:if(B.memoizedState!==null){Kv(c);continue}}J!==null?(J.return=B,We=J):Kv(c)}_=_.sibling}if(Me){e:if(_=null,Me)for(c=l;;){if(c.tag===5){if(_===null){_=c;try{S=c.stateNode,h?Ye(S):at(c.stateNode,c.memoizedProps)}catch(ze){Jt(l,l.return,ze)}}}else if(c.tag===6){if(_===null)try{R=c.stateNode,h?Ue(R):At(R,c.memoizedProps)}catch(ze){Jt(l,l.return,ze)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;_===c&&(_=null),c=c.return}_===c&&(_=null),c.sibling.return=c.return,c=c.sibling}}}break;case 19:bi(c,l),aa(l),_&4&&Hv(l);break;case 21:break;default:bi(c,l),aa(l)}}function aa(l){var c=l.flags;if(c&2){try{if(Me){e:{for(var h=l.return;h!==null;){if(Vv(h)){var _=h;break e}h=h.return}throw Error(s(160))}switch(_.tag){case 5:var S=_.stateNode;_.flags&32&&(Ne(S),_.flags&=-33);var R=Gv(l);rp(l,R,S);break;case 3:case 4:var B=_.stateNode.containerInfo,J=Gv(l);tp(l,J,B);break;default:throw Error(s(161))}}}catch(fe){Jt(l,l.return,fe)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function $S(l,c,h){We=l,$v(l)}function $v(l,c,h){for(var _=(l.mode&1)!==0;We!==null;){var S=We,R=S.child;if(S.tag===22&&_){var B=S.memoizedState!==null||Xu;if(!B){var J=S.alternate,fe=J!==null&&J.memoizedState!==null||sn;J=Xu;var Le=sn;if(Xu=B,(sn=fe)&&!Le)for(We=S;We!==null;)B=We,fe=B.child,B.tag===22&&B.memoizedState!==null?Yv(S):fe!==null?(fe.return=B,We=fe):Yv(S);for(;R!==null;)We=R,$v(R),R=R.sibling;We=S,Xu=J,sn=Le}Xv(l)}else S.subtreeFlags&8772&&R!==null?(R.return=S,We=R):Xv(l)}}function Xv(l){for(;We!==null;){var c=We;if(c.flags&8772){var h=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:sn||Ku(5,c);break;case 1:var _=c.stateNode;if(c.flags&4&&!sn)if(h===null)_.componentDidMount();else{var S=c.elementType===c.type?h.memoizedProps:Ii(c.type,h.memoizedProps);_.componentDidUpdate(S,h.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var R=c.updateQueue;R!==null&&Qx(c,R,_);break;case 3:var B=c.updateQueue;if(B!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=Ee(c.child.stateNode);break;case 1:h=c.child.stateNode}Qx(c,B,h)}break;case 5:var J=c.stateNode;h===null&&c.flags&4&&ke(J,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(Ze&&c.memoizedState===null){var fe=c.alternate;if(fe!==null){var Le=fe.memoizedState;if(Le!==null){var Xe=Le.dehydrated;Xe!==null&&oe(Xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}sn||c.flags&512&&ep(c)}catch(ct){Jt(c,c.return,ct)}}if(c===l){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function Kv(l){for(;We!==null;){var c=We;if(c===l){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function Yv(l){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Ku(4,c)}catch(fe){Jt(c,h,fe)}break;case 1:var _=c.stateNode;if(typeof _.componentDidMount=="function"){var S=c.return;try{_.componentDidMount()}catch(fe){Jt(c,S,fe)}}var R=c.return;try{ep(c)}catch(fe){Jt(c,R,fe)}break;case 5:var B=c.return;try{ep(c)}catch(fe){Jt(c,B,fe)}}}catch(fe){Jt(c,c.return,fe)}if(c===l){We=null;break}var J=c.sibling;if(J!==null){J.return=c.return,We=J;break}We=c.return}}var Yu=0,Qu=1,qu=2,Ju=3,Zu=4;if(typeof Symbol=="function"&&Symbol.for){var Fc=Symbol.for;Yu=Fc("selector.component"),Qu=Fc("selector.has_pseudo_class"),qu=Fc("selector.role"),Ju=Fc("selector.test_id"),Zu=Fc("selector.text")}function ip(l){var c=nt(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(s(364));return c}if(l=pe(l),l===null)throw Error(s(362));return l.stateNode.current}function ap(l,c){switch(c.$$typeof){case Yu:if(l.type===c.value)return!0;break;case Qu:e:{c=c.value,l=[l,0];for(var h=0;h<l.length;){var _=l[h++],S=l[h++],R=c[S];if(_.tag!==5||!Ae(_)){for(;R!=null&&ap(_,R);)S++,R=c[S];if(S===c.length){c=!0;break e}else for(_=_.child;_!==null;)l.push(_,S),_=_.sibling}}c=!1}return c;case qu:if(l.tag===5&&be(l.stateNode,c.value))return!0;break;case Zu:if((l.tag===5||l.tag===6)&&(l=Te(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case Ju:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function sp(l){switch(l.$$typeof){case Yu:return"<"+(N(l.value)||"Unknown")+">";case Qu:return":has("+(sp(l)||"")+")";case qu:return'[role="'+l.value+'"]';case Zu:return'"'+l.value+'"';case Ju:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function Qv(l,c){var h=[];l=[l,0];for(var _=0;_<l.length;){var S=l[_++],R=l[_++],B=c[R];if(S.tag!==5||!Ae(S)){for(;B!=null&&ap(S,B);)R++,B=c[R];if(R===c.length)h.push(S);else for(S=S.child;S!==null;)l.push(S,R),S=S.sibling}}return h}function op(l,c){if(!me)throw Error(s(363));l=ip(l),l=Qv(l,c),c=[],l=Array.from(l);for(var h=0;h<l.length;){var _=l[h++];if(_.tag===5)Ae(_)||c.push(_.stateNode);else for(_=_.child;_!==null;)l.push(_),_=_.sibling}return c}var XS=Math.ceil,ef=o.ReactCurrentDispatcher,lp=o.ReactCurrentOwner,hr=o.ReactCurrentBatchConfig,gt=0,Br=null,vr=null,Kr=0,$n=0,il=tn(0),Cr=0,Nc=null,eo=0,tf=0,cp=0,Rc=null,bn=null,up=0,fp=1/0,Ca=null;function al(){fp=Lr()+500}var rf=!1,dp=null,ts=null,nf=!1,rs=null,af=0,Ic=0,hp=null,sf=-1,of=0;function on(){return gt&6?Lr():sf!==-1?sf:sf=Lr()}function ns(l){return l.mode&1?gt&2&&Kr!==0?Kr&-Kr:FS.transition!==null?(of===0&&(of=bx()),of):(l=Nt,l!==0?l:qe()):1}function hi(l,c,h,_){if(50<Ic)throw Ic=0,hp=null,Error(s(185));mc(l,h,_),(!(gt&2)||l!==Br)&&(l===Br&&(!(gt&2)&&(tf|=h),Cr===4&&is(l,Kr)),On(l,_),h===1&&gt===0&&!(c.mode&1)&&(al(),Tu&&Zi()))}function On(l,c){var h=l.callbackNode;_S(l,c);var _=Eu(l,l===Br?Kr:0);if(_===0)h!==null&&Lx(h),l.callbackNode=null,l.callbackPriority=0;else if(c=_&-_,l.callbackPriority!==c){if(h!=null&&Lx(h),c===1)l.tag===0?PS(Jv.bind(null,l)):Mx(Jv.bind(null,l)),kt?Or(function(){!(gt&6)&&Zi()}):m1(x1,Zi),h=null;else{switch(Ox(_)){case 1:h=x1;break;case 4:h=ES;break;case 16:h=v1;break;case 536870912:h=CS;break;default:h=v1}h=o4(h,qv.bind(null,l))}l.callbackPriority=c,l.callbackNode=h}}function qv(l,c){if(sf=-1,of=0,gt&6)throw Error(s(327));var h=l.callbackNode;if(no()&&l.callbackNode!==h)return null;var _=Eu(l,l===Br?Kr:0);if(_===0)return null;if(_&30||_&l.expiredLanes||c)c=lf(l,_);else{c=_;var S=gt;gt|=2;var R=t4();(Br!==l||Kr!==c)&&(Ca=null,al(),to(l,c));do try{QS();break}catch(J){e4(l,J)}while(1);T1(),ef.current=R,gt=S,vr!==null?c=0:(Br=null,Kr=0,c=Cr)}if(c!==0){if(c===2&&(S=h1(l),S!==0&&(_=S,c=pp(l,S))),c===1)throw h=Nc,to(l,0),is(l,_),On(l,Lr()),h;if(c===6)is(l,_);else{if(S=l.current.alternate,!(_&30)&&!KS(S)&&(c=lf(l,_),c===2&&(R=h1(l),R!==0&&(_=R,c=pp(l,R))),c===1))throw h=Nc,to(l,0),is(l,_),On(l,Lr()),h;switch(l.finishedWork=S,l.finishedLanes=_,c){case 0:case 1:throw Error(s(345));case 2:ro(l,bn,Ca);break;case 3:if(is(l,_),(_&130023424)===_&&(c=up+500-Lr(),10<c)){if(Eu(l,0)!==0)break;if(S=l.suspendedLanes,(S&_)!==_){on(),l.pingedLanes|=l.suspendedLanes&S;break}l.timeoutHandle=z(ro.bind(null,l,bn,Ca),c);break}ro(l,bn,Ca);break;case 4:if(is(l,_),(_&4194240)===_)break;for(c=l.eventTimes,S=-1;0<_;){var B=31-Fi(_);R=1<<B,B=c[B],B>S&&(S=B),_&=~R}if(_=S,_=Lr()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*XS(_/1960))-_,10<_){l.timeoutHandle=z(ro.bind(null,l,bn,Ca),_);break}ro(l,bn,Ca);break;case 5:ro(l,bn,Ca);break;default:throw Error(s(329))}}}return On(l,Lr()),l.callbackNode===h?qv.bind(null,l):null}function pp(l,c){var h=Rc;return l.current.memoizedState.isDehydrated&&(to(l,c).flags|=256),l=lf(l,c),l!==2&&(c=bn,bn=h,c!==null&&gp(c)),l}function gp(l){bn===null?bn=l:bn.push.apply(bn,l)}function KS(l){for(var c=l;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var _=0;_<h.length;_++){var S=h[_],R=S.getSnapshot;S=S.value;try{if(!Ni(R(),S))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function is(l,c){for(c&=~cp,c&=~tf,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var h=31-Fi(c),_=1<<h;l[h]=-1,c&=~_}}function Jv(l){if(gt&6)throw Error(s(327));no();var c=Eu(l,0);if(!(c&1))return On(l,Lr()),null;var h=lf(l,c);if(l.tag!==0&&h===2){var _=h1(l);_!==0&&(c=_,h=pp(l,_))}if(h===1)throw h=Nc,to(l,0),is(l,c),On(l,Lr()),h;if(h===6)throw Error(s(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,ro(l,bn,Ca),On(l,Lr()),null}function Zv(l){rs!==null&&rs.tag===0&&!(gt&6)&&no();var c=gt;gt|=1;var h=hr.transition,_=Nt;try{if(hr.transition=null,Nt=1,l)return l()}finally{Nt=_,hr.transition=h,gt=c,!(gt&6)&&Zi()}}function mp(){$n=il.current,Mt(il)}function to(l,c){l.finishedWork=null,l.finishedLanes=0;var h=l.timeoutHandle;if(h!==de&&(l.timeoutHandle=de,ee(h)),vr!==null)for(h=vr.return;h!==null;){var _=h;switch(w1(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&_u();break;case 3:tl(),Mt(Rn),Mt(rn),b1();break;case 5:I1(_);break;case 4:tl();break;case 13:Mt(rr);break;case 19:Mt(rr);break;case 10:A1(_.type._context);break;case 22:case 23:mp()}h=h.return}if(Br=l,vr=l=as(l.current,null),Kr=$n=c,Cr=0,Nc=null,cp=tf=eo=0,bn=Rc=null,Js!==null){for(c=0;c<Js.length;c++)if(h=Js[c],_=h.interleaved,_!==null){h.interleaved=null;var S=_.next,R=h.pending;if(R!==null){var B=R.next;R.next=S,_.next=B}h.pending=_}Js=null}return l}function e4(l,c){do{var h=vr;try{if(T1(),Mu.current=zu,Bu){for(var _=nr.memoizedState;_!==null;){var S=_.queue;S!==null&&(S.pending=null),_=_.next}Bu=!1}if(Zs=0,Mr=Er=nr=null,wc=!1,Sc=0,lp.current=null,h===null||h.return===null){Cr=1,Nc=c,vr=null;break}e:{var R=l,B=h.return,J=h,fe=c;if(c=Kr,J.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Le=fe,Xe=J,ct=Xe.tag;if(!(Xe.mode&1)&&(ct===0||ct===11||ct===15)){var ze=Xe.alternate;ze?(Xe.updateQueue=ze.updateQueue,Xe.memoizedState=ze.memoizedState,Xe.lanes=ze.lanes):(Xe.updateQueue=null,Xe.memoizedState=null)}var Xt=Cv(B);if(Xt!==null){Xt.flags&=-257,Tv(Xt,B,J,R,c),Xt.mode&1&&Ev(R,Le,c),c=Xt,fe=Le;var Vt=c.updateQueue;if(Vt===null){var Ln=new Set;Ln.add(fe),c.updateQueue=Ln}else Vt.add(fe);break e}else{if(!(c&1)){Ev(R,Le,c),xp();break e}fe=Error(s(426))}}else if(qt&&J.mode&1){var Ta=Cv(B);if(Ta!==null){!(Ta.flags&65536)&&(Ta.flags|=256),Tv(Ta,B,J,R,c),E1(rl(fe,J));break e}}R=fe=rl(fe,J),Cr!==4&&(Cr=2),Rc===null?Rc=[R]:Rc.push(R),R=B;do{switch(R.tag){case 3:R.flags|=65536,c&=-c,R.lanes|=c;var le=Sv(R,fe,c);Yx(R,le);break e;case 1:J=fe;var Z=R.type,ge=R.stateNode;if(!(R.flags&128)&&(typeof Z.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(ts===null||!ts.has(ge)))){R.flags|=65536,c&=-c,R.lanes|=c;var Ve=kv(R,J,c);Yx(R,Ve);break e}}R=R.return}while(R!==null)}n4(h)}catch(et){c=et,vr===h&&h!==null&&(vr=h=h.return);continue}break}while(1)}function t4(){var l=ef.current;return ef.current=zu,l===null?zu:l}function xp(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),Br===null||!(eo&268435455)&&!(tf&268435455)||is(Br,Kr)}function lf(l,c){var h=gt;gt|=2;var _=t4();(Br!==l||Kr!==c)&&(Ca=null,to(l,c));do try{YS();break}catch(S){e4(l,S)}while(1);if(T1(),gt=h,ef.current=_,vr!==null)throw Error(s(261));return Br=null,Kr=0,Cr}function YS(){for(;vr!==null;)r4(vr)}function QS(){for(;vr!==null&&!SS();)r4(vr)}function r4(l){var c=s4(l.alternate,l,$n);l.memoizedProps=l.pendingProps,c===null?n4(l):vr=c,lp.current=null}function n4(l){var c=l;do{var h=c.alternate;if(l=c.return,c.flags&32768){if(h=GS(h,c),h!==null){h.flags&=32767,vr=h;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Cr=6,vr=null;return}}else if(h=VS(h,c,$n),h!==null){vr=h;return}if(c=c.sibling,c!==null){vr=c;return}vr=c=l}while(c!==null);Cr===0&&(Cr=5)}function ro(l,c,h){var _=Nt,S=hr.transition;try{hr.transition=null,Nt=1,qS(l,c,h,_)}finally{hr.transition=S,Nt=_}return null}function qS(l,c,h,_){do no();while(rs!==null);if(gt&6)throw Error(s(327));h=l.finishedWork;var S=l.finishedLanes;if(h===null)return null;if(l.finishedWork=null,l.finishedLanes=0,h===l.current)throw Error(s(177));l.callbackNode=null,l.callbackPriority=0;var R=h.lanes|h.childLanes;if(wS(l,R),l===Br&&(vr=Br=null,Kr=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||nf||(nf=!0,o4(v1,function(){return no(),null})),R=(h.flags&15990)!==0,h.subtreeFlags&15990||R){R=hr.transition,hr.transition=null;var B=Nt;Nt=1;var J=gt;gt|=4,lp.current=null,WS(l,h),Wv(h,l),ce(l.containerInfo),l.current=h,$S(h),kS(),gt=J,Nt=B,hr.transition=R}else l.current=h;if(nf&&(nf=!1,rs=l,af=S),R=l.pendingLanes,R===0&&(ts=null),TS(h.stateNode),On(l,Lr()),c!==null)for(_=l.onRecoverableError,h=0;h<c.length;h++)S=c[h],_(S.value,{componentStack:S.stack,digest:S.digest});if(rf)throw rf=!1,l=dp,dp=null,l;return af&1&&l.tag!==0&&no(),R=l.pendingLanes,R&1?l===hp?Ic++:(Ic=0,hp=l):Ic=0,Zi(),null}function no(){if(rs!==null){var l=Ox(af),c=hr.transition,h=Nt;try{if(hr.transition=null,Nt=16>l?16:l,rs===null)var _=!1;else{if(l=rs,rs=null,af=0,gt&6)throw Error(s(331));var S=gt;for(gt|=4,We=l.current;We!==null;){var R=We,B=R.child;if(We.flags&16){var J=R.deletions;if(J!==null){for(var fe=0;fe<J.length;fe++){var Le=J[fe];for(We=Le;We!==null;){var Xe=We;switch(Xe.tag){case 0:case 11:case 15:Pc(8,Xe,R)}var ct=Xe.child;if(ct!==null)ct.return=Xe,We=ct;else for(;We!==null;){Xe=We;var ze=Xe.sibling,Xt=Xe.return;if(zv(Xe),Xe===Le){We=null;break}if(ze!==null){ze.return=Xt,We=ze;break}We=Xt}}}var Vt=R.alternate;if(Vt!==null){var Ln=Vt.child;if(Ln!==null){Vt.child=null;do{var Ta=Ln.sibling;Ln.sibling=null,Ln=Ta}while(Ln!==null)}}We=R}}if(R.subtreeFlags&2064&&B!==null)B.return=R,We=B;else e:for(;We!==null;){if(R=We,R.flags&2048)switch(R.tag){case 0:case 11:case 15:Pc(9,R,R.return)}var le=R.sibling;if(le!==null){le.return=R.return,We=le;break e}We=R.return}}var Z=l.current;for(We=Z;We!==null;){B=We;var ge=B.child;if(B.subtreeFlags&2064&&ge!==null)ge.return=B,We=ge;else e:for(B=Z;We!==null;){if(J=We,J.flags&2048)try{switch(J.tag){case 0:case 11:case 15:Ku(9,J)}}catch(et){Jt(J,J.return,et)}if(J===B){We=null;break e}var Ve=J.sibling;if(Ve!==null){Ve.return=J.return,We=Ve;break e}We=J.return}}if(gt=S,Zi(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(Cu,l)}catch{}_=!0}return _}finally{Nt=h,hr.transition=c}}return!1}function i4(l,c,h){c=rl(h,c),c=Sv(l,c,1),l=es(l,c,1),c=on(),l!==null&&(mc(l,1,c),On(l,c))}function Jt(l,c,h){if(l.tag===3)i4(l,l,h);else for(;c!==null;){if(c.tag===3){i4(c,l,h);break}else if(c.tag===1){var _=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(ts===null||!ts.has(_))){l=rl(h,l),l=kv(c,l,1),c=es(c,l,1),l=on(),c!==null&&(mc(c,1,l),On(c,l));break}}c=c.return}}function JS(l,c,h){var _=l.pingCache;_!==null&&_.delete(c),c=on(),l.pingedLanes|=l.suspendedLanes&h,Br===l&&(Kr&h)===h&&(Cr===4||Cr===3&&(Kr&130023424)===Kr&&500>Lr()-up?to(l,0):cp|=h),On(l,c)}function a4(l,c){c===0&&(l.mode&1?(c=ku,ku<<=1,!(ku&130023424)&&(ku=4194304)):c=1);var h=on();l=ea(l,c),l!==null&&(mc(l,c,h),On(l,h))}function ZS(l){var c=l.memoizedState,h=0;c!==null&&(h=c.retryLane),a4(l,h)}function ek(l,c){var h=0;switch(l.tag){case 13:var _=l.stateNode,S=l.memoizedState;S!==null&&(h=S.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(s(314))}_!==null&&_.delete(c),a4(l,h)}var s4;s4=function(l,c,h){if(l!==null)if(l.memoizedProps!==c.pendingProps||Rn.current)Dn=!0;else{if(!(l.lanes&h)&&!(c.flags&128))return Dn=!1,zS(l,c,h);Dn=!!(l.flags&131072)}else Dn=!1,qt&&c.flags&1048576&&Bx(c,Pu,c.index);switch(c.lanes=0,c.tag){case 2:var _=c.type;Hu(l,c),l=c.pendingProps;var S=Xo(c,rn.current);Zo(c,h),S=M1(null,c,_,l,S,h);var R=B1();return c.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,In(_)?(R=!0,wu(c)):R=!1,c.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,N1(c),S.updater=Vu,c.stateNode=S,S._reactInternals=c,H1(c,_,l,h),c=K1(null,c,_,!0,R,h)):(c.tag=0,qt&&R&&_1(c),_n(null,c,S,h),c=c.child),c;case 16:_=c.elementType;e:{switch(Hu(l,c),l=c.pendingProps,S=_._init,_=S(_._payload),c.type=_,S=c.tag=rk(_),l=Ii(_,l),S){case 0:c=X1(null,c,_,l,h);break e;case 1:c=Iv(null,c,_,l,h);break e;case 11:c=Av(null,c,_,l,h);break e;case 14:c=Pv(null,c,_,Ii(_.type,l),h);break e}throw Error(s(306,_,""))}return c;case 0:return _=c.type,S=c.pendingProps,S=c.elementType===_?S:Ii(_,S),X1(l,c,_,S,h);case 1:return _=c.type,S=c.pendingProps,S=c.elementType===_?S:Ii(_,S),Iv(l,c,_,S,h);case 3:e:{if(Dv(c),l===null)throw Error(s(387));_=c.pendingProps,R=c.memoizedState,S=R.element,Kx(l,c),Ou(c,_,null,h);var B=c.memoizedState;if(_=B.element,Ze&&R.isDehydrated)if(R={element:_,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){S=rl(Error(s(423)),c),c=bv(l,c,_,h,S);break e}else if(_!==S){S=rl(Error(s(424)),c),c=bv(l,c,_,h,S);break e}else for(Ze&&(ci=j(c.stateNode.containerInfo),Wn=c,qt=!0,Ri=null,xc=!1),h=Wx(c,null,_,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Qo(),_===S){c=Ea(l,c,h);break e}_n(l,c,_,h)}c=c.child}return c;case 5:return qx(c),l===null&&k1(c),_=c.type,S=c.pendingProps,R=l!==null?l.memoizedProps:null,B=S.children,K(_,S)?B=null:R!==null&&K(_,R)&&(c.flags|=32),Rv(l,c),_n(l,c,B,h),c.child;case 6:return l===null&&k1(c),null;case 13:return Ov(l,c,h);case 4:return R1(c,c.stateNode.containerInfo),_=c.pendingProps,l===null?c.child=qo(c,null,_,h):_n(l,c,_,h),c.child;case 11:return _=c.type,S=c.pendingProps,S=c.elementType===_?S:Ii(_,S),Av(l,c,_,S,h);case 7:return _n(l,c,c.pendingProps,h),c.child;case 8:return _n(l,c,c.pendingProps.children,h),c.child;case 12:return _n(l,c,c.pendingProps.children,h),c.child;case 10:e:{if(_=c.type._context,S=c.pendingProps,R=c.memoizedProps,B=S.value,$x(c,_,B),R!==null)if(Ni(R.value,B)){if(R.children===S.children&&!Rn.current){c=Ea(l,c,h);break e}}else for(R=c.child,R!==null&&(R.return=c);R!==null;){var J=R.dependencies;if(J!==null){B=R.child;for(var fe=J.firstContext;fe!==null;){if(fe.context===_){if(R.tag===1){fe=ka(-1,h&-h),fe.tag=2;var Le=R.updateQueue;if(Le!==null){Le=Le.shared;var Xe=Le.pending;Xe===null?fe.next=fe:(fe.next=Xe.next,Xe.next=fe),Le.pending=fe}}R.lanes|=h,fe=R.alternate,fe!==null&&(fe.lanes|=h),P1(R.return,h,c),J.lanes|=h;break}fe=fe.next}}else if(R.tag===10)B=R.type===c.type?null:R.child;else if(R.tag===18){if(B=R.return,B===null)throw Error(s(341));B.lanes|=h,J=B.alternate,J!==null&&(J.lanes|=h),P1(B,h,c),B=R.sibling}else B=R.child;if(B!==null)B.return=R;else for(B=R;B!==null;){if(B===c){B=null;break}if(R=B.sibling,R!==null){R.return=B.return,B=R;break}B=B.return}R=B}_n(l,c,S.children,h),c=c.child}return c;case 9:return S=c.type,_=c.pendingProps.children,Zo(c,h),S=ui(S),_=_(S),c.flags|=1,_n(l,c,_,h),c.child;case 14:return _=c.type,S=Ii(_,c.pendingProps),S=Ii(_.type,S),Pv(l,c,_,S,h);case 15:return Fv(l,c,c.type,c.pendingProps,h);case 17:return _=c.type,S=c.pendingProps,S=c.elementType===_?S:Ii(_,S),Hu(l,c),c.tag=1,In(_)?(l=!0,wu(c)):l=!1,Zo(c,h),_v(c,_,S),H1(c,_,S,h),K1(null,c,_,!0,l,h);case 19:return Mv(l,c,h);case 22:return Nv(l,c,h)}throw Error(s(156,c.tag))};function o4(l,c){return m1(l,c)}function tk(l,c,h,_){this.tag=l,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pi(l,c,h,_){return new tk(l,c,h,_)}function vp(l){return l=l.prototype,!(!l||!l.isReactComponent)}function rk(l){if(typeof l=="function")return vp(l)?1:0;if(l!=null){if(l=l.$$typeof,l===y)return 11;if(l===w)return 14}return 2}function as(l,c){var h=l.alternate;return h===null?(h=pi(l.tag,c,l.key,l.mode),h.elementType=l.elementType,h.type=l.type,h.stateNode=l.stateNode,h.alternate=l,l.alternate=h):(h.pendingProps=c,h.type=l.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=l.flags&14680064,h.childLanes=l.childLanes,h.lanes=l.lanes,h.child=l.child,h.memoizedProps=l.memoizedProps,h.memoizedState=l.memoizedState,h.updateQueue=l.updateQueue,c=l.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=l.sibling,h.index=l.index,h.ref=l.ref,h}function cf(l,c,h,_,S,R){var B=2;if(_=l,typeof l=="function")vp(l)&&(B=1);else if(typeof l=="string")B=5;else e:switch(l){case d:return io(h.children,S,R,c);case p:B=8,S|=8;break;case g:return l=pi(12,h,c,S|2),l.elementType=g,l.lanes=R,l;case E:return l=pi(13,h,c,S),l.elementType=E,l.lanes=R,l;case k:return l=pi(19,h,c,S),l.elementType=k,l.lanes=R,l;case C:return uf(h,S,R,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:B=10;break e;case m:B=9;break e;case y:B=11;break e;case w:B=14;break e;case x:B=16,_=null;break e}throw Error(s(130,l==null?l:typeof l,""))}return c=pi(B,h,c,S),c.elementType=l,c.type=_,c.lanes=R,c}function io(l,c,h,_){return l=pi(7,l,_,c),l.lanes=h,l}function uf(l,c,h,_){return l=pi(22,l,_,c),l.elementType=C,l.lanes=h,l.stateNode={isHidden:!1},l}function yp(l,c,h){return l=pi(6,l,null,c),l.lanes=h,l}function _p(l,c,h){return c=pi(4,l.children!==null?l.children:[],l.key,c),c.lanes=h,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function nk(l,c,h,_,S){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=de,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=p1(0),this.expirationTimes=p1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=p1(0),this.identifierPrefix=_,this.onRecoverableError=S,Ze&&(this.mutableSourceEagerHydrationData=null)}function l4(l,c,h,_,S,R,B,J,fe){return l=new nk(l,c,h,J,fe),c===1?(c=1,R===!0&&(c|=8)):c=0,R=pi(3,null,null,c),l.current=R,R.stateNode=l,R.memoizedState={element:_,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},N1(R),l}function c4(l){if(!l)return Ja;l=l._reactInternals;e:{if(I(l)!==l||l.tag!==1)throw Error(s(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(In(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(s(171))}if(l.tag===1){var h=l.type;if(In(h))return Ix(l,h,c)}return c}function u4(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=O(c),l===null?null:l.stateNode}function f4(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var h=l.retryLane;l.retryLane=h!==0&&h<c?h:c}}function ff(l,c){f4(l,c),(l=l.alternate)&&f4(l,c)}function ik(l){return l=O(l),l===null?null:l.stateNode}function ak(){return null}return r.attemptContinuousHydration=function(l){if(l.tag===13){var c=ea(l,134217728);if(c!==null){var h=on();hi(c,l,134217728,h)}ff(l,134217728)}},r.attemptDiscreteHydration=function(l){if(l.tag===13){var c=ea(l,1);if(c!==null){var h=on();hi(c,l,1,h)}ff(l,1)}},r.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=ns(l),h=ea(l,c);if(h!==null){var _=on();hi(h,l,c,_)}ff(l,c)}},r.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var h=gc(c.pendingLanes);h!==0&&(g1(c,h|1),On(c,Lr()),!(gt&6)&&(al(),Zi()))}break;case 13:Zv(function(){var _=ea(l,1);if(_!==null){var S=on();hi(_,l,1,S)}}),ff(l,1)}},r.batchedUpdates=function(l,c){var h=gt;gt|=1;try{return l(c)}finally{gt=h,gt===0&&(al(),Tu&&Zi())}},r.createComponentSelector=function(l){return{$$typeof:Yu,value:l}},r.createContainer=function(l,c,h,_,S,R,B){return l4(l,c,!1,null,h,_,S,R,B)},r.createHasPseudoClassSelector=function(l){return{$$typeof:Qu,value:l}},r.createHydrationContainer=function(l,c,h,_,S,R,B,J,fe){return l=l4(h,_,!0,l,S,R,B,J,fe),l.context=c4(null),h=l.current,_=on(),S=ns(h),R=ka(_,S),R.callback=c??null,es(h,R,S),l.current.lanes=S,mc(l,S,_),On(l,_),l},r.createPortal=function(l,c,h){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:_==null?null:""+_,children:l,containerInfo:c,implementation:h}},r.createRoleSelector=function(l){return{$$typeof:qu,value:l}},r.createTestNameSelector=function(l){return{$$typeof:Ju,value:l}},r.createTextSelector=function(l){return{$$typeof:Zu,value:l}},r.deferredUpdates=function(l){var c=Nt,h=hr.transition;try{return hr.transition=null,Nt=16,l()}finally{Nt=c,hr.transition=h}},r.discreteUpdates=function(l,c,h,_,S){var R=Nt,B=hr.transition;try{return hr.transition=null,Nt=1,l(c,h,_,S)}finally{Nt=R,hr.transition=B,gt===0&&al()}},r.findAllNodes=op,r.findBoundingRects=function(l,c){if(!me)throw Error(s(363));c=op(l,c),l=[];for(var h=0;h<c.length;h++)l.push(Ce(c[h]));for(c=l.length-1;0<c;c--){h=l[c];for(var _=h.x,S=_+h.width,R=h.y,B=R+h.height,J=c-1;0<=J;J--)if(c!==J){var fe=l[J],Le=fe.x,Xe=Le+fe.width,ct=fe.y,ze=ct+fe.height;if(_>=Le&&R>=ct&&S<=Xe&&B<=ze){l.splice(c,1);break}else if(_!==Le||h.width!==fe.width||ze<R||ct>B){if(!(R!==ct||h.height!==fe.height||Xe<_||Le>S)){Le>_&&(fe.width+=Le-_,fe.x=_),Xe<S&&(fe.width=S-Le),l.splice(c,1);break}}else{ct>R&&(fe.height+=ct-R,fe.y=R),ze<B&&(fe.height=B-ct),l.splice(c,1);break}}}return l},r.findHostInstance=u4,r.findHostInstanceWithNoPortals=function(l){return l=U(l),l=l!==null?he(l):null,l===null?null:l.stateNode},r.findHostInstanceWithWarning=function(l){return u4(l)},r.flushControlled=function(l){var c=gt;gt|=1;var h=hr.transition,_=Nt;try{hr.transition=null,Nt=1,l()}finally{Nt=_,hr.transition=h,gt=c,gt===0&&(al(),Zi())}},r.flushPassiveEffects=no,r.flushSync=Zv,r.focusWithin=function(l,c){if(!me)throw Error(s(363));for(l=ip(l),c=Qv(l,c),c=Array.from(c),l=0;l<c.length;){var h=c[l++];if(!Ae(h)){if(h.tag===5&&Ge(h.stateNode))return!0;for(h=h.child;h!==null;)c.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Nt},r.getFindAllNodesFailureDescription=function(l,c){if(!me)throw Error(s(363));var h=0,_=[];l=[ip(l),0];for(var S=0;S<l.length;){var R=l[S++],B=l[S++],J=c[B];if((R.tag!==5||!Ae(R))&&(ap(R,J)&&(_.push(sp(J)),B++,B>h&&(h=B)),B<c.length))for(R=R.child;R!==null;)l.push(R,B),R=R.sibling}if(h<c.length){for(l=[];h<c.length;h++)l.push(sp(c[h]));return`findAllNodes was able to match part of the selector:
  `+(_.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},r.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return Ee(l.child.stateNode);default:return l.child.stateNode}},r.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ik,findFiberByHostInstance:l.findFiberByHostInstance||ak,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Cu=c.inject(l),Ji=c}catch{}l=!!c.checkDCE}}return l},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(l,c,h,_){if(!me)throw Error(s(363));l=op(l,c);var S=ye(l,h,_).disconnect;return{disconnect:function(){S()}}},r.registerMutableSourceForHydration=function(l,c){var h=c._getVersion;h=h(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,h]:l.mutableSourceEagerHydrationData.push(c,h)},r.runWithPriority=function(l,c){var h=Nt;try{return Nt=l,c()}finally{Nt=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(l,c,h,_){var S=c.current,R=on(),B=ns(S);return h=c4(h),c.context===null?c.context=h:c.pendingContext=h,c=ka(R,B),c.payload={element:l},_=_===void 0?null:_,_!==null&&(c.callback=_),l=es(S,c,B),l!==null&&(hi(l,S,B,R),bu(l,S,B)),B},r};lS.exports=GM;var HM=lS.exports;const WM=Xd(HM);var cS={exports:{}},Wo={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Wo.ConcurrentRoot=1;Wo.ContinuousEventPriority=4;Wo.DefaultEventPriority=16;Wo.DiscreteEventPriority=1;Wo.IdleEventPriority=536870912;Wo.LegacyRoot=0;cS.exports=Wo;var uS=cS.exports;const h5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let p5=!1,g5=!1;const Fx=".react-konva-event",$M=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,XM=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,KM={};function u1(e,t,r=KM){if(!p5&&"zIndex"in t&&(console.warn(XM),p5=!0),!g5&&t.draggable){var n=t.x!==void 0||t.y!==void 0,i=t.onDragEnd||t.onDragMove;n&&!i&&(console.warn($M),g5=!0)}for(var a in r)if(!h5[a]){var s=a.slice(0,2)==="on",o=r[a]!==t[a];if(s&&o){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e.off(u,r[a])}var f=!t.hasOwnProperty(a);f&&e.setAttr(a,void 0)}var d=t._useStrictMode,p={},g=!1;const v={};for(var a in t)if(!h5[a]){var s=a.slice(0,2)==="on",m=r[a]!==t[a];if(s&&m){var u=a.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t[a]&&(v[u]=t[a])}!s&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,p[a]=t[a])}g&&(e.setAttrs(p),$s(e));for(var u in v)e.on(u+Fx,v[u])}function $s(e){if(!pt.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const fS={},YM={};ru.Node.prototype._applyProps=u1;function QM(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),$s(e)}function qM(e,t,r){let n=ru[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=ru.Group);const i={},a={};for(var s in t){var o=s.slice(0,2)==="on";o?a[s]=t[s]:i[s]=t[s]}const u=new n(i);return u1(u,a),u}function JM(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function ZM(e,t,r){return!1}function eB(e){return e}function tB(){return null}function rB(){return null}function nB(e,t,r,n){return YM}function iB(){}function aB(e){}function sB(e,t){return!1}function oB(){return fS}function lB(){return fS}const cB=setTimeout,uB=clearTimeout,fB=-1;function dB(e,t){return!1}const hB=!1,pB=!0,gB=!0;function mB(e,t){t.parent===e?t.moveToTop():e.add(t),$s(e)}function xB(e,t){t.parent===e?t.moveToTop():e.add(t),$s(e)}function dS(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),$s(e)}function vB(e,t,r){dS(e,t,r)}function yB(e,t){t.destroy(),t.off(Fx),$s(e)}function _B(e,t){t.destroy(),t.off(Fx),$s(e)}function wB(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function SB(e,t,r){}function kB(e,t,r,n,i){u1(e,i,n)}function EB(e){e.hide(),$s(e)}function CB(e){}function TB(e,t){(t.visible==null||t.visible)&&e.show()}function AB(e,t){}function PB(e){}function FB(){}const NB=()=>uS.DefaultEventPriority,RB=Object.freeze(Object.defineProperty({__proto__:null,appendChild:mB,appendChildToContainer:xB,appendInitialChild:QM,cancelTimeout:uB,clearContainer:PB,commitMount:SB,commitTextUpdate:wB,commitUpdate:kB,createInstance:qM,createTextInstance:JM,detachDeletedInstance:FB,finalizeInitialChildren:ZM,getChildHostContext:lB,getCurrentEventPriority:NB,getPublicInstance:eB,getRootHostContext:oB,hideInstance:EB,hideTextInstance:CB,idlePriority:s0.unstable_IdlePriority,insertBefore:dS,insertInContainerBefore:vB,isPrimaryRenderer:hB,noTimeout:fB,now:s0.unstable_now,prepareForCommit:tB,preparePortalMount:rB,prepareUpdate:nB,removeChild:yB,removeChildFromContainer:_B,resetAfterCommit:iB,resetTextContent:aB,run:s0.unstable_runWithPriority,scheduleTimeout:cB,shouldDeprioritizeSubtree:sB,shouldSetTextContent:dB,supportsMutation:gB,unhideInstance:TB,unhideTextInstance:AB,warnsIfNotActing:pB},Symbol.toStringTag,{value:"Module"}));var IB=Object.defineProperty,DB=Object.defineProperties,bB=Object.getOwnPropertyDescriptors,m5=Object.getOwnPropertySymbols,OB=Object.prototype.hasOwnProperty,LB=Object.prototype.propertyIsEnumerable,x5=(e,t,r)=>t in e?IB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v5=(e,t)=>{for(var r in t||(t={}))OB.call(t,r)&&x5(e,r,t[r]);if(m5)for(var r of m5(t))LB.call(t,r)&&x5(e,r,t[r]);return e},MB=(e,t)=>DB(e,bB(t)),y5,_5;typeof window<"u"&&((y5=window.document)!=null&&y5.createElement||((_5=window.navigator)==null?void 0:_5.product)==="ReactNative")?_e.useLayoutEffect:_e.useEffect;function hS(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=t?e.return:e.child;for(;n;){const i=hS(n,t,r);if(i)return i;n=t?null:n.sibling}}function pS(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const w5=console.error;console.error=function(){const e=[...arguments].join("");if(e!=null&&e.startsWith("Warning:")&&e.includes("useContext")){console.error=w5;return}return w5.apply(this,arguments)};const Nx=pS(_e.createContext(null));class gS extends _e.Component{render(){return _e.createElement(Nx.Provider,{value:this._reactInternals},this.props.children)}}function BB(){const e=_e.useContext(Nx);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=_e.useId();return _e.useMemo(()=>{for(const n of[e,e==null?void 0:e.alternate]){if(!n)continue;const i=hS(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===t)return!0;s=s.next}});if(i)return i}},[e,t])}function UB(){const e=BB(),[t]=_e.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==Nx&&!t.has(i)&&t.set(i,_e.useContext(pS(i)))}r=r.return}return t}function jB(){const e=UB();return _e.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>_e.createElement(t,null,_e.createElement(r.Provider,MB(v5({},n),{value:e.get(r)}))),t=>_e.createElement(gS,v5({},t))),[e])}function zB(e){const t=Sr.useRef({});return Sr.useLayoutEffect(()=>{t.current=e}),Sr.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const VB=e=>{const t=Sr.useRef(),r=Sr.useRef(),n=Sr.useRef(),i=zB(e),a=jB(),s=o=>{const{forwardedRef:u}=e;u&&(typeof u=="function"?u(o):u.current=o)};return Sr.useLayoutEffect(()=>(r.current=new ru.Stage({width:e.width,height:e.height,container:t.current}),s(r.current),n.current=a0.createContainer(r.current,uS.LegacyRoot,!1,null),a0.updateContainer(Sr.createElement(a,{},e.children),n.current),()=>{ru.isBrowser&&(s(null),a0.updateContainer(null,n.current,null),r.current.destroy())}),[]),Sr.useLayoutEffect(()=>{s(r.current),u1(r.current,e,i),a0.updateContainer(Sr.createElement(a,{},e.children),n.current,null)}),Sr.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},GB="Layer",Xc="Group",Xn="Rect",Kc="Circle",S5="Line",la="Text",a0=WM(RB);a0.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Sr.version,rendererPackageName:"react-konva"});const HB=Sr.forwardRef((e,t)=>Sr.createElement(gS,{},Sr.createElement(VB,{...e,forwardedRef:t}))),Yc=[{level:0,threshold:.1,description:"Ultra Low - Package outline only"},{level:1,threshold:.3,description:"Low - Package + major banks"},{level:2,threshold:.7,description:"Medium - + pin circles"},{level:3,threshold:1.5,description:"High - + pin/signal names"},{level:4,threshold:1/0,description:"Ultra High - All details"}];function WB(e){for(let t=0;t<Yc.length;t++)if(e<Yc[t].threshold)return Yc[t].level;return Yc[Yc.length-1].level}function $B(e,t){return e>=t}function XB(e){switch(e){case 0:return 1;case 1:return .8;case 2:return .6;case 3:return .4;case 4:return .2;default:return .5}}function KB(e){switch(e){case 0:return 50;case 1:return 200;case 2:return 500;case 3:return 1e3;case 4:return 5e3;default:return 1e3}}function YB(e,t="pin"){return e>={pin:.7,signal:.7,bank:.3}[t]}function QB(e,t=12){if(e<.5)return 0;const r=t*Math.min(e,2);return Math.max(8,Math.min(r,24))}function qB(e){return e>=.3}function JB(e){return e>=.7}class Un{}Un.getLODLevel=WB;Un.shouldRenderAtLOD=$B;Un.getPerformanceMultiplier=XB;Un.getMaxElements=KB;Un.shouldRenderText=YB;Un.getAdaptiveTextSize=QB;Un.shouldRenderDifferentialPairs=qB;Un.shouldRenderPinDetails=JB;class jr{static createVirtualizedPinList(t,r,n){const i=Math.ceil(r/n)+5;return{getVisibleRange:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length);return{startIndex:s,endIndex:o}},getVisiblePins:a=>{const s=Math.floor(a/n),o=Math.min(s+i,t.length),{startIndex:u,endIndex:f}={startIndex:s,endIndex:o};return t.slice(u,f).map((d,p)=>({pin:d,index:u+p,top:(u+p)*n}))},getTotalHeight:()=>t.length*n}}static createDebouncedSearch(t,r=300){let n,i=[];return{search:a=>new Promise(s=>{if(clearTimeout(n),!a.trim()){s([]);return}n=setTimeout(()=>{i=t(a),s(i)},r)}),getLastResults:()=>i,cancel:()=>{clearTimeout(n)}}}static optimizeCanvasRendering(){return{getLODLevel:t=>t<.3?"ultra-low":t<.6?"low":t<1.2?"medium":t<2.5?"high":"ultra-high",cullPins:(t,r)=>{const i={left:r.x-100,right:r.x+r.width+100,top:r.y-100,bottom:r.y+r.height+100};return t.filter(a=>{const s=a.position.x*r.scale,o=a.position.y*r.scale;return s>=i.left&&s<=i.right&&o>=i.top&&o<=i.bottom})},batchDOMUpdates:t=>{requestAnimationFrame(()=>{t.forEach(r=>r())})}}}static createPinIndexes(t){const r=new Map,n=new Map,i=new Map,a=new Map,s=new Map;return t.forEach(o=>{r.set(o.id,o),n.set(o.pinNumber,o),o.signalName&&(i.has(o.signalName)||i.set(o.signalName,[]),i.get(o.signalName).push(o)),o.bank&&(a.has(o.bank)||a.set(o.bank,[]),a.get(o.bank).push(o)),s.has(o.pinType)||s.set(o.pinType,[]),s.get(o.pinType).push(o)}),{byId:r,byPinNumber:n,bySignalName:i,byBank:a,byPinType:s,findById:o=>r.get(o),findByPinNumber:o=>n.get(o),findBySignalName:o=>i.get(o)||[],findByBank:o=>a.get(o)||[],findByPinType:o=>s.get(o)||[]}}static startRenderMeasurement(t){this.renderMetrics.set(t,performance.now())}static endRenderMeasurement(t){const r=this.renderMetrics.get(t);if(!r)return 0;const n=performance.now()-r;return this.renderMetrics.delete(t),n}static trackFrameRate(){this.frameCount++;const t=performance.now();if(t-this.lastFrameTime>=1e3){const r=this.frameCount/((t-this.lastFrameTime)/1e3);return this.frameCount=0,this.lastFrameTime=t,r}return null}static createSmartFilter(t){return{filter:(r,n)=>{const i=[];for(const a of t){if(n&&i.length>=n)break;let s=!0;for(const o of r)if(!o(a)){s=!1;break}s&&i.push(a)}return i}}}static createPinSearchRanker(){return{rankPins:(t,r)=>{const n=r.toLowerCase(),i=[];return t.forEach(a=>{let s=0;a.pinNumber.toLowerCase()===n?s+=100:a.pinNumber.toLowerCase().startsWith(n)?s+=80:a.pinNumber.toLowerCase().includes(n)&&(s+=40),a.signalName&&a.signalName.toLowerCase().includes(n)&&(s+=60),a.pinName.toLowerCase().includes(n)&&(s+=30),a.bank&&a.bank.toLowerCase().includes(n)&&(s+=20),s>0&&i.push({pin:a,score:s})}),i.sort((a,s)=>s.score-a.score)}}}}jr.renderMetrics=new Map;jr.frameCount=0;jr.lastFrameTime=performance.now();const ZB=({fileName:e,viewInfo:t})=>T.jsxs("div",{style:{width:"100%",height:"32px",background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"0 16px",position:"relative",zIndex:2,color:"#e0e0e0",fontSize:"12px",fontWeight:500,boxSizing:"border-box",borderBottom:"1px solid #333"},children:[T.jsx("span",{style:{transform:"translateY(-2px)"},children:t}),T.jsx("span",{style:{transform:"translateY(-2px)",marginLeft:"360px"},children:e})]}),eU=({package:e,pins:t,selectedPins:r,onPinSelect:n,onPinDoubleClick:i,zoom:a,rotation:s,isTopView:o,onZoomChange:u,resetTrigger:f=0})=>{const{togglePinSelection:d,selectPins:p,visibleBanks:g,toggleBankVisibility:v,showAllBanks:m}=Xi(),y=_e.useRef(null),E=_e.useRef(null),[k,w]=_e.useState({width:window.innerWidth,height:window.innerHeight-32}),[x,C]=_e.useState(null),[A,P]=_e.useState({x:0,y:0,scale:1}),[N,F]=_e.useState(!1),[I,D]=_e.useState({x:0,y:0}),[U,O]=_e.useState(0),[Q,he]=_e.useState({x:0,y:0});console.log(` PackageCanvas: Received ${t.length} pins (filtered)`);const te=Un.getLODLevel(A.scale),Ee=_e.useMemo(()=>{jr.startRenderMeasurement("pin-indexing");const me=jr.createPinIndexes(t);return jr.endRenderMeasurement("pin-indexing"),me},[t]),we=_e.useMemo(()=>{jr.startRenderMeasurement("viewport-culling");const me=k.width,pe=k.height,Ce=.2,Te=me*Ce/A.scale,Ae=pe*Ce/A.scale,be={x:-A.x/A.scale-me/(2*A.scale)-Te,y:-A.y/A.scale-pe/(2*A.scale)-Ae,width:me/A.scale+Te*2,height:pe/A.scale+Ae*2,scale:A.scale},Ge=(ye,ie)=>{let{x:Pe,y:Fe}=ye.position;if(s!==0){const ke=s*Math.PI/180,Qe=Math.cos(ke),Je=Math.sin(ke),dt=Pe*Qe-Fe*Je,lt=Pe*Je+Fe*Qe;Pe=dt,Fe=lt}return o||(Pe=-Pe),Pe>=ie.x&&Pe<=ie.x+ie.width&&Fe>=ie.y&&Fe<=ie.y+ie.height};if(A.scale>.6){const ye=300/A.scale,ie={...be,x:be.x-ye*1.5,y:be.y-ye*3,width:be.width+ye*3,height:be.height+ye*6},Pe=Array.from(r).map(Je=>Ee.findById(Je)).filter(Boolean),Fe=t.filter(Je=>Ge(Je,ie)),ke=new Map;Fe.forEach(Je=>ke.set(Je.id,Je)),Pe.forEach(Je=>ke.set(Je.id,Je));const Qe=Array.from(ke.values());return console.log(` : ${Qe.length}/${t.length} pins visible (scale: ${A.scale.toFixed(2)})`),console.log(" Extended bounds:",ie),jr.endRenderMeasurement("viewport-culling"),Qe}else{if(A.scale<=.2)return jr.endRenderMeasurement("viewport-culling"),t;if(A.scale<=.4){const ie=new Map;t.forEach(ke=>{const Qe=ke.bank||"NA";ie.has(Qe)||ie.set(Qe,[]),ie.get(Qe).push(ke)});const Pe=[],Fe=Array.from(r).map(ke=>Ee.findById(ke)).filter(Boolean);return Pe.push(...Fe),ie.forEach(ke=>{const Qe=Math.max(1,Math.floor(ke.length*.85)),Je=Math.max(1,Math.floor(ke.length/Qe));for(let dt=0;dt<ke.length;dt+=Je){const lt=ke[dt];r.has(lt.id)||Pe.push(lt)}}),jr.endRenderMeasurement("viewport-culling"),Pe}else if(A.scale<=.6){const ye=400/A.scale,ie={x:be.x-ye*1.5,y:be.y-ye*2.5,width:be.width+ye*3,height:be.height+ye*5},Pe=Array.from(r).map(vt=>Ee.findById(vt)).filter(Boolean),Fe=t.filter(vt=>Ge(vt,ie)),ke=t.filter(vt=>!Fe.some(Ne=>Ne.id===vt.id)&&!r.has(vt.id)),Qe=Math.max(1,Math.floor(ke.length/200)),Je=ke.filter((vt,Ne)=>Ne%Qe===0),dt=new Map;Pe.forEach(vt=>dt.set(vt.id,vt)),Fe.forEach(vt=>dt.set(vt.id,vt)),Je.forEach(vt=>dt.set(vt.id,vt));const lt=Array.from(dt.values());return jr.endRenderMeasurement("viewport-culling"),lt}else{const ye=new Map;t.forEach(Fe=>{const ke=Fe.bank||"NA";ye.has(ke)||ye.set(ke,[]),ye.get(ke).push(Fe)});const ie=Math.max(10,Math.floor(800/ye.size)),Pe=[];return ye.forEach(Fe=>{const ke=Fe.filter(Je=>r.has(Je.id));Pe.push(...ke);const Qe=ie-ke.length;if(Qe>0){const Je=Fe.filter(lt=>!r.has(lt.id)),dt=Math.max(1,Math.floor(Je.length/Qe));for(let lt=0;lt<Je.length&&Pe.length-ke.length<Qe;lt+=dt)Pe.push(Je[lt])}}),jr.endRenderMeasurement("viewport-culling"),Pe}}},[t,A,r,k,Ee]),se=200,X=8,ce=(me,pe)=>{if(pe.ctrlKey||pe.metaKey)d(me),C(me);else if(pe.shiftKey&&x){const Ce=t.findIndex(Ae=>Ae.id===me),Te=t.findIndex(Ae=>Ae.id===x);if(Ce!==-1&&Te!==-1){const Ae=Math.min(Ce,Te),be=Math.max(Ce,Te),Ge=t.slice(Ae,be+1).map(ie=>ie.id),ye=new Set(r);Ge.forEach(ie=>ye.add(ie)),p(Array.from(ye))}}else n(me),C(me)};_e.useEffect(()=>{var Te,Ae;const me=()=>{var Ge;if((Ge=y.current)==null?void 0:Ge.container()){const ie={width:window.innerWidth,height:window.innerHeight-32};w(Pe=>Pe.width!==ie.width||Pe.height!==ie.height?(console.log(" Canvas size updated for dynamic maximization (excluding header):",ie),y.current&&(y.current.width(ie.width),y.current.height(ie.height),y.current.getLayer().batchDraw()),ie):Pe)}},pe=setTimeout(()=>{me()},200),Ce=(Ae=(Te=y.current)==null?void 0:Te.container())==null?void 0:Ae.parentElement;if(Ce){const be=new ResizeObserver(()=>{E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{me()},16)});be.observe(Ce);const Ge=()=>{me()};return window.addEventListener("resize",Ge),()=>{clearTimeout(pe),E.current&&clearTimeout(E.current),be.disconnect(),window.removeEventListener("resize",Ge)}}return()=>{clearTimeout(pe)}},[]),_e.useEffect(()=>{if(e&&t.length>0&&k.width>0&&k.height>0){const me=K();if(me){const{width:pe,height:Ce,centerX:Te,centerY:Ae}=me,be=0,Ge=k.width-be*2,ye=k.height-be*2,ie=Ge/pe,Pe=ye/Ce,Fe=Math.max(.8,Math.min(ie,Pe,2)),ke={x:k.width/2,y:k.height/2+30},Qe={x:ke.x-Te*Fe,y:ke.y-Ae*Fe,scale:Fe};console.log(" Auto-fit viewport:",Qe,"for package:",pe,"x",Ce,"scale:",Fe),P(Qe)}}},[e,t.length,k]);const Se=me=>{var pe;return me.pinType==="GROUND"||me.pinName==="GND"?go("GROUND"):me.pinType==="POWER"||(pe=me.pinName)!=null&&pe.includes("VCC")?go("POWER"):go(me.bank)},L=me=>({IO:"#FFF",CONFIG:"#FFD700",POWER:"#FF4500",GROUND:"#000",MGT:"#9B4AE2",CLOCK:"#FF69B4",ADC:"#00FFFF",SPECIAL:"#FF1493",MIO:"#32CD32",DDR:"#8A2BE2",NC:"#696969",RESERVED:"#999999"})[me.pinType]||"#FFF",q=(me,pe,Ce)=>{if(!Gt||typeof Gt.isDifferentialPin!="function"||!Gt.isDifferentialPin(me))return null;const Te=Gt.findPairPin(me,pe);if(!Te)return null;const Ae=Ce.has(me.id),be=Ce.has(Te.id);return Ae||be?(Gt.getDifferentialPairType(me.pinName)||(me.signalName?Gt.getDifferentialPairType(me.signalName):null))==="positive"?"#FF3333":"#FF9933":null},Y=(me,pe)=>!Gt||typeof Gt.isDifferentialPin!="function"||!Gt.isDifferentialPin(me)?!1:Gt.findPairPin(me,pe)!==null,K=()=>{if(!e||t.length===0)return{width:600,height:600,centerX:300,centerY:300,minX:0,minY:0,maxX:600,maxY:600};const me=t.map(lt=>{var vt;return(vt=lt.gridPosition)==null?void 0:vt.row}).filter(Boolean),pe=t.map(lt=>{var vt;return(vt=lt.gridPosition)==null?void 0:vt.col}).filter(Boolean);console.log(` Found rows: ${me.join(", ")}`);const Ce=Math.min(...me.map(lt=>Is(lt))),Te=Math.max(...me.map(lt=>Is(lt))),Ae=Math.min(...pe),be=Math.max(...pe);console.log(` Row indices - min: ${Ce} (${ol(Ce)}), max: ${Te} (${ol(Te)})`),console.log(` Col indices - min: ${Ae}, max: ${be}`);const ye=88,ie=(be-Ae+1)*ye,Pe=(Te-Ce+1)*ye,Fe=0,ke=ie+Fe*2,Qe=Pe+Fe*2,Je=(Ae+be-1)*ye/2,dt=(Ce+Te)*ye/2;return{width:ke,height:Qe,centerX:Je,centerY:dt,minX:(Ae-1)*ye,minY:Ce*ye,maxX:be*ye,maxY:(Te+1)*ye,gridSpacing:ye,minRow:Ce,maxRow:Te,minCol:Ae,maxCol:be}},ue=K();_e.useEffect(()=>{t.length>0&&console.log(" PackageCanvas: Package loaded with",t.length,"pins")},[t.length]);const z=me=>{let{x:pe,y:Ce}=me.position;if(s!==0){const ye=s*Math.PI/180,ie=Math.cos(ye),Pe=Math.sin(ye),Fe=pe*ie-Ce*Pe,ke=pe*Pe+Ce*ie;pe=Fe,Ce=ke}o||(pe=-pe);const Te=k.width,Ae=k.height,be=pe*A.scale+A.x+Te/2,Ge=Ce*A.scale+A.y+Ae/2;return{x:be,y:Ge}},ee=(me,pe)=>{const Ce=K(),Te=Ce.width*pe,Ae=Ce.height*pe,be=k.width,Ge=k.height,ye=be*.5,ie=Ge*.8,Pe=-(Te/2+ye),Fe=Te/2+ye,ke=-(Ae/2+ie*1.5),Qe=Ae/2+ie;return{x:Math.max(Pe,Math.min(Fe,me.x)),y:Math.max(ke,Math.min(Qe,me.y))}},de=me=>{me.evt.preventDefault();const pe=y.current;if(!pe)return;const Ce=pe.getPointerPosition(),Te=1.05;if(me.evt.ctrlKey){const Ae=A.scale,be=me.evt.deltaY>0?Ae/Te:Ae*Te,Ge=Math.max(.1,Math.min(5,be)),ye={x:(Ce.x-A.x)/Ae,y:(Ce.y-A.y)/Ae},ie={x:Ce.x-ye.x*Ge,y:Ce.y-ye.y*Ge},Pe=ee(ie,Ge);P({scale:Ge,x:Pe.x,y:Pe.y}),u==null||u(Ge)}else{const Ae=A.y-me.evt.deltaY*.5,be=ee({x:A.x,y:Ae},A.scale);P(Ge=>({...Ge,x:be.x,y:be.y}))}},xe=()=>{const me=y.current;if(!me)return;const pe=me.getPointerPosition(),Ce=Date.now();O(Ce),he(pe),D(pe),F(!1)},Me=()=>{const me=y.current;if(!me)return;const pe=me.getPointerPosition(),Ce=Date.now();if(!N&&U>0){const Te=Ce-U,Ae=Math.sqrt(Math.pow(pe.x-Q.x,2)+Math.pow(pe.y-Q.y,2));(Te>se||Ae>X)&&F(!0)}if(N){const Te=pe.x-I.x,Ae=pe.y-I.y,be={x:A.x+Te,y:A.y+Ae},Ge=ee(be,A.scale);P(ye=>({...ye,x:Ge.x,y:Ge.y}))}D(pe)},G=()=>{F(!1),O(0)},Ze=()=>{F(!1),O(0)},nt=()=>{P({x:0,y:0,scale:1}),u==null||u(1)};_e.useEffect(()=>{Math.abs(a-1)<.001?P({x:0,y:0,scale:1}):P(me=>({...me,scale:a}))},[a,f]),_e.useEffect(()=>{const me=pe=>{(pe.key==="r"||pe.key==="R")&&nt()};return window.addEventListener("keydown",me),()=>window.removeEventListener("keydown",me)},[]);const Ke=(me,pe)=>{const Ce=Date.now();if(U>0){const Te=Ce-U,Ae=y.current;if(Ae&&Te<se){const be=Ae.getPointerPosition();Math.sqrt(Math.pow(be.x-Q.x,2)+Math.pow(be.y-Q.y,2))<X&&!N&&(me.cancelBubble=!0,ce(pe.id,me.evt))}}},qe=(me,pe)=>{me.cancelBubble=!0,i(pe.id)},De=me=>{const pe=Date.now();if(!N&&U>0){const Ce=pe-U,Te=y.current;if(Te&&Ce<se){const Ae=Te.getPointerPosition();Math.sqrt(Math.pow(Ae.x-Q.x,2)+Math.pow(Ae.y-Q.y,2))<X&&me.target===me.target.getStage()&&n("")}}};if(!e)return T.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"No package loaded. Please import a CSV file."});if(k.width<=0||k.height<=0)return T.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"18px"},children:"Loading canvas..."});const kt=`View: ${o?"TOP":"BOTTOM"} | Rotation: ${s} | Zoom: ${Math.round(a*100)}%`,Or=e?`${e.device}pkg.csv (${e.packageType})`:"No package loaded";return T.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#1a1a1a",position:"relative",display:"flex",flexDirection:"column"},children:[T.jsx(ZB,{fileName:Or,viewInfo:kt}),T.jsxs("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:[T.jsx("div",{style:{position:"absolute",top:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Ce,minRow:Te,maxRow:Ae}=ue;if(!me)return null;const be=[];if(s===0||s===180)for(let ye=pe;ye<=Ce;ye++){const ie=t.find(ke=>ke.gridPosition&&ke.gridPosition.col===ye);if(!ie)continue;const Fe={left:z(ie).x-10,top:-5};Fe.left>=-50&&Fe.left<=k.width+50&&be.push(T.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ye},`top-col-${ye}`))}else for(let ye=Te;ye<=Ae;ye++){const ie=ol(ye),Pe=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===ie);if(!Pe)continue;const ke={left:z(Pe).x-10,top:-5};ke.left>=-50&&ke.left<=k.width+50&&be.push(T.jsx("div",{style:{position:"absolute",...ke,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ie},`top-row-${ye}`))}return be})()}),T.jsx("div",{style:{position:"absolute",top:16,right:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Ce,minRow:Te,maxRow:Ae}=ue;if(!me)return null;const be=[];if(s===0||s===180)for(let ye=Te;ye<=Ae;ye++){const ie=ol(ye),Pe=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===ie);if(!Pe)continue;const ke={left:-5,top:z(Pe).y-8};ke.top>=-50&&ke.top<=k.height+50&&be.push(T.jsx("div",{style:{position:"absolute",...ke,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ie},`right-row-${ye}`))}else for(let ye=pe;ye<=Ce;ye++){const ie=t.find(ke=>ke.gridPosition&&ke.gridPosition.col===ye);if(!ie)continue;const Fe={left:-5,top:z(ie).y-8};Fe.top>=-50&&Fe.top<=k.height+50&&be.push(T.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ye},`right-col-${ye}`))}return be})()}),T.jsx("div",{style:{position:"absolute",bottom:0,left:16,right:16,height:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"row",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Ce,minRow:Te,maxRow:Ae}=ue;if(!me)return null;const be=[];if(s===0||s===180)for(let ye=pe;ye<=Ce;ye++){const ie=t.find(ke=>ke.gridPosition&&ke.gridPosition.col===ye);if(!ie)continue;const Fe={left:z(ie).x-10,top:-5};Fe.left>=-50&&Fe.left<=k.width+50&&be.push(T.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ye},`bottom-col-${ye}`))}else for(let ye=Te;ye<=Ae;ye++){const ie=ol(ye),Pe=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===ie);if(!Pe)continue;const ke={left:z(Pe).x-10,top:-5};ke.left>=-50&&ke.left<=k.width+50&&be.push(T.jsx("div",{style:{position:"absolute",...ke,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ie},`bottom-row-${ye}`))}return be})()}),T.jsx("div",{style:{position:"absolute",top:16,left:0,bottom:16,width:16,backgroundColor:"#2a2a2a",border:"1px solid #444",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:10,overflow:"hidden"},children:A.scale>.1&&(()=>{const{gridSpacing:me,minCol:pe,maxCol:Ce,minRow:Te,maxRow:Ae}=ue;if(!me)return null;const be=[];if(s===0||s===180)for(let ye=Te;ye<=Ae;ye++){const ie=ol(ye),Pe=t.find(Qe=>Qe.gridPosition&&Qe.gridPosition.row===ie);if(!Pe)continue;const ke={left:-5,top:z(Pe).y-8};ke.top>=-50&&ke.top<=k.height+50&&be.push(T.jsx("div",{style:{position:"absolute",...ke,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ie},`left-row-${ye}`))}else for(let ye=pe;ye<=Ce;ye++){const ie=t.find(ke=>ke.gridPosition&&ke.gridPosition.col===ye);if(!ie)continue;const Fe={left:-5,top:z(ie).y-8};Fe.top>=-50&&Fe.top<=k.height+50&&be.push(T.jsx("div",{style:{position:"absolute",...Fe,width:20,height:16,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",color:"#e0e0e0",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",pointerEvents:"none",overflow:"hidden"},children:ye},`left-col-${ye}`))}return be})()}),T.jsx("div",{style:{position:"absolute",top:16,left:16,right:16,bottom:16,overflow:"hidden"},children:T.jsx(HB,{ref:me=>{y.current=me},width:window.innerWidth,height:window.innerHeight,x:0,y:0,onClick:De,onWheel:de,onMouseDown:xe,onMouseMove:Me,onMouseUp:G,onMouseLeave:Ze,style:{cursor:N?"grabbing":"grab"},children:T.jsxs(GB,{children:[(()=>{const{gridSpacing:me,minRow:pe,maxRow:Ce,minCol:Te,maxCol:Ae}=ue;if(!me)return null;const be=(ke,Qe)=>z({position:{x:ke,y:Qe}}),Ge=0,ye=be((Te-1.5)*me-Ge,(pe-.5)*me-Ge),ie=be((Ae+.5)*me+Ge,(pe-.5)*me-Ge),Pe=be((Te-1.5)*me-Ge,(Ce+.5)*me+Ge),Fe=be((Ae+.5)*me+Ge,(Ce+.5)*me+Ge);return T.jsx(T.Fragment,{children:T.jsx(S5,{points:[ye.x,ye.y,ie.x,ie.y,Fe.x,Fe.y,Pe.x,Pe.y,ye.x,ye.y],stroke:"#555",strokeWidth:2,dash:[5,5],closed:!0,fill:"rgba(40, 40, 40, 0.3)"})})})(),!1,(()=>{jr.startRenderMeasurement("pin-rendering");const pe=Math.max(20,88*A.scale),Ce=A.scale>=.7,Te=Un.shouldRenderText(A.scale,"pin"),Ae=Un.shouldRenderText(A.scale,"signal"),be=Un.getAdaptiveTextSize(A.scale,12)/12,Ge=we,ye=jr.endRenderMeasurement("pin-rendering");return console.log(` Smart culling: Rendering ${Ge.length}/${t.length} pins (${ye.toFixed(2)}ms)`),Ge.map(ie=>{const Pe=z(ie),Fe=r&&r.has?r.has(ie.id):!1,ke=Se(ie),Qe=L(ie),Je=A.scale*10*be,dt=Math.max(8,Math.min(20,Je)),lt=Math.max(6,Math.min(16,A.scale*8*be)),vt=q(ie,we,r),Ne=Y(ie,t),Ye=Ce||Fe;return T.jsxs(Xc,{children:[T.jsx(Xn,{x:Pe.x-pe/2,y:Pe.y-pe/2,width:pe,height:pe,fill:ke,stroke:"#000",strokeWidth:1,cornerRadius:4,onClick:Ue=>Ke(Ue,ie),onDblClick:Ue=>qe(Ue,ie),style:{cursor:"pointer"}}),vt&&T.jsx(Xn,{x:Pe.x-pe/2-2,y:Pe.y-pe/2-2,width:pe+4,height:pe+4,fill:"transparent",stroke:vt,strokeWidth:2,cornerRadius:6,listening:!1}),T.jsx(Kc,{x:Pe.x,y:Pe.y,radius:Math.max(8,pe*.3),fill:Qe,stroke:"#000",strokeWidth:1,listening:!1}),Ne&&!vt&&pe>40&&T.jsx(Kc,{x:Pe.x+pe*.3,y:Pe.y-pe*.3,radius:3,fill:"#FF6600",stroke:"#FFF",strokeWidth:1,listening:!1}),vt&&T.jsx(Kc,{x:Pe.x,y:Pe.y,radius:Math.max(10,pe*.4),fill:"transparent",stroke:vt,strokeWidth:3,listening:!1,dash:[5,5]}),T.jsx(Xn,{x:Pe.x-ie.pinNumber.length*dt/4-2,y:Pe.y-dt/2-2,width:ie.pinNumber.length*dt/2+4,height:dt+4,fill:"rgba(0, 0, 0, 0.7)",cornerRadius:2,listening:!1}),T.jsx(la,{x:Pe.x,y:Pe.y-dt/2,text:ie.pinNumber,fontSize:dt,fill:"#FFF",align:"center",onClick:Ue=>Ke(Ue,ie),onDblClick:Ue=>qe(Ue,ie),style:{cursor:"pointer"},fontStyle:"bold",offsetX:ie.pinNumber.length*dt/4,listening:!1}),ie.pinName&&Ye&&Te&&pe>50&&T.jsxs(T.Fragment,{children:[T.jsx(Xn,{x:Pe.x-(ie.pinName.length>14?17:ie.pinName.length)*lt/4-2,y:Pe.y+dt/2+1,width:(ie.pinName.length>14?17:ie.pinName.length)*lt/2+4,height:lt+4,fill:"rgba(0, 0, 0, 0.6)",cornerRadius:2,listening:!1}),T.jsx(la,{x:Pe.x,y:Pe.y+dt/2+3,text:ie.pinName.length>14?ie.pinName.substring(0,14)+"...":ie.pinName,fontSize:lt,fill:"#E0E0E0",align:"center",onClick:Ue=>Ke(Ue,ie),onDblClick:Ue=>qe(Ue,ie),style:{cursor:"pointer"},offsetX:(ie.pinName.length>14?17:ie.pinName.length)*lt/4,listening:!1})]}),ie.signalName&&ie.signalName.trim()!==""&&Ae&&T.jsxs(T.Fragment,{children:[T.jsx(Xn,{x:Pe.x-(ie.signalName.length>12?15:ie.signalName.length)*lt*.35-6,y:Pe.y+dt/2+3+lt-1,width:(ie.signalName.length>12?15:ie.signalName.length)*lt*.7+12,height:lt+6,fill:"rgba(255, 215, 0, 0.9)",cornerRadius:3,listening:!1}),T.jsx(la,{x:Pe.x,y:Pe.y+dt/2+3+lt+2,text:ie.signalName.length>12?ie.signalName.substring(0,12)+"...":ie.signalName,fontSize:lt,fill:"#000",align:"center",onClick:Ue=>Ke(Ue,ie),onDblClick:Ue=>qe(Ue,ie),style:{cursor:"pointer"},fontStyle:"bold",offsetX:(ie.signalName.length>12?15:ie.signalName.length)*lt/4,listening:!1})]})]},ie.id)})})(),Un.shouldRenderDifferentialPairs(A.scale)&&(()=>{jr.startRenderMeasurement("diff-pair-lines");const me=[],pe=new Set;we.forEach(Te=>{if(!pe.has(Te.id)&&Gt&&typeof Gt.isDifferentialPin=="function"&&Gt.isDifferentialPin(Te)){const Ae=Gt.findPairPin&&Gt.findPairPin(Te,t),be=Ae&&we.includes(Ae),Ge=r.has(Te.id)||Ae&&r.has(Ae.id);if(Ae&&!pe.has(Ae.id)&&(be||Ge)){pe.add(Te.id),pe.add(Ae.id);const ye=z(Te),ie=z(Ae),Pe=q(Te,we,r),Fe=q(Ae,we,r),ke=Pe||Fe||"#FF6600",Qe=Math.sqrt(Math.pow(ie.x-ye.x,2)+Math.pow(ie.y-ye.y,2));if(Qe>50&&me.push(T.jsx(S5,{points:[ye.x,ye.y,ie.x,ie.y],stroke:ke,strokeWidth:2,opacity:.6,dash:[8,4],listening:!1},`diff-pair-${Te.id}-${Ae.id}`)),Qe>100&&A.scale>.4){const Je=(ye.x+ie.x)/2,dt=(ye.y+ie.y)/2,vt=Gt.getDifferentialPairType(Te.pinName)==="positive"?"+/-":"-/+";me.push(T.jsxs(Xc,{children:[T.jsx(Xn,{x:Je-10,y:dt-8,width:20,height:16,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),T.jsx(la,{x:Je,y:dt-6,text:vt,fontSize:10,fill:ke,align:"center",offsetX:10,listening:!1})]},`diff-label-${Te.id}-${Ae.id}`))}}}});const Ce=jr.endRenderMeasurement("diff-pair-lines");return console.log(` Differential pairs: ${me.length} lines (${Ce.toFixed(2)}ms)`),me})(),Un.shouldRenderAtLOD(te,2)&&(()=>{jr.startRenderMeasurement("bank-boundaries");const me=new Map;we.forEach(ye=>{const ie=ye.bank||"NA";me.has(ie)||me.set(ie,[]),me.get(ie).push(ye)});const Ce=Math.max(20,88*A.scale),Te=6,Ae=new Map;Array.from(me.entries()).forEach(([ye,ie])=>{if(ye==="NA"||ie.length<2)return;const Pe=ie.map(ke=>z(ke)),Fe={minX:Math.min(...Pe.map(ke=>ke.x))-Ce/2-Te,maxX:Math.max(...Pe.map(ke=>ke.x))+Ce/2+Te,minY:Math.min(...Pe.map(ke=>ke.y))-Ce/2-Te,maxY:Math.max(...Pe.map(ke=>ke.y))+Ce/2+Te,bankKey:ye,pins:ie};Ae.set(ye,Fe)});const be=Array.from(Ae.entries()).map(([ye,ie])=>{const Pe=Se(ie.pins[0]);return T.jsx(Xn,{x:ie.minX,y:ie.minY,width:ie.maxX-ie.minX,height:ie.maxY-ie.minY,fill:`${Pe}10`,stroke:"transparent",cornerRadius:6,opacity:.3,listening:!1},`bank-boundary-${ye}`)}),Ge=jr.endRenderMeasurement("bank-boundaries");return console.log(` Bank boundaries: ${Ae.size} boundaries (${Ge.toFixed(2)}ms)`),be})(),(()=>{const pe=Math.max(20,88*A.scale);return t.filter(Ce=>r&&r.has?r.has(Ce.id):!1).map(Ce=>{const Te=z(Ce);return T.jsx(Xn,{x:Te.x-pe/2-2,y:Te.y-pe/2-2,width:pe+4,height:pe+4,fill:"transparent",stroke:"#FFD700",strokeWidth:3,cornerRadius:4,onClick:Ae=>Ke(Ae,Ce),onDblClick:Ae=>qe(Ae,Ce),style:{cursor:"pointer"}},`highlight-${Ce.id}`)})})(),T.jsxs(Xc,{x:10,y:30,children:[(()=>{const me="Bank Groups";return T.jsxs(T.Fragment,{children:[T.jsx(Xn,{x:24,y:-2,width:me.length*6+8,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2,onClick:()=>{console.log(" Bank Groups header clicked - showing all banks!"),m()},onMouseEnter:pe=>{var Te;const Ce=pe.target;Ce.fill("rgba(0, 0, 0, 0.9)"),(Te=Ce.getLayer())==null||Te.batchDraw()},onMouseLeave:pe=>{var Te;const Ce=pe.target;Ce.fill("rgba(0, 0, 0, 0.85)"),(Te=Ce.getLayer())==null||Te.batchDraw()},style:{cursor:"pointer"}}),T.jsx(la,{x:27,y:0,text:me,fontSize:12,fill:"#4AE24A",onClick:()=>{console.log(" Bank Groups text clicked - showing all banks!"),m()},onMouseEnter:pe=>{var Te;const Ce=pe.target;Ce.fill("#fff"),(Te=Ce.getLayer())==null||Te.batchDraw()},onMouseLeave:pe=>{var Te;const Ce=pe.target;Ce.fill("#4AE24A"),(Te=Ce.getLayer())==null||Te.batchDraw()},style:{cursor:"pointer"}})]})})(),(()=>[...new Set(we.map(pe=>pe.bank).filter(Boolean))].sort((pe,Ce)=>{const Te=parseInt(pe),Ae=parseInt(Ce);return Te-Ae}).map((pe,Ce)=>{const Te=g&&g.size!==void 0?g.size===0||g.has(pe):!0;return T.jsxs(Xc,{y:20+Ce*18,x:27,children:[T.jsx(Xn,{x:8,y:-8,width:`Bank ${pe}`.length*6+20,height:16,fill:"rgba(0, 0, 0, 0)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:1,cornerRadius:2,onClick:()=>{console.log(` BANK ${pe} CLICKED!`),console.log("Before: visibleBanks =",Array.from(g)),console.log(`Before: Bank ${pe} is visible =`,g.has(pe)),console.log("Before: Total pins received =",t.length),v(pe)},onMouseEnter:Ae=>{var Ge;const be=Ae.target;be.stroke("rgba(255, 255, 255, 0.3)"),(Ge=be.getLayer())==null||Ge.batchDraw()},onMouseLeave:Ae=>{var Ge;const be=Ae.target;be.stroke("rgba(255, 255, 255, 0.1)"),(Ge=be.getLayer())==null||Ge.batchDraw()},style:{cursor:"pointer"}}),T.jsx(Kc,{x:12,y:2,radius:4,fill:Te?go(pe):"#444",stroke:Te?"#000":"#666",strokeWidth:1,listening:!1}),T.jsx(Xn,{x:23,y:-8,width:`Bank ${pe}`.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2,listening:!1}),T.jsx(la,{x:25,y:-6,text:`Bank ${pe}`,fontSize:10,fill:Te?"#ccc":"#666",listening:!1}),T.jsx(la,{x:10,y:-6,text:Te?"":"",fontSize:8,listening:!1})]},pe)}))(),T.jsx(Xn,{x:117,y:-2,width:130,height:16,fill:"rgba(0, 0, 0, 0.85)",cornerRadius:2}),T.jsx(la,{x:120,y:0,text:"Pin Types (Circle):",fontSize:12,fill:"#ccc"}),(()=>{const me=[...new Set(t.map(Ce=>Ce.pinType).filter(Boolean))].sort(),pe={IO:"#4A90E2",CONFIG:"#E24A4A",POWER:"#4AE24A",GROUND:"#333333",MGT:"#9B4AE2",CLOCK:"#E2A64A",ADC:"#4AE2E2",SPECIAL:"#E24AA6",NC:"#666666",RESERVED:"#999999",MIO:"#32CD32",DDR:"#8A2BE2"};return me.map((Ce,Te)=>T.jsxs(Xc,{y:20+Te*18,x:120,children:[T.jsx(Kc,{x:12,y:2,radius:4,fill:pe[Ce]||"#666666",stroke:"#000",strokeWidth:1}),T.jsx(la,{x:25,y:-6,text:Ce,fontSize:10,fill:"#999"}),T.jsx(Xn,{x:23,y:-8,width:Ce.length*6+4,height:14,fill:"rgba(0, 0, 0, 0.8)",cornerRadius:2}),T.jsx(la,{x:25,y:-6,text:Ce,fontSize:10,fill:"#ccc"})]},Ce))})()]})]})})})]})]})};class Kn{static createSaveData(t){var n,i,a,s,o,u;const r=new Date().toISOString();return{metadata:{version:this.SAVE_VERSION,created:r,modified:r,appVersion:"1.0.0",description:`FPGA Pin Planning Project - ${((n=t.package)==null?void 0:n.device)||"Unknown Device"}`,author:"FPGA Pin Planner User"},package:{device:((i=t.package)==null?void 0:i.device)||"",packageType:((a=t.package)==null?void 0:a.packageType)||""},pins:t.pins.map(f=>({id:f.id,pinNumber:f.pinNumber,pinName:f.pinName,assignedSignalName:f.signalName,comment:f.comment,bank:f.bank,pinType:f.pinType,gridPosition:f.gridPosition,differentialPair:f.differentialPair})),viewSettings:{zoom:t.viewConfig.zoom,rotation:t.viewConfig.rotation,isTopView:t.viewConfig.isTopView,viewport:t.viewConfig.viewport||{x:0,y:0,scale:1},selectedPins:Array.from(t.selectedPins),filters:t.filters},projectSettings:{listViewActiveTab:((s=t.listView)==null?void 0:s.activeTab)||"overview",sidebarWidth:((o=t.ui)==null?void 0:o.sidebarWidth)||300,showDifferentialPairs:((u=t.ui)==null?void 0:u.showDifferentialPairs)||!1,customSettings:t.projectSettings||{}},history:t.history||{currentIndex:0,actions:[]}}}static async saveToFile(t,r){const n=t.package.device.replace(/[^a-zA-Z0-9]/g,"_"),i=new Date().toISOString().split("T")[0],a=`${n}_project_${i}${this.FILE_EXTENSION}`,s=r||a,o=JSON.stringify(t,null,2),u=new Blob([o],{type:"application/json"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download=s,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}static async loadFromFile(t){return new Promise((r,n)=>{const i=new FileReader;i.onload=a=>{var s;try{const o=(s=a.target)==null?void 0:s.result,u=JSON.parse(o);if(!this.isCompatibleVersion(u.metadata.version))throw new Error(`Incompatible save file version: ${u.metadata.version}`);if(!u.package||!u.pins||!Array.isArray(u.pins))throw new Error("Invalid save file format: missing required fields");r(u)}catch(o){n(new Error(`Failed to parse save file: ${o}`))}},i.onerror=()=>n(new Error("Failed to read file")),i.readAsText(t)})}static restoreProject(t){const r={id:`package-${Date.now()}`,name:t.package.device,device:t.package.device,packageType:t.package.packageType,dimensions:{rows:Math.max(...t.pins.map(i=>{var a;return Is(((a=i.gridPosition)==null?void 0:a.row)||"A")+1})),cols:Math.max(...t.pins.map(i=>{var a;return((a=i.gridPosition)==null?void 0:a.col)||1}))},totalPins:t.pins.length,pins:t.pins.map(i=>({id:i.id,pinNumber:i.pinNumber,pinName:i.pinName,signalName:i.assignedSignalName||i.originalSignalName||"",direction:"InOut",pinType:i.pinType,voltage:"3.3V",packagePin:i.pinNumber,position:this.gridToPosition(i.gridPosition||{row:"A",col:1}),gridPosition:i.gridPosition||{row:"A",col:1},isAssigned:!!i.assignedSignalName,bank:i.bank||"NA",comment:i.comment||"",differentialPair:i.differentialPair}))};return{id:`project-${Date.now()}`,name:t.metadata.description||`Restored Project ${new Date().toLocaleDateString()}`,description:t.metadata.description||"",created:new Date(t.metadata.created),modified:new Date(t.metadata.modified),projectInfo:{device:t.package.device,package:t.package.packageType,speedGrade:t.package.speedGrade||"-1",temperature:"C"},packageData:r,pinAssignments:r.pins,viewConfig:{rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,zoom:t.viewSettings.zoom,showPinNumbers:!0,showSignalNames:!0,showPinTypes:!1},filters:{pinTypes:[],banks:[],searchText:"",voltageFilter:[],assignmentStatus:"all",showOnlyDifferentialPairs:!1,sortField:"pinNumber",sortOrder:"asc"}}}static restoreAppState(t,r){return{pins:r.pins.map(i=>{const a=t.pins.find(s=>s.id===i.id||s.pinNumber===i.pinNumber);return a?{...i,signalName:a.assignedSignalName||i.signalName,comment:a.comment||i.comment,differentialPair:a.differentialPair||i.differentialPair}:i}),selectedPins:new Set(t.viewSettings.selectedPins),viewConfig:{zoom:t.viewSettings.zoom,rotation:t.viewSettings.rotation,isTopView:t.viewSettings.isTopView,viewport:t.viewSettings.viewport},filters:t.viewSettings.filters,listView:{activeTab:t.projectSettings.listViewActiveTab||"overview"},ui:{sidebarWidth:t.projectSettings.sidebarWidth,showDifferentialPairs:t.projectSettings.showDifferentialPairs},history:t.history,projectSettings:t.projectSettings.customSettings}}static isCompatibleVersion(t){const[r]=t.split(".").map(Number),[n]=this.SAVE_VERSION.split(".").map(Number);return r<=n}static quickSave(t){try{const r=this.createSaveData(t),n=this.compressData(r);localStorage.setItem(this.QUICKSAVE_KEY,n),localStorage.setItem(this.QUICKSAVE_TIMESTAMP_KEY,new Date().toISOString()),console.log(" Quick save completed")}catch(r){throw console.error("Failed to quick save:",r),new Error(`Quick save failed: ${r}`)}}static quickLoad(){try{const t=localStorage.getItem(this.QUICKSAVE_KEY);return t?this.decompressData(t):null}catch(t){return console.error("Failed to load quicksave:",t),null}}static getQuickSaveInfo(){const t=localStorage.getItem(this.QUICKSAVE_TIMESTAMP_KEY);return{exists:localStorage.getItem(this.QUICKSAVE_KEY)!==null,timestamp:t||void 0}}static clearQuickSave(){localStorage.removeItem(this.QUICKSAVE_KEY),localStorage.removeItem(this.QUICKSAVE_TIMESTAMP_KEY)}static compressData(t){const r={metadata:{version:t.metadata.version,created:t.metadata.created},package:t.package,pins:t.pins.map(n=>({id:n.id,pinNumber:n.pinNumber,assignedSignalName:n.assignedSignalName,comment:n.comment,...n.differentialPair&&{differentialPair:n.differentialPair},...n.custom&&Object.keys(n.custom).length>0&&{custom:n.custom}})),viewSettings:t.viewSettings,projectSettings:t.projectSettings};return JSON.stringify(r)}static decompressData(t){const r=JSON.parse(t);return{metadata:{version:r.metadata.version,created:r.metadata.created,modified:new Date().toISOString(),appVersion:"1.0.0",description:"Quick Save Data"},package:r.package,pins:r.pins,viewSettings:r.viewSettings,projectSettings:r.projectSettings||{},constraints:{},history:{currentIndex:0,actions:[]}}}static gridToPosition(t){const r=Is(t.row),i=88,a=(t.col-1)*i,s=r*i;return{x:Math.round(a),y:Math.round(s)}}}Kn.SAVE_VERSION="1.0.0";Kn.FILE_EXTENSION=".fpgaproj";Kn.QUICKSAVE_KEY="fpga-planner-quicksave";Kn.QUICKSAVE_TIMESTAMP_KEY="fpga-planner-quicksave-timestamp";const tU=()=>{const e=_e.useRef(null),[t,r]=_e.useState(!1),[n,i]=_e.useState(""),{package:a,pins:s,selectedPins:o,viewConfig:u,loadProject:f}=Xi(),d=()=>({package:a,pins:s,selectedPins:o,viewConfig:u,listView:{activeTab:"overview"},ui:{sidebarWidth:300,showDifferentialPairs:!1},filters:{},history:{currentIndex:0,actions:[]},projectSettings:{}}),p=(w,x=3e3)=>{i(w),setTimeout(()=>i(""),x)},g=()=>typeof window.vscode<"u",v=async()=>{try{if(r(!0),!a||s.length===0)throw new Error("No project data to save");const w=d(),x=Kn.createSaveData(w);if(g())try{const C=window.vscode,A=x.package.device.replace(/[^a-zA-Z0-9]/g,"_"),P=new Date().toISOString().split("T")[0],N=`${A}_project_${P}.fpgaproj`,F=await new Promise((I,D)=>{const U=setTimeout(()=>{window.removeEventListener("message",O),D(new Error("Save dialog timeout"))},3e4),O=he=>{he.data.command==="saveDialogResult"&&(clearTimeout(U),window.removeEventListener("message",O),I(he.data.result))};window.addEventListener("message",O);const Q={command:"showSaveDialog",options:{saveLabel:"Save FPGA Project",filters:{"FPGA Project Files":["fpgaproj"],"JSON Files":["json"],"All Files":["*"]}}};try{C.postMessage(Q)}catch(he){console.error("Failed to send message to VS Code:",he),D(he)}});if(F){let I;if(typeof F=="string")I=F;else if(F&&typeof F=="object"){const O=F;I=O.fsPath||O.path,!I&&typeof F.toString=="function"&&(I=F.toString())}if(!I)throw new Error("Failed to extract file path from URI");const D=JSON.stringify(x,null,2);if(await new Promise(O=>{const Q=he=>{he.data.command==="saveFileResult"&&(window.removeEventListener("message",Q),O(he.data.success))};window.addEventListener("message",Q),C.postMessage({command:"saveFile",filePath:I,content:D,filename:N})}))p(" Project saved successfully!");else throw new Error("File save operation failed")}else return}catch(C){console.error("VS Code save failed:",C),await Kn.saveToFile(x),p(" Project saved successfully!")}else await Kn.saveToFile(x),p(" Project saved successfully!")}catch(w){console.error("Save failed:",w),p(` Save failed: ${w}`,5e3)}finally{r(!1)}},m=async w=>{var C;const x=(C=w.target.files)==null?void 0:C[0];if(x)try{r(!0);const A=await Kn.loadFromFile(x),P=Kn.restoreProject(A);f(P),p(` Project loaded: ${A.metadata.description}`),w.target.value=""}catch(A){console.error("Load failed:",A),p(` Load failed: ${A}`,5e3)}finally{r(!1)}},y=()=>{try{if(!a||s.length===0)throw new Error("No project data to save");const w=d();Kn.quickSave(w),p(" Quick save completed")}catch(w){console.error("Quick save failed:",w),p(` Quick save failed: ${w}`,5e3)}},E=async()=>{try{const w=Kn.quickLoad();if(!w){p(" No quick save found");return}const x=Kn.restoreProject(w);f(x),p(" Quick save loaded")}catch(w){console.error("Quick load failed:",w),p(` Quick load failed: ${w}`,5e3)}},k=Kn.getQuickSaveInfo();return Sr.useEffect(()=>{const w=x=>{var C;if(x.ctrlKey||x.metaKey)switch(x.key.toLowerCase()){case"s":x.preventDefault(),a&&s.length>0&&y();break;case"l":x.preventDefault(),k.exists?E():(C=e.current)==null||C.click();break}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[a,s.length,k.exists]),T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",position:"relative"},children:[T.jsx("button",{onClick:v,disabled:t||!a||s.length===0,title:"Save Project ()",style:{padding:"6px 8px",backgroundColor:"#00a8ff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t||!a||s.length===0?.5:1},children:""}),T.jsx("button",{onClick:()=>{var w;return(w=e.current)==null?void 0:w.click()},disabled:t,title:"Load Project ()",style:{padding:"6px 8px",backgroundColor:"#ffa500",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"11px",fontWeight:"bold",opacity:t?.5:1},children:""}),T.jsx("input",{ref:e,type:"file",accept:".fpgaproj,.json",onChange:m,style:{display:"none"}}),T.jsx("button",{onClick:y,disabled:t||!a||s.length===0,title:"Quick Save (Ctrl+S)",style:{padding:"6px 8px",backgroundColor:"#333",color:"#ccc",border:"1px solid #555",borderRadius:"4px",cursor:"pointer",fontSize:"11px",opacity:t||!a||s.length===0?.5:1},children:""}),n&&T.jsx("div",{style:{position:"absolute",top:"40px",right:"0",padding:"8px 12px",backgroundColor:n.includes("")?"#dc3545":"#28a745",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:n})]})},rU=({className:e=""})=>{const{canUndo:t,canRedo:r,currentActionDescription:n,nextRedoActionDescription:i,undo:a,redo:s}=Xi(),o=u=>({padding:"6px",backgroundColor:u?"#333":"#222",border:"1px solid #555",borderRadius:"4px",color:u?"#ccc":"#666",cursor:u?"pointer":"not-allowed",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",transition:"background-color 0.2s"});return T.jsxs("div",{className:`flex flex-row items-center ${e}`,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[T.jsx("button",{onClick:a,disabled:!t,title:`Undo${n?`: ${n}`:""} (Ctrl+Z)`,style:{...o(t),borderRadius:"4px 0 0 4px",borderRight:"none"},onMouseEnter:u=>{t&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{t&&(u.currentTarget.style.backgroundColor="#333")},children:T.jsx(nU,{className:"w-3 h-3"})}),T.jsx("button",{onClick:s,disabled:!r,title:`Redo${i?`: ${i}`:""} (Ctrl+Y)`,style:{...o(r),borderRadius:"0 4px 4px 0"},onMouseEnter:u=>{r&&(u.currentTarget.style.backgroundColor="#444")},onMouseLeave:u=>{r&&(u.currentTarget.style.backgroundColor="#333")},children:T.jsx(iU,{className:"w-3 h-3"})})]})},nU=({className:e})=>T.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[T.jsx("path",{d:"M3 7v6h6"}),T.jsx("path",{d:"m21 17a9 9 0 00-9-9 9 9 0 00-6 2.3l-3 3"})]}),iU=({className:e})=>T.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:[T.jsx("path",{d:"M21 7v6h-6"}),T.jsx("path",{d:"m3 17a9 9 0 019-9 9 9 0 016 2.3l3 3"})]}),aU=({isOpen:e,onClose:t})=>{if(!e)return null;const r=[{key:"Ctrl+Z",description:"Undo"},{key:"Ctrl+Y",description:"Redo"},{key:"Ctrl+O",description:"Open CSV file"},{key:"Ctrl+S",description:"Save project"},{key:"Ctrl+E",description:"Export XDC file"},{key:"Ctrl+F",description:"Focus search field"},{key:"Click",description:"Select pin"},{key:"Ctrl+Click",description:"Toggle pin selection"},{key:"Shift+Click",description:"Range select pins"},{key:"Ctrl+A",description:"Select all pins"},{key:"Ctrl+D",description:"Deselect all"},{key:"Space",description:"Rotate view 90 degrees"},{key:"F",description:"Toggle top/bottom view"},{key:"R",description:"Reset zoom and pan"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"Escape",description:"Deselect all"},{key:"Delete",description:"Unassign selected pins"}];return T.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:T.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-hidden flex flex-col",children:[T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Keyboard Shortcuts"}),T.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-xl",children:""})]}),T.jsx("div",{className:"flex-1 overflow-y-auto",children:T.jsx("div",{className:"space-y-1",children:r.map((n,i)=>T.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-50",children:[T.jsx("span",{className:"text-sm text-gray-600",children:n.description}),T.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-gray-100 rounded border",children:n.key})]},i))})}),T.jsx("div",{className:"mt-4 pt-4 border-t",children:T.jsx("button",{onClick:t,className:"w-full py-2 px-4 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Close"})})]})})},sU=({validationResult:e,onIssueClick:t,onPinHighlight:r,className:n=""})=>{const[i,a]=_e.useState(!0),[s,o]=_e.useState("all"),[u,f]=_e.useState("all"),d=m=>{switch(m){case"pin_conflict":return"Pin Conflict";case"differential_pair":return"Differential Pair";case"bank_constraint":return"Bank Constraint";case"clock_constraint":return"Clock Constraint";default:return m}},p=(e==null?void 0:e.issues.filter(m=>{const y=s==="all"||m.severity===s,E=u==="all"||m.type===u;return y&&E}))||[],g=m=>{t==null||t(m),r==null||r(m.affectedPins)},v=m=>{switch(m){case"error":return"";case"warning":return"";case"info":return""}};return e?T.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[T.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),T.jsx("button",{onClick:()=>a(!i),className:"text-gray-500 hover:text-gray-700",children:i?"":""})]})}),T.jsx("div",{className:"flex-1 overflow-y-auto right-sidebar-scroll",children:i&&T.jsxs("div",{className:"p-4",children:[T.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.summary.errorCount}),T.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]}),T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.summary.warningCount}),T.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.summary.infoCount}),T.jsx("div",{className:"text-xs text-gray-500",children:"Info"})]})]}),T.jsxs("div",{className:"space-y-2",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Severity"}),T.jsxs("select",{value:s,onChange:m=>o(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsxs("option",{value:"all",children:["All Issues (",e.issues.length,")"]}),T.jsxs("option",{value:"error",children:["Errors (",e.summary.errorCount,")"]}),T.jsxs("option",{value:"warning",children:["Warnings (",e.summary.warningCount,")"]}),T.jsxs("option",{value:"info",children:["Info (",e.summary.infoCount,")"]})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Filter by Type"}),T.jsxs("select",{value:u,onChange:m=>f(m.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"all",children:"All Types"}),Array.from(new Set(e.issues.map(m=>m.type))).map(m=>T.jsx("option",{value:m,children:d(m)},m))]})]})]}),T.jsx("div",{className:"mt-4 space-y-2 max-h-64 overflow-y-auto right-sidebar-scroll",children:p.map((m,y)=>T.jsxs("div",{onClick:()=>g(m),className:`p-3 rounded-lg cursor-pointer transition-colors ${m.severity==="error"?"bg-red-50 border border-red-200 hover:bg-red-100":m.severity==="warning"?"bg-yellow-50 border border-yellow-200 hover:bg-yellow-100":"bg-blue-50 border border-blue-200 hover:bg-blue-100"}`,children:[T.jsxs("div",{className:"flex items-start justify-between mb-1",children:[T.jsx("span",{className:"text-sm",children:v(m.severity)}),T.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded",children:d(m.type)})]}),T.jsx("p",{className:"text-xs mb-2 line-clamp-2",children:m.description}),m.affectedPins.length>0&&T.jsxs("div",{className:"text-xs mb-2",children:[T.jsx("span",{className:"font-medium",children:"Affected pins: "}),T.jsxs("span",{className:"font-mono",children:[m.affectedPins.slice(0,3).join(", "),m.affectedPins.length>3&&` +${m.affectedPins.length-3} more`]})]}),m.suggestion&&T.jsxs("div",{className:"text-xs mt-2 p-2 bg-white bg-opacity-50 rounded",children:[T.jsx("span",{className:"font-medium",children:" Suggestion: "}),m.suggestion]})]},y))})]})}),T.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 p-3 bg-white",children:T.jsx("div",{className:"text-xs text-gray-500 text-center",children:(e==null?void 0:e.lastChecked)&&T.jsxs(T.Fragment,{children:["Last checked: ",new Date(e.lastChecked).toLocaleTimeString()]})})})]}):T.jsxs("div",{className:`bg-gray-50 flex flex-col h-full ${n}`,children:[T.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Validation Results"}),T.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No validation data available"})]}),T.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"text-4xl mb-2",children:""}),T.jsx("div",{className:"text-sm",children:"Run validation to see results"})]})})]})},oU=({validationResult:e,className:t=""})=>{if(!e)return T.jsx("div",{className:`inline-flex items-center text-gray-400 ${t}`,children:T.jsx("span",{className:"text-sm",children:""})});const{summary:r}=e;return r.errorCount>0?T.jsxs("div",{className:`inline-flex items-center text-red-600 ${t}`,children:[T.jsx("span",{className:"text-sm",children:""}),T.jsx("span",{className:"ml-1 text-xs font-bold",children:r.errorCount})]}):r.warningCount>0?T.jsxs("div",{className:`inline-flex items-center text-yellow-600 ${t}`,children:[T.jsx("span",{className:"text-sm",children:""}),T.jsx("span",{className:"ml-1 text-xs font-bold",children:r.warningCount})]}):T.jsx("div",{className:`inline-flex items-center text-green-600 ${t}`,children:T.jsx("span",{className:"text-sm",children:""})})};class Qc{static assignArrayPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(r.startIndex>r.endIndex)throw new Error("Start index must be less than or equal to end index");const i=[];for(let s=r.startIndex;s<=r.endIndex;s+=r.step){const o=r.padding>0?s.toString().padStart(r.padding,"0"):s.toString(),u=r.indexFormat.replace("{i}",o).replace("{index}",o);i.push(r.baseName+u)}const a=Math.min(t.length,i.length);for(let s=0;s<a;s++){const o=t[s],u=i[s];if(o.pinType&&["POWER","GROUND","NC"].includes(o.pinType)){n.skippedPins++,n.errors.push(`Skipped ${o.pinNumber}: Cannot assign to ${o.pinType} pin`);continue}n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:u}),n.processedPins++}}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static assignDifferentialPattern(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.baseName.trim())throw new Error("Base name is required");if(!r.positiveFormat||!r.negativeFormat)throw new Error("Both positive and negative formats are required");t.length%2!==0&&n.errors.push(`Warning: Odd number of pins (${t.length}). Last pin will be skipped.`);const i=Math.floor(t.length/2);for(let a=0;a<i;a++){const s=t[a*2],o=t[a*2+1],u=s.pinType&&["POWER","GROUND","NC"].includes(s.pinType),f=o.pinType&&["POWER","GROUND","NC"].includes(o.pinType);if(u||f){n.skippedPins+=2,n.errors.push(`Skipped pair ${s.pinNumber}/${o.pinNumber}: Cannot assign to ${s.pinType}/${o.pinType} pins`);continue}let d=r.baseName;if(r.indexFormat&&r.startIndex!==void 0){const v=(r.startIndex||0)+a,m=r.padding&&r.padding>0?v.toString().padStart(r.padding,"0"):v.toString();d=r.indexFormat.replace("{i}",m).replace("{index}",m),d=r.baseName+d}const p=d+r.positiveFormat,g=d+r.negativeFormat;n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:s.signalName,newSignal:p}),n.assignments.push({pinId:o.id,pinNumber:o.pinNumber,oldSignal:o.signalName,newSignal:g}),n.processedPins+=2}t.length%2!==0&&n.skippedPins++}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}static filterPinsByCriteria(t,r){return t.filter(n=>{if(r.pinTypes&&r.pinTypes.length>0&&(!n.pinType||!r.pinTypes.includes(n.pinType))||r.banks&&r.banks.length>0&&(!n.bank||!r.banks.includes(n.bank))||r.voltages&&r.voltages.length>0&&(!n.voltage||!r.voltages.includes(n.voltage)))return!1;if(r.assignmentStatus){const i=n.signalName&&n.signalName.trim()!=="";if(r.assignmentStatus==="assigned"&&!i||r.assignmentStatus==="unassigned"&&i)return!1}if(r.pinNumberPattern)try{if(!new RegExp(r.pinNumberPattern).test(n.pinNumber))return!1}catch{}if(r.gridRange&&n.gridPosition){const{rowStart:i,rowEnd:a,colStart:s,colEnd:o}=r.gridRange;if(i&&n.gridPosition.row<i||a&&n.gridPosition.row>a||s&&n.gridPosition.col<s||o&&n.gridPosition.col>o)return!1}return!0})}static clearSignals(t){const r={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{for(const n of t)n.signalName&&n.signalName.trim()!==""?(r.assignments.push({pinId:n.id,pinNumber:n.pinNumber,oldSignal:n.signalName,newSignal:""}),r.processedPins++):r.skippedPins++}catch(n){r.success=!1,r.errors.push(n instanceof Error?n.message:"Unknown error occurred")}return r}static validateBatchOperation(t,r){const n=[];if(t.length===0)return n.push("No pins selected for batch operation"),n;t.length>1e3&&n.push(`Warning: Large dataset (${t.length} pins). Operation may take some time.`);const i=new Set(t.map(a=>a.pinType).filter(Boolean));return i.size>1&&(i.has("POWER")||i.has("GROUND"))&&n.push("Warning: Selection includes power/ground pins which cannot be assigned signals"),r==="differential"&&(t.length<2&&n.push("At least 2 pins required for differential pair assignment"),new Set(t.map(s=>s.bank).filter(Boolean)).size>1&&n.push("Warning: Differential pairs should typically be in the same bank")),n}static previewBatchOperation(t,r,n){try{let i;return n==="array"?i=this.assignArrayPattern(t,r):i=this.assignDifferentialPattern(t,r),i.assignments.map(a=>({pinNumber:a.pinNumber,currentSignal:a.oldSignal||"",newSignal:a.newSignal}))}catch{return[]}}static setVoltageAndIO(t,r){var i,a;const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!r.voltage&&!r.ioStandard)throw new Error("At least voltage or I/O standard must be specified");r.voltage&&!dx.includes(r.voltage)&&n.errors.push(`Invalid voltage: ${r.voltage}`),r.ioStandard&&!hx.includes(r.ioStandard)&&r.ioStandard!=="AUTO"&&n.errors.push(`Invalid I/O standard: ${r.ioStandard}`);for(const s of t){if(!["IO","CLOCK"].includes(s.pinType)&&r.voltage){n.skippedPins++;continue}let o=s.voltage,u=((i=s.attributes)==null?void 0:i.IO_Standard)||s.ioType||"AUTO";if(r.voltage&&(o=r.voltage),r.ioStandard)if(r.ioStandard==="AUTO"||r.autoDetectIO)u=Ql(o||"3.3V");else{if(o&&!UD(o,r.ioStandard)){n.errors.push(`I/O standard ${r.ioStandard} is not compatible with voltage ${o} for pin ${s.pinNumber}`),n.skippedPins++;continue}u=r.ioStandard}else r.autoDetectIO&&o&&(u=Ql(o));n.assignments.push({pinId:s.id,pinNumber:s.pinNumber,oldSignal:`${s.voltage||"Unknown"}V / ${((a=s.attributes)==null?void 0:a.IO_Standard)||s.ioType||"Unknown"}`,newSignal:`${o}V / ${u}`}),n.processedPins++}n.processedPins===0&&n.skippedPins>0&&(n.errors.push("No pins were processed. All pins were skipped."),n.success=!1)}catch(s){n.success=!1,n.errors.push(s instanceof Error?s.message:"Unknown error occurred")}return n}static setPinDirections(t,r){const n={success:!0,processedPins:0,skippedPins:0,errors:[],assignments:[]};try{if(!["Input","Output","InOut","Clock","Reset"].includes(r))throw new Error(`Invalid direction: ${r}`);for(const a of t){if(!["IO","CLOCK"].includes(a.pinType)){n.skippedPins++;continue}const s=a.direction||"Unknown";n.assignments.push({pinId:a.id,pinNumber:a.pinNumber,oldSignal:`Direction: ${s}`,newSignal:`Direction: ${r}`}),n.processedPins++}n.processedPins===0&&(n.errors.push("No I/O pins found to update"),n.success=!1)}catch(i){n.success=!1,n.errors.push(i instanceof Error?i.message:"Unknown error occurred")}return n}}const lU=({isVisible:e})=>{const{pins:t,selectedPins:r,assignSignal:n}=Xi(),[i,a]=_e.useState("array"),[s,o]=_e.useState("manual"),[u,f]=_e.useState(!1),[d,p]=_e.useState({baseName:"DATA",startIndex:0,endIndex:31,indexFormat:"[{i}]",padding:0,step:1}),[g,v]=_e.useState({voltage:"3.3V",ioStandard:"AUTO",autoDetectIO:!0,driveStrength:12,slewRate:"FAST"}),[m,y]=_e.useState("Input"),[E,k]=_e.useState({pinTypes:["IO"],assignmentStatus:"unassigned"}),[w,x]=_e.useState(null),C=_e.useMemo(()=>s==="manual"?t.filter(F=>r.has(F.id)):Qc.filterPinsByCriteria(t,E),[t,r,s,E]),A=_e.useMemo(()=>i==="clear"?[]:i==="voltage-io"||i==="direction"?C.length===0?["No pins selected"]:[]:C.length===0?["No pins selected"]:[],[C,i]),P=()=>{let F;switch(i){case"array":F=Qc.assignArrayPattern(C,d);break;case"voltage-io":F=Qc.setVoltageAndIO(C,g);break;case"direction":F=Qc.setPinDirections(C,m);break;case"clear":F=Qc.clearSignals(C);break;default:return}const I={...F,errors:F.errors.filter(D=>!D.includes("Need")&&!D.includes("pins, got")&&!D.includes("Not enough pins")&&!D.includes("pins selected"))};x(I),f(!0)},N=()=>{if(!w)return;const F=`Batch ${i} operation on ${w.processedPins} pins`,I=w.assignments.map(D=>({pinId:D.pinId,oldSignal:D.oldSignal||"",newSignal:D.newSignal}));Tr.recordAction("batch_operation",I,F),w.assignments.forEach(D=>{if(i==="voltage-io"){const{updatePin:U}=Xi.getState();U(D.pinId,{voltage:g.voltage,attributes:{IO_Standard:g.ioStandard==="AUTO"?Ql(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"},ioType:g.ioStandard==="AUTO"?Ql(g.voltage||"3.3V"):g.ioStandard||"LVCMOS33"})}else if(i==="direction"){const{updatePin:U}=Xi.getState();U(D.pinId,{direction:m})}else n(D.pinId,D.newSignal)}),f(!1),x(null)};return e?T.jsxs("div",{className:"flex flex-col h-full bg-gray-50",children:[T.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-200 bg-white",children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Batch Operations"}),T.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Assign patterns to multiple pins efficiently"})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"operationType",value:"array",checked:i==="array",onChange:F=>a(F.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:"Array Pattern (DATA[0], DATA[1], ...)"})]}),T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"operationType",value:"voltage-io",checked:i==="voltage-io",onChange:F=>a(F.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:"Voltage & I/O Standards"})]}),T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"operationType",value:"direction",checked:i==="direction",onChange:F=>a(F.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:"Pin Directions"})]}),T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"operationType",value:"clear",checked:i==="clear",onChange:F=>a(F.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:"Clear Signals"})]})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pin Selection"}),T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"selectionMode",value:"manual",checked:s==="manual",onChange:F=>o(F.target.value),className:"mr-2"}),T.jsxs("span",{className:"text-sm",children:["Use Selected Pins (",r.size,")"]})]}),T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"selectionMode",value:"criteria",checked:s==="criteria",onChange:F=>o(F.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:"Auto-select by Criteria"})]})]})]}),s==="criteria"&&T.jsxs("div",{className:"space-y-4 p-3 bg-blue-50 rounded-lg",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pin Types"}),T.jsx("div",{className:"space-x-4",children:["IO","POWER","GROUND","CLOCK"].map(F=>{var I;return T.jsxs("label",{className:"inline-flex items-center",children:[T.jsx("input",{type:"checkbox",checked:(I=E.pinTypes)==null?void 0:I.includes(F),onChange:D=>{D.target.checked?k(U=>({...U,pinTypes:[...U.pinTypes||[],F]})):k(U=>{var O;return{...U,pinTypes:((O=U.pinTypes)==null?void 0:O.filter(Q=>Q!==F))||[]}})},className:"mr-1"}),T.jsx("span",{className:"text-xs",children:F})]},F)})})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignment Status"}),T.jsxs("select",{value:E.assignmentStatus,onChange:F=>k(I=>({...I,assignmentStatus:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"any",children:"Any"}),T.jsx("option",{value:"assigned",children:"Assigned"}),T.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),T.jsxs("div",{className:"text-xs text-gray-600",children:["Matches ",C.length," pins"]})]}),i==="array"&&T.jsxs("div",{className:"space-y-3 p-3 bg-green-50 rounded-lg",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Array Pattern Configuration"}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Base Name"}),T.jsx("input",{type:"text",value:d.baseName,onChange:F=>p(I=>({...I,baseName:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"DATA"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Index Format"}),T.jsx("input",{type:"text",value:d.indexFormat,onChange:F=>p(I=>({...I,indexFormat:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"[{i}]"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start Index"}),T.jsx("input",{type:"number",value:d.startIndex,onChange:F=>p(I=>({...I,startIndex:parseInt(F.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End Index"}),T.jsx("input",{type:"number",value:d.endIndex,onChange:F=>p(I=>({...I,endIndex:parseInt(F.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Step"}),T.jsx("input",{type:"number",value:d.step,onChange:F=>p(I=>({...I,step:parseInt(F.target.value)||1})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"1"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Padding"}),T.jsx("input",{type:"number",value:d.padding,onChange:F=>p(I=>({...I,padding:parseInt(F.target.value)||0})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0"})]})]}),T.jsxs("div",{className:"text-xs text-gray-600",children:["Preview: ",d.baseName,d.indexFormat.replace("{i}",d.startIndex.toString().padStart(d.padding,"0"))]})]}),i==="voltage-io"&&T.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded-lg",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Voltage & I/O Standard Configuration"}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Voltage Level"}),T.jsxs("select",{value:g.voltage||"",onChange:F=>v(I=>({...I,voltage:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"",children:"Keep current"}),dx.map(F=>T.jsx("option",{value:F,children:F},F))]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"I/O Standard"}),T.jsxs("select",{value:g.ioStandard||"",onChange:F=>v(I=>({...I,ioStandard:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"",children:"Keep current"}),T.jsx("option",{value:"AUTO",children:"AUTO (based on voltage)"}),hx.map(F=>T.jsx("option",{value:F,children:F},F))]})]})]}),T.jsx("div",{className:"flex items-center space-x-4",children:T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"checkbox",checked:g.autoDetectIO||!1,onChange:F=>v(I=>({...I,autoDetectIO:F.target.checked})),className:"mr-2"}),T.jsx("span",{className:"text-xs",children:"Auto-detect I/O standard"})]})}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Drive Strength (mA)"}),T.jsxs("select",{value:g.driveStrength||"",onChange:F=>v(I=>({...I,driveStrength:parseInt(F.target.value)})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"",children:"Keep current"}),T.jsx("option",{value:"2",children:"2 mA"}),T.jsx("option",{value:"4",children:"4 mA"}),T.jsx("option",{value:"6",children:"6 mA"}),T.jsx("option",{value:"8",children:"8 mA"}),T.jsx("option",{value:"12",children:"12 mA"}),T.jsx("option",{value:"16",children:"16 mA"}),T.jsx("option",{value:"20",children:"20 mA"}),T.jsx("option",{value:"24",children:"24 mA"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Slew Rate"}),T.jsxs("select",{value:g.slewRate||"",onChange:F=>v(I=>({...I,slewRate:F.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[T.jsx("option",{value:"",children:"Keep current"}),T.jsx("option",{value:"SLOW",children:"SLOW"}),T.jsx("option",{value:"FAST",children:"FAST"})]})]})]})]}),i==="direction"&&T.jsxs("div",{className:"space-y-3 p-3 bg-orange-50 rounded-lg",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-800",children:"Pin Direction Configuration"}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Direction"}),T.jsx("div",{className:"space-y-2",children:["Input","Output","InOut","Clock","Reset"].map(F=>T.jsxs("label",{className:"flex items-center",children:[T.jsx("input",{type:"radio",name:"direction",value:F,checked:m===F,onChange:I=>y(I.target.value),className:"mr-2"}),T.jsx("span",{className:"text-sm",children:F})]},F))})]})]}),T.jsxs("div",{className:"p-3 bg-gray-100 rounded-lg",children:[T.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Target Summary"}),T.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[T.jsxs("div",{children:["Selected pins: ",C.length]}),T.jsxs("div",{children:["Operation: ",i]}),A.length>0&&T.jsxs("div",{className:"text-red-600",children:[T.jsx("div",{className:"font-medium",children:"Validation Issues:"}),T.jsx("ul",{className:"text-xs mt-1 space-y-1",children:A.map((F,I)=>T.jsxs("li",{children:[" ",F]},I))})]})]})]}),T.jsx("div",{children:T.jsx("button",{onClick:P,disabled:C.length===0||A.length>0,className:"w-full py-3 px-4 bg-blue-500 text-black rounded-lg hover:bg-blue-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-blue-600",children:"Generate Preview"})}),u&&w&&T.jsxs("div",{className:"border rounded-lg bg-white",children:[T.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[T.jsx("h4",{className:"font-medium text-gray-800",children:"Preview Results"}),T.jsx("p",{className:"text-sm text-gray-600 mt-1",children:w.success?`${w.processedPins} pins will be assigned`:"Operation preview failed"})]}),w.errors.length>0&&T.jsxs("div",{className:"p-3 bg-red-50 border-b",children:[T.jsx("h5",{className:"text-sm font-medium text-red-800 mb-1",children:"Errors:"}),T.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:w.errors.map((F,I)=>T.jsxs("li",{children:[" ",F]},I))})]}),w.assignments.length>0&&T.jsxs("div",{className:"p-4",children:[T.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Assignments"}),T.jsx("div",{className:"max-h-48 overflow-y-auto border rounded custom-scrollbar",children:T.jsxs("table",{className:"w-full text-sm",children:[T.jsx("thead",{className:"bg-gray-50 sticky top-0",children:T.jsxs("tr",{children:[T.jsx("th",{className:"px-3 py-2 text-left",children:"Pin"}),T.jsx("th",{className:"px-3 py-2 text-left",children:"Current"}),T.jsx("th",{className:"px-3 py-2 text-left",children:"New"})]})}),T.jsxs("tbody",{children:[w.assignments.slice(0,50).map((F,I)=>T.jsxs("tr",{className:"border-t",children:[T.jsx("td",{className:"px-3 py-2 font-mono",children:F.pinNumber}),T.jsx("td",{className:"px-3 py-2 text-gray-600",children:F.oldSignal||"-"}),T.jsx("td",{className:"px-3 py-2 font-medium text-green-700",children:F.newSignal})]},I)),w.assignments.length>50&&T.jsx("tr",{children:T.jsxs("td",{colSpan:3,className:"px-3 py-2 text-center text-gray-500 italic",children:["... and ",w.assignments.length-50," more"]})})]})]})})]})]})]}),u&&w&&T.jsx("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:T.jsxs("div",{className:"flex gap-3",children:[T.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),T.jsx("button",{onClick:N,disabled:!w.success||w.processedPins===0,className:"flex-1 py-2 px-4 bg-green-500 text-black rounded-lg hover:bg-green-600 hover:text-black disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed font-medium shadow-md border border-green-600",children:"Execute Operation"})]})})]}):null},Ml=class{static initialize(){this.isInitialized||(document.addEventListener("keydown",this.handleKeyDown),this.isInitialized=!0)}static cleanup(){document.removeEventListener("keydown",this.handleKeyDown),this.shortcuts.clear(),this.isInitialized=!1}static registerShortcut(t,r){this.shortcuts.set(t.toLowerCase(),r)}static unregisterShortcut(t){this.shortcuts.delete(t.toLowerCase())}static getKeyString(t){const r=[];return t.ctrlKey&&r.push("ctrl"),t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),t.metaKey&&r.push("meta"),r.push(t.key.toLowerCase()),r.join("+")}static getAvailableShortcuts(){return[{key:"ctrl+o",description:"Open CSV file"},{key:"ctrl+s",description:"Save project"},{key:"ctrl+e",description:"Export XDC"},{key:"ctrl+f",description:"Focus search"},{key:"ctrl+a",description:"Select all pins"},{key:"ctrl+d",description:"Deselect all"},{key:"r",description:"Reset zoom and pan"},{key:"space",description:"Rotate view 90"},{key:"f",description:"Flip top/bottom view"},{key:"ctrl+z",description:"Undo"},{key:"ctrl+y",description:"Redo"},{key:"+",description:"Zoom in"},{key:"-",description:"Zoom out"},{key:"0",description:"Reset zoom to 100%"},{key:"escape",description:"Clear selection"},{key:"delete",description:"Clear selected pin assignments"},{key:"ctrl+shift+?",description:"Show keyboard shortcuts"}]}};Ml.shortcuts=new Map;Ml.isInitialized=!1;Ml.handleKeyDown=e=>{if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)return;const t=Ml.getKeyString(e),r=Ml.shortcuts.get(t);r&&(e.preventDefault(),r())};let Ut=Ml;const cU=()=>{const{undo:e,redo:t,updateUndoRedoState:r}=Xi();_e.useEffect(()=>{Tr.initialize();const n=()=>{r()};return Tr.addListener(n),Ut.initialize(),Ut.registerShortcut("ctrl+z",()=>{e()}),Ut.registerShortcut("ctrl+y",()=>{t()}),Ut.registerShortcut("ctrl+shift+z",()=>{t()}),r(),()=>{Tr.removeListener(n),Ut.unregisterShortcut("ctrl+z"),Ut.unregisterShortcut("ctrl+y"),Ut.unregisterShortcut("ctrl+shift+z")}},[e,t,r])},uU=()=>{const{clearSelection:e,resetZoom:t,rotatePins:r,flipView:n,setZoom:i,viewConfig:a,pins:s,selectPins:o}=Xi();_e.useEffect(()=>(Ut.registerShortcut("escape",()=>{e()}),Ut.registerShortcut("ctrl+a",()=>{o(s.map(u=>u.id))}),Ut.registerShortcut("ctrl+d",()=>{e()}),Ut.registerShortcut("r",()=>{t()}),Ut.registerShortcut("space",()=>{r(90)}),Ut.registerShortcut("f",()=>{n()}),Ut.registerShortcut("+",()=>{const u=Math.min(a.zoom*1.2,5);i(u)}),Ut.registerShortcut("-",()=>{const u=Math.max(a.zoom/1.2,.1);i(u)}),Ut.registerShortcut("0",()=>{i(1)}),Ut.registerShortcut("ctrl+shift+?",()=>{document.dispatchEvent(new CustomEvent("showKeyboardHelp"))}),()=>{Ut.unregisterShortcut("escape"),Ut.unregisterShortcut("ctrl+a"),Ut.unregisterShortcut("ctrl+d"),Ut.unregisterShortcut("r"),Ut.unregisterShortcut("space"),Ut.unregisterShortcut("f"),Ut.unregisterShortcut("+"),Ut.unregisterShortcut("-"),Ut.unregisterShortcut("0"),Ut.unregisterShortcut("ctrl+shift+?")}),[e,t,r,n,i,a.zoom,s,o])},fU=()=>{cU(),uU(),_e.useEffect(()=>()=>{Ut.cleanup()},[])};class pl{static async validateProjectAsync(t,r){return new Promise(n=>{const i=this.validateProject(t,r);n(i)})}static validateProject(t,r){const n=[];n.push(...this.checkPinConflicts(r)),n.push(...this.checkDifferentialPairs(r)),n.push(...this.checkBankConstraints(r));const i=this.calculateSummary(n);return{issues:n,summary:i,lastChecked:Date.now()}}static checkPinConflicts(t){const r=[],n=new Map;return t.forEach(i=>{if(i.signalName&&i.signalName.trim()!==""){const a=i.signalName.trim();n.has(a)||n.set(a,[]),n.get(a).push(i)}}),n.forEach((i,a)=>{i.length>1&&r.push({id:`conflict_${a}_${Date.now()}`,type:"pin_conflict",severity:"error",title:`Duplicate assignment for signal "${a}"`,description:`Signal "${a}" is assigned to ${i.length} pins.`,affectedPins:i.map(s=>s.id),suggestion:"Each signal should be assigned to only one pin.",autoFixable:!1,timestamp:Date.now()})}),r}static checkDifferentialPairs(t){const r=[],n=new Set;return t.forEach(i=>{if(!Gt.isDifferentialPin(i))return;const a=Gt.getDifferentialPairType(i.pinName)||(i.signalName?Gt.getDifferentialPairType(i.signalName):null);if(!a)return;const s=Gt.findPairPin(i,t),o=Gt.getDifferentialBaseName(i.pinName),u=`${i.id}_${(s==null?void 0:s.id)||"missing"}`;if(!n.has(u))if(n.add(u),!s)r.push({id:`diff_pair_incomplete_${i.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Incomplete differential pair: ${o}`,description:`Pin ${i.pinNumber} (${i.pinName}) has no differential pair partner.`,affectedPins:[i.id],suggestion:`Find and assign the ${a==="positive"?"negative":"positive"} side pin in the same bank.`,autoFixable:!1,timestamp:Date.now()});else{i.bank!==s.bank&&r.push({id:`diff_pair_bank_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"error",title:`Differential pair bank mismatch: ${o}`,description:`Differential pair pins are in different banks. Pin ${i.pinNumber} (Bank ${i.bank}) and Pin ${s.pinNumber} (Bank ${s.bank})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be placed in the same bank.",autoFixable:!1,timestamp:Date.now()}),i.voltage!==s.voltage&&r.push({id:`diff_pair_voltage_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`Differential pair voltage mismatch: ${o}`,description:`Differential pair pins have different voltages. Pin ${i.pinNumber} (${i.voltage}) and Pin ${s.pinNumber} (${s.voltage})`,affectedPins:[i.id,s.id],suggestion:"Differential pair pins should be set to the same voltage level.",autoFixable:!1,timestamp:Date.now()});const f=i.signalName&&i.signalName.trim()!=="",d=s.signalName&&s.signalName.trim()!=="";if(f&&d){const p=Gt.getPairPinName(i.signalName);p&&p.toLowerCase()!==s.signalName.toLowerCase()&&r.push({id:`diff_pair_signal_mismatch_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"warning",title:`: ${o}`,description:`"${i.signalName}"  "${s.signalName}"`,affectedPins:[i.id,s.id],suggestion:`: "${i.signalName}"  "${p}"`,autoFixable:!1,timestamp:Date.now()})}else f&&!d&&r.push({id:`diff_pair_incomplete_signal_${i.id}_${s.id}_${Date.now()}`,type:"differential_pair",severity:"info",title:`: ${o}`,description:` ${i.pinNumber}  "${i.signalName}"  ${s.pinNumber} `,affectedPins:[i.id,s.id],suggestion:"",autoFixable:!1,timestamp:Date.now()})}}),r}static checkBankConstraints(t){const r=[],n=new Map;return t.forEach(i=>{i.bank&&i.signalName&&i.signalName.trim()!==""&&(n.has(i.bank)||n.set(i.bank,[]),n.get(i.bank).push(i))}),n.forEach((i,a)=>{r.push(...this.checkVCCOConsistency(a,i)),r.push(...this.checkIOStandardCompatibility(a,i)),r.push(...this.checkDifferentialPairBankConstraints(a,i)),r.push(...this.checkSpecialPinConstraints(a,i)),r.push(...this.checkHighSpeedSignalConstraints(a,i))}),r}static getIOStandard(t){var r,n,i;return((r=t.attributes)==null?void 0:r.IO_Standard)||((n=t.attributes)==null?void 0:n.io_standard)||((i=t.attributes)==null?void 0:i.iostandard)}static checkVCCOConsistency(t,r){const n=[],i=new Set(r.map(a=>a.voltage).filter(a=>a&&a!==""&&a!=="0V"));return i.size>1&&n.push({id:`bank-vcco-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`VCCO voltage mismatch in Bank ${t}`,description:`Bank ${t} contains pins with different VCCO voltages: ${Array.from(i).join(", ")}. All pins in a bank must share the same VCCO.`,affectedPins:r.map(a=>a.id),suggestion:"Configure all pins in the same bank to use the same VCCO voltage level.",autoFixable:!1,timestamp:Date.now()}),n}static checkIOStandardCompatibility(t,r){const n=[],i=r.map(o=>this.getIOStandard(o)).filter(o=>o&&o!=="");if(i.length===0)return n;const a=[...new Set(i)];if(a.length<=1)return n;const s=[{group1:["LVCMOS33","LVCMOS25","LVCMOS18","LVCMOS15","LVCMOS12"],group2:["LVDS","LVDS_25","BLVDS_25","MLVDS_25"],reason:"Single-ended and differential standards cannot share the same bank"},{group1:["SSTL135","SSTL125","SSTL15"],group2:["POD12","POD10"],reason:"SSTL and POD standards require different reference voltages"},{group1:["HSTL_I","HSTL_II","HSTL_I_18","HSTL_II_18"],group2:["LVCMOS33","LVCMOS25"],reason:"HSTL requires center-tap termination, incompatible with LVCMOS"},{group1:["MIPI_DPHY_DCI"],group2:["LVCMOS18","LVCMOS12"],reason:"MIPI DPHY requires dedicated differential signaling"}];for(const o of s){const u=o.group1.some(d=>a.includes(d)),f=o.group2.some(d=>a.includes(d));if(u&&f){const d=r.filter(p=>o.group1.includes(this.getIOStandard(p)||"")||o.group2.includes(this.getIOStandard(p)||""));n.push({id:`bank-iostd-conflict-${t}-${Date.now()}`,type:"bank_constraint",severity:"error",title:`Incompatible I/O standards in Bank ${t}`,description:`${o.reason}. Found: ${a.join(", ")}`,affectedPins:d.map(p=>p.id),suggestion:"Separate incompatible I/O standards into different banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkDifferentialPairBankConstraints(t,r){const n=[],i=new Map;return r.forEach(a=>{if(!a.signalName)return;const s=this.getDifferentialBaseName(a.signalName);s&&(i.has(s)||i.set(s,[]),i.get(s).push(a))}),i.forEach((a,s)=>{if(a.length===2){const[o,u]=a;o.bank!==u.bank&&n.push({id:`diff-pair-bank-cross-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair crosses bank boundary",description:`Differential pair "${s}" has pins in different banks: ${o.pinNumber} (Bank ${o.bank}) and ${u.pinNumber} (Bank ${u.bank})`,affectedPins:[o.id,u.id],suggestion:"Place both pins of a differential pair in the same bank.",autoFixable:!1,timestamp:Date.now()});const f=this.getIOStandard(o),d=this.getIOStandard(u);f&&d&&f!==d&&n.push({id:`diff-pair-iostd-${s}-${Date.now()}`,type:"differential_pair",severity:"error",title:"Differential pair I/O standard mismatch",description:`Differential pair "${s}" has mismatched I/O standards: ${f} vs ${d}`,affectedPins:[o.id,u.id],suggestion:"Use the same I/O standard for both pins in a differential pair.",autoFixable:!1,timestamp:Date.now()})}}),n}static checkSpecialPinConstraints(t,r){const n=[],i=r.filter(s=>{var o,u,f,d,p;return((o=s.pinType)==null?void 0:o.includes("CLOCK"))||((u=s.pinType)==null?void 0:u.includes("GLOBAL"))||((f=s.pinType)==null?void 0:f.includes("CONFIG"))||((d=s.pinName)==null?void 0:d.startsWith("IO_L"))&&((p=s.pinName)==null?void 0:p.includes("CC"))}),a=r.filter(s=>!i.includes(s));if(i.length>0&&a.length>0){const s=i.filter(o=>{var u,f;return((u=o.signalName)==null?void 0:u.toLowerCase().includes("clk"))||((f=o.signalName)==null?void 0:f.toLowerCase().includes("clock"))});if(s.length>0){const o=s.filter(u=>{var f,d,p,g;return((f=u.signalName)==null?void 0:f.includes("100"))||((d=u.signalName)==null?void 0:d.includes("200"))||((p=u.signalName)==null?void 0:p.includes("GHz"))||((g=this.getIOStandard(u))==null?void 0:g.includes("LVDS"))});o.length>0&&a.length>0&&n.push({id:`bank-clock-isolation-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`High-speed clocks mixed with regular I/O in Bank ${t}`,description:"High-speed clock signals may cause noise coupling with regular I/O signals",affectedPins:[...o.map(u=>u.id),...a.slice(0,3).map(u=>u.id)],suggestion:"Consider isolating high-speed clock signals in dedicated banks.",autoFixable:!1,timestamp:Date.now()})}}return n}static checkHighSpeedSignalConstraints(t,r){const n=[],i=r.filter(s=>{var u,f,d,p;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return o.includes("ddr")||o.includes("pcie")||o.includes("serdes")||o.includes("mgt")||o.includes("lvds")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVDS"))||((d=this.getIOStandard(s))==null?void 0:d.includes("SSTL"))||((p=this.getIOStandard(s))==null?void 0:p.includes("POD"))}),a=r.filter(s=>{var u,f;const o=((u=s.signalName)==null?void 0:u.toLowerCase())||"";return(o.includes("gpio")||o.includes("led")||o.includes("button")||((f=this.getIOStandard(s))==null?void 0:f.includes("LVCMOS")))&&!i.includes(s)});return i.length>0&&a.length>0&&n.push({id:`bank-speed-mix-${t}-${Date.now()}`,type:"bank_constraint",severity:"warning",title:`Mixed signal speeds in Bank ${t}`,description:`Bank ${t} contains both high-speed (${i.length}) and low-speed (${a.length}) signals`,affectedPins:[...i.slice(0,2).map(s=>s.id),...a.slice(0,2).map(s=>s.id)],suggestion:"Consider grouping signals by speed to minimize noise coupling.",autoFixable:!1,timestamp:Date.now()}),n}static getDifferentialBaseName(t){const r=t.toLowerCase();if(r.endsWith("_p")||r.endsWith("_n"))return t.slice(0,-2);if(r.endsWith("+")||r.endsWith("-"))return t.slice(0,-1);if(r.endsWith("p")&&!r.endsWith("_p")||r.endsWith("n")&&!r.endsWith("_n")){const n=r.charAt(r.length-2);if(/[\d_-]/.test(n))return t.slice(0,-1)}return null}static calculateSummary(t){const r={totalIssues:t.length,errorCount:0,warningCount:0,infoCount:0};return t.forEach(n=>{switch(n.severity){case"error":r.errorCount++;break;case"warning":r.warningCount++;break;case"info":r.infoCount++;break}}),r}static addListener(t){this.listeners.add(t)}static removeListener(t){this.listeners.delete(t)}static getIssuesForPin(t,r){return r.filter(n=>n.affectedPins.includes(t))}static getIssuesByType(t,r){return r.filter(n=>n.type===t)}static getIssuesBySeverity(t,r){return r.filter(n=>n.severity===t)}}pl.listeners=new Set;const dU=(e,t,r={})=>{const{enabled:n=!0,debounceMs:i=1e3,backgroundCheck:a=!0}=r,[s,o]=_e.useState(null),[u,f]=_e.useState(!1),d=_e.useRef(null),p=_e.useRef(""),g=_e.useCallback(async()=>{if(!n||!e||t.length===0)return;const w=JSON.stringify({packageId:e.id,pinsData:t.map(x=>({id:x.id,signalName:x.signalName,bank:x.bank,voltage:x.voltage,pinName:x.pinName}))});if(w!==p.current)if(p.current=w,a){f(!0);try{const x=await pl.validateProjectAsync(e,t);o(x)}catch(x){console.error("Validation error:",x)}finally{f(!1)}}else{const x=pl.validateProject(e,t);o(x)}},[e,t,n,a]),v=_e.useCallback(()=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{g()},i)},[g,i]);_e.useEffect(()=>(n&&v(),()=>{d.current&&clearTimeout(d.current)}),[t,e,n,v]);const m=_e.useCallback(()=>{p.current="",g()},[g]),y=_e.useCallback(w=>s?pl.getIssuesForPin(w,s.issues):[],[s]),E=_e.useCallback(w=>s?pl.getIssuesByType(w,s.issues):[],[s]),k=_e.useCallback(w=>s?pl.getIssuesBySeverity(w,s.issues):[],[s]);return{validationResult:s,isValidating:u,manualValidate:m,getIssuesForPin:y,getIssuesByType:E,getIssuesBySeverity:k,hasErrors:s?s.summary.errorCount>0:!1,hasWarnings:s?s.summary.warningCount>0:!1,hasIssues:s?s.summary.totalIssues>0:!1,errorCount:(s==null?void 0:s.summary.errorCount)||0,warningCount:(s==null?void 0:s.summary.warningCount)||0,totalIssues:(s==null?void 0:s.summary.totalIssues)||0}},hU=`# Xilinx XC7A12T Package Data
# Copyright (C) 2024 Sample Data
Pin,Pin Name,Memory Byte Group,Bank,VCCAUX Group,Super Logic Region,I/O Type,No-Connect
A1,IO_L1P_T0_D00_MOSI_14,0,14,NA,X0Y0,HR,FALSE
A2,IO_L1N_T0_D01_DIN_14,0,14,NA,X0Y0,HR,FALSE
B1,VCCINT,NA,NA,NA,NA,POWER,FALSE
B2,GND,NA,NA,NA,NA,GROUND,FALSE
C1,IO_L2P_T0_D02_14,0,14,NA,X0Y0,HR,FALSE
C2,IO_L2N_T0_D03_14,0,14,NA,X0Y0,HR,FALSE
D1,CONFIG_DONE,NA,NA,NA,NA,CONFIG,FALSE
D2,MGTPRXP1_216,NA,216,NA,NA,GTP,FALSE`,pU=()=>{const e=new Blob([hU],{type:"text/csv"});return new File([e],"sample-fpga-pins.csv",{type:"text/csv"})},gU=()=>{const e=_e.useRef(null),[t,r]=_e.useState(!1),[n,i]=_e.useState(null),[a,s]=_e.useState(!1),[o,u]=_e.useState(!1),[f,d]=_e.useState("validation"),[p,g]=_e.useState(!1),[v,m]=_e.useState(!1),[y,E]=_e.useState(!1),[k,w]=_e.useState(!1),[x,C]=_e.useState(320),[A,P]=_e.useState(280),[N,F]=_e.useState(null);fU(),_e.useEffect(()=>{const Ne=Ye=>{Ye.key==="F11"&&(Ye.preventDefault(),de())};return document.addEventListener("keydown",Ne),()=>{document.removeEventListener("keydown",Ne)}},[v,y,k]),_e.useEffect(()=>{const Ne=()=>{u(!0)};return document.addEventListener("showKeyboardHelp",Ne),()=>{document.removeEventListener("showKeyboardHelp",Ne)}},[]),_e.useEffect(()=>{if(typeof window.acquireVsCodeApi<"u"&&!window.vscode)try{const Ne=window.acquireVsCodeApi();window.vscode=Ne}catch(Ne){console.error("Failed to initialize VS Code API:",Ne)}},[]),_e.useEffect(()=>{const Ne=Ye=>{p&&(Ye.target.closest("[data-export-menu]")||g(!1))};return document.addEventListener("click",Ne),()=>{document.removeEventListener("click",Ne)}},[p]);const{pins:I,filteredPins:D,selectedPins:U,package:O,filters:Q,viewConfig:he,listView:te,loadPackage:Ee,selectPin:we,assignSignal:se,updateFilters:X,setError:ce,setLoading:Se,setRotation:L,toggleView:q,setZoom:Y,resetZoom:K,setSortField:ue,setSortOrder:z,setViewMode:ee}=Xi(),de=()=>{m(!v),v?(E(!1),w(!1)):(E(!0),w(!0),setTimeout(()=>{K()},100))},xe=Ne=>Ye=>{Ye.preventDefault(),F(Ne)},Me=Ne=>{if(!N)return;const Ye=window.innerWidth;if(N==="left"){const Ue=Math.max(200,Math.min(500,Ne.clientX));C(Ue)}else if(N==="right"){const Ue=Math.max(200,Math.min(500,Ye-Ne.clientX));P(Ue)}},G=()=>{F(null)};_e.useEffect(()=>(document.addEventListener("mousemove",Me),document.addEventListener("mouseup",G),()=>{document.removeEventListener("mousemove",Me),document.removeEventListener("mouseup",G)}),[N]),_e.useEffect(()=>{const Ne=Ye=>{const Ue=Ye.data;switch(Ue.command){case"loadProject":try{if(Ue.projectData){const at=Ue.projectData;if(at.package&&at.pins){const At=at.pins.map(Et=>({...Et,isAssigned:!!Et.assignedSignalName,signalName:Et.assignedSignalName||""})),Ot=zc.createPackageFromPins(At,at.package.name||"Loaded Project");Ee(Ot)}}}catch(at){console.error("Failed to load project from VS Code:",at),ce(`Failed to load project: ${at}`)}break;case"loadSampleData":(async()=>{try{const at=pU();r(!0),Se(!0),ce(null);const At=await zc.parseCSVFile(at);if(At.success){const Ot=zc.createPackageFromPins(At.pins,at.name);Ee(Ot),At.warnings.length>0&&console.warn("Sample data import warnings:",At.warnings)}else ce(`Failed to load sample data: ${At.errors.join(", ")}`)}catch(at){console.error("Failed to load sample data from VS Code:",at),ce(`Failed to load sample data: ${at}`)}finally{r(!1),Se(!1)}})();break}};return console.log(" Checking VS Code environment:",{hasVscode:typeof window.vscode<"u",windowKeys:Object.keys(window),userAgent:navigator.userAgent}),typeof window.vscode<"u"?(window.addEventListener("message",Ne),setTimeout(()=>{window.vscode.postMessage({command:"webviewReady"})},500),()=>{window.removeEventListener("message",Ne)}):()=>{}},[Ee,ce]);const{validationResult:Ze,isValidating:nt,hasErrors:Ke,hasWarnings:qe,errorCount:De,warningCount:kt}=dU(O,I,{enabled:!0,debounceMs:1e3,backgroundCheck:!0}),Or=()=>{var Ne;(Ne=e.current)==null||Ne.click()},me=async Ne=>{var Ue;const Ye=(Ue=Ne.target.files)==null?void 0:Ue[0];if(Ye){r(!0),Se(!0),ce(null);try{const at=await zc.parseCSVFile(Ye);if(at.success){const At=zc.createPackageFromPins(at.pins,Ye.name);Ee(At),at.warnings.length>0&&console.warn("Import warnings:",at.warnings)}else ce(`Failed to import file: ${at.errors.join(", ")}`)}catch(at){console.error(" :",at),ce(`Error reading file: ${at.message}`)}finally{r(!1),Se(!1),e.current&&(e.current.value="")}}},pe=Ne=>{X({searchText:Ne.target.value})},Ce=Ne=>{const Ye=Q.pinTypes,Ue=Ye.includes(Ne)?Ye.filter(at=>at!==Ne):[...Ye,Ne];X({pinTypes:Ue})},Te=()=>{const Ne=I.length,Ye=I.filter(at=>at.isAssigned).length,Ue=Ne-Ye;return{total:Ne,assigned:Ye,unassigned:Ue}},Ae=()=>{L(he.rotation+90)},be=()=>{Y(Math.min(3,he.zoom+.1))},Ge=()=>{Y(Math.max(.2,he.zoom-.1))},ye=Ne=>{const Ye=I.find(Ue=>Ue.id===Ne);if(Ye){const Ue=prompt("Enter signal name:",Ye.signalName);Ue!==null&&se(Ne,Ue)}},ie=Ne=>{we(Ne),i(Ne||null)},Pe=Ne=>{we(Ne)},Fe=()=>{const Ne=typeof window.vscode<"u",Ye=typeof window.acquireVsCodeApi<"u",Ue=window.location.protocol.includes("vscode-resource")||window.location.protocol.includes("vscode-webview")||window.navigator.userAgent.includes("Electron");return Ne||Ye||Ue},ke=async(Ne,Ye,Ue,at)=>{if(!Fe())return!1;try{let At=window.vscode;if(!At&&typeof window.acquireVsCodeApi<"u"&&(At=window.acquireVsCodeApi(),window.vscode=At),!At||typeof At.postMessage!="function")return!1;const Ot=await new Promise((Et,ai)=>{const Nn=setTimeout(()=>{window.removeEventListener("message",Hn),ai(new Error("Save dialog timeout"))},3e4),Hn=Qt=>{console.log(" Received message in App.tsx:",Qt.data),Qt.data.command==="saveDialogResult"&&(clearTimeout(Nn),window.removeEventListener("message",Hn),console.log(" Save dialog result received in App.tsx:",Qt.data.result),Et(Qt.data.result))};window.addEventListener("message",Hn);const $r={command:"showSaveDialog",options:{saveLabel:at,filters:Ue}};try{At.postMessage($r)}catch(Qt){console.error("Failed to send message:",Qt),ai(Qt)}});if(Ot){let Et;if(typeof Ot=="string")Et=Ot;else if(Ot&&typeof Ot=="object"){const Nn=Ot;Et=Nn.fsPath||Nn.path,!Et&&typeof Ot.toString=="function"&&(Et=Ot.toString())}return!Et||Et==="undefined"||Et==="[object Object]"?(console.error("Failed to extract valid file path from URI"),!1):await new Promise(Nn=>{const Hn=$r=>{$r.data.command==="saveFileResult"&&(window.removeEventListener("message",Hn),Nn($r.data.success))};window.addEventListener("message",Hn),At.postMessage({command:"saveFile",filePath:Et,content:Ne,filename:Ye})})}}catch(At){console.error("VS Code save failed:",At)}return!1},Qe=async Ne=>{const Ye=D.length>0?D:I;if(Ye.length===0)return;let Ue,at,At,Ot,Et;Ne==="xdc"?(Ue=Na.exportToXDC(Ye,O),at=`${(O==null?void 0:O.device)||"fpga"}_pins.xdc`,At="text/plain",Ot={"XDC Files":["xdc"],"All Files":["*"]},Et="Export XDC Constraints"):(Ue=Na.exportToSDC(Ye,O),at=`${(O==null?void 0:O.device)||"fpga"}_pins.sdc`,At="text/plain",Ot={"SDC Files":["sdc"],"All Files":["*"]},Et="Export SDC Constraints"),await ke(Ue,at,Ot,Et)||Na.downloadFile(Ue,at,At)},Je=async()=>{console.log(" EXPORT DEBUG - handleExportCSV:"),console.log("- pins.length:",I.length),console.log("- filteredPins.length:",D.length);const Ne=D.length>0?D:I;if(Ne.length===0){console.log(" No pins available for export");return}const Ye=Na.exportToCSV(Ne),Ue=`${(O==null?void 0:O.device)||"fpga"}_pins.csv`;await ke(Ye,Ue,{"CSV Files":["csv"],"All Files":["*"]},"Export Pin Data to CSV")||Na.downloadFile(Ye,Ue,"text/csv")},dt=async()=>{console.log(" EXPORT DEBUG - handleExportReport:"),console.log("- pins.length:",I.length),console.log("- filteredPins.length:",D.length);const Ne=D.length>0?D:I;if(Ne.length===0){console.log(" No pins available for export");return}const Ye=Na.exportReport(Ne,O),Ue=`${(O==null?void 0:O.device)||"fpga"}_report.txt`;await ke(Ye,Ue,{"Text Files":["txt"],"All Files":["*"]},"Export Pin Assignment Report")||Na.downloadFile(Ye,Ue,"text/plain")},lt=Te(),{sortedPinsForList:vt}=Sr.useMemo(()=>{const Ne=[...D];return Ne.sort((Ye,Ue)=>{var Nn,Hn;const at=n&&Ye.id===n,At=n&&Ue.id===n;if(at&&!At)return-1;if(!at&&At)return 1;if(n&&!at&&!At){const $r=D.find(Qt=>Qt.id===n);if($r){const Qt=Gt.findPairPin($r,D),Xs=(Qt==null?void 0:Qt.id)===Ye.id,$o=(Qt==null?void 0:Qt.id)===Ue.id;if(Xs&&!$o)return-1;if(!Xs&&$o)return 1}}let Ot,Et;switch(Q.sortField){case"pinNumber":Ot=Ye.pinNumber,Et=Ue.pinNumber;break;case"pinName":Ot=Ye.pinName,Et=Ue.pinName;break;case"signalName":Ot=Ye.signalName||"",Et=Ue.signalName||"";break;case"pinType":Ot=Ye.pinType,Et=Ue.pinType;break;case"bank":Ot=Ye.bank||"",Et=Ue.bank||"";break;case"grid":if(Ye.gridPosition&&Ue.gridPosition){const $r=H6(Ye.gridPosition.row,Ue.gridPosition.row);if($r!==0)return Q.sortOrder==="asc"?$r:-$r;const Qt=Ye.gridPosition.col-Ue.gridPosition.col;return Q.sortOrder==="asc"?Qt:-Qt}Ot=((Nn=Ye.gridPosition)==null?void 0:Nn.row)||"",Et=((Hn=Ue.gridPosition)==null?void 0:Hn.row)||"";break;default:Ot=Ye.pinNumber,Et=Ue.pinNumber}const ai=Ot.localeCompare(Et,void 0,{numeric:!0,sensitivity:"base"});return Q.sortOrder==="asc"?ai:-ai}),{sortedPinsForList:Ne}},[D,Q.sortField,Q.sortOrder,n,I]);return T.jsxs("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#1e1e1e",color:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',display:"flex",flexDirection:"column"},children:[T.jsxs("header",{style:{height:"36px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",flexShrink:0,minHeight:"36px"},children:[T.jsx("h1",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#4A90E2"},children:"FPGA Pin Planner"}),T.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"12px",alignItems:"center"},children:[T.jsx("button",{onClick:de,style:{padding:"6px 12px",backgroundColor:v?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px",color:v?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},title:v?"Restore Normal View (F11)":"Maximize Viewer (F11)",children:v?" Restore":" Maximize"}),T.jsx("input",{ref:e,type:"file",accept:".csv,.txt,.xlsx,.xls",onChange:me,style:{display:"none"}}),T.jsx("button",{onClick:Or,disabled:t,style:{padding:"8px 16px",backgroundColor:t?"#666":"#4A90E2",border:"none",borderRadius:"4px",color:"white",cursor:t?"not-allowed":"pointer",fontSize:"14px"},children:t?" Loading...":" Open Pin File"}),T.jsxs("div",{style:{position:"relative"},"data-export-menu":!0,children:[T.jsxs("button",{onClick:()=>g(!p),disabled:D.length===0&&I.length===0,style:{padding:"8px 16px",backgroundColor:D.length>0||I.length>0?"#4A90E2":"#666",border:"none",borderRadius:"4px",color:"white",cursor:D.length>0||I.length>0?"pointer":"not-allowed",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},title:"Export Pin Data",children:[" Export ",p?"":""]}),p&&(D.length>0||I.length>0)&&T.jsxs("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",zIndex:1e3,minWidth:"160px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[T.jsx("button",{onClick:()=>{s(!0),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Ne=>Ne.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ne=>Ne.currentTarget.style.backgroundColor="transparent",children:" Constraints (XDC/SDC)"}),T.jsx("button",{onClick:()=>{Je(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px",borderBottom:"1px solid #444"},onMouseEnter:Ne=>Ne.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ne=>Ne.currentTarget.style.backgroundColor="transparent",children:" CSV Data"}),T.jsx("button",{onClick:()=>{dt(),g(!1)},style:{width:"100%",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"white",cursor:"pointer",textAlign:"left",fontSize:"14px"},onMouseEnter:Ne=>Ne.currentTarget.style.backgroundColor="#3a3a3a",onMouseLeave:Ne=>Ne.currentTarget.style.backgroundColor="transparent",children:" Report"})]})]})]})]}),T.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden",minHeight:0,height:"100%"},children:[!y&&T.jsxs("aside",{style:{width:`${x}px`,backgroundColor:"#252525",borderRight:"1px solid #444",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%",minWidth:"200px",maxWidth:"500px"},children:[T.jsx("div",{onMouseDown:xe("left"),style:{position:"absolute",right:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:N==="left"?"#007acc":"transparent"},title:"Drag to resize panel"}),T.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #444"},children:[T.jsx("input",{type:"text",placeholder:"Search pins...",value:Q.searchText,onChange:pe,style:{width:"100%",padding:"8px 12px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),T.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",alignItems:"center"},children:[T.jsx("span",{style:{fontSize:"12px",color:"#999"},children:"Sort:"}),T.jsxs("select",{value:Q.sortField,onChange:Ne=>ue(Ne.target.value),style:{padding:"4px 8px",backgroundColor:"#1a1a1a",border:"1px solid #555",borderRadius:"3px",color:"#fff",fontSize:"12px",cursor:"pointer"},children:[T.jsx("option",{value:"pinNumber",children:"Pin Number"}),T.jsx("option",{value:"pinName",children:"Pin Name"}),T.jsx("option",{value:"signalName",children:"Signal Name"}),T.jsx("option",{value:"pinType",children:"Pin Type"}),T.jsx("option",{value:"bank",children:"Bank"}),T.jsx("option",{value:"grid",children:"Grid Position"})]}),T.jsx("button",{onClick:()=>z(Q.sortOrder==="asc"?"desc":"asc"),style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px"},title:`Sort ${Q.sortOrder==="asc"?"Descending":"Ascending"}`,children:Q.sortOrder==="asc"?"":""})]}),T.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px",flexWrap:"wrap"},children:[T.jsxs("button",{onClick:()=>X({pinTypes:[]}),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.length===0?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["All (",I.length,")"]}),T.jsxs("button",{onClick:()=>Ce("IO"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("IO")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["I/O (",I.filter(Ne=>Ne.pinType==="IO").length,")"]}),T.jsxs("button",{onClick:()=>Ce("POWER"),style:{padding:"4px 8px",fontSize:"12px",backgroundColor:Q.pinTypes.includes("POWER")?"#4A90E2":"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer"},children:["Power (",I.filter(Ne=>Ne.pinType==="POWER").length,")"]})]})]}),T.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:I.length===0?T.jsxs(T.Fragment,{children:[T.jsx("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px"},children:"No package loaded"}),T.jsxs("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:["Debug: pins=",I.length,", package=",(O==null?void 0:O.name)||"null"]}),T.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"14px"},children:[T.jsx("div",{style:{marginBottom:"12px"},children:""}),T.jsx("div",{children:"Load a CSV file to start"})]})]}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{style:{color:"#999",fontSize:"12px",marginBottom:"8px",display:"flex",justifyContent:"space-between"},children:[T.jsx("span",{children:(O==null?void 0:O.name)||"Package"}),T.jsxs("span",{children:["Showing ",D.length," of ",I.length]})]}),T.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:vt.map(Ne=>{const Ye=n?I.find(At=>At.id===n):null,Ue=Ye?Gt.findPairPin(Ye,I):null,at=(Ue==null?void 0:Ue.id)===Ne.id;return T.jsx(yD,{pin:Ne,isSelected:U.has(Ne.id),onSelect:Pe,onAssignSignal:se,isPairPin:!1,isDifferentialPairPartner:at},Ne.id)})})]})})]}),T.jsxs("main",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0,minHeight:0},children:[T.jsxs("div",{className:"toolbar-scrollbar",style:{height:"32px",backgroundColor:"#2a2a2a",borderBottom:"1px solid #444",display:"flex",alignItems:"center",padding:"0 12px",gap:"8px",overflowX:"auto",overflowY:"hidden",flexShrink:0,minHeight:"32px"},children:[T.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[T.jsx("button",{onClick:()=>ee("grid"),style:{padding:"4px 8px",backgroundColor:te.viewMode==="grid"?"#007acc":"#333",border:"1px solid #555",borderRadius:"4px 0 0 4px",color:te.viewMode==="grid"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"Grid View",children:" Grid"}),T.jsx("button",{onClick:()=>ee("list"),style:{padding:"4px 8px",backgroundColor:te.viewMode==="list"?"#007acc":"#333",border:"1px solid #555",borderRadius:"0 4px 4px 0",color:te.viewMode==="list"?"#fff":"#ccc",cursor:"pointer",fontSize:"11px",whiteSpace:"nowrap"},title:"List View",children:" List"})]}),T.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),T.jsx("button",{onClick:Ae,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Rotate 90"}),T.jsx("button",{onClick:q,style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},children:" Flip View"}),T.jsx("div",{style:{flexShrink:0},children:T.jsx(tU,{})}),T.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),T.jsx("div",{style:{flexShrink:0},children:T.jsx(rU,{})}),T.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),T.jsxs("button",{onClick:()=>d(f==="validation"?null:"validation"),style:{padding:"6px 12px",backgroundColor:f==="validation"?"#4a5568":Ke?"#dc2626":qe?"#d97706":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:`Validation: ${De} errors, ${kt} warnings (click for details)`,children:[T.jsx(oU,{validationResult:Ze}),T.jsx("span",{children:"Validation"}),nt&&T.jsx("span",{className:"animate-spin",children:""})]}),T.jsxs("button",{onClick:()=>d(f==="batch"?null:"batch"),style:{padding:"6px 12px",backgroundColor:f==="batch"?"#4a5568":"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",flexShrink:0},title:"Batch Operations - Assign patterns to multiple pins",children:[T.jsx("span",{children:""}),T.jsx("span",{children:"Batch Ops"})]}),T.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#555",flexShrink:0}}),T.jsx("button",{onClick:()=>u(!0),style:{padding:"6px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},title:"Keyboard Shortcuts (Ctrl+Shift+?)",children:" Shortcuts"}),T.jsx("div",{style:{flex:1,minWidth:"20px"}}),T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0,backgroundColor:"#2a2a2a",padding:"0 8px",borderRadius:"4px"},children:[T.jsx("span",{style:{fontSize:"12px",color:"#999",whiteSpace:"nowrap"},children:"Zoom:"}),T.jsx("button",{onClick:Ge,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"-"}),T.jsxs("button",{onClick:K,style:{padding:"4px 12px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",minWidth:"50px",whiteSpace:"nowrap"},title:"Reset zoom to 100%",children:[Math.round(he.zoom*100),"%"]}),T.jsx("button",{onClick:be,style:{padding:"4px 8px",backgroundColor:"#333",border:"1px solid #555",borderRadius:"3px",color:"#ccc",cursor:"pointer",fontSize:"12px",whiteSpace:"nowrap",minWidth:"32px"},children:"+"})]})]}),T.jsxs("div",{style:{flex:1,minWidth:"0",backgroundColor:"#1a1a1a",overflow:"hidden",display:"flex",flexShrink:1,width:"100%",minHeight:0,height:"100%"},children:[T.jsx("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minWidth:0,width:"100%",minHeight:0,height:"100%"},children:te.viewMode==="grid"?T.jsx(eU,{package:O,pins:D,selectedPins:U,onPinSelect:ie,onPinDoubleClick:ye,zoom:he.zoom,rotation:he.rotation,isTopView:he.isTopView,onZoomChange:Y}):T.jsx("div",{style:{height:"100%",backgroundColor:"#1a1a1a",overflow:"hidden",width:"100%",minHeight:0},children:T.jsx(jD,{onPinSelect:Pe})})}),!y&&f&&T.jsxs("div",{style:{width:`${A}px`,minWidth:"200px",maxWidth:"500px",borderLeft:"1px solid #555",backgroundColor:"#1e1e1e",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minHeight:0,position:"relative"},children:[T.jsx("div",{onMouseDown:xe("right"),style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",cursor:"col-resize",zIndex:10,backgroundColor:N==="right"?"#007acc":"transparent"},title:"Drag to resize panel"}),f==="validation"&&T.jsx("div",{style:{height:"100%",overflow:"hidden"},className:"custom-scrollbar",children:T.jsx(sU,{validationResult:Ze,onIssueClick:Ne=>{Ne.affectedPins&&Ne.affectedPins.length>0&&console.log("Pins to highlight:",Ne.affectedPins)}})}),f==="batch"&&T.jsx("div",{style:{height:"100%",overflow:"auto"},className:"custom-scrollbar",children:T.jsx(lU,{isVisible:!0})})]})]})]})]}),!k&&T.jsxs("footer",{style:{height:"16px",backgroundColor:"#2a2a2a",borderTop:"1px solid #444",display:"flex",alignItems:"center",padding:"0 16px",fontSize:"10px",color:"#999",flexShrink:0},children:[T.jsx("span",{children:"Ready"}),T.jsx("div",{style:{marginLeft:"auto"},children:T.jsxs("span",{children:["Pins: ",lt.total," | Assigned: ",lt.assigned," | Unassigned: ",lt.unassigned]})})]}),T.jsx(_D,{isOpen:a,onClose:()=>s(!1),onExport:Qe,pins:I,currentPackage:O}),T.jsx(aU,{isOpen:o,onClose:()=>u(!1)})]})};Sg.createRoot(document.getElementById("root")).render(T.jsx(Sr.StrictMode,{children:T.jsx(gU,{})}));
