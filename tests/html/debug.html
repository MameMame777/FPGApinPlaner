<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPGA Pin Planner - Debug</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #1e1e1e;
            color: #ffffff;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            background-color: #333;
        }
        .success { background-color: #2d5a27; }
        .error { background-color: #5a2727; }
        .loading { background-color: #2d4a5a; }
    </style>
</head>
<body>
    <h1>🔧 FPGA Pin Planner - デバッグページ</h1>
    
    <div id="status" class="status loading">
        📊 アプリケーションの状態を確認中...
    </div>
    
    <div id="details"></div>
    
    <h2>🧪 基本機能テスト</h2>
    <button onclick="testBasicFunction()" style="padding: 8px 16px; background-color: #4A90E2; border: none; border-radius: 4px; color: white; cursor: pointer;">
        基本機能をテスト
    </button>
    
    <div id="test-results"></div>
    
    <script>
        console.log('🚀 デバッグページが読み込まれました');
        
        function updateStatus(message, type = 'loading') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }
        
        function addDetail(message) {
            const details = document.getElementById('details');
            const div = document.createElement('div');
            div.className = 'status';
            div.textContent = message;
            details.appendChild(div);
        }
        
        // React app の状態をチェック
        setTimeout(() => {
            try {
                // Vite開発サーバーの確認
                fetch('http://localhost:5175')
                    .then(response => {
                        if (response.ok) {
                            updateStatus('✅ 開発サーバーは正常に動作しています', 'success');
                            addDetail('📡 HTTP Status: ' + response.status);
                            return response.text();
                        } else {
                            throw new Error('Server response: ' + response.status);
                        }
                    })
                    .then(html => {
                        if (html.includes('<div id="root"></div>')) {
                            addDetail('✅ Reactアプリのルート要素が見つかりました');
                        } else {
                            addDetail('❌ Reactアプリのルート要素が見つかりません');
                        }
                        
                        if (html.includes('script')) {
                            addDetail('✅ JavaScriptファイルが読み込まれています');
                        } else {
                            addDetail('❌ JavaScriptファイルが見つかりません');
                        }
                    })
                    .catch(error => {
                        updateStatus('❌ 開発サーバーへの接続に失敗しました', 'error');
                        addDetail('エラー: ' + error.message);
                    });
            } catch (error) {
                updateStatus('❌ 予期しないエラーが発生しました', 'error');
                addDetail('エラー: ' + error.message);
            }
        }, 1000);
        
        function testBasicFunction() {
            const resultsDiv = document.getElementById('test-results');
            
            let results = '<h3>🧪 テスト結果</h3>';
            
            // Browser support tests
            results += '<div class="status">';
            results += '<strong>ブラウザサポート確認:</strong><br>';
            results += 'ES6 Modules: ' + (typeof import !== 'undefined' ? '✅' : '❌') + '<br>';
            results += 'Fetch API: ' + (typeof fetch !== 'undefined' ? '✅' : '❌') + '<br>';
            results += 'Local Storage: ' + (typeof localStorage !== 'undefined' ? '✅' : '❌') + '<br>';
            results += 'File API: ' + (typeof FileReader !== 'undefined' ? '✅' : '❌') + '<br>';
            results += '</div>';
            
            resultsDiv.innerHTML = results;
        }
        
        // Console error monitoring
        const originalError = console.error;
        console.error = function(...args) {
            addDetail('❌ Console Error: ' + args.join(' '));
            originalError.apply(console, args);
        };
        
        // Unhandled promise rejection monitoring
        window.addEventListener('unhandledrejection', function(event) {
            addDetail('❌ Unhandled Promise Rejection: ' + event.reason);
        });
        
        // JavaScript error monitoring
        window.addEventListener('error', function(event) {
            addDetail('❌ JavaScript Error: ' + event.message + ' at ' + event.filename + ':' + event.lineno);
        });
    </script>
</body>
</html>
